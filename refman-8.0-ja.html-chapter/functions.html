<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第 12 章 関数と演算子</title><link rel="stylesheet" type="text/css" href="mvl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="up" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="prev" href="data-types.html" title="第 11 章 データ型"><link rel="next" href="sql-statements.html" title="第 13 章 SQL ステートメント"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 12 章 関数と演算子</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="data-types.html">前</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="sql-statements.html">次へ</a></td></tr></table><hr></div><div class="status-header"><p class="alert">このページは機械翻訳したものです。</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="functions"></a>第 12 章 関数と演算子</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="functions.html#built-in-function-reference">12.1 SQL 関数および演算子リファレンス</a></span></dt><dt><span class="section"><a href="functions.html#loadable-function-reference">12.2 ユーザー定義関数参照</a></span></dt><dt><span class="section"><a href="functions.html#type-conversion">12.3 式評価での型変換</a></span></dt><dt><span class="section"><a href="functions.html#non-typed-operators">12.4 演算子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#operator-precedence">12.4.1 演算子の優先順位</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.4.2 比較関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.4.3 論理演算子</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.4.4 割り当て演算子</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#flow-control-functions">12.5 フロー制御関数</a></span></dt><dt><span class="section"><a href="functions.html#numeric-functions">12.6 数値関数と演算子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 算術演算子</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 数学関数</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#date-and-time-functions">12.7 日付および時間関数</a></span></dt><dt><span class="section"><a href="functions.html#string-functions">12.8 文字列関数および演算子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#string-comparison-functions">12.8.1 文字列比較関数および演算子</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.8.2 正規表現</a></span></dt><dt><span class="section"><a href="functions.html#string-functions-charset">12.8.3 関数結果の文字セットと照合順序</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#mysql-calendar">12.9 MySQL で使用されるカレンダー</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search">12.10 全文検索関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#fulltext-natural-language">12.10.1 自然言語全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean">12.10.2 ブール全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion">12.10.3 クエリー拡張を使用した全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords">12.10.4 全文ストップワード</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions">12.10.5 全文制限</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning">12.10.6 MySQL の全文検索の微調整</a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation">12.10.7 全文インデックス付けのためのユーザー定義照合の追加</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-ngram">12.10.8 ngram 全文パーサー</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-mecab">12.10.9 MeCab フルテキストパーサープラグイン</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#cast-functions">12.11 キャスト関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#xml-functions">12.12 XML 関数</a></span></dt><dt><span class="section"><a href="functions.html#bit-functions">12.13 ビット関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#encryption-functions">12.14 暗号化関数と圧縮関数</a></span></dt><dt><span class="section"><a href="functions.html#locking-functions">12.15 ロック関数</a></span></dt><dt><span class="section"><a href="functions.html#information-functions">12.16 情報関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-analysis-functions">12.17 空間分析関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#spatial-function-reference">12.17.1 空間関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling">12.17.2 空間関数による引数処理</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions">12.17.3 WKT 値からジオメトリ値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions">12.17.4 WKB 値からジオメトリ値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions">12.17.5 ジオメトリ値を作成する MySQL 固有の関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions">12.17.6 ジオメトリ形式変換関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions">12.17.7 ジオメトリプロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions">12.17.8 空間演算子関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions">12.17.9 ジオメトリオブジェクト間の空間関係をテストする関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geohash-functions">12.17.10 空間 Geohash 関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geojson-functions">12.17.11 空間 GeoJSON 関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-aggregate-functions">12.17.12 空間集計関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-convenience-functions">12.17.13 空間の便利な関数</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#json-functions">12.18 JSON 関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#json-function-reference">12.18.1 JSON 関数リファレンス</a></span></dt><dt><span class="section"><a href="functions.html#json-creation-functions">12.18.2 JSON 値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-search-functions">12.18.3 JSON 値を検索する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-modification-functions">12.18.4 JSON 値を変更する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-attribute-functions">12.18.5 JSON 値属性を返す関数</a></span></dt><dt><span class="section"><a href="functions.html#json-table-functions">12.18.6 JSON テーブル関数</a></span></dt><dt><span class="section"><a href="functions.html#json-validation-functions">12.18.7 JSON スキーマ検証関数</a></span></dt><dt><span class="section"><a href="functions.html#json-utility-functions">12.18.8 JSON ユーティリティ関数</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#gtid-functions">12.19 グローバルトランザクション識別子 (GTID) で使用される機能</a></span></dt><dt><span class="section"><a href="functions.html#aggregate-functions-and-modifiers">12.20 集計関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#aggregate-functions">12.20.1 集計関数の説明</a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers">12.20.2 GROUP BY 修飾子</a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling">12.20.3 MySQL での GROUP BY の処理</a></span></dt><dt><span class="section"><a href="functions.html#group-by-functional-dependence">12.20.4 機能依存性の検出</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#window-functions">12.21 ウィンドウ関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#window-function-descriptions">12.21.1 Window 関数の説明</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-usage">12.21.2 Window 関数の概念と構文</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-frames">12.21.3 ウィンドウ機能フレーム仕様</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-named-windows">12.21.4 名前付きウィンドウ</a></span></dt><dt><span class="section"><a href="functions.html#window-function-restrictions">12.21.5 ウィンドウ機能の制限事項</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#performance-schema-functions">12.22 パフォーマンススキーマ関数</a></span></dt><dt><span class="section"><a href="functions.html#internal-functions">12.23 内部関数</a></span></dt><dt><span class="section"><a href="functions.html#miscellaneous-functions">12.24 その他の関数</a></span></dt><dt><span class="section"><a href="functions.html#precision-math">12.25 高精度計算</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#precision-math-numbers">12.25.1 数値の型</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics">12.25.2 DECIMAL データ型の特性</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions">12.25.3 式の処理</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding">12.25.4 丸め動作</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples">12.25.5 高精度計算の例</a></span></dt></dl></dd></dl></div><a class="indexterm" name="idm46041630799360"></a><a class="indexterm" name="idm46041630797152"></a><a class="indexterm" name="idm46041630795808"></a><p>
    <a class="link" href="glossary.html#glos_sql" title="SQL">SQL</a> ステートメントのいくつかのポイント (<code class="literal">SELECT</code> ステートメントの <code class="literal">ORDER BY</code> または <code class="literal">HAVING</code> 句、<code class="literal">SELECT</code>、<code class="literal">DELETE</code>、または <code class="literal">UPDATE</code> ステートメントの <code class="literal">WHERE</code> 句、<code class="literal">SET</code> ステートメントなど) では、式を使用できます。 式は、リテラル値、カラム値、<code class="literal">NULL</code>、組み込み関数、ストアドファンクション、ユーザー定義関数、および演算子を使用して作成できます。 この章では、MySQL で式を記述できる SQL 関数および演算子について説明します。 ストアドファンクションおよびユーザー定義関数を作成する手順については、<a class="xref" href="stored-objects.html#stored-routines" title="25.2 ストアドルーチンの使用">セクション25.2「ストアドルーチンの使用」</a>および<a class="ulink" href="https://dev.mysql.com/doc/extending-mysql/8.0/en/adding-functions.html" target="_top">Adding Functions to MySQL</a>で説明されています。 各種の関数への参照をサーバーが解釈する方法を記述したルールについては、<a class="xref" href="language-structure.html#function-resolution" title="9.2.5 関数名の構文解析と解決">セクション9.2.5「関数名の構文解析と解決」</a>を参照してください。 
  </p><p>
    <code class="literal">NULL</code> を含む式では、その関数または演算子に関するドキュメントで明記されていないかぎり、常に <code class="literal">NULL</code> 値が生成されます。
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
      デフォルトでは、関数名とそれに続く丸括弧の間には空白を入れることはできません。 これは、MySQL パーサーが、関数呼び出しと、偶然に関数と同じ名前を持つテーブルまたはカラムへの参照を区別するのに役立ちます。 ただし、関数の引数の前後にスペースを入れることは許可されています。 
    </p></div><p>
    最初に <code class="option">--sql-mode=IGNORE_SPACE</code> オプションを付けると、関数名のあとの空白文字を受け入れるように MySQL サーバーに指示できます。 (<a class="xref" href="server-administration.html#sql-mode" title="5.1.11 サーバー SQL モード">セクション5.1.11「サーバー SQL モード」</a>を参照してください。) 各クライアントプログラムで <code class="literal">mysql_real_connect()</code> に <code class="literal">CLIENT_IGNORE_SPACE</code> オプションを使用すると、この動作をリクエストできます。 どちらの場合でも、すべての関数名は予約語になります。 
  </p><p>
    簡略化のため、この章で示すほとんどの例では、<span class="command"><strong>mysql</strong></span> プログラムからの出力が省略形で表示されています。 例は次の書式で表示されません。 
  </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
+-----------+
| mod(29,9) |
+-----------+
|         2 |
+-----------+
1 rows in set (0.00 sec)
</pre><p>
    代わりに、次の書式が使用されます。
  </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
        -&gt; 2
</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="built-in-function-reference"></a>12.1 SQL 関数および演算子リファレンス</h2></div></div></div><p>
      次のテーブルに、各 SQL 関数と演算子を示し、それぞれについて簡単に説明します。 ユーザー定義関数を示すテーブルについては、<a class="xref" href="functions.html#loadable-function-reference" title="12.2 ユーザー定義関数参照">セクション12.2「ユーザー定義関数参照」</a> を参照してください。 
    </p><div class="table"><a name="idm46041630765152"></a><p class="title"><b>表 12.1 「SQL 関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「すべての SQL 関数および演算子をリストする参照。」"><col style="width: 22%"><col style="width: 55%"><col style="width: 11%"><col style="width: 11%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
<th>非推奨</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></th>
<td>
      ビット単位の AND
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></th>
<td>
      右不等 (より多い) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></th>
<td>
      右シフト
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></th>
<td>
      以上 (より多いか等しい) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></th>
<td>
      左不等 (より少ない) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">&lt;&gt;</code>, <code class="literal">!=</code></a></th>
<td>
      不等価 (等しくない) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></th>
<td>
      左シフト
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></th>
<td>
      以下 (より少ないか等しい) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=</code></a></th>
<td>
      NULL 安全等価演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><code class="literal">%</code>, <code class="literal">MOD</code></th>
<td>
      モジュロ演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></th>
<td>
      乗算演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></th>
<td>
      加算演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></th>
<td>
      減算演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></th>
<td>
      引数の符号を変更します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></th>
<td>
      パスを評価した後の JSON カラムからの戻り値 (JSON_EXTRACT() と同等)。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></th>
<td>
      パスを評価して結果を引用符で囲まずに JSON カラムから値を返します (JSON_UNQUOTE(JSON_EXTRACT() と同等)。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></th>
<td>
      除算演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></th>
<td>
      値を割り当てます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></th>
<td>
      (<code class="literal">SET</code> ステートメントの一部として、または <code class="literal">UPDATE</code> ステートメントの <code class="literal">SET</code> 句の一部として) 値を割り当てます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></th>
<td>
      等価 (等しい) 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></th>
<td>
      ビット単位の XOR
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></th>
<td>
      絶対値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></th>
<td>
      アークコサインを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></th>
<td>
      日付値に時間値 (間隔) を加算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></th>
<td>
      時間を加算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></th>
<td>
      AES を使用して復号化します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></th>
<td>
      AES を使用して暗号化します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></th>
<td>
      論理 AND
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a></th>
<td>
      ONLY_FULL_GROUP_BY 値の拒否を抑止します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></th>
<td>
      左端の文字の数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></th>
<td>
      アークサインを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></th>
<td>
      アークタンジェントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></th>
<td>
      2 つの引数のアークタンジェントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></th>
<td>
      引数の平均値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></th>
<td>
      式を繰り返し実行します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></th>
<td>
      値が値の範囲内にあるかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></th>
<td>
      数値のバイナリ表現を含む文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a></th>
<td>
      バイナリ UUID を文字列に変換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></th>
<td>
      文字列をバイナリ文字列にキャストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></th>
<td>
      ビット単位 AND を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></th>
<td>
      設定されているビット数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></th>
<td>
      ビット単位で引数の長さを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></th>
<td>
      ビット単位の OR を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></th>
<td>
      ビット単位 XOR を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-column"><code class="literal">CAN_ACCESS_COLUMN()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-database"><code class="literal">CAN_ACCESS_DATABASE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-table"><code class="literal">CAN_ACCESS_TABLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-user"><code class="literal">CAN_ACCESS_USER()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.22</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-view"><code class="literal">CAN_ACCESS_VIEW()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></th>
<td>
      CASE 演算子
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></th>
<td>
      値を特定の型としてキャストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></th>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></th>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></th>
<td>
      渡された各整数の文字を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></th>
<td>
      引数の文字数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></th>
<td>
      CHAR_LENGTH() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></th>
<td>
      引数の文字セットを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></th>
<td>
      NULL 以外の最初の引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></th>
<td>
      文字列引数の照合順序強制性値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></th>
<td>
      文字列引数の照合順序を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></th>
<td>
      バイナリ文字列として結果を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></th>
<td>
      連結された文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></th>
<td>
      連結されたものをセパレータ付きで返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></th>
<td>
      接続のための接続 ID (スレッド ID) を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></th>
<td>
      数値を異なる基数間で変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></th>
<td>
      値を特定の型としてキャストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></th>
<td>
      タイムゾーン間での変換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></th>
<td>
      コサインを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></th>
<td>
      コタンジェントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></th>
<td>
      返された行数のカウントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></th>
<td>
      異なる値のカウントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></th>
<td>
      巡回冗長検査値を計算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a></th>
<td>
      累積分布値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></th>
<td>
      現在の日付を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></th>
<td>
      CURDATE() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a></th>
<td>
      現在アクティブなロールを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></th>
<td>
      CURTIME() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></th>
<td>
      NOW() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code>, <code class="literal">CURRENT_USER</code></a></th>
<td>
      認証済みユーザー名とホスト名
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></th>
<td>
      現在の時間を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></th>
<td>
      デフォルト (現在) のデータベース名を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></th>
<td>
      日付または日付時間式の日付部分を抽出します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></th>
<td>
      日付値に時間値 (間隔) を加算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></th>
<td>
      日付を指定された書式に設定します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></th>
<td>
      日付から時間値 (間隔) を引きます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></th>
<td>
      2 つの日付の差を求めます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></th>
<td>
      DAYOFMONTH() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></th>
<td>
      曜日の名前を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></th>
<td>
      月の日を返します (0 - 31)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></th>
<td>
      引数の曜日インデックスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></th>
<td>
      年の日を返します (1 - 366)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></th>
<td>
      テーブルカラムのデフォルト値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></th>
<td>
      ラジアンを角度に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a></th>
<td>
      パーティション内の現在の行のランク (ギャップなし)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></th>
<td>
      整数除算
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></th>
<td>
      インデックス番号位置の文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></th>
<td>
      累乗します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></th>
<td>
      値 bits 内の各ビットが設定されている場合は on 文字列を取得し、各ビットが設定されていない場合には off 文字列を取得するように、文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></th>
<td>
      日付の一部を抽出します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></th>
<td>
      XPath 表記法を使用した XML 文字列からの値の抽出
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></th>
<td>
      後続の引数の最初の引数のインデックス (位置)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></th>
<td>
      2 番目の引数内の最初の引数のインデックス (位置)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a></th>
<td>
      ウィンドウフレームの最初の行からの引数の値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></th>
<td>
      引数以下のもっとも大きな整数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></th>
<td>
      指定された小数点以下桁数に書式設定された数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a></th>
<td>
      バイト数を単位付きの値に変換
    </td>
<td>8.0.16</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a></th>
<td>
      時間をピコ秒単位で値に変換
    </td>
<td>8.0.16</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></th>
<td>
      LIMIT 句付き SELECT で、LIMIT 句がない場合に戻される可能性がある行の数です
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></th>
<td>
      base64 でエンコードされた文字列をデコードして結果を返す
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></th>
<td>
      日数を日付に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></th>
<td>
      Unix タイムスタンプを日付として書式設定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a></th>
<td>
      ジオメトリからジオメトリコレクションを構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></th>
<td>
      ジオメトリからジオメトリコレクションを構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-column-privileges"><code class="literal">GET_DD_COLUMN_PRIVILEGES()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-create-options"><code class="literal">GET_DD_CREATE_OPTIONS()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-index-sub-part-length"><code class="literal">GET_DD_INDEX_SUB_PART_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></th>
<td>
      日付書式文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></th>
<td>
      名前付きロックを取得します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></th>
<td>
      最大の引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></th>
<td>
      連結された文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a></th>
<td>
      ROLLUP 行と通常の行の区別
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></th>
<td>
      サブセット内のすべての GTID がセット内にもある場合は、true を返します。そうでない場合は、false を返します。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></th>
<td>
      セット内の GTID のうち、サブセット内にないものをすべてを返します。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></th>
<td>
      小数または文字列値の 16 進数表現
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></th>
<td>
      時を抽出します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_icu-version"><code class="literal">ICU_VERSION()</code></a></th>
<td>
      ICU ライブラリバージョン
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></th>
<td>
      If/else 構文
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></th>
<td>
      Null if/else 構文
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></th>
<td>
      値が値セット内にあるかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></th>
<td>
      IP アドレスの数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></th>
<td>
      数値から IP アドレスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></th>
<td>
      IPv6 アドレスの数値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></th>
<td>
      数値から IPv6 アドレスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></th>
<td>
      指定した位置に指定した文字数まで部分文字列を挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></th>
<td>
      部分文字列が最初に出現する位置のインデックスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-auto-increment"><code class="literal">INTERNAL_AUTO_INCREMENT()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-avg-row-length"><code class="literal">INTERNAL_AVG_ROW_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-check-time"><code class="literal">INTERNAL_CHECK_TIME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-checksum"><code class="literal">INTERNAL_CHECKSUM()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-data-free"><code class="literal">INTERNAL_DATA_FREE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-data-length"><code class="literal">INTERNAL_DATA_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-dd-char-length"><code class="literal">INTERNAL_DD_CHAR_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-comment-or-error"><code class="literal">INTERNAL_GET_COMMENT_OR_ERROR()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-enabled-role-json"><code class="literal">INTERNAL_GET_ENABLED_ROLE_JSON()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-hostname"><code class="literal">INTERNAL_GET_HOSTNAME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-username"><code class="literal">INTERNAL_GET_USERNAME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-view-warning-or-error"><code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-index-column-cardinality"><code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-index-length"><code class="literal">INTERNAL_INDEX_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-is-enabled-role"><code class="literal">INTERNAL_IS_ENABLED_ROLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-is-mandatory-role"><code class="literal">INTERNAL_IS_MANDATORY_ROLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-keys-disabled"><code class="literal">INTERNAL_KEYS_DISABLED()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-max-data-length"><code class="literal">INTERNAL_MAX_DATA_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-table-rows"><code class="literal">INTERNAL_TABLE_ROWS()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-update-time"><code class="literal">INTERNAL_UPDATE_TIME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></th>
<td>
      第 1 引数より小さい引数のインデックスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></th>
<td>
      ブーリアンに対して値をテストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></th>
<td>
      名前付きロックが解放されているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></th>
<td>
      引数が IPv4 アドレスかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></th>
<td>
      引数が IPv4 互換アドレスかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></th>
<td>
      引数が IPv4 マップアドレスかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></th>
<td>
      引数が IPv6 アドレスかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></th>
<td>
      ブーリアンに対して値をテストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></th>
<td>
      NOT NULL 値テスト
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></th>
<td>
      NULL 値テスト
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></th>
<td>
      指定されたロックが使用中かどうか。true の場合は接続識別子を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a></th>
<td>
      引数が有効な UUID かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></th>
<td>
      引数が NULL かどうかをテストします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a></th>
<td>
      JSON 配列の作成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array-append"><code class="literal">JSON_ARRAY_APPEND()</code></a></th>
<td>
      JSON ドキュメントへのデータの追加
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT()</code></a></th>
<td>
      JSON 配列に挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a></th>
<td>
      結果セットを単一の JSON 配列として返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a></th>
<td>
      JSON ドキュメントのパスに特定のオブジェクトが含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a></th>
<td>
      JSON ドキュメントにパスのデータが含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-depth"><code class="literal">JSON_DEPTH()</code></a></th>
<td>
      JSON ドキュメントの最大深度
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a></th>
<td>
      JSON ドキュメントからデータを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a></th>
<td>
      JSON ドキュメントへのデータの挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-keys"><code class="literal">JSON_KEYS()</code></a></th>
<td>
      JSON ドキュメントからのキーの配列
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-length"><code class="literal">JSON_LENGTH()</code></a></th>
<td>
      JSON ドキュメント内の要素数
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE()</code></a></th>
<td>
      JSON ドキュメントをマージし、重複するキーを保持します。 JSON_MERGE_PRESERVE() の非推奨シノニム 
    </td>
<td></td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a></th>
<td>
      重複キーの値を置換して JSON ドキュメントをマージ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a></th>
<td>
      重複キーを保持した JSON ドキュメントのマージ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a></th>
<td>
      JSON オブジェクトの作成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a></th>
<td>
      結果セットを単一の JSON オブジェクトとして返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-overlaps"><code class="literal">JSON_OVERLAPS()</code></a></th>
<td>
      2 つの JSON ドキュメントを比較し、共通のキーと値のペアまたは配列要素がある場合は TRUE (1) を戻し、それ以外の場合は FALSE (0) を戻します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a></th>
<td>
      JSON ドキュメントを人間が読める形式で出力
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE()</code></a></th>
<td>
      見積 JSON 文書
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a></th>
<td>
      JSON ドキュメントからのデータの削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a></th>
<td>
      JSON ドキュメントの値の置換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID()</code></a></th>
<td>
      JSON スキーマに対して JSON ドキュメントを検証します。ドキュメントがスキーマに対して検証される場合は TRUE/1 を返し、検証されない場合は FALSE/0 を返します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code></a></th>
<td>
      JSON スキーマに対して JSON ドキュメントを検証します。成功や失敗、失敗の理由など、検証の結果に関するレポートを JSON 形式で返します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a></th>
<td>
      JSON ドキュメント内の値へのパス
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a></th>
<td>
      JSON ドキュメントへのデータの挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a></th>
<td>
      部分更新後の JSON カラム値のバイナリ表現内の空き領域
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a></th>
<td>
      JSON ドキュメントのバイナリ表現の格納に使用される領域
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a></th>
<td>
      JSON 式からリレーショナルテーブルとしてデータを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a></th>
<td>
      JSON 値のタイプ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a></th>
<td>
      JSON 値の引用符なし
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-valid"><code class="literal">JSON_VALID()</code></a></th>
<td>
      JSON 値が有効かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-value"><code class="literal">JSON_VALUE()</code></a></th>
<td>
      指定されたパスでポイントされた場所にある JSON ドキュメントから値を抽出します。この値を VARCHAR(512) または指定されたタイプとして返します
    </td>
<td>8.0.21</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a></th>
<td>
      パーティション内の現在行より遅れている行の引数の値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></th>
<td>
      引数の月の最終日を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></th>
<td>
      前回の INSERT での AUTOINCREMENT カラムの値です
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a></th>
<td>
      ウィンドウフレームの最後の行からの引数の値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></th>
<td>
      LOWER() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a></th>
<td>
      パーティション内の現在の行の先頭行からの引数の値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></th>
<td>
      最小の引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></th>
<td>
      左端から指定された数の文字を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></th>
<td>
      文字列の長さをバイト単位で返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></th>
<td>
      単純なパターン一致
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></th>
<td>
      Point 値から LineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></th>
<td>
      引数の自然対数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></th>
<td>
      指定されたファイルをロードします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></th>
<td>
      NOW() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></th>
<td>
      NOW() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></th>
<td>
      部分文字列が最初に出現する位置を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></th>
<td>
      最初の引数の自然対数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></th>
<td>
      引数の底 10 の対数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></th>
<td>
      引数の底 2 の対数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></th>
<td>
      引数を小文字で返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></th>
<td>
      指定された文字列で左からパディングした文字列引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></th>
<td>
      先頭の空白を削除します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></th>
<td>
      bits セット内の対応するビットを持つ、カンマ区切り文字列のセットを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></th>
<td>
      年と年間通算日から日付を作成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></th>
<td>
      時、分、秒から時間を作成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></th>
<td>
      レプリカが指定された位置までのすべての更新を読み取り、適用するまでブロック
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></th>
<td>
      全文検索を実行します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></th>
<td>
      最大値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></th>
<td>
      あるジオメトリの MBR に、別のジオメトリの MBR が含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a></th>
<td>
      ある MBR が別の MBR でカバーされているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a></th>
<td>
      ある MBR が別の MBR をカバーしているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></th>
<td>
      2 つのジオメトリの MBR が切り離されているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals()</code></a></th>
<td>
      2 つのジオメトリの MBR が等しいかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></th>
<td>
      2 つのジオメトリの MBR が交差しているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></th>
<td>
      2 つのジオメトリの MBR がオーバーラップしているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></th>
<td>
      2 つのジオメトリの MBR が接しているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></th>
<td>
      あるジオメトリの MBR が、別のジオメトリの MBR の内部にあるかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></th>
<td>
      MD5 チェックサムを計算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></th>
<td>
      最初のオペランドが 2 番目のオペランドとして渡された JSON 配列のいずれかの要素と一致する場合は true (1) を返し、それ以外の場合は false (0) を返します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></th>
<td>
      引数からマイクロ秒を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></th>
<td>
      指定された位置から始まる部分文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></th>
<td>
      最小値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></th>
<td>
      引数から分を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><code class="literal">MOD()</code></th>
<td>
      余りを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></th>
<td>
      渡された日付から月を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></th>
<td>
      月の名前を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></th>
<td>
      LineString 値から MultiLineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></th>
<td>
      Point 値から MultiPoint を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></th>
<td>
      Polygon 値から MultiPolygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></th>
<td>
      カラムの名前を指定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></th>
<td>
      値を否定します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></th>
<td>
      値が値の範囲内にないかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></th>
<td>
      値が値セット内にないかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></th>
<td>
      単純なパターン一致の否定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></th>
<td>
      REGEXP の否定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></th>
<td>
      現在の日付と時間を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a></th>
<td>
      ウィンドウフレームの N 番目の行からの引数の値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ntile"><code class="literal">NTILE()</code></a></th>
<td>
      パーティション内の現在の行のバケット番号。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></th>
<td>
      expr1 = expr2 の場合に NULL を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></th>
<td>
      数値の 8 進数表現を含む文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></th>
<td>
      LENGTH() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></th>
<td>
      論理 OR
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></th>
<td>
      引数の左端の文字の文字コードを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a></th>
<td>
      パーセントランク値
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></th>
<td>
      年月に期間を加算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></th>
<td>
      期間内の月数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></th>
<td>
      pi の値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></th>
<td>
      座標から Point を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></th>
<td>
      LineString 引数から Polygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></th>
<td>
      LOCATE() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></th>
<td>
      指定した指数で累乗された引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></th>
<td>
      指定した指数で累乗された引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a></th>
<td>
      現在のスレッドのパフォーマンススキーマスレッド ID
    </td>
<td>8.0.16</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a></th>
<td>
      指定されたスレッドのパフォーマンススキーマスレッド ID
    </td>
<td>8.0.16</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></th>
<td>
      日付引数から四半期を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></th>
<td>
      SQL ステートメント内で使用するために引数をエスケープします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></th>
<td>
      ラジアンに変換された引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></th>
<td>
      ランダムな浮動小数点値を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></th>
<td>
      ランダムなバイトベクトルを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a></th>
<td>
      パーティション内の現在の行のランク (ギャップあり)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></th>
<td>
      文字列が正規表現と一致するかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></th>
<td>
      正規表現に一致する部分文字列の開始インデックス
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></th>
<td>
      文字列が正規表現と一致するかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></th>
<td>
      正規表現に一致する部分文字列の置換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></th>
<td>
      正規表現に一致する部分文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_release-all-locks"><code class="literal">RELEASE_ALL_LOCKS()</code></a></th>
<td>
      現在の名前付きロックをすべて解放
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></th>
<td>
      指定したロックを解放
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></th>
<td>
      文字列を指定された回数だけ繰り返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></th>
<td>
      指定された文字列の出現箇所を置き換えます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></th>
<td>
      文字列内の文字を逆順に並べ替えます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></th>
<td>
      右端から指定された数の文字を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><code class="literal">RLIKE</code></th>
<td>
      文字列が正規表現と一致するかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_roles-graphml"><code class="literal">ROLES_GRAPHML()</code></a></th>
<td>
      メモリーロールのサブグラフを表す GraphML ドキュメントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></th>
<td>
      引数を丸めます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></th>
<td>
      更新された行数
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a></th>
<td>
      パーティション内の現在の行数
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></th>
<td>
      指定された回数だけ文字列を追加します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></th>
<td>
      末尾の空白を削除します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></th>
<td>
      DATABASE() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></th>
<td>
      秒を hh:mm:ss 形式に変換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></th>
<td>
      秒 (0-59) を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></th>
<td>
      USER() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code>, <code class="literal">SHA()</code></a></th>
<td>
      SHA-1 160 ビットチェックサムを計算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></th>
<td>
      SHA-2 チェックサムを計算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></th>
<td>
      引数の符号を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></th>
<td>
      引数のサインを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></th>
<td>
      ある秒数間スリープ状態にします
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></th>
<td>
      soundex 文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></th>
<td>
      音声を比較します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></th>
<td>
      指定された数の空白で構成される文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></th>
<td>
      引数の平方根を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></th>
<td>
      Polygon または MultiPolygon 領域を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary()</code>, <code class="literal">ST_AsWKB()</code></a></th>
<td>
      内部ジオメトリ形式から WKB に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON()</code></a></th>
<td>
      ジオメトリから GeoJSON オブジェクトを生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText()</code>, <code class="literal">ST_AsWKT()</code></a></th>
<td>
      内部ジオメトリ形式から WKT に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a></th>
<td>
      ジオメトリから指定された距離内にある点のジオメトリを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a></th>
<td>
      ST_Buffer() の作成戦略オプション
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></th>
<td>
      重心を Point として返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-collect"><code class="literal">ST_Collect()</code></a></th>
<td>
      空間値をコレクションに集約
    </td>
<td>8.0.24</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></th>
<td>
      あるジオメトリに別のジオメトリが含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull()</code></a></th>
<td>
      ジオメトリの凸包を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></th>
<td>
      あるジオメトリが別のジオメトリと交差しているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></th>
<td>
      2 つのジオメトリの点集合の差集合を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension()</code></a></th>
<td>
      ジオメトリの次元
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></th>
<td>
      あるジオメトリが別のジオメトリから切り離されているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></th>
<td>
      あるジオメトリの別のジオメトリからの距離
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a></th>
<td>
      2 つのジオメトリ間の地球上の最小距離
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a></th>
<td>
      LineString の終点
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></th>
<td>
      ジオメトリの MBR を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></th>
<td>
      あるジオメトリが別のジオメトリに等しいかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing()</code></a></th>
<td>
      Polygon の外側のリングを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-frechetdistance"><code class="literal">ST_FrechetDistance()</code></a></th>
<td>
      ジオメトリ間の離散フレシェ距離
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash()</code></a></th>
<td>
      geohash 値を生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromText()</code>, <code class="literal">ST_GeometryCollectionFromText()</code>, <code class="literal">ST_GeomCollFromTxt()</code></a></th>
<td>
      WKT からジオメトリコレクションを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeomCollFromWKB()</code>, <code class="literal">ST_GeometryCollectionFromWKB()</code></a></th>
<td>
      WKB からジオメトリコレクションを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN()</code></a></th>
<td>
      ジオメトリコレクションから N 番目のジオメトリを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType()</code></a></th>
<td>
      ジオメトリ型の名前を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON()</code></a></th>
<td>
      GeoJSON オブジェクトからジオメトリを生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code>, <code class="literal">ST_GeometryFromText()</code></a></th>
<td>
      WKT からジオメトリを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB()</code>, <code class="literal">ST_GeometryFromWKB()</code></a></th>
<td>
      WKB からジオメトリを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-hausdorffdistance"><code class="literal">ST_HausdorffDistance()</code></a></th>
<td>
      ジオメトリ間の離散ハスドルフ距離
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN()</code></a></th>
<td>
      Polygon の N 番目の内側のリングを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></th>
<td>
      2 つのジオメトリの点集合の積集合を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></th>
<td>
      あるジオメトリが別のジオメトリと交差しているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a></th>
<td>
      ジオメトリが閉じていて単純かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty()</code></a></th>
<td>
      ジオメトリが空かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a></th>
<td>
      ジオメトリが単純かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a></th>
<td>
      ジオメトリが有効かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a></th>
<td>
      geohash 値から緯度を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a></th>
<td>
      点の緯度を返します
    </td>
<td>8.0.12</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a></th>
<td>
      LineString の長さを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineFromText()</code>, <code class="literal">ST_LineStringFromText()</code></a></th>
<td>
      WKT から LineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineFromWKB()</code>, <code class="literal">ST_LineStringFromWKB()</code></a></th>
<td>
      WKB から LineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-lineinterpolatepoint"><code class="literal">ST_LineInterpolatePoint()</code></a></th>
<td>
      LineString に沿った特定のパーセンテージのポイント
    </td>
<td>8.0.24</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-lineinterpolatepoints"><code class="literal">ST_LineInterpolatePoints()</code></a></th>
<td>
      LineString に沿って指定された割合をポイント
    </td>
<td>8.0.24</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a></th>
<td>
      geohash 値から経度を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a></th>
<td>
      点の経度を返します
    </td>
<td>8.0.12</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a></th>
<td>
      2 点周りの長方形
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MLineFromText()</code>, <code class="literal">ST_MultiLineStringFromText()</code></a></th>
<td>
      WKT から MultiLineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MLineFromWKB()</code>, <code class="literal">ST_MultiLineStringFromWKB()</code></a></th>
<td>
      WKB から MultiLineString を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText()</code>, <code class="literal">ST_MultiPointFromText()</code></a></th>
<td>
      WKT から MultiPoint を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MPointFromWKB()</code>, <code class="literal">ST_MultiPointFromWKB()</code></a></th>
<td>
      WKB から MultiPoint を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MPolyFromText()</code>, <code class="literal">ST_MultiPolygonFromText()</code></a></th>
<td>
      WKT から MultiPolygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MPolyFromWKB()</code>, <code class="literal">ST_MultiPolygonFromWKB()</code></a></th>
<td>
      WKB から MultiPolygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries()</code></a></th>
<td>
      ジオメトリコレクション内のジオメトリ数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing()</code>, <code class="literal">ST_NumInteriorRings()</code></a></th>
<td>
      Polygon 内の内側のリング数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints()</code></a></th>
<td>
      LineString 内の Point の数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></th>
<td>
      あるジオメトリが別のジオメトリとオーバーラップしているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointatdistance"><code class="literal">ST_PointAtDistance()</code></a></th>
<td>
      LineString に沿った特定の距離の点
    </td>
<td>8.0.24</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a></th>
<td>
      geohash 値を POINT 値に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText()</code></a></th>
<td>
      WKT から Point を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB()</code></a></th>
<td>
      WKB から Point を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN()</code></a></th>
<td>
      LineString から N 番目の Point を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolyFromText()</code>, <code class="literal">ST_PolygonFromText()</code></a></th>
<td>
      WKT から Polygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolyFromWKB()</code>, <code class="literal">ST_PolygonFromWKB()</code></a></th>
<td>
      WKB から Polygon を構築します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify()</code></a></th>
<td>
      簡略化されたジオメトリを返す
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a></th>
<td>
      ジオメトリの空間参照システム ID を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a></th>
<td>
      LineString の始点
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY()</code></a></th>
<td>
      X/Y 座標が入れ替えられた引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></th>
<td>
      2 つのジオメトリの点集合の対称差を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></th>
<td>
      あるジオメトリが別のジオメトリに接しているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a></th>
<td>
      ジオメトリの座標を変換
    </td>
<td>8.0.13</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></th>
<td>
      2 つのジオメトリの点集合の和集合を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a></th>
<td>
      検証済ジオメトリを戻します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></th>
<td>
      あるジオメトリが別のジオメトリの内部にあるかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a></th>
<td>
      Point の X 座標を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a></th>
<td>
      Point の Y 座標を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a></th>
<td>
      ステートメントダイジェストハッシュ値の計算
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a></th>
<td>
      正規化されたステートメントダイジェストの計算
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></th>
<td>
      母標準偏差を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></th>
<td>
      母標準偏差を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></th>
<td>
      母標準偏差を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></th>
<td>
      標本標準偏差を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></th>
<td>
      文字列を日付に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></th>
<td>
      2 つの文字列を比較します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></th>
<td>
      3 つの引数で呼び出されるときは DATE_SUB() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></th>
<td>
      指定された部分文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></th>
<td>
      指定された部分文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></th>
<td>
      文字列から、区切り文字が指定された回数出現する前の部分文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></th>
<td>
      時間の差を求めます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></th>
<td>
      集計を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></th>
<td>
      この関数が実行される時間を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></th>
<td>
      USER() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></th>
<td>
      引数のタンジェントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></th>
<td>
      渡された式の時部分を抽出します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></th>
<td>
      時間として書式設定します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></th>
<td>
      秒に変換された引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></th>
<td>
      時間の差を求めます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></th>
<td>
      引数が 1 つの場合、この関数は日付または日付時間式を返します。引数が 2 つの場合、引数の合計を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></th>
<td>
      日付時間式に間隔を加算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></th>
<td>
      日付時間式から間隔を減算します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></th>
<td>
      base 64 文字列に変換された引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></th>
<td>
      日に変換された日付引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></th>
<td>
      0 年以降の秒数に変換された日付または日付時間引数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></th>
<td>
      先頭と末尾にある空白を削除します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></th>
<td>
      指定された小数点以下の桁数に切り捨てます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></th>
<td>
      UPPER() のシノニムです
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></th>
<td>
      圧縮された文字列を圧縮解除します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></th>
<td>
      圧縮前の文字列長を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></th>
<td>
      数値の 16 進数表現を含む文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></th>
<td>
      Unix タイムスタンプを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></th>
<td>
      置換後 XML フラグメントを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></th>
<td>
      大文字に変換します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></th>
<td>
      ユーザー名と、クライアントによって提供されるホスト名です
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></th>
<td>
      現在の UTC 日付を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></th>
<td>
      現在の UTC 時間を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></th>
<td>
      現在の UTC 日付と時間を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></th>
<td>
      ユニバーサル固有識別子 (UUID) を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></th>
<td>
      整数値のユニバーサル識別子を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a></th>
<td>
      文字列 UUID をバイナリに変換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></th>
<td>
      パスワードの強度を判断します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></th>
<td>
      INSERT 中に使用する値の定義
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></th>
<td>
      母標準分散を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></th>
<td>
      標本分散を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></th>
<td>
      母標準分散を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></th>
<td>
      MySQL サーバーのバージョンを示す文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_wait-for-executed-gtid-set"><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code></a></th>
<td>
      指定された GTID がレプリカで実行されるまで待機します。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></th>
<td>
      <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code> の使用。
    </td>
<td></td>
<td>8.0.18</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></th>
<td>
      週番号を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></th>
<td>
      曜日インデックスを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></th>
<td>
      日付の暦週を返します (1 - 53)
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></th>
<td>
      文字列の重み文字列を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></th>
<td>
      論理 XOR
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></th>
<td>
      年を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></th>
<td>
      年と週を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></th>
<td>
      ビット単位の OR
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></th>
<td>
      ビット単位の反転
    </td>
<td></td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="loadable-function-reference"></a>12.2 ユーザー定義関数参照</h2></div></div></div><a class="indexterm" name="idm46041628517088"></a><p>
      次のテーブルに、各ユーザー定義関数を示し、それぞれについて簡単に説明します。 SQL 関数および演算子を示すテーブルは、<a class="xref" href="functions.html#built-in-function-reference" title="12.1 SQL 関数および演算子リファレンス">セクション12.1「SQL 関数および演算子リファレンス」</a> を参照してください 
    </p><p>
      ユーザー定義関数の一般情報は、<a class="xref" href="server-administration.html#server-loadable-functions" title="5.7 MySQL Server のユーザー定義関数">セクション5.7「MySQL Server のユーザー定義関数」</a> を参照してください。
    </p><div class="table"><a name="idm46041628511920"></a><p class="title"><b>表 12.2 「ユーザー定義関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「すべてのユーザー定義関数をリストする参照。」"><col style="width: 22%"><col style="width: 55%"><col style="width: 11%"><col style="width: 11%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
<th>非推奨</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="security.html#function_asymmetric-decrypt"><code class="literal">asymmetric_decrypt()</code></a></th>
<td>
      秘密鍵または公開鍵を使用して暗号文を復号化します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_asymmetric-derive"><code class="literal">asymmetric_derive()</code></a></th>
<td>
      非対称鍵から対称鍵を導出します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_asymmetric-encrypt"><code class="literal">asymmetric_encrypt()</code></a></th>
<td>
      秘密キーまたは公開キーを使用したクリアテキストの暗号化
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_asymmetric-sign"><code class="literal">asymmetric_sign()</code></a></th>
<td>
      ダイジェストから署名を生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_asymmetric-verify"><code class="literal">asymmetric_verify()</code></a></th>
<td>
      署名がダイジェストと一致することを確認します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_asynchronous-connection-failover-add-managed"><code class="literal">asynchronous_connection_failover_add_managed()</code></a></th>
<td>
      管理対象グループのレプリケーションソースサーバーをソースリストに追加
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_asynchronous-connection-failover-add-source"><code class="literal">asynchronous_connection_failover_add_source()</code></a></th>
<td>
      レプリケーションソースサーバーをソースリストに追加
    </td>
<td>8.0.22</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_asynchronous-connection-failover-delete-managed"><code class="literal">asynchronous_connection_failover_delete_managed()</code></a></th>
<td>
      ソースリストからのレプリケーションサーバーの管理対象グループの削除
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_asynchronous-connection-failover-delete-source"><code class="literal">asynchronous_connection_failover_delete_source()</code></a></th>
<td>
      ソースリストからのレプリケーションソースサーバーの削除
    </td>
<td>8.0.22</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-api-message-emit-udf"><code class="literal">audit_api_message_emit_udf()</code></a></th>
<td>
      監査ログへのメッセージイベントの追加
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-encryption-password-get"><code class="literal">audit_log_encryption_password_get()</code></a></th>
<td>
      監査ログ暗号化パスワードのフェッチ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-encryption-password-set"><code class="literal">audit_log_encryption_password_set()</code></a></th>
<td>
      監査ログの暗号化パスワードの設定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-filter-flush"><code class="literal">audit_log_filter_flush()</code></a></th>
<td>
      監査ログフィルタテーブルのフラッシュ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-filter-remove-filter"><code class="literal">audit_log_filter_remove_filter()</code></a></th>
<td>
      監査ログフィルタの削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-filter-remove-user"><code class="literal">audit_log_filter_remove_user()</code></a></th>
<td>
      ユーザーからの監査ログフィルタの割当て解除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-filter-set-filter"><code class="literal">audit_log_filter_set_filter()</code></a></th>
<td>
      監査ログフィルタの定義
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-filter-set-user"><code class="literal">audit_log_filter_set_user()</code></a></th>
<td>
      ユーザーへの監査ログフィルタの割当て
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-read"><code class="literal">audit_log_read()</code></a></th>
<td>
      監査ログレコードを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_audit-log-read-bookmark"><code class="literal">audit_log_read_bookmark()</code></a></th>
<td>
      最新の監査ログイベントのブックマーク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_create-asymmetric-priv-key"><code class="literal">create_asymmetric_priv_key()</code></a></th>
<td>
      秘密鍵を作成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_create-asymmetric-pub-key"><code class="literal">create_asymmetric_pub_key()</code></a></th>
<td>
      公開鍵を作成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_create-dh-parameters"><code class="literal">create_dh_parameters()</code></a></th>
<td>
      共有 DH シークレットを生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_create-digest"><code class="literal">create_digest()</code></a></th>
<td>
      文字列からダイジェストを生成します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_firewall-group-delist"><code class="literal">firewall_group_delist()</code></a></th>
<td>
      ファイアウォールグループプロファイルからアカウントを削除
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_firewall-group-enlist"><code class="literal">firewall_group_enlist()</code></a></th>
<td>
      ファイアウォールグループプロファイルにアカウントを追加
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-blacklist"><code class="literal">gen_blacklist()</code></a></th>
<td>
      辞書用語置換の実行
    </td>
<td></td>
<td>8.0.23</td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-blocklist"><code class="literal">gen_blocklist()</code></a></th>
<td>
      辞書用語置換の実行
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-dictionary"><code class="literal">gen_dictionary()</code></a></th>
<td>
      辞書からランダムな用語を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-dictionary-drop"><code class="literal">gen_dictionary_drop()</code></a></th>
<td>
      レジストリからディクショナリを削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-dictionary-load"><code class="literal">gen_dictionary_load()</code></a></th>
<td>
      ディクショナリをレジストリにロード
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-range"><code class="literal">gen_range()</code></a></th>
<td>
      範囲内の乱数を生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-rnd-email"><code class="literal">gen_rnd_email()</code></a></th>
<td>
      ランダムな電子メールアドレスの生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-rnd-pan"><code class="literal">gen_rnd_pan()</code></a></th>
<td>
      ランダム支払カードプライマリアカウント番号の生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-rnd-ssn"><code class="literal">gen_rnd_ssn()</code></a></th>
<td>
      ランダム US 社会保障番号の生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_gen-rnd-us-phone"><code class="literal">gen_rnd_us_phone()</code></a></th>
<td>
      ランダムな米国電話番号の生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-get-communication-protocol"><code class="literal">group_replication_get_communication_protocol()</code></a></th>
<td>
      Group Replication プロトコルバージョンを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-get-write-concurrency"><code class="literal">group_replication_get_write_concurrency()</code></a></th>
<td>
      パラレルで実行可能なコンセンサスインスタンスの最大数を返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-set-as-primary"><code class="literal">group_replication_set_as_primary()</code></a></th>
<td>
      グループメンバーを新規プライマリとして割り当てます
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-set-communication-protocol"><code class="literal">group_replication_set_communication_protocol()</code></a></th>
<td>
      グループレプリケーションプロトコルバージョンの設定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-set-write-concurrency"><code class="literal">group_replication_set_write_concurrency()</code></a></th>
<td>
      コンセンサスインスタンスの最大実行可能数をパラレルに設定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-switch-to-multi-primary-mode"><code class="literal">group_replication_switch_to_multi_primary_mode()</code></a></th>
<td>
      単一プライマリモードからマルチプライマリモードへのグループの変更
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="sql-statements.html#function_group-replication-switch-to-single-primary-mode"><code class="literal">group_replication_switch_to_single_primary_mode()</code></a></th>
<td>
      マルチプライマリモードからシングルプライマリモードへのグループの変更
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-aws-rotate-cmk"><code class="literal">keyring_aws_rotate_cmk()</code></a></th>
<td>
      AWS 顧客マスターキーのローテーション
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-aws-rotate-keys"><code class="literal">keyring_aws_rotate_keys()</code></a></th>
<td>
      keyring_aws
      ストレージファイル内のキーのローテーション
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-hashicorp-update-config"><code class="literal">keyring_hashicorp_update_config()</code></a></th>
<td>
      ランタイム keyring_hashicorp 再構成の原因
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-fetch"><code class="literal">keyring_key_fetch()</code></a></th>
<td>
      キーリングキー値のフェッチ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-generate"><code class="literal">keyring_key_generate()</code></a></th>
<td>
      ランダムキーリングキーの生成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-length-fetch"><code class="literal">keyring_key_length_fetch()</code></a></th>
<td>
      鍵リング鍵の長さを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-remove"><code class="literal">keyring_key_remove()</code></a></th>
<td>
      キーリングキーの削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-store"><code class="literal">keyring_key_store()</code></a></th>
<td>
      キーリングにキーを格納
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_keyring-key-type-fetch"><code class="literal">keyring_key_type_fetch()</code></a></th>
<td>
      キーリングキータイプを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_load-rewrite-rules"><code class="literal">load_rewrite_rules()</code></a></th>
<td>
      リライタプラグインヘルパールーチン
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mask-inner"><code class="literal">mask_inner()</code></a></th>
<td>
      文字列の内部部分のマスク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mask-outer"><code class="literal">mask_outer()</code></a></th>
<td>
      文字列の左右の部分をマスク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mask-pan"><code class="literal">mask_pan()</code></a></th>
<td>
      文字列の支払カードプライマリアカウント番号部分のマスク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mask-pan-relaxed"><code class="literal">mask_pan_relaxed()</code></a></th>
<td>
      文字列の支払カードプライマリアカウント番号部分のマスク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mask-ssn"><code class="literal">mask_ssn()</code></a></th>
<td>
      US 社会保障番号のマスク
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_mysql-firewall-flush-status"><code class="literal">mysql_firewall_flush_status()</code></a></th>
<td>
      ファイアウォールステータス変数のリセット
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="language-structure.html#function_mysql-query-attribute-string"><code class="literal">mysql_query_attribute_string()</code></a></th>
<td>
      クエリー属性値のフェッチ
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_normalize-statement"><code class="literal">normalize_statement()</code></a></th>
<td>
      ダイジェスト形式への SQL
      ステートメントの正規化
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_read-firewall-group-allowlist"><code class="literal">read_firewall_group_allowlist()</code></a></th>
<td>
      ファイアウォールグループプロファイルの記録されたステートメントキャッシュの更新
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_read-firewall-groups"><code class="literal">read_firewall_groups()</code></a></th>
<td>
      ファイアウォールグループプロファイルキャッシュの更新
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_read-firewall-users"><code class="literal">read_firewall_users()</code></a></th>
<td>
      ファイアウォールアカウントプロファイルキャッシュの更新
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_read-firewall-whitelist"><code class="literal">read_firewall_whitelist()</code></a></th>
<td>
      ファイアウォールアカウントプロファイルの記録ステートメントキャッシュの更新
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_service-get-read-locks"><code class="literal">service_get_read_locks()</code></a></th>
<td>
      ロックサービス共有ロックの取得
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_service-get-write-locks"><code class="literal">service_get_write_locks()</code></a></th>
<td>
      ロックサービス排他ロックの取得
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_service-release-locks"><code class="literal">service_release_locks()</code></a></th>
<td>
      ロックサービスロックの解放
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_set-firewall-group-mode"><code class="literal">set_firewall_group_mode()</code></a></th>
<td>
      ファイアウォールグループプロファイルの動作モードを確立
    </td>
<td>8.0.23</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="security.html#function_set-firewall-mode"><code class="literal">set_firewall_mode()</code></a></th>
<td>
      ファイアウォールアカウントプロファイル操作モードの確立
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-delete"><code class="literal">version_tokens_delete()</code></a></th>
<td>
      バージョントークンリストからのトークンの削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-edit"><code class="literal">version_tokens_edit()</code></a></th>
<td>
      バージョントークンリストの変更
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-lock-exclusive"><code class="literal">version_tokens_lock_exclusive()</code></a></th>
<td>
      バージョントークンの排他ロックの取得
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-lock-shared"><code class="literal">version_tokens_lock_shared()</code></a></th>
<td>
      バージョントークンの共有ロックの取得
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-set"><code class="literal">version_tokens_set()</code></a></th>
<td>
      バージョントークンリストの設定
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-show"><code class="literal">version_tokens_show()</code></a></th>
<td>
      バージョントークンリストを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="server-administration.html#function_version-tokens-unlock"><code class="literal">version_tokens_unlock()</code></a></th>
<td>
      バージョントークンロックの解放
    </td>
<td></td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="type-conversion"></a>12.3 式評価での型変換</h2></div></div></div><a class="indexterm" name="idm46041628124880"></a><a class="indexterm" name="idm46041628123456"></a><p>
      演算子が別の型のオペランドとともに使用されると、オペランドの互換性を保つために型変換が発生します。 一部の変換は暗黙的に発生します。 たとえば、MySQL は必要に応じて文字列を数値に自動的に変換し、その逆も行います。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1+'1';</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(2,' test');</code></strong>
        -&gt; '2 test'
</pre><p>
      また、<code class="literal">CAST()</code> 関数を明示的に使用して、数字を文字列に変換することもできます。 <code class="literal">CONCAT()</code> 関数では文字列の引数が要求されるため、使用すると暗黙的に変換が発生します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 38.8, CAST(38.8 AS CHAR);</code></strong>
        -&gt; 38.8, '38.8'
mysql&gt; <strong class="userinput"><code>SELECT 38.8, CONCAT(38.8);</code></strong>
        -&gt; 38.8, '38.8'
</pre><p>
      文字セットの数字から文字列への暗黙的な変換について、および <code class="literal">CREATE TABLE ... SELECT</code> ステートメントに適用される変更済みのルールについては、このセクションの後半を参照してください。
    </p><p>
      次のルールでは、比較演算の際にどのように変換が発生するのかについて説明します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">NULL</code>-safe <code class="literal">&lt;=&gt;</code> 等価比較演算子の場合を除いて、一方または両方の引数が <code class="literal">NULL</code> の場合は、比較の結果も <code class="literal">NULL</code> になります。 <code class="literal">NULL &lt;=&gt; NULL</code> の場合は、結果が true になります。 変換は必要ありません。 
        </p></li><li class="listitem"><p>
          比較演算の両方の引数が文字列の場合は、文字列として比較されます。
        </p></li><li class="listitem"><p>
          両方の引数が整数の場合は、整数として比較されます。
        </p></li><li class="listitem"><p>
          16 進値が数字と比較されない場合は、バイナリ文字列として処理されます。
        </p></li><li class="listitem"><p>
          いずれかの引数が <code class="literal">TIMESTAMP</code> カラムまたは <code class="literal">DATETIME</code> カラムで、もう一方の引数が定数の場合、定数は比較が実行される前にタイムスタンプに変換されます。 これは、ODBC により適合させるために実行されます。 これは、<code class="literal">IN()</code> への引数には実行されません。 念のため、比較を行う際は、常に完全な日付時間、日付、または時間文字列を使用してください。 たとえば、日付または時間の値とともに <code class="literal">BETWEEN</code> を使用したときの結果を最適にするには、<code class="literal">CAST()</code> を使用して、明示的に値を目的のデータ型に変換します。 
        </p><p>
          テーブル (複数可) からの単一行のサブクエリーは、定数とみなされません。 たとえば、サブクエリーで <code class="literal">DATETIME</code> 値と比較される整数が返される場合は、比較が 2 つの整数として実行されます。 整数は時間値には変換されません。 オペランドを <code class="literal">DATETIME</code> 値として比較するには、<code class="literal">CAST()</code> を使用して、明示的にサブクエリーの値を <code class="literal">DATETIME</code> に変換します。 
        </p><a class="indexterm" name="idm46041628090672"></a><a class="indexterm" name="idm46041628089200"></a></li><li class="listitem"><p>
          引数のいずれかが 10 進値の場合、比較はその他の引数に依存します。 その他の引数が 10 進値または整数値の場合、引数は 10 進値として比較され、その他の引数が浮動小数点値の場合、引数は浮動小数点値として比較されます。 
        </p></li><li class="listitem"><p>
          ほかのすべてのケースでは、引数は浮動小数点 (実) 数として比較されます。 たとえば、文字列オペランドと数値オペランドの比較は、浮動小数点数の比較として行われます。 
        </p></li></ul></div><p>
      別の時間型への値の変換については、<a class="xref" href="data-types.html#date-and-time-type-conversion" title="11.2.7 日付と時間型間での変換">セクション11.2.7「日付と時間型間での変換」</a>を参照してください。
    </p><p>
      JSON 値の比較は 2 つのレベルで行われます。 最初のレベルの比較は、比較された値の JSON 型に基づきます。 タイプが異なる場合、比較結果は優先順位の高いタイプによってのみ決定されます。 2 つの値が同じ JSON 型である場合、2 つ目のレベルの比較は型固有のルールを使用して行われます。 JSON 値と非 JSON 値を比較するために、非 JSON 値は JSON に変換され、値は JSON 値として比較されます。 詳細は、<a class="xref" href="data-types.html#json-comparison" title="JSON 値の比較および順序付け">JSON 値の比較および順序付け</a>を参照してください。 
    </p><p>
      次の例は、比較演算での文字列から数字への変換を示しています。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 &gt; '6x';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 7 &gt; '6x';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 0 &gt; 'x6';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 0 = 'x6';</code></strong>
        -&gt; 1
</pre><p>
      文字列カラムと数字との比較では、MySQL はカラム上のインデックスを使用して、値をすばやく検索できません。 <em class="replaceable"><code>str_col</code></em> がインデックスの付いた文字列カラムである場合は、次のステートメントで検索を実行するときに、そのインデックスを使用できません。 
    </p><pre class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>str_col</code></em>=1;
</pre><p>
      その理由は、<code class="literal">'1'</code>、<code class="literal">' 1'</code>、<code class="literal">'1a'</code> のように、値 <code class="literal">1</code> に変換できるさまざまな文字列があるためです。
    </p><p>
      整数は比較前に倍精度浮動小数点に変換されるため、浮動小数点数と <code class="literal">INTEGER</code> 型の大きい値との比較は概算されます。これは、すべての 64 ビット整数を正確に表現できないためです。 たとえば、整数値 2 <sup>53</sup>+ 1 は float として表現できず、プラットフォームに応じて float 比較の前に 2 <sup>53</sup> または 2 <sup>53</sup>+ 2 に丸められます。 
    </p><p>
      説明するために、次の比較のうち最初の比較では等しい値のみが比較されますが、両方の比較で true (1) が返されます:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '9223372036854775807' = 9223372036854775807;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '9223372036854775807' = 9223372036854775806;</code></strong>
        -&gt; 1
</pre><p>
      文字列から浮動小数点への変換および整数から浮動小数点への変換が行われる場合、必ずしも同じように行われるとはかぎりません。 整数は、CPU によって浮動小数点に変換される可能性があります。一方、文字列は、浮動小数点の乗算を伴う演算で 1 桁ずつ変換されます。 また、結果は、コンピュータアーキテクチャ、コンパイラのバージョン、最適化レベルなどの要因の影響を受ける可能性があります。 このような問題を回避する方法の 1 つは、値が暗黙的に浮動小数点値に変換されないように、<code class="literal">CAST()</code> を使用することです。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CAST('9223372036854775807' AS UNSIGNED) = 9223372036854775806;</code></strong>
        -&gt; 0
</pre><p>
      浮動小数点の比較についての詳細は、<a class="xref" href="error-handling.html#problems-with-float" title="B.3.4.8 浮動小数点値に関する問題">セクションB.3.4.8「浮動小数点値に関する問題」</a>を参照してください。
    </p><p>
      サーバーには、文字列または <code class="literal">DECIMAL</code> の値と概算値 (<code class="literal">FLOAT</code>/<code class="literal">DOUBLE</code>) の数値との間の変換を改善するための基準を提供する変換ライブラリである <code class="literal">dtoa</code> が含まれています:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Unix と Windows 間の変換の相違などが除去された、プラットフォーム間で整合性のある変換結果。
        </p></li><li class="listitem"><p>
          以前の結果に十分な精度がなかった場合 (IEEE の制限に近い値など) の正確な値の表示。
        </p></li><li class="listitem"><p>
          最大限の精度を持つ文字列書式への数字の変換。 <code class="literal">dtoa</code> の精度は、常に標準の C ライブラリ関数の精度と同じか、それ以上です。 
        </p></li></ul></div><p>
      このライブラリで生成された変換は、<code class="literal">dtoa</code> 以外の結果とは異なる場合があるため、以前の結果に依存するアプリケーションとの互換性が保たれない可能性があります。 たとえば、以前の変換からの特定の正確な結果に依存するアプリケーションでは、追加の精度に対応するように調整が必要となる場合があります。 
    </p><p>
      <code class="literal">dtoa</code> ライブラリでは、次のプロパティーを使用した変換が提供されます。 <em class="replaceable"><code>D</code></em> は <code class="literal">DECIMAL</code> または文字列表現を含む値を表し、<em class="replaceable"><code>F</code></em> はネイティブバイナリ (IEEE) 書式の浮動小数点数を表します。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> の変換は、最大限の精度で実行され、読み取り時に <em class="replaceable"><code>F</code></em> が生成されるもっとも短い文字列として <em class="replaceable"><code>D</code></em> が返され、IEEE で指定されているネイティブバイナリ形式でもっとも近い値に丸められます。
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> の変換は、<em class="replaceable"><code>F</code></em> が入力された 10 進文字列 <em class="replaceable"><code>D</code></em> にもっとも近いネイティブバイナリの数字になるように実行されます。
        </p></li></ul></div><p>
      <em class="replaceable"><code>F</code></em> が <code class="literal">-inf</code>、<code class="literal">+inf</code>、または <code class="literal">NaN</code> の場合を除いて、これらのプロパティーは、<em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> の変換が可逆であることを暗黙的に示しています。 後者の値は、SQL 標準では <code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code> の無効な値として定義されているため、サポートされていません。 
    </p><p>
      <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> の変換では、<em class="replaceable"><code>D</code></em> が 15 桁以下の精度を使用し、非正規値 (<code class="literal">-inf</code>、<code class="literal">+inf</code>、または <code class="literal">NaN</code>) でないことが可逆のための十分な条件となります。 <em class="replaceable"><code>D</code></em> の精度が 15 桁よりも大きい場合でも、変換が可逆であるケースもありますが、常に該当するとはかぎりません。 
    </p><p>
      数値または時間値を文字列に暗黙的に変換すると、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数によって決定された文字セットと照合順序を持つ値が生成されます。 (一般に、これらの変数は <code class="literal">SET NAMES</code> を使用して設定されます。 接続文字セットについては、<a class="xref" href="charset.html#charset-connection" title="10.4 接続文字セットおよび照合順序">セクション10.4「接続文字セットおよび照合順序」</a>を参照してください。) 
    </p><p>
      つまり、接続文字セットが <code class="literal">binary</code> に設定されている場合を除いて、このような変換では、(非バイナリ) 文字列 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、または <code class="literal">LONGTEXT</code> 値) が生成されます。 この場合、変換の結果はバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、または <code class="literal">LONGBLOB</code> 値) になります。 
    </p><p>
      整数式では、式の<span class="emphasis"><em>評価</em></span>に関する上記の備考は、式の<span class="emphasis"><em>割り当て</em></span>には多少異なる方法で適用されます。次のようなステートメントでの例を示します。
    </p><pre class="programlisting">CREATE TABLE t SELECT <em class="replaceable"><code>integer_expr</code></em>;
</pre><p>
      この場合、式の結果として生成されるカラム内のテーブルの型は、整数式の長さに応じて、<code class="literal">INT</code> または <code class="literal">BIGINT</code> になります。 式の最大長が <code class="literal">INT</code> に収まらない場合は、代わりに <code class="literal">BIGINT</code> が使用されます。 長さは、<code class="literal">SELECT</code> 結果セットメタデータの <code class="literal">max_length</code> 値から取得されます (<a class="ulink" href="https://dev.mysql.com/doc/c-api/8.0/en/c-api-data-structures.html" target="_top">C API Basic Data Structures</a>を参照してください)。 つまり、十分に長い式を使用することで、<code class="literal">INT</code> ではなく、<code class="literal">BIGINT</code> を強制的に適用できます。 
    </p><pre class="programlisting">CREATE TABLE t SELECT 000000000000000000000;
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="non-typed-operators"></a>12.4 演算子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#operator-precedence">12.4.1 演算子の優先順位</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.4.2 比較関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.4.3 論理演算子</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.4.4 割り当て演算子</a></span></dt></dl></div><div class="table"><a name="idm46041627999456"></a><p class="title"><b>表 12.3 「演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「すべての演算子をリストする参照。」"><col style="width: 25%"><col style="width: 62%"><col style="width: 12%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></th>
<td>
      ビット単位の AND
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></th>
<td>
      右不等 (より多い) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></th>
<td>
      右シフト
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></th>
<td>
      以上 (より多いか等しい) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></th>
<td>
      左不等 (より少ない) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">&lt;&gt;</code>, <code class="literal">!=</code></a></th>
<td>
      不等価 (等しくない) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></th>
<td>
      左シフト
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></th>
<td>
      以下 (より少ないか等しい) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=</code></a></th>
<td>
      NULL 安全等価演算子
    </td>
<td></td>
</tr><tr><th scope="row"><code class="literal">%</code>, <code class="literal">MOD</code></th>
<td>
      モジュロ演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></th>
<td>
      乗算演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></th>
<td>
      加算演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></th>
<td>
      減算演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></th>
<td>
      引数の符号を変更します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></th>
<td>
      パスを評価した後の JSON カラムからの戻り値 (JSON_EXTRACT() と同等)。
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></th>
<td>
      パスを評価して結果を引用符で囲まずに JSON カラムから値を返します (JSON_UNQUOTE(JSON_EXTRACT() と同等)。
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></th>
<td>
      除算演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></th>
<td>
      値を割り当てます
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></th>
<td>
      (<code class="literal">SET</code> ステートメントの一部として、または <code class="literal">UPDATE</code> ステートメントの <code class="literal">SET</code> 句の一部として) 値を割り当てます
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></th>
<td>
      等価 (等しい) 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></th>
<td>
      ビット単位の XOR
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></th>
<td>
      論理 AND
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></th>
<td>
      値が値の範囲内にあるかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></th>
<td>
      文字列をバイナリ文字列にキャストします
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></th>
<td>
      CASE 演算子
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></th>
<td>
      整数除算
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></th>
<td>
      値が値セット内にあるかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></th>
<td>
      ブーリアンに対して値をテストします
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></th>
<td>
      ブーリアンに対して値をテストします
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></th>
<td>
      NOT NULL 値テスト
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></th>
<td>
      NULL 値テスト
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></th>
<td>
      単純なパターン一致
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></th>
<td>
      最初のオペランドが 2 番目のオペランドとして渡された JSON 配列のいずれかの要素と一致する場合は true (1) を返し、それ以外の場合は false (0) を返します
    </td>
<td>8.0.17</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></th>
<td>
      値を否定します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></th>
<td>
      値が値の範囲内にないかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></th>
<td>
      値が値セット内にないかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></th>
<td>
      単純なパターン一致の否定
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></th>
<td>
      REGEXP の否定
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></th>
<td>
      論理 OR
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></th>
<td>
      文字列が正規表現と一致するかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><code class="literal">RLIKE</code></th>
<td>
      文字列が正規表現と一致するかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></th>
<td>
      音声を比較します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></th>
<td>
      論理 XOR
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></th>
<td>
      ビット単位の OR
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></th>
<td>
      ビット単位の反転
    </td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="operator-precedence"></a>12.4.1 演算子の優先順位</h3></div></div></div><a class="indexterm" name="idm46041627804992"></a><a class="indexterm" name="idm46041627802864"></a><p>
        次のリストには、演算子の優先順位をもっとも高いものから順番に示しています。 同じ行に並んで記載されている演算子は、優先順位が同じものです。 
      </p><pre class="programlisting">INTERVAL
BINARY, COLLATE
!
- (unary minus), ~ (unary bit inversion)
^
*, /, DIV, %, MOD
-, +
&lt;&lt;, &gt;&gt;
&amp;
|
= (comparison), &lt;=&gt;, &gt;=, &gt;, &lt;=, &lt;, &lt;&gt;, !=, IS, LIKE, REGEXP, IN, MEMBER OF
BETWEEN, CASE, WHEN, THEN, ELSE
NOT
AND, &amp;&amp;
XOR
OR, ||
= (assignment), :=
</pre><p>
        <code class="literal">=</code> の優先順位は、比較演算子 (<code class="literal">=</code>) として使用されるのか、割り当て演算子 (<code class="literal">=</code>) として使用されるのかによって異なります。 比較演算子として使用する場合、<code class="literal">&lt;=&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&lt;</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">!=</code>, <code class="literal">IS</code>, <code class="literal">LIKE</code>, <code class="literal">REGEXP</code> および <code class="literal">IN()</code> と同じ優先順位を持ちます。 割り当て演算子として使用される場合は、優先順位が <code class="literal">:=</code> と同じです。<a class="xref" href="sql-statements.html#set-variable" title="13.7.6.1 変数代入の SET 構文">セクション13.7.6.1「変数代入の SET 構文」</a>および<a class="xref" href="language-structure.html#user-variables" title="9.4 ユーザー定義変数">セクション9.4「ユーザー定義変数」</a>では、適用される <code class="literal">=</code> の解釈が MySQL でどのように決定されるのかについて説明されています。 
      </p><p>
        式内で同じ優先順位レベルで発生する演算子の場合、評価は左から右に進みますが、割当てが右から左に評価される点が異なります。
      </p><p>
        一部の演算子の優先順位と意味は、SQL モードによって異なります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            デフォルトでは、<code class="literal">||</code> は論理 <code class="literal">OR</code> 演算子です。 <code class="literal">PIPES_AS_CONCAT</code> が有効になっている場合は、<code class="literal">||</code> は <code class="literal">^</code> と単項演算子間の優先順位を持つ文字列連結です。 
          </p></li><li class="listitem"><p>
            デフォルトでは、<code class="literal">!</code> は <code class="literal">NOT</code> よりも高い優先順位です。 <code class="literal">HIGH_NOT_PRECEDENCE</code> が有効になっている場合は、<code class="literal">!</code> と <code class="literal">NOT</code> の優先順位は同じです。 
          </p></li></ul></div><p>
        <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 サーバー SQL モード">セクション5.1.11「サーバー SQL モード」</a>を参照してください。
      </p><a class="indexterm" name="idm46041627762976"></a><a class="indexterm" name="idm46041627761552"></a><a class="indexterm" name="idm46041627760208"></a><a class="indexterm" name="idm46041627758176"></a><p>
        演算子の優先順位によって、式の項の評価順序が決まります。 この順序をオーバーライドし、明示的に項をグループ化するには、丸括弧を使用します。 例: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1+2*3;</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT (1+2)*3;</code></strong>
        -&gt; 9
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="comparison-operators"></a>12.4.2 比較関数と演算子</h3></div></div></div><a class="indexterm" name="idm46041627751776"></a><div class="table"><a name="idm46041627750336"></a><p class="title"><b>表 12.4 「比較演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「比較演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td>
<td>
      右不等 (より多い) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td>
<td>
      以上 (より多いか等しい) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td>
<td>
      左不等 (より少ない) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-equal"><code class="literal">&lt;&gt;</code>, <code class="literal">!=</code></a></td>
<td>
      不等価 (等しくない) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td>
<td>
      以下 (より少ないか等しい) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=</code></a></td>
<td>
      NULL 安全等価演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td>
<td>
      等価 (等しい) 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td>
<td>
      値が値の範囲内にあるかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></td>
<td>
      NULL 以外の最初の引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></td>
<td>
      最大の引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></td>
<td>
      値が値セット内にあるかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></td>
<td>
      第 1 引数より小さい引数のインデックスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td>
<td>
      ブーリアンに対して値をテストします
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td>
<td>
      ブーリアンに対して値をテストします
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td>
<td>
      NOT NULL 値テスト
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td>
<td>
      NULL 値テスト
    </td>
</tr><tr><td><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></td>
<td>
      引数が NULL かどうかをテストします
    </td>
</tr><tr><td><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></td>
<td>
      最小の引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      単純なパターン一致
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td>
<td>
      値が値の範囲内にないかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></td>
<td>
      値が値セット内にないかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      単純なパターン一致の否定
    </td>
</tr><tr><td><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      2 つの文字列を比較します
    </td>
</tr></tbody></table></div></div><br class="table-break"><a class="indexterm" name="idm46041627673120"></a><a class="indexterm" name="idm46041627671664"></a><p>
        比較演算の結果は、<code class="literal">1</code> (<code class="literal">TRUE</code>)、<code class="literal">0</code> (<code class="literal">FALSE</code>)、または <code class="literal">NULL</code> の値になります。 これらの演算は、数字と文字列の両方で機能します。 必要に応じて、文字列は数字に、数字は文字列に自動的に変換されます。 
      </p><p>
        次の関係比較演算子を使用すれば、スカラーオペランドだけでなく行オペランドも比較できます。
      </p><pre class="programlisting">=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=
</pre><p>
        これらの演算子の詳細は、このセクションの後半で説明します。 行サブクエリーのコンテキストにおける行比較のその他の例は、<a class="xref" href="sql-statements.html#row-subqueries" title="13.2.11.5 行サブクエリー">セクション13.2.11.5「行サブクエリー」</a> を参照してください。 
      </p><p>
        このセクションで示す関数の一部では、<code class="literal">1</code> (<code class="literal">TRUE</code>)、<code class="literal">0</code> (<code class="literal">FALSE</code>)、または <code class="literal">NULL</code> 以外の値が返されます。 <code class="literal">LEAST()</code> および <code class="literal">GREATEST()</code> はこのような関数の例です。<a class="xref" href="functions.html#type-conversion" title="12.3 式評価での型変換">セクション12.3「式評価での型変換」</a> では、これらの関数と同様の関数によって実行される、戻り値を決定するための比較操作のルールについて説明しています。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          以前のバージョンの MySQL では、<code class="literal">LEAST()</code> または <code class="literal">GREATEST()</code> を含む式を評価するときに、サーバーは関数が使用されたコンテキストを推測し、関数の引数を式全体のデータ型に強制変換しようとしました。 たとえば、<code class="literal">LEAST("11", "45", "2")</code> の引数は文字列として評価およびソートされるため、この式は<code class="literal">"11"</code>を返します。 MySQL 8.0.3 以前では、式 <code class="literal">LEAST("11", "45", "2") + 0</code> を評価する際に、サーバーは引数をソートする前に整数に変換し (結果に整数 0 を追加することが予想されます)、2 を返します。 
        </p><p>
          MySQL 8.0.4 以降、サーバーはこの方法でコンテキストの推測を試行しなくなりました。 かわりに、関数は指定された引数を使用して実行され、すべて同じ型でない場合にのみ、1 つ以上の引数へのデータ型変換が実行されます。 戻り値を使用する式によって強制される型強制は、関数の実行後に実行されるようになりました。 つまり、MySQl 8.0.4 以降では、<code class="literal">LEAST("11", "45", "2") + 0</code> は<code class="literal">"11" + 0</code> と評価されるため、整数 11 になります。 (Bug #83895、Bug #25123839) 
        </p></div><p>
        <code class="literal">CAST()</code> 関数を使用すると、比較目的で値を特定の型に変換できます。 <code class="literal">CONVERT()</code> を使用すると、文字列値を別の文字セットに変換できます。 <a class="xref" href="functions.html#cast-functions" title="12.11 キャスト関数と演算子">セクション12.11「キャスト関数と演算子」</a>を参照してください。 
      </p><p>
        デフォルトでは、文字列比較では大/小文字は区別されず、現在の文字セットが使用されます。 デフォルトは <code class="literal">utf8mb4</code> です。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_equal"></a><p>
            <code class="literal">=</code>
          </p><a class="indexterm" name="idm46041627638176"></a><a class="indexterm" name="idm46041627636832"></a><p>
            等しい:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 = 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '0' = 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '0.0' = 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '0.01' = 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '.01' = 0.01;</code></strong>
        -&gt; 1
</pre><p>
            行の比較では、<code class="literal">(a, b) = (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a = x) AND (b = y)
</pre></li><li class="listitem"><a name="operator_equal-to"></a><p>
            <code class="literal">&lt;=&gt;</code>
          </p><a class="indexterm" name="idm46041627622928"></a><a class="indexterm" name="idm46041627620768"></a><p>
            <code class="literal">NULL</code> - 安全等価。 この演算子では、<code class="literal">=</code> 演算子のように等価比較が実行されますが、両方のオペランドが <code class="literal">NULL</code> であれば、<code class="literal">NULL</code> でなく <code class="literal">1</code> が返され、一方のオペランドが <code class="literal">NULL</code> の場合は、<code class="literal">NULL</code> でなく <code class="literal">0</code> が返されます。 
          </p><a class="indexterm" name="idm46041627611648"></a><p>
            <code class="literal">&lt;=&gt;</code> 演算子は、標準の SQL <code class="literal">IS NOT DISTINCT FROM</code> 演算子と同等です。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 &lt;=&gt; 1, NULL &lt;=&gt; NULL, 1 &lt;=&gt; NULL;</code></strong>
        -&gt; 1, 1, 0
mysql&gt; <strong class="userinput"><code>SELECT 1 = 1, NULL = NULL, 1 = NULL;</code></strong>
        -&gt; 1, NULL, NULL
</pre><p>
            行の比較では、<code class="literal">(a, b) &lt;=&gt; (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &lt;=&gt; x) AND (b &lt;=&gt; y)
</pre></li><li class="listitem"><a name="operator_not-equal"></a><p>
            <code class="literal">&lt;&gt;</code>, <code class="literal">!=</code>
          </p><a class="indexterm" name="idm46041627596704"></a><a class="indexterm" name="idm46041627595216"></a><a class="indexterm" name="idm46041627593856"></a><a class="indexterm" name="idm46041627592480"></a><p>
            等しくない:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '.01' &lt;&gt; '0.01';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT .01 &lt;&gt; '0.01';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'zapp' &lt;&gt; 'zappp';</code></strong>
        -&gt; 1
</pre><p>
            行の比較では、<code class="literal">(a, b) &lt;&gt; (x, y)</code> と <code class="literal">(a, b) != (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &lt;&gt; x) OR (b &lt;&gt; y)
</pre></li><li class="listitem"><a name="operator_less-than-or-equal"></a><p>
            <code class="literal">&lt;=</code>
          </p><a class="indexterm" name="idm46041627578256"></a><a class="indexterm" name="idm46041627576784"></a><p>
            より少ないか等しい:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 0.1 &lt;= 2;</code></strong>
        -&gt; 1
</pre><p>
            行の比較では、<code class="literal">(a, b) &lt;= (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &lt; x) OR ((a = x) AND (b &lt;= y))
</pre></li><li class="listitem"><a name="operator_less-than"></a><p>
            <code class="literal">&lt;</code>
          </p><a class="indexterm" name="idm46041627564768"></a><a class="indexterm" name="idm46041627563280"></a><p>
            より少ない:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &lt; 2;</code></strong>
        -&gt; 0
</pre><p>
            行の比較では、<code class="literal">(a, b) &lt; (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &lt; x) OR ((a = x) AND (b &lt; y))
</pre></li><li class="listitem"><a name="operator_greater-than-or-equal"></a><p>
            <code class="literal">&gt;=</code>
          </p><a class="indexterm" name="idm46041627551264"></a><a class="indexterm" name="idm46041627549792"></a><p>
            より多いか等しい:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &gt;= 2;</code></strong>
        -&gt; 1
</pre><p>
            行の比較では、<code class="literal">(a, b) &gt;= (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &gt; x) OR ((a = x) AND (b &gt;= y))
</pre></li><li class="listitem"><a name="operator_greater-than"></a><p>
            <code class="literal">&gt;</code>
          </p><a class="indexterm" name="idm46041627537808"></a><a class="indexterm" name="idm46041627536320"></a><p>
            より多い:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &gt; 2;</code></strong>
        -&gt; 0
</pre><p>
            行の比較では、<code class="literal">(a, b) &gt; (x, y)</code> は次と同等です:
          </p><pre class="programlisting">(a &gt; x) OR ((a = x) AND (b &gt; y))
</pre></li><li class="listitem"><a name="operator_between"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em></code>
          </p><a class="indexterm" name="idm46041627523328"></a><p>
            <em class="replaceable"><code>expr</code></em> が <em class="replaceable"><code>min</code></em> より多いか等しく、<em class="replaceable"><code>expr</code></em> が <em class="replaceable"><code>max</code></em> より少ないか等しい場合、<code class="literal">BETWEEN</code> は <code class="literal">1</code> を返し、それ以外では <code class="literal">0</code> を返します。 すべての引数の型が同じであれば、これは式 <code class="literal">(<em class="replaceable"><code>min</code></em> &lt;= <em class="replaceable"><code>expr</code></em> AND <em class="replaceable"><code>expr</code></em> &lt;= <em class="replaceable"><code>max</code></em>)</code> と同等です。 それ以外の場合は、<a class="xref" href="functions.html#type-conversion" title="12.3 式評価での型変換">セクション12.3「式評価での型変換」</a>に記載したルールに従って型変換が実行されますが、3 つのすべての引数に適用されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 1 AND 3, 2 BETWEEN 3 and 1;</code></strong>
        -&gt; 1, 0
mysql&gt; <strong class="userinput"><code>SELECT 1 BETWEEN 2 AND 3;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'b' BETWEEN 'a' AND 'c';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND '3';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND 'x-3';</code></strong>
        -&gt; 0
</pre><p>
            日付または時間の値とともに <code class="literal">BETWEEN</code> を使用したときの結果を最適にするには、<code class="literal">CAST()</code> を使用して明示的に値を目的のデータ型に変換します。 例 : <code class="literal">DATETIME</code> を 2 つの <code class="literal">DATE</code> 値と比較する場合は、<code class="literal">DATE</code> 値を <code class="literal">DATETIME</code> 値に変換します。 <code class="literal">DATE</code> との比較で <code class="literal">'2001-1-1'</code> などの文字列定数を使用する場合は、文字列を <code class="literal">DATE</code> にキャストします。 
          </p></li><li class="listitem"><a name="operator_not-between"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> NOT BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em></code>
          </p><a class="indexterm" name="idm46041627492176"></a><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em>)</code> と同じです。
          </p></li><li class="listitem"><a name="function_coalesce"></a><p>
            <code class="literal">COALESCE(<em class="replaceable"><code>value</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627482160"></a><a class="indexterm" name="idm46041627481072"></a><p>
            リストの最初の非 <code class="literal">NULL</code> 値を返します。非 <code class="literal">NULL</code> 値がない場合は、<code class="literal">NULL</code> を返します。
          </p><p>
            <code class="literal">COALESCE()</code> の戻り型は、引数型の集計型です。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,1);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,NULL,NULL);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_greatest"></a><p>
            <code class="literal">GREATEST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627465360"></a><p>
            2 つ以上の引数がある場合は、最大の (最大値の) 引数を返します。 引数は、<code class="literal">LEAST()</code> のルールと同じルールを使用して比較されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT GREATEST(2,0);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT GREATEST(34.0,3.0,5.0,767.0);</code></strong>
        -&gt; 767.0
mysql&gt; <strong class="userinput"><code>SELECT GREATEST('B','A','C');</code></strong>
        -&gt; 'C'
</pre><p>
            引数のいずれかが <code class="literal">NULL</code> である場合、<code class="literal">GREATEST()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="operator_in"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> IN (<em class="replaceable"><code>value</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627448864"></a><p>
            <em class="replaceable"><code>expr</code></em> が <code class="literal">IN()</code> リストのいずれかの値と等しい場合は <code class="literal">1</code> (true) を返し、それ以外の場合は <code class="literal">0</code> (false) を返します。
          </p><p>
            型変換は、<a class="xref" href="functions.html#type-conversion" title="12.3 式評価での型変換">セクション12.3「式評価での型変換」</a> で説明されているルールに従って行われ、すべての引数に適用されます。 <code class="literal">IN()</code> リストの値に型変換が必要ない場合、それらはすべて同じ型の <code class="literal">JSON</code> 以外の定数であり、<em class="replaceable"><code>expr</code></em> を同じ型の値として比較できます (型変換後の場合もあります)。 リストがソートされ、バイナリ検索を使用して <em class="replaceable"><code>expr</code></em> の検索が実行されるため、<code class="literal">IN()</code> 操作が非常に迅速になります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 IN (0,3,5,7);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'wefwf' IN ('wee','wefwf','weg');</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">IN()</code> を使用して、行コンストラクタを比較できます:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT (3,4) IN ((1,2), (3,4));</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT (3,4) IN ((1,2), (3,5));</code></strong>
        -&gt; 0
</pre><p>
            引用符で囲まれた値 (文字列など) と囲まれていない値 (数字など) の比較ルールは異なるため、<code class="literal">IN()</code> リストの引用符で囲まれた値と囲まれていない値を決して混同しないでください。 したがって、型を混同すると、整合性のない結果になる可能性があります。 たとえば、<code class="literal">IN()</code> 式を次のように記述しないでください。 
          </p><pre class="programlisting">SELECT val1 FROM tbl1 WHERE val1 IN (1,2,'a');
</pre><p>
            代わりに、次のように記述してください。
          </p><pre class="programlisting">SELECT val1 FROM tbl1 WHERE val1 IN ('1','2','a');
</pre><p>
            暗黙的な型変換では、直感的でない結果が生成される場合があります:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'a' IN (0), 0 IN ('b');</code></strong>
        -&gt; 1, 1
</pre><p>
            どちらの場合も、比較値は浮動小数点値に変換され、それぞれの場合に 0.0 が生成され、比較結果は 1 (true) になります。
          </p><p>
            <code class="literal">IN()</code> リストの値の数は、<code class="literal">max_allowed_packet</code> 値によってのみ制限されます。
          </p><p>
            SQL の標準に準拠するために、左側の式が <code class="literal">NULL</code> である場合だけでなく、リストに一致が見つからない場合やリストの式のいずれかが <code class="literal">NULL</code> である場合にも、<code class="literal">IN()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <code class="literal">IN()</code> 構文は、特定のタイプのサブクエリーを作成する際にも使用できます。 <a class="xref" href="sql-statements.html#any-in-some-subqueries" title="13.2.11.3 ANY、IN、または SOME を使用したサブクエリー">セクション13.2.11.3「ANY、IN、または SOME を使用したサブクエリー」</a>を参照してください。 
          </p></li><li class="listitem"><a name="operator_not-in"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> NOT IN (<em class="replaceable"><code>value</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627409632"></a><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> IN (<em class="replaceable"><code>value</code></em>,...))</code> と同じです。
          </p></li><li class="listitem"><a name="function_interval"></a><p>
            <code class="literal">INTERVAL(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>N1</code></em>,<em class="replaceable"><code>N2</code></em>,<em class="replaceable"><code>N3</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627398752"></a><p>
            <em class="replaceable"><code>N</code></em> &lt; <em class="replaceable"><code>N1</code></em> の場合は <code class="literal">0</code> を返し、<em class="replaceable"><code>N</code></em> &lt; <em class="replaceable"><code>N2</code></em> などの場合は <code class="literal">1</code> を返し、<em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> の場合は <code class="literal">-1</code> を返します。 すべての引数は整数として処理されます。 この関数が正しく機能するには、<em class="replaceable"><code>N1</code></em> &lt; <em class="replaceable"><code>N2</code></em> &lt; <em class="replaceable"><code>N3</code></em> &lt; <code class="literal">...</code> &lt; <em class="replaceable"><code>Nn</code></em> とする必要があります。 これは、バイナリ検索が使用されていることが理由です (非常に高速)。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(23, 1, 15, 17, 30, 44, 200);</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(10, 1, 10, 100, 1000);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(22, 23, 30, 44, 200);</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="operator_is"></a><p>
            <code class="literal">IS <em class="replaceable"><code>boolean_value</code></em></code>
          </p><a class="indexterm" name="idm46041627379296"></a><a class="indexterm" name="idm46041627377152"></a><a class="indexterm" name="idm46041627375120"></a><a class="indexterm" name="idm46041627373088"></a><p>
            <em class="replaceable"><code>boolean_value</code></em> を <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">UNKNOWN</code> にすることができるブール値に対して値をテストします。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS TRUE, 0 IS FALSE, NULL IS UNKNOWN;</code></strong>
        -&gt; 1, 1, 1
</pre></li><li class="listitem"><a name="operator_is-not"></a><p>
            <code class="literal">IS NOT <em class="replaceable"><code>boolean_value</code></em></code>
          </p><a class="indexterm" name="idm46041627360592"></a><a class="indexterm" name="idm46041627358448"></a><a class="indexterm" name="idm46041627356416"></a><a class="indexterm" name="idm46041627354384"></a><p>
            <em class="replaceable"><code>boolean_value</code></em> を <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">UNKNOWN</code> にすることができるブール値に対して値をテストします。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT UNKNOWN, 0 IS NOT UNKNOWN, NULL IS NOT UNKNOWN;</code></strong>
        -&gt; 1, 1, 0
</pre></li><li class="listitem"><a name="operator_is-null"></a><p>
            <code class="literal">IS NULL</code>
          </p><a class="indexterm" name="idm46041627342160"></a><a class="indexterm" name="idm46041627340000"></a><p>
            値が <code class="literal">NULL</code> かどうかをテストします。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NULL, 0 IS NULL, NULL IS NULL;</code></strong>
        -&gt; 0, 0, 1
</pre><p>
            ODBC プログラムを適切に使用するために、MySQL では、<code class="literal">IS NULL</code> の使用時に次の追加機能がサポートされています:
          </p><a class="indexterm" name="idm46041627332432"></a><a class="indexterm" name="idm46041627330960"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">sql_auto_is_null</code> 変数が 1 に設定されている場合は、自動的に生成された <code class="literal">AUTO_INCREMENT</code> 値を正常に挿入するステートメントのあとに、次の形式のステートメントを発行すれば、その値を検索できます。
              </p><pre class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>auto_col</code></em> IS NULL
</pre><p>
                ステートメントが行を返す場合、返される値は <code class="literal">LAST_INSERT_ID()</code> 関数を呼び出した場合と同じです。 複数行の挿入後の戻り値などについての詳細は、<a class="xref" href="functions.html#information-functions" title="12.16 情報関数">セクション12.16「情報関数」</a>を参照してください。 <code class="literal">AUTO_INCREMENT</code> 値を正常に挿入できなかった場合、<code class="literal">SELECT</code> ステートメントは行を返しません。 
              </p><p>
                <code class="literal">IS NULL</code> の比較を使用して <code class="literal">AUTO_INCREMENT</code> 値を取得する動作は、<code class="literal">sql_auto_is_null = 0</code> を設定すると無効にできます。 <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a>を参照してください。 
              </p><p>
                <code class="literal">sql_auto_is_null</code> のデフォルト値は 0 です。
              </p></li><li class="listitem"><p>
                <code class="literal">NOT NULL</code> として宣言された <code class="literal">DATE</code> および <code class="literal">DATETIME</code> カラムでは、次のようなステートメントを使用することで、特殊な日付 <code class="literal">'0000-00-00'</code> を検索できます。
              </p><pre class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>date_column</code></em> IS NULL
</pre><p>
                ODBC では <code class="literal">'0000-00-00'</code> 日付値がサポートされていないため、一部の ODBC アプリケーションを取得する際に、これが必要になります。
              </p><p>
                <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top">Obtaining Auto-Increment Values</a>、および<a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-configuration-connection-parameters.html" target="_top">Connector/ODBC Connection Parameters</a>の <code class="literal">FLAG_AUTO_IS_NULL</code> オプションについての説明を参照してください。
              </p></li></ul></div></li><li class="listitem"><a name="operator_is-not-null"></a><p>
            <code class="literal">IS NOT NULL</code>
          </p><a class="indexterm" name="idm46041627299056"></a><a class="indexterm" name="idm46041627296896"></a><p>
            値が <code class="literal">NULL</code> でないかどうかをテストします。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;</code></strong>
        -&gt; 1, 1, 0
</pre></li><li class="listitem"><a name="function_isnull"></a><p>
            <code class="literal">ISNULL(<em class="replaceable"><code>expr</code></em>)</code>
          </p><a class="indexterm" name="idm46041627286400"></a><p>
            <em class="replaceable"><code>expr</code></em> が <code class="literal">NULL</code> の場合、<code class="literal">ISNULL()</code> は <code class="literal">1</code> を返し、それ以外の場合は <code class="literal">0</code> を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1+1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1/0);</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">=</code> の代わりに <code class="literal">ISNULL()</code> を使用すると、値が <code class="literal">NULL</code> であるかどうかをテストできます。 (<code class="literal">=</code> を使用して値を <code class="literal">NULL</code> と比較すると、常に <code class="literal">NULL</code> が生成されます。) 
          </p><p>
            <code class="literal">ISNULL()</code> 関数は <code class="literal">IS NULL</code> 比較演算子と、いくつかの特殊な動作を共有します。 <code class="literal">IS NULL</code> の説明を参照してください。 
          </p></li><li class="listitem"><a name="function_least"></a><p>
            <code class="literal">LEAST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code>
          </p><a class="indexterm" name="idm46041627261200"></a><p>
            2 つ以上の引数がある場合は、最小の (最小値の) 引数を返します。 引数は、次のルールを使用して比較されます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                引数が <code class="literal">NULL</code> である場合、結果は <code class="literal">NULL</code> になります。 比較は必要ありません。 
              </p></li><li class="listitem"><p>
                すべての引数が整数値の場合、整数として比較されます。
              </p></li><li class="listitem"><p>
                少なくとも 1 つの引数が倍精度の場合は、倍精度の値として比較されます。 それ以外の場合、少なくとも 1 つの引数が <code class="literal">DECIMAL</code> 値であれば、<code class="literal">DECIMAL</code> 値として比較されます。 
              </p></li><li class="listitem"><p>
                引数が数値と文字列の組合せで構成されている場合、それらは文字列として比較されます。
              </p></li><li class="listitem"><p>
                引数が非バイナリ (文字) 文字列の場合は、非バイナリ文字列として比較されます。
              </p></li><li class="listitem"><p>
                ほかのすべてのケースでは、引数はバイナリ文字列として比較されます。
              </p></li></ul></div><p>
            <code class="literal">LEAST()</code> の戻り型は、比較引数型の集計型です。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LEAST(2,0);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LEAST(34.0,3.0,5.0,767.0);</code></strong>
        -&gt; 3.0
mysql&gt; <strong class="userinput"><code>SELECT LEAST('B','A','C');</code></strong>
        -&gt; 'A'
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="logical-operators"></a>12.4.3 論理演算子</h3></div></div></div><a class="indexterm" name="idm46041627240640"></a><a class="indexterm" name="idm46041627239168"></a><div class="table"><a name="idm46041627237136"></a><p class="title"><b>表 12.5 「論理演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「論理演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td>
<td>
      論理 AND
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td>
<td>
      値を否定します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></td>
<td>
      論理 OR
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td>
<td>
      論理 XOR
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        SQL では、すべての論理演算子は <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">NULL</code> (<code class="literal">UNKNOWN</code>) に評価されます。 MySQL では、これらは 1 (<code class="literal">TRUE</code>)、0 (<code class="literal">FALSE</code>)、および <code class="literal">NULL</code> として実装されます。 この大部分は、さまざまな SQL データベースサーバーに共通のものです。ただし、一部のサーバーは <code class="literal">TRUE</code> にゼロ以外の任意の値を返す場合があります。 
      </p><p>
        MySQL では、ゼロ以外の任意の非 <code class="literal">NULL</code> 値が <code class="literal">TRUE</code> に評価されます。 たとえば、次のステートメントはすべて <code class="literal">TRUE</code> に評価されます。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 10 IS TRUE;</code></strong>
-&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT -10 IS TRUE;</code></strong>
-&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'string' IS NOT NULL;</code></strong>
-&gt; 1
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not"></a><p>
            <code class="literal">NOT</code>, <code class="literal">!</code>
          </p><a class="indexterm" name="idm46041627198560"></a><a class="indexterm" name="idm46041627196848"></a><p>
            NOT 演算。 オペランドが <code class="literal">0</code> の場合は <code class="literal">1</code> に、オペランドがゼロ以外の場合は <code class="literal">0</code> にそれぞれ評価され、<code class="literal">NOT NULL</code> の場合は <code class="literal">NULL</code> が返されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOT 10;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT NOT 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT NOT NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT ! (1+1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ! 1+1;</code></strong>
        -&gt; 1
</pre><p>
            最後の例では、式が <code class="literal">(!1)+1</code> と同様に評価されるため、<code class="literal">1</code> が生成されています。
          </p><p>
            <code class="literal">!</code>、演算子は非標準の MySQL 拡張機能です。 MySQL 8.0.17 では、この演算子は非推奨です。将来のバージョンの MySQL で削除される予定です。 アプリケーションは、標準の SQL <code class="literal">NOT</code> 演算子を使用するように調整する必要があります。 
          </p></li><li class="listitem"><a name="operator_and"></a><p>
            <code class="literal">AND</code>, <code class="literal">&amp;&amp;</code>
          </p><a class="indexterm" name="idm46041627174640"></a><a class="indexterm" name="idm46041627172928"></a><p>
            論理 AND すべてのオペランドがゼロ以外で非 <code class="literal">NULL</code> の場合は <code class="literal">1</code> に、1 つ以上のオペランドが <code class="literal">0</code> の場合は <code class="literal">0</code> に評価され、それ以外の場合は <code class="literal">NULL</code> が返されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 AND 1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 AND 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 AND NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 0 AND NULL;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT NULL AND 0;</code></strong>
        -&gt; 0
</pre><p>
            <code class="literal">&amp;&amp;</code>、演算子は非標準の MySQL 拡張機能です。 MySQL 8.0.17 では、この演算子は非推奨です。将来のバージョンの MySQL ではサポートされなくなる予定です。 アプリケーションは、標準の SQL <code class="literal">AND</code> 演算子を使用するように調整する必要があります。 
          </p></li><li class="listitem"><a name="operator_or"></a><p>
            <code class="literal">OR</code>, <code class="literal">||</code>
          </p><a class="indexterm" name="idm46041627152720"></a><a class="indexterm" name="idm46041627150768"></a><p>
            論理 OR。 両方のオペランドが非 <code class="literal">NULL</code> であれば、オペランドのいずれかがゼロ以外である場合の結果は <code class="literal">1</code>、それ以外の場合は <code class="literal">0</code> になります。 <code class="literal">NULL</code> オペランドが 1 つあれば、ほかのオペランドがゼロ以外である場合の結果は <code class="literal">1</code>、それ以外の場合は <code class="literal">NULL</code> になります。 両方のオペランドが <code class="literal">NULL</code> であれば、結果は <code class="literal">NULL</code> になります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 OR 1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 OR 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 0 OR 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 0 OR NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 1 OR NULL;</code></strong>
        -&gt; 1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              <code class="literal">PIPES_AS_CONCAT</code> SQL モードが有効な場合、<code class="literal">||</code>は SQL 標準の文字列連結演算子 (<code class="literal">CONCAT()</code> など) を示します。
            </p></div><p>
            <code class="literal">||</code>、演算子は非標準の MySQL 拡張機能です。 MySQL 8.0.17 では、この演算子は非推奨です。将来のバージョンの MySQL ではサポートされなくなる予定です。 アプリケーションは、標準の SQL <code class="literal">OR</code> 演算子を使用するように調整する必要があります。 例外: <code class="literal">PIPES_AS_CONCAT</code> が有効な場合、<code class="literal">||</code>は文字列の連結を示すため、非推奨は適用されません。 
          </p></li><li class="listitem"><a name="operator_xor"></a><p>
            <code class="literal">XOR</code>
          </p><a class="indexterm" name="idm46041627122976"></a><p>
            論理 XOR。 オペランドのいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 非 <code class="literal">NULL</code> のオペランドでは、奇数のオペランドがゼロ以外の場合は <code class="literal">1</code> に評価され、それ以外の場合は <code class="literal">0</code> が返されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1 XOR 1;</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">a XOR b</code> は、数学的に <code class="literal">(a AND (NOT b)) OR ((NOT a) and b)</code> に等しくなります。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="assignment-operators"></a>12.4.4 割り当て演算子</h3></div></div></div><a class="indexterm" name="idm46041627107184"></a><a class="indexterm" name="idm46041627105712"></a><div class="table"><a name="idm46041627103680"></a><p class="title"><b>表 12.6 「代入演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「代入演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td>
<td>
      値を割り当てます
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td>
<td>
      (<code class="literal">SET</code> ステートメントの一部として、または <code class="literal">UPDATE</code> ステートメントの <code class="literal">SET</code> 句の一部として) 値を割り当てます
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_assign-value"></a><p>
            <code class="literal">:=</code>
          </p><a class="indexterm" name="idm46041627084288"></a><a class="indexterm" name="idm46041627083056"></a><p>
            割り当て演算子。 演算子の左側にあるユーザー変数が右側にある値に代入されます。 右側の値は、リテラル値、値を格納する別の変数、またはクエリーの結果を含むスカラー値を生成する任意の有効な式 (この値がスカラー値の場合) である可能性があります。 同じ <code class="literal">SET</code> ステートメントで、複数の割り当てを実行できます。 同じステートメントで複数の割当てを実行できます。 
          </p><p>
            <code class="literal">=</code> とは異なり、<code class="literal">:=</code> 演算子は比較演算子として解釈されません。 つまり、(<code class="literal">SET</code> ステートメントだけでなく) 有効な任意の SQL ステートメントで <code class="literal">:=</code> を使用すれば、値を変数に割り当てることができます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; NULL, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong>
        -&gt; 1, 1
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, 1

mysql&gt; <strong class="userinput"><code>SELECT @var1:=COUNT(*) FROM t1;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 4
</pre><p>
            次に示すように、<code class="literal">SELECT</code> 以外のステートメント (<code class="literal">UPDATE</code> など) でも、<code class="literal">:=</code> を使用して値の割り当てを実行できます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
        -&gt; 1, 3, 5, 7

mysql&gt; <strong class="userinput"><code>UPDATE t1 SET c1 = 2 WHERE c1 = @var1:= 1;</code></strong>
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
        -&gt; 2, 3, 5, 7
</pre><p>
            <code class="literal">:=</code> 演算子を使用すれば、単一の SQL ステートメントで同じ変数の値の設定と読み取りの両方を行うこともできますが、これは推奨されていません。<a class="xref" href="language-structure.html#user-variables" title="9.4 ユーザー定義変数">セクション9.4「ユーザー定義変数」</a>では、これを回避するべき理由について説明されています。
          </p></li><li class="listitem"><a name="operator_assign-equal"></a><p>
            <code class="literal">=</code>
          </p><a class="indexterm" name="idm46041627049248"></a><a class="indexterm" name="idm46041627047760"></a><a class="indexterm" name="idm46041627045888"></a><p>
            この演算子は、次の 2 つのパラグラフで説明する 2 つのケースで値の割り当てを実行する際に使用されます。
          </p><p>
            <code class="literal">SET</code> ステートメントでは、<code class="literal">=</code> は、演算子の左側にあるユーザー変数を右側にある値に代入する割り当て演算子として処理されます。 (言い換えると、<code class="literal">SET</code> ステートメントで使用されると、<code class="literal">=</code> は <code class="literal">:=</code> と同じように処理されます。) 右側の値は、リテラル値、値を格納する別の変数、またはクエリーの結果を含むスカラー値を生成する任意の有効な式 (この値がスカラー値の場合) である可能性があります。 同じ <code class="literal">SET</code> ステートメントで、複数の割り当てを実行できます。 
          </p><p>
            <code class="literal">UPDATE</code> ステートメントの <code class="literal">SET</code> 句では、<code class="literal">=</code> は割り当て演算子としても機能します。ただし、この場合、<code class="literal">UPDATE</code> の一部である <code class="literal">WHERE</code> 条件に一致していれば、演算子の左側で指定されたカラムが右側に指定された値であるとみなされます。 <code class="literal">UPDATE</code> ステートメントの同じ <code class="literal">SET</code> 句で、複数の割り当てを実行できます。 
          </p><p>
            その他のコンテキストでは、<code class="literal">=</code> は<a class="link" href="functions.html#operator_equal">比較演算子</a>として処理されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; NULL, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong>
        -&gt; 1, 1
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, 1
</pre><p>
            詳細は、<a class="xref" href="sql-statements.html#set-variable" title="13.7.6.1 変数代入の SET 構文">セクション13.7.6.1「変数代入の SET 構文」</a>、<a class="xref" href="sql-statements.html#update" title="13.2.13 UPDATE ステートメント">セクション13.2.13「UPDATE ステートメント」</a>、および<a class="xref" href="sql-statements.html#subqueries" title="13.2.11 サブクエリー">セクション13.2.11「サブクエリー」</a>を参照してください。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-control-functions"></a>12.5 フロー制御関数</h2></div></div></div><a class="indexterm" name="idm46041627015504"></a><a class="indexterm" name="idm46041627014032"></a><div class="table"><a name="idm46041627012000"></a><p class="title"><b>表 12.7 「フロー制御演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「フロー制御演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td>
<td>
      CASE 演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></td>
<td>
      If/else 構文
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></td>
<td>
      Null if/else 構文
    </td>
</tr><tr><td><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></td>
<td>
      expr1 = expr2 の場合に NULL を返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_case"></a><p>
          <code class="literal">CASE <em class="replaceable"><code>value</code></em> WHEN <em class="replaceable"><code>compare_value</code></em> THEN <em class="replaceable"><code>result</code></em> [WHEN <em class="replaceable"><code>compare_value</code></em> THEN <em class="replaceable"><code>result</code></em> ...] [ELSE <em class="replaceable"><code>result</code></em>] END</code>
        </p><p>
          <code class="literal">CASE WHEN <em class="replaceable"><code>condition</code></em> THEN <em class="replaceable"><code>result</code></em> [WHEN <em class="replaceable"><code>condition</code></em> THEN <em class="replaceable"><code>result</code></em> ...] [ELSE <em class="replaceable"><code>result</code></em>] END</code>
        </p><a class="indexterm" name="idm46041626982272"></a><p>
          最初の <code class="literal">CASE</code> 構文では、true である最初の <code class="literal"><em class="replaceable"><code>value</code></em>=<em class="replaceable"><code>compare_value</code></em></code> 比較の <em class="replaceable"><code>result</code></em> が返されます。 2 番目の構文は、true である最初の条件の結果を返します。 比較または条件が true の場合、<code class="literal">ELSE</code> が返された後の結果、または <code class="literal">ELSE</code> 部分がない場合は <code class="literal">NULL</code> が返されます。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する <code class="literal">CASE</code> <span class="emphasis"><em>operator</em></span> の構文は、<a class="xref" href="sql-statements.html#case" title="13.6.5.1 CASE ステートメント">セクション13.6.5.1「CASE ステートメント」</a> で説明する SQL <code class="literal">CASE</code> <span class="emphasis"><em>statement</em></span> の構文とは若干異なり、ストアドプログラム内で使用されます。 <code class="literal">CASE</code> ステートメントは <code class="literal">ELSE NULL</code> 句を持つことができず、<code class="literal">END</code> でなく、<code class="literal">END CASE</code> で終了します。 
          </p></div><p>
          <code class="literal">CASE</code> 式の結果の戻り型は、すべての結果値の集計型です:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              すべてのタイプが数値の場合、集計タイプも数値になります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  少なくとも 1 つの引数が倍精度の場合、結果は倍精度になります。
                </p></li><li class="listitem"><p>
                  それ以外の場合、少なくとも 1 つの引数が <code class="literal">DECIMAL</code> であれば、結果は <code class="literal">DECIMAL</code> になります。
                </p></li><li class="listitem"><p>
                  それ以外の場合、結果は整数型になります (ただし、次の例外があります):
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      すべての整数型がすべて符号付きまたは符号なしの場合、結果は同じ符号になり、精度は指定されたすべての整数型 (<code class="literal">TINYINT</code>, <code class="literal">SMALLINT</code>, <code class="literal">MEDIUMINT</code>, <code class="literal">INT</code> または <code class="literal">BIGINT</code>) の中で最も高くなります。
                    </p></li><li class="listitem"><p>
                      符号付き整数型と符号なし整数型の組合せがある場合、結果は符号付きになり、精度が高くなる可能性があります。 たとえば、型が署名付き <code class="literal">INT</code> および署名なし <code class="literal">INT</code> の場合、結果は署名付き <code class="literal">BIGINT</code> になります。 
                    </p></li><li class="listitem"><p>
                      例外は、符号なし <code class="literal">BIGINT</code> と符号付き整数型を組み合せたものです。 その結果、精度とスケール 0 が十分な <code class="literal">DECIMAL</code> になります。 
                    </p></li></ul></div></li></ul></div></li><li class="listitem"><p>
              すべてのタイプが <code class="literal">BIT</code> の場合、結果は <code class="literal">BIT</code> になります。 それ以外の場合、<code class="literal">BIT</code> 引数は <code class="literal">BIGINT</code> と同様に扱われます。 
            </p></li><li class="listitem"><p>
              すべてのタイプが <code class="literal">YEAR</code> の場合、結果は <code class="literal">YEAR</code> になります。 それ以外の場合、<code class="literal">YEAR</code> 引数は <code class="literal">INT</code> と同様に扱われます。 
            </p></li><li class="listitem"><p>
              すべての型が文字列 (<code class="literal">CHAR</code> または <code class="literal">VARCHAR</code>) の場合、結果は、オペランドの最長文字長によって決定される最大長の <code class="literal">VARCHAR</code> になります。
            </p></li><li class="listitem"><p>
              すべての型が文字列またはバイナリ文字列の場合、結果は <code class="literal">VARBINARY</code> になります。
            </p></li><li class="listitem"><p>
              <code class="literal">SET</code> および <code class="literal">ENUM</code> は <code class="literal">VARCHAR</code> と同様に処理され、結果は <code class="literal">VARCHAR</code> になります。
            </p></li><li class="listitem"><p>
              すべてのタイプが <code class="literal">JSON</code> の場合、結果は <code class="literal">JSON</code> になります。
            </p></li><li class="listitem"><p>
              すべての型が時間的な場合、結果は時間的になります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  すべての時間型が <code class="literal">DATE</code>、<code class="literal">TIME</code> または <code class="literal">TIMESTAMP</code> の場合、結果はそれぞれ <code class="literal">DATE</code>、<code class="literal">TIME</code> または <code class="literal">TIMESTAMP</code> になります。
                </p></li><li class="listitem"><p>
                  それ以外の場合、時間型が混在すると、結果は <code class="literal">DATETIME</code> になります。
                </p></li></ul></div></li><li class="listitem"><p>
              すべてのタイプが <code class="literal">GEOMETRY</code> の場合、結果は <code class="literal">GEOMETRY</code> になります。
            </p></li><li class="listitem"><p>
              いずれかのタイプが <code class="literal">BLOB</code> の場合、結果は <code class="literal">BLOB</code> になります。
            </p></li><li class="listitem"><p>
              他のすべてのタイプの組合せの場合、結果は <code class="literal">VARCHAR</code> です。
            </p></li><li class="listitem"><p>
              リテラル <code class="literal">NULL</code> オペランドは、集計型では無視されます。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CASE 1 WHEN 1 THEN 'one'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 2 THEN 'two' ELSE 'more' END;</code></strong>
        -&gt; 'one'
mysql&gt; <strong class="userinput"><code>SELECT CASE WHEN 1&gt;0 THEN 'true' ELSE 'false' END;</code></strong>
        -&gt; 'true'
mysql&gt; <strong class="userinput"><code>SELECT CASE BINARY 'B'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 'a' THEN 1 WHEN 'b' THEN 2 END;</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_if"></a><p>
          <code class="literal">IF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>,<em class="replaceable"><code>expr3</code></em>)</code>
        </p><a class="indexterm" name="idm46041626889824"></a><p>
          <em class="replaceable"><code>expr1</code></em> が <code class="literal">TRUE</code> (<code class="literal"> <em class="replaceable"><code>expr1</code></em> &lt;&gt; 0</code> および<code class="literal"> <em class="replaceable"><code>expr1</code></em> &lt;&gt; NULL</code>) の場合、<code class="literal">IF()</code> は <em class="replaceable"><code>expr2</code></em> を返します。 それ以外の場合は、<em class="replaceable"><code>expr3</code></em> を返します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">IF</code> <span class="emphasis"><em>ステートメント</em></span>もありますが、ここで説明されている <code class="literal">IF()</code> <span class="emphasis"><em>関数</em></span>とは異なります。 <a class="xref" href="sql-statements.html#if" title="13.6.5.2 IF ステートメント">セクション13.6.5.2「IF ステートメント」</a>を参照してください。 
          </p></div><p>
          <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr3</code></em> の一方のみが明示的に <code class="literal">NULL</code> である場合は、<code class="literal">IF()</code> 関数の結果型は非 <code class="literal">NULL</code> 式の型になります。
        </p><p>
          <code class="literal">IF()</code> のデフォルトの戻り型 (一時テーブルに格納されている場合でもかまいません) は、次のように計算されます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> が文字列を生成する場合、結果は文字列になります。
            </p><p>
              <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr3</code></em> の両方が文字列の場合、いずれかの文字列で大文字と小文字が区別されると、結果では大文字と小文字が区別されます。
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> が浮動小数点値を生成する場合、結果は浮動小数点値になります。
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> が整数を生成する場合、結果は整数になります。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IF(1&gt;2,2,3);</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT IF(1&lt;2,'yes','no');</code></strong>
        -&gt; 'yes'
mysql&gt; <strong class="userinput"><code>SELECT IF(STRCMP('test','test1'),'no','yes');</code></strong>
        -&gt; 'no'
</pre></li><li class="listitem"><a name="function_ifnull"></a><p>
          <code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041626854928"></a><a class="indexterm" name="idm46041626852768"></a><p>
          <em class="replaceable"><code>expr1</code></em> が <code class="literal">NULL</code> でない場合、<code class="literal">IFNULL()</code> は <em class="replaceable"><code>expr1</code></em> を返し、それ以外の場合は <em class="replaceable"><code>expr2</code></em> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1,0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(NULL,10);</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,10);</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,'yes');</code></strong>
        -&gt; 'yes'
</pre><p>
          <code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code> のデフォルトの戻り型は、<code class="literal">STRING</code>、<code class="literal">REAL</code> または <code class="literal">INTEGER</code> の順で、2 つの式のうちより多くの<span class="quote">「<span class="quote">「一般」</span>」</span>です。 式や MySQL が一時テーブルの <code class="literal">IFNULL()</code> で返された値を内部に格納する必要のある場所に基づいて、テーブルの大文字と小文字を考慮してください。 
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE tmp SELECT IFNULL(1,'test') AS test;</code></strong>
mysql&gt; <strong class="userinput"><code>DESCRIBE tmp;</code></strong>
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| test  | varbinary(4) | NO   |     |         |       |
+-------+--------------+------+-----+---------+-------+
</pre><p>
          この例では、<code class="literal">test</code> カラムの型は <code class="literal">VARBINARY(4)</code> (文字列型) です。
        </p></li><li class="listitem"><a name="function_nullif"></a><p>
          <code class="literal">NULLIF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041626826192"></a><p>
          <code class="literal"><em class="replaceable"><code>expr1</code></em> = <em class="replaceable"><code>expr2</code></em></code> が true の場合は <code class="literal">NULL</code> を返し、それ以外の場合は <em class="replaceable"><code>expr1</code></em> を返します。 これは、<code class="literal">CASE WHEN <em class="replaceable"><code>expr1</code></em> = <em class="replaceable"><code>expr2</code></em> THEN NULL ELSE <em class="replaceable"><code>expr1</code></em> END</code> と同じです。 
        </p><p>
          戻り値の型は最初の引数と同じです。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,1);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,2);</code></strong>
        -&gt; 1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            引数が等しくない場合は、MySQL で <em class="replaceable"><code>expr1</code></em> が 2 回評価されます。
          </p></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="numeric-functions"></a>12.6 数値関数と演算子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 算術演算子</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 数学関数</a></span></dt></dl></div><div class="table"><a name="idm46041626811184"></a><p class="title"><b>表 12.8 「数値関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「数値関数および演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><code class="literal">%</code>, <code class="literal">MOD</code></td>
<td>
      モジュロ演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      乗算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      加算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      減算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      引数の符号を変更します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      除算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td>
<td>
      絶対値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td>
<td>
      アークコサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td>
<td>
      アークサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td>
<td>
      アークタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td>
<td>
      2 つの引数のアークタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td>
<td>
      数値を異なる基数間で変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td>
<td>
      コサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td>
<td>
      コタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td>
<td>
      巡回冗長検査値を計算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td>
<td>
      ラジアンを角度に変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      整数除算
    </td>
</tr><tr><td><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td>
<td>
      累乗します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td>
<td>
      引数以下のもっとも大きな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td>
<td>
      引数の自然対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td>
<td>
      最初の引数の自然対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td>
<td>
      引数の底 10 の対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td>
<td>
      引数の底 2 の対数を返します
    </td>
</tr><tr><td><code class="literal">MOD()</code></td>
<td>
      余りを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td>
<td>
      pi の値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td>
<td>
      指定した指数で累乗された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td>
<td>
      指定した指数で累乗された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td>
<td>
      ラジアンに変換された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td>
      ランダムな浮動小数点値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td>
<td>
      引数を丸めます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td>
<td>
      引数の符号を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td>
<td>
      引数のサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td>
<td>
      引数の平方根を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td>
<td>
      引数のタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td>
<td>
      指定された小数点以下の桁数に切り捨てます
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="arithmetic-functions"></a>12.6.1 算術演算子</h3></div></div></div><a class="indexterm" name="idm46041626691648"></a><div class="table"><a name="idm46041626689504"></a><p class="title"><b>表 12.9 「算術演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「算術演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><code class="literal">%</code>, <code class="literal">MOD</code></td>
<td>
      モジュロ演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      乗算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      加算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      減算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      引数の符号を変更します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      除算演算子
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      整数除算
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        通常の算術演算子を使用できます。 結果は次のルールに従って決定されます。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">-</code>、<code class="literal">+</code>、および <code class="literal">*</code> の場合は、両方のオペランドが整数であれば、結果が <code class="literal">BIGINT</code> (64 ビット) 精度で計算されます。
          </p></li><li class="listitem"><p>
            両方のオペランドが整数で、いずれかが符合なしの場合は、結果が符合なし整数になります。 減算では、<code class="literal">NO_UNSIGNED_SUBTRACTION</code> SQL モードが有効になっている場合は、オペランドのいずれかが符号なしでも、結果が符号付きになります。 
          </p></li><li class="listitem"><p>
            <code class="literal">+</code>、<code class="literal">-</code>、<code class="literal">/</code>、<code class="literal">*</code>、<code class="literal">%</code> のオペランドのいずれかが実数値または文字列値である場合は、結果の精度が、最大の精度を持つオペランドの精度になります。
          </p></li><li class="listitem"><p>
            <code class="literal">/</code> を使用して実行される除算では、2 つの正確な値のオペランドを使用したときの結果のスケールが、1 番目のオペランドに <code class="literal">div_precision_increment</code> システム変数 (デフォルトでは 4) の値を加えた値になります。 たとえば、式 <code class="literal">5.05 / 0.014</code> の結果のスケールは、小数点以下 6 桁になります (<code class="literal">360.714286</code>)。 
          </p></li></ul></div><p>
        ネストされた計算が各コンポーネントの精度を暗黙的に示すように、これらのルールは演算ごとに適用されます。 したがって、<code class="literal">(14620 / 9432456) / (24250 / 9432456)</code> では、まず <code class="literal">(0.0014) / (0.0026)</code> に解かれて、最終的な結果は小数点以下 8 桁 (<code class="literal">0.60288653</code>) になります。 
      </p><p>
        このようなルールおよびそれらが適用される方法があるため、計算のコンポーネントおよびサブコンポーネントで適切な精度レベルが使用されていることを慎重に確認してください。 <a class="xref" href="functions.html#cast-functions" title="12.11 キャスト関数と演算子">セクション12.11「キャスト関数と演算子」</a>を参照してください。 
      </p><p>
        数値式評価でのオーバーフロー処理については、<a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.1.7 範囲外およびオーバーフローの処理">セクション11.1.7「範囲外およびオーバーフローの処理」</a>を参照してください。
      </p><p>
        算術演算子は数字に適用されます。 その他の型の値では、代替の演算が使用できる場合もあります。 たとえば、日付値を追加するには、<code class="literal">DATE_ADD()</code> を使用します。<a class="xref" href="functions.html#date-and-time-functions" title="12.7 日付および時間関数">セクション12.7「日付および時間関数」</a>を参照してください。 
      </p><a class="indexterm" name="idm46041626632288"></a><a class="indexterm" name="idm46041626630176"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_plus"></a><p>
            <code class="literal">+</code>
          </p><a class="indexterm" name="idm46041626624496"></a><a class="indexterm" name="idm46041626623408"></a><p>
            加算:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3+5;</code></strong>
        -&gt; 8
</pre></li><li class="listitem"><a name="operator_minus"></a><p>
            <code class="literal">-</code>
          </p><a class="indexterm" name="idm46041626613616"></a><a class="indexterm" name="idm46041626612528"></a><p>
            減算:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3-5;</code></strong>
        -&gt; -2
</pre></li><li class="listitem"><a name="operator_unary-minus"></a><p>
            <code class="literal">-</code>
          </p><a class="indexterm" name="idm46041626602800"></a><a class="indexterm" name="idm46041626601296"></a><a class="indexterm" name="idm46041626599264"></a><p>
            単項マイナス。 この演算子は、オペランドの符号を変更します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT - 2;</code></strong>
        -&gt; -2
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              この演算子が <code class="literal">BIGINT</code> で使用される場合は、戻り値も <code class="literal">BIGINT</code> になります。 つまり、値 −2<sup>63</sup> を持つ可能性のある整数では、<code class="literal">-</code> の使用を避けるべきです。 
            </p></div></li><li class="listitem"><a name="operator_times"></a><p>
            <code class="literal">*</code>
          </p><a class="indexterm" name="idm46041626585216"></a><a class="indexterm" name="idm46041626584128"></a><p>
            乗算:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3*5;</code></strong>
        -&gt; 15
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984.0;</code></strong>
        -&gt; 324518553658426726783156020576256.0
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984;</code></strong>
        -&gt; out-of-range error
</pre><p>
            最後の式では、整数乗算の結果が 64 ビット範囲の <code class="literal">BIGINT</code> 計算を超過するため、エラーが生成されます。 (<a class="xref" href="data-types.html#numeric-types" title="11.1 数値データ型">セクション11.1「数値データ型」</a>を参照してください。) 
          </p></li><li class="listitem"><a name="operator_divide"></a><p>
            <code class="literal">/</code>
          </p><a class="indexterm" name="idm46041626570192"></a><a class="indexterm" name="idm46041626568848"></a><p>
            除算:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3/5;</code></strong>
        -&gt; 0.60
</pre><p>
            ゼロによる除算では、<code class="literal">NULL</code> の結果が生成されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 102/(1-1);</code></strong>
        -&gt; NULL
</pre><p>
            結果が整数に変換されるコンテキストで実行される場合にのみ、除算は <code class="literal">BIGINT</code> 算術を使用して計算されます。
          </p></li><li class="listitem"><a name="operator_div"></a><p>
            <code class="literal">DIV</code>
          </p><a class="indexterm" name="idm46041626554560"></a><p>
            整数除算。 除算結果から小数点以下の小数部を破棄します。 
          </p><p>
            いずれかのオペランドが整数以外の型の場合、オペランドは <code class="literal">DECIMAL</code> に変換され、<code class="literal">DECIMAL</code> 算術を使用して除算されてから、結果が <code class="literal">BIGINT</code> に変換されます。 結果が <code class="literal">BIGINT</code> の範囲を超過する場合は、エラーが発生します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 5 DIV 2, -5 DIV 2, 5 DIV -2, -5 DIV -2;</code></strong>
        -&gt; 2, -2, -2, 2
</pre></li><li class="listitem"><a name="operator_mod"></a><p>
            <code class="literal"><em class="replaceable"><code>N</code></em> % <em class="replaceable"><code>M</code></em></code>, <code class="literal"><em class="replaceable"><code>N</code></em> MOD <em class="replaceable"><code>M</code></em></code>
          </p><a class="indexterm" name="idm46041626537712"></a><p>
            モジュロ演算。 <em class="replaceable"><code>M</code></em> で除算された <em class="replaceable"><code>N</code></em> の余りを返します。 詳細は、<a class="xref" href="functions.html#mathematical-functions" title="12.6.2 数学関数">セクション12.6.2「数学関数」</a>の <code class="literal">MOD()</code> 関数に関する説明を参照してください。 
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mathematical-functions"></a>12.6.2 数学関数</h3></div></div></div><div class="table"><a name="idm46041626529904"></a><p class="title"><b>表 12.10 「数学関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「算術関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td>
<td>
      絶対値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td>
<td>
      アークコサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td>
<td>
      アークサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td>
<td>
      アークタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td>
<td>
      2 つの引数のアークタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td>
<td>
      引数以上のもっとも小さな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td>
<td>
      数値を異なる基数間で変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td>
<td>
      コサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td>
<td>
      コタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td>
<td>
      巡回冗長検査値を計算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td>
<td>
      ラジアンを角度に変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td>
<td>
      累乗します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td>
<td>
      引数以下のもっとも大きな整数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td>
<td>
      引数の自然対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td>
<td>
      最初の引数の自然対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td>
<td>
      引数の底 10 の対数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td>
<td>
      引数の底 2 の対数を返します
    </td>
</tr><tr><td><code class="literal">MOD()</code></td>
<td>
      余りを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td>
<td>
      pi の値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td>
<td>
      指定した指数で累乗された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td>
<td>
      指定した指数で累乗された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td>
<td>
      ラジアンに変換された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td>
      ランダムな浮動小数点値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td>
<td>
      引数を丸めます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td>
<td>
      引数の符号を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td>
<td>
      引数のサインを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td>
<td>
      引数の平方根を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td>
<td>
      引数のタンジェントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td>
<td>
      指定された小数点以下の桁数に切り捨てます
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        すべての数学関数は、エラーの発生時に <code class="literal">NULL</code> を返します。
      </p><a class="indexterm" name="idm46041626430304"></a><a class="indexterm" name="idm46041626428832"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_abs"></a><p>
            <code class="literal">ABS(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626422256"></a><p>
            <em class="replaceable"><code>X</code></em> の絶対値、または <em class="replaceable"><code>X</code></em> が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。
          </p><p>
            結果の型は引数の型から導出されます。 これは、結果を署名付き <code class="literal">BIGINT</code> 値に格納できないため、<code class="literal">ABS(-9223372036854775808)</code> でエラーが発生することを意味します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ABS(2);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT ABS(-32);</code></strong>
        -&gt; 32
</pre><p>
            この関数は、<code class="literal">BIGINT</code> 値でも安全に使用できます。
          </p></li><li class="listitem"><a name="function_acos"></a><p>
            <code class="literal">ACOS(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626405152"></a><p>
            <em class="replaceable"><code>X</code></em> のアークコサイン (つまり、コサインが <em class="replaceable"><code>X</code></em> である値) を返します。 <em class="replaceable"><code>X</code></em> が <code class="literal">-1</code> から <code class="literal">1</code> までの範囲内にない場合は、<code class="literal">NULL</code> を返します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ACOS(1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ACOS(1.0001);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT ACOS(0);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_asin"></a><p>
            <code class="literal">ASIN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626389968"></a><p>
            <em class="replaceable"><code>X</code></em> のアークサイン (つまり、サインが <em class="replaceable"><code>X</code></em> である値) を返します。 <em class="replaceable"><code>X</code></em> が <code class="literal">-1</code> から <code class="literal">1</code> までの範囲内にない場合は、<code class="literal">NULL</code> を返します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ASIN(0.2);</code></strong>
        -&gt; 0.20135792079033
mysql&gt; <strong class="userinput"><code>SELECT ASIN('foo');</code></strong>

+-------------+
| ASIN('foo') |
+-------------+
|           0 |
+-------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+-----------------------------------------+
| Level   | Code | Message                                 |
+---------+------+-----------------------------------------+
| Warning | 1292 | Truncated incorrect DOUBLE value: 'foo' |
+---------+------+-----------------------------------------+
</pre></li><li class="listitem"><a name="function_atan"></a><p>
            <code class="literal">ATAN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626374288"></a><p>
            <em class="replaceable"><code>X</code></em> のアークタンジェント (つまり、タンジェントが <em class="replaceable"><code>X</code></em> である値) を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ATAN(2);</code></strong>
        -&gt; 1.1071487177941
mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2);</code></strong>
        -&gt; -1.1071487177941
</pre></li><li class="listitem"><a name="function_atan2"></a><p>
            <code class="literal">ATAN(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">ATAN2(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626359968"></a><p>
            2 つの変数 <em class="replaceable"><code>X</code></em> および <em class="replaceable"><code>Y</code></em> のアークタンジェントを返します。 これは、両方の引数の符号が結果の象限の判定に使用される点を除いて、<code class="literal"><em class="replaceable"><code>Y</code></em> / <em class="replaceable"><code>X</code></em></code> のアークタンジェントの計算と同様です。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2,2);</code></strong>
        -&gt; -0.78539816339745
mysql&gt; <strong class="userinput"><code>SELECT ATAN2(PI(),0);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_ceil"></a><p>
            <code class="literal">CEIL(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626346592"></a><p>
            <code class="literal">CEIL()</code> は <code class="literal">CEILING()</code> のシノニムです。
          </p></li><li class="listitem"><a name="function_ceiling"></a><p>
            <code class="literal">CEILING(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626336672"></a><p>
            <em class="replaceable"><code>X</code></em> 以上で最小の整数値を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CEILING(1.23);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT CEILING(-1.23);</code></strong>
        -&gt; -1
</pre><p>
            引数が厳密値数値の場合は、戻り値の型も厳密値数値になります。 引数が文字列または浮動小数点の場合は、戻り値の型が浮動小数点になります。 
          </p></li><li class="listitem"><a name="function_conv"></a><p>
            <code class="literal">CONV(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>from_base</code></em>,<em class="replaceable"><code>to_base</code></em>)</code>
          </p><a class="indexterm" name="idm46041626323776"></a><p>
            数値を異なる基数間で変換します。 基数 <em class="replaceable"><code>from_base</code></em> から基数 <em class="replaceable"><code>to_base</code></em> に変換された数値 <em class="replaceable"><code>N</code></em> の文字列表現を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 引数 <em class="replaceable"><code>N</code></em> は整数として解釈されますが、整数または文字列として指定される場合もあります。 最小の基数は <code class="literal">2</code> で、最大の基数は <code class="literal">36</code> です。 <em class="replaceable"><code>from_base</code></em> が負数の場合、<em class="replaceable"><code>N</code></em> は符号付き数値とみなされます。 それ以外の場合は、<em class="replaceable"><code>N</code></em> は符号なしとみなされます。 <code class="literal">CONV()</code> は 64 ビット精度で動作します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONV('a',16,2);</code></strong>
        -&gt; '1010'
mysql&gt; <strong class="userinput"><code>SELECT CONV('6E',18,8);</code></strong>
        -&gt; '172'
mysql&gt; <strong class="userinput"><code>SELECT CONV(-17,10,-18);</code></strong>
        -&gt; '-H'
mysql&gt; <strong class="userinput"><code>SELECT CONV(10+'10'+'10'+X'0a',10,10);</code></strong>
        -&gt; '40'
</pre></li><li class="listitem"><a name="function_cos"></a><p>
            <code class="literal">COS(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626303600"></a><p>
            <em class="replaceable"><code>X</code></em> のコサインを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COS(PI());</code></strong>
        -&gt; -1
</pre></li><li class="listitem"><a name="function_cot"></a><p>
            <code class="literal">COT(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626292576"></a><p>
            <em class="replaceable"><code>X</code></em> のコタンジェントを返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COT(12);</code></strong>
        -&gt; -1.5726734063977
mysql&gt; <strong class="userinput"><code>SELECT COT(0);</code></strong>
        -&gt; out-of-range error
</pre></li><li class="listitem"><a name="function_crc32"></a><p>
            <code class="literal">CRC32(<em class="replaceable"><code>expr</code></em>)</code>
          </p><a class="indexterm" name="idm46041626281120"></a><p>
            巡回冗長検査値を計算し、32 ビット値の符号なし値を返します。 引数が <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。 引数は文字列であると想定され、(可能な場合は) 文字列でない場合でも文字列として処理されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CRC32('MySQL');</code></strong>
        -&gt; 3259397556
mysql&gt; <strong class="userinput"><code>SELECT CRC32('mysql');</code></strong>
        -&gt; 2501908538
</pre></li><li class="listitem"><a name="function_degrees"></a><p>
            <code class="literal">DEGREES(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626268240"></a><p>
            ラジアンからディグリーに変換された引数 <em class="replaceable"><code>X</code></em> を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI());</code></strong>
        -&gt; 180
mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI() / 2);</code></strong>
        -&gt; 90
</pre></li><li class="listitem"><a name="function_exp"></a><p>
            <code class="literal">EXP(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626256816"></a><p>
            <span class="emphasis"><em>e</em></span> (自然対数の底) の <em class="replaceable"><code>X</code></em> 乗の値を返します。 この関数の逆は、(単一の引数のみを使用する) <code class="literal">LOG()</code> または <code class="literal">LN()</code> です。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXP(2);</code></strong>
        -&gt; 7.3890560989307
mysql&gt; <strong class="userinput"><code>SELECT EXP(-2);</code></strong>
        -&gt; 0.13533528323661
mysql&gt; <strong class="userinput"><code>SELECT EXP(0);</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_floor"></a><p>
            <code class="literal">FLOOR(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626242112"></a><p>
            <em class="replaceable"><code>X</code></em> 以下で最大の整数値を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FLOOR(1.23), FLOOR(-1.23);</code></strong>
        -&gt; 1, -2
</pre><p>
            引数が厳密値数値の場合は、戻り値の型も厳密値数値になります。 引数が文字列または浮動小数点の場合は、戻り値の型が浮動小数点になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><p>
            数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。 詳細は、<a class="xref" href="functions.html#string-functions" title="12.8 文字列関数および演算子">セクション12.8「文字列関数および演算子」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm46041626227552"></a> <code class="literal">HEX(N_or_S)</code>
          </p><p>
            この関数を使用すると、10 進数または文字列の 16 進表現を取得できます。その方法は、引数の型によって異なります。 詳細は、<a class="xref" href="functions.html#string-functions" title="12.8 文字列関数および演算子">セクション12.8「文字列関数および演算子」</a>で、この関数の説明を参照してください。 
          </p></li><li class="listitem"><a name="function_ln"></a><p>
            <code class="literal">LN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626219088"></a><p>
            <em class="replaceable"><code>X</code></em> の自然対数 (つまり、<em class="replaceable"><code>X</code></em> の底 <span class="emphasis"><em>e</em></span> の対数) を返します。 <em class="replaceable"><code>X</code></em> が 0.0 E0 以下の場合、この関数は <code class="literal">NULL</code> を返し、<span class="quote">「<span class="quote">「対数の引数が無効です」</span>」</span>という警告が報告されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LN(2);</code></strong>
        -&gt; 0.69314718055995
mysql&gt; <strong class="userinput"><code>SELECT LN(-2);</code></strong>
        -&gt; NULL
</pre><p>
            この関数は <code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code> のシノニムです。 この関数の逆は、<code class="literal">EXP()</code> 関数です。 
          </p></li><li class="listitem"><a name="function_log"></a><p>
            <code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626200464"></a><p>
            1 つのパラメータで呼び出される場合、この関数は <em class="replaceable"><code>X</code></em> の自然対数を返します。 <em class="replaceable"><code>X</code></em> が 0.0 E0 以下の場合、この関数は <code class="literal">NULL</code> を返し、<span class="quote">「<span class="quote">「対数の引数が無効です」</span>」</span>という警告が報告されます。 
          </p><p>
            この関数 (単一の引数で呼び出された場合) の逆は、<code class="literal">EXP()</code> 関数です。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG(2);</code></strong>
        -&gt; 0.69314718055995
mysql&gt; <strong class="userinput"><code>SELECT LOG(-2);</code></strong>
        -&gt; NULL
</pre><p>
            この関数が 2 つのパラメータで呼び出される場合は、<em class="replaceable"><code>B</code></em> を底とする <em class="replaceable"><code>X</code></em> の対数が返されます。 <em class="replaceable"><code>X</code></em> が 0 以下である場合、または <em class="replaceable"><code>B</code></em> が 1 以下である場合は、<code class="literal">NULL</code> が返されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG(2,65536);</code></strong>
        -&gt; 16
mysql&gt; <strong class="userinput"><code>SELECT LOG(10,100);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT LOG(1,100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code> は <code class="literal">LOG(<em class="replaceable"><code>X</code></em>) / LOG(<em class="replaceable"><code>B</code></em>)</code> と同等です。
          </p></li><li class="listitem"><a name="function_log2"></a><p>
            <code class="literal">LOG2(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626175408"></a><p>
            <code class="literal"><em class="replaceable"><code>X</code></em></code> の底 2 の対数を返します。 <em class="replaceable"><code>X</code></em> が 0.0 E0 以下の場合、この関数は <code class="literal">NULL</code> を返し、<span class="quote">「<span class="quote">「対数の引数が無効です」</span>」</span>という警告が報告されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG2(65536);</code></strong>
        -&gt; 16
mysql&gt; <strong class="userinput"><code>SELECT LOG2(-100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG2()</code> は、格納に必要なビット数を調べる際に役立ちます。 この関数は式 <code class="literal">LOG(<em class="replaceable"><code>X</code></em>) / LOG(2)</code> と同等です。 
          </p></li><li class="listitem"><a name="function_log10"></a><p>
            <code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626159024"></a><p>
            <em class="replaceable"><code>X</code></em> の底 10 の対数を返します。 <em class="replaceable"><code>X</code></em> が 0.0 E0 以下の場合、この関数は <code class="literal">NULL</code> を返し、<span class="quote">「<span class="quote">「対数の引数が無効です」</span>」</span>という警告が報告されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG10(2);</code></strong>
        -&gt; 0.30102999566398
mysql&gt; <strong class="userinput"><code>SELECT LOG10(100);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT LOG10(-100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code> は <code class="literal">LOG(10,<em class="replaceable"><code>X</code></em>)</code> と同等です。
          </p></li><li class="listitem"><a name="function_mod"></a><p>
            <code class="literal">MOD(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>M</code></em>)</code>, <code class="literal"><em class="replaceable"><code>N</code></em> % <em class="replaceable"><code>M</code></em></code>, <code class="literal"><em class="replaceable"><code>N</code></em> MOD <em class="replaceable"><code>M</code></em></code>
          </p><a class="indexterm" name="idm46041626138336"></a><a class="indexterm" name="idm46041626137248"></a><a class="indexterm" name="idm46041626136160"></a><a class="indexterm" name="idm46041626134688"></a><a class="indexterm" name="idm46041626133344"></a><p>
            モジュロ演算。 <em class="replaceable"><code>M</code></em> で除算された <em class="replaceable"><code>N</code></em> の余りを返します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(234, 10);</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT 253 % 7;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT 29 MOD 9;</code></strong>
        -&gt; 2
</pre><p>
            この関数は、<code class="literal">BIGINT</code> 値でも安全に使用できます。
          </p><p>
            <code class="literal">MOD()</code> は、小数部を持つ値でも機能し、除算後の正確な余りを返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(34.5,3);</code></strong>
        -&gt; 1.5
</pre><p>
            <code class="literal">MOD(<em class="replaceable"><code>N</code></em>,0)</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_pi"></a><p>
            <code class="literal">PI()</code>
          </p><a class="indexterm" name="idm46041626113760"></a><p>
            π (pi) の値を返します。 表示されるデフォルトの小数点以下の桁数は 7 ですが、MySQL では内部的に全倍精度値が使用されます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PI();</code></strong>
        -&gt; 3.141593
mysql&gt; <strong class="userinput"><code>SELECT PI()+0.000000000000000000;</code></strong>
        -&gt; 3.141592653589793116
</pre></li><li class="listitem"><a name="function_pow"></a><p>
            <code class="literal">POW(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code>
          </p><a class="indexterm" name="idm46041626102016"></a><p>
            <em class="replaceable"><code>X</code></em> の <em class="replaceable"><code>Y</code></em> 乗の値を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT POW(2,2);</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT POW(2,-2);</code></strong>
        -&gt; 0.25
</pre></li><li class="listitem"><a name="function_power"></a><p>
            <code class="literal">POWER(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code>
          </p><a class="indexterm" name="idm46041626090032"></a><p>
            これは <code class="literal">POW()</code> のシノニムです。
          </p></li><li class="listitem"><a name="function_radians"></a><p>
            <code class="literal">RADIANS(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041626081040"></a><p>
            ディグリーからラジアンに変換された引数 <em class="replaceable"><code>X</code></em> を返します。 (ラジアンは 180 度になります。) 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RADIANS(90);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_rand"></a><p>
            <code class="literal">RAND([<em class="replaceable"><code>N</code></em>])</code>
          </p><a class="indexterm" name="idm46041626070224"></a><p>
            <code class="literal">0</code> &lt;= <em class="replaceable"><code>v</code></em> &lt; <code class="literal">1.0</code> の範囲内で、ランダムな浮動小数点値 <em class="replaceable"><code>v</code></em> を返します。 <em class="replaceable"><code>i</code></em> &lt;= <em class="replaceable"><code>R</code></em> &lt; <em class="replaceable"><code>j</code></em> の範囲内でランダムな整数 <em class="replaceable"><code>R</code></em> を取得するには、式 <code class="literal">FLOOR(<em class="replaceable"><code>i</code></em> + RAND() * (<em class="replaceable"><code>j</code></em></code> − <code class="literal"><em class="replaceable"><code>i</code></em>))</code> を使用します。 たとえば、<code class="literal">7</code> &lt;=<em class="replaceable"><code>R</code></em> &lt; <code class="literal">12</code> の範囲のランダム整数を取得するには、次のステートメントを使用します: 
          </p><pre class="programlisting">SELECT FLOOR(7 + (RAND() * 5));
</pre><p>
            整数引数 <em class="replaceable"><code>N</code></em> が指定されている場合は、シード値として使用されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                定数イニシャライザ引数を使用すると、ステートメントの準備時に、実行前にシードが一度初期化されます。
              </p></li><li class="listitem"><p>
                定数以外のイニシャライザ引数 (カラム名など) を使用すると、シードは <code class="literal">RAND()</code> の起動ごとに値で初期化されます。
              </p></li></ul></div><p>
            この動作の影響の 1 つは、等しい引数値の場合、<code class="literal">RAND(<em class="replaceable"><code>N</code></em>)</code> は毎回同じ値を返すため、カラム値の繰返し可能なシーケンスを生成することです。 次の例では、<code class="literal">RAND(3)</code> によって生成される値の順序は両方とも同じです。 
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i INT);</code></strong>
Query OK, 0 rows affected (0.42 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong>
+------+------------------+
| i    | RAND()           |
+------+------------------+
|    1 | 0.61914388706828 |
|    2 | 0.93845168309142 |
|    3 | 0.83482678498591 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong>
+------+------------------+
| i    | RAND(3)          |
+------+------------------+
|    1 | 0.90576975597606 |
|    2 | 0.37307905813035 |
|    3 | 0.14808605345719 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong>
+------+------------------+
| i    | RAND()           |
+------+------------------+
|    1 | 0.35877890638893 |
|    2 | 0.28941420772058 |
|    3 | 0.37073435016976 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong>
+------+------------------+
| i    | RAND(3)          |
+------+------------------+
|    1 | 0.90576975597606 |
|    2 | 0.37307905813035 |
|    3 | 0.14808605345719 |
+------+------------------+
3 rows in set (0.01 sec)
</pre><p>
            <code class="literal">WHERE</code> 句内の <code class="literal">RAND()</code> は、行ごと (テーブルから選択する場合) または行の組合せごと (複数テーブル結合から選択する場合) に評価されます。 したがって、オプティマイザのために、<code class="literal">RAND()</code> は定数値ではなく、インデックスの最適化に使用できません。 詳細は、<a class="xref" href="optimization.html#function-optimization" title="8.2.1.20 関数コールの最適化">セクション8.2.1.20「関数コールの最適化」</a>を参照してください。 
          </p><p>
            <code class="literal">ORDER BY</code> 句または <code class="literal">GROUP BY</code> 句で <code class="literal">RAND()</code> 値を含むカラムを使用すると、いずれかの句で <code class="literal">RAND()</code> 式が同じ行に対して複数回評価され、毎回異なる結果が返されるため、予期しない結果になる可能性があります。 行をランダムな順序で取得することを目的としている場合は、次のようなステートメントを使用できます: 
          </p><pre class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> ORDER BY RAND();
</pre><p>
            一連の行からランダムサンプルを選択するには、<code class="literal">ORDER BY RAND()</code> と <code class="literal">LIMIT</code> を組み合せます:
          </p><pre class="programlisting">SELECT * FROM table1, table2 WHERE a=b AND c&lt;d ORDER BY RAND() LIMIT 1000;
</pre><p>
            <code class="literal">RAND()</code> は、完全なランダムジェネレータとしては設計されていません。 要求に応じてランダムな数字をすばやく生成する方法であり、同じ MySQL バージョンのプラットフォーム間で移植可能です。 
          </p><p>
            この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
          </p></li><li class="listitem"><a name="function_round"></a><p>
            <code class="literal">ROUND(<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">ROUND(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><a class="indexterm" name="idm46041626017552"></a><p>
            引数 <em class="replaceable"><code>X</code></em> を <em class="replaceable"><code>D</code></em> 小数点に丸めます。 丸めアルゴリズムは、<em class="replaceable"><code>X</code></em> のデータ型に依存します。 <em class="replaceable"><code>D</code></em> が指定されていない場合は、デフォルトで 0 に設定されます。 <em class="replaceable"><code>D</code></em> を負の数に指定すると、値 <em class="replaceable"><code>X</code></em> の小数点左側の <em class="replaceable"><code>D</code></em> 桁をゼロにすることができます。 <em class="replaceable"><code>D</code></em> の最大絶対値は 30 です。30 (または -30) を超える桁は切り捨てられます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.23);</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.58);</code></strong>
        -&gt; -2
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.58);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 1);</code></strong>
        -&gt; 1.3
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT ROUND(23.298, -1);</code></strong>
        -&gt; 20
mysql&gt; <strong class="userinput"><code>SELECT ROUND(.12345678901234567890123456789012345, 35);</code></strong>
        -&gt; 0.123456789012345678901234567890
</pre><p>
            戻り値の型は、最初の引数と同じです (integer、double または decimal であると想定)。 つまり、引数が整数の場合は、結果が整数 (小数点なし) になります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(150.000,2), ROUND(150,2);</code></strong>
+------------------+--------------+
| ROUND(150.000,2) | ROUND(150,2) |
+------------------+--------------+
|           150.00 |          150 |
+------------------+--------------+
</pre><p>
            <code class="literal">ROUND()</code> では、第 1 引数の型に応じて次のルールが使用されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                真値の数字の場合、<code class="literal">ROUND()</code> では<span class="quote">「<span class="quote">四捨五入</span>」</span>または<span class="quote">「<span class="quote">切り捨て (切り上げ)</span>」</span> ルールが使用されます。0.5 以上の小数部を持つ値は、正の場合は次の整数に切り上げられ、負の場合は次の整数に切り下げられます。 (つまり、ゼロから遠い方に丸められます。) 0.5 未満の小数部を持つ値は、正の場合は次の整数に切り下げられ、負の場合は次の整数に切り上げられます。 
              </p></li><li class="listitem"><p>
                近似値の数字の場合、結果は C ライブラリによって異なります。 多くのシステムでは、これは <code class="literal">ROUND()</code> が<span class="quote">「<span class="quote">「最も近い偶数に丸める」</span>」</span>ルールを使用することを意味: 2 つの整数の間に小数部がある値は、最も近い偶数の整数に丸められます。 
              </p></li></ul></div><p>
            次の例では、正確な値の丸めと近似値の丸めの相違点を示します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong>
+------------+--------------+
| ROUND(2.5) | ROUND(25E-1) |
+------------+--------------+
| 3          |            2 |
+------------+--------------+
</pre><p>
            詳細は、<a class="xref" href="functions.html#precision-math" title="12.25 高精度計算">セクション12.25「高精度計算」</a>を参照してください。
          </p><p>
            MySQL 8.0.21 以降では、<code class="literal">ROUND()</code> (および <code class="literal">TRUNCATE()</code>) によって返されるデータ型は、次に示すルールに従って決定されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                最初の引数が任意の整数型の場合、戻り型は常に <code class="literal">BIGINT</code> です。
              </p></li><li class="listitem"><p>
                最初の引数が浮動小数点型または非数値型の場合、戻り型は常に <code class="literal">DOUBLE</code> です。
              </p></li><li class="listitem"><p>
                最初の引数が <code class="literal">DECIMAL</code> 値の場合、戻り型も <code class="literal">DECIMAL</code> です。
              </p></li><li class="listitem"><p>
                戻り値の型属性も最初の引数からコピーされますが、<code class="literal">DECIMAL</code> の場合は、2 番目の引数が定数値の場合を除きます。
              </p><p>
                小数点以下の桁数が引数の位取りより小さい場合は、結果の位取りと精度が適宜調整されます。
              </p><p>
                また、<code class="literal">ROUND()</code> (<code class="literal">TRUNCATE()</code> 関数ではありません) の場合、精度は、有効桁数を増やす端数処理に対応するために 1 箇所まで拡張されます。 2 番目の引数が負の場合、戻り値の型は、対応する精度でスケールが 0 になるように調整されます。 たとえば、<code class="literal">ROUND(99.999, 2)</code> は <code class="literal">100.00</code> を返します。最初の引数は <code class="literal">DECIMAL(5, 3)</code> で、戻り値の型は <code class="literal">DECIMAL(5, 2)</code> です。 
              </p><p>
                2 番目の引数が負の場合、戻り値の型はスケール 0 および対応する精度を持ち、<code class="literal">ROUND(99.999, -1)</code> は <code class="literal">100</code> (<code class="literal">DECIMAL(3, 0)</code>) を返します。
              </p></li></ul></div></li><li class="listitem"><a name="function_sign"></a><p>
            <code class="literal">SIGN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041625964192"></a><p>
            <em class="replaceable"><code>X</code></em> が負、ゼロ、または正のいずれであるのかに応じて、引数の符号を <code class="literal">-1</code>、<code class="literal">0</code>、または <code class="literal">1</code> として返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SIGN(-32);</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT SIGN(0);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT SIGN(234);</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_sin"></a><p>
            <code class="literal">SIN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041625949968"></a><p>
            <em class="replaceable"><code>X</code></em> のサインを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SIN(PI());</code></strong>
        -&gt; 1.2246063538224e-16
mysql&gt; <strong class="userinput"><code>SELECT ROUND(SIN(PI()));</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="function_sqrt"></a><p>
            <code class="literal">SQRT(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041625938144"></a><p>
            負ではない数字 <em class="replaceable"><code>X</code></em> の平方根を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SQRT(4);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT SQRT(20);</code></strong>
        -&gt; 4.4721359549996
mysql&gt; <strong class="userinput"><code>SELECT SQRT(-16);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_tan"></a><p>
            <code class="literal">TAN(<em class="replaceable"><code>X</code></em>)</code>
          </p><a class="indexterm" name="idm46041625926064"></a><p>
            <em class="replaceable"><code>X</code></em> のタンジェントを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TAN(PI());</code></strong>
        -&gt; -1.2246063538224e-16
mysql&gt; <strong class="userinput"><code>SELECT TAN(PI()+1);</code></strong>
        -&gt; 1.5574077246549
</pre></li><li class="listitem"><a name="function_truncate"></a><p>
            <code class="literal">TRUNCATE(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><a class="indexterm" name="idm46041625913792"></a><p>
            <em class="replaceable"><code>D</code></em> 小数点に切り捨てて、数字 <em class="replaceable"><code>X</code></em> を返します。 <em class="replaceable"><code>D</code></em> が <code class="literal">0</code> の場合は、結果に小数点または小数部が含まれません。 <em class="replaceable"><code>D</code></em> を負の数に指定すると、値 <em class="replaceable"><code>X</code></em> の小数点左側の <em class="replaceable"><code>D</code></em> 桁をゼロにすることができます。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.223,1);</code></strong>
        -&gt; 1.2
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,1);</code></strong>
        -&gt; 1.9
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(-1.999,1);</code></strong>
        -&gt; -1.9
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(122,-2);</code></strong>
       -&gt; 100
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(10.28*100,0);</code></strong>
       -&gt; 1028
</pre><p>
            すべての数字は、ゼロ方向に丸められます。
          </p><p>
            MySQL 8.0.21 以降では、<code class="literal">TRUNCATE()</code> によって返されるデータ型は、<code class="literal">ROUND()</code> 関数の戻り型を決定するものと同じルールに従います。詳細は、<code class="literal">ROUND()</code> の説明を参照してください。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="date-and-time-functions"></a>12.7 日付および時間関数</h2></div></div></div><a class="indexterm" name="idm46041625894880"></a><a class="indexterm" name="idm46041625893392"></a><p>
      このセクションでは、時間値の処理に使用できる関数について説明します。 各日付日時型が持つ値の範囲、および値を指定する際の有効な書式については、<a class="xref" href="data-types.html#date-and-time-types" title="11.2 日時データ型">セクション11.2「日時データ型」</a>を参照してください。 
    </p><div class="table"><a name="idm46041625889808"></a><p class="title"><b>表 12.11 「日付および時刻関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「日付と時刻の関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></td>
<td>
      日付値に時間値 (間隔) を加算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></td>
<td>
      時間を加算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></td>
<td>
      タイムゾーン間での変換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></td>
<td>
      現在の日付を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></td>
<td>
      CURDATE() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></td>
<td>
      CURTIME() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></td>
<td>
      NOW() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></td>
<td>
      現在の時間を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></td>
<td>
      日付または日付時間式の日付部分を抽出します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></td>
<td>
      日付値に時間値 (間隔) を加算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></td>
<td>
      日付を指定された書式に設定します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></td>
<td>
      日付から時間値 (間隔) を引きます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></td>
<td>
      2 つの日付の差を求めます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></td>
<td>
      DAYOFMONTH() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></td>
<td>
      曜日の名前を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></td>
<td>
      月の日を返します (0 - 31)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></td>
<td>
      引数の曜日インデックスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></td>
<td>
      年の日を返します (1 - 366)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></td>
<td>
      日付の一部を抽出します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></td>
<td>
      日数を日付に変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></td>
<td>
      Unix タイムスタンプを日付として書式設定
    </td>
</tr><tr><td><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></td>
<td>
      日付書式文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></td>
<td>
      時を抽出します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></td>
<td>
      引数の月の最終日を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></td>
<td>
      NOW() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></td>
<td>
      NOW() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></td>
<td>
      年と年間通算日から日付を作成します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></td>
<td>
      時、分、秒から時間を作成します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></td>
<td>
      引数からマイクロ秒を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></td>
<td>
      引数から分を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></td>
<td>
      渡された日付から月を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></td>
<td>
      月の名前を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></td>
<td>
      現在の日付と時間を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></td>
<td>
      年月に期間を加算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></td>
<td>
      期間内の月数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></td>
<td>
      日付引数から四半期を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></td>
<td>
      秒を hh:mm:ss 形式に変換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></td>
<td>
      秒 (0-59) を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></td>
<td>
      文字列を日付に変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></td>
<td>
      3 つの引数で呼び出されるときは DATE_SUB() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></td>
<td>
      時間の差を求めます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></td>
<td>
      この関数が実行される時間を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></td>
<td>
      渡された式の時部分を抽出します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></td>
<td>
      時間として書式設定します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></td>
<td>
      秒に変換された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></td>
<td>
      時間の差を求めます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></td>
<td>
      引数が 1 つの場合、この関数は日付または日付時間式を返します。引数が 2 つの場合、引数の合計を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></td>
<td>
      日付時間式に間隔を加算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></td>
<td>
      日付時間式から間隔を減算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></td>
<td>
      日に変換された日付引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></td>
<td>
      0 年以降の秒数に変換された日付または日付時間引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></td>
<td>
      Unix タイムスタンプを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></td>
<td>
      現在の UTC 日付を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></td>
<td>
      現在の UTC 時間を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></td>
<td>
      現在の UTC 日付と時間を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></td>
<td>
      週番号を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></td>
<td>
      曜日インデックスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></td>
<td>
      日付の暦週を返します (1 - 53)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></td>
<td>
      年を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></td>
<td>
      年と週を返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      次に、日付関数の使用例を示します。 次のクエリーは、過去 30 日以内の <em class="replaceable"><code>date_col</code></em> 値を含むすべての行を選択します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT <em class="replaceable"><code>something</code></em> FROM <em class="replaceable"><code>tbl_name</code></em></code></strong>
    -&gt; <strong class="userinput"><code>WHERE DATE_SUB(CURDATE(),INTERVAL 30 DAY) &lt;= <em class="replaceable"><code>date_col</code></em>;</code></strong>
</pre><p>
      このクエリーは、将来の日付を持つ行も選択します。
    </p><p>
      通常、日付値が要求される関数では、日付時間値が受け入れられ、時間の部分は無視されます。 通常、時間値が要求される関数では、日付時間値が受け入れられ、日付の部分は無視されます。 
    </p><p>
      現在の日付または時間をそれぞれ返す関数は、クエリー実行の開始時にクエリーごとに 1 回だけ評価されます。 つまり、<code class="literal">NOW()</code> などの関数が単一クエリー内で複数回参照されても、常に同じ結果が生成されます。 (設計上、単一クエリーにはストアドプログラム (ストアドルーチン、トリガー、またはイベント) の呼び出し、およびそのプログラムによって呼び出されるすべてのサブプログラムも含まれています。) この原則は、<code class="literal">CURDATE()</code>、<code class="literal">CURTIME()</code>、<code class="literal">UTC_DATE()</code>、<code class="literal">UTC_TIME()</code>、<code class="literal">UTC_TIMESTAMP()</code>、およびそれらのシノニムにも適用されます。 
    </p><p>
      <code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_DATE()</code> および <code class="literal">FROM_UNIXTIME()</code> 関数は、<code class="literal">time_zone</code> システム変数のセッション値として使用可能な現在のセッションタイムゾーンの値を返します。 また、<code class="literal">UNIX_TIMESTAMP()</code> では、引数がセッションタイムゾーンの日時値であると想定しています。 <a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a>を参照してください。 
    </p><p>
      <span class="quote">「<span class="quote">zero</span>」</span> 日付または <code class="literal">'2001-11-00'</code> のような不完全な日付とともに使用できる日付関数もありますが、使用できない日付関数もあります。 通常、日付の一部を抽出する関数は不完全な日付でも正しく機能するため、ゼロ以外の値が要求される場合に 0 を返すことができます。 例: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2001-11-00'), MONTH('2005-00-00');</code></strong>
        -&gt; 0, 0
</pre><p>
      その他の関数では完全な日付が要求され、日付が不完全な場合は <code class="literal">NULL</code> が返されます。 これらには、日付演算を実行する関数や日付の一部を名前にマップする関数が含まれます。 例: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2006-05-00',INTERVAL 1 DAY);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2006-05-00');</code></strong>
        -&gt; NULL
</pre><p>
      <code class="literal">DATE()</code> 関数の値を引数として渡し、日部分がゼロの不完全な日付を拒否すると、いくつかの関数が厳密になります: <code class="literal">CONVERT_TZ()</code>, <code class="literal">DATE_ADD()</code>, <code class="literal">DATE_SUB()</code>, <code class="literal">DAYOFYEAR()</code>, <code class="literal">TIMESTAMPDIFF()</code>, <code class="literal">TO_DAYS()</code>, <code class="literal">TO_SECONDS()</code>, <code class="literal">WEEK()</code>, <code class="literal">WEEKDAY()</code>, <code class="literal">WEEKOFYEAR()</code>, <code class="literal">YEARWEEK()</code>。
    </p><p>
      <code class="literal">TIME</code>、<code class="literal">DATETIME</code> および <code class="literal">TIMESTAMP</code> 値の小数秒は、マイクロ秒までの精度でサポートされます。 時間引数を取る関数は、小数秒を含む値を受け入れます。 時間関数からの戻り値には、必要に応じて小数秒が含まれます。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_adddate"></a><p>
          <code class="literal">ADDDATE(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>, <code class="literal">ADDDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code>
        </p><a class="indexterm" name="idm46041625646000"></a><p>
          <code class="literal">INTERVAL</code> 形式の 2 番目の引数を付けて呼び出されると、<code class="literal">ADDDATE()</code> は <code class="literal">DATE_ADD()</code> のシノニムになります。 関連する関数 <code class="literal">SUBDATE()</code> は <code class="literal">DATE_SUB()</code> のシノニムです。 <code class="literal">INTERVAL</code> <em class="replaceable"><code>unit</code></em> 引数の詳細は、<a class="xref" href="language-structure.html#temporal-intervals" title="時間間隔">時間間隔</a> を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2008-02-02'
mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2008-02-02'
</pre><p>
          <em class="replaceable"><code>days</code></em> 形式の 2 番目の引数を付けて呼び出されると、MySQL では <em class="replaceable"><code>expr</code></em> に加算される整数の日数として処理されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', 31);</code></strong>
        -&gt; '2008-02-02'
</pre></li><li class="listitem"><a name="function_addtime"></a><p>
          <code class="literal">ADDTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041625624480"></a><p>
          <code class="literal">ADDTIME()</code> は <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr1</code></em> を加算し、その結果を返します。<em class="replaceable"><code>expr1</code></em> は時間または日付時間式であり、<em class="replaceable"><code>expr2</code></em> は時間式です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('2007-12-31 23:59:59.999999', '1 1:1:1.000002');</code></strong>
        -&gt; '2008-01-02 01:01:01.000001'
mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('01:00:00.999999', '02:00:00.999998');</code></strong>
        -&gt; '03:00:01.999997'
</pre></li><li class="listitem"><a name="function_convert-tz"></a><p>
          <code class="literal">CONVERT_TZ(<em class="replaceable"><code>dt</code></em>,<em class="replaceable"><code>from_tz</code></em>,<em class="replaceable"><code>to_tz</code></em>)</code>
        </p><a class="indexterm" name="idm46041625609600"></a><p>
          <code class="literal">CONVERT_TZ()</code> は、日付時間値 <em class="replaceable"><code>dt</code></em> を <em class="replaceable"><code>from_tz</code></em> で指定されたタイムゾーンから、<em class="replaceable"><code>to_tz</code></em> で指定されたタイムゾーンに変換し、結果の値を返します。 タイムゾーンは、<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a>で説明されているように指定されます。 引数が無効な場合、この関数は <code class="literal">NULL</code> を返します。 
        </p><p>
          <em class="replaceable"><code>from_tz</code></em> から UTC に変換される際に、値が <code class="literal">TIMESTAMP</code> でサポートされている範囲から外れている場合は、変換が実行されません。 <code class="literal">TIMESTAMP</code> の範囲については、<a class="xref" href="data-types.html#date-and-time-type-syntax" title="11.2.1 日時データ型の構文">セクション11.2.1「日時データ型の構文」</a>で説明されています。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','GMT','MET');</code></strong>
        -&gt; '2004-01-01 13:00:00'
mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00');</code></strong>
        -&gt; '2004-01-01 22:00:00'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">'MET'</code>や<code class="literal">'Europe/Amsterdam'</code>などの名前付きタイムゾーンを使用するには、タイムゾーンテーブルが適切に設定されている必要があります。 その手順は、<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a>を参照してください。 
          </p></div></li><li class="listitem"><a name="function_curdate"></a><p>
          <code class="literal">CURDATE()</code>
        </p><a class="indexterm" name="idm46041625587840"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の日付を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD</code></em>'</code>または <em class="replaceable"><code>YYYYMMDD</code></em> 形式の値として返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CURDATE();</code></strong>
        -&gt; '2008-06-13'
mysql&gt; <strong class="userinput"><code>SELECT CURDATE() + 0;</code></strong>
        -&gt; 20080613
</pre></li><li class="listitem"><a name="function_current-date"></a><p>
          <code class="literal">CURRENT_DATE</code>, <code class="literal">CURRENT_DATE()</code>
        </p><a class="indexterm" name="idm46041625574512"></a><p>
          <code class="literal">CURRENT_DATE</code> および <code class="literal">CURRENT_DATE()</code> は <code class="literal">CURDATE()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_current-time"></a><p>
          <code class="literal">CURRENT_TIME</code>, <code class="literal">CURRENT_TIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041625562656"></a><p>
          <code class="literal">CURRENT_TIME</code> および <code class="literal">CURRENT_TIME()</code> は <code class="literal">CURTIME()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_current-timestamp"></a><p>
          <code class="literal">CURRENT_TIMESTAMP</code>, <code class="literal">CURRENT_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041625550720"></a><p>
          <code class="literal">CURRENT_TIMESTAMP</code> および <code class="literal">CURRENT_TIMESTAMP()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_curtime"></a><p>
          <code class="literal">CURTIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041625539888"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の時間を<em class="replaceable"><code>'hh:mm:ss'</code></em>または <em class="replaceable"><code>hhmmss</code></em> 形式の値として返します。 値はセッションのタイムゾーンで表されます。 
        </p><p>
          0 から 6 までの小数秒精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合、戻り値にはその桁数の小数秒部分が含まれます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CURTIME();</code></strong>
        -&gt; '23:50:26'
mysql&gt; <strong class="userinput"><code>SELECT CURTIME() + 0;</code></strong>
        -&gt; 235026.000000
</pre></li><li class="listitem"><a name="function_date"></a><p>
          <code class="literal">DATE(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041625526400"></a><p>
          日付または日付時間式 <em class="replaceable"><code>expr</code></em> の日付部分を抽出します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE('2003-12-31 01:02:03');</code></strong>
        -&gt; '2003-12-31'
</pre></li><li class="listitem"><a name="function_datediff"></a><p>
          <code class="literal">DATEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041625515248"></a><p>
          <code class="literal">DATEDIFF()</code> は、ある日付から別の日付までの日数の値として表現された <em class="replaceable"><code>expr1</code></em> − <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> および <em class="replaceable"><code>expr2</code></em> は、日付または日付時間式です。 値の日付部分のみが計算に使用されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2007-12-31 23:59:59','2007-12-30');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2010-11-30 23:59:59','2010-12-31');</code></strong>
        -&gt; -31
</pre></li><li class="listitem"><a name="function_date-add"></a><p>
          <code class="literal">DATE_ADD(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>, <code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>
        </p><a class="indexterm" name="idm46041625498000"></a><a class="indexterm" name="idm46041625496656"></a><p>
          これらの関数は日付演算を実行します。 <em class="replaceable"><code>date</code></em> 引数は、開始日または日時の値を指定します。<em class="replaceable"><code>expr</code></em> は、開始日に対して加算または減算される間隔値を指定する式です。<em class="replaceable"><code>expr</code></em> は文字列として評価されます。負の間隔では <code class="literal">-</code> で始まる場合があります。<em class="replaceable"><code>unit</code></em> は、式を解釈する単位を示すキーワードです。 
        </p><p>
          <em class="replaceable"><code>unit</code></em> 指定子の完全なリスト、各 <em class="replaceable"><code>unit</code></em> 値に必要な <em class="replaceable"><code>expr</code></em> 引数の形式、および時間演算でのオペランド解釈の規則など、時間間隔構文の詳細は、<a class="xref" href="language-structure.html#temporal-intervals" title="時間間隔">時間間隔</a> を参照してください。
        </p><p>
          戻り値は引数によって異なります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>date</code></em> 引数が <code class="literal">DATE</code> 値で、計算に <code class="literal">YEAR</code>、<code class="literal">MONTH</code> および <code class="literal">DAY</code> 部分のみが含まれる (つまり、時間部分が含まれない) 場合は、<code class="literal">DATE</code>。
            </p></li><li class="listitem"><p>
              第 1 引数が <code class="literal">DATETIME</code> (または <code class="literal">TIMESTAMP</code>) 値である場合と、第 1 引数が <code class="literal">DATE</code> で、<em class="replaceable"><code>unit</code></em> 値に <code class="literal">HOURS</code>、<code class="literal">MINUTES</code>、または <code class="literal">SECONDS</code> が使用されている場合は、<code class="literal">DATETIME</code> です。
            </p></li><li class="listitem"><p>
              それ以外の場合は文字列です。
            </p></li></ul></div><p>
          必ず結果が <code class="literal">DATETIME</code> になるようにするには、<code class="literal">CAST()</code> を使用すれば、第 1 引数を <code class="literal">DATETIME</code> に変換できます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2018-05-01',INTERVAL 1 DAY);</code></strong>
        -&gt; '2018-05-02'
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2018-05-01',INTERVAL 1 YEAR);</code></strong>
        -&gt; '2017-05-01'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2020-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL 1 SECOND);</code></strong>
        -&gt; '2021-01-01 00:00:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2018-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL 1 DAY);</code></strong>
        -&gt; '2019-01-01 23:59:59'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2100-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '1:1' MINUTE_SECOND);</code></strong>
        -&gt; '2101-01-01 00:01:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2025-01-01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '1 1:1:1' DAY_SECOND);</code></strong>
        -&gt; '2024-12-30 22:58:59'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1900-01-01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '-1 10' DAY_HOUR);</code></strong>
        -&gt; '1899-12-30 14:00:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('1998-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '1997-12-02'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1992-12-31 23:59:59.000002',</code></strong>
    -&gt;            <strong class="userinput"><code>INTERVAL '1.999999' SECOND_MICROSECOND);</code></strong>
        -&gt; '1993-01-01 00:00:01.000001'
</pre></li><li class="listitem"><a name="function_date-format"></a><p>
          <code class="literal">DATE_FORMAT(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><a class="indexterm" name="idm46041625450352"></a><p>
          <em class="replaceable"><code>format</code></em> 文字列に従って、<em class="replaceable"><code>date</code></em> 値を書式設定します。
        </p><p>
          次のテーブルに示す指定子は、<em class="replaceable"><code>format</code></em> 文字列で使用できます。 書式指定子文字の前には、<code class="literal">%</code> 文字を付ける必要があります。 指定子は他の関数にも適用されます: <code class="literal">STR_TO_DATE()</code>, <code class="literal">TIME_FORMAT()</code>, <code class="literal">UNIX_TIMESTAMP()</code>。 
        </p><div class="informaltable"><table summary="Specifier characters for the DATE_FORMAT function that may be used in the format string and provides a description of each specifier character."><col style="width: 20%"><col style="width: 70%"><thead><tr>
              <th>指定子</th>
              <th>説明</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">%a</code></td>
              <td>簡略曜日名 (<code class="literal">Sun</code>..<code class="literal">Sat</code>)</td>
            </tr><tr>
              <td><code class="literal">%b</code></td>
              <td>簡略月名 (<code class="literal">Jan</code>..<code class="literal">Dec</code>)</td>
            </tr><tr>
              <td><code class="literal">%c</code></td>
              <td>月、数字 (<code class="literal">0</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td><code class="literal">%D</code></td>
              <td>英語のサフィクスを持つ日付 (<code class="literal">0th</code>, <code class="literal">1st</code>, <code class="literal">2nd</code>, <code class="literal">3rd</code>, …)</td>
            </tr><tr>
              <td><code class="literal">%d</code></td>
              <td>日、数字 (<code class="literal">00</code>..<code class="literal">31</code>)</td>
            </tr><tr>
              <td><code class="literal">%e</code></td>
              <td>日、数字 (<code class="literal">0</code>..<code class="literal">31</code>)</td>
            </tr><tr>
              <td><code class="literal">%f</code></td>
              <td>マイクロ秒 (<code class="literal">000000</code>..<code class="literal">999999</code>)</td>
            </tr><tr>
              <td><code class="literal">%H</code></td>
              <td>時間 (<code class="literal">00</code>..<code class="literal">23</code>)</td>
            </tr><tr>
              <td><code class="literal">%h</code></td>
              <td>時間 (<code class="literal">01</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td><code class="literal">%I</code></td>
              <td>時間 (<code class="literal">01</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td><code class="literal">%i</code></td>
              <td>分、数字 (<code class="literal">00</code>..<code class="literal">59</code>)</td>
            </tr><tr>
              <td><code class="literal">%j</code></td>
              <td>年間通算日 (<code class="literal">001</code>..<code class="literal">366</code>)</td>
            </tr><tr>
              <td><code class="literal">%k</code></td>
              <td>時 (<code class="literal">0</code>..<code class="literal">23</code>)</td>
            </tr><tr>
              <td><code class="literal">%l</code></td>
              <td>時 (<code class="literal">1</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td><code class="literal">%M</code></td>
              <td>月名 (<code class="literal">January</code>..<code class="literal">December</code>)</td>
            </tr><tr>
              <td><code class="literal">%m</code></td>
              <td>月、数字 (<code class="literal">00</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td><code class="literal">%p</code></td>
              <td><code class="literal">AM</code> または <code class="literal">PM</code></td>
            </tr><tr>
              <td><code class="literal">%r</code></td>
              <td>時間、12 時間単位 (<em class="replaceable"><code>hh:mm:ss</code></em> に <code class="literal">AM</code> または <code class="literal">PM</code> が続く)</td>
            </tr><tr>
              <td><code class="literal">%S</code></td>
              <td>秒数 (<code class="literal">00</code><code class="literal">59</code>)</td>
            </tr><tr>
              <td><code class="literal">%s</code></td>
              <td>秒数 (<code class="literal">00</code><code class="literal">59</code>)</td>
            </tr><tr>
              <td><code class="literal">%T</code></td>
              <td>時間、24 時間単位 (<em class="replaceable"><code>hh:mm:ss</code></em>)</td>
            </tr><tr>
              <td><code class="literal">%U</code></td>
              <td>週 (<code class="literal">00</code>..<code class="literal">53</code>)、日曜日が週の初日、<code class="literal">WEEK()</code> モード 0</td>
            </tr><tr>
              <td><code class="literal">%u</code></td>
              <td>週 (<code class="literal">00</code>..<code class="literal">53</code>)、月曜日が週の初日、<code class="literal">WEEK()</code> モード 1</td>
            </tr><tr>
              <td><code class="literal">%V</code></td>
              <td>週 (<code class="literal">01</code>..<code class="literal">53</code>)、日曜日が週の初日、<code class="literal">WEEK()</code> モード 2、<code class="literal">%X</code> とともに使用</td>
            </tr><tr>
              <td><code class="literal">%v</code></td>
              <td>週 (<code class="literal">01</code>..<code class="literal">53</code>)、月曜日が週の初日、<code class="literal">WEEK()</code> モード 3、<code class="literal">%x</code> とともに使用</td>
            </tr><tr>
              <td><code class="literal">%W</code></td>
              <td>曜日名 (<code class="literal">Sunday</code>..<code class="literal">Saturday</code>)</td>
            </tr><tr>
              <td><code class="literal">%w</code></td>
              <td>曜日 (<code class="literal">0</code>=Sunday..<code class="literal">6</code>=Saturday)</td>
            </tr><tr>
              <td><code class="literal">%X</code></td>
              <td>年間の週、日曜日が週の初日、数字、4 桁、<code class="literal">%V</code> とともに使用</td>
            </tr><tr>
              <td><code class="literal">%x</code></td>
              <td>年間の週、月曜日が週の初日、数字、4 桁、<code class="literal">%v</code> とともに使用</td>
            </tr><tr>
              <td><code class="literal">%Y</code></td>
              <td>年、数字、4 桁</td>
            </tr><tr>
              <td><code class="literal">%y</code></td>
              <td>年、数字 (2 桁)</td>
            </tr><tr>
              <td><code class="literal">%%</code></td>
              <td>リテラル <code class="literal">%</code> 文字</td>
            </tr><tr>
              <td><code class="literal">%<em class="replaceable"><code>x</code></em></code></td>
              <td><em class="replaceable"><code>x</code></em> (上記にないすべての <span class="quote">「<span class="quote"><em class="replaceable"><code>x</code></em></span>」</span>)</td>
            </tr></tbody></table></div><p>
          MySQL では <code class="literal">'2014-00-00'</code> などの不完全な日付の格納が許可されるため、月および日の指定子の範囲はゼロから始まります。
        </p><p>
          日および月の名前と略語に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="charset.html#locale-support" title="10.16 MySQL Server のロケールサポート">セクション10.16「MySQL Server のロケールサポート」</a>) の値で制御されます。
        </p><p>
          <code class="literal">%U</code>、<code class="literal">%u</code>、<code class="literal">%V</code>、および <code class="literal">%v</code> 指定子のモード値については、<code class="literal">WEEK()</code> 関数の説明を参照してください。 モードによって、週番号が付与される方法が影響を受けます。 
        </p><p>
          <code class="literal">DATE_FORMAT()</code> は、ASCII 以外の文字を含む月および週の名前を返すことができるように、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> で指定された文字セットおよび照合順序を含む文字列を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2009-10-04 22:23:00', '%W %M %Y');</code></strong>
        -&gt; 'Sunday October 2009'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2007-10-04 22:23:00', '%H:%i:%s');</code></strong>
        -&gt; '22:23:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1900-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%D %y %a %d %m %b %j');</code></strong>
        -&gt; '4th 00 Thu 04 10 Oct 277'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1997-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%H %k %I %r %T %S %w');</code></strong>
        -&gt; '22 22 10 10:23:00 PM 22:23:00 00 6'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1999-01-01', '%X %V');</code></strong>
        -&gt; '1998 52'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2006-06-00', '%d');</code></strong>
        -&gt; '00'
</pre></li><li class="listitem"><a name="function_date-sub"></a><p>
          <code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>
        </p><a class="indexterm" name="idm46041625279488"></a><p>
          <code class="literal">DATE_ADD()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_day"></a><p>
          <code class="literal">DAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625270544"></a><p>
          <code class="literal">DAY()</code> は <code class="literal">DAYOFMONTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_dayname"></a><p>
          <code class="literal">DAYNAME(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625260608"></a><p>
          <em class="replaceable"><code>date</code></em> に対応する曜日の名前を返します。 名前に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="charset.html#locale-support" title="10.16 MySQL Server のロケールサポート">セクション10.16「MySQL Server のロケールサポート」</a>) の値で制御されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2007-02-03');</code></strong>
        -&gt; 'Saturday'
</pre></li><li class="listitem"><a name="function_dayofmonth"></a><p>
          <code class="literal">DAYOFMONTH(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625248144"></a><p>
          <code class="literal">1</code> から <code class="literal">31</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する日を返します。<code class="literal">'0000-00-00'</code> や <code class="literal">'2008-00-00'</code> のように日の部分がゼロの場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2007-02-03');</code></strong>
        -&gt; 3
</pre></li><li class="listitem"><a name="function_dayofweek"></a><p>
          <code class="literal">DAYOFWEEK(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625233872"></a><p>
          <em class="replaceable"><code>date</code></em> の曜日インデックス (<code class="literal">1</code> = Sunday、<code class="literal">2</code> = Monday、…、<code class="literal">7</code> = Saturday) を返します。 これらのインデックス値は、ODBC 標準に対応しています。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFWEEK('2007-02-03');</code></strong>
        -&gt; 7
</pre></li><li class="listitem"><a name="function_dayofyear"></a><p>
          <code class="literal">DAYOFYEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625220960"></a><p>
          <code class="literal">1</code> から <code class="literal">366</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する通日を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFYEAR('2007-02-03');</code></strong>
        -&gt; 34
</pre></li><li class="listitem"><a name="function_extract"></a><p>
          <code class="literal">EXTRACT(<em class="replaceable"><code>unit</code></em> FROM <em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625208480"></a><p>
          <code class="literal">EXTRACT()</code> 関数は、<code class="literal">DATE_ADD()</code> または <code class="literal">DATE_SUB()</code> と同じ種類の <em class="replaceable"><code>unit</code></em> 指定子を使用しますが、日付演算を実行するのではなく、日付から部分を抽出します。 <em class="replaceable"><code>unit</code></em> 引数の詳細は、<a class="xref" href="language-structure.html#temporal-intervals" title="時間間隔">時間間隔</a> を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR FROM '2019-07-02');</code></strong>
        -&gt; 2019
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR_MONTH FROM '2019-07-02 01:02:03');</code></strong>
        -&gt; 201907
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(DAY_MINUTE FROM '2019-07-02 01:02:03');</code></strong>
        -&gt; 20102
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(MICROSECOND</code></strong>
    -&gt;                <strong class="userinput"><code>FROM '2003-01-02 10:30:00.000123');</code></strong>
        -&gt; 123
</pre></li><li class="listitem"><a name="function_from-days"></a><p>
          <code class="literal">FROM_DAYS(<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041625190352"></a><p>
          日数 <em class="replaceable"><code>N</code></em> が指定され、<code class="literal">DATE</code> 値を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FROM_DAYS(730669);</code></strong>
        -&gt; '2000-07-03'
</pre><p>
          古い日付では、<code class="literal">FROM_DAYS()</code> を慎重に使用してください。 グレゴリオ暦 (1582) の出現よりも前の値とともに使用することを目的に設計されていません。 <a class="xref" href="functions.html#mysql-calendar" title="12.9 MySQL で使用されるカレンダー">セクション12.9「MySQL で使用されるカレンダー」</a>を参照してください。 
        </p></li><li class="listitem"><a name="function_from-unixtime"></a><p>
          <code class="literal">FROM_UNIXTIME(<em class="replaceable"><code>unix_timestamp</code></em>[,<em class="replaceable"><code>format</code></em>])</code>
        </p><a class="indexterm" name="idm46041625175600"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、<em class="replaceable"><code>unix_timestamp</code></em> 引数の表現を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>'</code>または <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> 形式の値として返します。<em class="replaceable"><code>unix_timestamp</code></em> は、<code class="literal">'1970-01-01 00:00:00'</code> UTC 以降の秒数を表す内部タイムスタンプ値で、<code class="literal">UNIX_TIMESTAMP()</code> 関数によって生成されます。
        </p><p>
          戻り値は、セッションのタイムゾーンで表されます。 (クライアントは、<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a> の説明に従ってセッションタイムゾーンを設定できます。) <em class="replaceable"><code>format</code></em> 文字列 (指定されている場合) は、<code class="literal">DATE_FORMAT()</code> 関数のエントリで説明されているのと同じ方法で結果を書式設定するために使用されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881);</code></strong>
        -&gt; '2015-11-13 10:08:01'
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881) + 0;</code></strong>
        -&gt; 20151113100801
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881,</code></strong>
    -&gt;                      <strong class="userinput"><code>'%Y %D %M %h:%i:%s %x');</code></strong>
        -&gt; '2015 13th November 10:08:01 2015'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">UNIX_TIMESTAMP()</code> および <code class="literal">FROM_UNIXTIME()</code> を使用して UTC 以外のタイムゾーンの値と Unix タイムスタンプ値の間で変換する場合、マッピングは双方向では一対一ではないため、変換は失われます。 詳細は <code class="literal">UNIX_TIMESTAMP()</code> 関数の説明を参照してください。 
          </p></div></li><li class="listitem"><a name="function_get-format"></a><p>
          <code class="literal">GET_FORMAT({DATE|TIME|DATETIME}, {'EUR'|'USA'|'JIS'|'ISO'|'INTERNAL'})</code>
        </p><a class="indexterm" name="idm46041625151184"></a><p>
          書式文字列を返します。 この関数は、<code class="literal">DATE_FORMAT()</code> および<code class="literal">STR_TO_DATE()</code> 関数と組み合わせて使用すると便利です。 
        </p><p>
          1 番目と 2 番目の引数に値を指定できるため、複数の書式文字列を生成できます (使用される指定子については、<code class="literal">DATE_FORMAT()</code> 関数の説明で示す表を参照してください)。 ISO 書式は ISO 8601 ではなく、ISO 9075 を参照しています。 
        </p><div class="informaltable"><table summary="Function calls for the GET_FORMAT function along with results for each function call."><col style="width: 60%"><col style="width: 40%"><thead><tr>
              <th>関数呼び出し</th>
              <th>結果</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">GET_FORMAT(DATE,'USA')</code></td>
              <td><code class="literal">'%m.%d.%Y'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATE,'JIS')</code></td>
              <td><code class="literal">'%Y-%m-%d'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATE,'ISO')</code></td>
              <td><code class="literal">'%Y-%m-%d'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATE,'EUR')</code></td>
              <td><code class="literal">'%d.%m.%Y'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATE,'INTERNAL')</code></td>
              <td><code class="literal">'%Y%m%d'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATETIME,'USA')</code></td>
              <td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATETIME,'JIS')</code></td>
              <td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATETIME,'ISO')</code></td>
              <td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATETIME,'EUR')</code></td>
              <td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(DATETIME,'INTERNAL')</code></td>
              <td><code class="literal">'%Y%m%d%H%i%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(TIME,'USA')</code></td>
              <td><code class="literal">'%h:%i:%s %p'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(TIME,'JIS')</code></td>
              <td><code class="literal">'%H:%i:%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(TIME,'ISO')</code></td>
              <td><code class="literal">'%H:%i:%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(TIME,'EUR')</code></td>
              <td><code class="literal">'%H.%i.%s'</code></td>
            </tr><tr>
              <td><code class="literal">GET_FORMAT(TIME,'INTERNAL')</code></td>
              <td><code class="literal">'%H%i%s'</code></td>
            </tr></tbody></table></div><p>
          <code class="literal">TIMESTAMP</code> は、<code class="literal">GET_FORMAT()</code> への 1 番目の引数としても使用できます。その場合、関数は <code class="literal">DATETIME</code> の場合と同じ値を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2003-10-03',GET_FORMAT(DATE,'EUR'));</code></strong>
        -&gt; '03.10.2003'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('10.31.2003',GET_FORMAT(DATE,'USA'));</code></strong>
        -&gt; '2003-10-31'
</pre></li><li class="listitem"><a name="function_hour"></a><p>
          <code class="literal">HOUR(<em class="replaceable"><code>time</code></em>)</code>
        </p><a class="indexterm" name="idm46041625077696"></a><p>
          <em class="replaceable"><code>time</code></em> に対応する時を返します。 戻り値の範囲は、日付時間値の <code class="literal">0</code> から <code class="literal">23</code> までです。 ただし、<code class="literal">TIME</code> 値の範囲は実際にはもっと大きいため、<code class="literal">HOUR</code> は <code class="literal">23</code> よりも大きい値を返すことができます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HOUR('10:05:03');</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT HOUR('272:59:59');</code></strong>
        -&gt; 272
</pre></li><li class="listitem"><a name="function_last-day"></a><p>
          <code class="literal">LAST_DAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041625062240"></a><p>
          日付または日付時間の値が指定され、月の最終日に対応する値を返します。 引数が無効である場合は、<code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-02-05');</code></strong>
        -&gt; '2003-02-28'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-02-05');</code></strong>
        -&gt; '2004-02-29'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-01-01 01:01:01');</code></strong>
        -&gt; '2004-01-31'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-03-32');</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_localtime"></a><p>
          <code class="literal">LOCALTIME</code>, <code class="literal">LOCALTIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041625047792"></a><p>
          <code class="literal">LOCALTIME</code> および <code class="literal">LOCALTIME()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_localtimestamp"></a><p>
          <code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041625035936"></a><p>
          <code class="literal">LOCALTIMESTAMP</code> および <code class="literal">LOCALTIMESTAMP()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_makedate"></a><p>
          <code class="literal">MAKEDATE(<em class="replaceable"><code>year</code></em>,<em class="replaceable"><code>dayofyear</code></em>)</code>
        </p><a class="indexterm" name="idm46041625024592"></a><p>
          指定された年と年間通算値から、日付を返します。<em class="replaceable"><code>dayofyear</code></em> は 0 よりも大きくする必要があり、それ以外の場合は結果が <code class="literal">NULL</code> になります。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,31), MAKEDATE(2011,32);</code></strong>
        -&gt; '2011-01-31', '2011-02-01'
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,365), MAKEDATE(2014,365);</code></strong>
        -&gt; '2011-12-31', '2014-12-31'
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,0);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_maketime"></a><p>
          <code class="literal">MAKETIME(<em class="replaceable"><code>hour</code></em>,<em class="replaceable"><code>minute</code></em>,<em class="replaceable"><code>second</code></em>)</code>
        </p><a class="indexterm" name="idm46041625010496"></a><p>
          <em class="replaceable"><code>hour</code></em>、<em class="replaceable"><code>minute</code></em>、および <em class="replaceable"><code>second</code></em> 引数から計算された時間値を返します。
        </p><p>
          <em class="replaceable"><code>second</code></em> 引数には小数部を含めることができます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKETIME(12,15,30);</code></strong>
        -&gt; '12:15:30'
</pre></li><li class="listitem"><a name="function_microsecond"></a><p>
          <code class="literal">MICROSECOND(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041624998000"></a><p>
          <code class="literal">0</code> から <code class="literal">999999</code> までの範囲内の数値として、時間または日付時間式 <em class="replaceable"><code>expr</code></em> からのマイクロ秒を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('12:00:00.123456');</code></strong>
        -&gt; 123456
mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('2019-12-31 23:59:59.000010');</code></strong>
        -&gt; 10
</pre></li><li class="listitem"><a name="function_minute"></a><p>
          <code class="literal">MINUTE(<em class="replaceable"><code>time</code></em>)</code>
        </p><a class="indexterm" name="idm46041624985008"></a><p>
          <code class="literal">0</code> から <code class="literal">59</code> までの範囲内で、<em class="replaceable"><code>time</code></em> に対応する分を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MINUTE('2008-02-03 10:05:03');</code></strong>
        -&gt; 5
</pre></li><li class="listitem"><a name="function_month"></a><p>
          <code class="literal">MONTH(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624972976"></a><p>
          <code class="literal">1</code> (1 月) から <code class="literal">12</code> (12 月) の範囲内で、<em class="replaceable"><code>date</code></em> に対応する月を返します。<code class="literal">'0000-00-00'</code> や <code class="literal">'2008-00-00'</code> のように月の部分がゼロの場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MONTH('2008-02-03');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_monthname"></a><p>
          <code class="literal">MONTHNAME(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624958672"></a><p>
          <em class="replaceable"><code>date</code></em> に対応する月の完全名を返します。 名前に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="charset.html#locale-support" title="10.16 MySQL Server のロケールサポート">セクション10.16「MySQL Server のロケールサポート」</a>) の値で制御されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MONTHNAME('2008-02-03');</code></strong>
        -&gt; 'February'
</pre></li><li class="listitem"><a name="function_now"></a><p>
          <code class="literal">NOW([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041624946272"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の日時を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>'</code>または <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> 形式の値として返します。 値はセッションのタイムゾーンで表されます。 
        </p><p>
          0 から 6 までの小数秒精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合、戻り値にはその桁数の小数秒部分が含まれます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW();</code></strong>
        -&gt; '2007-12-15 23:50:26'
mysql&gt; <strong class="userinput"><code>SELECT NOW() + 0;</code></strong>
        -&gt; 20071215235026.000000
</pre><p>
          <code class="literal">NOW()</code> は、ステートメントが実行を開始する時刻を示す定数時間を返します。 (ストアドファンクションまたはトリガーでは、<code class="literal">NOW()</code> は関数またはトリガーステートメントが実行を開始する時間を返します。) これは、正確な実行時間を返す <code class="literal">SYSDATE()</code> の動作とは異なります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong>
+---------------------+----------+---------------------+
| NOW()               | SLEEP(2) | NOW()               |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |
+---------------------+----------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong>
+---------------------+----------+---------------------+
| SYSDATE()           | SLEEP(2) | SYSDATE()           |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |
+---------------------+----------+---------------------+
</pre><p>
          さらに、<code class="literal">SET TIMESTAMP</code> ステートメントによって、<code class="literal">NOW()</code> で返された値は影響を受けますが、<code class="literal">SYSDATE()</code> で返された値は影響を受けません。 つまり、バイナリログのタイムスタンプ設定は、<code class="literal">SYSDATE()</code> の呼び出しに影響しないことを意味します。 タイムスタンプをゼロ以外の値に設定すると、後続の <code class="literal">NOW()</code> が起動されるたびに、その値が返されます。 タイムスタンプをゼロに設定すると、この効果が取り消され、再度 <code class="literal">NOW()</code> が現在の日付と時間を返すようになります。 
        </p><p>
          2 つの関数の相違点についての詳細は、<code class="literal">SYSDATE()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_period-add"></a><p>
          <code class="literal">PERIOD_ADD(<em class="replaceable"><code>P</code></em>,<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041624915712"></a><p>
          <em class="replaceable"><code>N</code></em> 月を期間 <em class="replaceable"><code>P</code></em> に (<em class="replaceable"><code>YYMM</code></em> または <em class="replaceable"><code>YYYYMM</code></em> の書式で) 加算します。 <em class="replaceable"><code>YYYYMM</code></em> の書式で値を返します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            期間引数 <em class="replaceable"><code>P</code></em> は、日付値では<span class="emphasis"><em>ありません</em></span>。
          </p></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PERIOD_ADD(200801,2);</code></strong>
        -&gt; 200803
</pre></li><li class="listitem"><a name="function_period-diff"></a><p>
          <code class="literal">PERIOD_DIFF(<em class="replaceable"><code>P1</code></em>,<em class="replaceable"><code>P2</code></em>)</code>
        </p><a class="indexterm" name="idm46041624901168"></a><p>
          期間 <em class="replaceable"><code>P1</code></em> と <em class="replaceable"><code>P2</code></em> 間の月数を返します。 <em class="replaceable"><code>P1</code></em> および <em class="replaceable"><code>P2</code></em> は、<em class="replaceable"><code>YYMM</code></em> または <em class="replaceable"><code>YYYYMM</code></em> の書式にする必要があります。 期間引数 <em class="replaceable"><code>P1</code></em> および <em class="replaceable"><code>P2</code></em> は日付値では<span class="emphasis"><em>ない</em></span>ことに注意してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PERIOD_DIFF(200802,200703);</code></strong>
        -&gt; 11
</pre></li><li class="listitem"><a name="function_quarter"></a><p>
          <code class="literal">QUARTER(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624886992"></a><p>
          <code class="literal">1</code> から <code class="literal">4</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する四半期を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT QUARTER('2008-04-01');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_second"></a><p>
          <code class="literal">SECOND(<em class="replaceable"><code>time</code></em>)</code>
        </p><a class="indexterm" name="idm46041624874944"></a><p>
          <code class="literal">0</code> から <code class="literal">59</code> までの範囲内で、<em class="replaceable"><code>time</code></em> に対応する秒数を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SECOND('10:05:03');</code></strong>
        -&gt; 3
</pre></li><li class="listitem"><a name="function_sec-to-time"></a><p>
          <code class="literal">SEC_TO_TIME(<em class="replaceable"><code>seconds</code></em>)</code>
        </p><a class="indexterm" name="idm46041624862912"></a><p>
          <code class="literal">TIME</code> 値として、時、分、秒に変換された <em class="replaceable"><code>seconds</code></em> 引数を返します。 結果の範囲は、<code class="literal">TIME</code> データ型の範囲に制約されます。 引数がその範囲外の値に対応している場合は、警告が発行されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378);</code></strong>
        -&gt; '00:39:38'
mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378) + 0;</code></strong>
        -&gt; 3938
</pre></li><li class="listitem"><a name="function_str-to-date"></a><p>
          <code class="literal">STR_TO_DATE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><a class="indexterm" name="idm46041624848752"></a><p>
          これは <code class="literal">DATE_FORMAT()</code> 関数の逆です。 文字列 <em class="replaceable"><code>str</code></em> と書式文字列 <em class="replaceable"><code>format</code></em> が指定されます。 <code class="literal">STR_TO_DATE()</code> は、書式文字列に日付と時間の両方の部分が含まれる場合は <code class="literal">DATETIME</code> 値を返し、文字列に日付と時間の部分の一方のみが含まれる場合は <code class="literal">DATE</code> または <code class="literal">TIME</code> 値を返します。 <em class="replaceable"><code>str</code></em> から抽出された日付値、時間値、または日付時間値が不正な場合は、<code class="literal">STR_TO_DATE()</code> によって <code class="literal">NULL</code> が返され、警告が発行されます。 
        </p><p>
          サーバーは <em class="replaceable"><code>str</code></em> をスキャンすることで、<em class="replaceable"><code>format</code></em> の一致を試みます。 書式文字列には、リテラル文字と <code class="literal">%</code> で始まる書式指定子を含めることができます。 <em class="replaceable"><code>format</code></em> 内のリテラル文字は、<em class="replaceable"><code>str</code></em> 内と完全に一致する必要があります。 <em class="replaceable"><code>format</code></em> 内の書式指定子は、<em class="replaceable"><code>str</code></em> 内の日付または時間の部分に一致する必要があります。 <em class="replaceable"><code>format</code></em> で使用できる指定子については、<code class="literal">DATE_FORMAT()</code> 関数の説明を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('01,5,2013','%d,%m,%Y');</code></strong>
        -&gt; '2013-05-01'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('May 1, 2013','%M %d,%Y');</code></strong>
        -&gt; '2013-05-01'
</pre><p>
          <em class="replaceable"><code>str</code></em> の先頭からスキャンが開始され、一致しない <em class="replaceable"><code>format</code></em> が見つかった場合は失敗します。 <em class="replaceable"><code>str</code></em> の末尾にある余分な文字は、無視されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','a%h:%i:%s');</code></strong>
        -&gt; '09:30:17'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','%h:%i:%s');</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('09:30:17a','%h:%i:%s');</code></strong>
        -&gt; '09:30:17'
</pre><p>
          指定されていない日付または時間の部分の値は 0 になるため、<em class="replaceable"><code>str</code></em> に指定された値が不完全な場合は、結果の一部または全部が 0 に設定されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('abc','abc');</code></strong>
        -&gt; '0000-00-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%m');</code></strong>
        -&gt; '0000-09-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%s');</code></strong>
        -&gt; '00:00:09'
</pre><p>
          日付値の部分をチェックする範囲は、<a class="xref" href="data-types.html#datetime" title="11.2.2 DATE、DATETIME、および TIMESTAMP 型">セクション11.2.2「DATE、DATETIME、および TIMESTAMP 型」</a>の説明どおりです。 たとえば、<span class="quote">「<span class="quote">ゼロ</span>」</span>の日付または部分値が 0 の日付は、このような値が許可されないように SQL モードが設定されていなければ、許可されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('00/00/0000', '%m/%d/%Y');</code></strong>
        -&gt; '0000-00-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('04/31/2004', '%m/%d/%Y');</code></strong>
        -&gt; '2004-04-31'
</pre><p>
          <code class="literal">NO_ZERO_DATE</code> SQL モードが有効な場合、ゼロの日付は許可されません。 その場合、<code class="literal">STR_TO_DATE()</code> は <code class="literal">NULL</code> を返し、警告を生成します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode = '';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('00/00/0000', '%m/%d/%Y');</code></strong>
+---------------------------------------+
| STR_TO_DATE('00/00/0000', '%m/%d/%Y') |
+---------------------------------------+
| 0000-00-00                            |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SET sql_mode = 'NO_ZERO_DATE';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('00/00/0000', '%m/%d/%Y');</code></strong>
+---------------------------------------+
| STR_TO_DATE('00/00/0000', '%m/%d/%Y') |
+---------------------------------------+
| NULL                                  |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1411
Message: Incorrect datetime value: '00/00/0000' for function str_to_date
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            週が月の境界を越えた場合は、年と週の組み合わせでは年と月を一意に識別できないため、<code class="literal">"%X%V"</code> の書式を使用しても、年と週の文字列を日付に変換できません。 年と週を日付に変換するには、曜日も指定する必要があります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('200442 Monday', '%X%V %W');</code></strong>
        -&gt; '2004-10-18'
</pre></div></li><li class="listitem"><a name="function_subdate"></a><p>
          <code class="literal">SUBDATE(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>, <code class="literal">SUBDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code>
        </p><a class="indexterm" name="idm46041624793968"></a><p>
          <code class="literal">INTERVAL</code> 形式で 2 番目の引数を付けて呼び出されると、<code class="literal">SUBDATE()</code> は <code class="literal">DATE_SUB()</code> のシノニムになります。 <code class="literal">INTERVAL</code> <em class="replaceable"><code>unit</code></em> 引数については、<code class="literal">DATE_ADD()</code> の説明を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2007-12-02'
mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2007-12-02'
</pre><p>
          2 番目の形式では、<em class="replaceable"><code>days</code></em> の整数値を使用できます。 このような場合は、日付または日付時間式 <em class="replaceable"><code>expr</code></em> から日数が減算されると解釈されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02 12:00:00', 31);</code></strong>
        -&gt; '2007-12-02 12:00:00'
</pre></li><li class="listitem"><a name="function_subtime"></a><p>
          <code class="literal">SUBTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041624774560"></a><p>
          <code class="literal">SUBTIME()</code> は、<em class="replaceable"><code>expr1</code></em> と同じ書式で表現される <em class="replaceable"><code>expr1</code></em> と <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> は時間または日付時間式であり、<em class="replaceable"><code>expr2</code></em> は時間式です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('2007-12-31 23:59:59.999999','1 1:1:1.000002');</code></strong>
        -&gt; '2007-12-30 22:58:58.999997'
mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('01:00:00.999999', '02:00:00.999998');</code></strong>
        -&gt; '-00:59:59.999999'
</pre></li><li class="listitem"><a name="function_sysdate"></a><p>
          <code class="literal">SYSDATE([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041624760128"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の日時を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>'</code>または <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> 形式の値として返します。
        </p><p>
          0 から 6 までの小数秒精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合、戻り値にはその桁数の小数秒部分が含まれます。
        </p><p>
          <code class="literal">SYSDATE()</code> は、実行された時間を返します。 これは、ステートメントが実行を開始する時間を示す定数時間を返す <code class="literal">NOW()</code> の動作とは異なります。 (ストアドファンクションまたはトリガーでは、<code class="literal">NOW()</code> は関数またはトリガーステートメントが実行を開始する時間を返します。) 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong>
+---------------------+----------+---------------------+
| NOW()               | SLEEP(2) | NOW()               |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |
+---------------------+----------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong>
+---------------------+----------+---------------------+
| SYSDATE()           | SLEEP(2) | SYSDATE()           |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |
+---------------------+----------+---------------------+
</pre><p>
          さらに、<code class="literal">SET TIMESTAMP</code> ステートメントによって、<code class="literal">NOW()</code> で返された値は影響を受けますが、<code class="literal">SYSDATE()</code> で返された値は影響を受けません。 つまり、バイナリログのタイムスタンプ設定は、<code class="literal">SYSDATE()</code> の呼び出しに影響しないことを意味します。 
        </p><p>
          <code class="literal">SYSDATE()</code> は、同じステートメント内でもさまざまな値を返すことができ、<code class="literal">SET TIMESTAMP</code> による影響も受けないため、非決定的です。そのため、ステートメントベースのバイナリロギングが使用されている場合は、レプリケーションで安全に使用できません。 これが問題となる場合は、行ベースのロギングを使用できます。 
        </p><p>
          また、<code class="option">--sysdate-is-now</code> オプションを使用すると、<code class="literal">SYSDATE()</code> を <code class="literal">NOW()</code> のエイリアスにすることができます。 これは、レプリケーションソースサーバーとレプリカの両方でこのオプションが使用されている場合に機能します。 
        </p><p>
          <code class="literal">SYSDATE()</code> に非決定的な特性があるということは、それを参照する式を評価する際にインデックスを使用できないことも意味します。
        </p></li><li class="listitem"><a name="function_time"></a><p>
          <code class="literal">TIME(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041624729040"></a><p>
          時間または日付時間式 <em class="replaceable"><code>expr</code></em> の時部分を抽出し、文字列として返します。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03');</code></strong>
        -&gt; '01:02:03'
mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03.000123');</code></strong>
        -&gt; '01:02:03.000123'
</pre></li><li class="listitem"><a name="function_timediff"></a><p>
          <code class="literal">TIMEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041624714448"></a><p>
          <code class="literal">TIMEDIFF()</code> は、時間値として表現された <em class="replaceable"><code>expr1</code></em> − <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> および <em class="replaceable"><code>expr2</code></em> は時間または日付時間式ですが、両方とも同じ型にする必要があります。
        </p><p>
          <code class="literal">TIMEDIFF()</code> で返される結果は、<code class="literal">TIME</code> 値で許可される範囲に制限されています。 また、<code class="literal">TIMESTAMPDIFF()</code> および <code class="literal">UNIX_TIMESTAMP()</code> 関数のいずれかを使用することもできます。両方とも整数を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2000:01:01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>'2000:01:01 00:00:00.000001');</code></strong>
        -&gt; '-00:00:00.000001'
mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2008-12-31 23:59:59.000001',</code></strong>
    -&gt; <strong class="userinput"><code>                '2008-12-30 01:01:01.000002');</code></strong>
        -&gt; '46:58:57.999999'
</pre></li><li class="listitem"><a name="function_timestamp"></a><p>
          <code class="literal">TIMESTAMP(<em class="replaceable"><code>expr</code></em>)</code>, <code class="literal">TIMESTAMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041624692608"></a><p>
          引数を 1 つ付けると、この関数は日付または日付時間式 <em class="replaceable"><code>expr</code></em> を日付時間値として返します。 引数を 2 つ付けると、時間式 <em class="replaceable"><code>expr2</code></em> を日付または日付時間式 <em class="replaceable"><code>expr1</code></em> に加算し、その結果を日付時間値として返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31');</code></strong>
        -&gt; '2003-12-31 00:00:00'
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31 12:00:00','12:00:00');</code></strong>
        -&gt; '2004-01-01 00:00:00'
</pre></li><li class="listitem"><a name="function_timestampadd"></a><p>
          <code class="literal">TIMESTAMPADD(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>interval</code></em>,<em class="replaceable"><code>datetime_expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041624678880"></a><p>
          整数式 <em class="replaceable"><code>interval</code></em> を日付または日付時間式 <em class="replaceable"><code>datetime_expr</code></em> に加算します。 <em class="replaceable"><code>interval</code></em> の単位は、<em class="replaceable"><code>unit</code></em> 引数で指定されます。この引数は、<code class="literal">MICROSECOND</code> (マイクロ秒)、<code class="literal">SECOND</code>、<code class="literal">MINUTE</code>、<code class="literal">HOUR</code>、<code class="literal">DAY</code>、<code class="literal">WEEK</code>、<code class="literal">MONTH</code>、<code class="literal">QUARTER</code>、<code class="literal">YEAR</code> 値のいずれかにする必要があります。 
        </p><p>
          <em class="replaceable"><code>unit</code></em> 値を指定するには、ここで示したキーワードのいずれかを使用するか、<code class="literal">SQL_TSI_</code> をプリフィクスとして付けます。 たとえば、<code class="literal">DAY</code> と <code class="literal">SQL_TSI_DAY</code> は両方とも有効です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(MINUTE,1,'2003-01-02');</code></strong>
        -&gt; '2003-01-02 00:01:00'
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(WEEK,1,'2003-01-02');</code></strong>
        -&gt; '2003-01-09'
</pre></li><li class="listitem"><a name="function_timestampdiff"></a><p>
          <code class="literal">TIMESTAMPDIFF(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>datetime_expr1</code></em>,<em class="replaceable"><code>datetime_expr2</code></em>)</code>
        </p><a class="indexterm" name="idm46041624655104"></a><p>
          <em class="replaceable"><code>datetime_expr2</code></em> − <em class="replaceable"><code>datetime_expr1</code></em> を返します。<em class="replaceable"><code>datetime_expr1</code></em> と <em class="replaceable"><code>datetime_expr2</code></em> は、日付または日付時間式です。 式の一方が日付で、他方が日付時間にすることもできます。日付値は、必要に応じて時間部分が <code class="literal">'00:00:00'</code> の日付時間として処理されます。 結果 (整数) の単位は、<em class="replaceable"><code>unit</code></em> 引数で指定されます。 <em class="replaceable"><code>unit</code></em> の有効な値は、<code class="literal">TIMESTAMPADD()</code> 関数の説明で一覧表示された値と同じです。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01');</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01');</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MINUTE,'2003-02-01','2003-05-01 12:05:55');</code></strong>
        -&gt; 128885
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            この関数の日付または日付時間引数の順序は、<code class="literal">TIMESTAMP()</code> 関数を 2 つの引数を指定して呼び出す場合の順序と逆になります。
          </p></div></li><li class="listitem"><a name="function_time-format"></a><p>
          <code class="literal">TIME_FORMAT(<em class="replaceable"><code>time</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><a class="indexterm" name="idm46041624635824"></a><p>
          これは <code class="literal">DATE_FORMAT()</code> 関数と同様に使用されますが、<em class="replaceable"><code>format</code></em> 文字列には時間、分、秒、マイクロ秒の書式指定子のみを含めることができます。 その他の指定子では、<code class="literal">NULL</code> 値または <code class="literal">0</code> が生成されます。 
        </p><p>
          <em class="replaceable"><code>time</code></em> 値に <code class="literal">23</code> よりも大きな時間部分が含まれる場合は、<code class="literal">%H</code> および <code class="literal">%k</code> 時間書式指定子によって、<code class="literal">0..23</code> の通常の範囲よりも大きな値が生成されます。 その他の時間書式指定子では、時間値モジュロ 12 が生成されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME_FORMAT('100:00:00', '%H %k %h %I %l');</code></strong>
        -&gt; '100 100 04 04 4'
</pre></li><li class="listitem"><a name="function_time-to-sec"></a><p>
          <code class="literal">TIME_TO_SEC(<em class="replaceable"><code>time</code></em>)</code>
        </p><a class="indexterm" name="idm46041624618304"></a><p>
          秒に変換された <em class="replaceable"><code>time</code></em> 引数を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('22:23:00');</code></strong>
        -&gt; 80580
mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('00:39:38');</code></strong>
        -&gt; 2378
</pre></li><li class="listitem"><a name="function_to-days"></a><p>
          <code class="literal">TO_DAYS(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624606864"></a><p>
          日付 <em class="replaceable"><code>date</code></em> が指定され、日数 (0 年以降の日数) を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS(950501);</code></strong>
        -&gt; 728779
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2007-10-07');</code></strong>
        -&gt; 733321
</pre><p>
          <code class="literal">TO_DAYS()</code> は、カレンダーが変更された際に失われた日が考慮されないため、グレゴリオ暦 (1582) の出現よりも前の値とともに使用するために設計されていません。 日付が 1582 よりも前の場合は (ほかのロケールでは、さらにあとの年になる可能性があります)、この関数の結果は信頼できません。 詳細は、<a class="xref" href="functions.html#mysql-calendar" title="12.9 MySQL で使用されるカレンダー">セクション12.9「MySQL で使用されるカレンダー」</a>,を参照してください。 
        </p><p>
          MySQL では <a class="xref" href="data-types.html#date-and-time-types" title="11.2 日時データ型">セクション11.2「日時データ型」</a> のルールを使用して、日付の 2 桁の年の値が 4 桁の形式に変換されることを忘れないでください。 たとえば、<code class="literal">'2008-10-07'</code> と <code class="literal">'08-10-07'</code> は同じ日付と認識されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2008-10-07'), TO_DAYS('08-10-07');</code></strong>
        -&gt; 733687, 733687
</pre><p>
          MySQL では、ゼロの日付は <code class="literal">'0000-00-00'</code> として定義されます。ただし、このデータ自体は無効とみなされます。 つまり、<code class="literal">'0000-00-00'</code> および <code class="literal">'0000-01-01'</code> の場合、<code class="literal">TO_DAYS()</code> は次に示す値を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-00-00');</code></strong>
+-----------------------+
| to_days('0000-00-00') |
+-----------------------+
|                  NULL |
+-----------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-01-01');</code></strong>
+-----------------------+
| to_days('0000-01-01') |
+-----------------------+
|                     1 |
+-----------------------+
1 row in set (0.00 sec)
</pre><p>
          このことは、<code class="literal">ALLOW_INVALID_DATES</code> SQL サーバーモードが有効であるかどうかに関係なく当てはまります。
        </p></li><li class="listitem"><a name="function_to-seconds"></a><p>
          <code class="literal">TO_SECONDS(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041624578112"></a><p>
          日付または日時 <em class="replaceable"><code>expr</code></em> を指定すると、0 年以降の秒数を戻します。 <em class="replaceable"><code>expr</code></em> が有効な日付または日付時間の値ではない場合は、<code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS(950501);</code></strong>
        -&gt; 62966505600
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29');</code></strong>
        -&gt; 63426672000
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29 13:43:32');</code></strong>
        -&gt; 63426721412
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS( NOW() );</code></strong>
        -&gt; 63426721458
</pre><p>
          <code class="literal">TO_DAYS()</code> と同様に、<code class="literal">TO_SECONDS()</code> は、カレンダーが変更された際に失われた日が考慮されないため、グレゴリオ暦 (1582) の出現よりも前の値とともに使用する目的で設計されていません。 日付が 1582 よりも前の場合は (ほかのロケールでは、さらにあとの年になる可能性があります)、この関数の結果は信頼できません。 詳細は、<a class="xref" href="functions.html#mysql-calendar" title="12.9 MySQL で使用されるカレンダー">セクション12.9「MySQL で使用されるカレンダー」</a>,を参照してください。 
        </p><p>
          <code class="literal">TO_DAYS()</code> と同様に、<code class="literal">TO_SECONDS()</code> は <a class="xref" href="data-types.html#date-and-time-types" title="11.2 日時データ型">セクション11.2「日時データ型」</a> のルールを使用して日付の 2 桁の年の値を 4 桁の形式に変換します。
        </p><p>
          MySQL では、ゼロの日付は <code class="literal">'0000-00-00'</code> として定義されます。ただし、このデータ自体は無効とみなされます。 つまり、<code class="literal">'0000-00-00'</code> および <code class="literal">'0000-01-01'</code> の場合、<code class="literal">TO_SECONDS()</code> は次に示す値を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-00-00');</code></strong>
+--------------------------+
| TO_SECONDS('0000-00-00') |
+--------------------------+
|                     NULL |
+--------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-01-01');</code></strong>
+--------------------------+
| TO_SECONDS('0000-01-01') |
+--------------------------+
|                    86400 |
+--------------------------+
1 row in set (0.00 sec)
</pre><p>
          このことは、<code class="literal">ALLOW_INVALID_DATES</code> SQL サーバーモードが有効であるかどうかに関係なく当てはまります。
        </p></li><li class="listitem"><a name="function_unix-timestamp"></a><p>
          <code class="literal">UNIX_TIMESTAMP([<em class="replaceable"><code>date</code></em>])</code>
        </p><a class="indexterm" name="idm46041624547232"></a><p>
          <em class="replaceable"><code>date</code></em> 引数を指定せずに <code class="literal">UNIX_TIMESTAMP()</code> をコールすると、<code class="literal">'1970-01-01 00:00:00'</code> UTC 以降の秒数を表す Unix タイムスタンプが返されます。
        </p><p>
          <em class="replaceable"><code>date</code></em> 引数を指定して <code class="literal">UNIX_TIMESTAMP()</code> をコールすると、<code class="literal">'1970-01-01 00:00:00'</code> UTC 以降の秒数として引数の値が返されます。 サーバーは、<em class="replaceable"><code>date</code></em> をセッションタイムゾーンの値として解釈し、UTC の内部 Unix タイムスタンプ値に変換します。 (クライアントは、<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a> の説明に従ってセッションタイムゾーンを設定できます。) <em class="replaceable"><code>date</code></em> 引数には、<code class="literal">DATE</code>、<code class="literal">DATETIME</code> または <code class="literal">TIMESTAMP</code> 文字列、<em class="replaceable"><code>YYMMDD</code></em>, <em class="replaceable"><code>YYMMDDhhmmss</code></em>, <em class="replaceable"><code>YYYYMMDD</code></em> の数値または <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> 形式を指定できます。 引数に時間部分が含まれている場合、オプションで小数秒部分を含めることができます。 
        </p><p>
          戻り値は、引数が指定されていない場合、または引数に小数秒部分が含まれていない場合は整数、小数秒部分を含む引数が指定されている場合は <code class="literal">DECIMAL</code> です。
        </p><p>
          <em class="replaceable"><code>date</code></em> 引数が <code class="literal">TIMESTAMP</code> カラムの場合、<code class="literal">UNIX_TIMESTAMP()</code> は内部タイムスタンプ値を直接返し、<span class="quote">「<span class="quote">string-to-Unix-timestamp</span>」</span> の暗黙的な変換は行いません。
        </p><p>
          引数値の有効範囲は、<code class="literal">TIMESTAMP</code> データ型の場合と同じです: <code class="literal">'1970-01-01 00:00:01.000000'</code> UTC から<code class="literal">'2038-01-19 03:14:07.999999'</code> UTC。 <code class="literal">UNIX_TIMESTAMP()</code> に範囲外の日付を渡すと、<code class="literal">0</code> が返されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP();</code></strong>
        -&gt; 1447431666
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2015-11-13 10:20:19');</code></strong>
        -&gt; 1447431619
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2015-11-13 10:20:19.012');</code></strong>
        -&gt; 1447431619.012
</pre><a class="indexterm" name="idm46041624517696"></a><p>
          <code class="literal">UNIX_TIMESTAMP()</code> および <code class="literal">FROM_UNIXTIME()</code> を使用して UTC 以外のタイムゾーンの値と Unix タイムスタンプ値の間で変換する場合、マッピングは双方向では一対一ではないため、変換は失われます。 たとえば、夏時間 (DST) などのローカルタイムゾーンの変更の規則により、<code class="literal">UNIX_TIMESTAMP()</code> では UTC 以外のタイムゾーンで区別される 2 つの値を同じ Unix タイムスタンプ値にマップできます。 <code class="literal">FROM_UNIXTIME()</code> では、その値は元の値のいずれかにのみマップされます。 次に、<code class="literal">MET</code> タイムゾーンで区別される値を使用する例を示します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET time_zone = 'MET';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 03:00:00');</code></strong>
+---------------------------------------+
| UNIX_TIMESTAMP('2005-03-27 03:00:00') |
+---------------------------------------+
|                            1111885200 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 02:00:00');</code></strong>
+---------------------------------------+
| UNIX_TIMESTAMP('2005-03-27 02:00:00') |
+---------------------------------------+
|                            1111885200 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1111885200);</code></strong>
+---------------------------+
| FROM_UNIXTIME(1111885200) |
+---------------------------+
| 2005-03-27 03:00:00       |
+---------------------------+
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">'MET'</code>や<code class="literal">'Europe/Amsterdam'</code>などの名前付きタイムゾーンを使用するには、タイムゾーンテーブルが適切に設定されている必要があります。 その手順は、<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a>を参照してください。 
          </p></div><p>
          <code class="literal">UNIX_TIMESTAMP()</code> カラムを減算する場合は、符号付き整数にキャストできます。 <a class="xref" href="functions.html#cast-functions" title="12.11 キャスト関数と演算子">セクション12.11「キャスト関数と演算子」</a>を参照してください。 
        </p></li><li class="listitem"><a name="function_utc-date"></a><p>
          <code class="literal">UTC_DATE</code>, <code class="literal">UTC_DATE()</code>
        </p><a class="indexterm" name="idm46041624495120"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の UTC 日付を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD</code></em>'</code>または <em class="replaceable"><code>YYYYMMDD</code></em> 形式の値として返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UTC_DATE(), UTC_DATE() + 0;</code></strong>
        -&gt; '2003-08-14', 20030814
</pre></li><li class="listitem"><a name="function_utc-time"></a><p>
          <code class="literal">UTC_TIME</code>, <code class="literal">UTC_TIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041624482080"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の UTC 時間を<em class="replaceable"><code>'hh:mm:ss'</code></em>または <em class="replaceable"><code>hhmmss</code></em> 形式の値として返します。
        </p><p>
          0 から 6 までの小数秒精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合、戻り値にはその桁数の小数秒部分が含まれます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UTC_TIME(), UTC_TIME() + 0;</code></strong>
        -&gt; '18:07:53', 180753.000000
</pre></li><li class="listitem"><a name="function_utc-timestamp"></a><p>
          <code class="literal">UTC_TIMESTAMP</code>, <code class="literal">UTC_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><a class="indexterm" name="idm46041624468528"></a><p>
          関数が文字列または数値のどちらのコンテキストで使用されているかに応じて、現在の UTC 日時を<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>'</code>または <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> 形式の値として返します。
        </p><p>
          0 から 6 までの小数秒精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合、戻り値にはその桁数の小数秒部分が含まれます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UTC_TIMESTAMP(), UTC_TIMESTAMP() + 0;</code></strong>
        -&gt; '2003-08-14 18:08:04', 20030814180804.000000
</pre></li><li class="listitem"><a name="function_week"></a><p>
          <code class="literal">WEEK(<em class="replaceable"><code>date</code></em>[,<em class="replaceable"><code>mode</code></em>])</code>
        </p><a class="indexterm" name="idm46041624454768"></a><p>
          この関数は、<em class="replaceable"><code>date</code></em> に対応する週番号を返します。 2 つの引数を取る形式の <code class="literal">WEEK()</code> を使用すると、週が日曜日と月曜日のどちらから始まるのか、および戻り値が <code class="literal">0</code> から <code class="literal">53</code>までと <code class="literal">1</code> から <code class="literal">53</code> までのどちらの範囲内であるのかを指定できます。 <em class="replaceable"><code>mode</code></em> 引数が省略された場合は、<code class="literal">default_week_format</code> システム変数の値が使用されます。 <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a>を参照してください。 
        </p><p>
          次の表では、<em class="replaceable"><code>mode</code></em> 引数がどのように機能するのかについて説明します。
        </p><div class="informaltable"><table summary="Now the mode argument of the WEEK function works. For each mode value, the table lists the first day of the week, the range, and a description of week 1."><col style="width: 10%"><col style="width: 20%"><col style="width: 20%"><col style="width: 50%"><thead><tr>
              <th scope="col">モード</th>
              <th scope="col">週の 1 日目</th>
              <th scope="col">範囲</th>
              <th scope="col">第 1 週は次の条件を満たす最初の週</th>
            </tr></thead><tbody><tr>
              <th scope="row">0</th>
              <td>日曜日</td>
              <td>0-53</td>
              <td>本年の日曜日を含む</td>
            </tr><tr>
              <th scope="row">1</th>
              <td>月曜日</td>
              <td>0-53</td>
              <td>本年の 4 日以上を含む</td>
            </tr><tr>
              <th scope="row">2</th>
              <td>日曜日</td>
              <td>1-53</td>
              <td>本年の日曜日を含む</td>
            </tr><tr>
              <th scope="row">3</th>
              <td>月曜日</td>
              <td>1-53</td>
              <td>本年の 4 日以上を含む</td>
            </tr><tr>
              <th scope="row">4</th>
              <td>日曜日</td>
              <td>0-53</td>
              <td>本年の 4 日以上を含む</td>
            </tr><tr>
              <th scope="row">5</th>
              <td>月曜日</td>
              <td>0-53</td>
              <td>本年の月曜日を含む</td>
            </tr><tr>
              <th scope="row">6</th>
              <td>日曜日</td>
              <td>1-53</td>
              <td>本年の 4 日以上を含む</td>
            </tr><tr>
              <th scope="row">7</th>
              <td>月曜日</td>
              <td>1-53</td>
              <td>本年の月曜日を含む</td>
            </tr></tbody></table></div><p>
          <span class="quote">「<span class="quote">本年の 4 日以上を含む</span>」</span>という意味を持つ <em class="replaceable"><code>mode</code></em> 値では、ISO 8601:1988 に従って週番が付けられます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              1 月 1 日を含む週に新年の 4 日以上が含まれる場合は、その週が第 1 週です。
            </p></li><li class="listitem"><p>
              それ以外の場合は、前年の最終週となり、次の週が第 1 週です。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20');</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20',0);</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20',1);</code></strong>
        -&gt; 8
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-12-31',1);</code></strong>
        -&gt; 53
</pre><p>
          日付が前年の最終週に入っている場合は、オプションの <em class="replaceable"><code>mode</code></em> 引数として<code class="literal">2</code>、<code class="literal">3</code>、<code class="literal">6</code>、または <code class="literal">7</code> を使用しなければ、MySQL によって <code class="literal">0</code> が返されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT YEAR('2000-01-01'), WEEK('2000-01-01',0);</code></strong>
        -&gt; 2000, 0
</pre><p>
          指定された日付は実際には 1999 年の第 52 週に発生するため、<code class="literal">WEEK()</code> は <code class="literal">52</code> を返す必要があると議論されることもあります。 代わりに <code class="literal">WEEK()</code> は、戻り値が<span class="quote">「<span class="quote">指定された年の週番号</span>」</span>となるように <code class="literal">0</code> を返します。 これにより、日付から日付部分を抽出するその他の関数と組み合わせると、<code class="literal">WEEK()</code> 関数を信頼して使用できるようになります。 
        </p><p>
          指定された日付に対応する週の 1 日目を含む年について評価された結果を優先する場合は、オプションの <em class="replaceable"><code>mode</code></em> 引数として <code class="literal">0</code>、<code class="literal">2</code>、<code class="literal">5</code>、または <code class="literal">7</code> を使用します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT WEEK('2000-01-01',2);</code></strong>
        -&gt; 52
</pre><p>
          または、<code class="literal">YEARWEEK()</code> 関数を使用します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT YEARWEEK('2000-01-01');</code></strong>
        -&gt; 199952
mysql&gt; <strong class="userinput"><code>SELECT MID(YEARWEEK('2000-01-01'),5,2);</code></strong>
        -&gt; '52'
</pre></li><li class="listitem"><a name="function_weekday"></a><p>
          <code class="literal">WEEKDAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624365552"></a><p>
          <em class="replaceable"><code>date</code></em> に対応する曜日インデックス (<code class="literal">0</code> = Monday、<code class="literal">1</code> = Tuesday、…<code class="literal">6</code> = Sunday) を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT WEEKDAY('2008-02-03 22:23:00');</code></strong>
        -&gt; 6
mysql&gt; <strong class="userinput"><code>SELECT WEEKDAY('2007-11-06');</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_weekofyear"></a><p>
          <code class="literal">WEEKOFYEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624352048"></a><p>
          <code class="literal">1</code> から <code class="literal">53</code> までの範囲内で、日付の暦週を返します。 <code class="literal">WEEKOFYEAR()</code> は <code class="literal">WEEK(<em class="replaceable"><code>date</code></em>,3)</code> に同等の互換性のある関数です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT WEEKOFYEAR('2008-02-20');</code></strong>
        -&gt; 8
</pre></li><li class="listitem"><a name="function_year"></a><p>
          <code class="literal">YEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><a class="indexterm" name="idm46041624337936"></a><p>
          <code class="literal">1000</code> から <code class="literal">9999</code> までの範囲内で、<em class="replaceable"><code>date</code></em> に対応する年を返します。日付が<span class="quote">「<span class="quote">ゼロ</span>」</span>の場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT YEAR('1987-01-01');</code></strong>
        -&gt; 1987
</pre></li><li class="listitem"><a name="function_yearweek"></a><p>
          <code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>)</code>, <code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>mode</code></em>)</code>
        </p><a class="indexterm" name="idm46041624322928"></a><p>
          日付に対応する年と週を返します。 結果の年と日付引数の年では、その年の最初と最後の週が異なる可能性があります。 
        </p><p>
          <em class="replaceable"><code>mode</code></em> 引数は、<code class="literal">WEEK()</code> への <em class="replaceable"><code>mode</code></em> 引数とまったく同様に機能します。 単一引数構文では、<em class="replaceable"><code>mode</code></em> 値 0 が使用されます。 <code class="literal">WEEK()</code> とは異なり、<code class="literal">default_week_format</code> の値は <code class="literal">YEARWEEK()</code> に影響しません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT YEARWEEK('1987-01-01');</code></strong>
        -&gt; 198652
</pre><p>
          <code class="literal">WEEK()</code> はその後、指定された年のコンテキストで週を返すため、週番号はオプションの引数 <code class="literal">0</code> または <code class="literal">1</code> を付けた場合に <code class="literal">WEEK()</code> 関数で返される数字 (<code class="literal">0</code>) とは異なります。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="string-functions"></a>12.8 文字列関数および演算子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#string-comparison-functions">12.8.1 文字列比較関数および演算子</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.8.2 正規表現</a></span></dt><dt><span class="section"><a href="functions.html#string-functions-charset">12.8.3 関数結果の文字セットと照合順序</a></span></dt></dl></div><a class="indexterm" name="idm46041624304752"></a><a class="indexterm" name="idm46041624303312"></a><a class="indexterm" name="idm46041624301648"></a><a class="indexterm" name="idm46041624300176"></a><div class="table"><a name="idm46041624298144"></a><p class="title"><b>表 12.12 「文字列関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「文字列関数および演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></td>
<td>
      左端の文字の数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></td>
<td>
      数値のバイナリ表現を含む文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></td>
<td>
      ビット単位で引数の長さを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></td>
<td>
      渡された各整数の文字を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></td>
<td>
      引数の文字数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></td>
<td>
      CHAR_LENGTH() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></td>
<td>
      連結された文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></td>
<td>
      連結されたものをセパレータ付きで返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></td>
<td>
      インデックス番号位置の文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></td>
<td>
      値 bits 内の各ビットが設定されている場合は on 文字列を取得し、各ビットが設定されていない場合には off 文字列を取得するように、文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></td>
<td>
      後続の引数の最初の引数のインデックス (位置)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></td>
<td>
      2 番目の引数内の最初の引数のインデックス (位置)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></td>
<td>
      指定された小数点以下桁数に書式設定された数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></td>
<td>
      base64 でエンコードされた文字列をデコードして結果を返す
    </td>
</tr><tr><td><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></td>
<td>
      小数または文字列値の 16 進数表現
    </td>
</tr><tr><td><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></td>
<td>
      指定した位置に指定した文字数まで部分文字列を挿入
    </td>
</tr><tr><td><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></td>
<td>
      部分文字列が最初に出現する位置のインデックスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></td>
<td>
      LOWER() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></td>
<td>
      左端から指定された数の文字を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></td>
<td>
      文字列の長さをバイト単位で返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      単純なパターン一致
    </td>
</tr><tr><td><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></td>
<td>
      指定されたファイルをロードします
    </td>
</tr><tr><td><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></td>
<td>
      部分文字列が最初に出現する位置を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></td>
<td>
      引数を小文字で返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></td>
<td>
      指定された文字列で左からパディングした文字列引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></td>
<td>
      先頭の空白を削除します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></td>
<td>
      bits セット内の対応するビットを持つ、カンマ区切り文字列のセットを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></td>
<td>
      全文検索を実行します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></td>
<td>
      指定された位置から始まる部分文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      単純なパターン一致の否定
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      REGEXP の否定
    </td>
</tr><tr><td><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></td>
<td>
      数値の 8 進数表現を含む文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></td>
<td>
      LENGTH() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></td>
<td>
      引数の左端の文字の文字コードを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></td>
<td>
      LOCATE() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></td>
<td>
      SQL ステートメント内で使用するために引数をエスケープします
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></td>
<td>
      正規表現に一致する部分文字列の開始インデックス
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></td>
<td>
      正規表現に一致する部分文字列の置換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></td>
<td>
      正規表現に一致する部分文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></td>
<td>
      文字列を指定された回数だけ繰り返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></td>
<td>
      指定された文字列の出現箇所を置き換えます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></td>
<td>
      文字列内の文字を逆順に並べ替えます
    </td>
</tr><tr><td><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></td>
<td>
      右端から指定された数の文字を返します
    </td>
</tr><tr><td><code class="literal">RLIKE</code></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></td>
<td>
      指定された回数だけ文字列を追加します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></td>
<td>
      末尾の空白を削除します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></td>
<td>
      soundex 文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td>
<td>
      音声を比較します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></td>
<td>
      指定された数の空白で構成される文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      2 つの文字列を比較します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></td>
<td>
      指定された部分文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></td>
<td>
      指定された部分文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></td>
<td>
      文字列から、区切り文字が指定された回数出現する前の部分文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></td>
<td>
      base 64 文字列に変換された引数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></td>
<td>
      先頭と末尾にある空白を削除します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></td>
<td>
      UPPER() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></td>
<td>
      数値の 16 進数表現を含む文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></td>
<td>
      大文字に変換します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></td>
<td>
      文字列の重み文字列を返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      文字列値の関数は、結果の長さが <code class="literal">max_allowed_packet</code> システム環境変数の値よりも長くなると、<code class="literal">NULL</code> を返します。 <a class="xref" href="server-administration.html#server-configuration" title="5.1.1 サーバーの構成">セクション5.1.1「サーバーの構成」</a>を参照してください。 
    </p><p>
      文字列の位置を操作する関数では、最初の位置には数値 1 が付けられます。
    </p><p>
      長さの引数を取る関数では、整数以外の引数はもっとも近い整数に丸められます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_ascii"></a><p>
          <code class="literal">ASCII(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041624095184"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> の左端の文字の数値を返します。 <em class="replaceable"><code>str</code></em> が空の文字列である場合は、<code class="literal">0</code> を返します。 <em class="replaceable"><code>str</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。 <code class="literal">ASCII()</code> は、8 ビット文字の場合に動作します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ASCII('2');</code></strong>
        -&gt; 50
mysql&gt; <strong class="userinput"><code>SELECT ASCII(2);</code></strong>
        -&gt; 50
mysql&gt; <strong class="userinput"><code>SELECT ASCII('dx');</code></strong>
        -&gt; 100
</pre><p>
          <code class="literal">ORD()</code> 関数も参照してください。
        </p></li><li class="listitem"><a name="function_bin"></a><p>
          <code class="literal">BIN(<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041624077504"></a><p>
          <em class="replaceable"><code>N</code></em> のバイナリ値の文字列表現を返します。<em class="replaceable"><code>N</code></em> は longlong (<code class="literal">BIGINT</code>) 数字です。 これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10,2)</code> と同等です。 <em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIN(12);</code></strong>
        -&gt; '1100'
</pre></li><li class="listitem"><a name="function_bit-length"></a><p>
          <code class="literal">BIT_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041624062096"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> の長さをビット単位で返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIT_LENGTH('text');</code></strong>
        -&gt; 32
</pre></li><li class="listitem"><a name="function_char"></a><p>
          <code class="literal">CHAR(<em class="replaceable"><code>N</code></em>,... [USING <em class="replaceable"><code>charset_name</code></em>])</code>
        </p><a class="indexterm" name="idm46041624051008"></a><p>
          <code class="literal">CHAR()</code> は各 <em class="replaceable"><code>N</code></em> 引数を整数として解釈し、それらの整数のコード値で指定された文字を構成している文字列を返します。 <code class="literal">NULL</code> 値はスキップされます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,121,83,81,'76');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,77.3,'77.3');</code></strong>
        -&gt; 'MMM'
</pre><p>
          255 よりも大きい <code class="literal">CHAR()</code> 引数は、複数の結果バイトに変換されます。 たとえば、<code class="literal">CHAR(256)</code> は <code class="literal">CHAR(1,0)</code> に同等で、<code class="literal">CHAR(256*256)</code> は <code class="literal">CHAR(1,0,0)</code> に同等です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0)), HEX(CHAR(256));</code></strong>
+----------------+----------------+
| HEX(CHAR(1,0)) | HEX(CHAR(256)) |
+----------------+----------------+
| 0100           | 0100           |
+----------------+----------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0,0)), HEX(CHAR(256*256));</code></strong>
+------------------+--------------------+
| HEX(CHAR(1,0,0)) | HEX(CHAR(256*256)) |
+------------------+--------------------+
| 010000           | 010000             |
+------------------+--------------------+
</pre><p>
          デフォルトでは、<code class="literal">CHAR()</code> はバイナリ文字列を返します。 指定された文字セットで文字列を生成するには、オプションの <code class="literal">USING</code> 句を使用します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET(CHAR(X'65')), CHARSET(CHAR(X'65' USING utf8));</code></strong>
+----------------------+---------------------------------+
| CHARSET(CHAR(X'65')) | CHARSET(CHAR(X'65' USING utf8)) |
+----------------------+---------------------------------+
| binary               | utf8                            |
+----------------------+---------------------------------+
</pre><p>
          <code class="literal">USING</code> が指定され、結果文字列が指定された文字セットで不正である場合は、警告が発行されます。 また、厳密な SQL モードが有効になっている場合は、<code class="literal">CHAR()</code> からの結果は <code class="literal">NULL</code> になります。 
        </p></li><li class="listitem"><a name="function_char-length"></a><p>
          <code class="literal">CHAR_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041624020352"></a><p>
          文字で測定された文字列 <em class="replaceable"><code>str</code></em> の長さを返します。 マルチバイト文字は、単一の文字としてカウントされます。 つまり、5 つの 2 バイト文字を含む文字列では、<code class="literal">LENGTH()</code> は <code class="literal">10</code> を返し、<code class="literal">CHAR_LENGTH()</code> は <code class="literal">5</code> を返します。 
        </p></li><li class="listitem"><a name="function_character-length"></a><p>
          <code class="literal">CHARACTER_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041624008112"></a><p>
          <code class="literal">CHARACTER_LENGTH()</code> は <code class="literal">CHAR_LENGTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_concat"></a><p>
          <code class="literal">CONCAT(<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><a class="indexterm" name="idm46041623997728"></a><a class="indexterm" name="idm46041623996640"></a><a class="indexterm" name="idm46041623995216"></a><p>
          引数を連結することで生成される文字列を返します。 1 つ以上の引数を持つ場合があります。 すべての引数が非バイナリ文字列の場合は、結果も非バイナリ文字列になります。 引数にバイナリ文字列が含まれる場合は、結果はバイナリ文字列になります。 数値の引数は、同等の非バイナリ文字列形式に変換されます。 
        </p><p>
          引数のいずれかかが <code class="literal">NULL</code> である場合、<code class="literal">CONCAT()</code> は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', 'S', 'QL');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', NULL, 'QL');</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(14.3);</code></strong>
        -&gt; '14.3'
</pre><p>
          引用符で囲まれた文字列では、文字列を並べて配置することで連結が実行されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'My' 'S' 'QL';</code></strong>
        -&gt; 'MySQL'
</pre></li><li class="listitem"><a name="function_concat-ws"></a><p>
          <code class="literal">CONCAT_WS(<em class="replaceable"><code>separator</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><a class="indexterm" name="idm46041623976384"></a><p>
          <code class="literal">CONCAT_WS()</code> は Concatenate With Separator (区切り文字を使用した連結) を表し、<code class="literal">CONCAT()</code> の特殊な形式です。 最初の引数は、残りの引数の区切り文字です。 区切り文字は、連結される文字列の間に追加されます。 区切り文字は、残りの引数と同様に文字列にすることができます。 区切り文字が <code class="literal">NULL</code> の場合は、結果も <code class="literal">NULL</code> になります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name','Second name','Last Name');</code></strong>
        -&gt; 'First name,Second name,Last Name'
mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name',NULL,'Last Name');</code></strong>
        -&gt; 'First name,Last Name'
</pre><p>
          <code class="literal">CONCAT_WS()</code> では、空の文字列がスキップされません。 ただし、区切り文字引数のあとの <code class="literal">NULL</code> 値はすべてスキップされます。 
        </p></li><li class="listitem"><a name="function_elt"></a><p>
          <code class="literal">ELT(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code>
        </p><a class="indexterm" name="idm46041623957472"></a><p>
          <code class="literal">ELT()</code> は、文字列リストの <em class="replaceable"><code>N</code></em> 番目の要素を返します。<em class="replaceable"><code>N</code></em> = <code class="literal">1</code> の場合は <em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>N</code></em> = <code class="literal">2</code> の場合は <em class="replaceable"><code>str2</code></em> のように返します。 <em class="replaceable"><code>N</code></em> が <code class="literal">1</code> よりも小さいか、引数の数よりも大きい場合は、<code class="literal">NULL</code> を返します。 <code class="literal">ELT()</code> は <code class="literal">FIELD()</code> の補数です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ELT(1, 'Aa', 'Bb', 'Cc', 'Dd');</code></strong>
        -&gt; 'Aa'
mysql&gt; <strong class="userinput"><code>SELECT ELT(4, 'Aa', 'Bb', 'Cc', 'Dd');</code></strong>
        -&gt; 'Dd'
</pre></li><li class="listitem"><a name="function_export-set"></a><p>
          <code class="literal">EXPORT_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>on</code></em>,<em class="replaceable"><code>off</code></em>[,<em class="replaceable"><code>separator</code></em>[,<em class="replaceable"><code>number_of_bits</code></em>]])</code>
        </p><a class="indexterm" name="idm46041623936336"></a><p>
          値 <em class="replaceable"><code>bits</code></em> 内で各ビットが設定されている場合には <em class="replaceable"><code>on</code></em> 文字列を取得し、値内で各ビットが設定されていない場合には <em class="replaceable"><code>off</code></em> 文字列を取得するように、文字列を返します。 <em class="replaceable"><code>bits</code></em> のビットは、右から左 (下位ビットから上位ビット) へと検証されます。 文字列は、<em class="replaceable"><code>separator</code></em> 文字列 (デフォルトはカンマ文字 <code class="literal">,</code>) で区切られた結果に左から右へと追加されます。 検証されるビット数は、<em class="replaceable"><code>number_of_bits</code></em> で指定されます。指定されない場合のデフォルトは 64 です。<em class="replaceable"><code>number_of_bits</code></em> が 64 よりも大きい場合は、警告なしで 64 に短縮されます。 符号なし整数として処理されるため、値 −1 は実際には 64 と同じです。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(5,'Y','N',',',4);</code></strong>
        -&gt; 'Y,N,Y,N'
mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(6,'1','0',',',10);</code></strong>
        -&gt; '0,1,1,0,0,0,0,0,0,0'
</pre></li><li class="listitem"><a name="function_field"></a><p>
          <code class="literal">FIELD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code>
        </p><a class="indexterm" name="idm46041623919008"></a><p>
          <em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>str2</code></em>、<em class="replaceable"><code>str3</code></em>、<code class="literal">...</code> リスト内で <em class="replaceable"><code>str</code></em> のインデックス (位置) を返します。 <em class="replaceable"><code>str</code></em> が見つからない場合は、<code class="literal">0</code> を返します。 
        </p><p>
          <code class="literal">FIELD()</code> へのすべての引数が文字列の場合は、すべての引数が文字列として比較されます。 すべての引数が数値の場合は、数字として比較されます。 それ以外の場合は、引数が倍精度として比較されます。 
        </p><p>
          <code class="literal">NULL</code> ではどの値との等価比較にも失敗するため、<em class="replaceable"><code>str</code></em> が <code class="literal">NULL</code> である場合は、戻り値が <code class="literal">0</code> になります。 <code class="literal">FIELD()</code> は <code class="literal">ELT()</code> の補数です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FIELD('Bb', 'Aa', 'Bb', 'Cc', 'Dd', 'Ff');</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT FIELD('Gg', 'Aa', 'Bb', 'Cc', 'Dd', 'Ff');</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="function_find-in-set"></a><p>
          <code class="literal">FIND_IN_SET(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>strlist</code></em>)</code>
        </p><a class="indexterm" name="idm46041623896944"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>N</code></em> 部分文字列で構成される文字列リスト <em class="replaceable"><code>strlist</code></em> 内にある場合は、1 から <em class="replaceable"><code>N</code></em> までの範囲内の値を返します。 文字列リストは、<code class="literal">,</code> 文字で区切られた部分文字列で構成された文字列です。 最初の引数が定数文字列で、2 番目が <code class="literal">SET</code> 型のカラムの場合、<code class="literal">FIND_IN_SET()</code> 関数はビット演算を使用するために最適化されます。 <em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>strlist</code></em> 内にない場合、または <em class="replaceable"><code>strlist</code></em> が空の文字列の場合は、<code class="literal">0</code> を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 最初の引数にカンマ (<code class="literal">,</code>) 文字が含まれる場合は、この関数が正しく動作しません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FIND_IN_SET('b','a,b,c,d');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_format"></a><p>
          <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>[,<em class="replaceable"><code>locale</code></em>])</code>
        </p><a class="indexterm" name="idm46041623876416"></a><p>
          数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。 <em class="replaceable"><code>D</code></em> が <code class="literal">0</code> の場合は、結果に小数点または小数部が含まれません。 
        </p><p>
          オプションの 3 番目のパラメータを使用すると、結果数の小数点、3 桁の区切り文字、および区切り文字間のグループ化に使用されるロケールを指定できます。 許可されるロケール値は、<code class="literal">lc_time_names</code> システム変数の有効な値と同じです (<a class="xref" href="charset.html#locale-support" title="10.16 MySQL Server のロケールサポート">セクション10.16「MySQL Server のロケールサポート」</a>を参照してください)。 ロケールが指定されていない場合のデフォルトは、<code class="literal">'en_US'</code> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.123456, 4);</code></strong>
        -&gt; '12,332.1235'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.1,4);</code></strong>
        -&gt; '12,332.1000'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,0);</code></strong>
        -&gt; '12,332'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,2,'de_DE');</code></strong>
        -&gt; '12.332,20'
</pre></li><li class="listitem"><a name="function_from-base64"></a><p>
          <code class="literal">FROM_BASE64(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623857312"></a><p>
          <code class="literal">TO_BASE64()</code> で使用される base-64 でエンコードされたルールでエンコードされた文字列が指定され、デコードされた結果をバイナリ文字列として返します。 引数が <code class="literal">NULL</code> の場合または有効な base-64 文字列でない場合は、結果が <code class="literal">NULL</code> になります。 ルールのエンコードおよびデコードについての詳細は、<code class="literal">TO_BASE64()</code> の説明を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong>
        -&gt; 'JWJj', 'abc'
</pre></li><li class="listitem"><a name="function_hex"></a><p>
          <code class="literal">HEX(<em class="replaceable"><code>str</code></em>)</code>, <code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041623841648"></a><p>
          文字列の引数 <em class="replaceable"><code>str</code></em> では、<code class="literal">HEX()</code> は <em class="replaceable"><code>str</code></em> の 16 進数文字列表現を返します。<em class="replaceable"><code>str</code></em> 内の各文字の各バイトは、2 つの 16 進数字に変換されます。 (したがって、マルチバイト文字は 2 桁よりも大きくなります。) この演算の逆は、<code class="literal">UNHEX()</code> 関数で実行されます。 
        </p><p>
          数値の引数 <em class="replaceable"><code>N</code></em> では、<code class="literal">HEX()</code> は、longlong (<code class="literal">BIGINT</code>) 数字として処理される <em class="replaceable"><code>N</code></em> の 16 進数文字列表現を返します。 これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10.16)</code> と同等です。 この演算の逆は、<code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code> で実行されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT X'616263', HEX('abc'), UNHEX(HEX('abc'));</code></strong>
        -&gt; 'abc', 616263, 'abc'
mysql&gt; <strong class="userinput"><code>SELECT HEX(255), CONV(HEX(255),16,10);</code></strong>
        -&gt; 'FF', 255
</pre></li><li class="listitem"><a name="function_insert"></a><p>
          <code class="literal">INSERT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>newstr</code></em>)</code>
        </p><a class="indexterm" name="idm46041623819312"></a><p>
          位置 <em class="replaceable"><code>pos</code></em> で始まる部分文字列と、文字列 <em class="replaceable"><code>newstr</code></em> で置換された <em class="replaceable"><code>len</code></em> 文字長とともに、文字列 <em class="replaceable"><code>str</code></em> を返します。 <em class="replaceable"><code>pos</code></em> が文字列の長さに収まらない場合は、元の文字列を返します。 <em class="replaceable"><code>len</code></em> が残りの文字列の長さに収まらない場合は、位置 <em class="replaceable"><code>pos</code></em> からの残りの文字列を置換します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 4, 'What');</code></strong>
        -&gt; 'QuWhattic'
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', -1, 4, 'What');</code></strong>
        -&gt; 'Quadratic'
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 100, 'What');</code></strong>
        -&gt; 'QuWhat'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_instr"></a><p>
          <code class="literal">INSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>substr</code></em>)</code>
        </p><a class="indexterm" name="idm46041623801520"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> 内で部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。 これは、引数の順序が逆になる点を除いて、2 つの引数形式の <code class="literal">LOCATE()</code> と同じです。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INSTR('foobarbar', 'bar');</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT INSTR('xbar', 'foobar');</code></strong>
        -&gt; 0
</pre><p>
          この関数はマルチバイトセーフであり、1 つ以上の引数がバイナリ文字列である場合にのみ大文字と小文字が区別されます。
        </p></li><li class="listitem"><a name="function_lcase"></a><p>
          <code class="literal">LCASE(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623787760"></a><p>
          <code class="literal">LCASE()</code> は <code class="literal">LOWER()</code> のシノニムです。
        </p><p>
          ビューで使用される <code class="literal">LCASE()</code> は、ビュー定義の格納時に <code class="literal">LOWER()</code> としてリライトされます。 (Bug #12844279) 
        </p></li><li class="listitem"><a name="function_left"></a><p>
          <code class="literal">LEFT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041623775376"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> から左端の <em class="replaceable"><code>len</code></em> 文字を返し、引数が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LEFT('foobarbar', 5);</code></strong>
        -&gt; 'fooba'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_length"></a><p>
          <code class="literal">LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623762288"></a><p>
          バイトで測定された文字列 <em class="replaceable"><code>str</code></em> の長さを返します。 マルチバイト文字は、複数のバイトとしてカウントされます。 つまり、5 つの 2 バイト文字を含む文字列では、<code class="literal">LENGTH()</code> は <code class="literal">10</code> を返し、<code class="literal">CHAR_LENGTH()</code> は <code class="literal">5</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LENGTH('text');</code></strong>
        -&gt; 4
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            MySQL では、<code class="literal">Length()</code> OpenGIS 空間関数の名前は <code class="literal">ST_Length()</code> です。
          </p></div></li><li class="listitem"><a name="function_load-file"></a><p>
          <code class="literal">LOAD_FILE(<em class="replaceable"><code>file_name</code></em>)</code>
        </p><a class="indexterm" name="idm46041623745280"></a><a class="indexterm" name="idm46041623743936"></a><p>
          ファイルを読み取り、ファイルの内容を文字列として返します。 この関数を使用するには、ファイルがサーバーホストに配置されている必要があり、ファイルへのフルパス名を指定し、<code class="literal">FILE</code> 権限を持つ必要があります。 ファイルは、サーバーで読取り可能で、そのサイズが <code class="literal">max_allowed_packet</code> バイト未満である必要があります。 <code class="literal">secure_file_priv</code> システム変数が空でないディレクトリ名に設定されている場合は、そのディレクトリ内にロード対象のファイルが配置されている必要があります。 (MySQL 8.0.17 より前では、ファイルはサーバーから読み取り可能であるだけでなく、すべてから読み取り可能である必要があります。) 
        </p><p>
          ファイルが存在しない場合、または上記の条件が満たされていないために、ファイルを読み取ることができない場合、この関数は <code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">character_set_filesystem</code> システム変数では、リテラル文字列として指定されているファイル名の解釈が制御されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE t</code></strong>
          <strong class="userinput"><code>  SET blob_col=LOAD_FILE('/tmp/picture')</code></strong>
          <strong class="userinput"><code>  WHERE id=1;</code></strong>
</pre></li><li class="listitem"><a name="function_locate"></a><p>
          <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code>, <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>
        </p><a class="indexterm" name="idm46041623722432"></a><p>
          1 番目の構文は、文字列 <em class="replaceable"><code>str</code></em> 内で、部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。 2 番目の構文は、文字列 <em class="replaceable"><code>str</code></em> 内の位置 <em class="replaceable"><code>pos</code></em> 以降で、部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。 <em class="replaceable"><code>str</code></em> 内に <em class="replaceable"><code>substr</code></em> がない場合は、<code class="literal">0</code> を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar');</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('xbar', 'foobar');</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar', 5);</code></strong>
        -&gt; 7
</pre><p>
          この関数はマルチバイトセーフであり、1 つ以上の引数がバイナリ文字列である場合にのみ大文字と小文字が区別されます。
        </p></li><li class="listitem"><a name="function_lower"></a><p>
          <code class="literal">LOWER(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623704368"></a><p>
          現在の文字セットのマッピングに従って、すべての文字が小文字に変更された文字列 <em class="replaceable"><code>str</code></em> を返します。 デフォルトは <code class="literal">utf8mb4</code> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOWER('QUADRATICALLY');</code></strong>
        -&gt; 'quadratically'
</pre><p>
          <code class="literal">LOWER()</code> (および <code class="literal">UPPER()</code>) をバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code>) に適用しても、何の効果もありません。 バイナリ文字列の大文字と小文字の変換を実行するには、まず文字列に格納されているデータに適した文字セットを使用して、非バイナリ文字列に変換します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING utf8mb4));</code></strong>
+-------------+------------------------------------+
| LOWER(@str) | LOWER(CONVERT(@str USING utf8mb4)) |
+-------------+------------------------------------+
| New York    | new york                           |
+-------------+------------------------------------+
</pre><p>
          Unicode 文字セットの照合の場合、<code class="literal">LOWER()</code> および <code class="literal">UPPER()</code> は、照合名の Unicode 照合アルゴリズム (UCA) バージョン (存在する場合) および UCA 4.0.0 (バージョンが指定されていない場合) に従って動作します。 たとえば、<code class="literal">utf8mb4_0900_ai_ci</code> と <code class="literal">utf8_unicode_520_ci</code> はそれぞれ UCA 9.0.0 と 5.2.0 に従って動作し、<code class="literal">utf8_unicode_ci</code> は UCA 4.0.0 に従って動作します。 <a class="xref" href="charset.html#charset-unicode-sets" title="10.10.1 Unicode 文字セット">セクション10.10.1「Unicode 文字セット」</a>を参照してください。 
        </p><p>
          この関数はマルチバイトセーフです。
        </p><p>
          ビュー内で使用される <code class="literal">LCASE()</code> は、<code class="literal">LOWER()</code> としてリライトされます。
        </p></li><li class="listitem"><a name="function_lpad"></a><p>
          <code class="literal">LPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code>
        </p><a class="indexterm" name="idm46041623675328"></a><p>
          <em class="replaceable"><code>len</code></em> 文字の長さになるように文字列 <em class="replaceable"><code>padstr</code></em> で左にパディングされた文字列 <em class="replaceable"><code>str</code></em> を返します。 <em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>len</code></em> よりも長い場合は、戻り値は <em class="replaceable"><code>len</code></em> 文字に短縮されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',4,'??');</code></strong>
        -&gt; '??hi'
mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',1,'??');</code></strong>
        -&gt; 'h'
</pre></li><li class="listitem"><a name="function_ltrim"></a><p>
          <code class="literal">LTRIM(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623661616"></a><p>
          先頭の空白文字が削除された文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LTRIM('  barbar');</code></strong>
        -&gt; 'barbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_make-set"></a><p>
          <code class="literal">MAKE_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><a class="indexterm" name="idm46041623649504"></a><p>
          <em class="replaceable"><code>bits</code></em> セット内の対応するビットを持つ文字列で構成されるセット値 (<code class="literal">,</code> 文字で区切られた部分文字列を含む文字列) を返します。<em class="replaceable"><code>str1</code></em> はビット 0 に対応し、<em class="replaceable"><code>str2</code></em> はビット 1 に対応する、などとなります。 <em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>str2</code></em>、<code class="literal">...</code> 内の <code class="literal">NULL</code> 値は結果に追加されません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1,'a','b','c');</code></strong>
        -&gt; 'a'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice','world');</code></strong>
        -&gt; 'hello,world'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice',NULL,'world');</code></strong>
        -&gt; 'hello'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(0,'a','b','c');</code></strong>
        -&gt; ''
</pre></li><li class="listitem"><a name="function_mid"></a><p>
          <code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041623631472"></a><p>
          <code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code> は、<code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_oct"></a><p>
          <code class="literal">OCT(<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041623619248"></a><p>
          <em class="replaceable"><code>N</code></em> の 8 進数の文字列表現を返します。<em class="replaceable"><code>N</code></em> は longlong (<code class="literal">BIGINT</code>) 数字です。 これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10.8)</code> と同等です。 <em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT OCT(12);</code></strong>
        -&gt; '14'
</pre></li><li class="listitem"><a name="function_octet-length"></a><p>
          <code class="literal">OCTET_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623603856"></a><p>
          <code class="literal">OCTET_LENGTH()</code> は <code class="literal">LENGTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_ord"></a><p>
          <code class="literal">ORD(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623593936"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> の左端の文字がマルチバイト文字である場合は、その文字のコードを返します。コードは、次の計算式を使用して、その構成要素の数値から計算されます。
        </p><pre class="programlisting">  (1st byte code)
+ (2nd byte code * 256)
+ (3rd byte code * 256^2) ...
</pre><p>
          左端の文字がマルチバイト文字でない場合は、<code class="literal">ORD()</code> は <code class="literal">ASCII()</code> 関数と同じ値を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ORD('2');</code></strong>
        -&gt; 50
</pre></li><li class="listitem"><a name="function_position"></a><p>
          <code class="literal">POSITION(<em class="replaceable"><code>substr</code></em> IN <em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623578960"></a><p>
          <code class="literal">POSITION(<em class="replaceable"><code>substr</code></em> IN <em class="replaceable"><code>str</code></em>)</code> は <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_quote"></a><p>
          <code class="literal">QUOTE(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623567424"></a><p>
          SQL ステートメントで、適切にエスケープされたデータ値として使用できる結果を生成する文字列を引用符で囲みます。 文字列は一重引用符で囲まれ、バックスラッシュ (<code class="literal">\</code>)、一重引用符 (<code class="literal">'</code>)、ASCII <code class="literal">NUL</code> および Control+Z の各インスタンスの前にバックスラッシュが付いて返されます。 引数が <code class="literal">NULL</code> の場合の戻り値は、一重引用符で囲まれていない単語 <span class="quote">「<span class="quote">NULL</span>」</span> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT QUOTE('Don\'t!');</code></strong>
        -&gt; 'Don\'t!'
mysql&gt; <strong class="userinput"><code>SELECT QUOTE(NULL);</code></strong>
        -&gt; NULL
</pre><a class="indexterm" name="idm46041623556992"></a><p>
          比較するために、<a class="xref" href="language-structure.html#string-literals" title="9.1.1 文字列リテラル">セクション9.1.1「文字列リテラル」</a>および<a class="ulink" href="https://dev.mysql.com/doc/c-api/8.0/en/mysql-real-escape-string-quote.html" target="_top">mysql_real_escape_string_quote()</a>で、リテラル文字列に対する引用ルールと C API 内の引用ルールを参照してください。
        </p></li><li class="listitem"><a name="function_repeat"></a><p>
          <code class="literal">REPEAT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>count</code></em>)</code>
        </p><a class="indexterm" name="idm46041623548656"></a><p>
          <em class="replaceable"><code>count</code></em> 回繰り返された文字列 <em class="replaceable"><code>str</code></em> で構成される文字列を返します。 <em class="replaceable"><code>count</code></em> が 1 よりも小さい場合は、空の文字列を返します。 <em class="replaceable"><code>str</code></em> または <em class="replaceable"><code>count</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REPEAT('MySQL', 3);</code></strong>
        -&gt; 'MySQLMySQLMySQL'
</pre></li><li class="listitem"><a name="function_replace"></a><p>
          <code class="literal">REPLACE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>from_str</code></em>,<em class="replaceable"><code>to_str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623533744"></a><p>
          文字列 <em class="replaceable"><code>from_str</code></em> のすべての出現箇所が文字列 <em class="replaceable"><code>to_str</code></em> で置換された、文字列 <em class="replaceable"><code>str</code></em> を返します。 <code class="literal">REPLACE()</code> は、<em class="replaceable"><code>from_str</code></em> を検索する際に、大文字と小文字を区別した一致を実行します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REPLACE('www.mysql.com', 'w', 'Ww');</code></strong>
        -&gt; 'WwWwWw.mysql.com'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_reverse"></a><p>
          <code class="literal">REVERSE(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623519920"></a><p>
          文字の順序が逆になった文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REVERSE('abc');</code></strong>
        -&gt; 'cba'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_right"></a><p>
          <code class="literal">RIGHT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041623508352"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> から右端の <em class="replaceable"><code>len</code></em> 文字を返し、引数が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RIGHT('foobarbar', 4);</code></strong>
        -&gt; 'rbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_rpad"></a><p>
          <code class="literal">RPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code>
        </p><a class="indexterm" name="idm46041623494464"></a><p>
          <em class="replaceable"><code>len</code></em> 文字の長さになるように文字列 <em class="replaceable"><code>padstr</code></em> で右にパディングされた文字列 <em class="replaceable"><code>str</code></em> を返します。 <em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>len</code></em> よりも長い場合は、戻り値は <em class="replaceable"><code>len</code></em> 文字に短縮されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',5,'?');</code></strong>
        -&gt; 'hi???'
mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',1,'?');</code></strong>
        -&gt; 'h'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_rtrim"></a><p>
          <code class="literal">RTRIM(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623480208"></a><p>
          末尾の空白文字が削除された文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RTRIM('barbar   ');</code></strong>
        -&gt; 'barbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_soundex"></a><p>
          <code class="literal">SOUNDEX(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623468992"></a><p>
          <em class="replaceable"><code>str</code></em> から soundex 文字列を返します。 ほぼ同じ発音の 2 つの文字列は、同じ soundex 文字列を持つはずです。 標準の soundex 文字列の長さは 4 文字ですが、<code class="literal">SOUNDEX()</code> 関数は任意の長さの文字列を返します。 結果で <code class="literal">SUBSTRING()</code> を使用すると、標準の soundex 文字列を取得できます。 <em class="replaceable"><code>str</code></em> 内のアルファベット以外の文字はすべて無視されます。 A から Z までの範囲外の国際アルファベット文字はすべて、母音として処理されます。 
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            <code class="literal">SOUNDEX()</code> の使用時には、次の制限に注意してください。
          </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              現在実装されているこの関数は、文字列の言語が英語である場合にのみ機能するように設計されています。 その他の言語の文字列では、信頼できる結果が生成されない可能性があります。 
            </p></li><li class="listitem"><p>
              この関数では、文字列でマルチバイト文字セット (<code class="literal">utf-8</code> など) が使用されている場合に、整合性のある結果が生成されることは保証されません。 詳細は、Bug #22638 を参照してください。 
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Hello');</code></strong>
        -&gt; 'H400'
mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Quadratically');</code></strong>
        -&gt; 'Q36324'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            この関数には、オリジナルの Soundex アルゴリズムが実装されています。より人気のある拡張バージョンではありません (この作成者も D.  Knuth です)。 相違点としては、元のバージョンではまず母音が破棄されてから複製が破棄されますが、拡張バージョンではまず複製が破棄されてから母音が破棄されます。 
          </p></div></li><li class="listitem"><a name="operator_sounds-like"></a><p>
          <code class="literal"><em class="replaceable"><code>expr1</code></em> SOUNDS LIKE <em class="replaceable"><code>expr2</code></em></code>
        </p><a class="indexterm" name="idm46041623446816"></a><p>
          これは、<code class="literal">SOUNDEX(<em class="replaceable"><code>expr1</code></em>) = SOUNDEX(<em class="replaceable"><code>expr2</code></em>)</code> と同じです。
        </p></li><li class="listitem"><a name="function_space"></a><p>
          <code class="literal">SPACE(<em class="replaceable"><code>N</code></em>)</code>
        </p><a class="indexterm" name="idm46041623436976"></a><p>
          <em class="replaceable"><code>N</code></em> 空白文字で構成される文字列を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SPACE(6);</code></strong>
        -&gt; '      '
</pre></li><li class="listitem"><a name="function_substr"></a><p>
          <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em> FOR <em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041623419968"></a><p>
          <code class="literal">SUBSTR()</code> は <code class="literal">SUBSTRING()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_substring"></a><p>
          <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em> FOR <em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041623403632"></a><p>
          <em class="replaceable"><code>len</code></em> 引数を付けない形式では、位置 <em class="replaceable"><code>pos</code></em> で始まる文字列 <em class="replaceable"><code>str</code></em> からの部分文字列が返されます。 <em class="replaceable"><code>len</code></em> 引数を付けた形式では、位置 <em class="replaceable"><code>pos</code></em> で始まる文字列 <em class="replaceable"><code>str</code></em> からの部分文字列 <em class="replaceable"><code>len</code></em> 文字長が返されます。 <code class="literal">FROM</code> を使用する形式は、標準の SQL 構文です。 また、<em class="replaceable"><code>pos</code></em> に負の値を使用することもできます。 その場合、部分文字列の先頭は文字列の先頭でなく、文字列の末尾からの <em class="replaceable"><code>pos</code></em> 文字になります。 この関数のどの形式でも、<em class="replaceable"><code>pos</code></em> で負の値を使用できます。 <em class="replaceable"><code>pos</code></em> の値が 0 の場合、空の文字列が返されます。 
        </p><p>
          すべての形式の <code class="literal">SUBSTRING()</code> で、部分文字列の抽出が開始される文字列内の最初の文字の位置が <code class="literal">1</code> とみなされます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5);</code></strong>
        -&gt; 'ratically'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('foobarbar' FROM 4);</code></strong>
        -&gt; 'barbar'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5,6);</code></strong>
        -&gt; 'ratica'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -3);</code></strong>
        -&gt; 'ila'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -5, 3);</code></strong>
        -&gt; 'aki'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila' FROM -4 FOR 2);</code></strong>
        -&gt; 'ki'
</pre><p>
          この関数はマルチバイトセーフです。
        </p><p>
          <em class="replaceable"><code>len</code></em> が 1 よりも小さい場合は、結果が空の文字列になります。
        </p></li><li class="listitem"><a name="function_substring-index"></a><p>
          <code class="literal">SUBSTRING_INDEX(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>delim</code></em>,<em class="replaceable"><code>count</code></em>)</code>
        </p><a class="indexterm" name="idm46041623378464"></a><p>
          文字列 <em class="replaceable"><code>str</code></em> から、区切り文字 <em class="replaceable"><code>delim</code></em> が <em class="replaceable"><code>count</code></em> 回出現する前の部分文字列を返します。 <em class="replaceable"><code>count</code></em> が正の値の場合は、(左から数えて) 最後の区切り文字の左側にあるすべてが返されます。 <em class="replaceable"><code>count</code></em> が負の値の場合は、(右から数えて) 最後の区切り文字の右側にあるすべてが返されます。 <code class="literal">SUBSTRING_INDEX()</code> は、<em class="replaceable"><code>delim</code></em> を検索する際に、大文字と小文字を区別した一致を実行します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', 2);</code></strong>
        -&gt; 'www.mysql'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', -2);</code></strong>
        -&gt; 'mysql.com'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_to-base64"></a><p>
          <code class="literal">TO_BASE64(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623362496"></a><p>
          文字列の引数を base-64 でエンコードされた形式に変換し、その結果を接続文字セットと照合順序が含まれる文字列として返します。 引数が文字列でない場合は、変換が実行される前に文字列に変換されます。 引数が <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。 <code class="literal">FROM_BASE64()</code> 関数を使用すると、base-64 でエンコードされた文字列をデコードできます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong>
        -&gt; 'JWJj', 'abc'
</pre><p>
          さまざまな base-64 エンコードスキームが存在します。 これらは、<code class="literal">TO_BASE64()</code> および <code class="literal">FROM_BASE64()</code> で使用されるエンコードおよびデコードのルールです。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              アルファベット値 62 のエンコードは <code class="literal">'+'</code> です。
            </p></li><li class="listitem"><p>
              アルファベット値 63 のエンコードは <code class="literal">'/'</code> です。
            </p></li><li class="listitem"><p>
              エンコードされた出力は、出力可能な 4 文字のグループで構成されます。 入力データの各 3 バイトは、4 文字を使用してエンコードされます。 最後のグループが不完全な場合は、長さが 4 になるまで <code class="literal">'='</code> 文字でパディングされます。 
            </p></li><li class="listitem"><p>
              長い出力を複数の行に分割するために、エンコードされた出力の各 76 文字の後ろに改行が追加されます。
            </p></li><li class="listitem"><p>
              デコードでは改行、復帰改行、タブ、および空白が認識および無視されます。
            </p></li></ul></div></li><li class="listitem"><a name="function_trim"></a><p>
          <code class="literal">TRIM([{BOTH | LEADING | TRAILING} [<em class="replaceable"><code>remstr</code></em>] FROM] <em class="replaceable"><code>str</code></em>)</code>, <code class="literal">TRIM([<em class="replaceable"><code>remstr</code></em> FROM] <em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623335936"></a><p>
          すべての <em class="replaceable"><code>remstr</code></em> プリフィクスまたはサフィクスが削除された文字列 <em class="replaceable"><code>str</code></em> を返します。 <code class="literal">BOTH</code>、<code class="literal">LEADING</code>、<code class="literal">TRAILING</code> のいずれの指定子も指定されない場合は、<code class="literal">BOTH</code> が指定されたとみなされます。<em class="replaceable"><code>remstr</code></em> はオプションであり、指定されない場合は空白文字が削除されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TRIM('  bar   ');</code></strong>
        -&gt; 'bar'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(LEADING 'x' FROM 'xxxbarxxx');</code></strong>
        -&gt; 'barxxx'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(BOTH 'x' FROM 'xxxbarxxx');</code></strong>
        -&gt; 'bar'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz');</code></strong>
        -&gt; 'barx'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_ucase"></a><p>
          <code class="literal">UCASE(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623318192"></a><p>
          <code class="literal">UCASE()</code> は <code class="literal">UPPER()</code> のシノニムです。
        </p><p>
          ビュー内で使用される <code class="literal">UCASE()</code> は、<code class="literal">UPPER()</code> としてリライトされます。
        </p></li><li class="listitem"><a name="function_unhex"></a><p>
          <code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623306288"></a><p>
          文字列の引数 <em class="replaceable"><code>str</code></em> では、<code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code> は引数の各文字ペアを 16 進数として解釈し、その数字で表されたバイトに変換します。 戻り値はバイナリ文字列です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNHEX('4D7953514C');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT X'4D7953514C';</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT UNHEX(HEX('string'));</code></strong>
        -&gt; 'string'
mysql&gt; <strong class="userinput"><code>SELECT HEX(UNHEX('1267'));</code></strong>
        -&gt; '1267'
</pre><p>
          引数文字列内の文字は、正当な 16 進数である必要があります: <code class="literal">'0'</code> .. <code class="literal">'9'</code>、<code class="literal">'A'</code> .. <code class="literal">'F'</code>、<code class="literal">'a'</code> .. <code class="literal">'f'</code>。 引数に 16 進以外の数字が含まれている場合は、結果が <code class="literal">NULL</code> になります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNHEX('GG');</code></strong>
+-------------+
| UNHEX('GG') |
+-------------+
| NULL        |
+-------------+
</pre><p>
          <code class="literal">NULL</code> の結果は、<code class="literal">UNHEX()</code> への引数が <code class="literal">BINARY</code> カラムの場合に発生することがあります。これは、格納時に値に <code class="literal">0x00</code> バイトが埋め込まれても、それらのバイトは取得時に削除されないためです。 たとえば、<code class="literal">'41'</code>は<code class="literal">'41 '</code>として <code class="literal">CHAR(3)</code> カラムに格納され、<code class="literal">'41'</code>として取得されるため (末尾の空白が削除されます)、カラム値の <code class="literal">UNHEX()</code> は <code class="literal">X'41'</code>を返します。 対照的に、<code class="literal">'41'</code>は<code class="literal">'41\0'</code>として <code class="literal">BINARY(3)</code> カラムに格納され、<code class="literal">'41\0'</code>として取得されます (後続パッド <code class="literal">0x00</code> バイトは削除されません)。<code class="literal">'\0'</code>は有効な 16 進数ではないため、カラム値の <code class="literal">UNHEX()</code> は <code class="literal">NULL</code> を返します。 
        </p><p>
          数値の引数 <em class="replaceable"><code>N</code></em> の場合、<code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code> の逆は <code class="literal">UNHEX()</code> では実行されません。 代わりに、<code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code> を使用してください。 <code class="literal">HEX()</code> の説明を参照してください。 
        </p></li><li class="listitem"><a name="function_upper"></a><p>
          <code class="literal">UPPER(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041623263232"></a><p>
          現在の文字セットのマッピングに従って、すべての文字が大文字に変更された文字列 <em class="replaceable"><code>str</code></em> を返します。 デフォルトは <code class="literal">utf8mb4</code> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UPPER('Hej');</code></strong>
        -&gt; 'HEJ'
</pre><p>
          <code class="literal">UPPER()</code> にも適用される情報については、<code class="literal">LOWER()</code> の説明を参照してください。 これには、現在は機能が無効になっているバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code>) の大文字と小文字の変換を実行する方法に関する情報、および Unicode 文字セットの大文字と小文字の変換に関する情報が含まれていました。 
        </p><p>
          この関数はマルチバイトセーフです。
        </p><p>
          ビュー内で使用される <code class="literal">UCASE()</code> は、<code class="literal">UPPER()</code> としてリライトされます。
        </p></li><li class="listitem"><a name="function_weight-string"></a><p>
          <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str</code></em> [AS {CHAR|BINARY}(<em class="replaceable"><code>N</code></em>)] [<em class="replaceable"><code>flags</code></em>])</code>
        </p><a class="indexterm" name="idm46041623242768"></a><p>
          この関数は、入力文字列の重み文字列を返します。 戻り値は、文字列の比較およびソート値を表すバイナリ文字列です。 これらのプロパティーがあります。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code> = <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code> の場合は、<code class="literal"><em class="replaceable"><code>str1</code></em> = <em class="replaceable"><code>str2</code></em></code> です (<em class="replaceable"><code>str1</code></em> と <em class="replaceable"><code>str2</code></em> は等しいとみなされます)。
            </p></li><li class="listitem"><p>
              <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code> &lt; <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code> の場合は、<code class="literal"><em class="replaceable"><code>str1</code></em> &lt; <em class="replaceable"><code>str2</code></em></code> です (<em class="replaceable"><code>str1</code></em> は <em class="replaceable"><code>str2</code></em> の前にソートされます)。
            </p></li></ul></div><p>
          <code class="literal">WEIGHT_STRING()</code> は、内部使用を目的としたデバッグ機能です。 その動作は、MySQL のバージョン間で予告なしに変更できます。 これは、特に新しい照合を追加する場合に、照合のテストおよびデバッグに使用できます。 <a class="xref" href="charset.html#adding-collation" title="10.14 文字セットへの照合順序の追加">セクション10.14「文字セットへの照合順序の追加」</a>を参照してください。 
        </p><p>
          このリストには、引数が簡単にまとめられています。 詳細は、リストの後の説明を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>str</code></em>: 入力文字列式。
            </p></li><li class="listitem"><p>
              <code class="literal">AS</code> 句: オプション。入力文字列を指定された型と長さにキャストします。
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>flags</code></em>: Optional; unused.
            </p></li></ul></div><p>
          入力文字列 <em class="replaceable"><code>str</code></em> は文字列式です。 入力が非バイナリ (文字) 文字列 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、<code class="literal">TEXT</code> 値など) である場合は、戻り値に文字列の照合順序重みが含まれます。 入力がバイナリ (バイト) 文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code> 値など) である場合は、戻り値は入力と同じです (バイナリ文字列のバイトごとの重みはバイト値です)。 入力が <code class="literal">NULL</code> である場合は、<code class="literal">WEIGHT_STRING()</code> は <code class="literal">NULL</code> を返します。 
        </p><p>
          例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = _utf8mb4 'AB' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| AB   | 4142    | 1C471C60               |
+------+---------+------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = _utf8mb4 'ab' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| ab   | 6162    | 1C471C60               |
+------+---------+------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CAST('AB' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| AB   | 4142    | 4142                   |
+------+---------+------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CAST('ab' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| ab   | 6162    | 6162                   |
+------+---------+------------------------+
</pre><p>
          上記の例では、<code class="literal">HEX()</code> を使用して <code class="literal">WEIGHT_STRING()</code> の結果を表示しています。 結果はバイナリ値であるため、結果に出力されない値が含まれるときに出力可能な形式で表示する際に、<code class="literal">HEX()</code> が特に役立ちます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CONVERT(X'C39F' USING utf8) COLLATE utf8_czech_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(@s));</code></strong>
+------------------------+
| HEX(WEIGHT_STRING(@s)) |
+------------------------+
| 0FEA0FEA               |
+------------------------+
</pre><p>
          非 <code class="literal">NULL</code> の戻り値では、長さが <code class="literal">VARBINARY</code> の最大長内である場合は、値のデータ型が <code class="literal">VARBINARY</code> であり、その他の場合はデータ型は <code class="literal">BLOB</code> です。
        </p><p>
          入力文字列を非バイナリまたはバイナリの文字列にキャストし、強制的に指定した長さになるように、<code class="literal">AS</code> 句が指定されている場合があります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">AS CHAR(<em class="replaceable"><code>N</code></em>)</code> は、文字列を非バイナリ文字列にキャストし、<em class="replaceable"><code>N</code></em> 文字の長さになるように空白文字で右側をパディングします。 <em class="replaceable"><code>N</code></em> は少なくとも 1 にする必要があります。 <em class="replaceable"><code>N</code></em> が入力文字列の長さよりも小さい場合は、文字列が <em class="replaceable"><code>N</code></em> 文字まで切り捨てられます。 切り捨てられても警告は発生しません。 
            </p></li><li class="listitem"><p>
              <code class="literal">AS BINARY(<em class="replaceable"><code>N</code></em>)</code> は、文字列がバイナリ文字列にキャストされ、<em class="replaceable"><code>N</code></em> が (文字単位ではなく) バイト単位で測定され、パディングで (空白文字でななく) <code class="literal">0x00</code> バイトが使用される点を除いて同様です。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET NAMES 'latin1';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS CHAR(4)));</code></strong>
+-------------------------------------+
| HEX(WEIGHT_STRING('ab' AS CHAR(4))) |
+-------------------------------------+
| 41422020                            |
+-------------------------------------+
mysql&gt; <strong class="userinput"><code>SET NAMES 'utf8';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS CHAR(4)));</code></strong>
+-------------------------------------+
| HEX(WEIGHT_STRING('ab' AS CHAR(4))) |
+-------------------------------------+
| 0041004200200020                    |
+-------------------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS BINARY(4)));</code></strong>
+---------------------------------------+
| HEX(WEIGHT_STRING('ab' AS BINARY(4))) |
+---------------------------------------+
| 61620000                              |
+---------------------------------------+
</pre><p>
          現在、<em class="replaceable"><code>flags</code></em> 句は使用されていません。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="string-comparison-functions"></a>12.8.1 文字列比較関数および演算子</h3></div></div></div><a class="indexterm" name="idm46041623168848"></a><a class="indexterm" name="idm46041623167376"></a><a class="indexterm" name="idm46041623165328"></a><a class="indexterm" name="idm46041623163952"></a><div class="table"><a name="idm46041623161904"></a><p class="title"><b>表 12.13 「文字列比較関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「文字列比較関数および演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      単純なパターン一致
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      単純なパターン一致の否定
    </td>
</tr><tr><td><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      2 つの文字列を比較します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        文字列関数に引数としてバイナリ文字列が指定されている場合は、結果の文字列もバイナリ文字列になります。 文字列に変換された数字は、バイナリ文字列として処理されます。 比較のみがこの影響を受けます。 
      </p><a class="indexterm" name="idm46041623145088"></a><a class="indexterm" name="idm46041623142912"></a><p>
        通常、文字列比較のいずれかの式で大/小文字が区別される場合、比較は大/小文字を区別して実行されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_like"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>']</code>
          </p><a class="indexterm" name="idm46041623134528"></a><p>
            SQL パターンを使用したパターン一致。 <code class="literal">1</code> (<code class="literal">TRUE</code>) または <code class="literal">0</code> (<code class="literal">FALSE</code>) を返します。 <em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> のいずれかが <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。 
          </p><p>
            パターンはリテラル文字列である必要はありません。 たとえば、文字列式やテーブルカラムとして指定できます。 後者の場合、カラムは MySQL 文字列型のいずれかとして定義する必要があります (<a class="xref" href="data-types.html#string-types" title="11.3 文字列データ型">セクション11.3「文字列データ型」</a> を参照)。 
          </p><p>
            SQL 標準では、<code class="literal">LIKE</code> は文字ごとに一致を実行するため、<code class="literal">=</code> 比較演算子とは異なる結果が生成される可能性があります。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'ä' LIKE 'ae' COLLATE latin1_german2_ci;</code></strong>
+-----------------------------------------+
| 'ä' LIKE 'ae' COLLATE latin1_german2_ci |
+-----------------------------------------+
|                                       0 |
+-----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT 'ä' = 'ae' COLLATE latin1_german2_ci;</code></strong>
+--------------------------------------+
| 'ä' = 'ae' COLLATE latin1_german2_ci |
+--------------------------------------+
|                                    1 |
+--------------------------------------+
</pre><a class="indexterm" name="idm46041623117808"></a><p>
            特に、末尾のスペースは常に意味を持ちます。 これは、非バイナリ文字列 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code> および <code class="literal">TEXT</code> 値) の末尾のスペースの意味が比較に使用される照合のパッド属性に依存する <code class="literal">=</code> 演算子で実行される比較とは異なります。 詳細は、<a class="xref" href="charset.html#charset-binary-collations-trailing-space-comparisons" title="比較での後続領域の処理">比較での後続領域の処理</a>を参照してください。 
          </p><p>
            <code class="literal">LIKE</code> では、パターンに次の 2 つのワイルドカード文字を使用できます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">%</code> は、ゼロ文字を含め、任意の数の文字に一致します。
              </p></li><li class="listitem"><p>
                <code class="literal">_</code>は、単一の文字と完全に一致します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David_';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE '%D%v%';</code></strong>
        -&gt; 1
</pre><p>
            ワイルドカード文字のリテラルインスタンスをテストするには、その前にエスケープ文字を指定します。 <code class="literal">ESCAPE</code> 文字を指定しない場合は、<code class="literal">\</code> と仮定されます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">\%</code> は、いずれかの <code class="literal">%</code> 文字と一致します。
              </p></li><li class="listitem"><p>
                <code class="literal">\_</code>は、いずれかの<code class="literal">_</code>文字と一致します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David\_';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David\_';</code></strong>
        -&gt; 1
</pre><p>
            別のエスケープ文字を指定するには、<code class="literal">ESCAPE</code> 句を使用します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David|_' ESCAPE '|';</code></strong>
        -&gt; 1
</pre><p>
            エスケープシーケンスは空にするか、1 文字の長さにするようにしてください。 実行時に、式は定数として評価される必要があります。 <code class="literal">NO_BACKSLASH_ESCAPES</code> SQL モードが有効になっている場合は、シーケンスを空にできません。 
          </p><p>
            次の 2 つのステートメントは、オペランドのいずれかが大文字と小文字を区別しないかぎり、文字列の比較で大文字と小文字が区別されないことを示しています (大文字と小文字が区別される照合順序を使用するか、バイナリ文字列です):
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE 'ABC';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE _utf8mb4 'ABC' COLLATE utf8mb4_0900_as_cs;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE _utf8mb4 'ABC' COLLATE utf8mb4_bin;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE BINARY 'ABC';</code></strong>
        -&gt; 0
</pre><p>
            標準 SQL の拡張機能として、MySQL では数値式に対する <code class="literal">LIKE</code> が許可されます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 10 LIKE '1%';</code></strong>
        -&gt; 1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              MySQL では文字列で C エスケープ構文 (改行文字を表す<code class="literal">\n</code> など) が使用されるため、<code class="literal">LIKE</code> 文字列で使用する<code class="literal">\</code>をダブルクリックする必要があります。 たとえば、<code class="literal">\n</code> を検索するには、<code class="literal">\\n</code> と指定します。 <code class="literal">\</code>を検索するには、<code class="literal">\\\\</code>として指定します。これは、バックスラッシュがパーサーによって一度だけ取り除かれ、パターン一致が行われたときに再度取り除かれ、単一のバックスラッシュが照合対象のままになるためです。 
            </p><p>
              例外: パターン文字列の末尾では、バックスラッシュを <code class="literal">\\</code> と指定できます。 文字列の末尾では、エスケープの後ろに何もないため、バックスラッシュはそれ自体を表します。 テーブルに次の値が含まれると仮定します。 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT filename FROM t1;</code></strong>
+--------------+
| filename     |
+--------------+
| C:           |
| C:\          |
| C:\Programs  |
| C:\Programs\ |
+--------------+
</pre><p>
              バックスラッシュで終わる値をテストするには、次のパターンのいずれかを使用すると値をマッチングできます。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\' FROM t1;</code></strong>
+--------------+---------------------+
| filename     | filename LIKE '%\\' |
+--------------+---------------------+
| C:           |                   0 |
| C:\          |                   1 |
| C:\Programs  |                   0 |
| C:\Programs\ |                   1 |
+--------------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\\\' FROM t1;</code></strong>
+--------------+-----------------------+
| filename     | filename LIKE '%\\\\' |
+--------------+-----------------------+
| C:           |                     0 |
| C:\          |                     1 |
| C:\Programs  |                     0 |
| C:\Programs\ |                     1 |
+--------------+-----------------------+
</pre></div></li><li class="listitem"><a name="operator_not-like"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> NOT LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>']</code>
          </p><a class="indexterm" name="idm46041623060576"></a><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>'])</code> と同じです。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              <code class="literal">NULL</code> を含むカラムとの <code class="literal">NOT LIKE</code> 比較を伴う集計クエリーでは、予想外の結果が生成される可能性があります。 たとえば、次のテーブルとデータを検討してください。 
            </p><pre class="programlisting">CREATE TABLE foo (bar VARCHAR(10));

INSERT INTO foo VALUES (NULL), (NULL);
</pre><p>
              クエリー <code class="literal">SELECT COUNT(*) FROM foo WHERE bar LIKE '%baz%';</code> は <code class="literal">0</code> を返します。 <code class="literal">SELECT COUNT(*) FROM foo WHERE bar NOT LIKE '%baz%';</code> は <code class="literal">2</code> を返すと想定しています。 ただし、事実は異なります。2 番目のクエリーは <code class="literal">0</code> を返します。 これは、<em class="replaceable"><code>expr</code></em> の値に関係なく、<code class="literal">NULL NOT LIKE <em class="replaceable"><code>expr</code></em></code> は常に <code class="literal">NULL</code> を返すためです。 <code class="literal">NULL</code> を伴う集計クエリー、および <code class="literal">NOT RLIKE</code> または <code class="literal">NOT REGEXP</code> を使用する比較でも、同じことが当てはまります。 このような場合は、次に示すように、(<code class="literal">AND</code> ではなく) <code class="literal">OR</code> を使用して <code class="literal">NOT NULL</code> を明示的にテストする必要があります。 
            </p><pre class="programlisting">SELECT COUNT(*) FROM foo WHERE bar NOT LIKE '%baz%' OR bar IS NULL;
</pre></div></li><li class="listitem"><a name="function_strcmp"></a><p>
            <code class="literal">STRCMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
          </p><a class="indexterm" name="idm46041623032784"></a><p>
            <code class="literal">STRCMP()</code> は、文字列が同じ場合は <code class="literal">0</code> を返し、現在のソート順に従って 1 番目の引数が 2 番目よりも小さい場合は <code class="literal">-1</code>、それ以外の場合は <code class="literal">1</code> を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text2');</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text2', 'text');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text');</code></strong>
        -&gt; 0
</pre><p>
            <code class="literal">STRCMP()</code> は、引数の照合順序を使用して比較を実行します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s1 = _utf8mb4 'x' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s2 = _utf8mb4 'X' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s3 = _utf8mb4 'x' COLLATE utf8mb4_0900_as_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s4 = _utf8mb4 'X' COLLATE utf8mb4_0900_as_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s2), STRCMP(@s3, @s4);</code></strong>
+------------------+------------------+
| STRCMP(@s1, @s2) | STRCMP(@s3, @s4) |
+------------------+------------------+
|                0 |               -1 |
+------------------+------------------+
</pre><p>
            照合順序の互換性がない場合は、その他との互換性を保つために、引数のいずれかを変換する必要があります。 <a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4 式での照合の強制性">セクション10.8.4「式での照合の強制性」</a>を参照してください。 
          </p><pre class="programlisting">mysql&gt; SET @s1 = _utf8mb4 'x' COLLATE utf8mb4_0900_ai_ci;
mysql&gt; SET @s2 = _utf8mb4 'X' COLLATE utf8mb4_0900_ai_ci;
mysql&gt; SET @s3 = _utf8mb4 'x' COLLATE utf8mb4_0900_as_cs;
mysql&gt; SET @s4 = _utf8mb4 'X' COLLATE utf8mb4_0900_as_cs;
--&gt;
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3);</code></strong>
ERROR 1267 (HY000): Illegal mix of collations (utf8mb4_0900_ai_ci,IMPLICIT)
and (utf8mb4_0900_as_cs,IMPLICIT) for operation 'strcmp'
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3 COLLATE utf8mb4_0900_ai_ci);</code></strong>
+---------------------------------------------+
| STRCMP(@s1, @s3 COLLATE utf8mb4_0900_ai_ci) |
+---------------------------------------------+
|                                           0 |
+---------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="regexp"></a>12.8.2 正規表現</h3></div></div></div><a class="indexterm" name="idm46041623009792"></a><a class="indexterm" name="idm46041623008320"></a><a class="indexterm" name="idm46041623006944"></a><a class="indexterm" name="idm46041623005584"></a><div class="table"><a name="idm46041623003536"></a><p class="title"><b>表 12.14 「正規表現関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「正規表現の関数および演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      REGEXP の否定
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></td>
<td>
      正規表現に一致する部分文字列の開始インデックス
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></td>
<td>
      正規表現に一致する部分文字列の置換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></td>
<td>
      正規表現に一致する部分文字列を返します
    </td>
</tr><tr><td><code class="literal">RLIKE</code></td>
<td>
      文字列が正規表現と一致するかどうか
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        正規表現は、複雑な検索でパターンを指定する強力な方法です。 このセクションでは、正規表現の照合に使用できる関数と演算子について説明し、正規表現の操作に使用できる特殊文字と構造の一部を例とともに示します。 <a class="xref" href="tutorial.html#pattern-matching" title="3.3.4.7 パターンマッチング">セクション3.3.4.7「パターンマッチング」</a>も参照してください。 
      </p><p>
        MySQL では、Unicode の国際コンポーネント (ICU) を使用した正規表現サポートが実装されています。ICU は完全な Unicode サポートを提供し、マルチバイトセーフです。 (MySQL 8.0.4 より前では、MySQL は Henry Spencer による正規表現の実装を使用していました。これはバイト単位で動作し、マルチバイトセーフではありません。 正規表現を使用するアプリケーションが実装の変更の影響を受ける方法の詳細は、<a class="xref" href="functions.html#regexp-compatibility" title="正規表現の互換性に関する考慮事項">正規表現の互換性に関する考慮事項</a> を参照してください。) 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#regexp-operators" title="正規表現関数および演算子">正規表現関数および演算子</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-syntax" title="正規表現構文">正規表現構文</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-resource-control" title="正規表現のリソース制御">正規表現のリソース制御</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-compatibility" title="正規表現の互換性に関する考慮事項">正規表現の互換性に関する考慮事項</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="regexp-operators"></a>正規表現関数および演算子</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not-regexp"></a><p>
              <code class="literal"><em class="replaceable"><code>expr</code></em> NOT REGEXP <em class="replaceable"><code>pat</code></em></code>, <code class="literal"><em class="replaceable"><code>expr</code></em> NOT RLIKE <em class="replaceable"><code>pat</code></em></code>
            </p><a class="indexterm" name="idm46041622960752"></a><p>
              これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> REGEXP <em class="replaceable"><code>pat</code></em>)</code> と同じです。
            </p></li><li class="listitem"><a name="operator_regexp"></a><p>
              <code class="literal"><em class="replaceable"><code>expr</code></em> REGEXP <em class="replaceable"><code>pat</code></em></code>, <code class="literal"><em class="replaceable"><code>expr</code></em> RLIKE <em class="replaceable"><code>pat</code></em></code>
            </p><a class="indexterm" name="idm46041622949072"></a><a class="indexterm" name="idm46041622947728"></a><p>
              文字列 <em class="replaceable"><code>expr</code></em> がパターン <em class="replaceable"><code>pat</code></em> で指定された正規表現と一致する場合は 1 を返し、一致しない場合は 0 を返します。 <em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 
            </p><p>
              <code class="literal">REGEXP</code> および <code class="literal">RLIKE</code> は、<code class="literal">REGEXP_LIKE()</code> のシノニムです。
            </p><p>
              照合の実行方法の詳細は、<code class="literal">REGEXP_LIKE()</code> の説明を参照してください。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'Michael!' REGEXP '.*';</code></strong>
+------------------------+
| 'Michael!' REGEXP '.*' |
+------------------------+
|                      1 |
+------------------------+
mysql&gt; <strong class="userinput"><code>SELECT 'new*\n*line' REGEXP 'new\\*.\\*line';</code></strong>
+---------------------------------------+
| 'new*\n*line' REGEXP 'new\\*.\\*line' |
+---------------------------------------+
|                                     0 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP '^[a-d]';</code></strong>
+---------------------+
| 'a' REGEXP '^[a-d]' |
+---------------------+
|                   1 |
+---------------------+
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP 'A', 'a' REGEXP BINARY 'A';</code></strong>
+----------------+-----------------------+
| 'a' REGEXP 'A' | 'a' REGEXP BINARY 'A' |
+----------------+-----------------------+
|              1 |                     0 |
+----------------+-----------------------+
</pre></li><li class="listitem"><a name="function_regexp-instr"></a><p>
              <code class="literal">REGEXP_INSTR(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>pat</code></em>[, <em class="replaceable"><code>pos</code></em>[, <em class="replaceable"><code>occurrence</code></em>[, <em class="replaceable"><code>return_option</code></em>[, <em class="replaceable"><code>match_type</code></em>]]]])</code>
            </p><a class="indexterm" name="idm46041622923456"></a><p>
              パターン <em class="replaceable"><code>pat</code></em> で指定された正規表現に一致する文字列 <em class="replaceable"><code>expr</code></em> の部分文字列の開始インデックスを返します。一致がない場合は 0 を返します。 <em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 文字インデックスは 1 から始まります。 
            </p><p>
              <code class="literal">REGEXP_INSTR()</code> は、次のオプションの引数を取ります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: 検索を開始する <em class="replaceable"><code>expr</code></em> 内の位置。 省略した場合、デフォルトは 1 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: 検索する一致のオカレンス。 省略した場合、デフォルトは 1 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>return_option</code></em>: 返す位置のタイプ。 この値が 0 の場合、<code class="literal">REGEXP_INSTR()</code> は一致した部分文字列の最初の文字の位置を戻します。 この値が 1 の場合、<code class="literal">REGEXP_INSTR()</code> は一致した部分文字列の後の位置を戻します。 省略した場合、デフォルトは 0 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: 照合の実行方法を指定する文字列。 意味は、<code class="literal">REGEXP_LIKE()</code> で説明されているとおりです。 
                </p></li></ul></div><p>
              照合の実行方法の詳細は、<code class="literal">REGEXP_LIKE()</code> の説明を参照してください。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('dog cat dog', 'dog');</code></strong>
+------------------------------------+
| REGEXP_INSTR('dog cat dog', 'dog') |
+------------------------------------+
|                                  1 |
+------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('dog cat dog', 'dog', 2);</code></strong>
+---------------------------------------+
| REGEXP_INSTR('dog cat dog', 'dog', 2) |
+---------------------------------------+
|                                     9 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('aa aaa aaaa', 'a{2}');</code></strong>
+-------------------------------------+
| REGEXP_INSTR('aa aaa aaaa', 'a{2}') |
+-------------------------------------+
|                                   1 |
+-------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('aa aaa aaaa', 'a{4}');</code></strong>
+-------------------------------------+
| REGEXP_INSTR('aa aaa aaaa', 'a{4}') |
+-------------------------------------+
|                                   8 |
+-------------------------------------+
</pre></li><li class="listitem"><a name="function_regexp-like"></a><p>
              <code class="literal">REGEXP_LIKE(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>pat</code></em>[, <em class="replaceable"><code>match_type</code></em>])</code>
            </p><a class="indexterm" name="idm46041622892816"></a><p>
              文字列 <em class="replaceable"><code>expr</code></em> がパターン <em class="replaceable"><code>pat</code></em> で指定された正規表現と一致する場合は 1 を返し、一致しない場合は 0 を返します。 <em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 
            </p><p>
              パターンには、<a class="xref" href="functions.html#regexp-syntax" title="正規表現構文">正規表現構文</a> で説明されている構文である拡張正規表現を使用できます。 パターンはリテラル文字列である必要はありません。 たとえば、文字列式やテーブルカラムとして指定できます。 
            </p><p>
              オプションの <em class="replaceable"><code>match_type</code></em> 引数は、照合の実行方法を指定する次の文字の一部またはすべてを含むことができる文字列です:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">c</code>: 大文字小文字を区別する照合。
                </p></li><li class="listitem"><p>
                  <code class="literal">i</code>: 大文字小文字を区別しない照合。
                </p></li><li class="listitem"><p>
                  <code class="literal">m</code>: Multiple-line mode. 文字列内の行終了記号を認識します。 デフォルトの動作では、文字列式の先頭と末尾でのみ行終了記号が照合されます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">n</code>: <code class="literal">.</code> 文字は行終了記号と一致します。 デフォルトでは、<code class="literal">.</code> 照合は行の最後で停止します。 
                </p></li><li class="listitem"><p>
                  <code class="literal">u</code>: Unix 専用の行の終わり。 改行文字のみが、<code class="literal">.</code>、<code class="literal">^</code> および <code class="literal">$</code> の一致演算子で終わる行として認識されます。 
                </p></li></ul></div><p>
              矛盾するオプションを指定する文字が <em class="replaceable"><code>match_type</code></em> 内で指定されている場合は、右端の文字が優先されます。
            </p><p>
              デフォルトでは、正規表現操作は、文字のタイプを決定して比較を実行するときに、<em class="replaceable"><code>expr</code></em> および <em class="replaceable"><code>pat</code></em> 引数の文字セットと照合順序を使用します。 引数にさまざまな文字セットまたは照合順序が含まれる場合は、<a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4 式での照合の強制性">セクション10.8.4「式での照合の強制性」</a>で説明するとおりに、型変換属性ルールが適用されます。 引数は、比較動作を変更するために、明示的な照合インジケータとともに指定できます。 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('CamelCase', 'CAMELCASE');</code></strong>
+---------------------------------------+
| REGEXP_LIKE('CamelCase', 'CAMELCASE') |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('CamelCase', 'CAMELCASE' COLLATE utf8mb4_0900_as_cs);</code></strong>
+------------------------------------------------------------------+
| REGEXP_LIKE('CamelCase', 'CAMELCASE' COLLATE utf8mb4_0900_as_cs) |
+------------------------------------------------------------------+
|                                                                0 |
+------------------------------------------------------------------+
</pre><p>
              <em class="replaceable"><code>match_type</code></em> は、デフォルトの大/小文字の区別をオーバーライドするために、<code class="literal">c</code> または <code class="literal">i</code> 文字とともに指定できます。 例外: いずれかの引数がバイナリ文字列の場合、<em class="replaceable"><code>match_type</code></em> に <code class="literal">i</code> 文字が含まれていても、引数は大/小文字を区別してバイナリ文字列として処理されます。 
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
                MySQL では文字列で C エスケープ構文 (改行文字を表す<code class="literal">\n</code> など) が使用されるため、<em class="replaceable"><code>expr</code></em> および <em class="replaceable"><code>pat</code></em> 引数で使用する<code class="literal">\</code>をダブルクリックする必要があります。
              </p></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Michael!', '.*');</code></strong>
+-------------------------------+
| REGEXP_LIKE('Michael!', '.*') |
+-------------------------------+
|                             1 |
+-------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('new*\n*line', 'new\\*.\\*line');</code></strong>
+----------------------------------------------+
| REGEXP_LIKE('new*\n*line', 'new\\*.\\*line') |
+----------------------------------------------+
|                                            0 |
+----------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('a', '^[a-d]');</code></strong>
+----------------------------+
| REGEXP_LIKE('a', '^[a-d]') |
+----------------------------+
|                          1 |
+----------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('a', 'A'), REGEXP_LIKE('a', BINARY 'A');</code></strong>
+-----------------------+------------------------------+
| REGEXP_LIKE('a', 'A') | REGEXP_LIKE('a', BINARY 'A') |
+-----------------------+------------------------------+
|                     1 |                            0 |
+-----------------------+------------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abc', 'ABC');</code></strong>
+---------------------------+
| REGEXP_LIKE('abc', 'ABC') |
+---------------------------+
|                         1 |
+---------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abc', 'ABC', 'c');</code></strong>
+--------------------------------+
| REGEXP_LIKE('abc', 'ABC', 'c') |
+--------------------------------+
|                              0 |
+--------------------------------+
</pre></li><li class="listitem"><a name="function_regexp-replace"></a><p>
              <code class="literal">REGEXP_REPLACE(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>pat</code></em>, <em class="replaceable"><code>repl</code></em>[, <em class="replaceable"><code>pos</code></em>[, <em class="replaceable"><code>occurrence</code></em>[, <em class="replaceable"><code>match_type</code></em>]]])</code>
            </p><a class="indexterm" name="idm46041622841408"></a><p>
              パターン <em class="replaceable"><code>pat</code></em> で指定された正規表現に一致する文字列 <em class="replaceable"><code>expr</code></em> 内のオカレンスを置換文字列 <em class="replaceable"><code>repl</code></em> で置換し、結果の文字列を戻します。 <em class="replaceable"><code>expr</code></em>、<em class="replaceable"><code>pat</code></em> または <em class="replaceable"><code>repl</code></em> が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 
            </p><p>
              <code class="literal">REGEXP_REPLACE()</code> は、次のオプションの引数を取ります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: 検索を開始する <em class="replaceable"><code>expr</code></em> 内の位置。 省略した場合、デフォルトは 1 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: 置換する一致のオカレンス。 省略した場合、デフォルトは 0 (<span class="quote">「<span class="quote">「すべて置換」</span>」</span>を意味します) です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: 照合の実行方法を指定する文字列。 意味は、<code class="literal">REGEXP_LIKE()</code> で説明されているとおりです。 
                </p></li></ul></div><p>
              MySQL 8.0.17 より前は、この関数によって戻された結果で <code class="literal">UTF-16</code> 文字セットが使用されていました。MySQL 8.0.17 以降では、一致を検索した式の文字セットおよび照合順序が使用されます。 (Bug #94203、Bug #29308212) 
            </p><p>
              照合の実行方法の詳細は、<code class="literal">REGEXP_LIKE()</code> の説明を参照してください。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_REPLACE('a b c', 'b', 'X');</code></strong>
+-----------------------------------+
| REGEXP_REPLACE('a b c', 'b', 'X') |
+-----------------------------------+
| a X c                             |
+-----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_REPLACE('abc def ghi', '[a-z]+', 'X', 1, 3);</code></strong>
+----------------------------------------------------+
| REGEXP_REPLACE('abc def ghi', '[a-z]+', 'X', 1, 3) |
+----------------------------------------------------+
| abc def X                                          |
+----------------------------------------------------+
</pre></li><li class="listitem"><a name="function_regexp-substr"></a><p>
              <code class="literal">REGEXP_SUBSTR(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>pat</code></em>[, <em class="replaceable"><code>pos</code></em>[, <em class="replaceable"><code>occurrence</code></em>[, <em class="replaceable"><code>match_type</code></em>]]])</code>
            </p><a class="indexterm" name="idm46041622813056"></a><p>
              一致がない場合は、<em class="replaceable"><code>pat</code></em>、<code class="literal">NULL</code> パターンで指定された正規表現に一致する文字列 <em class="replaceable"><code>expr</code></em> の部分文字列を返します。 <em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 
            </p><p>
              <code class="literal">REGEXP_SUBSTR()</code> は、次のオプションの引数を取ります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: 検索を開始する <em class="replaceable"><code>expr</code></em> 内の位置。 省略した場合、デフォルトは 1 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: 検索する一致のオカレンス。 省略した場合、デフォルトは 1 です。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: 照合の実行方法を指定する文字列。 意味は、<code class="literal">REGEXP_LIKE()</code> で説明されているとおりです。 
                </p></li></ul></div><p>
              MySQL 8.0.17 より前は、この関数によって戻された結果で <code class="literal">UTF-16</code> 文字セットが使用されていました。MySQL 8.0.17 以降では、一致を検索した式の文字セットおよび照合順序が使用されます。 (Bug #94203、Bug #29308212) 
            </p><p>
              照合の実行方法の詳細は、<code class="literal">REGEXP_LIKE()</code> の説明を参照してください。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('abc def ghi', '[a-z]+');</code></strong>
+----------------------------------------+
| REGEXP_SUBSTR('abc def ghi', '[a-z]+') |
+----------------------------------------+
| abc                                    |
+----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('abc def ghi', '[a-z]+', 1, 3);</code></strong>
+----------------------------------------------+
| REGEXP_SUBSTR('abc def ghi', '[a-z]+', 1, 3) |
+----------------------------------------------+
| ghi                                          |
+----------------------------------------------+
</pre></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="regexp-syntax"></a>正規表現構文</h4></div></div></div><p>
          正規表現では、文字列のセットが記述されます。 もっとも単純な正規表現は、特殊文字を使用していないものです。 たとえば、正規表現 <code class="literal">hello</code> は <code class="literal">hello</code> にのみ一致します。 
        </p><p>
          重要な正規表現では、複数の文字列に一致できるように特定の特殊構造が使用されます。 たとえば、正規表現 <code class="literal">hello|world</code> には<code class="literal">|</code>代替演算子が含まれ、<code class="literal">hello</code> または <code class="literal">world</code> のいずれかと一致します。 
        </p><p>
          さらに複雑な例として、正規表現 <code class="literal">B[an]*s</code> は、文字列 <code class="literal">Bananas</code>、<code class="literal">Baaaaas</code>、<code class="literal">Bs</code> のいずれか、および <code class="literal">B</code> で始まり、<code class="literal">s</code> で終わり、その間に任意の数字の <code class="literal">a</code> または <code class="literal">n</code> 文字が含まれるその他の文字列に一致します。
        </p><p>
          次のリストは、正規表現で使用できる基本的な特殊文字と構造体の一部を示しています。 正規表現サポートの実装に使用される ICU ライブラリでサポートされる完全な正規表現構文の詳細は、<a class="ulink" href="http://userguide.icu-project.org/strings/regexp" target="_top">「Unicode web サイトの国際コンポーネント」</a>を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">^</code>
            </p><p>
              文字列の先頭に一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\nfo', '^fo$');</code></strong>                   -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fofo', '^fo');</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">$</code>
            </p><p>
              文字列の末尾に一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\no', '^fo\no$');</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\no', '^fo$');</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">.</code>
            </p><p>
              任意の文字に一致します (キャリッジリターンおよび改行を含むが、文字列の途中でこれらを一致させるには、<code class="literal">m</code> (複数行) の一致制御文字または <code class="literal">(?m)</code> のパターン内修飾子を指定する必要があります)。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fofo', '^f.*$');</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '^f.*$');</code></strong>                -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '^f.*$', 'm');</code></strong>           -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '(?m)^f.*$');</code></strong>           -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">a*</code>
            </p><p>
              ゼロ個以上の <code class="literal">a</code> 文字のシーケンスに一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba*n');</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Baaan', '^Ba*n');</code></strong>                   -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba*n');</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">a+</code>
            </p><p>
              1 個以上の <code class="literal">a</code> 文字のシーケンスに一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba+n');</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba+n');</code></strong>                      -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">a?</code>
            </p><p>
              ゼロまたは 1 個の <code class="literal">a</code> 文字に一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba?n');</code></strong>                      -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba?n');</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Baan', '^Ba?n');</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">de|abc</code>
            </p><p>
              代替。順序 <code class="literal">de</code> または <code class="literal">abc</code> のいずれかに一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', 'pi|apa');</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('axe', 'pi|apa');</code></strong>                    -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('apa', 'pi|apa');</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('apa', '^(pi|apa)$');</code></strong>                -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', '^(pi|apa)$');</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pix', '^(pi|apa)$');</code></strong>                -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">(abc)*</code>
            </p><p>
              シーケンス <code class="literal">abc</code> のゼロ個以上のインスタンスに一致します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', '^(pi)*$');</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pip', '^(pi)*$');</code></strong>                   -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pipi', '^(pi)*$');</code></strong>                  -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">{1}</code>, <code class="literal">{2,3}</code>
            </p><p>
              繰返し: <code class="literal">{<em class="replaceable"><code>n</code></em>}</code> および <code class="literal">{<em class="replaceable"><code>m</code></em>,<em class="replaceable"><code>n</code></em>}</code> 表記法では、パターンの以前の原子 (または<span class="quote">「<span class="quote">「ピース」</span>」</span>) の多くの出現に一致する正規表現を記述するより一般的な方法が提供されます。<em class="replaceable"><code>m</code></em> および <em class="replaceable"><code>n</code></em> は整数です。
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">a*</code>
                </p><p>
                  <code class="literal">a{0,}</code> と記述できます。
                </p></li><li class="listitem"><p>
                  <code class="literal">a+</code>
                </p><p>
                  <code class="literal">a{1,}</code> と記述できます。
                </p></li><li class="listitem"><p>
                  <code class="literal">a?</code>
                </p><p>
                  <code class="literal">a{0,1}</code> と記述できます。
                </p></li></ul></div><p>
              より正確にするために、<code class="literal">a{<em class="replaceable"><code>n</code></em>}</code> は <code class="literal">a</code> の <em class="replaceable"><code>n</code></em> インスタンスと完全に一致します。<code class="literal">a{ <em class="replaceable"><code>n</code></em>,}</code> は、<code class="literal">a</code> の <em class="replaceable"><code>n</code></em> 以上のインスタンスと一致します。<code class="literal">a{<em class="replaceable"><code>m</code></em>, <em class="replaceable"><code>n</code></em> }</code> は、<code class="literal">a</code> の <em class="replaceable"><code>n</code></em> インスタンス (これを含む) を介して <em class="replaceable"><code>m</code></em> を照合します。 <em class="replaceable"><code>m</code></em> および <em class="replaceable"><code>n</code></em> の両方が指定されている場合は、<em class="replaceable"><code>m</code></em> を <em class="replaceable"><code>n</code></em> 以下にする必要があります。 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{2}e');</code></strong>              -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{3}e');</code></strong>              -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{1,10}e');</code></strong>           -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">[a-dX]</code>, <code class="literal">[^a-dX]</code>
            </p><p>
              <code class="literal">a</code>, <code class="literal">b</code>, <code class="literal">c</code>, <code class="literal">d</code> または <code class="literal">X</code> のいずれかである (または <code class="literal">^</code> が使用されている場合はそうでない) 任意の文字に一致します。 2 つの文字の間の <code class="literal">-</code> 文字によって、1 番目の文字から 2 番目の文字までのすべての文字に一致する範囲が形成されます。 たとえば、<code class="literal">[0-9]</code> は任意の 10 進数に一致します。 リテラル文字 <code class="literal">]</code> を含めるには、左括弧 <code class="literal">[</code> の直後に記述する必要があります。 リテラル文字 <code class="literal">-</code> を含めるには、先頭または末尾に記述する必要があります。 <code class="literal">[]</code> ペアの内側に定義された特殊な意味を持たない文字は、それ自体としか一致しません。 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '[a-dXYZ]');</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[a-dXYZ]$');</code></strong>               -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[a-dXYZ]+$');</code></strong>              -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[^a-dXYZ]+$');</code></strong>             -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('gheis', '^[^a-dXYZ]+$');</code></strong>            -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('gheisa', '^[^a-dXYZ]+$');</code></strong>           -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">[=character_class=]</code>
            </p><p>
              (<code class="literal">[</code> と <code class="literal">]</code> 使用して記述された) 括弧式内の <code class="literal">[=character_class=]</code> は、等価クラスを表します。 これは、同じ照合順序値を持つすべての文字 (それ自体を含む) に一致します。 たとえば、<code class="literal">o</code> および <code class="literal">(+)</code> が等価クラスのメンバーである場合、<code class="literal">[[=o=]]</code>、<code class="literal">[[=(+)=]]</code>、および <code class="literal">[o(+)]</code> はすべてシノニムです。 等価クラスは、範囲の終点として使用できない場合もあります。 
            </p></li><li class="listitem"><p>
              <code class="literal">[:character_class:]</code>
            </p><p>
              (<code class="literal">[</code> と <code class="literal">]</code> を使用して記述された)括弧式内の <code class="literal">[:character_class:]</code> は、そのクラスに属するすべての文字と一致する文字クラスを表します。 次の表には、標準のクラス名を一覧表示します。 これらの名前は、<code class="literal">ctype(3)</code> のマニュアルページで定義されている文字クラスを表しています。 特定のロケールでは、ほかのクラス名が提供される場合もあります。 文字クラスは、範囲の終点として使用できない場合もあります。 
            </p><div class="informaltable"><table summary="Character class names and the meaning of each class."><col style="width: 20%"><col style="width: 80%"><thead><tr>
                  <th>文字クラス名</th>
                  <th>意味</th>
                </tr></thead><tbody><tr>
                  <td><code class="literal">alnum</code></td>
                  <td>英数文字</td>
                </tr><tr>
                  <td><code class="literal">alpha</code></td>
                  <td>アルファベット文字</td>
                </tr><tr>
                  <td><code class="literal">blank</code></td>
                  <td>空白文字</td>
                </tr><tr>
                  <td><code class="literal">cntrl</code></td>
                  <td>制御文字</td>
                </tr><tr>
                  <td><code class="literal">digit</code></td>
                  <td>数字文字</td>
                </tr><tr>
                  <td><code class="literal">graph</code></td>
                  <td>図形文字</td>
                </tr><tr>
                  <td><code class="literal">lower</code></td>
                  <td>小文字アルファベット文字</td>
                </tr><tr>
                  <td><code class="literal">print</code></td>
                  <td>図形または空白文字</td>
                </tr><tr>
                  <td><code class="literal">punct</code></td>
                  <td>句読点文字</td>
                </tr><tr>
                  <td><code class="literal">space</code></td>
                  <td>空白、タブ、改行、および復帰改行</td>
                </tr><tr>
                  <td><code class="literal">upper</code></td>
                  <td>大文字アルファベット文字</td>
                </tr><tr>
                  <td><code class="literal">xdigit</code></td>
                  <td>16 進数文字</td>
                </tr></tbody></table></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('justalnums', '[[:alnum:]]+');</code></strong>       -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('!!', '[[:alnum:]]+');</code></strong>               -&gt; 0
</pre></li></ul></div><p>
          正規表現で特殊文字のリテラルインスタンスを使用するには、前に 2 つのバックスラッシュ (\) 文字を付けます。 MySQL パーサーが 2 つのバックスラッシュの一方を解釈し、正規表現ライブラリがもう一方を解釈します。 たとえば、特殊文字 <code class="literal">+</code> を含む文字列 <code class="literal">1+2</code> に一致する正規表現は、次のうちで最後のものだけです。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1+2');</code></strong>                       -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1\+2');</code></strong>                      -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1\\+2');</code></strong>                     -&gt; 1
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="regexp-resource-control"></a>正規表現のリソース制御</h4></div></div></div><p>
          <code class="literal">REGEXP_LIKE()</code> および同様の関数は、システム変数を設定することで制御できるリソースを使用します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              照合エンジンは、内部スタックにメモリーを使用します。 スタックで使用可能な最大メモリーをバイト単位で制御するには、<code class="literal">regexp_stack_limit</code> システム変数を設定します。 
            </p></li><li class="listitem"><p>
              照合エンジンはステップで動作します。 エンジンによって実行されるステップの最大数 (つまり、間接的に実行時間) を制御するには、<code class="literal">regexp_time_limit</code> システム変数を設定します。 この制限はステップ数で表されるため、実行時間には間接的にのみ影響します。 通常はミリ秒の順序で表示されます。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="regexp-compatibility"></a>正規表現の互換性に関する考慮事項</h4></div></div></div><p>
          MySQL 8.0.4 より前は、MySQL は、International Components for Unicode (ICU) ではなく Henry Spencer 正規表現ライブラリを使用して正規表現操作をサポートしていました。 次の説明では、アプリケーションに影響を与える可能性のある Spencer ライブラリと ICU ライブラリの違いについて説明します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Spencer ライブラリでは、<code class="literal">REGEXP</code> および <code class="literal">RLIKE</code> 演算子はバイト単位で動作するため、マルチバイトセーフではなく、マルチバイト文字セットで予期しない結果が発生する可能性があります。 さらに、これらの演算子ではそのバイト値に基づいて文字が比較されるため、アクセント記号付き文字は、指定された照合順序では等しいとみなされた場合でも、等しいとして比較されない可能性があります。 
            </p><p>
              ICU では Unicode が完全にサポートされており、マルチバイトセーフです。 その正規表現関数は、すべての文字列を <code class="literal">UTF-16</code> として扱います。 位置インデックスは、コードポイントではなく 16 ビットチャンクに基づいていることに注意してください。 つまり、このような関数に渡された場合、複数のチャンクを使用する文字は、次に示すような予期しない結果を生成する可能性があります: 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('🍣🍣b', 'b');</code></strong>
+--------------------------+
| REGEXP_INSTR('??b', 'b') |
+--------------------------+
|                        5 |
+--------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('🍣🍣bxxx', 'b', 4);</code></strong>
+--------------------------------+
| REGEXP_INSTR('??bxxx', 'b', 4) |
+--------------------------------+
|                              5 |
+--------------------------------+
1 row in set (0.00 sec)
</pre><p>
              ほとんどの最新言語で使用される文字を含む Unicode Basic Multilingual Plane 内の文字は、次の点で安全です:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('бжb', 'b');</code></strong>
+----------------------------+
| REGEXP_INSTR('бжb', 'b')   |
+----------------------------+
|                          3 |
+----------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('עבb', 'b');</code></strong>
+----------------------------+
| REGEXP_INSTR('עבb', 'b')   |
+----------------------------+
|                          3 |
+----------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('µå周çб', '周');</code></strong>
+------------------------------------+
| REGEXP_INSTR('µå周çб', '周')       |
+------------------------------------+
|                                  3 |
+------------------------------------+
1 row in set (0.00 sec)
</pre><p>
              最初の 2 つの例で使用されている<span class="quote">「<span class="quote">「寿司」</span>」</span>文字 (U+1F363) などの絵文字は、基本多言語プレーンではなく Unicode 補助多言語プレーンに含まれています。 <code class="literal">REGEXP_SUBSTR()</code> または同様の関数が文字の途中で検索を開始すると、emoji およびその他の 4 バイト文字で別の問題が発生する可能性があります。 次の例の 2 つのステートメントはそれぞれ、最初の引数の 2 バイト目の位置から始まります。 最初のステートメントは、2 バイト (BMP) 文字のみで構成される文字列に対して機能します。 2 番目のステートメントには 4 バイトの文字が含まれており、最初の 2 バイトが取り除かれ、残りの文字データが正しく配置されていないため、結果で正しく解釈されません。 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('周周周周', '.*', 2);</code></strong>
+----------------------------------------+
| REGEXP_SUBSTR('周周周周', '.*', 2)     |
+----------------------------------------+
| 周周周                                 |
+----------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('🍣🍣🍣🍣', '.*', 2);</code></strong>
+--------------------------------+
| REGEXP_SUBSTR('????', '.*', 2) |
+--------------------------------+
| ?㳟揘㳟揘㳟揘                  |
+--------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
              <code class="literal">.</code> 演算子の場合、Spencer ライブラリは、文字列式の任意の場所 (中央を含む) の行終了文字 (キャリッジリターン、改行) と一致します。 文字列の途中にある行末文字を ICU と照合するには、<code class="literal">m</code> の一致制御文字を指定します。 
            </p></li><li class="listitem"><p>
              Spencer ライブラリは、ワードスタート境界マーカーとワードエンド境界マーカー (<code class="literal">[[:&lt;:]]</code>および<code class="literal">[[:&gt;:]]</code>表記法) をサポートしています。 ICU はそうではありません。 ICU の場合、<code class="literal">\b</code> を使用して単語境界を照合できます。MySQL では文字列内のエスケープ文字として解釈されるため、バックスラッシュをダブルクリックします。 
            </p></li><li class="listitem"><p>
              Spencer ライブラリは、照合要素ブラケット式 (<code class="literal">[.characters.]</code>表記法) をサポートしています。 ICU はそうではありません。 
            </p></li><li class="listitem"><p>
              繰返し回数 (<code class="literal">{n}</code> および <code class="literal">{m,n}</code> 表記) の場合、Spencer ライブラリの最大数は 255 です。 ICU にはこのような制限はありませんが、照合エンジンステップの最大数は <code class="literal">regexp_time_limit</code> システム変数を設定することで制限できます。 
            </p></li><li class="listitem"><p>
              ICU はカッコをメタ文字として解釈します。 リテラルの左カッコまたは右カッコ <code class="literal">(</code>を正規表現で指定するには、エスケープする必要があります: 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('(', '(');</code></strong>
ERROR 3692 (HY000): Mismatched parenthesis in regular expression.
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('(', '\\(');</code></strong>
+-------------------------+
| REGEXP_LIKE('(', '\\(') |
+-------------------------+
|                       1 |
+-------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE(')', ')');</code></strong>
ERROR 3692 (HY000): Mismatched parenthesis in regular expression.
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE(')', '\\)');</code></strong>
+-------------------------+
| REGEXP_LIKE(')', '\\)') |
+-------------------------+
|                       1 |
+-------------------------+
</pre></li><li class="listitem"><p>
              ICU は大カッコもメタ文字として解釈しますが、リテラル文字として使用するには、左大カッコのみをエスケープする必要があります:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('[', '[');</code></strong>
ERROR 3696 (HY000): The regular expression contains an
unclosed bracket expression.
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('[', '\\[');</code></strong>
+-------------------------+
| REGEXP_LIKE('[', '\\[') |
+-------------------------+
|                       1 |
+-------------------------+
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE(']', ']');</code></strong>
+-----------------------+
| REGEXP_LIKE(']', ']') |
+-----------------------+
|                     1 |
+-----------------------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="string-functions-charset"></a>12.8.3 関数結果の文字セットと照合順序</h3></div></div></div><p>
        MySQL には、文字列を返す多数の演算子と関数があります。 このセクションでは、そのような文字列の文字セットと照合順序について説明します。 
      </p><p>
        文字列の入力を取得して文字列の結果を出力として返す単純な関数では、出力の文字セットおよび照合順序は、主要な入力値の文字セットおよび照合順序と同じです。 たとえば、<code class="literal">UPPER(<em class="replaceable"><code>X</code></em>)</code> は、<em class="replaceable"><code>X</code></em> と同じ文字列および照合順序を持つ文字列を返します。 同じことは、<code class="literal">INSTR()</code>、<code class="literal">LCASE()</code>、<code class="literal">LOWER()</code>、<code class="literal">LTRIM()</code>、<code class="literal">MID()</code>、<code class="literal">REPEAT()</code>、<code class="literal">REPLACE()</code>、<code class="literal">REVERSE()</code>、<code class="literal">RIGHT()</code>、<code class="literal">RPAD()</code>、<code class="literal">RTRIM()</code>、<code class="literal">SOUNDEX()</code>、<code class="literal">SUBSTRING()</code>、<code class="literal">TRIM()</code>、<code class="literal">UCASE()</code>、および <code class="literal">UPPER()</code> についても当てはまります。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          <code class="literal">REPLACE()</code> 関数は、他のすべての関数とは異なり、常に文字列入力の照合を無視し、大/小文字を区別する比較を実行します。
        </p></div><p>
        文字列入力または関数結果がバイナリ文字列の場合、文字列は <code class="literal">binary</code> 文字セットおよび照合順序を持ちます。 これは、<code class="literal">CHARSET()</code> および <code class="literal">COLLATION()</code> 関数を使用してチェックできます。どちらの関数もバイナリ文字列引数に <code class="literal">binary</code> を返します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET(BINARY 'a'), COLLATION(BINARY 'a');</code></strong>
+---------------------+-----------------------+
| CHARSET(BINARY 'a') | COLLATION(BINARY 'a') |
+---------------------+-----------------------+
| binary              | binary                |
+---------------------+-----------------------+
</pre><p>
        複数の文字列入力を組み合わせて単一の文字列出力を返す演算では、結果の照合順序の特定に次の標準 SQL の<span class="quote">「<span class="quote">アグリゲーションルール</span>」</span>が適用されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            明示的な <code class="literal">COLLATE <em class="replaceable"><code>Y</code></em></code> が発生した場合は、<em class="replaceable"><code>Y</code></em> を使用します。
          </p></li><li class="listitem"><p>
            明示的な <code class="literal">COLLATE <em class="replaceable"><code>Y</code></em></code> および <code class="literal">COLLATE <em class="replaceable"><code>Z</code></em></code> が発生した場合は、エラーが発生します。
          </p></li><li class="listitem"><p>
            それ以外の場合、すべての照合順序が <em class="replaceable"><code>Y</code></em> であれば、<em class="replaceable"><code>Y</code></em> を使用します。
          </p></li><li class="listitem"><p>
            その他の場合、結果に照合順序はありません。
          </p></li></ul></div><p>
        たとえば、<code class="literal">CASE ... WHEN a THEN b WHEN b THEN c COLLATE <em class="replaceable"><code>X</code></em> END</code> と指定されている場合、結果の照合順序は <em class="replaceable"><code>X</code></em> になります。 同じことは、<code class="literal">UNION</code>、<code class="literal">||</code>、<code class="literal">CONCAT()</code>、<code class="literal">ELT()</code>、<code class="literal">GREATEST()</code>、<code class="literal">IF()</code>、および <code class="literal">LEAST()</code> にも当てはまります。 
      </p><p>
        文字データに変換する操作の場合、操作によって生成される文字列の文字セットと照合順序は、デフォルトの接続文字セットと照合順序を決定する <code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数によって定義されます (<a class="xref" href="charset.html#charset-connection" title="10.4 接続文字セットおよび照合順序">セクション10.4「接続文字セットおよび照合順序」</a> を参照)。 これは、<code class="literal">BIN_TO_UUID()</code>, <code class="literal">CAST()</code>, <code class="literal">CONV()</code>, <code class="literal">FORMAT()</code>, <code class="literal">HEX()</code> および <code class="literal">SPACE()</code> にのみ適用されます。 
      </p><p>
        仮想生成カラムの式では、前述の原則の例外が発生します。 このような式では、接続文字セットに関係なく、テーブルの文字セットが <code class="literal">BIN_TO_UUID()</code>、<code class="literal">CONV()</code> または <code class="literal">HEX()</code> の結果に使用されます。 
      </p><p>
        文字列関数によって返される結果の文字セットまたは照合順序に関する質問がある場合は、<code class="literal">CHARSET()</code> または <code class="literal">COLLATION()</code> 関数を使用して次を確認してください:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT USER(), CHARSET(USER()), COLLATION(USER());</code></strong>
+----------------+-----------------+-------------------+
| USER()         | CHARSET(USER()) | COLLATION(USER()) |
+----------------+-----------------+-------------------+
| test@localhost | utf8            | utf8_general_ci   |
+----------------+-----------------+-------------------+
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(COMPRESS('abc')), COLLATION(COMPRESS('abc'));</code></strong>
+--------------------------+----------------------------+
| CHARSET(COMPRESS('abc')) | COLLATION(COMPRESS('abc')) |
+--------------------------+----------------------------+
| binary                   | binary                     |
+--------------------------+----------------------------+
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-calendar"></a>12.9 MySQL で使用されるカレンダー</h2></div></div></div><a class="indexterm" name="idm46041622498080"></a><p>
      MySQL では、<span class="firstterm">先発グレゴリオ暦</span>と呼ばれるものが使用されています。
    </p><p>
      ユリウス暦からグレゴリオ暦に切り替えた国はすべて、切り替え時に少なくとも 10 日間を破棄する必要がありました。 この動作を確認するために、最初にユリウス暦からグレゴリオ暦への切り替えが発生した 1582 年 10 月を考えてください。 
    </p><div class="informaltable"><table summary="The month of October 1582, when the first Julian-to-Gregorian switch occurred. Table headings are days of the week and table rows list the dates for each day of the week. The table is intended to illustrate that there are no dates between October 4 and October 15."><col style="width: 14%"><col style="width: 14%"><col style="width: 14%"><col style="width: 14%"><col style="width: 14%"><col style="width: 14%"><col style="width: 14%"><thead><tr>
          <th scope="col">月曜日</th>
          <th scope="col">火曜日</th>
          <th scope="col">水曜日</th>
          <th scope="col">木曜日</th>
          <th scope="col">金曜日</th>
          <th scope="col">土曜日</th>
          <th scope="col">日曜日</th>
        </tr></thead><tbody><tr>
          <th scope="row">1</th>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>15</td>
          <td>16</td>
          <td>17</td>
        </tr><tr>
          <th scope="row">18</th>
          <td>19</td>
          <td>20</td>
          <td>21</td>
          <td>22</td>
          <td>23</td>
          <td>24</td>
        </tr><tr>
          <th scope="row">25</th>
          <td>26</td>
          <td>27</td>
          <td>28</td>
          <td>29</td>
          <td>30</td>
          <td>31</td>
        </tr></tbody></table></div><p>
      10 月 4 日から 10 月 15 日の間には日付がありません。 この不連続性は<span class="firstterm">カットオーバー</span>と呼ばれます。 カットオーバー前の日付はユリウス暦で、カットオーバー後の日付はグレゴリオ暦です。 カットオーバー中の日付は存在しません。 
    </p><p>
      実際に使用されていなかった日付に適用されるカレンダーは、<span class="firstterm">先発</span>と呼ばれます。 したがって、カットオーバーが発生せず、常にグレゴリオ暦のルールで制御されていると考えられる場合は、先発グレゴリオ暦が使用されています。 これが MySQL で使用されるものであり、標準 SQL でも必須です。 そのため、MySQL <code class="literal">DATE</code> または <code class="literal">DATETIME</code> 値として格納されたカットオーバー前の日付は、その違いが補正されるように調整する必要があります。 すべての国で同時にカットオーバーが発生しなかったこと、および発生が遅くなるほど失われる日数も多かったことに気付くことが重要です。 たとえば、イギリスでは 1752 年に発生し、9 月 2 日水曜日の翌日が 9 月 14 日木曜日になりました。 ロシアでは 1918 年までユリウス暦のままでしたが、その過程で 13 日間が失われました。<span class="quote">「<span class="quote">10 月革命</span>」</span>として知られる有名な事件は、グレゴリオ暦に従うと 11 月に発生しました。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fulltext-search"></a>12.10 全文検索関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#fulltext-natural-language">12.10.1 自然言語全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean">12.10.2 ブール全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion">12.10.3 クエリー拡張を使用した全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords">12.10.4 全文ストップワード</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions">12.10.5 全文制限</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning">12.10.6 MySQL の全文検索の微調整</a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation">12.10.7 全文インデックス付けのためのユーザー定義照合の追加</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-ngram">12.10.8 ngram 全文パーサー</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-mecab">12.10.9 MeCab フルテキストパーサープラグイン</a></span></dt></dl></div><a class="indexterm" name="idm46041622450272"></a><a class="indexterm" name="idm46041622448240"></a><a class="indexterm" name="idm46041622446768"></a><a class="indexterm" name="idm46041622445792"></a><p><a name="function_match"></a>
      <code class="literal">MATCH (<em class="replaceable"><code>col1</code></em>,<em class="replaceable"><code>col2</code></em>,...) AGAINST (<em class="replaceable"><code>expr</code></em> [<em class="replaceable"><code>search_modifier</code></em>])</code>
    </p><pre class="programlisting"><em class="replaceable"><code>search_modifier:</code></em>
  {
       IN NATURAL LANGUAGE MODE
     | IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION
     | IN BOOLEAN MODE
     | WITH QUERY EXPANSION
  }
</pre><p>
      MySQL では、次のような全文インデックス設定および検索がサポートされています。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          MySQL の全文インデックスは、型 <code class="literal">FULLTEXT</code> のインデックスです。
        </p></li><li class="listitem"><p>
          全文インデックスは、<code class="literal">InnoDB</code> または <code class="literal">MyISAM</code> テーブルでのみ使用でき、<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、または <code class="literal">TEXT</code> カラムにのみ作成できます。
        </p></li><li class="listitem"><p>
          MySQL には、中国語、日本語および韓国語 (CJK) をサポートする組込みの全文 ngram パーサーと、日本語用のインストール可能な MeCab 全文パーサープラグインが用意されています。 解析の相違点については、<a class="xref" href="functions.html#fulltext-search-ngram" title="12.10.8 ngram 全文パーサー">セクション12.10.8「ngram 全文パーサー」</a> と <a class="xref" href="functions.html#fulltext-search-mecab" title="12.10.9 MeCab フルテキストパーサープラグイン">セクション12.10.9「MeCab フルテキストパーサープラグイン」</a> で概説します。 
        </p></li><li class="listitem"><p>
          <code class="literal">FULLTEXT</code> インデックスの定義は、テーブルの作成時に <code class="literal">CREATE TABLE</code> ステートメントで指定することも、あとで <code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> を使用して追加することもできます。
        </p></li><li class="listitem"><p>
          データセットが大きい場合は、<code class="literal">FULLTEXT</code> インデックスが付いていないテーブルにロードしてから、そのあとでインデックスを作成した方が、既存の<code class="literal">FULLTEXT</code> インデックスが付いているテーブルにロードするよりも断然速いです。
        </p></li></ul></div><p>
      全文検索は、<code class="literal">MATCH() ... AGAINST</code> 構文を使用して実行されます。 <code class="literal">MATCH()</code> には、検索対象のカラム名をカンマで区切ったリストを指定します。 <code class="literal">AGAINST</code> には、検索する文字列と、実行する検索のタイプを示すオプションの修飾子を指定します。 検索文字列は、クエリー評価時に定数である文字列値にする必要があります。 たとえば、テーブルカラムは、行ごとに異なる可能性があるため除外されます。 
    </p><p>
      全文検索には、次の 3 つの種類があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          自然言語の検索では、検索文字列が人間の自然な言語でのフレーズ (フリーテキストのフレーズ) として解釈されます。 二重引用符 (") 文字を除き、特殊演算子はありません。 ストップワードリストが適用されます。 ストップワードリストの詳細は、<a class="xref" href="functions.html#fulltext-stopwords" title="12.10.4 全文ストップワード">セクション12.10.4「全文ストップワード」</a> を参照してください。 
        </p><p>
          <code class="literal">IN NATURAL LANGUAGE MODE</code> 修飾子が指定されている場合または修飾子がまったく指定されていない場合は、全文検索が自然言語検索になります。 詳細は、<a class="xref" href="functions.html#fulltext-natural-language" title="12.10.1 自然言語全文検索">セクション12.10.1「自然言語全文検索」</a>を参照してください。 
        </p></li><li class="listitem"><p>
          ブール検索では、特別なクエリー言語のルールを使用して検索文字列が解釈されます。 文字列には、検索対象の単語が含まれます。 また、一致する行に単語が存在しなければならない、または存在してはならないように、あるいは通常よりも単語の重みが高くまたは低くなるように、要件を指定する演算子を含めることもできます。 特定の共通単語 (ストップワード) は、検索インデックスから省略され、検索文字列に存在しない場合は一致が行われません。 <code class="literal">IN BOOLEAN MODE</code> 修飾子は、ブール検索を指定します。 詳細は、<a class="xref" href="functions.html#fulltext-boolean" title="12.10.2 ブール全文検索">セクション12.10.2「ブール全文検索」</a>を参照してください。 
        </p></li><li class="listitem"><p>
          クエリー拡張検索は、自然言語検索を改善したものです。 自然言語検索を実行する際は、検索文字列が使用されます。 その後、検索で返されたもっとも関連性の高い行からの単語が検索文字列に追加され、再度検索が実行されます。 クエリーでは、2 回目の検索からの行が返されます。 <code class="literal">IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION</code> または <code class="literal">WITH QUERY EXPANSION</code> 修飾子は、クエリー拡張検索を指定します。 詳細は、<a class="xref" href="functions.html#fulltext-query-expansion" title="12.10.3 クエリー拡張を使用した全文検索">セクション12.10.3「クエリー拡張を使用した全文検索」</a>を参照してください。 
        </p></li></ul></div><p>
      <code class="literal">FULLTEXT</code> クエリーのパフォーマンスについては、<a class="xref" href="optimization.html#column-indexes" title="8.3.5 カラムインデックス">セクション8.3.5「カラムインデックス」</a>を参照してください。
    </p><p>
      <code class="literal">InnoDB</code> <code class="literal">FULLTEXT</code> インデックスの詳細は、<a class="xref" href="innodb-storage-engine.html#innodb-fulltext-index" title="15.6.2.4 InnoDB FULLTEXT インデックス">セクション15.6.2.4「InnoDB FULLTEXT インデックス」</a> を参照してください。
    </p><p>
      全文検索上の制約については、<a class="xref" href="functions.html#fulltext-restrictions" title="12.10.5 全文制限">セクション12.10.5「全文制限」</a>に一覧表示されています。
    </p><p>
      <span class="command"><strong>myisam_ftdump</strong></span> ユーティリティーは、<code class="literal">MyISAM</code> 全文インデックスの内容をダンプします。 これは、全文クエリーのデバッグ時に役立つことがあります。 <a class="xref" href="programs.html#myisam-ftdump" title="4.6.3 myisam_ftdump — 全文インデックス情報の表示">セクション4.6.3「myisam_ftdump — 全文インデックス情報の表示」</a>を参照してください。 
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-natural-language"></a>12.10.1 自然言語全文検索</h3></div></div></div><p>
        デフォルトの場合や <code class="literal">IN NATURAL LANGUAGE MODE</code> 修飾子が指定された場合は、<code class="literal">MATCH()</code> 関数は、<span class="firstterm">テキストコレクション</span>に対して文字列の自然言語検索を実行します。 コレクションは、<code class="literal">FULLTEXT</code> インデックスに含まれる 1 つ以上のカラムのセットです。 検索文字列は、<code class="literal">AGAINST()</code> への引数として指定されます。 <code class="literal">MATCH()</code> は、テーブルの行ごとに関連性の値を返します。つまり、検索文字列と、<code class="literal">MATCH()</code> リストで名前が指定されたカラムの該当行のテキスト間で類似性が評価されます。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE articles (</code></strong>
          <strong class="userinput"><code>id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
          <strong class="userinput"><code>title VARCHAR(200),</code></strong>
          <strong class="userinput"><code>body TEXT,</code></strong>
          <strong class="userinput"><code>FULLTEXT (title,body)</code></strong>
        <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong>
Query OK, 0 rows affected (0.08 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO articles (title,body) VALUES</code></strong>
        <strong class="userinput"><code>('MySQL Tutorial','DBMS stands for DataBase ...'),</code></strong>
        <strong class="userinput"><code>('How To Use MySQL Well','After you went through a ...'),</code></strong>
        <strong class="userinput"><code>('Optimizing MySQL','In this tutorial, we show ...'),</code></strong>
        <strong class="userinput"><code>('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),</code></strong>
        <strong class="userinput"><code>('MySQL vs. YourSQL','In the following database comparison ...'),</code></strong>
        <strong class="userinput"><code>('MySQL Security','When configured properly, MySQL ...');</code></strong>
Query OK, 6 rows affected (0.01 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
        <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
        <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)
</pre><p>
        デフォルトでは、大文字と小文字が区別される方法で検索が実行されます。 大/小文字を区別する全文検索を実行するには、インデックス付けされたカラムに大/小文字を区別する照合またはバイナリ照合を使用します。 たとえば、の <code class="literal">utf8mb4</code> 文字セットを使用するカラムには、<code class="literal">utf8mb4_0900_as_cs</code> または <code class="literal">utf8mb4_bin</code> の照合順序を割り当てて、全文検索で大文字と小文字を区別できます。 
      </p><p>
        以前に例で示したように、<code class="literal">MATCH()</code> が <code class="literal">WHERE</code> 句で使用されると、もっとも関連性の高い行が 1 番目に返されるように、自動的にソートされます。 関連性の値は、負ではない浮動小数点数です。 ゼロの関連性は、類似性がないという意味です。 関連性は、行 (ドキュメント) 内の単語の数、行内の一意の単語の数、コレクション内の単語の合計数および特定の単語を含む行の数に基づいて計算されます。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          <span class="quote">「<span class="quote">document</span>」</span> という用語は、<span class="quote">「<span class="quote">row</span>」</span> という用語と同じ意味で使用でき、どちらの用語も行のインデックス付けされた部分を指します。 <span class="quote">「<span class="quote">collection</span>」</span> という用語は、インデックス付けされたカラムを指し、すべての行を含みます。 
        </p></div><p>
        単に一致をカウントするには、次のようなクエリーを使用してください。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----------+
| COUNT(*) |
+----------+
|        2 |
+----------+
1 row in set (0.00 sec)
</pre><p>
        次のように、クエリーを再作成した方が早い場合もあります。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    <strong class="userinput"><code>COUNT(IF(MATCH (title,body) AGAINST ('database' IN NATURAL LANGUAGE MODE), 1, NULL))</code></strong>
    <strong class="userinput"><code>AS count</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong>
+-------+
| count |
+-------+
|     2 |
+-------+
1 row in set (0.03 sec)
</pre><p>
        1 つ目のクエリーでは、いくつかの追加作業 (関連性別の結果のソート) が実行されますが、<code class="literal">WHERE</code> 句に基づくインデックス検索を使用することもできます。 インデックス検索では、検索でほとんど行が一致しない場合に、最初のクエリーが速くなる可能性があります。 2 つ目のクエリーではテーブルの完全スキャンが実行され、ほとんどの行に検索語句が存在した場合に、インデックス検索よりも高速になる可能性があります。 
      </p><p>
        自然言語による全文検索では、<code class="literal">MATCH()</code> 関数で名前が指定されたカラムは、テーブル内の一部の <code class="literal">FULLTEXT</code> インデックスに含まれるカラムと同じである必要があります。 前述のクエリーでは、<code class="literal">MATCH()</code> 関数 (<code class="literal">title</code> および <code class="literal">body</code>) で指定されたカラムは、<code class="literal">article</code> テーブル <code class="literal">FULLTEXT</code> インデックスの定義で指定されたカラムと同じであることに注意してください。 <code class="literal">title</code> または <code class="literal">body</code> を個別に検索するには、カラムごとに個別の <code class="literal">FULLTEXT</code> インデックスを作成します。 
      </p><p>
        ブール検索やクエリー拡張を使用した検索を実行することもできます。 これらの検索タイプについては、<a class="xref" href="functions.html#fulltext-boolean" title="12.10.2 ブール全文検索">セクション12.10.2「ブール全文検索」</a>および<a class="xref" href="functions.html#fulltext-query-expansion" title="12.10.3 クエリー拡張を使用した全文検索">セクション12.10.3「クエリー拡張を使用した全文検索」</a>で説明されています。 
      </p><p>
        インデックスを使用した全文検索では、インデックスが複数のテーブルに及ぶ可能性はないため、<code class="literal">MATCH()</code> 句の単一テーブルにあるカラムにしか名前を付けることができません。 <code class="literal">MyISAM</code> テーブルでは、インデックスが存在しない場合でも、ブール検索を実行できます (ただし、低速になります)。この場合、複数のテーブルのカラムに名前を指定できます。 
      </p><p>
        上記の例では、関連性の降順で行が返される <code class="literal">MATCH()</code> 関数の使用方法について簡単に説明しました。 次の例では、関連性の値を明示的に取得する方法を示します。 <code class="literal">SELECT</code> ステートメントには <code class="literal">WHERE</code> 句も <code class="literal">ORDER BY</code> 句も含まれていないため、返される行は順序付けられません。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT id, MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('Tutorial' IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong>
+----+---------------------+
| id | score               |
+----+---------------------+
|  1 | 0.22764469683170319 |
|  2 |                   0 |
|  3 | 0.22764469683170319 |
|  4 |                   0 |
|  5 |                   0 |
|  6 |                   0 |
+----+---------------------+
6 rows in set (0.00 sec)
</pre><p>
        次の例はさらに複雑です。 このクエリーでは関連性の値が返され、関連性の降順での行のソートも行われます。 この結果を実現するには、<code class="literal">MATCH()</code> を 2 回 (1 回は <code class="literal">SELECT</code> リストに、もう 1 回は <code class="literal">WHERE</code> 句に) 指定します。 MySQL オプティマイザによって、2 回の <code class="literal">MATCH()</code> 呼び出しが同じであり、全文検索コードが 1 回のみ起動されることが検出されるため、追加のオーバーヘッドは発生しません。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT id, body, MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles WHERE MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------------------------+-----------------+
| id | body                                | score           |
+----+-------------------------------------+-----------------+
|  4 | 1. Never run mysqld as root. 2. ... | 1.5219271183014 |
|  6 | When configured properly, MySQL ... | 1.3114095926285 |
+----+-------------------------------------+-----------------+
2 rows in set (0.00 sec)
</pre><p>
        二重引用符 (<code class="literal">"</code>) 文字内で囲まれたフレーズは、<span class="emphasis"><em>入力されたそのままの</em></span>フレーズを含む行にのみ一致します。 全文エンジンでは、フレーズが複数の単語に分割され、それらの単語の <code class="literal">FULLTEXT</code> インデックス内で検索が実行されます。 単語以外の文字は、正確に一致する必要がありません。フレーズ検索では、そのフレーズとまったく同じ単語が同じ順序で一致に含まれることのみが必要です。 たとえば、<code class="literal">"test phrase"</code> は <code class="literal">"test, phrase"</code> と一致します。 フレーズにインデックス内にある単語が含まれない場合は、結果が空になります。 たとえば、すべての単語がストップワードであるか、インデックス付けされた単語の最小長より短い場合、結果は空になります。 
      </p><p>
        MySQL <code class="literal">FULLTEXT</code> の実装では、トゥルーワード文字 (文字、数字、およびアンダースコア) のシーケンスが単語とみなされます。 そのシーケンスには、アポストロフィー (<code class="literal">'</code>) も含めることはできますが、1 行に 1 つまでです。 つまり、<code class="literal">aaa'bbb</code> は 1 語とみなされますが、<code class="literal">aaa''bbb</code> は 2 語とみなされます。 単語の先頭または末尾のアポストロフィーは、<code class="literal">FULLTEXT</code> パーサーによって削除されます。<code class="literal">'aaa'bbb'</code> は、<code class="literal">aaa'bbb</code> として解析されます。 
      </p><p>
        組込み <code class="literal">FULLTEXT</code> パーサーは、<code class="literal"> </code> (空白)、<code class="literal">,</code> (カンマ)、<code class="literal">.</code> (ピリオド) などの特定のデリミタ文字を検索して、単語の開始位置と終了位置を決定します。 単語がデリミタで区切られていない場合 (中国語など)、組込み <code class="literal">FULLTEXT</code> パーサーは単語の開始位置または終了位置を判別できません。 組込み <code class="literal">FULLTEXT</code> パーサーを使用する <code class="literal">FULLTEXT</code> インデックスに、このような言語の単語またはインデックス付けされた他の用語を追加できるようにするには、それらが任意のデリミタで区切られるように事前処理する必要があります。 または、ngram パーサープラグイン (中国語、日本語または韓国語) または MeCab パーサープラグイン (日本語) を使用して、<code class="literal">FULLTEXT</code> インデックスを作成できます。 
      </p><p>
        組み込みの全文パーサーを置き換えるプラグインを記述できます。 詳細は、<a class="ulink" href="https://dev.mysql.com/doc/extending-mysql/8.0/en/plugin-api.html" target="_top">The MySQL Plugin API</a>を参照してください。 パーサープラグインのサンプルソースコードについては、MySQL のソース配布の <code class="filename">plugin/fulltext</code> ディレクトリを参照してください。 
      </p><p>
        全文検索では、一部の単語が無視されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            短すぎる単語は無視されます。 全文検索で見つかった単語のデフォルトの最小長は、<code class="literal">InnoDB</code> 検索インデックスの場合は 3 文字、<code class="literal">MyISAM</code> の場合は 4 文字です。 インデックスを作成する前に、構成オプション (<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_min_token_size</code> 構成オプション、<code class="literal">MyISAM</code> の場合は <code class="literal">ft_min_word_len</code>) を設定すると、カットオフを制御できます。 
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              この動作は、ngram パーサーを使用する <code class="literal">FULLTEXT</code> インデックスには適用されません。 ngram パーサーの場合、トークンの長さは <code class="literal">ngram_token_size</code> オプションによって定義されます。 
            </p></div></li><li class="listitem"><p>
            ストップワードリスト内の単語は無視されます。 ストップワードは、セマンティクス値がゼロであると考えられるほど一般的な単語 (<span class="quote">「<span class="quote">the</span>」</span> や <span class="quote">「<span class="quote">some</span>」</span> など) です。 組み込みのストップワードリストもありますが、ユーザー定義のリストでオーバーライドできます。 ストップワードリストおよび関連する構成オプションは、<code class="literal">InnoDB</code> 検索インデックスと <code class="literal">MyISAM</code> 検索インデックスとで異なります。 ストップワードの処理は、<code class="literal">InnoDB</code> 検索インデックスの場合は構成オプション <code class="literal">innodb_ft_enable_stopword</code>、<code class="literal">innodb_ft_server_stopword_table</code>、および <code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_stopword_file</code> によって制御されます。 
          </p></li></ul></div><p>
        デフォルトのストップワードリストおよびそれを変更する方法を表示する方法については、<a class="xref" href="functions.html#fulltext-stopwords" title="12.10.4 全文ストップワード">セクション12.10.4「全文ストップワード」</a>を参照してください。 単語のデフォルト最小長は、<a class="xref" href="functions.html#fulltext-fine-tuning" title="12.10.6 MySQL の全文検索の微調整">セクション12.10.6「MySQL の全文検索の微調整」</a>で説明したように変更できます。 
      </p><p>
        コレクションおよびクエリー内のすべての正確な単語は、コレクションまたはクエリーでの重要性に従って重み付けられます。 したがって、多くのドキュメント内に存在する単語では、この特定のコレクション内のセマンティクス値が低くなるため、重みも低くなります。 反対に、まれな単語には、高い重みが付けられます。 単語の重みを組み合わせることで、行の関連性が計算されます。 この技術は、大きなコレクションで最適に機能します。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">MyISAM の制限</div><p>
          非常に小さなテーブルでは、単語の配布が適切にセマンティクス値に反映されないため、このモデルでは、<code class="literal">MyISAM</code> テーブル上の検索インデックスに対して異常な結果が生成される可能性があります。 たとえば、以前に示した <code class="literal">articles</code> テーブルのすべての行には、<span class="quote">「<span class="quote">MySQL</span>」</span> という単語が存在しますが、<code class="literal">MyISAM</code> 検索インデックス内の単語を検索しても結果が生成されません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('MySQL' IN NATURAL LANGUAGE MODE);</code></strong>
Empty set (0.00 sec)
</pre><p>
          <span class="quote">「<span class="quote">MySQL</span>」</span> という単語は 50% 以上の行に存在するため、検索の結果が空になります。そのため、事実上ストップワードとして処理されます。 このフィルタ処理技術は、よくある語句に対して不適切な結果が生成される可能性のある小さなデータセットよりも、1G バイトのテーブルから 1 行おきに結果セットが返される可能性のない大きなデータセットに適しています。 
        </p><p>
          全文検索がどのように動作するかを確認するために最初に試すと、しきい値が 50% であることに驚くかもしれませんが、これによって <code class="literal">InnoDB</code> テーブルが全文検索での実験によりふさわしいことがわかります。 <code class="literal">MyISAM</code> テーブルを作成し、それに 1、2 行のテキストのみを挿入する場合は、テキスト内のすべての単語が 50% 以上の行に出現します。 その結果、テーブルにより多くの行が含まれるまで、検索の結果が返されません。 50% の制限を回避する必要のあるユーザーは、<code class="literal">InnoDB</code> テーブル上に検索インデックスを構築したり、<a class="xref" href="functions.html#fulltext-boolean" title="12.10.2 ブール全文検索">セクション12.10.2「ブール全文検索」</a>で説明したブール検索モードを使用したりできます。 
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-boolean"></a>12.10.2 ブール全文検索</h3></div></div></div><a class="indexterm" name="idm46041622258720"></a><a class="indexterm" name="idm46041622257264"></a><p>
        MySQL では、<code class="literal">IN BOOLEAN MODE</code> 修飾子を使用することでブール全文検索を実行できます。 この修飾子を使用すると、検索文字列の先頭または末尾にある特定の文字が特別な意味を持ちます。 次のクエリーでは、<code class="literal">+</code> および <code class="literal">-</code> 演算子は、一致が発生するために単語が存在しなければならないことと、単語が存在してはならないことをそれぞれ示します。 したがって、このクエリーでは、<span class="quote">「<span class="quote">MySQL</span>」</span> という単語は含まれるが、<span class="quote">「<span class="quote">YourSQL</span>」</span> という単語は<span class="emphasis"><em>含まれない</em></span>すべての行が取得されます。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM articles WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('+MySQL -YourSQL' IN BOOLEAN MODE);</code></strong>
+----+-----------------------+-------------------------------------+
| id | title                 | body                                |
+----+-----------------------+-------------------------------------+
|  1 | MySQL Tutorial        | DBMS stands for DataBase ...        |
|  2 | How To Use MySQL Well | After you went through a ...        |
|  3 | Optimizing MySQL      | In this tutorial, we show ...       |
|  4 | 1001 MySQL Tricks     | 1. Never run mysqld as root. 2. ... |
|  6 | MySQL Security        | When configured properly, MySQL ... |
+----+-----------------------+-------------------------------------+
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          この機能を実装すると、MySQL では<span class="firstterm">暗黙的ブール論理</span>とも呼ばれる次のようなものが使用されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">+</code> は <code class="literal">AND</code> を表します
            </p></li><li class="listitem"><p>
              <code class="literal">-</code> は <code class="literal">NOT</code> を表します
            </p></li><li class="listitem"><p>
              [<span class="emphasis"><em>演算子なし</em></span>] は暗黙的に <code class="literal">OR</code> を表します
            </p></li></ul></div></div><p>
        ブール全文検索には、次のような特徴があります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            行は自動的に関連性の降順にソートされません。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> テーブルでブールクエリーを実行するには、<code class="literal">MATCH()</code> 式のすべてのカラム上に <code class="literal">FULLTEXT</code> インデックスが必要です。 <code class="literal">MyISAM</code> 検索インデックスに対するブールクエリーは、<code class="literal">FULLTEXT</code> インデックスなしでも機能します。ただし、この方法で実行される検索の速度は、非常に遅くなります。 
          </p></li><li class="listitem"><p>
            単語の最小長および最大長の全文パラメータは、組込み <code class="literal">FULLTEXT</code> パーサーおよび MeCab パーサープラグインを使用して作成された <code class="literal">FULLTEXT</code> インデックスに適用されます。<code class="literal">innodb_ft_min_token_size</code> および <code class="literal">innodb_ft_max_token_size</code> は <code class="literal">InnoDB</code> 検索インデックスに使用されます。<code class="literal">ft_min_word_len</code> および <code class="literal">ft_max_word_len</code> は <code class="literal">MyISAM</code> 検索インデックスに使用されます。
          </p><p>
            単語の最小長および最大長の全文パラメータは、ngram パーサーを使用して作成された <code class="literal">FULLTEXT</code> インデックスには適用されません。ngram トークンサイズは、<code class="literal">ngram_token_size</code> オプションで定義されます。
          </p></li><li class="listitem"><p>
            ストップワードリストが適用されます。これらは、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_enable_stopword</code>、<code class="literal">innodb_ft_server_stopword_table</code>、および <code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_stopword_file</code> によって制御されます。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、<code class="literal">'++apple'</code> の例と同様に、単一の検索単語で複数の演算子を使用するようサポートされていません。 単一の検索語で複数の演算子を使用すると、標準出力に構文エラーが返されます。 MyISAM 全文検索では、同じ検索が正常に処理され、検索語に隣接する演算子を除くすべての演算子が無視されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、先頭のプラス記号またはマイナス記号のみがサポートされています。 たとえば、<code class="literal">InnoDB</code> では <code class="literal">'+apple'</code> がサポートされますが、<code class="literal">'apple+'</code> はサポートされていません。 末尾にプラス記号またはマイナス記号を指定すると、<code class="literal">InnoDB</code> で構文エラーがレポートされます。 
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、ワイルドカード (<code class="literal">'+*'</code>) を使用した先頭のプラス記号、プラス記号とマイナス記号の組み合わせ (<code class="literal">'+-'</code>)、または先頭のプラス記号とマイナス記号の組み合わせ (<code class="literal">'+-apple'</code>) はサポートされていません。 このような無効なクエリーでは、構文エラーが返されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> 全文検索では、ブール全文検索での<code class="literal">@</code>記号の使用はサポートされていません。 <code class="literal">@</code>記号は、<code class="literal">@distance</code> 近接検索演算子で使用するために予約されています。 
          </p></li><li class="listitem"><p>
            <code class="literal">MyISAM</code> 検索インデックスに適用される 50% のしきい値は使用されません。
          </p></li></ul></div><p>
        ブール全文検索機能では、次の演算子がサポートされています。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">+</code>
          </p><p>
            先頭または末尾のプラス記号は、この単語が返される各行に存在<span class="emphasis"><em>しなければならない</em></span>ことを示します。 <code class="literal">InnoDB</code> では、先頭のプラス記号のみがサポートされています。 
          </p></li><li class="listitem"><p>
            <code class="literal">-</code>
          </p><p>
            先頭または末尾のマイナス記号は、この単語が返される行のいずれにも存在<span class="emphasis"><em>してはならない</em></span>ことを示します。 <code class="literal">InnoDB</code> では、先頭のマイナス記号のみがサポートされています。 
          </p><p>
            注: <code class="literal">-</code> 演算子は、本来ならほかの検索語句で一致が行われる行を除外することのみに使用します。 したがって、<code class="literal">-</code> の前にある検索語句のみを含むブールモードの検索では、空の結果が返されます。 <span class="quote">「<span class="quote">除外された検索語句のいずれかを含む行を除いたすべての行</span>」</span>が返されるわけではありません。 
          </p></li><li class="listitem"><p>
            (演算子なし)
          </p><p>
            デフォルトでは (<code class="literal">+</code> と <code class="literal">-</code> のどちらも指定されてない場合)、この単語はオプションですが、それを含む行の評価は高くなります。 これは、<code class="literal">IN BOOLEAN MODE</code> 修飾子なしの <code class="literal">MATCH() ... AGAINST()</code> の動作と似ています。 
          </p></li><li class="listitem"><p>
            <code class="literal">@<em class="replaceable"><code>distance</code></em></code>
          </p><p>
            この演算子は、<code class="literal">InnoDB</code> テーブルでのみ機能します。 2 つ以上の単語がすべて、相互に指定された距離内で始まっているかどうかが単語単位でテストされます。 <code class="literal">@<em class="replaceable"><code>distance</code></em></code> 演算子の直前に、二重引用符で囲まれた文字列内の検索単語を指定します (たとえば、<code class="literal">MATCH(col1) AGAINST('"word1 word2 word3" @8' IN BOOLEAN MODE)</code>)。 
          </p></li><li class="listitem"><p>
            <code class="literal">&gt; &lt;</code>
          </p><p>
            これらの 2 つの演算子は、行に割り当てられた関連性の値への単語の貢献度を変更する際に使用されます。 <code class="literal">&gt;</code> 演算子は貢献度を上げ、<code class="literal">&lt;</code> 演算子は貢献度を下げます。 次のリストのあとに示す例を参照してください。 
          </p></li><li class="listitem"><p>
            <code class="literal">( )</code>
          </p><p>
            丸括弧は、単語を部分式にグループ化します。 丸括弧で囲まれたグループはネストできます。 
          </p></li><li class="listitem"><p>
            <code class="literal">~</code>
          </p><p>
            先頭のチルダは否定演算子として機能するため、行の関連性への単語の貢献度がマイナスになります。 これは、<span class="quote">「<span class="quote">ノイズ</span>」</span>単語にマークを付ける際に便利です。 このような単語を含む行は、その他よりも低く評価されますが、<code class="literal">-</code> 演算子を使用した場合のように、完全に除外されることはありません。 
          </p></li><li class="listitem"><p>
            <code class="literal">*</code>
          </p><p>
            アスタリスクは、切り捨て (またはワイルドカード) 演算子として機能します。 その他の演算子とは異なり、影響を受ける単語に<span class="emphasis"><em>追加</em></span>されます。 <code class="literal">*</code> 演算子の前の単語で始まれば、単語が一致します。 
          </p><p>
            切り捨て演算子を付けて単語が指定されている場合は、その単語が短すぎたり、ストップワードであったりしても、ブールクエリーから削除されません。 単語が短すぎるかどうかは、<code class="literal">InnoDB</code> テーブルの場合は <code class="literal">innodb_ft_min_token_size</code> 設定、<code class="literal">MyISAM</code> テーブルの場合は <code class="literal">ft_min_word_len</code> によって判断されます。 これらのオプションは、ngram パーサーを使用する <code class="literal">FULLTEXT</code> インデックスには適用されません。 
          </p><p>
            ワイルドカード単語は、1 つ以上の単語の先頭に存在しなければならないプリフィクスとみなされます。 単語の最小長が 4 である場合は、<code class="literal">'+<em class="replaceable"><code>word</code></em> +the*'</code> の検索では、2 番目のクエリーで短すぎる検索語句 <code class="literal">the</code> が無視されるため、<code class="literal">'+<em class="replaceable"><code>word</code></em> +the'</code> の検索よりも少ない行が返される可能性があります。 
          </p></li><li class="listitem"><p>
            <code class="literal">"</code>
          </p><p>
            二重引用符 (<code class="literal">"</code>) 文字内で囲まれたフレーズは、<span class="emphasis"><em>入力されたそのままの</em></span>フレーズを含む行にのみ一致します。 全文エンジンでは、フレーズが複数の単語に分割され、それらの単語の <code class="literal">FULLTEXT</code> インデックス内で検索が実行されます。 単語以外の文字は、正確に一致する必要がありません。フレーズ検索では、そのフレーズとまったく同じ単語が同じ順序で一致に含まれることのみが必要です。 たとえば、<code class="literal">"test phrase"</code> は <code class="literal">"test, phrase"</code> と一致します。 
          </p><p>
            フレーズにインデックス内にある単語が含まれない場合は、結果が空になります。 単語がテキスト内に存在しない場合、ストップワードである場合、またはインデックス付きの単語の最小長よりも短い場合の組み合わせが原因で、単語がインデックス内に存在しない可能性があります。 
          </p></li></ul></div><p>
        次の例では、ブール全文演算子を使用する一部の検索文字列を実演します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">'apple banana'</code>
          </p><p>
            2 つの単語の 1 つ以上を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple +juice'</code>
          </p><p>
            両方の単語を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含む行を検索しますが、行に <span class="quote">「<span class="quote">macintosh</span>」</span> も含まれる場合は行を高く評価されます。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple -macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含むが、<span class="quote">「<span class="quote">macintosh</span>」</span> は含まない行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple ~macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含む行を検索しますが、行に単語 <span class="quote">「<span class="quote">macintosh</span>」</span> も含まれる場合は、行に含まれない場合よりも低く評価されます。 これは、<span class="quote">「<span class="quote">macintosh</span>」</span> が存在すると、行がまったく返されない <code class="literal">'+apple -macintosh'</code> の検索よりも<span class="quote">「<span class="quote">ソフト</span>」</span>です。 
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple +(&gt;turnover &lt;strudel)'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> と <span class="quote">「<span class="quote">turnover</span>」</span>、または <span class="quote">「<span class="quote">apple</span>」</span> と <span class="quote">「<span class="quote">strudel</span>」</span> (順序は不問) を含む行を検索しますが、<span class="quote">「<span class="quote">apple turnover</span>」</span> を <span class="quote">「<span class="quote">apple strudel</span>」</span> よりも高く評価します。
          </p></li><li class="listitem"><p>
            <code class="literal">'apple*'</code>
          </p><p>
            <span class="quote">「<span class="quote">apple</span>」</span>、<span class="quote">「<span class="quote">apples</span>」</span>、<span class="quote">「<span class="quote">applesauce</span>」</span>、<span class="quote">「<span class="quote">applet</span>」</span> などの単語を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'"some words"'</code>
          </p><p>
            <span class="quote">「<span class="quote">some words</span>」</span> とまったく同じフレーズを含む行を検索します (たとえば、<span class="quote">「<span class="quote">some words of wisdom</span>」</span> を含む行は検索しますが、<span class="quote">「<span class="quote">some noise words</span>」</span> は検索しません)。 句を囲む<code class="literal">"</code>文字は、句を区切る演算子文字であることに注意してください。 検索文字列自体を囲む引用符ではありません。 
          </p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-boolean-innodb-relevancy-ranking"></a>InnoDB ブールモード検索の関連性ランキング</h4></div></div></div><p>
          <code class="literal">InnoDB</code> の全文検索は、<a class="ulink" href="http://sphinxsearch.com/" target="_top">Sphinx</a> の全文検索エンジンをモデルにし、使用されるアルゴリズムは、<a class="ulink" href="http://en.wikipedia.org/wiki/Okapi_BM25" target="_top">BM25</a> および <a class="ulink" href="http://en.wikipedia.org/wiki/TF-IDF" target="_top">TF-IDF</a> のランキングアルゴリズムに基づいています。 このような理由のため、<code class="literal">InnoDB</code> のブール全文検索の関連性ランキングは、<code class="literal">MyISAM</code> の関連性ランキングと異なる場合があります。 
        </p><p>
          <code class="literal">InnoDB</code> では、<span class="quote">「<span class="quote">term frequency-inverse document frequency</span>」</span> (<code class="literal">TF-IDF</code>) 重み付けシステムの偏差を使用して、指定された全文検索クエリーのドキュメントの関連性にランクが付けられます。 <code class="literal">TF-IDF</code> の重み付けは、ドキュメントで単語が出現する頻度に基づき、コレクション内のすべてのドキュメントで単語が出現する頻度によってオフセットされます。 言い換えると、ある単語がドキュメントで出現する頻度が高くなるほど、その単語がドキュメントコレクションで出現する頻度が低くなり、ドキュメントのランクが高くなります。 
        </p><h5><a name="idm46041622105616"></a>関連性ランキングの計算方法</h5><p>
          単語の出現頻度 (<code class="literal">TF</code>) 値は、単語がドキュメントで出現する回数です。 単語の逆文書頻度 (<code class="literal">IDF</code>) 値は、次の公式を使用して計算されます。ここで、<code class="literal">total_records</code> はコレクション内のレコード数、<code class="literal">matching_records</code> は検索語句が表示されるレコード数です。 
        </p><pre class="programlisting">${IDF} = log10( ${total_records} / ${matching_records} )  </pre><p>
          ドキュメントに単語が複数回含まれる場合は、IDF 値が TF 値で乗算されます。
        </p><pre class="programlisting">${TF} * ${IDF}</pre><p>
          <code class="literal">TF</code> および <code class="literal">IDF</code> 値を使用する場合は、ドキュメントの関連性ランキングが次の公式を使用して計算されます。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF}</pre><p>
          公式については、次の例で実演されています。
        </p><h5><a name="idm46041622094800"></a>単一単語検索の関連性ランキング</h5><p>
          この例では、単一単語検索の関連性ランキングの計算を実演します。
        </p><pre class="programlisting">mysql&gt; CREATE TABLE articles (
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
title VARCHAR(200),
body TEXT,
FULLTEXT (title,body)
) ENGINE=InnoDB;
Query OK, 0 rows affected (1.04 sec)

mysql&gt; INSERT INTO articles (title,body) VALUES
('MySQL Tutorial','This database tutorial ...'),
("How To Use MySQL",'After you went through a ...'),
('Optimizing Your Database','In this database tutorial ...'),
('MySQL vs. YourSQL','When comparing databases ...'),
('MySQL Security','When configured properly, MySQL ...'),
('Database, Database, Database','database database database'),
('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),
('MySQL Full-Text Indexes', 'MySQL fulltext indexes use a ..');
Query OK, 8 rows affected (0.06 sec)
Records: 8  Duplicates: 0  Warnings: 0

mysql&gt; SELECT id, title, body, MATCH (title,body)  AGAINST ('database' IN BOOLEAN MODE)
AS score FROM articles ORDER BY score DESC;
+----+------------------------------+-------------------------------------+---------------------+
| id | title                        | body                                | score               |
+----+------------------------------+-------------------------------------+---------------------+
|  6 | Database, Database, Database | database database database          |  1.0886961221694946 |
|  3 | Optimizing Your Database     | In this database tutorial ...       | 0.36289870738983154 |
|  1 | MySQL Tutorial               | This database tutorial ...          | 0.18144935369491577 |
|  2 | How To Use MySQL             | After you went through a ...        |                   0 |
|  4 | MySQL vs. YourSQL            | When comparing databases ...        |                   0 |
|  5 | MySQL Security               | When configured properly, MySQL ... |                   0 |
|  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... |                   0 |
|  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     |                   0 |
+----+------------------------------+-------------------------------------+---------------------+
8 rows in set (0.00 sec)</pre><p>
          合計で 8 つのレコードがあり、そのうち 3 つが <span class="quote">「<span class="quote">database</span>」</span> という検索語句に一致します。 1 つ目のレコード (<code class="literal">id 6</code>) には、検索語句が 6 回含まれ、関連性ランキングは <code class="literal">1.0886961221694946</code> です。 このランキング値は、6 の <code class="literal">TF</code> 値 (レコード <code class="literal">id 6</code> には <span class="quote">「<span class="quote">database</span>」</span> という検索語句が 6 回出現します)、および次のように計算される 0.42596873216370745 の <code class="literal">IDF</code> 値 (ここで、8 はレコードの合計数、3 は検索語句が出現するレコードの数) を使用して計算されます。 
        </p><pre class="programlisting">${IDF} = log10( 8 / 3 ) = 0.42596873216370745</pre><p>
          その後、<code class="literal">TF</code> および <code class="literal">IDF</code> 値はランキング公式に入力されます。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF}</pre><p>
          MySQL コマンド行クライアントで計算を実行すると、1.088696164686938 のランキング値が返されます。
        </p><pre class="programlisting">mysql&gt; SELECT 6*log10(8/3)*log10(8/3);
+-------------------------+
| 6*log10(8/3)*log10(8/3) |
+-------------------------+
|       1.088696164686938 |
+-------------------------+
1 row in set (0.00 sec)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">SELECT ... MATCH ... AGAINST</code> ステートメントと MySQL コマンド行クライアントで返されるランキング値 (<code class="literal">1.0886961221694946</code> と <code class="literal">1.088696164686938</code>) に、わずかな相違がある場合があります。 この相違は、整数と浮動小数点/倍精度間のキャストが (関連する精度および丸めの決定とともに) <code class="literal">InnoDB</code> によって内部で実行される方法、およびその他の場所 (MySQL コマンド行クライアントやその他のタイプの計算機など) で実行される方法が原因で発生します。 
          </p></div><h5><a name="idm46041622069488"></a>複数単語検索の関連性ランキング</h5><p>
          この例では、以前の例で使用された <code class="literal">articles</code> テーブルおよびデータに基づいて、複数単語の全文検索の関連性ランキングの計算を実演します。
        </p><p>
          複数の単語で検索する場合は、次の公式に示すように、関連性ランキングの値が各単語の関連性ランキングの合計になります。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF} + ${TF} * ${IDF} * ${IDF}</pre><p>
          2 つの語句 ('mysql tutorial') で検索を実行すると、次の結果が返されます。
        </p><pre class="programlisting">mysql&gt; SELECT id, title, body, MATCH (title,body)  AGAINST ('mysql tutorial' IN BOOLEAN MODE)
    AS score FROM articles ORDER BY score DESC;
+----+------------------------------+-------------------------------------+----------------------+
| id | title                        | body                                | score                |
+----+------------------------------+-------------------------------------+----------------------+
|  1 | MySQL Tutorial               | This database tutorial ...          |   0.7405621409416199 |
|  3 | Optimizing Your Database     | In this database tutorial ...       |   0.3624762296676636 |
|  5 | MySQL Security               | When configured properly, MySQL ... | 0.031219376251101494 |
|  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     | 0.031219376251101494 |
|  2 | How To Use MySQL             | After you went through a ...        | 0.015609688125550747 |
|  4 | MySQL vs. YourSQL            | When comparing databases ...        | 0.015609688125550747 |
|  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... | 0.015609688125550747 |
|  6 | Database, Database, Database | database database database          |                    0 |
+----+------------------------------+-------------------------------------+----------------------+
8 rows in set (0.00 sec)</pre><p>
          1 つ目のレコード (<code class="literal">id 8</code>) では、'mysql' が 1 回出現し、'tutorial' が 2 回出現します。 'mysql' に一致するレコードは 6 つ、'tutorial' に一致するレコードは 2 つあります。 MySQL コマンド行クライアントでは、これらの値を複数単語検索のランキング公式に挿入するときに、予期されるランキング値が返されます。 
        </p><pre class="programlisting">mysql&gt; SELECT (1*log10(8/6)*log10(8/6)) + (2*log10(8/2)*log10(8/2));
+-------------------------------------------------------+
| (1*log10(8/6)*log10(8/6)) + (2*log10(8/2)*log10(8/2)) |
+-------------------------------------------------------+
|                                    0.7405621541938003 |
+-------------------------------------------------------+
1 row in set (0.00 sec)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            上記の例では、<code class="literal">SELECT ... MATCH ... AGAINST</code> ステートメントと MySQL コマンド行クライアントで返されるランキング値に、わずかな相違があることについて説明しました。
          </p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-query-expansion"></a>12.10.3 クエリー拡張を使用した全文検索</h3></div></div></div><a class="indexterm" name="idm46041622054368"></a><a class="indexterm" name="idm46041622052944"></a><p>
        全文検索では、クエリー拡張 (特に、そのバリアントの <span class="quote">「<span class="quote">ブラインドクエリー拡張</span>」</span>) がサポートされています。 一般に、これは検索フレーズが短すぎるときに役立ちます。つまり、ユーザーは多くの場合暗黙的な知識に依存しますが、全文検索エンジンにはこれが不足していることを意味します。 たとえば、ユーザーが <span class="quote">「<span class="quote">database</span>」</span> を検索することは、実際は <span class="quote">「<span class="quote">MySQL</span>」</span>、<span class="quote">「<span class="quote">Oracle</span>」</span>、<span class="quote">「<span class="quote">DB2</span>」</span>、および <span class="quote">「<span class="quote">RDBMS</span>」</span> がすべて、<span class="quote">「<span class="quote">databases</span>」</span> に一致して返されるはずのフレーズであることを意味する場合があります。 これが暗黙的な知識です。 
      </p><p>
        ブラインドクエリー拡張 (自動関連性フィードバックとも呼ばれる) は、検索フレーズのあとに <code class="literal">WITH QUERY EXPANSION</code> または <code class="literal">IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION</code> を追加することで有効になります。 これは、検索を 2 回実行することで機能します。2 回目の検索での検索フレーズは、1 回目の検索でのもっとも関連性の高い数個のドキュメントと連結されたオリジナルの検索フレーズです。 したがって、これらのドキュメントのいずれかに単語 <span class="quote">「<span class="quote">databases</span>」</span> および単語 <span class="quote">「<span class="quote">MySQL</span>」</span> が含まれている場合は、単語 <span class="quote">「<span class="quote">database</span>」</span> が含まれていなくても、2 回目の検索で単語 <span class="quote">「<span class="quote">MySQL</span>」</span> を含むドキュメントが検索されます。 次の例では、この相違点を示します。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' WITH QUERY EXPANSION);</code></strong>
+----+-----------------------+------------------------------------------+
| id | title                 | body                                     |
+----+-----------------------+------------------------------------------+
|  5 | MySQL vs. YourSQL     | In the following database comparison ... |
|  1 | MySQL Tutorial        | DBMS stands for DataBase ...             |
|  3 | Optimizing MySQL      | In this tutorial we show ...             |
|  6 | MySQL Security        | When configured properly, MySQL ...      |
|  2 | How To Use MySQL Well | After you went through a ...             |
|  4 | 1001 MySQL Tricks     | 1. Never run mysqld as root. 2. ...      |
+----+-----------------------+------------------------------------------+
6 rows in set (0.00 sec)
</pre><p>
        もう 1 つの例では、ユーザーが <span class="quote">「<span class="quote">Maigret</span>」</span> のスペルに自信がないときに、Georges Simenon 著の Maigret に関する書籍を検索しています。 クエリー拡張を使用しなければ、<span class="quote">「<span class="quote">Megre and the reluctant witnesses</span>」</span> を検索しても <span class="quote">「<span class="quote">Maigret and the Reluctant Witnesses</span>」</span> のみが検索されます。 クエリー拡張を使用すれば、2 回目の検索で単語 <span class="quote">「<span class="quote">Maigret</span>」</span> を含むすべての書籍が検索されます。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          ブラインドクエリー拡張には、関連性のないドキュメントが返されるとノイズが大幅に増加する傾向があるため、検索フレーズが短すぎる場合にのみ使用してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-stopwords"></a>12.10.4 全文ストップワード</h3></div></div></div><a class="indexterm" name="idm46041622030464"></a><p>
        サーバー文字セットおよび照合順序 (<code class="literal">character_set_server</code> および <code class="literal">collation_server</code> システム変数の値) を使用すると、全文クエリー用のストップワードリストがロードおよび検索されます。 全文インデックス作成または検索で使用されるストップワードファイルまたはカラムに、<code class="literal">character_set_server</code> または <code class="literal">collation_server</code> とは異なる文字セットまたは照合順序が含まれている場合は、ストップワード検索で誤ったヒットまたはミスが発生する可能性があります。 
      </p><p>
        ストップワード検索で大文字と小文字が区別されるかどうかは、サーバー照合順序によって異なります。 たとえば、照合順序が <code class="literal">utf8mb4_0900_ai_ci</code> の場合、参照では大/小文字は区別されませんが、照合順序が <code class="literal">utf8mb4_0900_as_cs</code> または <code class="literal">utf8mb4_bin</code> の場合、参照では大/小文字が区別されます。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#fulltext-stopwords-stopwords-for-innodb-search-indexes" title="InnoDB 検索インデックスのストップワード">InnoDB 検索インデックスのストップワード</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-stopwords-stopwords-for-myisam-search-indexes" title="MyISAM 検索インデックスのストップワード">MyISAM 検索インデックスのストップワード</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-stopwords-stopwords-for-innodb-search-indexes"></a>InnoDB 検索インデックスのストップワード</h4></div></div></div><p>
          技術的、文学的、およびその他のソースからのドキュメントでは、キーワードとしてまたは重要なフレーズで短い単語が使用されることが多いため、<code class="literal">InnoDB</code> ではデフォルトのストップワードリストが比較的短くなります。 たとえば、<span class="quote">「<span class="quote">to be or not to be</span>」</span> を検索し、これらの単語がすべて無視されるのではなく、適切な結果が取得されることを期待するとします。 
        </p><p>
          デフォルトの <code class="literal">InnoDB</code> ストップワードリストを確認するには、<code class="literal">INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD</code> テーブルを問い合わせます。
        </p><pre class="programlisting">mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD;
+-------+
| value |
+-------+
| a     |
| about |
| an    |
| are   |
| as    |
| at    |
| be    |
| by    |
| com   |
| de    |
| en    |
| for   |
| from  |
| how   |
| i     |
| in    |
| is    |
| it    |
| la    |
| of    |
| on    |
| or    |
| that  |
| the   |
| this  |
| to    |
| was   |
| what  |
| when  |
| where |
| who   |
| will  |
| with  |
| und   |
| the   |
| www   |
+-------+
36 rows in set (0.00 sec)</pre><p>
          すべての <code class="literal">InnoDB</code> テーブルで独自のストップワードリストを定義するには、<code class="literal">INNODB_FT_DEFAULT_STOPWORD</code> テーブルと同じ構造を持つテーブルを定義し、それにストップワードを移入し、<code class="literal">innodb_ft_server_stopword_table</code> オプションの値を <code class="literal"><em class="replaceable"><code>db_name</code></em>/<em class="replaceable"><code>table_name</code></em></code> 形式の値に設定してから、全文インデックスを作成します。 ストップワードテーブルには、<code class="literal">value</code> という名前の単一の <code class="literal">VARCHAR</code> カラムが含まれている必要があります。 次の例では、<code class="literal">InnoDB</code> 用に新しいグローバルストップワードテーブルを作成および構成するよう実演します。 
        </p><pre class="programlisting">-- Create a new stopword table

mysql&gt; CREATE TABLE my_stopwords(value VARCHAR(30)) ENGINE = INNODB;
Query OK, 0 rows affected (0.01 sec)

-- Insert stopwords (for simplicity, a single stopword is used in this example)

mysql&gt; INSERT INTO my_stopwords(value) VALUES ('Ishmael');
Query OK, 1 row affected (0.00 sec)

-- Create the table

mysql&gt; CREATE TABLE opening_lines (
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
opening_line TEXT(500),
author VARCHAR(200),
title VARCHAR(200)
) ENGINE=InnoDB;
Query OK, 0 rows affected (0.01 sec)

-- Insert data into the table

mysql&gt; INSERT INTO opening_lines(opening_line,author,title) VALUES
('Call me Ishmael.','Herman Melville','Moby-Dick'),
('A screaming comes across the sky.','Thomas Pynchon','Gravity\'s Rainbow'),
('I am an invisible man.','Ralph Ellison','Invisible Man'),
('Where now? Who now? When now?','Samuel Beckett','The Unnamable'),
('It was love at first sight.','Joseph Heller','Catch-22'),
('All this happened, more or less.','Kurt Vonnegut','Slaughterhouse-Five'),
('Mrs. Dalloway said she would buy the flowers herself.','Virginia Woolf','Mrs. Dalloway'),
('It was a pleasure to burn.','Ray Bradbury','Fahrenheit 451');
Query OK, 8 rows affected (0.00 sec)
Records: 8  Duplicates: 0  Warnings: 0

-- Set the innodb_ft_server_stopword_table option to the new stopword table

mysql&gt; SET GLOBAL innodb_ft_server_stopword_table = 'test/my_stopwords';
Query OK, 0 rows affected (0.00 sec)

-- Create the full-text index (which rebuilds the table if no FTS_DOC_ID column is defined)

mysql&gt; CREATE FULLTEXT INDEX idx ON opening_lines(opening_line);
Query OK, 0 rows affected, 1 warning (1.17 sec)
Records: 0  Duplicates: 0  Warnings: 1</pre><p>
          <code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE</code> で単語を問い合わせて、指定したストップワード ('Ishmael') が表示されないことを確認します。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            デフォルトでは、長さが 3 文字よりも少ない単語または 84 文字よりも多い単語は、<code class="literal">InnoDB</code> の全文検索インデックスに表示されません。 単語の最大長および最小長の値は、<code class="literal">innodb_ft_max_token_size</code> および <code class="literal">innodb_ft_min_token_size</code> 変数を使用して構成できます。 このデフォルトの動作は ngram パーサープラグインには適用されません。ngram トークンサイズは <code class="literal">ngram_token_size</code> オプションで定義されます。 
          </p></div><pre class="programlisting">mysql&gt; SET GLOBAL innodb_ft_aux_table='test/opening_lines';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; SELECT word FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE LIMIT 15;
+-----------+
| word      |
+-----------+
| across    |
| all       |
| burn      |
| buy       |
| call      |
| comes     |
| dalloway  |
| first     |
| flowers   |
| happened  |
| herself   |
| invisible |
| less      |
| love      |
| man       |
+-----------+
15 rows in set (0.00 sec)</pre><p>
          ストップワードリストをテーブルごとに作成するには、その他のストップワードテーブルを作成し、<code class="literal">innodb_ft_user_stopword_table</code> オプションを使用して使用されるストップワードテーブルを指定してから、全文インデックスを作成します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-stopwords-stopwords-for-myisam-search-indexes"></a>MyISAM 検索インデックスのストップワード</h4></div></div></div><p>
          ストップワードファイルは、<code class="literal">character_set_server</code> が <code class="literal">ucs2</code>, <code class="literal">utf16</code>, <code class="literal">utf16le</code> または <code class="literal">utf32</code> の場合、<code class="literal">latin1</code> を使用してロードおよび検索されます。
        </p><p>
          <a class="indexterm" name="idm46041621980080"></a> <a class="indexterm" name="idm46041621977888"></a>MyISAM テーブル用のデフォルトのストップワードリストをオーバーライドするには、<code class="literal">ft_stopword_file</code> システム変数を設定します。 (<a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a>を参照してください。) 変数の値は、ストップワードリストを含むファイルのパス名、またはストップワードのフィルタ処理が無効になる空の文字列になるようにしてください。 サーバーは、別のディレクトリを指定する絶対パス名が指定されないかぎり、データディレクトリ内のファイルを検索します。 この変数の値またはストップワードファイルの内容を変更したら、サーバーを再起動し、<code class="literal">FULLTEXT</code> インデックスを再構築してください。 
        </p><p>
          ストップワードリストは自由形式で、改行、空白、カンマなどの英数字以外の文字でストップワードが区切られます。 例外は、アンダースコア文字 (<code class="literal">_</code>) および単語の一部として扱われる単一のアポストロフィ (<code class="literal">'</code>) です。 ストップワードリストの文字セットは、サーバーのデフォルト文字セットです。<a class="xref" href="charset.html#charset-server" title="10.3.2 サーバー文字セットおよび照合順序">セクション10.3.2「サーバー文字セットおよび照合順序」</a>を参照してください。 
        </p><p>
          次のリストに、<code class="literal">MyISAM</code> 検索インデックスのデフォルトのストップワードを示します。 このリストは、MySQL ソース配布の <code class="filename">storage/myisam/ft_static.c</code> ファイルで検索できます。 
        </p><pre class="programlisting">a's           able          about         above         according
accordingly   across        actually      after         afterwards
again         against       ain't         all           allow
allows        almost        alone         along         already
also          although      always        am            among
amongst       an            and           another       any
anybody       anyhow        anyone        anything      anyway
anyways       anywhere      apart         appear        appreciate
appropriate   are           aren't        around        as
aside         ask           asking        associated    at
available     away          awfully       be            became
because       become        becomes       becoming      been
before        beforehand    behind        being         believe
below         beside        besides       best          better
between       beyond        both          brief         but
by            c'mon         c's           came          can
can't         cannot        cant          cause         causes
certain       certainly     changes       clearly       co
com           come          comes         concerning    consequently
consider      considering   contain       containing    contains
corresponding could         couldn't      course        currently
definitely    described     despite       did           didn't
different     do            does          doesn't       doing
don't         done          down          downwards     during
each          edu           eg            eight         either
else          elsewhere     enough        entirely      especially
et            etc           even          ever          every
everybody     everyone      everything    everywhere    ex
exactly       example       except        far           few
fifth         first         five          followed      following
follows       for           former        formerly      forth
four          from          further       furthermore   get
gets          getting       given         gives         go
goes          going         gone          got           gotten
greetings     had           hadn't        happens       hardly
has           hasn't        have          haven't       having
he            he's          hello         help          hence
her           here          here's        hereafter     hereby
herein        hereupon      hers          herself       hi
him           himself       his           hither        hopefully
how           howbeit       however       i'd           i'll
i'm           i've          ie            if            ignored
immediate     in            inasmuch      inc           indeed
indicate      indicated     indicates     inner         insofar
instead       into          inward        is            isn't
it            it'd          it'll         it's          its
itself        just          keep          keeps         kept
know          known         knows         last          lately
later         latter        latterly      least         less
lest          let           let's         like          liked
likely        little        look          looking       looks
ltd           mainly        many          may           maybe
me            mean          meanwhile     merely        might
more          moreover      most          mostly        much
must          my            myself        name          namely
nd            near          nearly        necessary     need
needs         neither       never         nevertheless  new
next          nine          no            nobody        non
none          noone         nor           normally      not
nothing       novel         now           nowhere       obviously
of            off           often         oh            ok
okay          old           on            once          one
ones          only          onto          or            other
others        otherwise     ought         our           ours
ourselves     out           outside       over          overall
own           particular    particularly  per           perhaps
placed        please        plus          possible      presumably
probably      provides      que           quite         qv
rather        rd            re            really        reasonably
regarding     regardless    regards       relatively    respectively
right         said          same          saw           say
saying        says          second        secondly      see
seeing        seem          seemed        seeming       seems
seen          self          selves        sensible      sent
serious       seriously     seven         several       shall
she           should        shouldn't     since         six
so            some          somebody      somehow       someone
something     sometime      sometimes     somewhat      somewhere
soon          sorry         specified     specify       specifying
still         sub           such          sup           sure
t's           take          taken         tell          tends
th            than          thank         thanks        thanx
that          that's        thats         the           their
theirs        them          themselves    then          thence
there         there's       thereafter    thereby       therefore
therein       theres        thereupon     these         they
they'd        they'll       they're       they've       think
third         this          thorough      thoroughly    those
though        three         through       throughout    thru
thus          to            together      too           took
toward        towards       tried         tries         truly
try           trying        twice         two           un
under         unfortunately unless        unlikely      until
unto          up            upon          us            use
used          useful        uses          using         usually
value         various       very          via           viz
vs            want          wants         was           wasn't
way           we            we'd          we'll         we're
we've         welcome       well          went          were
weren't       what          what's        whatever      when
whence        whenever      where         where's       whereafter
whereas       whereby       wherein       whereupon     wherever
whether       which         while         whither       who
who's         whoever       whole         whom          whose
why           will          willing       wish          with
within        without       won't         wonder        would
wouldn't      yes           yet           you           you'd
you'll        you're        you've        your          yours
yourself      yourselves    zero
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-restrictions"></a>12.10.5 全文制限</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            全文検索は、<code class="literal">InnoDB</code> および <code class="literal">MyISAM</code> テーブルでのみサポートされています。
          </p></li><li class="listitem"><p>
            パーティション化されたテーブルでは、全文検索がサポートされていません。 <a class="xref" href="partitioning.html#partitioning-limitations" title="24.6 パーティショニングの制約と制限">セクション24.6「パーティショニングの制約と制限」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            全文検索は、ほとんどのマルチバイト文字セットで使用できます。 例外として、Unicode では、<code class="literal">utf8</code> 文字セットは使用できますが、<code class="literal">ucs2</code> 文字セットは使用できません。 <code class="literal">ucs2</code> カラム上では <code class="literal">FULLTEXT</code> インデックスを使用できませんが、このようなインデックスが含まれない <code class="literal">ucs2</code> 上で <code class="literal">IN BOOLEAN MODE</code> 検索を実行することはできます。 
          </p><p>
            <code class="literal">utf8</code> に関する備考は <code class="literal">utf8mb4</code> にも適用され、<code class="literal">ucs2</code> に関する備考は <code class="literal">utf16</code>、<code class="literal">utf16le</code>、および <code class="literal">utf32</code> にも適用されます。
          </p></li><li class="listitem"><p>
            中国語や日本語のような表意文字を使用する言語には、単語の区切り文字がありません。 したがって、組込みの全文パーサー<span class="emphasis"><em>これらの言語および他の言語で単語の開始位置と終了位置を判別できません</em></span>です。 
          </p><p>
            中国語、日本語および韓国語 (CJK) をサポートする文字ベースの ngram 全文パーサーと、日本語をサポートするワードベースの MeCab パーサープラグインが、<code class="literal">InnoDB</code> および <code class="literal">MyISAM</code> テーブルで使用するために提供されています。
          </p></li><li class="listitem"><p>
            単一テーブル内で複数の文字セットを使用することはサポートされていますが、<code class="literal">FULLTEXT</code> インデックス内のすべてのカラムで同じ文字セットおよび照合順序が使用される必要があります。
          </p></li><li class="listitem"><p>
            <code class="literal">MATCH()</code> カラムリストは、この <code class="literal">MATCH()</code> が <code class="literal">MyISAM</code> テーブル上の <code class="literal">IN BOOLEAN MODE</code> である場合を除いて、テーブルの一部の <code class="literal">FULLTEXT</code> インデックス定義に含まれるカラムリストに完全に一致する必要があります。 <code class="literal">MyISAM</code> テーブルでは、インデックスが付いていないカラムでもブールモード検索を実行できます。ただし、検索が遅くなる可能性があります。 
          </p></li><li class="listitem"><p>
            <code class="literal">AGAINST()</code> への引数は、クエリー評価時に定数である文字列値にする必要があります。 たとえば、テーブルカラムは、行ごとに異なる可能性があるため除外されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">FULLTEXT</code> 以外の検索の場合よりも <code class="literal">FULLTEXT</code> 検索の場合の方が、インデックスヒントに対する制限が多くなります。 <a class="xref" href="optimization.html#index-hints" title="8.9.4 インデックスヒント">セクション8.9.4「インデックスヒント」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> では、全文インデックスを含むカラムを必要とするすべての DML 演算子 (<code class="literal">INSERT</code>、<code class="literal">UPDATE</code>、<code class="literal">DELETE</code>) は、トランザクションのコミット時に処理されます。 たとえば、<code class="literal">INSERT</code> 演算では、挿入された文字列がトークン化され、個々の単語に分解されます。 その後、個々の単語は、トランザクションのコミット時に全文インデックステーブルに追加されます。 その結果、全文検索ではコミットされたデータのみが返されます。 
          </p></li><li class="listitem"><p>
            '%'文字は全文検索でサポートされているワイルドカード文字ではありません。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-fine-tuning"></a>12.10.6 MySQL の全文検索の微調整</h3></div></div></div><p>
        MySQL の全文検索機能には、ユーザーが調整できるパラメータがほとんどありません。 一部の変更でソースコードを変更する必要があるために、MySQL ソース配布を持っている場合は、全文検索の動作をさらに制御できます。 <a class="xref" href="installing.html#source-installation" title="2.9 ソースから MySQL をインストールする">セクション2.9「ソースから MySQL をインストールする」</a>を参照してください。 
      </p><p>
        全文検索の有効性は、慎重に調整されます。 ほとんど場合、デフォルトの動作を変更すると、実際には有効性が低くなる可能性があります。 <span class="emphasis"><em>使用方法を理解していない場合は、MySQL ソースは変更しないでください</em></span>。 
      </p><p>
        このセクションで説明するほとんどの全文変数は、サーバーの起動時に設定する必要があります。 変更するには、サーバーの再起動が必要です。サーバーが動作しているときは、変更できません。 
      </p><p>
        一部の変数を変更するには、テーブル内の <code class="literal">FULLTEXT</code> インデックスを再構築する必要があります。 これを行う手順については、このセクションの後半で説明します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#fulltext-word-length" title="単語の最小長と最大長の構成">単語の最小長と最大長の構成</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-natural-language-threshold" title="自然言語検索のしきい値の構成">自然言語検索のしきい値の構成</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-modify-boolean-operators" title="ブール全文検索演算子の変更">ブール全文検索演算子の変更</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-modify-character-set" title="文字セットの変更">文字セットの変更</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-rebuild-innodb-indexes" title="InnoDB 全文インデックスの再構築">InnoDB 全文インデックスの再構築</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-optimize" title="InnoDB 全文インデックスの最適化">InnoDB 全文インデックスの最適化</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-rebuild-myisam-indexes" title="MyISAM 全文インデックスの再構築">MyISAM 全文インデックスの再構築</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-word-length"></a>単語の最小長と最大長の構成</h4></div></div></div><p>
          インデックスが付けられる単語の最小長および最大長は、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_min_token_size</code> および <code class="literal">innodb_ft_max_token_size</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_min_word_len</code> および <code class="literal">ft_max_word_len</code> で定義されます。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            単語の最小長および最大長の全文パラメータは、ngram パーサーを使用して作成された <code class="literal">FULLTEXT</code> インデックスには適用されません。ngram トークンサイズは、<code class="literal">ngram_token_size</code> オプションで定義されます。
          </p></div><p>
          これらのオプションのいずれかを変更したら、変更を有効にするために <code class="literal">FULLTEXT</code> インデックスを再構築してください。 たとえば、2 文字の単語を検索可能にするには、オプションファイルに次の行を配置します。 
        </p><pre class="programlisting">[mysqld]
innodb_ft_min_token_size=2
ft_min_word_len=2</pre><p>
          次に、サーバーを再起動し、<code class="literal">FULLTEXT</code> インデックスを再構築します。 <code class="literal">MyISAM</code> テーブルについては、<code class="literal">MyISAM</code> の全文インデックスを再構築する際に従う手順で、<span class="command"><strong>myisamchk</strong></span> に関する備考に注意してください。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-natural-language-threshold"></a>自然言語検索のしきい値の構成</h4></div></div></div><p>
          <code class="literal">MyISAM</code> 検索インデックスでは、選択された特定の重み付けスキームによって、自然言語検索で 50% のしきい値が決定されます。 これを無効にするには、<code class="filename">storage/myisam/ftdefs.h</code> で次の行を検索してください。 
        </p><pre class="programlisting">#define GWS_IN_USE GWS_PROB
</pre><p>
          この行を次のように変更します。
        </p><pre class="programlisting">#define GWS_IN_USE GWS_FREQ
</pre><p>
          次に、MySQL を再コンパイルします。 この場合、インデックスを再構築する必要はありません。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            このように変更すると、<code class="literal">MATCH()</code> 関数に適切な関連性値を提供する MySQL の能力が<span class="emphasis"><em>大幅に</em></span>低下します。 このような一般的な単語を検索する必要がある場合は、代わりに、50% のしきい値に従わない <code class="literal">IN BOOLEAN MODE</code> を使用して検索する方が適切です。 
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-modify-boolean-operators"></a>ブール全文検索演算子の変更</h4></div></div></div><p>
          <code class="literal">MyISAM</code> テーブル上でブール全文検索に使用される演算子を変更するには、<code class="literal">ft_boolean_syntax</code> システム変数を設定します。 (<code class="literal">InnoDB</code> には同等の設定がありません。) この変数は、サーバーの実行中に変更できますが、グローバルシステム変数を設定するのに十分な権限が必要です (<a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 システム変数権限">セクション5.1.9.1「システム変数権限」</a> を参照)。 この場合は、インデックスを再構築する必要はありません。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-modify-character-set"></a>文字セットの変更</h4></div></div></div><p>
          組込み全文パーサーでは、次のリストで説明するように、単語文字とみなされる文字のセットをいくつかの方法で変更できます。 変更が完了したら、任意の <code class="literal">FULLTEXT</code> インデックスを含むテーブルごとにインデックスを再構築します。 ハイフン文字 (' - ') を単語文字として処理すると仮定します。 次の方法のいずれかを使用します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL ソースを変更します。<code class="filename">storage/innobase/handler/ha_innodb.cc</code> (<code class="literal">InnoDB</code> の場合) または <code class="filename">storage/myisam/ftdefs.h</code> (<code class="literal">MyISAM</code> の場合) で、<code class="literal">true_word_char()</code> および <code class="literal">misc_word_char()</code> マクロを参照してください。 それらのマクロのいずれかに <code class="literal">'-'</code> を追加し、MySQL を再コンパイルします。 
            </p></li><li class="listitem"><p>
              文字セットファイルを変更します。再コンパイルする必要はありません。 <code class="literal">true_word_char()</code> マクロでは、英数字とその他の文字を区別するために <span class="quote">「<span class="quote">character type</span>」</span> テーブルが使用されます。 文字セット XML ファイルのいずれかで <code class="literal">&lt;ctype&gt;&lt;map&gt;</code> 配列の内容を編集すると、<code class="literal">'-'</code> が<span class="quote">「<span class="quote">英字</span>」</span>になるように指定できます。 次に、<code class="literal">FULLTEXT</code> インデックスに指定された文字セットを使用します。 <code class="literal">&lt;ctype&gt;&lt;map&gt;</code> 配列の書式については、<a class="xref" href="charset.html#character-arrays" title="10.13.1 文字定義配列">セクション10.13.1「文字定義配列」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              インデックス付きのカラムで使用される文字セットに新しい照合順序を追加し、その照合順序が使用されるようにカラムを変更します。 照合順序の追加に関する一般的な情報については、<a class="xref" href="charset.html#adding-collation" title="10.14 文字セットへの照合順序の追加">セクション10.14「文字セットへの照合順序の追加」</a>を参照してください。 全文インデックス作成に固有の例については、<a class="xref" href="functions.html#full-text-adding-collation" title="12.10.7 全文インデックス付けのためのユーザー定義照合の追加">セクション12.10.7「全文インデックス付けのためのユーザー定義照合の追加」</a>を参照してください。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-rebuild-innodb-indexes"></a>InnoDB 全文インデックスの再構築</h4></div></div></div><p>
          変更を有効にするには、次の全文インデックス変数のいずれかを変更した後に <code class="literal">FULLTEXT</code> インデックスを再構築する必要があります: <code class="literal">innodb_ft_min_token_size</code>; <code class="literal">innodb_ft_max_token_size</code>; <code class="literal">innodb_ft_server_stopword_table</code>; <code class="literal">innodb_ft_user_stopword_table</code>; <code class="literal">innodb_ft_enable_stopword</code>; <code class="literal">ngram_token_size</code>。 <code class="literal">innodb_ft_min_token_size</code>、<code class="literal">innodb_ft_max_token_size</code> または <code class="literal">ngram_token_size</code> を変更するには、サーバーを再起動する必要があります。 
        </p><p>
          <code class="literal">InnoDB</code> テーブルの <code class="literal">FULLTEXT</code> インデックスを再構築するには、<code class="literal">DROP INDEX</code> および <code class="literal">ADD INDEX</code> オプションを指定して <code class="literal">ALTER TABLE</code> を使用し、各インデックスを削除して再作成します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-optimize"></a>InnoDB 全文インデックスの最適化</h4></div></div></div><p>
          全文インデックス付きのテーブル上で <code class="literal">OPTIMIZE TABLE</code> を実行すると、全文インデックスが再構築され、削除済みのドキュメント ID が削除され、同じ単語に対応する複数のエントリが連結されます (可能な場合)。
        </p><p>
          全文インデックスを最適化するには、<code class="literal">innodb_optimize_fulltext_only</code> を有効にして、<code class="literal">OPTIMIZE TABLE</code> を実行します。
        </p><pre class="programlisting">mysql&gt; set GLOBAL innodb_optimize_fulltext_only=ON;
Query OK, 0 rows affected (0.01 sec)

mysql&gt; OPTIMIZE TABLE opening_lines;
+--------------------+----------+----------+----------+
| Table              | Op       | Msg_type | Msg_text |
+--------------------+----------+----------+----------+
| test.opening_lines | optimize | status   | OK       |
+--------------------+----------+----------+----------+
1 row in set (0.01 sec)    </pre><p>
          大きなテーブルで全文インデックスの再構築時間が長くなることを回避するには、<code class="literal">innodb_ft_num_word_optimize</code> オプションを使用すれば、最適化を段階的に実行できます。 <code class="literal">innodb_ft_num_word_optimize</code> オプションでは、<code class="literal">OPTIMIZE TABLE</code> が実行されるたびに最適化される単語の数が定義されます。 デフォルト設定は 2000 です。これは、<code class="literal">OPTIMIZE TABLE</code> が実行されるたびに 2000 個の単語が最適化されることを表します。 後続の <code class="literal">OPTIMIZE TABLE</code> 演算は、先行する <code class="literal">OPTIMIZE TABLE</code> 演算が終了した場所から続行されます。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-rebuild-myisam-indexes"></a>MyISAM 全文インデックスの再構築</h4></div></div></div><p>
          インデックス作成に影響を与える全文変数 (<code class="literal">ft_min_word_len</code>、<code class="literal">ft_max_word_len</code>、または <code class="literal">ft_stopword_file</code>) を変更する場合や、ストップワードファイル自体を変更する場合は、変更して、サーバーを再起動したあとに、<code class="literal">FULLTEXT</code> インデックスを再構築する必要があります。
        </p><p>
          <code class="literal">MyISAM</code> テーブルの <code class="literal">FULLTEXT</code> インデックスを再構築するには、<code class="literal">QUICK</code> 修復演算を実行すれば十分です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>REPAIR TABLE <em class="replaceable"><code>tbl_name</code></em> QUICK;</code></strong>
</pre><p>
          または、先ほど説明した <code class="literal">ALTER TABLE</code> を使用します。 これは、修復演算よりも高速になる可能性もあります。 
        </p><p>
          任意の <code class="literal">FULLTEXT</code> インデックスを含む各テーブルは、上記のように修復する必要があります。 そうしないと、テーブルのクエリーによって誤った結果が生成される可能性があり、テーブルを変更すると、サーバーはテーブルが破損していて修復が必要であることを確認します。 
        </p><p>
          <span class="command"><strong>myisamchk</strong></span> を使用して、<code class="literal">MyISAM</code> テーブルインデックスを変更する演算 (修復や分析など) を実行する場合は、ほかに指定がなければ、単語の最小長、単語の最大長、およびストップワードファイルの<span class="emphasis"><em>デフォルト</em></span>の全文パラメータ値を使用して、<code class="literal">FULLTEXT</code> インデックスが再構築されます。 これにより、クエリーに失敗する可能性があります。 
        </p><p>
          この問題は、これらのパラメータがサーバーでのみ認識されていることが原因で発生します。 <code class="literal">MyISAM</code> インデックスファイルには格納されていません。 サーバーで使用される単語の最小長や最大長、またはストップワードファイルの値を変更した場合の問題を回避するには、<span class="command"><strong>mysqld</strong></span> で使用される <span class="command"><strong>myisamchk</strong></span> と同じ <code class="literal">ft_min_word_len</code>、<code class="literal">ft_max_word_len</code>、および <code class="literal">ft_stopword_file</code> 値を指定します。 たとえば、単語の最小長を 3 に設定した場合は、次のように <span class="command"><strong>myisamchk</strong></span> を使用してテーブルを修復できます。 
        </p><pre class="programlisting">myisamchk --recover --ft_min_word_len=3 <em class="replaceable"><code>tbl_name</code></em>.MYI
</pre><p>
          <span class="command"><strong>myisamchk</strong></span> およびサーバーで全文パラメータに必ず同じ値が使用されるようにするには、オプションファイルの <code class="literal">[mysqld]</code> と <code class="literal">[myisamchk]</code> の両方のセクションにそれぞれを配置してください。
        </p><pre class="programlisting">[mysqld]
ft_min_word_len=3

[myisamchk]
ft_min_word_len=3
</pre><p>
          <code class="literal">MyISAM</code> テーブルインデックスの変更に <span class="command"><strong>myisamchk</strong></span> を使用する方法の代替として、<code class="literal">REPAIR TABLE</code>、<code class="literal">ANALYZE TABLE</code>、<code class="literal">OPTIMIZE TABLE</code>、または <code class="literal">ALTER TABLE</code> ステートメントを使用します。 これらのステートメントは、適切に使用される全文パラメータ値が認識されているサーバーで実行されます。 
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="full-text-adding-collation"></a>12.10.7 全文インデックス付けのためのユーザー定義照合の追加</h3></div></div></div><p>
        このセクションでは、組込み全文パーサーを使用して全文検索用のユーザー定義照合を追加する方法について説明します。 サンプルの照合順序は <code class="literal">latin1_swedish_ci</code> と似ていますが、<code class="literal">'-'</code> 文字は、単語文字としてインデックスを付けることができるように、句読文字としてではなく英字として処理されます。 照合順序の追加に関する一般的な情報については、<a class="xref" href="charset.html#adding-collation" title="10.14 文字セットへの照合順序の追加">セクション10.14「文字セットへの照合順序の追加」</a>で説明されています。この情報を参照し、関与するファイルをよく理解することが前提となっています。 
      </p><p>
        全文インデックス付けの照合を追加するには、次の手順を使用します。 ここで説明する手順では、<a class="xref" href="charset.html#adding-collation" title="10.14 文字セットへの照合順序の追加">セクション10.14「文字セットへの照合順序の追加」</a> で説明されているように、文字セットプロパティを記述する構成ファイルを使用して、単純な文字セットの照合順序を作成できます。 Unicode などの複雑な文字セットの場合は、文字セットプロパティを記述する C ソースファイルを使用して照合を作成します。 
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            照合順序を <code class="filename">Index.xml</code> ファイルに追加します。 ユーザー定義照合に許可される ID の範囲は、<a class="xref" href="charset.html#adding-collation-choosing-id" title="10.14.2 照合順序 ID の選択">セクション10.14.2「照合順序 ID の選択」</a> で指定されます。 ID は未使用である必要があるため、その ID がシステムですでに使用されている場合は 1025 以外の値を選択してください。 
          </p><pre class="programlisting">&lt;charset name="latin1"&gt;
...
&lt;collation name="latin1_fulltext_ci" id="1025"/&gt;
&lt;/charset&gt;
</pre></li><li class="listitem"><p>
            <code class="filename">latin1.xml</code> ファイルで照合順序のソート順序を宣言します。 この場合、<code class="literal">latin1_swedish_ci</code> から順序をコピーできます。 
          </p><pre class="programlisting">&lt;collation name="latin1_fulltext_ci"&gt;
&lt;map&gt;
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F
30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F
40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F
60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F
80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F
90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F
A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF
B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D D7 D8 55 55 55 59 59 DE DF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D F7 D8 55 55 55 59 59 DE FF
&lt;/map&gt;
&lt;/collation&gt;
</pre></li><li class="listitem"><p>
            <code class="filename">latin1.xml</code> で <code class="literal">ctype</code> 配列を変更します。 0x2D (<code class="literal">'-'</code>文字のコード) に対応する値を 10 (句読点) から 01 (大文字) に変更します。 次の配列では、これは 4 行目の要素で、最後から 3 番目の値です。 
          </p><pre class="programlisting">&lt;ctype&gt;
&lt;map&gt;
00
20 20 20 20 20 20 20 20 20 28 28 28 28 28 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
48 10 10 10 10 10 10 10 10 10 10 10 10 <em class="replaceable"><code>01</code></em> 10 10
84 84 84 84 84 84 84 84 84 84 10 10 10 10 10 10
10 81 81 81 81 81 81 01 01 01 01 01 01 01 01 01
01 01 01 01 01 01 01 01 01 01 01 10 10 10 10 10
10 82 82 82 82 82 82 02 02 02 02 02 02 02 02 02
02 02 02 02 02 02 02 02 02 02 02 10 10 10 10 20
10 00 10 02 10 10 10 10 10 10 01 10 01 00 01 00
00 10 10 10 10 10 10 10 10 10 02 10 02 00 02 01
48 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01
01 01 01 01 01 01 01 10 01 01 01 01 01 01 01 02
02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02
02 02 02 02 02 02 02 10 02 02 02 02 02 02 02 02
&lt;/map&gt;
&lt;/ctype&gt;
</pre></li><li class="listitem"><p>
            サーバーを再起動します。
          </p></li><li class="listitem"><p>
            新しい照合順序を使用するには、使用されるカラムの定義に追加します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS t1;</code></strong>
Query OK, 0 rows affected (0.13 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    <strong class="userinput"><code>a TEXT CHARACTER SET latin1 COLLATE latin1_fulltext_ci,</code></strong>
    <strong class="userinput"><code>FULLTEXT INDEX(a)</code></strong>
    <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong>
Query OK, 0 rows affected (0.47 sec)
</pre></li><li class="listitem"><p>
            照合順序をテストして、ハイフンが単語文字としてみなされることを確認します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUEs ('----'),('....'),('abcd');</code></strong>
Query OK, 3 rows affected (0.22 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 WHERE MATCH a AGAINST ('----' IN BOOLEAN MODE);</code></strong>
+------+
| a    |
+------+
| ---- |
+------+
1 row in set (0.00 sec)
</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-search-ngram"></a>12.10.8 ngram 全文パーサー</h3></div></div></div><p>
        組込みの MySQL 全文パーサーは、単語間の空白をデリミタとして使用して、単語の開始位置と終了位置を決定します。これは、単語デリミタを使用しない表意文字言語を使用する場合の制限です。 この制限に対処するために、MySQL には、中国語、日本語および韓国語 (CJK) をサポートする ngram 全文パーサーが用意されています。 ngram 全文パーサーは、<code class="literal">InnoDB</code> および <code class="literal">MyISAM</code> での使用がサポートされています。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          MySQL には、ドキュメントを意味のある単語にトークン化する日本語用の MeCab 全文パーサープラグインも用意されています。 詳細は、<a class="xref" href="functions.html#fulltext-search-mecab" title="12.10.9 MeCab フルテキストパーサープラグイン">セクション12.10.9「MeCab フルテキストパーサープラグイン」</a>を参照してください。 
        </p></div><p>
        ngram は、指定された一連のテキストから連続した一連の <em class="replaceable"><code>n</code></em> 文字です。 ngram パーサーは、一連のテキストを連続した一連の <em class="replaceable"><code>n</code></em> 文字にトークン化します。 たとえば、ngram 全文パーサーを使用して、<em class="replaceable"><code>n</code></em> の様々な値の <span class="quote">「<span class="quote">abcd</span>」</span> をトークン化できます。 
      </p><pre class="programlisting">n=1: 'a', 'b', 'c', 'd'
n=2: 'ab', 'bc', 'cd'
n=3: 'abc', 'bcd'
n=4: 'abcd'</pre><p>
        ngram 全文パーサーは、組み込みのサーバープラグインです。 ほかの組み込みサーバープラグインと同様に、サーバーの起動時に自動的にロードされます。 
      </p><p>
        <a class="xref" href="functions.html#fulltext-search" title="12.10 全文検索関数">セクション12.10「全文検索関数」</a> で説明されている全文検索構文は、ngram パーサープラグインに適用されます。 このセクションでは、解析動作の違いについて説明します。 単語の最小長および最大長オプション (<code class="literal">innodb_ft_min_token_size</code>, <code class="literal">innodb_ft_max_token_size</code>, <code class="literal">ft_min_word_len</code>, <code class="literal">ft_max_word_len</code>) を除く、全文関連の構成オプションも適用できます。 
      </p><h4><a name="idm46041621726256"></a>ngram トークンサイズの構成</h4><p>
        ngram パーサーのデフォルトの ngram トークンサイズは 2 (bigram) です。 たとえば、トークンサイズが 2 の場合、ngram パーサーは文字列 <span class="quote">「<span class="quote">abc def</span>」</span> を 4 つのトークンに解析: <span class="quote">「<span class="quote">ab</span>」</span>、<span class="quote">「<span class="quote">bc</span>」</span>、<span class="quote">「<span class="quote">de</span>」</span> および <span class="quote">「<span class="quote">ef</span>」</span>。 
      </p><p>
        ngram トークンサイズは、最小値が 1 で最大値が 10 の <code class="literal">ngram_token_size</code> 構成オプションを使用して構成できます。
      </p><p>
        通常、<code class="literal">ngram_token_size</code> は、検索する最大トークンのサイズに設定されます。 単一文字のみを検索する場合は、<code class="literal">ngram_token_size</code> を 1 に設定します。 トークンサイズを小さくすると、全文検索インデックスが小さくなり、検索が高速になります。 複数の文字で構成される単語を検索する必要がある場合は、それに応じて <code class="literal">ngram_token_size</code> を設定します。 たとえば、<span class="quote">「<span class="quote">Happy Birthday</span>」</span> は簡体字中国語の<span class="quote">「<span class="quote">「<span lang="zh-cn" class="phrase">生日快乐</span>」</span>」</span>で、<span class="quote">「<span class="quote">「<span lang="zh-cn" class="phrase">生日</span>」</span>」</span>は<span class="quote">「<span class="quote">「誕生日」</span>」</span>で、<span class="quote">「<span class="quote">「<span lang="zh-cn" class="phrase">快乐</span>」</span>」</span>は<span class="quote">「<span class="quote">「幸せ」</span>」</span>として翻訳されます。 これらのような 2 文字の単語を検索するには、<code class="literal">ngram_token_size</code> を 2 以上の値に設定します。 
      </p><p>
        読取り専用変数として、<code class="literal">ngram_token_size</code> は起動文字列の一部または構成ファイルでのみ設定できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            起動文字列:
          </p><pre class="programlisting">mysqld --ngram_token_size=2</pre></li><li class="listitem"><p>
            構成ファイル:
          </p><pre class="programlisting">[mysqld]
ngram_token_size=2</pre></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          ngram パーサーを使用する <code class="literal">FULLTEXT</code> インデックスでは、次の最小および最大ワード長構成オプションは無視されます: <code class="literal">innodb_ft_min_token_size</code>, <code class="literal">innodb_ft_max_token_size</code>, <code class="literal">ft_min_word_len</code> および <code class="literal">ft_max_word_len</code>。
        </p></div><h4><a name="idm46041621699104"></a>ngram パーサーを使用する FULLTEXT インデックスの作成</h4><p>
        ngram パーサーを使用する <code class="literal">FULLTEXT</code> インデックスを作成するには、<code class="literal">CREATE TABLE</code>、<code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> とともに <code class="literal">WITH PARSER ngram</code> を指定します。
      </p><p>
        次の例では、<code class="literal">ngram</code> <code class="literal">FULLTEXT</code> インデックスを使用したテーブルの作成、サンプルデータの挿入 (簡体字中国語テキスト)、および <code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE</code> テーブルでのトークン化されたデータの表示を示します。
      </p><pre class="programlisting">mysql&gt; USE test;

mysql&gt; CREATE TABLE articles (
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
      title VARCHAR(200),
      body TEXT,
      FULLTEXT (title,body) WITH PARSER ngram
    ) ENGINE=InnoDB CHARACTER SET utf8mb4;

mysql&gt; SET NAMES utf8mb4;

INSERT INTO articles (title,body) VALUES
    ('数据库管理','在本教程中我将向你展示如何管理数据库'),
    ('数据库应用开发','学习开发数据库应用程序');

mysql&gt; SET GLOBAL innodb_ft_aux_table="test/articles";

mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE ORDER BY doc_id, position;</pre><p>
        既存のテーブルに <code class="literal">FULLTEXT</code> インデックスを追加するには、<code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> を使用できます。 例: 
      </p><pre class="programlisting">CREATE TABLE articles (
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
      title VARCHAR(200),
      body TEXT
     ) ENGINE=InnoDB CHARACTER SET utf8;

ALTER TABLE articles ADD FULLTEXT INDEX ft_index (title,body) WITH PARSER ngram;

# Or:

CREATE FULLTEXT INDEX ft_index ON articles (title,body) WITH PARSER ngram;
</pre><h4><a name="idm46041621683200"></a>ngram パーサーの領域処理</h4><p>
        ngram パーサーは、解析時にスペースを削除します。 例: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="quote">「<span class="quote">ab cd</span>」</span> が <span class="quote">「<span class="quote">ab</span>」</span>、<span class="quote">「<span class="quote">cd</span>」</span> に解析されます
          </p></li><li class="listitem"><p>
            <span class="quote">「<span class="quote">a bc</span>」</span> が <span class="quote">「<span class="quote">bc</span>」</span> に解析されます
          </p></li></ul></div><h4><a name="idm46041621677664"></a>ngram パーサーのストップワード処理</h4><p>
        組込みの MySQL 全文パーサーは、ワードをストップワードリストのエントリと比較します。 ワードがストップワードリストのエントリと等しい場合、そのワードはインデックスから除外されます。 ngram パーサーの場合、ストップワード処理は異なる方法で実行されます。 ngram パーサーは、ストップワードリストのエントリと等しいトークンを除外するかわりに、<span class="emphasis"><em>次を含む</em></span>がストップワードするトークンを除外します。 たとえば、<code class="literal">ngram_token_size=2</code> の場合、<span class="quote">「<span class="quote">a,b</span>」</span> を含むドキュメントは <span class="quote">「<span class="quote">a,</span>」</span>および<span class="quote">「<span class="quote">,b</span>」</span> に解析されます。 カンマ (<span class="quote">「<span class="quote">,</span>」</span>) がストップワードとして定義されている場合、<span class="quote">「<span class="quote">a,</span>」</span>と<span class="quote">「<span class="quote">,b</span>」</span> の両方にカンマが含まれているため、インデックスから除外されます。 
      </p><p>
        デフォルトでは、ngram パーサーは、英語のストップワードのリストを含むデフォルトのストップワードリストを使用します。 中国語、日本語または韓国語に適用可能なストップワードリストの場合は、独自のものを作成する必要があります。 ストップワードリストの作成の詳細は、<a class="xref" href="functions.html#fulltext-stopwords" title="12.10.4 全文ストップワード">セクション12.10.4「全文ストップワード」</a> を参照してください。 
      </p><p>
        <code class="literal">ngram_token_size</code> より長いストップワードは無視されます。
      </p><h4><a name="idm46041621668016"></a>ngram パーサー用語検索</h4><p>
        <span class="emphasis"><em>自然言語モード</em></span>検索の場合、検索語は ngram 語の和集合に変換されます。 たとえば、文字列 <span class="quote">「<span class="quote">abc</span>」</span> (<code class="literal">ngram_token_size=2</code> を想定) は <span class="quote">「<span class="quote">ab bc</span>」</span> に変換されます。 <span class="quote">「<span class="quote">ab</span>」</span> を含むドキュメントと <span class="quote">「<span class="quote">abc</span>」</span> を含むドキュメントがある場合、検索語 <span class="quote">「<span class="quote">ab bc</span>」</span> は両方のドキュメントに一致します。 
      </p><p>
        <span class="emphasis"><em>ブールモード検索</em></span>の場合、検索語は ngram 句検索に変換されます。 たとえば、文字列'abc' (<code class="literal">ngram_token_size=2</code> を想定) は'<span class="quote">「<span class="quote">ab bc</span>」</span>'に変換されます。 'ab'を含むドキュメントと'abc'を含むドキュメントがある場合、検索フレーズ'<span class="quote">「<span class="quote">ab bc</span>」</span>'は'abc'を含むドキュメントにのみ一致します。 
      </p><h4><a name="idm46041621659744"></a>ngram パーサーワイルドカード検索</h4><p>
        ngram <code class="literal">FULLTEXT</code> インデックスには ngrams のみが含まれ、用語の先頭に関する情報は含まれないため、ワイルドカード検索で予期しない結果が返されることがあります。 ngram <code class="literal">FULLTEXT</code> 検索インデックスを使用したワイルドカード検索には、次の動作が適用されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ワイルドカード検索の接頭辞語句が ngram トークンサイズより短い場合、クエリーは接頭辞 term で始まる ngram トークンを含むすべてのインデックス付き行を返します。 たとえば、<code class="literal">ngram_token_size=2</code> の場合、<span class="quote">「<span class="quote">a*</span>」</span> で検索すると、<span class="quote">「<span class="quote">a</span>」</span> で始まるすべての行が返されます。 
          </p></li><li class="listitem"><p>
            ワイルドカード検索の接頭辞用語が ngram トークンサイズより長い場合、接頭辞用語は ngram 句に変換され、ワイルドカード演算子は無視されます。 たとえば、<code class="literal">ngram_token_size=2</code> の場合、<span class="quote">「<span class="quote">abc*</span>」</span> ワイルドカード検索は <span class="quote">「<span class="quote">ab bc</span>」</span> に変換されます。 
          </p></li></ul></div><h4><a name="idm46041621649552"></a>ngram パーサーフレーズ検索</h4><p>
        フレーズ検索は ngram 句検索に変換されます。 たとえば、<span class="quote">「<span class="quote">abc</span>」</span> という検索フレーズは、<span class="quote">「<span class="quote">abc</span>」</span> および <span class="quote">「<span class="quote">ab bc</span>」</span> を含むドキュメントを返す <span class="quote">「<span class="quote">ab bc</span>」</span> に変換されます。 
      </p><p>
        <span class="quote">「<span class="quote">abc def</span>」</span> という検索フレーズは、<span class="quote">「<span class="quote">abc def</span>」</span> および <span class="quote">「<span class="quote">ab bc de ef</span>」</span> を含むドキュメントを返す <span class="quote">「<span class="quote">ab bc de ef</span>」</span> に変換されます。 <span class="quote">「<span class="quote">abcdef</span>」</span> を含むドキュメントは返されません。 
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-search-mecab"></a>12.10.9 MeCab フルテキストパーサープラグイン</h3></div></div></div><p>
        組込みの MySQL 全文パーサーは、単語間の空白をデリミタとして使用して、単語の開始位置と終了位置を決定します。これは、単語デリミタを使用しない表意文字言語を使用する場合の制限です。 日本語のこの制限に対処するために、MySQL には MeCab 全文パーサープラグインが用意されています。 MeCab 全文パーサープラグインは、<code class="literal">InnoDB</code> および <code class="literal">MyISAM</code> での使用がサポートされています。 
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          MySQL には、日本語をサポートする ngram 全文パーサープラグインも用意されています。 詳細は、<a class="xref" href="functions.html#fulltext-search-ngram" title="12.10.8 ngram 全文パーサー">セクション12.10.8「ngram 全文パーサー」</a>を参照してください。 
        </p></div><p>
        MeCab 全文パーサープラグインは、一連のテキストを意味のある単語にトークン化する日本語の全文パーサープラグインです。 たとえば、MeCab は、<span class="quote">「<span class="quote">「<span lang="ja" class="phrase">データベース管理</span>」</span>」</span> (<span class="quote">「<span class="quote">「データベース管理」</span>」</span>) を<span class="quote">「<span class="quote">「<span lang="ja" class="phrase">データベース</span>」</span>」</span> (<span class="quote">「<span class="quote">「データベース」</span>」</span>) および<span class="quote">「<span class="quote">「<span lang="ja" class="phrase">管理</span>」</span>」</span> (<span class="quote">「<span class="quote">「管理」</span>」</span>) にトークン化します。 比較すると、<a class="link" href="functions.html#fulltext-search-ngram" title="12.10.8 ngram 全文パーサー">ngram</a> 全文パーサーは、テキストを連続した一連の <em class="replaceable"><code>n</code></em> 文字にトークン化します。ここで、<em class="replaceable"><code>n</code></em> は 1 から 10 までの数値を表します。 
      </p><p>
        テキストを意味のある単語にトークン化するだけでなく、MeCab インデックスは通常 ngram インデックスよりも小さく、MeCab 全文検索は一般的に高速です。 欠点は、ngram 全文パーサーに比べて、MeCab 全文パーサーがドキュメントをトークン化するのに時間がかかることです。 
      </p><p>
        <a class="xref" href="functions.html#fulltext-search" title="12.10 全文検索関数">セクション12.10「全文検索関数」</a> で説明されている全文検索構文は、MeCab パーサープラグインに適用されます。 このセクションでは、解析動作の違いについて説明します。 全文関連の構成オプションも適用できます。 
      </p><p>
        MeCab パーサーの詳細は、Github の<a class="ulink" href="http://taku910.github.io/mecab/" target="_top">「MeCab : 他の品詞/形態アナライザ」</a>プロジェクトを参照してください。
      </p><h4><a name="idm46041621625856"></a>MeCab パーサープラグインのインストール</h4><p>
        MeCab パーサープラグインには、<code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> が必要です。
      </p><p>
        サポートされている Fedora、Debian および Ubuntu プラットフォーム (システム <code class="filename">mecab</code> バージョンが古すぎる Ubuntu 12.04 を除く) では、MySQL はシステム <code class="filename">mecab</code> インストールがデフォルトの場所にインストールされている場合に、そのインストールに動的にリンクします。 サポートされている他の Unix に似たプラットフォームでは、<code class="filename">libmecab.so</code> は MySQL プラグインディレクトリにある <code class="filename">libpluginmecab.so</code> で静的にリンクされます。<code class="filename">mecab-ipadic</code> は MySQL バイナリに含まれており、<code class="filename"><em class="replaceable"><code>MYSQL_HOME</code></em>\lib\mecab</code> にあります。 
      </p><p>
        ネイティブパッケージ管理ユーティリティ (Fedora、Debian および Ubuntu 上) を使用して <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> をインストールするか、ソースから <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> をビルドできます。 ネイティブパッケージ管理ユーティリティを使用した <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> のインストールの詳細は、<a class="link" href="functions.html#install-mecab-binary" title="バイナリ配布からの MeCab のインストール (オプション)">Installing MeCab From a Binary Distribution (Optional)</a> を参照してください。 ソースから <code class="filename">mecab</code> および <code class="literal">mecab-ipadic</code> をビルドする場合は、<a class="link" href="functions.html#build-mecab-from-source" title="ソースからの MeCab のインストール (オプション)">Building MeCab From Source (Optional)</a> を参照してください。 
      </p><p>
        Windows では、<code class="filename">libmecab.dll</code> は MySQL <code class="filename">bin</code> ディレクトリにあります。<code class="filename">mecab-ipadic</code> は <code class="filename"><em class="replaceable"><code>MYSQL_HOME</code></em>/lib/mecab</code> にあります。
      </p><p>
        MeCab パーサープラグインをインストールおよび構成するには、次のステップを実行します:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            MySQL 構成ファイルで、<code class="literal">mecab_rc_file</code> 構成オプションを、MeCab の構成ファイルである <code class="literal">mecabrc</code> 構成ファイルの場所に設定します。 MySQL とともに配布される MeCab パッケージを使用している場合、<code class="literal">mecabrc</code> ファイルは <code class="filename">MYSQL_HOME/lib/mecab/etc/</code>にあります。 
          </p><pre class="programlisting">[mysqld]
loose-mecab-rc-file=MYSQL_HOME/lib/mecab/etc/mecabrc</pre><p>
            <code class="literal">loose</code> 接頭辞は <a class="link" href="programs.html#option-modifiers" title="4.2.2.4 プログラムオプション修飾子">option modifier</a> です。 <code class="literal">mecab_rc_file</code> オプションは、MeCaB パーサープラグインがインストールされるまで MySQL によって認識されませんが、MeCaB パーサープラグインをインストールする前に設定する必要があります。 <code class="literal">loose</code> 接頭辞を使用すると、認識されない変数が原因でエラーが発生することなく MySQL を再起動できます。 
          </p><p>
            独自の MeCab インストールを使用する場合、またはソースから MeCab をビルドする場合、<code class="filename">mecabrc</code> 構成ファイルの場所が異なる可能性があります。
          </p><p>
            MySQL 構成ファイルとその場所の詳細は、<a class="xref" href="programs.html#option-files" title="4.2.2.2 オプションファイルの使用">セクション4.2.2.2「オプションファイルの使用」</a> を参照してください。
          </p></li><li class="listitem"><p>
            また、MySQL 構成ファイルで、最小トークンサイズを 1 または 2 に設定します。これは、MeCab パーサーで使用することをお薦めします。 <code class="literal">InnoDB</code> テーブルの場合、最小トークンサイズは <code class="literal">innodb_ft_min_token_size</code> 構成オプションによって定義され、デフォルト値は 3 です。 <code class="literal">MyISAM</code> テーブルの場合、最小トークンサイズは <code class="literal">ft_min_word_len</code> によって定義され、デフォルト値は 4 です。 
          </p><pre class="programlisting">[mysqld]
innodb_ft_min_token_size=1</pre></li><li class="listitem"><p>
            <code class="filename">mecabrc</code> 構成ファイルを変更して、使用するディクショナリを指定します。 MySQL バイナリとともに配布される <code class="filename">mecab-ipadic</code> パッケージには、3 つのディクショナリ (<code class="literal">ipadic_euc-jp</code>、<code class="literal">ipadic_sjis</code> および <code class="literal">ipadic_utf-8</code>) が含まれます。 MySQL とともにパッケージ化された <code class="filename">mecabrc</code> 構成ファイルには、次のようなエントリが含まれています: 
          </p><pre class="programlisting">dicdir =  /path/to/mysql/lib/mecab/lib/mecab/dic/ipadic_euc-jp</pre><p>
            たとえば、<code class="filename">ipadic_utf-8</code> ディクショナリを使用するには、次のようにエントリを変更します:
          </p><pre class="programlisting">dicdir=<em class="replaceable"><code>MYSQL_HOME</code></em>/lib/mecab/dic/ipadic_utf-8</pre><p>
            独自の MeCab インストールを使用している場合、またはソースから MeCab をビルドしている場合、<code class="filename">mecabrc</code> ファイルのデフォルトの <code class="literal">dicdir</code> エントリはディクショナリとその場所とは異なる可能性があります。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              MeCab パーサープラグインのインストール後、<code class="literal">mecab_charset</code> ステータス変数を使用して、MeCab で使用される文字セットを表示できます。 MySQL バイナリで提供される 3 つの MeCab ディクショナリでは、次の文字セットがサポートされます。 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                  <code class="literal">ipadic_euc-jp</code> ディクショナリは、<code class="literal">ujis</code> および <code class="literal">eucjpms</code> 文字セットをサポートしています。
                </p></li><li class="listitem"><p>
                  <code class="literal">ipadic_sjis</code> ディクショナリは、<code class="literal">sjis</code> および <code class="literal">cp932</code> 文字セットをサポートしています。
                </p></li><li class="listitem"><p>
                  <code class="literal">ipadic_utf-8</code> ディクショナリは、<code class="literal">utf8</code> および <code class="literal">utf8mb4</code> 文字セットをサポートしています。
                </p></li></ul></div><p>
              <code class="literal">mecab_charset</code> では、最初にサポートされている文字セットのみがレポートされます。 たとえば、<code class="literal">ipadic_utf-8</code> ディクショナリは、<code class="literal">utf8</code> と <code class="literal">utf8mb4</code> の両方をサポートしています。このディクショナリが使用されている場合、<code class="literal">mecab_charset</code> は常に <code class="literal">utf8</code> をレポートします。 
            </p></div></li><li class="listitem"><p>
            MySQL を再開します。
          </p></li><li class="listitem"><p>
            MeCab パーサーのプラグインをインストールします:
          </p><p>
            MeCab パーサープラグインは、<code class="literal">INSTALL PLUGIN</code> 構文を使用してインストールされます。 プラグイン名は <code class="filename">mecab</code> で、共有ライブラリ名は <code class="filename">libpluginmecab.so</code> です。 プラグインのインストールの詳細は、<a class="xref" href="server-administration.html#plugin-loading" title="5.6.1 プラグインのインストールおよびアンインストール">セクション5.6.1「プラグインのインストールおよびアンインストール」</a> を参照してください。 
          </p><pre class="programlisting">INSTALL PLUGIN mecab SONAME 'libpluginmecab.so';
</pre><p>
            インストールされると、MeCab パーサープラグインは通常の MySQL の再起動のたびにロードされます。
          </p></li><li class="listitem"><p>
            <code class="literal">SHOW PLUGINS</code> ステートメントを使用して、MeCab パーサープラグインがロードされていることを確認します。
          </p><pre class="programlisting">mysql&gt; SHOW PLUGINS;</pre><p>
            <code class="literal">mecab</code> プラグインがプラグインのリストに表示されます。
          </p></li></ol></div><h4><a name="idm46041621542704"></a>MeCab パーサーを使用する FULLTEXT インデックスの作成</h4><p>
        mecab パーサーを使用する <code class="literal">FULLTEXT</code> インデックスを作成するには、<code class="literal">CREATE TABLE</code>、<code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> とともに <code class="literal">WITH PARSER ngram</code> を指定します。
      </p><p>
        この例では、<code class="literal">mecab</code> <code class="literal">FULLTEXT</code> インデックスを使用したテーブルの作成、サンプルデータの挿入および <code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE</code> テーブルでのトークン化されたデータの表示を示します:
      </p><pre class="programlisting">mysql&gt; USE test;

mysql&gt; CREATE TABLE articles (
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
      title VARCHAR(200),
      body TEXT,
      FULLTEXT (title,body) WITH PARSER mecab
    ) ENGINE=InnoDB CHARACTER SET utf8;

mysql&gt; SET NAMES utf8;

mysql&gt; INSERT INTO articles (title,body) VALUES
    ('データベース管理','このチュートリアルでは、私はどのようにデータベースを管理する方法を紹介します'),
    ('データベースアプリケーション開発','データベースアプリケーションを開発することを学ぶ');

mysql&gt; SET GLOBAL innodb_ft_aux_table="test/articles";

mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE ORDER BY doc_id, position;</pre><p>
        既存のテーブルに <code class="literal">FULLTEXT</code> インデックスを追加するには、<code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> を使用できます。 例: 
      </p><pre class="programlisting">CREATE TABLE articles (
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
      title VARCHAR(200),
      body TEXT
     ) ENGINE=InnoDB CHARACTER SET utf8;

ALTER TABLE articles ADD FULLTEXT INDEX ft_index (title,body) WITH PARSER mecab;

# Or:

CREATE FULLTEXT INDEX ft_index ON articles (title,body) WITH PARSER mecab;</pre><h4><a name="idm46041621526480"></a>MeCab パーサーの領域処理</h4><p>
        MeCab パーサーは、クエリー文字列のセパレータとして空白を使用します。 たとえば、MeCab パーサーは、<span lang="ja" class="phrase">「データベース管理」</span>を<span lang="ja" class="phrase">「データベース」</span>および<span lang="ja" class="phrase">「管理」</span>としてトークン化します。 
      </p><h4><a name="idm46041621522896"></a>MeCab パーサーのストップワード処理</h4><p>
        デフォルトでは、MeCab パーサーは、英語のストップワードの短いリストを含むデフォルトのストップワードリストを使用します。 日本語に適用可能なストップワードリストの場合は、独自のストップワードリストを作成する必要があります。 ストップワードリストの作成の詳細は、<a class="xref" href="functions.html#fulltext-stopwords" title="12.10.4 全文ストップワード">セクション12.10.4「全文ストップワード」</a> を参照してください。 
      </p><h4><a name="idm46041621520304"></a>MeCab パーサー用語検索</h4><p>
        自然言語モードの検索では、検索語はトークンの和集合に変換されます。 たとえば、<span lang="ja" class="phrase">「データベース管理」</span>は<span lang="ja" class="phrase">「データベース管理」</span>に変換されます。 
      </p><pre class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('データベース管理' IN NATURAL LANGUAGE MODE);</pre><p>
        ブールモード検索の場合、検索語は検索フレーズに変換されます。 たとえば、<span lang="ja" class="phrase">「データベース管理」</span>は<span lang="ja" class="phrase">「データベース管理」</span>に変換されます。 
      </p><pre class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('データベース管理' IN BOOLEAN MODE);</pre><h4><a name="idm46041621513200"></a>MeCab パーサーのワイルドカード検索</h4><p>
        ワイルドカード検索語はトークン化されません。 <span lang="ja" class="phrase">「データベース管理 *」</span>での検索は、接頭辞<span lang="ja" class="phrase">「データベース管理」</span>に対して実行されます。 
      </p><pre class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('データベース*' IN BOOLEAN MODE);</pre><h4><a name="idm46041621509264"></a>MeCab パーサーフレーズ検索</h4><p>
        フレーズはトークン化されます。 たとえば、<span lang="ja" class="phrase">「データベース管理」</span>は<span lang="ja" class="phrase">「データベース管理」</span>としてトークン化されます。 
      </p><pre class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('"データベース管理"' IN BOOLEAN MODE);</pre><h4><a name="install-mecab-binary"></a>バイナリ配布からの MeCab のインストール (オプション)</h4><p>
        このセクションでは、ネイティブパッケージ管理ユーティリティを使用してバイナリ配布から <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> をインストールする方法について説明します。 たとえば、Fedora では、Yum を使用してインストールを実行できます: 
      </p><pre class="programlisting">yum mecab-devel</pre><p>
        Debian または Ubuntu では、APT インストールを実行できます:
      </p><pre class="programlisting">apt-get install mecab
apt-get install mecab-ipadic</pre><h4><a name="build-mecab-from-source"></a>ソースからの MeCab のインストール (オプション)</h4><p>
        ソースから <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> をビルドする場合、基本的なインストールステップは次のとおりです。 詳細は、MeCab のドキュメントを参照してください。 
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> 用の tar.gz パッケージを <a class="ulink" href="http://taku910.github.io/mecab/#download" target="_top">http://taku910.github.io/mecab/#download</a> からダウンロードします。 2016 年 2 月現在、使用可能な最新のパッケージは <code class="filename">mecab-0.996.tar.gz</code> および <code class="filename">mecab-ipadic-2.7.0-20070801.tar.gz</code> です。 
          </p></li><li class="listitem"><p>
            <code class="filename">mecab</code> をインストールします:
          </p><pre class="programlisting">tar zxfv mecab-0.996.tar
cd mecab-0.996
./configure
make
make check
su
make install</pre></li><li class="listitem"><p>
            <code class="filename">mecab-ipadic</code> をインストールします:
          </p><pre class="programlisting">tar zxfv mecab-ipadic-2.7.0-20070801.tar
cd mecab-ipadic-2.7.0-20070801
./configure
make
su
make install</pre></li><li class="listitem"><p>
            <code class="option">WITH_MECAB</code> CMake オプションを使用して MySQL をコンパイルします。 <code class="filename">mecab</code> および <code class="filename">mecab-ipadic</code> をデフォルトの場所にインストールした場合は、<code class="option">WITH_MECAB</code> オプションを <code class="literal">system</code> に設定します。 
          </p><pre class="programlisting">-DWITH_MECAB=system</pre><p>
            カスタムインストールディレクトリを定義した場合は、<code class="option">WITH_MECAB</code> をカスタムディレクトリに設定します。 例: 
          </p><pre class="programlisting">-DWITH_MECAB=/path/to/mecab</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cast-functions"></a>12.11 キャスト関数と演算子</h2></div></div></div><a class="indexterm" name="idm46041621475808"></a><a class="indexterm" name="idm46041621474384"></a><a class="indexterm" name="idm46041621473024"></a><a class="indexterm" name="idm46041621470992"></a><a class="indexterm" name="idm46041621469632"></a><div class="table"><a name="idm46041621467600"></a><p class="title"><b>表 12.15 「キャスト関数および演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「キャスト関数および演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td>
<td>
      文字列をバイナリ文字列にキャストします
    </td>
</tr><tr><td><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></td>
<td>
      値を特定の型としてキャストします
    </td>
</tr><tr><td><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></td>
<td>
      値を特定の型としてキャストします
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      キャスト関数および演算子を使用すると、あるデータ型から別のデータ型に値を変換できます。
    </p><p>
      <code class="literal">USING</code> 句を含む <code class="literal">CONVERT()</code> は、文字セット間でデータを変換します:
    </p><pre class="programlisting">CONVERT(<em class="replaceable"><code>expr</code></em> USING <em class="replaceable"><code>transcoding_name</code></em>)
</pre><p>
      MySQL では、トランスコーディング名は対応する文字セット名と同じです。
    </p><p>
      例:
    </p><pre class="programlisting">SELECT CONVERT('test' USING utf8mb4);
SELECT CONVERT(_latin1'Müller' USING utf8mb4);
INSERT INTO utf8mb4_table (utf8mb4_column)
    SELECT CONVERT(latin1_column USING utf8mb4) FROM latin1_table;
</pre><p>
      文字セット間で文字列を変換するには、<code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>type</code></em>)</code> 構文 (<code class="literal">USING</code> なし) または <code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS <em class="replaceable"><code>type</code></em>)</code> も使用できます。これは同等です:
    </p><pre class="programlisting">CONVERT(<em class="replaceable"><code>string</code></em>, CHAR[(<em class="replaceable"><code>N</code></em>)] CHARACTER SET <em class="replaceable"><code>charset_name</code></em>)
CAST(<em class="replaceable"><code>string</code></em> AS CHAR[(<em class="replaceable"><code>N</code></em>)] CHARACTER SET <em class="replaceable"><code>charset_name</code></em>)
</pre><p>
      例:
    </p><pre class="programlisting">SELECT CONVERT('test', CHAR CHARACTER SET utf8mb4);
SELECT CAST('test' AS CHAR CHARACTER SET utf8mb4);
</pre><p>
      前述のように <code class="literal">CHARACTER SET <em class="replaceable"><code>charset_name</code></em></code> を指定した場合、結果の文字セットと照合順序は <em class="replaceable"><code>charset_name</code></em> および <em class="replaceable"><code>charset_name</code></em> のデフォルト照合順序になります。 <code class="literal">CHARACTER SET <em class="replaceable"><code>charset_name</code></em></code> を省略すると、結果の文字セットおよび照合順序は、デフォルトの接続文字セットおよび照合順序を決定する <code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数によって定義されます (<a class="xref" href="charset.html#charset-connection" title="10.4 接続文字セットおよび照合順序">セクション10.4「接続文字セットおよび照合順序」</a> を参照)。 
    </p><p>
      <code class="literal">COLLATE</code> 句は、<code class="literal">CONVERT()</code> または <code class="literal">CAST()</code> コール内では許可されませんが、関数の結果に適用できます。 たとえば、次の場合は有効です。 
    </p><pre class="programlisting">SELECT CONVERT('test' USING utf8mb4) COLLATE utf8mb4_bin;
SELECT CONVERT('test', CHAR CHARACTER SET utf8mb4) COLLATE utf8mb4_bin;
SELECT CAST('test' AS CHAR CHARACTER SET utf8mb4) COLLATE utf8mb4_bin;
</pre><p>
      ただし、これらは不正です:
    </p><pre class="programlisting">SELECT CONVERT('test' USING utf8mb4 COLLATE utf8mb4_bin);
SELECT CONVERT('test', CHAR CHARACTER SET utf8mb4 COLLATE utf8mb4_bin);
SELECT CAST('test' AS CHAR CHARACTER SET utf8mb4 COLLATE utf8mb4_bin);
</pre><p>
      通常、<code class="literal">BLOB</code> 値またはその他のバイナリ文字列は、大文字と小文字を区別しない方法で比較できません。バイナリ文字列では、大文字と小文字の概念と照合されない <code class="literal">binary</code> 文字セットが使用されるためです。 大/小文字を区別しない比較を実行するには、まず <code class="literal">CONVERT()</code> または <code class="literal">CAST()</code> 関数を使用して、値を非バイナリ文字列に変換します。 結果の文字列の比較では、その照合が使用されます。 たとえば、変換結果の照合で大/小文字が区別されない場合、<code class="literal">LIKE</code> 操作では大/小文字は区別されません。 これは、デフォルトの <code class="literal">utf8mb4</code> 照合 (<code class="literal">utf8mb4_0900_ai_ci</code>) では大/小文字が区別されないため、次の操作に当てはまります: 
    </p><pre class="programlisting">SELECT 'A' LIKE CONVERT(<em class="replaceable"><code>blob_col</code></em> USING utf8mb4)
  FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
      変換された文字列に特定の照合順序を指定するには、<code class="literal">CONVERT()</code> コールの後に <code class="literal">COLLATE</code> 句を使用します:
    </p><pre class="programlisting">SELECT 'A' LIKE CONVERT(<em class="replaceable"><code>blob_col</code></em> USING utf8mb4) COLLATE utf8mb4_unicode_ci
  FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
      別の文字セットを使用するには、前述のステートメントで <code class="literal">utf8mb4</code> の名前を置き換えます (別の照合順序を使用する場合と同様です)。
    </p><p>
      <code class="literal">CONVERT()</code> および <code class="literal">CAST()</code> は、異なる文字セットで表される文字列を比較するために、より一般的に使用できます。 たとえば、これらの文字列を比較すると、文字セットが異なるためエラーになります: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s1 = _latin1 'abc', @s2 = _latin2 'abc';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s1 = @s2;</code></strong>
ERROR 1267 (HY000): Illegal mix of collations (latin1_swedish_ci,IMPLICIT)
and (latin2_general_ci,IMPLICIT) for operation '='
</pre><p>
      いずれかの文字列を他の文字セットと互換性のある文字セットに変換すると、エラーなしで比較を実行できます:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @s1 = CONVERT(@s2 USING latin1);</code></strong>
+---------------------------------+
| @s1 = CONVERT(@s2 USING latin1) |
+---------------------------------+
|                               1 |
+---------------------------------+
</pre><p>
      文字列リテラルの場合、文字セットを指定する別の方法は、文字セットイントロデューサを使用することです。前述の例の<code class="literal">_latin1</code> および<code class="literal">_latin2</code> は、イントロデューサのインスタンスです。 文字列をある文字セットから別の文字セットに変換する <code class="literal">CAST()</code> や <code class="literal">CONVERT()</code> などの変換関数とは異なり、イントロデューサは文字列リテラルを特定の文字セットを持つものとして指定し、変換は必要ありません。 詳細は、<a class="xref" href="charset.html#charset-introducer" title="10.3.8 文字セットイントロデューサ">セクション10.3.8「文字セットイントロデューサ」</a>を参照してください。 
    </p><p>
      文字セット変換は、バイナリ文字列の大文字と小文字の変換の前にも役立ちます。 <code class="literal">LOWER()</code> および <code class="literal">UPPER()</code> は、大文字と小文字の概念が適用されないため、バイナリ文字列に直接適用すると無効になります。 バイナリ文字列の大文字と小文字の変換を実行するには、まず文字列に格納されているデータに適した文字セットを使用して、非バイナリ文字列に変換します: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING utf8mb4));</code></strong>
+-------------+------------------------------------+
| LOWER(@str) | LOWER(CONVERT(@str USING utf8mb4)) |
+-------------+------------------------------------+
| New York    | new york                           |
+-------------+------------------------------------+
</pre><p>
      <code class="literal">BINARY</code>、<code class="literal">CAST()</code> または <code class="literal">CONVERT()</code> を使用してインデックス付けされたカラムを変換すると、MySQL でインデックスを効率的に使用できない場合があることに注意してください。
    </p><p>
      キャスト関数は、<code class="literal">CREATE TABLE ... SELECT</code> ステートメントで特定の型のカラムを作成する場合に役立ちます:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE new_table SELECT CAST('2000-01-01' AS DATE) AS c1;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE new_table\G</code></strong>
*************************** 1. row ***************************
       Table: new_table
Create Table: CREATE TABLE `new_table` (
  `c1` date DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
</pre><p>
      キャスト関数は、<code class="literal">ENUM</code> カラムを字句順にソートする場合に役立ちます。 通常、<code class="literal">ENUM</code> カラムのソートは、内部数値を使用して実行されます。 値を <code class="literal">CHAR</code> にキャストすると、語彙順にソートされます。 
    </p><pre class="programlisting">SELECT <em class="replaceable"><code>enum_col</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> ORDER BY CAST(<em class="replaceable"><code>enum_col</code></em> AS CHAR);
</pre><p>
      <code class="literal">CONCAT('Date: ',CAST(NOW() AS DATE))</code> のように、より複雑な式の一部として使用する場合でも、<code class="literal">CAST()</code> の結果が変わります。
    </p><p>
      時間値の場合、<code class="literal">CAST()</code> を使用して様々な形式でデータを抽出する必要はほとんどありません。 かわりに、<code class="literal">EXTRACT()</code>、<code class="literal">DATE_FORMAT()</code>、<code class="literal">TIME_FORMAT()</code> などの関数を使用してください。 <a class="xref" href="functions.html#date-and-time-functions" title="12.7 日付および時間関数">セクション12.7「日付および時間関数」</a>を参照してください。 
    </p><p>
      文字列を数値にキャストするには、通常、数値コンテキストで文字列値を使用するだけで十分です:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1+'1';</code></strong>
       -&gt; 2
</pre><p>
      これは、16 進数リテラルおよびビットリテラル (デフォルトではバイナリ文字列) にも当てはまります:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT X'41', X'41'+0;</code></strong>
        -&gt; 'A', 65
mysql&gt; <strong class="userinput"><code>SELECT b'1100001', b'1100001'+0;</code></strong>
        -&gt; 'a', 97
</pre><p>
      算術演算で使用される文字列は、式の評価時に浮動小数点数に変換されます。
    </p><p>
      文字列コンテキストで使用される数値は文字列に変換されます:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONCAT('hello you ',2);</code></strong>
        -&gt; 'hello you 2'
</pre><p>
      数字から文字列への暗黙的な変換については、<a class="xref" href="functions.html#type-conversion" title="12.3 式評価での型変換">セクション12.3「式評価での型変換」</a>を参照してください。
    </p><p>
      MySQL では、符号付きと符号なしの両方の 64 ビット値を使用した演算がサポートされています。 オペランドのいずれかが符号なし整数である数値演算子 (<code class="literal">+</code> や <code class="literal">-</code> など) の場合、結果はデフォルトで符号なしになります (<a class="xref" href="functions.html#arithmetic-functions" title="12.6.1 算術演算子">セクション12.6.1「算術演算子」</a> を参照)。 これをオーバーライドするには、<code class="literal">SIGNED</code> または <code class="literal">UNSIGNED</code> キャスト演算子を使用して、それぞれ符号付きまたは符号なし 64 ビット整数に値をキャストします。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 - 2;</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT CAST(1 - 2 AS UNSIGNED);</code></strong>
        -&gt; 18446744073709551615
mysql&gt; <strong class="userinput"><code>SELECT CAST(CAST(1 - 2 AS UNSIGNED) AS SIGNED);</code></strong>
        -&gt; -1
</pre><p>
      オペランドのいずれかが浮動小数点値である場合は、結果が浮動小数点値になり、上記のルールによる影響を受けません。 (このコンテキストでは、<code class="literal">DECIMAL</code> カラム値は浮動小数点値とみなされます。) 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CAST(1 AS UNSIGNED) - 2.0;</code></strong>
        -&gt; -1.0
</pre><p>
      SQL モードは、変換操作の結果に影響します (<a class="xref" href="server-administration.html#sql-mode" title="5.1.11 サーバー SQL モード">セクション5.1.11「サーバー SQL モード」</a> を参照)。 例: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="quote">「<span class="quote">「ゼロ」</span>」</span>の日付文字列を日付に変換する場合、<code class="literal">CONVERT()</code> および <code class="literal">CAST()</code> は <code class="literal">NULL</code> を返し、<code class="literal">NO_ZERO_DATE</code> SQL モードが有効なときに警告を生成します。
        </p></li><li class="listitem"><p>
          整数の減算では、<code class="literal">NO_UNSIGNED_SUBTRACTION</code> SQL モードが有効になっている場合は、オペランドのいずれかが符号なしでも、結果が符号付きになります。
        </p></li></ul></div><p>
      次のリストでは、使用可能なキャスト関数および演算子について説明します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_binary"></a><p>
          <code class="literal">BINARY</code> <em class="replaceable"><code>expr</code></em>
        </p><a class="indexterm" name="idm46041621328352"></a><p>
          <code class="literal">BINARY</code> 演算子は、式をバイナリ文字列 (<code class="literal">binary</code> 文字セットおよび <code class="literal">binary</code> 照合順序を持つ文字列) に変換します。 <code class="literal">BINARY</code> の一般的な用途は、文字単位ではなく数値バイト値を使用して、文字列をバイト単位で強制的に比較することです。 <code class="literal">BINARY</code> 演算子を使用すると、比較の末尾の空白も意味を持ちます。 <code class="literal">binary</code> 文字セットの <code class="literal">binary</code> 照合順序と非バイナリ文字セットの<code class="literal">_bin</code> 照合順序の違いについては、<a class="xref" href="charset.html#charset-binary-collations" title="10.8.5 バイナリ照合順序と_bin 照合順序">セクション10.8.5「バイナリ照合順序と_bin 照合順序」</a> を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'A';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT BINARY 'a' = 'A';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'a ';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT BINARY 'a' = 'a ';</code></strong>
        -&gt; 0
</pre><p>
          比較時に、<code class="literal">BINARY</code> によって演算全体が影響を受けます。これは、同じ結果を持ついずれかのオペランドの前に指定できます。
        </p><p>
          文字列式をバイナリ文字列に変換する場合、次の構造体は同等です:
        </p><pre class="programlisting">CAST(<em class="replaceable"><code>expr</code></em> AS BINARY)
CONVERT(<em class="replaceable"><code>expr</code></em> USING BINARY)
BINARY <em class="replaceable"><code>expr</code></em>
</pre><p>
          値が文字列リテラルの場合は、<code class="literal">_binary</code> 文字セットイントロデューサを使用して、変換せずにバイナリ文字列として指定できます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'A';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT _binary 'a' = 'A';</code></strong>
        -&gt; 0
</pre><p>
          イントロデューサについては、<a class="xref" href="charset.html#charset-introducer" title="10.3.8 文字セットイントロデューサ">セクション10.3.8「文字セットイントロデューサ」</a> を参照してください。
        </p><p>
          式の <code class="literal">BINARY</code> 演算子は、文字カラム定義の <code class="literal">BINARY</code> 属性とは異なります。 <code class="literal">BINARY</code> 属性で定義された文字列の場合、MySQL は、テーブルのデフォルトの文字セットと、その文字セットのバイナリ (<code class="literal">_bin</code>) 照合順序を割り当てます。 すべての非バイナリ文字セットには、<code class="literal">_bin</code> 照合順序があります。 たとえば、テーブルのデフォルトの文字セットが <code class="literal">utf8mb4</code> の場合、次の 2 つのカラム定義は同等です: 
        </p><pre class="programlisting">CHAR(10) BINARY
CHAR(10) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin
</pre><p>
          <code class="literal">CHAR</code>、<code class="literal">VARCHAR</code> または <code class="literal">TEXT</code> カラムの定義で <code class="literal">CHARACTER SET binary</code> を使用すると、カラムは対応するバイナリ文字列データ型として扱われます。 たとえば、次のペアになった定義は同等です。 
        </p><pre class="programlisting">CHAR(10) CHARACTER SET binary
BINARY(10)

VARCHAR(10) CHARACTER SET binary
VARBINARY(10)

TEXT CHARACTER SET binary
BLOB
</pre></li><li class="listitem"><a name="function_cast"></a><p>
          <code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS <em class="replaceable"><code>type</code></em> [ARRAY])</code>
        </p><p>
          <code class="literal">CAST(<em class="replaceable"><code>timestamp_value</code></em> AT TIME ZONE <em class="replaceable"><code>timezone_specifier</code></em> AS DATETIME[(<em class="replaceable"><code>precision</code></em>)])</code>
        </p><p>
          <em class="replaceable"><code>timezone_specifier</code></em>: [INTERVAL] '+00:00' | 'UTC'
        </p><a class="indexterm" name="idm46041621281952"></a><p>
          <code class="literal">CAST()</code> 関数は、任意の型の式を受け取り、<code class="literal">CONVERT()</code> と同様に、指定された型の結果値を生成します。 詳細は、<code class="literal">CONVERT()</code> の説明を参照してください。 
        </p><p>
          MySQL 8.0.17 以上では、<code class="literal">InnoDB</code> を使用して、<code class="literal">CREATE INDEX</code>、<code class="literal">CREATE TABLE</code> および <code class="literal">ALTER TABLE</code> ステートメントの一部として追加 <code class="literal">ARRAY</code> キーワードを使用して、<code class="literal">JSON</code> 配列に複数値インデックスを作成できます。 これらのステートメントのいずれかで複数値インデックスを作成するために使用する場合を除き、<code class="literal">ARRAY</code> はサポートされていません。この場合は、複数値インデックスが必要です。 インデックス付けするカラムは、<code class="literal">JSON</code> 型のカラムである必要があります。 <code class="literal">ARRAY</code> では、<code class="literal">AS</code> キーワードの後に続く <em class="replaceable"><code>type</code></em> は、<code class="literal">BINARY</code>、<code class="literal">JSON</code> および <code class="literal">YEAR</code> を除き、<code class="literal">CAST()</code> でサポートされている任意のタイプを指定できます。 構文情報と例、およびその他の関連情報については、<a class="xref" href="sql-statements.html#create-index-multi-valued" title="複数値インデックス">複数値インデックス</a> を参照してください。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">CAST()</code> とは異なり、<code class="literal">CONVERT()</code> では複数値インデックスの作成または <code class="literal">ARRAY</code> キーワードはサポートされていません。
          </p></div><p>
          MySQL 8.0.22 以降、<code class="literal">CAST()</code> では <code class="literal">AT TIMEZONE</code> 演算子を使用した UTC としての <code class="literal">TIMESTAMP</code> 値の取得がサポートされています。 サポートされているタイムゾーンは UTC のみです。これは、<code class="literal">'+00:00'</code>または<code class="literal">'UTC'</code>のいずれかとして指定できます。 この構文でサポートされている唯一の戻り型は <code class="literal">DATETIME</code> で、0 から 6 の範囲のオプションの精度指定子があります。 
        </p><p>
          タイムゾーンオフセットを使用する <code class="literal">TIMESTAMP</code> 値もサポートされています。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @@system_time_zone;</code></strong>
+--------------------+
| @@system_time_zone |
+--------------------+
| EDT                |
+--------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE TZ (c TIMESTAMP);</code></strong>
Query OK, 0 rows affected (0.41 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO tz VALUES</code></strong>
     &gt;     <strong class="userinput"><code>ROW(CURRENT_TIMESTAMP),</code></strong>
     &gt;     <strong class="userinput"><code>ROW('2020-07-28 14:50:15+1:00');</code></strong>
Query OK, 1 row affected (0.08 sec)

mysql&gt; <strong class="userinput"><code>TABLE tz;</code></strong>
+---------------------+
| c                   |
+---------------------+
| 2020-07-28 09:22:41 |
| 2020-07-28 09:50:15 |
+---------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT CAST(c AT TIME ZONE '+00:00' AS DATETIME) AS u FROM tz;</code></strong>
+---------------------+
| u                   |
+---------------------+
| 2020-07-28 13:22:41 |
| 2020-07-28 13:50:15 |
+---------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT CAST(c AT TIME ZONE 'UTC' AS DATETIME(2)) AS u FROM tz;</code></strong>
+------------------------+
| u                      |
+------------------------+
| 2020-07-28 13:22:41.00 |
| 2020-07-28 13:50:15.00 |
+------------------------+
2 rows in set (0.00 sec)
</pre><p>
          この形式の <code class="literal">CAST()</code> で<code class="literal">'UTC'</code>をタイムゾーン指定子として使用し、サーバーで<span class="errortext">「不明または不正なタイムゾーン: 'UTC'」</span>などのエラーが発生した場合は、MySQL タイムゾーンテーブルのインストールが必要になることがあります (<a class="xref" href="server-administration.html#time-zone-installation" title="タイムゾーンテーブルへの移入">タイムゾーンテーブルへの移入</a> を参照)。
        </p><p>
          <code class="literal">AT TIME ZONE</code> では <code class="literal">ARRAY</code> キーワードはサポートされておらず、<code class="literal">CONVERT()</code> 関数ではサポートされていません。
        </p></li><li class="listitem"><a name="function_convert"></a><p>
          <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em> USING <em class="replaceable"><code>transcoding_name</code></em>)</code>, <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>type</code></em>)</code>
        </p><a class="indexterm" name="idm46041621228640"></a><p>
          <code class="literal">CONVERT()</code> 関数は、任意の型の式を受け取り、指定された型の結果値を生成します。
        </p><p>
          <code class="literal">CONVERT(... USING ...)</code> は標準の SQL 構文です。 <code class="literal">USING</code> 形式以外の <code class="literal">CONVERT()</code> は ODBC の構文です。 
        </p><p>
          <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em> USING <em class="replaceable"><code>transcoding_name</code></em>)</code> は、異なる文字セット間でデータを変換します。 MySQL では、トランスコーディング名は対応する文字セット名と同じです。 たとえば、次のステートメントは、デフォルト文字セットの文字列<code class="literal">'abc'</code>を <code class="literal">utf8mb4</code> 文字セットの対応する文字列に変換します: 
        </p><pre class="programlisting">SELECT CONVERT('abc' USING utf8mb4);
</pre><p>
          <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>type</code></em>)</code> 構文 (<code class="literal">USING</code> を使用しない) では、結果タイプを指定する式および <em class="replaceable"><code>type</code></em> 値を使用します。 この操作は、同等の <code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS <em class="replaceable"><code>type</code></em>)</code> として表現することもできます。 次の <em class="replaceable"><code>type</code></em> 値を使用できます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">BINARY[(<em class="replaceable"><code>N</code></em>)]</code>
            </p><p>
              <code class="literal">BINARY</code> データ型の文字列を生成します。 これが比較に与える影響の詳細は、<a class="xref" href="data-types.html#binary-varbinary" title="11.3.3 BINARY および VARBINARY 型">セクション11.3.3「BINARY および VARBINARY 型」</a> を参照してください。 オプションの長さ <em class="replaceable"><code>N</code></em> が指定されている場合に、<code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code> を使用すると、キャストで <em class="replaceable"><code>N</code></em> バイトの引数しか使用されなくなります。 値が <em class="replaceable"><code>N</code></em> バイトよりも短い場合は、<em class="replaceable"><code>N</code></em> の長さになるまで <code class="literal">0x00</code> バイトでパディングされます。 
            </p></li><li class="listitem"><p>
              <code class="literal">CHAR[(<em class="replaceable"><code>N</code></em>)] [<em class="replaceable"><code>charset_info</code></em>]</code>
            </p><p>
              <code class="literal">CHAR</code> データ型の文字列を生成します。 オプションの長さの <em class="replaceable"><code>N</code></em> が指定されている場合、<code class="literal">CHAR(<em class="replaceable"><code>N</code></em>)</code> はキャストで引数の <em class="replaceable"><code>N</code></em> 文字以下を使用します。 <em class="replaceable"><code>N</code></em> 文字より短い値にはパディングは行われません。 
            </p><p>
              <em class="replaceable"><code>charset_info</code></em> 句を指定しない場合、<code class="literal">CHAR</code> はデフォルトの文字セットを使用して文字列を生成します。 文字セットを明示的に指定するには、次の <em class="replaceable"><code>charset_info</code></em> 値を使用できます: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">CHARACTER SET <em class="replaceable"><code>charset_name</code></em></code>: 指定された文字セットを持つ文字列を生成します。
                </p></li><li class="listitem"><p>
                  <code class="literal">ASCII</code>: <code class="literal">CHARACTER SET latin1</code> の短縮形。
                </p></li><li class="listitem"><p>
                  <code class="literal">UNICODE</code>: <code class="literal">CHARACTER SET ucs2</code> の短縮形。
                </p></li></ul></div><p>
              いずれの場合も、文字列にはデフォルトの照合順序が設定されます。
            </p></li><li class="listitem"><p>
              <code class="literal">DATE</code>
            </p><p>
              <code class="literal">DATE</code> 値を生成します。
            </p></li><li class="listitem"><p>
              <code class="literal">DATETIME</code>
            </p><p>
              <code class="literal">DATETIME</code> 値を生成します。
            </p></li><li class="listitem"><p>
              <code class="literal">DECIMAL[(<em class="replaceable"><code>M</code></em>[,<em class="replaceable"><code>D</code></em>])]</code>
            </p><p>
              <code class="literal">DECIMAL</code> 値を生成します。 オプションの <em class="replaceable"><code>M</code></em> および <em class="replaceable"><code>D</code></em> 値が指定されている場合は、小数点以下の最大桁数 (精度) と桁数 (スケール) を指定します。 
            </p></li><li class="listitem"><p>
              <code class="literal">DOUBLE</code>
            </p><p>
              <code class="literal">DOUBLE</code> 結果を生成します。 MySQL 8.0.17 で追加されました。 
            </p></li><li class="listitem"><p>
              <code class="literal">FLOAT[(<em class="replaceable"><code>p</code></em>)]</code>
            </p><p>
              精度 <em class="replaceable"><code>p</code></em> が指定されていない場合、<code class="literal">FLOAT</code> 型の結果が生成されます。 <em class="replaceable"><code>p</code></em> が指定され、0 &lt;= &lt; <em class="replaceable"><code>p</code></em> &lt;= 24 の場合、結果のタイプは <code class="literal">FLOAT</code> になります。 25 &lt;= <em class="replaceable"><code>p</code></em> &lt;= 53 の場合、結果のタイプは <code class="literal">DOUBLE</code> です。 <em class="replaceable"><code>p</code></em> &lt; 0 または <em class="replaceable"><code>p</code></em> &gt; 53 の場合、エラーが返されます。 MySQL 8.0.17 で追加されました。 
            </p></li><li class="listitem"><p>
              <code class="literal">JSON</code>
            </p><p>
              <code class="literal">JSON</code> 値を生成します。 <code class="literal">JSON</code> と他のタイプ間の値変換のルールの詳細は、<a class="xref" href="data-types.html#json-comparison" title="JSON 値の比較および順序付け">JSON 値の比較および順序付け</a> を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">NCHAR[(<em class="replaceable"><code>N</code></em>)]</code>
            </p><p>
              <code class="literal">CHAR</code> と似ていますが、各国語文字セットの文字列を生成します。 <a class="xref" href="charset.html#charset-national" title="10.3.7 各国語文字セット">セクション10.3.7「各国語文字セット」</a>を参照してください。 
            </p><p>
              <code class="literal">CHAR</code> とは異なり、<code class="literal">NCHAR</code> では後続の文字セット情報を指定できません。
            </p></li><li class="listitem"><p>
              <code class="literal">REAL</code>
            </p><p>
              <code class="literal">REAL</code> タイプの結果を生成します。 <code class="literal">REAL_AS_FLOAT</code> SQL モードが有効な場合、これは実際には <code class="literal">FLOAT</code> です。それ以外の場合、結果のタイプは <code class="literal">DOUBLE</code> になります。 
            </p></li><li class="listitem"><p>
              <code class="literal">SIGNED [INTEGER]</code>
            </p><p>
              符号付き整数値を生成します。
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>spatial_type</code></em>
            </p><p>
              MySQL 8.0.24 では、<code class="literal">CAST()</code> および <code class="literal">CONVERT()</code> は、空間型の特定の組合せに対して、ある空間型から別の空間型へのジオメトリ値のキャストをサポートしています。 次のリストに、許可されているタイプの組合せを示します。ここで、<span class="quote">「<span class="quote">MySQL 拡張機能</span>」</span>は、<a class="link" href="data-types.html#spatial-types" title="11.4 空間データ型">SQL/MM standard</a> で定義されているもの以外に、MySQL で実装されているキャストを指定します: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">Point</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">MultiPoint</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">LineString</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">Polygon</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiPoint</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiLineString</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">Polygon</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">LineString</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiLineString</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiPolygon</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">MultiPoint</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">Point</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">LineString</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">MultiLineString</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">LineString</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">Polygon</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiPolygon</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">MultiPolygon</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">Polygon</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiLineString</code> (MySQL 拡張機能)
                    </p></li><li class="listitem"><p>
                      <code class="literal">GeometryCollection</code>
                    </p></li></ul></div></li><li class="listitem"><p>
                  <code class="literal">GeometryCollection</code> から次の操作を行います:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      <code class="literal">Point</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">LineString</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">Polygon</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiPoint</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiLineString</code>
                    </p></li><li class="listitem"><p>
                      <code class="literal">MultiPolygon</code>
                    </p></li></ul></div></li></ul></div><p>
              空間キャストでは、<code class="literal">GeometryCollection</code> と <code class="literal">GeomCollection</code> は同じ結果タイプのシノニムです。
            </p><p>
              一部の条件はすべての空間型キャストに適用され、一部の条件はキャスト結果が特定の空間型を持つ場合にのみ適用されます。 <span class="quote">「<span class="quote">「整形式のジオメトリ、」</span>」</span>などの用語の詳細は、<a class="xref" href="data-types.html#geometry-well-formedness-validity" title="11.4.4 ジオメトリの整形式と妥当性">セクション11.4.4「ジオメトリの整形式と妥当性」</a> を参照してください。 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-general-conditions" title="空間キャストの一般的な条件">空間キャストの一般的な条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-point-conditions" title="ポイントへのキャストの条件">ポイントへのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-linestring-conditions" title="LineString へのキャストの条件">LineString へのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-polygon-conditions" title="ポリゴンへのキャストの条件">ポリゴンへのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-multipoint-conditions" title="MultiPoint へのキャストの条件">MultiPoint へのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-multilinestring-conditions" title="MultiLineString へのキャストの条件">MultiLineString へのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-multipolygon-conditions" title="MultiPolygon へのキャストの条件">MultiPolygon へのキャストの条件</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#spatial-cast-geometrycollection-conditions" title="GeometryCollection へのキャストの条件">GeometryCollection へのキャストの条件</a></p></li></ul></div><h3><a name="spatial-cast-general-conditions"></a>空間キャストの一般的な条件</h3><p>
              次の条件は、結果の型に関係なく、すべての空間キャストに適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストの結果は、キャストする式の SRS と同じ SRS になります。
                </p></li><li class="listitem"><p>
                  空間型間のキャストでは、座標値または順序は変更されません。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">NULL</code> の場合、関数の結果は <code class="literal">NULL</code> です。
                </p></li><li class="listitem"><p>
                  空間型を指定する <code class="literal">RETURNING</code> 句とともに <code class="literal">JSON_VALUE()</code> 関数を使用して空間型にキャストすることはできません。
                </p></li><li class="listitem"><p>
                  空間型の <code class="literal">ARRAY</code> へのキャストは許可されません。
                </p></li><li class="listitem"><p>
                  空間型の組合せが許可されているが、キャストする式が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
                </p></li><li class="listitem"><p>
                  空間型の組合せが許可されているが、キャストする式が未定義の空間参照システム (SRS) 内の構文的に整形されたジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
                </p></li><li class="listitem"><p>
                  キャストする式に地理 SRS があり、経度または緯度が範囲外の場合は、エラーが発生します:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      経度の値が (−180, 180]の範囲にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します。
                    </p></li><li class="listitem"><p>
                      緯度の値が[−90, 90]の範囲にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します。
                    </p></li></ul></div><p>
                  表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
                </p></li></ul></div><h3><a name="spatial-cast-point-conditions"></a>ポイントへのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">Point</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式が <code class="literal">Point</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Point</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が単一の <code class="literal">Point</code> を含む <code class="literal">MultiPoint</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Point</code> になります。 式に複数の <code class="literal">Point</code> が含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が、単一の <code class="literal">Point</code> のみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Point</code> になります。 式が空の場合、複数の <code class="literal">Point</code> が含まれている場合、または他のジオメトリタイプが含まれている場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Point</code>, <code class="literal">MultiPoint</code>, <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-linestring-conditions"></a>LineString へのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">LineString</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">LineString</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が、内部リングを持たない <code class="literal">Polygon</code> 型の整形式ジオメトリである場合、関数の結果は、外部リングの点を同じ順序で含む <code class="literal">LineString</code> になります。 式に内部リングがある場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が、少なくとも 2 つの点を含む <code class="literal">MultiPoint</code> 型の整形式ジオメトリである場合、関数の結果は、式に出現する順序で <code class="literal">MultiPoint</code> の点を含む <code class="literal">LineString</code> になります。 式に <code class="literal">Point</code> が 1 つしか含まれていない場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が単一の <code class="literal">LineString</code> を含む <code class="literal">MultiLineString</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">LineString</code> になります。 式に複数の <code class="literal">LineString</code> が含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が、単一の <code class="literal">LineString</code> のみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">LineString</code> になります。 式が空の場合、複数の <code class="literal">LineString</code> が含まれている場合、または他のジオメトリタイプが含まれている場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code>, <code class="literal">Polygon</code>, <code class="literal">MultiPoint</code>, <code class="literal">MultiLineString</code> または <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-polygon-conditions"></a>ポリゴンへのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">Polygon</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式がリングである (つまり、開始点と終了点が同じである) <code class="literal">LineString</code> 型の整形式ジオメトリである場合、関数の結果は、同じ順序の <code class="literal">LineString</code> の点で構成される外部リングを持つ <code class="literal">Polygon</code> になります。 式がリングでない場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 リングの順序が正しくない場合 (外側のリングは反時計回りである必要があります)、<code class="literal">ER_INVALID_CAST_POLYGON_RING_DIRECTION</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Polygon</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Polygon</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が、すべての要素がリングである <code class="literal">MultiLineString</code> 型の整形式ジオメトリである場合、関数の結果は、最初の <code class="literal">LineString</code> が外側のリングとして、追加の <code class="literal">LineString</code> 値が内側のリングとして含まれる <code class="literal">Polygon</code> になります。 式のいずれかの要素がリングでない場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 正しい順序でないリングがある場合 (外側のリングは反時計回り、内側のリングは時計回りである必要があります)、<code class="literal">ER_INVALID_CAST_POLYGON_RING_DIRECTION</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が単一の <code class="literal">Polygon</code> を含む <code class="literal">MultiPolygon</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Polygon</code> になります。 式に複数の <code class="literal">Polygon</code> が含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が、単一の <code class="literal">Polygon</code> のみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">Polygon</code> になります。 式が空の場合、複数の <code class="literal">Polygon</code> が含まれている場合、または他のジオメトリタイプが含まれている場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code>, <code class="literal">Polygon</code>, <code class="literal">MultiLineString</code>, <code class="literal">MultiPolygon</code> または <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-multipoint-conditions"></a>MultiPoint へのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">MultiPoint</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式が <code class="literal">Point</code> 型の整形式のジオメトリである場合、関数の結果はその <code class="literal">Point</code> を唯一の要素として含む <code class="literal">MultiPoint</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code> 型の整形式ジオメトリである場合、関数の結果は <code class="literal">LineString</code> の点を同じ順序で含む <code class="literal">MultiPoint</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiPoint</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">MultiPoint</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が、点のみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はこれらの点を含む <code class="literal">MultiPoint</code> になります。 <code class="literal">GeometryCollection</code> が空であるか、他のジオメトリタイプが含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Point</code>, <code class="literal">LineString</code>, <code class="literal">MultiPoint</code> または <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-multilinestring-conditions"></a>MultiLineString へのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">MultiLineString</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code> 型の整形式のジオメトリである場合、関数の結果はその <code class="literal">LineString</code> を唯一の要素として含む <code class="literal">MultiLineString</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Polygon</code> 型の整形式ジオメトリである場合、関数の結果は、<code class="literal">Polygon</code> の外側のリングが最初の要素として含まれ、内側のリングが式に出現する順序で追加の要素として含まれる <code class="literal">MultiLineString</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiLineString</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">MultiLineString</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が、内部リングのないポリゴンのみを含む <code class="literal">MultiPolygon</code> 型の整形式ジオメトリである場合、関数の結果は、式に出現する順序でポリゴンのリングを含む <code class="literal">MultiLineString</code> になります。 式に内部リングを持つポリゴンが含まれている場合は、<code class="literal">ER_WRONG_PARAMETERS_TO_STORED_FCT</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が linestring のみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はこれらの linestring を含む <code class="literal">MultiLineString</code> になります。 式が空であるか、他のジオメトリタイプが含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code>, <code class="literal">Polygon</code>, <code class="literal">MultiLineString</code>, <code class="literal">MultiPolygon</code> または <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-multipolygon-conditions"></a>MultiPolygon へのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">MultiPolygon</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  キャストする式が <code class="literal">Polygon</code> 型の整形式のジオメトリである場合、関数の結果は、その唯一の要素として <code class="literal">Polygon</code> を含む <code class="literal">MultiPolygon</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が、すべての要素がリングである <code class="literal">MultiLineString</code> 型の整形式ジオメトリである場合、関数の結果は、式の各要素の外側のリングのみを含む <code class="literal">Polygon</code> を含む <code class="literal">MultiPolygon</code> になります。 いずれかの要素がリングでない場合は、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 正しい順序でないリングがある場合 (外側のリングは反時計回りである必要があります)、<code class="literal">ER_INVALID_CAST_POLYGON_RING_DIRECTION</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiPolygon</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">MultiPolygon</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式がポリゴンのみを含む <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はそれらのポリゴンを含む <code class="literal">MultiPolygon</code> になります。 式が空であるか、他のジオメトリタイプが含まれている場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。 
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Polygon</code>, <code class="literal">MultiLineString</code>, <code class="literal">MultiPolygon</code> または <code class="literal">GeometryCollection</code> 以外の型の整形式ジオメトリである場合、<code class="literal">ER_INVALID_CAST_TO_GEOMETRY</code> エラーが発生します。
                </p></li></ul></div><h3><a name="spatial-cast-geometrycollection-conditions"></a>GeometryCollection へのキャストの条件</h3><p>
              キャスト結果タイプが <code class="literal">GeometryCollection</code> の場合は、次の条件が適用されます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">GeometryCollection</code> と <code class="literal">GeomCollection</code> は、同じ結果タイプのシノニムです。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Point</code> 型の整形式のジオメトリである場合、関数の結果はその <code class="literal">Point</code> を唯一の要素として含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">LineString</code> 型の整形式のジオメトリである場合、関数の結果はその <code class="literal">LineString</code> を唯一の要素として含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">Polygon</code> 型の整形式のジオメトリである場合、関数の結果はその <code class="literal">Polygon</code> を唯一の要素として含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiPoint</code> 型の整形式ジオメトリである場合、関数の結果は、式に出現する順序で点を含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiLineString</code> 型の整形式ジオメトリである場合、関数の結果は、式に出現する順序で linestring を含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">MultiPolygon</code> 型の整形式ジオメトリである場合、関数の結果は、式に出現する順序で <code class="literal">MultiPolygon</code> の要素を含む <code class="literal">GeometryCollection</code> になります。
                </p></li><li class="listitem"><p>
                  キャストする式が <code class="literal">GeometryCollection</code> 型の整形式ジオメトリである場合、関数の結果はその <code class="literal">GeometryCollection</code> になります。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">TIME</code>
            </p><p>
              <code class="literal">TIME</code> 値を生成します。
            </p></li><li class="listitem"><p>
              <code class="literal">UNSIGNED [INTEGER]</code>
            </p><p>
              符号なし整数値を生成します。
            </p></li><li class="listitem"><p>
              <code class="literal">YEAR</code>
            </p><p>
              <code class="literal">YEAR</code> 値を生成します。 MySQL 8.0.22 で追加されました。 <code class="literal">YEAR</code> への変換は、次のルールによって制御されます: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  1901-2155 の範囲の 4 桁の数値の場合、またはこの範囲の 4 桁の数値として解釈できる文字列の場合は、対応する <code class="literal">YEAR</code> 値を返します。
                </p></li><li class="listitem"><p>
                  1 桁または 2 桁で構成される数値の場合、またはこのような数値としてインターペットできる文字列の場合、次のように <code class="literal">YEAR</code> 値を返します:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      数値が 1-69 の範囲内にある場合は、2000 を加算して合計を返します。
                    </p></li><li class="listitem"><p>
                      数値が 70-99 の範囲内にある場合は、1900 を加算して合計を返します。
                    </p></li></ul></div></li><li class="listitem"><p>
                  0 と評価される文字列の場合、2000 を返します。
                </p></li><li class="listitem"><p>
                  数値 0 の場合は 0 を返します。
                </p></li><li class="listitem"><p>
                  <code class="literal">DATE</code>、<code class="literal">DATETIME</code> または <code class="literal">TIMESTAMP</code> 値の場合、値の <code class="literal">YEAR</code> 部分を返します。 <code class="literal">TIME</code> 値の場合、現在の年を返します。 
                </p><p>
                  <code class="literal">TIME</code> 引数の型を指定しない場合、次に示すように、予期したものとは異なる結果が得られる可能性があります:
                </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONVERT("11:35:00", YEAR), CONVERT(TIME "11:35:00", YEAR);</code></strong>
+---------------------------+--------------------------------+
| CONVERT("11:35:00", YEAR) | CONVERT(TIME "11:35:00", YEAR) |
+---------------------------+--------------------------------+
|                      2011 |                           2020 |
+---------------------------+--------------------------------+
</pre></li><li class="listitem"><p>
                  引数の型が <code class="literal">DECIMAL</code>, <code class="literal">DOUBLE</code>, <code class="literal">DECIMAL</code> または <code class="literal">REAL</code> の場合、次に示すように、値を最も近い整数に丸めてから、整数値のルールを使用して値を <code class="literal">YEAR</code> にキャストしようとします:
                </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONVERT(1944.35, YEAR), CONVERT(1944.50, YEAR);</code></strong>
+------------------------+------------------------+
| CONVERT(1944.35, YEAR) | CONVERT(1944.50, YEAR) |
+------------------------+------------------------+
|                   1944 |                   1945 |
+------------------------+------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT CONVERT(66.35, YEAR), CONVERT(66.50, YEAR);</code></strong>
+----------------------+----------------------+
| CONVERT(66.35, YEAR) | CONVERT(66.50, YEAR) |
+----------------------+----------------------+
|                 2066 |                 2067 |
+----------------------+----------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
                  <code class="literal">GEOMETRY</code> 型の引数は、<code class="literal">YEAR</code> に変換できません。
                </p></li><li class="listitem"><p>
                  <code class="literal">YEAR</code> に正常に変換できない値の場合は、<code class="literal">NULL</code> を返します。
                </p></li></ul></div><p>
              変換前に切り捨てる必要がある数値以外の文字を含む文字列値は、次に示すように警告を生成します:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONVERT("1979aaa", YEAR);</code></strong>
+--------------------------+
| CONVERT("1979aaa", YEAR) |
+--------------------------+
|                     1979 |
+--------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+-------------------------------------------+
| Level   | Code | Message                                   |
+---------+------+-------------------------------------------+
| Warning | 1292 | Truncated incorrect YEAR value: '1979aaa' |
+---------+------+-------------------------------------------+
</pre></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xml-functions"></a>12.12 XML 関数</h2></div></div></div><div class="table"><a name="idm46041620824352"></a><p class="title"><b>表 12.16 「XML 関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「XML 関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></td>
<td>
      XPath 表記法を使用した XML 文字列からの値の抽出
    </td>
</tr><tr><td><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></td>
<td>
      置換後 XML フラグメントを返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      このセクションでは、MySQL での XML および関連する機能について説明します。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        <code class="option">--xml</code> オプションを付けて呼び出すと、<span class="command"><strong>mysql</strong></span> および <span class="command"><strong>mysqldump</strong></span> クライアントで XML 書式の出力を MySQL から取得できます。 <a class="xref" href="programs.html#mysql" title="4.5.1 mysql — MySQL コマンドラインクライアント">セクション4.5.1「mysql — MySQL コマンドラインクライアント」</a>および<a class="xref" href="programs.html#mysqldump" title="4.5.4 mysqldump — データベースバックアッププログラム">セクション4.5.4「mysqldump — データベースバックアッププログラム」</a>を参照してください。 
      </p></div><p>
      基本的な XPath 1.0 (XML Path Language、バージョン 1.0) の機能を提供する 2 つの関数が使用可能です。 XPath の構文および使用方法に関する基本情報の一部は、このセクションの後半で説明しますが、これらのトピックの詳細はこのマニュアルの範囲外であるため、<a class="ulink" href="http://www.w3.org/TR/xpath" target="_top">「XML Path Language (XPath) 1.0 標準」</a>で明確な情報を参照する必要があります。 XPath がはじめてのユーザーや基本の復習を希望するユーザーに役立つリソースは、複数の言語で入手できる<a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top">「Zvon.org XPath Tutorial」</a>です。 
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        これらの関数はまだ開発中です。 XML および XPath 機能のこれらの側面やその他の側面については、MySQL 8.0 以降で引き続き改善します。 これらについて議論したり、質問したり、<a class="ulink" href="https://forums.mysql.com/list.php?44" target="_top">MySQL XML ユーザーフォーラム</a>でほかのユーザーからの支援を得たりすることもできます。 
      </p></div><p>
      これらの関数で使用される XPath の式では、ユーザー変数およびローカルストアドプログラム変数がサポートされています。 ユーザー変数は簡単にチェックされます。ストアドプログラムへのローカル変数は厳密にチェックされます (Bug#26518 も参照してください)。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b>ユーザー変数 (簡単なチェック). </b>
             構文 <code class="literal">$@<em class="replaceable"><code>variable_name</code></em></code> を使用する変数 (つまり、ユーザー変数) はチェックされません。 変数の型が間違っている場合や、変数に値が事前に割り当てられていない場合でも、サーバーから警告やエラーが発行されません。 これは、<code class="literal">$@myvariable</code> が意図された場所で (たとえば)<code class="literal">$@myvairable</code> が使用された場合、警告が表示されないため、ユーザーが入力ミスを完全に担当することも意味します。 
          </p><p>
          例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;X&lt;/b&gt;&lt;b&gt;Y&lt;/b&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @i =1, @j = 2;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @i, ExtractValue(@xml, '//b[$@i]');</code></strong>
+------+--------------------------------+
| @i   | ExtractValue(@xml, '//b[$@i]') |
+------+--------------------------------+
|    1 | X                              |
+------+--------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, ExtractValue(@xml, '//b[$@j]');</code></strong>
+------+--------------------------------+
| @j   | ExtractValue(@xml, '//b[$@j]') |
+------+--------------------------------+
|    2 | Y                              |
+------+--------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @k, ExtractValue(@xml, '//b[$@k]');</code></strong>
+------+--------------------------------+
| @k   | ExtractValue(@xml, '//b[$@k]') |
+------+--------------------------------+
| NULL |                                |
+------+--------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p><b>ストアドプログラム内の変数 (厳密なチェック). </b>
            これらの関数をストアドプログラム内部で呼び出すときに、構文 <code class="literal">$<em class="replaceable"><code>variable_name</code></em></code> を使用する変数を宣言し、これらの関数で使用できます。 このような変数は、定義されているストアドプログラムへのローカル変数であり、型および値について厳密にチェックされます。 
          </p><p>
          例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>DELIMITER |</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE myproc ()</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE i INT DEFAULT 1;</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE xml VARCHAR(25) DEFAULT '&lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt;';</code></strong>
    -&gt;
    -&gt;   <strong class="userinput"><code>WHILE i &lt; 4 DO</code></strong>
    -&gt;     <strong class="userinput"><code>SELECT xml, i, ExtractValue(xml, '//a[$i]');</code></strong>
    -&gt;     <strong class="userinput"><code>SET i = i+1;</code></strong>
    -&gt;   <strong class="userinput"><code>END WHILE;</code></strong>
    -&gt; <strong class="userinput"><code>END |</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>DELIMITER ;</code></strong>

mysql&gt; <strong class="userinput"><code>CALL myproc();</code></strong>
+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 1 | X                            |
+--------------------------+---+------------------------------+
1 row in set (0.00 sec)

+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 2 | Y                            |
+--------------------------+---+------------------------------+
1 row in set (0.01 sec)

+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 3 | Z                            |
+--------------------------+---+------------------------------+
1 row in set (0.01 sec)
</pre><p><b>パラメータ. </b>
            ストアドルーチン内部の XPath 式で使用され、パラメータとして渡される変数も、厳密なチェックの対象です。
          </p></li></ul></div><p>
      ユーザー変数やストアドプログラムへのローカル変数を含む式は、その他の点 (表記法は除く) では、XPath 1.0 仕様で規定されている変数を含む XPath 式のルールに準拠する必要があります。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        XPath 式の格納に使用されるユーザー変数は、空の文字列として扱われます。 このため、ユーザー変数として XPath 式を格納することはできません。 (Bug #32911) 
      </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_extractvalue"></a><p>
          <code class="literal">ExtractValue(<em class="replaceable"><code>xml_frag</code></em>, <em class="replaceable"><code>xpath_expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041620764128"></a><p>
          <code class="literal">ExtractValue()</code> は、XML マークアップ <em class="replaceable"><code>xml_frag</code></em> のフラグメントと XPath 式 <em class="replaceable"><code>xpath_expr</code></em> (<span class="firstterm">ロケータ</span>とも呼ばれる) の 2 つの文字列引数を取ります。これは、XPath 式に一致する要素の子である最初のテキストノードのテキスト (<code class="literal">CDATA</code>) を返します。
        </p><p>
          この関数を使用することは、<code class="literal">/text()</code> を追加したあとに <em class="replaceable"><code>xpath_expr</code></em> を使用して一致を実行することと同等です。 言い換えると、<code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;', '/a/b')</code> と <code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;', '/a/b/text()')</code> では同じ結果が生成されます。 
        </p><p>
          複数の一致が見つかった場合は、一致する各要素の 1 番目の子テキストノードの内容が空白文字で区切られた単一文字列として (一致した順序で) 返されます。
        </p><p>
          式に一致するテキストノード (暗黙的な <code class="literal">/text()</code> を含む) が見つからない場合は、どのような理由でも、<em class="replaceable"><code>xpath_expr</code></em> が有効で、<em class="replaceable"><code>xml_frag</code></em> が適切にネストされ、閉じられた要素で構成されていれば、空の文字列が返されます。 空の要素で一致することと、まったく一致しないこととは区別されません。 これは意図的なものです。 
        </p><p>
          <em class="replaceable"><code>xml_frag</code></em> で一致する要素が見つからなかったのか、またはこのような要素は見つかったが、子テキストノードが含まれていなかったのかを判断する必要がある場合は、XPath <code class="literal">count()</code> 関数を使用する式の結果をテストしてください。 たとえば、次に示すように、これらのステートメントの両方で空の文字列が返されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', '/a/b');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', '/a/b') |
+-------------------------------------+
|                                     |
+-------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', '/a/b');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', '/a/b') |
+-------------------------------------+
|                                     |
+-------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          ただし、次のコマンドを使用すれば、実際に一致する要素があったかどうかを判断できます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', 'count(/a/b)') |
+-------------------------------------+
| 1                                   |
+-------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', 'count(/a/b)') |
+-------------------------------------+
| 0                                   |
+-------------------------------------+
1 row in set (0.01 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            <code class="literal">ExtractValue()</code> では <code class="literal">CDATA</code> のみが返され、一致するタグ内に含まれるタグや、それらの内容は返されません (次の例で、<code class="literal">val1</code> として返された結果を参照してください)。
          </p></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a') AS val1,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a/b') AS val2,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '//b') AS val3,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/b') AS val4,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;b&gt;eee&lt;/b&gt;&lt;/a&gt;', '//b') AS val5;</code></strong>

+------+------+------+------+---------+
| val1 | val2 | val3 | val4 | val5    |
+------+------+------+------+---------+
| ccc  | ddd  | ddd  |      | ddd eee |
+------+------+------+------+---------+
</pre><p>
          この関数では、<code class="literal">contains()</code> との比較を実行し、その他の文字列関数 (<code class="literal">CONCAT()</code> など) と同じ照合順序アグリゲーションを実行し、それらの引数の照合順序強制性を考慮に入れる際に、現在の SQL 照合順序が使用されます。この動作を制御するルールの説明については、<a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4 式での照合の強制性">セクション10.8.4「式での照合の強制性」</a>を参照してください。
        </p><p>
          (以前は、大文字と小文字が区別されるバイナリが常に使用されていました。)
        </p><p>
          次の例に示すように、<em class="replaceable"><code>xml_frag</code></em> に、適切にネストされていない要素や閉じられていない要素が含まれ、警告が生成された場合は、<code class="literal">NULL</code> が返されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong>
+-----------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a') |
+-----------------------------------+
| NULL                              |
+-----------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1525
Message: Incorrect XML value: 'parse error at line 1 pos 11:
         END-OF-INPUT unexpected ('&gt;' wanted)'
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a') |
+-------------------------------------+
| c                                   |
+-------------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_updatexml"></a><p>
          <code class="literal">UpdateXML(<em class="replaceable"><code>xml_target</code></em>, <em class="replaceable"><code>xpath_expr</code></em>, <em class="replaceable"><code>new_xml</code></em>)</code>
        </p><a class="indexterm" name="idm46041620713280"></a><p>
          この関数は、XML マークアップ <em class="replaceable"><code>xml_target</code></em> の特定のフラグメントの一部を新しい XML フラグメント <em class="replaceable"><code>new_xml</code></em> に置き換えてから、変更された XML を返します。 置換された <em class="replaceable"><code>xml_target</code></em> の一部は、ユーザーが指定した XPath 式 <em class="replaceable"><code>xpath_expr</code></em> に一致します。 
        </p><p>
          <em class="replaceable"><code>xpath_expr</code></em> に一致する式が見つからない場合、または複数の一致が見つかった場合、この関数は元の <em class="replaceable"><code>xml_target</code></em> XML フラグメントを返します。 3 つの引数はすべて文字列にする必要があります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a', '&lt;e&gt;fff&lt;/e&gt;') AS val1,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/b', '&lt;e&gt;fff&lt;/e&gt;') AS val2,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '//b', '&lt;e&gt;fff&lt;/e&gt;') AS val3,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val4,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val5</code></strong>
    -&gt; <strong class="userinput"><code>\G</code></strong>

*************************** 1. row ***************************
val1: &lt;e&gt;fff&lt;/e&gt;
val2: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
val3: &lt;a&gt;&lt;e&gt;fff&lt;/e&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
val4: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;e&gt;fff&lt;/e&gt;&lt;/a&gt;
val5: &lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
</pre></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        XPath の構文および使用方法の詳細は、このマニュアルの範囲外です。 最終的な情報については、<a class="ulink" href="http://www.w3.org/TR/xpath" target="_top">「XML Path Language (XPath) 1.0 仕様」</a>を参照してください。 XPath がはじめてのユーザーや基本の復習を希望するユーザーに役立つリソースは、複数の言語で入手できる<a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top">「Zvon.org XPath Tutorial」</a>です。 
      </p></div><p>
      一部の基本的な XPath 式の説明および例は、次のとおりです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code> がルート要素の場合にかぎり、<code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code> に一致します。
        </p><p>
          例: <code class="literal">/a</code> はいちばん外側の (ルート) タグに一致するため、<code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> には一致があります。 この例では、別の要素の子であるため、<code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> の内側の <em class="replaceable"><code>a</code></em> 要素には一致しません。 
        </p></li><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag1</code></em>/<em class="replaceable"><code>tag2</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code> の子であり、<code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code> がルート要素である場合にかぎり、<code class="literal">&lt;<em class="replaceable"><code>tag2</code></em>/&gt;</code> に一致します。
        </p><p>
          例: <code class="literal">/a/b</code> はルート要素 <em class="replaceable"><code>a</code></em> の子であるため、XML フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> の <em class="replaceable"><code>b</code></em> 要素に一致します。 この場合、<em class="replaceable"><code>b</code></em> はルート要素 (その他の要素の子) であるため、<code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> には一致がありません。 XPath 式でも <code class="literal">&lt;a&gt;&lt;c&gt;&lt;b/&gt;&lt;/c&gt;&lt;/a&gt;</code> に一致がありません。ここで、<em class="replaceable"><code>b</code></em> は <em class="replaceable"><code>a</code></em> の子孫ですが、実際には <em class="replaceable"><code>a</code></em> の子ではありません。 
        </p><p>
          この構成は、3 つ以上の要素に拡張できます。 たとえば、XPath 式 <code class="literal">/a/b/c</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code> 内の <em class="replaceable"><code>c</code></em> 要素に一致します。 
        </p></li><li class="listitem"><p>
          <code class="literal">//<em class="replaceable"><code>tag</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag</code></em>&gt;</code> の任意のインスタンスに一致します。
        </p><p>
          例: <code class="literal">//a</code> は、<code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code>、<code class="literal">&lt;c&gt;&lt;a&gt;&lt;b/&gt;&lt;/a&gt;&lt;/b&gt;</code>、<code class="literal">&lt;c&gt;&lt;b&gt;&lt;a/&gt;&lt;/b&gt;&lt;/c&gt;</code> のいずれかの <em class="replaceable"><code>a</code></em> 要素に一致します。
        </p><p>
          <code class="literal">//</code> は <code class="literal">/</code> と組み合わせることができます。 たとえば、<code class="literal">//a/b</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> または <code class="literal">&lt;c&gt;&lt;a&gt;&lt;b/&gt;&lt;/a&gt;&lt;/c&gt;</code> のいずれかの <em class="replaceable"><code>b</code></em> 要素と一致します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">//<em class="replaceable"><code>tag</code></em></code> は <code class="literal">/descendant-or-self::*/<em class="replaceable"><code>tag</code></em></code> と同等です。 よく見られる誤りは、これと <code class="literal">/descendant-or-self::<em class="replaceable"><code>tag</code></em></code> とを混同することです。次に示すように、実際には後者の式ではまったく異なる結果が生成される可能性があります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;&lt;c&gt;w&lt;/c&gt;&lt;b&gt;x&lt;/b&gt;&lt;d&gt;y&lt;/d&gt;z&lt;/b&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @xml;</code></strong>
+-----------------------------------------+
| @xml                                    |
+-----------------------------------------+
| &lt;a&gt;&lt;b&gt;&lt;c&gt;w&lt;/c&gt;&lt;b&gt;x&lt;/b&gt;&lt;d&gt;y&lt;/d&gt;z&lt;/b&gt;&lt;/a&gt; |
+-----------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[1]');</code></strong>
+------------------------------+
| ExtractValue(@xml, '//b[1]') |
+------------------------------+
| x z                          |
+------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[2]');</code></strong>
+------------------------------+
| ExtractValue(@xml, '//b[2]') |
+------------------------------+
|                              |
+------------------------------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[1]');</code></strong>
+---------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::*/b[1]') |
+---------------------------------------------------+
| x z                                               |
+---------------------------------------------------+
1 row in set (0.06 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[2]');</code></strong>
+---------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::*/b[2]') |
+---------------------------------------------------+
|                                                   |
+---------------------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[1]');</code></strong>
+-------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::b[1]') |
+-------------------------------------------------+
| z                                               |
+-------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[2]');</code></strong>
+-------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::b[2]') |
+-------------------------------------------------+
| x                                               |
+-------------------------------------------------+
1 row in set (0.00 sec)
</pre></div></li><li class="listitem"><p>
          <code class="literal">*</code> 演算子は、任意の要素に一致する<span class="quote">「<span class="quote">ワイルドカード</span>」</span>として機能します。 たとえば、式 <code class="literal">/*/b</code> は、XML フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> または <code class="literal">&lt;c&gt;&lt;b/&gt;&lt;/c&gt;</code> 内の <em class="replaceable"><code>b</code></em> 要素に一致します。 ただし、<em class="replaceable"><code>b</code></em> はその他の要素の子である必要があるため、この式ではフラグメント <code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> 内の一致は生成されません。 ワイルドカードは任意の位置で使用できます: 式<code class="literal">/*/b/*</code> は、それ自体がルート要素ではない <em class="replaceable"><code>b</code></em> 要素の子と一致します。 
        </p></li><li class="listitem"><p>
          <code class="literal">|</code> (<code class="literal">UNION</code>) 演算子を使用すれば、複数のロケータのいずれかに一致できます。 たとえば、式 <code class="literal">//b|//c</code> は、XML ターゲット内のすべての <em class="replaceable"><code>b</code></em> および <em class="replaceable"><code>c</code></em> 要素に一致します。 
        </p></li><li class="listitem"><p>
          その属性の 1 つ以上の値に基づいて、要素に一致することもできます。 これは、構文 <code class="literal"><em class="replaceable"><code>tag</code></em>[@<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code> を使用して実行されます。 たとえば、式 <code class="literal">//b[@id="idB"]</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b id="idA"/&gt;&lt;c/&gt;&lt;b id="idB"/&gt;&lt;/a&gt;</code> 内の 2 番目の <em class="replaceable"><code>b</code></em> 要素に一致します。 <code class="literal"><em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"</code> を含む<span class="emphasis"><em>任意の</em></span>要素に対して一致を行うには、XPath 式 <code class="literal">//*[<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code> を使用します。 
        </p><p>
          複数の属性値をフィルタ処理するには、単に複数の属性比較句を連続して使用するだけです。 たとえば、式 <code class="literal">//b[@c="x"][@d="y"]</code> は、指定した XML フラグメントの任意の場所で発生した要素 <code class="literal">&lt;b c="x" d="y"/&gt;</code> に一致します。 
        </p><p>
          同じ属性が複数の値のいずれかに一致する要素を見つけるには、<code class="literal">|</code> 演算子で結合された複数のロケータを使用します。 たとえば、<em class="replaceable"><code>c</code></em> 属性の値が 23 または 17 であるすべての <em class="replaceable"><code>b</code></em> 要素に一致するには、式 <code class="literal">//b[@c="23"]|//b[@c="17"]</code> を使用します。 この目的のために、<code class="literal">//b[@c="23" or @c="17"]</code> のように論理 <code class="literal">or</code> 演算子を使用することもできます。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">or</code> と <code class="literal">|</code> の相違点として、<code class="literal">or</code> は条件を結合するのに対し、<code class="literal">|</code> は結果セットを結合します。
          </p></div></li></ul></div><p><b>XPath の制限. </b>
        現在、これらの関数でサポートされている XPath 構文は、次の制限の対象となっています。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          ノードセット間の比較 (<code class="literal">'/a/b[@c=@d]'</code> など) はサポートされていません。
        </p></li><li class="listitem"><p>
          標準の XPath 比較演算子はすべてサポートされています。 (Bug #22823) 
        </p></li><li class="listitem"><p>
          相対ロケータ式は、ルートノードのコンテキストで解決されます。 たとえば、次のようなクエリーと結果を考えてみます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;   <strong class="userinput"><code>'&lt;a&gt;&lt;b c="1"&gt;X&lt;/b&gt;&lt;b c="2"&gt;Y&lt;/b&gt;&lt;/a&gt;',</code></strong>
    -&gt;    <strong class="userinput"><code>'a/b'</code></strong>
    -&gt; <strong class="userinput"><code>) AS result;</code></strong>
+--------+
| result |
+--------+
| X Y    |
+--------+
1 row in set (0.03 sec)
</pre><p>
          この場合は、ロケータ <code class="literal">a/b</code> が <code class="literal">/a/b</code> に解決されています。
        </p><p>
          相対ロケータは、述語内でもサポートされています。 次の例では、<code class="literal">d[../@c="1"]</code> が <code class="literal">/a/b[@c="1"]/d</code> として解決されています。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;      <strong class="userinput"><code>'&lt;a&gt;</code></strong>
    -&gt;        <strong class="userinput"><code>&lt;b c="1"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong>
    -&gt;        <strong class="userinput"><code>&lt;b c="2"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong>
    -&gt;      <strong class="userinput"><code>&lt;/a&gt;',</code></strong>
    -&gt;      <strong class="userinput"><code>'a/b/d[../@c="1"]')</code></strong>
    -&gt; <strong class="userinput"><code>AS result;</code></strong>
+--------+
| result |
+--------+
| X      |
+--------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
          スカラー値 (変数参照、リテラル、数字、およびスカラー関数の呼び出しを含む) として評価する式が前に付けられたロケータは許可されず、使用するとエラーが発生します。
        </p></li><li class="listitem"><p>
          <code class="literal">::</code> 演算子を次のようなノード型と組み合わせることは、サポートされていません。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::comment()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::text()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::processing-instructions()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::node()</code>
            </p></li></ul></div><p>
          ただし、次の例に示すように、名前のテスト (<code class="literal"><em class="replaceable"><code>axis</code></em>::<em class="replaceable"><code>name</code></em></code> や <code class="literal"><em class="replaceable"><code>axis</code></em>::*</code> など) はサポートされています。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::b');</code></strong>
+-------------------------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::b') |
+-------------------------------------------------------+
| x                                                     |
+-------------------------------------------------------+
1 row in set (0.02 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::*');</code></strong>
+-------------------------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::*') |
+-------------------------------------------------------+
| x y                                                   |
+-------------------------------------------------------+
1 row in set (0.01 sec)
</pre></li><li class="listitem"><p>
          パスがルート要素を<span class="quote">「<span class="quote">上方向</span>」</span>に導いている場合は、<span class="quote">「<span class="quote">上下</span>」</span>の移動がサポートされていません。 つまり、現在の要素の 1 つ以上の祖先がルート要素の祖先でもある場合は、指定された要素の祖先の子孫で一致する式を使用できません (Bug #16321 を参照してください)。 
        </p></li><li class="listitem"><p>
          次の XPath 関数はサポートされていないか、または説明したような既知の問題があります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">id()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">lang()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">local-name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">namespace-uri()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">normalize-space()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">starts-with()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">string()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-after()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-before()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">translate()</code>
            </p></li></ul></div></li><li class="listitem"><p>
          次の軸はサポートされていません。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">following-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">following</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding</code>
            </p></li></ul></div></li></ul></div><p>
      <code class="literal">ExtractValue()</code> および <code class="literal">UpdateXML()</code> への引数として渡される XPath 式の要素セレクタ内には、コロン文字 (<code class="literal">:</code>) が含まれている可能性があります。これにより、XML 名前空間の表記法を使用しているマークアップとの使用が有効になります。 例: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;111&lt;b:c&gt;222&lt;d&gt;333&lt;/d&gt;&lt;e:f&gt;444&lt;/e:f&gt;&lt;/b:c&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//e:f');</code></strong>
+-----------------------------+
| ExtractValue(@xml, '//e:f') |
+-----------------------------+
| 444                         |
+-----------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT UpdateXML(@xml, '//b:c', '&lt;g:h&gt;555&lt;/g:h&gt;');</code></strong>
+--------------------------------------------+
| UpdateXML(@xml, '//b:c', '&lt;g:h&gt;555&lt;/g:h&gt;') |
+--------------------------------------------+
| &lt;a&gt;111&lt;g:h&gt;555&lt;/g:h&gt;&lt;/a&gt;                   |
+--------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
      これは、いくつかの点で <a class="ulink" href="http://xalan.apache.org/" target="_top">Apache Xalan</a> およびその他の一部のパーサーで許可されているものと似ていますが、名前空間の制限や <code class="literal">namespace-uri()</code> および <code class="literal">local-name()</code> 関数の使用を必要とするよりも大幅に単純です。
    </p><p><b>エラー処理. </b>
        <code class="literal">ExtractValue()</code> と <code class="literal">UpdateXML()</code> のどちらの場合でも、使用される XPath ロケータが有効であり、検索対象の XML が適切にネストされ、閉じられた要素で構成されている必要があります。 ロケータが無効な場合は、次のようなエラーが生成されます。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '/&amp;a');</code></strong>
<span class="errortext">ERROR 1105 (HY000): XPATH syntax error: '&amp;a'</span>
</pre><p>
      <em class="replaceable"><code>xml_frag</code></em> が適切にネストされ、閉じられている要素で構成されていない場合は、次の例に示すように、<code class="literal">NULL</code> が返され、警告が生成されます。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong>
+-----------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a') |
+-----------------------------------+
| NULL                              |
+-----------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1525
Message: Incorrect XML value: 'parse error at line 1 pos 11:
         END-OF-INPUT unexpected ('&gt;' wanted)'
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a') |
+-------------------------------------+
| c                                   |
+-------------------------------------+
1 row in set (0.00 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
        <code class="literal">UpdateXML()</code> への第 3 引数として使用される置換用の XML は、適切にネストされ、閉じられている要素のみで構成されているかどうかを判断するためにチェック<span class="emphasis"><em>されません</em></span>。
      </p></div><p><b>XPath インジェクション. </b>
        <span class="firstterm">コードインジェクション</span>は、権限やデータへの不正アクセス権を取得するために、悪意のあるコードがシステムに導入された場合に発生します。 これは、ユーザーが入力したデータの型や内容について開発者が行なった想定の悪用に基づいています。 これに関しては、XPath も例外ではありません。 
      </p><p>
      この問題が発生する可能性のある一般的なシナリオは、次のような XPath 式を使用して、ログイン名とパスワードの組み合わせを XML ファイル内で見つかったものと一致させることで承認を処理するアプリケーションのケースです。
    </p><pre class="programlisting">//user[login/text()='neapolitan' and password/text()='1c3cr34m']/attribute::id
</pre><p>
      この XPath 式は、次のような SQL ステートメントと同等です。
    </p><pre class="programlisting">SELECT id FROM users WHERE login='neapolitan' AND password='1c3cr34m';
</pre><p>
      XPath を使用している PHP アプリケーションでは、次のようにログインプロセスが処理される可能性があります。
    </p><pre class="programlisting">&lt;?php

  $file     =   "users.xml";

  $login    =   $POST["login"];
  $password =   $POST["password"];

  $xpath = "//user[login/text()=$login and password/text()=$password]/attribute::id";

  if( file_exists($file) )
  {
    $xml = simplexml_load_file($file);

    if($result = $xml-&gt;xpath($xpath))
      echo "You are now logged in as user $result[0].";
    else
      echo "Invalid login name or password.";
  }
  else
    exit("Failed to open $file.");

?&gt;
</pre><p>
      入力時にはチェックが実行されません。 これは、悪意のあるユーザーがログイン名とパスワードの両方に <code class="literal">' or 1=1</code> と入力することで、テストを<span class="quote">「<span class="quote">回避</span>」</span>できることを意味します。その結果、<code class="varname">$xpath</code> が次のように評価されます。 
    </p><pre class="programlisting">//user[login/text()='' or 1=1 and password/text()='' or 1=1]/attribute::id
</pre><p>
      角括弧内の式は常に <code class="literal">true</code> と評価されるため、事実上、XML ドキュメント内のすべての <code class="literal">user</code> 要素の <code class="literal">id</code> 属性に一致する次の式と同じです。
    </p><pre class="programlisting">//user/attribute::id
</pre><p>
      この攻撃を回避する方法の 1 つは、<code class="literal">$xpath</code> の定義内に挿入される変数名を単に引用符で囲むだけです。これにより、Web フォームから渡された値が強制的に文字列に変換されます。
    </p><pre class="programlisting">$xpath = "//user[login/text()='$login' and password/text()='$password']/attribute::id";
</pre><p>
      これは、SQL インジェクション攻撃を回避する際に推奨されることの多い方法と同じです。 一般に、XPath インジェクション攻撃を回避するために従うべき方法は、SQL インジェクションを回避するための方法と同じです。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          アプリケーションでは、テストされていないユーザーデータは許可されません。
        </p></li><li class="listitem"><p>
          ユーザーが送信したすべてのデータの型をチェックします。不正な型のデータは拒否または変換します。
        </p></li><li class="listitem"><p>
          数値データに範囲外の値が含まれていないかをテストします。範囲外の値は切り捨てるか、丸めるか、拒否します。 文字列に不正な文字が含まれていないかをテストし、不正な文字が含まれる入力は削除するか拒否します。 
        </p></li><li class="listitem"><p>
          明示的なエラーメッセージは、システムを危険にさらすために使用できる手がかりを未承認ユーザーに与える可能性があるため、出力しないでください。その代わりに、ファイルやデータベーステーブルにログを記録してください。
        </p></li></ul></div><p>
      SQL インジェクション攻撃を使用すればデータベーススキーマに関する情報を取得できるように、XPath インジェクションを使用すれば、Amit Klein 氏の論文<a class="ulink" href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf" target="_top">『Blind XPath Injection』</a>(PDF ファイル、46K バイト) で説明されているように、XML ファイルをスキャンして構造を明らかにできます。
    </p><p>
      クライアントに返送される出力をチェックすることも重要です。 MySQL の <code class="literal">ExtractValue()</code> 関数を使用すると何が発生する可能性があるのかを検討します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;     <strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong>
    -&gt;     <strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong>
    -&gt; <strong class="userinput"><code>) AS id;</code></strong>
+-------------------------------+
| id                            |
+-------------------------------+
| 00327 13579 02403 42354 28570 |
+-------------------------------+
1 row in set (0.01 sec)
</pre><p>
      <code class="literal">ExtractValue()</code> は複数の一致を空白で区切られた単一の文字列として返すため、このインジェクション攻撃によって、<code class="filename">users.xml</code> 内に含まれるすべての有効な ID が単一の出力行としてユーザーに提供されます。 追加の保護手段として、ユーザーに返される前に出力のテストも行うべきです。 次に、単純な例を示します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @id = ExtractValue(</code></strong>
    -&gt;     <strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong>
    -&gt;     <strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT IF(</code></strong>
    -&gt;     <strong class="userinput"><code>INSTR(@id, ' ') = 0,</code></strong>
    -&gt;     <strong class="userinput"><code>@id,</code></strong>
    -&gt;     <strong class="userinput"><code>'Unable to retrieve user ID')</code></strong>
    -&gt; <strong class="userinput"><code>AS singleID;</code></strong>
+----------------------------+
| singleID                   |
+----------------------------+
| Unable to retrieve user ID |
+----------------------------+
1 row in set (0.00 sec)
</pre><p>
      一般に、ユーザーにデータをセキュアに返すためのガイドラインは、ユーザー入力を受け入れるためのガイドラインと同じです。 それらは、次のように要約できます。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          常に、出力データの型および許可される値をテストします。
        </p></li><li class="listitem"><p>
          未承認ユーザーがエラーメッセージを表示することを許可しないでください。アプリケーションに関する情報が提供される可能性があり、それを悪用されるおそれがあります。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bit-functions"></a>12.13 ビット関数と演算子</h2></div></div></div><a class="indexterm" name="idm46041620477088"></a><a class="indexterm" name="idm46041620474976"></a><a class="indexterm" name="idm46041620472944"></a><a class="indexterm" name="idm46041620471584"></a><a class="indexterm" name="idm46041620470224"></a><a class="indexterm" name="idm46041620468624"></a><a class="indexterm" name="idm46041620466656"></a><a class="indexterm" name="idm46041620465200"></a><div class="table"><a name="idm46041620463840"></a><p class="title"><b>表 12.17 「ビット関数と演算子」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「ビット関数と演算子をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td>
<td>
      ビット単位の AND
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td>
<td>
      右シフト
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td>
<td>
      左シフト
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td>
<td>
      ビット単位の XOR
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></td>
<td>
      設定されているビット数を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td>
<td>
      ビット単位の OR
    </td>
</tr><tr><td><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td>
<td>
      ビット単位の反転
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      ビット関数および演算子は、<code class="literal">BIT_COUNT()</code>, <code class="literal">BIT_AND()</code>, <code class="literal">BIT_OR()</code>, <code class="literal">BIT_XOR()</code>, <code class="literal">&amp;</code>, <code class="literal">|</code>, <code class="literal">^</code>, <code class="literal">~</code>, <code class="literal">&lt;&lt;</code> および <code class="literal">&gt;&gt;</code> で構成されます。 (<code class="literal">BIT_AND()</code>、<code class="literal">BIT_OR()</code> および <code class="literal">BIT_XOR()</code> の集計関数については、<a class="xref" href="functions.html#aggregate-functions" title="12.20.1 集計関数の説明">セクション12.20.1「集計関数の説明」</a> を参照してください。) MySQL 8.0 より前では、ビット関数および演算子には <code class="literal">BIGINT</code> (64-bit 整数) 引数が必要であり、<code class="literal">BIGINT</code> 値が返されるため、最大範囲は 64 ビットでした。 操作の実行前に <code class="literal">BIGINT</code> 以外の引数が <code class="literal">BIGINT</code> に変換され、切捨てが発生する可能性があります。 
    </p><p>
      MySQL 8.0 では、ビット関数および演算子はバイナリ文字列型の引数 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code> および <code class="literal">BLOB</code> 型) を許可し、同様の型の値を返します。これにより、引数を受け取り、64 ビットを超える戻り値を生成できます。 バイナリ以外の文字列引数は <code class="literal">BIGINT</code> に変換され、以前と同様に処理されます。 
    </p><p>
      この動作の変更の影響は、バイナリ文字列引数に対するビット操作によって、MySQL 8.0 と 5.7 では異なる結果が生成される可能性があることです。 MySQL 5.7 と 8.0 間の潜在的な非互換性のために MySQL 5.7 で準備する方法の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/" target="_top">MySQL 5.7 Reference Manual</a> の <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/bit-functions.html" target="_top">Bit Functions and Operators</a> を参照してください。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-5-7" title="MySQL 8.0 より前のビット操作">MySQL 8.0 より前のビット操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-8-0" title="MySQL 8.0 でのビット操作">MySQL 8.0 でのビット操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-binary-string-examples" title="バイナリ文字列のビット操作の例">バイナリ文字列のビット操作の例</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-and-or-xor" title="ビット単位の AND、OR および XOR 操作">ビット単位の AND、OR および XOR 操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-complement-shift" title="ビット単位の補完およびシフト操作">ビット単位の補完およびシフト操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-bit-count" title="BIT_COUNT() の操作">BIT_COUNT() の操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-bit-aggregate" title="BIT_AND()、BIT_OR() および BIT_XOR() の操作">BIT_AND()、BIT_OR() および BIT_XOR() の操作</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-literal-handling" title="16 進数リテラル、ビットリテラルおよび NULL リテラルの特殊な処理">16 進数リテラル、ビットリテラルおよび NULL リテラルの特殊な処理</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-incompatibilities" title="MySQL 5.7 とのビット操作の非互換性">MySQL 5.7 とのビット操作の非互換性</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-5-7"></a>MySQL 8.0 より前のビット操作</h3></div></div></div><p>
        MySQL 8.0 より前のビット操作では、符号なし 64 ビット整数引数と結果値 (つまり、符号なし <code class="literal">BIGINT</code> 値) のみが処理されます。 他の型の引数の <code class="literal">BIGINT</code> への変換は、必要に応じて行われます。 例: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            次のステートメントは、符号なし 64 ビット整数として扱われる数値リテラルを操作します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 127 | 128, 128 &lt;&lt; 2, BIT_COUNT(15);</code></strong>
+-----------+----------+---------------+
| 127 | 128 | 128 &lt;&lt; 2 | BIT_COUNT(15) |
+-----------+----------+---------------+
|       255 |      512 |             4 |
+-----------+----------+---------------+
</pre></li><li class="listitem"><p>
            次のステートメントは、最初のステートメントと同じ操作を実行して同じ結果を生成する前に、文字列引数 (<code class="literal">'127'</code>から <code class="literal">127</code> など) に対して数値への変換を実行します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '127' | '128', '128' &lt;&lt; 2, BIT_COUNT('15');</code></strong>
+---------------+------------+-----------------+
| '127' | '128' | '128' &lt;&lt; 2 | BIT_COUNT('15') |
+---------------+------------+-----------------+
|           255 |        512 |               4 |
+---------------+------------+-----------------+
</pre></li><li class="listitem"><p>
            このステートメントは、ビット演算引数に 16 進数リテラルを使用します。 MySQL では、デフォルトで 16 進リテラルはバイナリ文字列として扱われますが、数値コンテキストでは数値として評価されます (<a class="xref" href="language-structure.html#hexadecimal-literals" title="9.1.4 16 進数リテラル">セクション9.1.4「16 進数リテラル」</a> を参照)。 MySQL 8.0 より前は、数値コンテキストにビット操作が含まれていました。 例: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT X'7F' | X'80', X'80' &lt;&lt; 2, BIT_COUNT(X'0F');</code></strong>
+---------------+------------+------------------+
| X'7F' | X'80' | X'80' &lt;&lt; 2 | BIT_COUNT(X'0F') |
+---------------+------------+------------------+
|           255 |        512 |                4 |
+---------------+------------+------------------+
</pre><p>
            ビット演算でのビット値リテラルの処理は、16 進数リテラル (つまり、数値) と似ています。
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-8-0"></a>MySQL 8.0 でのビット操作</h3></div></div></div><p>
        MySQL 8.0 はビット操作を拡張してバイナリ文字列引数を直接処理し (変換なし)、バイナリ文字列の結果を生成します。 (整数またはバイナリ文字列ではない引数は、以前と同様に整数に変換されます。) この拡張機能は、次のようにビット操作を拡張します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            64 ビットを超える値でビット操作が可能になります。
          </p></li><li class="listitem"><p>
            バイナリ文字列として表される値に対しては、整数として表される値よりもビット演算を実行する方が簡単です。
          </p></li></ul></div><p>
        たとえば、次のような判読可能なテキスト形式を持つ UUID 値と IPv6 アドレスについて考えてみます:
      </p><pre class="programlisting">UUID: 6ccd780c-baba-1026-9564-5b8c656024db
IPv6: fe80::219:d1ff:fe91:1a72
</pre><p>
        これらの形式のテキスト文字列を操作するのは面倒です。 別の方法として、デリミタなしの固定長バイナリ文字列に変換する方法があります。 <code class="literal">UUID_TO_BIN()</code> および <code class="literal">INET6_ATON()</code> はそれぞれ、バイナリ文字列 16 バイト (128 ビット) の長さのデータ型 <code class="literal">BINARY(16)</code> の値を生成します。 次のステートメントは、これを示しています (<code class="literal">HEX()</code> は表示可能な値を生成するために使用されます): 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(UUID_TO_BIN('6ccd780c-baba-1026-9564-5b8c656024db'));</code></strong>
+----------------------------------------------------------+
| HEX(UUID_TO_BIN('6ccd780c-baba-1026-9564-5b8c656024db')) |
+----------------------------------------------------------+
| 6CCD780CBABA102695645B8C656024DB                         |
+----------------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('fe80::219:d1ff:fe91:1a72'));</code></strong>
+---------------------------------------------+
| HEX(INET6_ATON('fe80::219:d1ff:fe91:1a72')) |
+---------------------------------------------+
| FE800000000000000219D1FFFE911A72            |
+---------------------------------------------+
</pre><p>
        これらのバイナリ値は、UUID 値からのタイムスタンプの抽出や、IPv6 アドレスのネットワークおよびホスト部分の抽出などのアクションを実行するビット操作で簡単に指定できます。 (例については、この説明の後半のを参照してください。) 
      </p><p>
        バイナリ文字列としてカウントされる引数には、カラム値、ルーチンパラメータ、ローカル変数、およびバイナリ文字列型を持つユーザー定義変数が含まれます: <code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、またはいずれかの <code class="literal">BLOB</code> タイプ。
      </p><p>
        16 進数リテラルとビットリテラルについて これらは MySQL ではデフォルトでバイナリ文字列ですが、数値コンテキストの数値であることを思い出してください。 MySQL 8.0 では、ビット操作はどのように処理されますか。 MySQL は、MySQL 8.0 の前と同様に、引き続き数値コンテキストで評価しますか。 または、ビット操作によってバイナリ文字列として評価され、バイナリ文字列を変換せずに<span class="quote">「<span class="quote">「ネイティブ」</span>」</span>を処理できるようになりましたか。 
      </p><p>
        回答: 16 進数リテラルまたはビットリテラルを使用してビット操作の引数を指定することは一般的であり、これらは数値を表すことを意図しているため、MySQL では、下位互換性のために、すべてのビット引数が 16 進数リテラルまたはビットリテラルである場合に、数値コンテキストでビット操作が評価され続けます。 かわりにバイナリ文字列としての評価が必要な場合は、簡単に実行できます: 少なくとも 1 つのリテラルに<code class="literal">_binary</code> イントロデューサを使用します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            次のビット演算は、16 進数リテラルおよびビットリテラルを整数として評価します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT X'40' | X'01', b'11110001' &amp; b'01001111';</code></strong>
+---------------+---------------------------+
| X'40' | X'01' | b'11110001' &amp; b'01001111' |
+---------------+---------------------------+
|            65 |                        65 |
+---------------+---------------------------+
</pre></li><li class="listitem"><p>
            これらのビット操作では、<code class="literal">_binary</code> イントロデューサのために 16 進数リテラルおよびビットリテラルがバイナリ文字列として評価されます:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT _binary X'40' | X'01', b'11110001' &amp; _binary b'01001111';</code></strong>
+-----------------------+-----------------------------------+
| _binary X'40' | X'01' | b'11110001' &amp; _binary b'01001111' |
+-----------------------+-----------------------------------+
| A                     | A                                 |
+-----------------------+-----------------------------------+
</pre></li></ul></div><p>
        両方のステートメントのビット操作によって数値 65 の結果が生成されますが、2 番目のステートメントはバイナリ文字列コンテキスト (65 は ASCII <code class="literal">A</code>) で動作します。
      </p><p>
        数値評価コンテキストでは、16 進数リテラルおよびビットリテラル引数の許容値は、結果と同様に最大 64 ビットです。 対照的に、バイナリ文字列の評価コンテキストでは、許可される引数 (および結果) は 64 ビットを超えることができます: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT _binary X'4040404040404040' | X'0102030405060708';</code></strong>
+---------------------------------------------------+
| _binary X'4040404040404040' | X'0102030405060708' |
+---------------------------------------------------+
| ABCDEFGH                                          |
+---------------------------------------------------+
</pre><p>
        ビット演算で 16 進数リテラルまたはビットリテラルを参照してバイナリ文字列評価を行うには、いくつかの方法があります:
      </p><pre class="programlisting">_binary <em class="replaceable"><code>literal</code></em>
BINARY <em class="replaceable"><code>literal</code></em>
CAST(<em class="replaceable"><code>literal</code></em> AS BINARY)
</pre><p>
        16 進数リテラルまたはビットリテラルの二項文字列評価を生成する別の方法は、それらをユーザー定義変数に割り当てることです。これにより、バイナリ文字列型の変数が生成されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @v1 = X'40', @v2 = X'01', @v3 = b'11110001', @v4 = b'01001111';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @v1 | @v2, @v3 &amp; @v4;</code></strong>
+-----------+-----------+
| @v1 | @v2 | @v3 &amp; @v4 |
+-----------+-----------+
| A         | A         |
+-----------+-----------+
</pre><p>
        バイナリ文字列コンテキストでは、ビット単位の操作引数の長さが同じである必要があります。そうでない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT _binary X'40' | X'0001';</code></strong>
ERROR 3513 (HY000): Binary operands of bitwise
operators must be of equal length
</pre><p>
        等価長の要件を満たすには、短い値を先頭のゼロ桁に埋めるか、長い値が先頭のゼロ桁で始まり、短い結果値が許容される場合は削除します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT _binary X'0040' | X'0001';</code></strong>
+---------------------------+
| _binary X'0040' | X'0001' |
+---------------------------+
|  A                        |
+---------------------------+
mysql&gt; <strong class="userinput"><code>SELECT _binary X'40' | X'01';</code></strong>
+-----------------------+
| _binary X'40' | X'01' |
+-----------------------+
| A                     |
+-----------------------+
</pre><p>
        パディングまたはストリッピングは、<code class="literal">LPAD()</code>, <code class="literal">RPAD()</code>, <code class="literal">SUBSTR()</code> や <code class="literal">CAST()</code> などの機能を使用して実行することもできます。 このような場合、式の引数はすべてのリテラルではなくなり、<code class="literal">_binary</code> は不要になります。 例: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LPAD(X'40', 2, X'00') | X'0001';</code></strong>
+---------------------------------+
| LPAD(X'40', 2, X'00') | X'0001' |
+---------------------------------+
|  A                              |
+---------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT X'40' | SUBSTR(X'0001', 2, 1);</code></strong>
+-------------------------------+
| X'40' | SUBSTR(X'0001', 2, 1) |
+-------------------------------+
| A                             |
+-------------------------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-binary-string-examples"></a>バイナリ文字列のビット操作の例</h3></div></div></div><p>
        次の例は、ビット操作を使用して UUID 値の一部 (この場合はタイムスタンプと IEEE 802 ノード番号) を抽出する方法を示しています。 このテクニックでは、抽出されたパーツごとにビットマスクが必要です。 
      </p><p>
        テキスト UUID を対応する 16 バイトのバイナリ値に変換して、バイナリ文字列コンテキストでビット操作を使用して操作できるようにします:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @uuid = UUID_TO_BIN('6ccd780c-baba-1026-9564-5b8c656024db');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(@uuid);</code></strong>
+----------------------------------+
| HEX(@uuid)                       |
+----------------------------------+
| 6CCD780CBABA102695645B8C656024DB |
+----------------------------------+
</pre><p>
        値のタイムスタンプおよびノード番号部分のビットマスクを構築します。 タイムスタンプは最初の 3 つの部分 (64 ビット、ビット 0 から 63) で構成され、ノード番号は最後の部分 (48 ビット、ビット 80 から 127) です: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ts_mask = CAST(X'FFFFFFFFFFFFFFFF' AS BINARY(16));</code></strong>
mysql&gt; <strong class="userinput"><code>SET @node_mask = CAST(X'FFFFFFFFFFFF' AS BINARY(16)) &gt;&gt; 80;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(@ts_mask);</code></strong>
+----------------------------------+
| HEX(@ts_mask)                    |
+----------------------------------+
| FFFFFFFFFFFFFFFF0000000000000000 |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(@node_mask);</code></strong>
+----------------------------------+
| HEX(@node_mask)                  |
+----------------------------------+
| 00000000000000000000FFFFFFFFFFFF |
+----------------------------------+
</pre><p>
        ここでは、マスクが適用される UUID 値と同じ長さである必要があるため、<code class="literal">CAST(... AS BINARY(16))</code> 関数が使用されます。 他の関数を使用して必要な長さまでマスクを埋め込むと、同じ結果が生成されます: 
      </p><pre class="programlisting">SET @ts_mask= RPAD(X'FFFFFFFFFFFFFFFF' , 16, X'00');
SET @node_mask = LPAD(X'FFFFFFFFFFFF', 16, X'00') ;
</pre><p>
        マスクを使用して、タイムスタンプおよびノード番号の部分を抽出します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(@uuid &amp; @ts_mask) AS 'timestamp part';</code></strong>
+----------------------------------+
| timestamp part                   |
+----------------------------------+
| 6CCD780CBABA10260000000000000000 |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(@uuid &amp; @node_mask) AS 'node part';</code></strong>
+----------------------------------+
| node part                        |
+----------------------------------+
| 000000000000000000005B8C656024DB |
+----------------------------------+
</pre><p>
        前述の例では、これらのビット操作を使用しています: 右シフト (<code class="literal">&gt;&gt;</code>) およびビット単位 AND (<code class="literal">&amp;</code>)。
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          <code class="literal">UUID_TO_BIN()</code> は、生成されるバイナリ UUID 値にビット再配置の原因となるフラグを取ります。 そのフラグを使用する場合は、それに応じて抽出マスクを変更します。 
        </p></div><p>
        次の例では、ビット操作を使用して、IPv6 アドレスのネットワーク部分およびホスト部分を抽出します。 ネットワークパーツの長さが 80 ビットであるとします。 この場合、ホスト部分の長さは 128−80 = 48 ビットです。 アドレスのネットワーク部分およびホスト部分を抽出するには、バイナリ文字列に変換してから、バイナリ文字列コンテキストでビット操作を使用します。 
      </p><p>
        テキスト IPv6 アドレスを対応するバイナリ文字列に変換します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ip = INET6_ATON('fe80::219:d1ff:fe91:1a72');</code></strong>
</pre><p>
        ネットワークの長さをビット単位で定義します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @net_len = 80;</code></strong>
</pre><p>
        all-one アドレスを左または右にシフトして、ネットワークマスクとホストマスクを構築します。 これを行うには、次のようなバイナリ文字列に変換することでわかるように、すべてのゼロの短縮形であるアドレス<code class="literal">::</code>から開始します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('::')) AS 'all zeros';</code></strong>
+----------------------------------+
| all zeros                        |
+----------------------------------+
| 00000000000000000000000000000000 |
+----------------------------------+
</pre><p>
        補完値 (すべて) を生成するには、<code class="literal">~</code> 演算子を使用してビットを反転します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(~INET6_ATON('::')) AS 'all ones';</code></strong>
+----------------------------------+
| all ones                         |
+----------------------------------+
| FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF |
+----------------------------------+
</pre><p>
        all-one 値を左または右にシフトして、ネットワークマスクとホストマスクを生成します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @net_mask = ~INET6_ATON('::') &lt;&lt; (128 - @net_len);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @host_mask = ~INET6_ATON('::') &gt;&gt; @net_len;</code></strong>
</pre><p>
        マスクを表示して、アドレスの正しい部分をカバーしていることを確認します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(@net_mask) AS 'network mask';</code></strong>
+----------------------------+
| network mask               |
+----------------------------+
| ffff:ffff:ffff:ffff:ffff:: |
+----------------------------+
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(@host_mask) AS 'host mask';</code></strong>
+------------------------+
| host mask              |
+------------------------+
| ::ffff:255.255.255.255 |
+------------------------+
</pre><p>
        アドレスのネットワーク部分とホスト部分を抽出して表示します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @net_part = @ip &amp; @net_mask;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @host_part = @ip &amp; @host_mask;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(@net_part) AS 'network part';</code></strong>
+-----------------+
| network part    |
+-----------------+
| fe80::219:0:0:0 |
+-----------------+
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(@host_part) AS 'host part';</code></strong>
+------------------+
| host part        |
+------------------+
| ::d1ff:fe91:1a72 |
+------------------+
</pre><p>
        前述の例では、これらのビット操作を使用しています: 補完 (<code class="literal">~</code>)、左シフト (<code class="literal">&lt;&lt;</code>) およびビット単位 AND (<code class="literal">&amp;</code>)。
      </p><p>
        残りの説明では、ビット操作の各グループの引数処理、ビット操作でのリテラル値の処理、および MySQL 8.0 と以前の MySQL バージョンとの間の潜在的な非互換性について詳しく説明します。
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-and-or-xor"></a>ビット単位の AND、OR および XOR 操作</h3></div></div></div><p>
        <code class="literal">&amp;</code>、<code class="literal">|</code>および <code class="literal">^</code> ビット操作の場合、結果の型は、引数がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            バイナリ文字列の評価は、引数がバイナリ文字列型で、少なくともそのいずれかが 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、引数は必要に応じて符号なし 64 ビット整数に変換されます。 
          </p></li><li class="listitem"><p>
            バイナリ文字列の評価では、引数と同じ長さのバイナリ文字列が生成されます。 引数の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
          </p></li></ul></div><p>
        数値評価の例:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 64 | 1, X'40' | X'01';</code></strong>
+--------+---------------+
| 64 | 1 | X'40' | X'01' |
+--------+---------------+
|     65 |            65 |
+--------+---------------+
</pre><p>
        バイナリ文字列の評価の例:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT _binary X'40' | X'01';</code></strong>
+-----------------------+
| _binary X'40' | X'01' |
+-----------------------+
| A                     |
+-----------------------+
mysql&gt; <strong class="userinput"><code>SET @var1 = X'40', @var2 = X'01';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @var1 | @var2;</code></strong>
+---------------+
| @var1 | @var2 |
+---------------+
| A             |
+---------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-complement-shift"></a>ビット単位の補完およびシフト操作</h3></div></div></div><p>
        <code class="literal">~</code>、<code class="literal">&lt;&lt;</code> および <code class="literal">&gt;&gt;</code> ビット操作の場合、結果の型はビット引数がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            バイナリ文字列の評価は、bit 引数がバイナリ文字列型で、16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は、必要に応じて引数を符号なし 64 ビット整数に変換することで、数値の評価が行われます。 
          </p></li><li class="listitem"><p>
            binary-string 評価では、bit 引数と同じ長さのバイナリ文字列が生成されます。 数値評価では符号なし 64 ビット整数が生成されます。 
          </p></li></ul></div><p>
        シフト操作では、引数の型に関係なく、値の末尾からシフトされたビットは警告なしで失われます。 特に、シフトカウントが bit 引数のビット数以上の場合、結果のすべてのビットは 0 になります。 
      </p><p>
        数値評価の例:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ~0, 64 &lt;&lt; 2, X'40' &lt;&lt; 2;</code></strong>
+----------------------+---------+------------+
| ~0                   | 64 &lt;&lt; 2 | X'40' &lt;&lt; 2 |
+----------------------+---------+------------+
| 18446744073709551615 |     256 |        256 |
+----------------------+---------+------------+
</pre><p>
        バイナリ文字列の評価の例:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'1111000022220000' &gt;&gt; 16);</code></strong>
+----------------------------------------+
| HEX(_binary X'1111000022220000' &gt;&gt; 16) |
+----------------------------------------+
| 0000111100002222                       |
+----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'1111000022220000' &lt;&lt; 16);</code></strong>
+----------------------------------------+
| HEX(_binary X'1111000022220000' &lt;&lt; 16) |
+----------------------------------------+
| 0000222200000000                       |
+----------------------------------------+
mysql&gt; <strong class="userinput"><code>SET @var1 = X'F0F0F0F0';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(~@var1);</code></strong>
+-------------+
| HEX(~@var1) |
+-------------+
| 0F0F0F0F    |
+-------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-bit-count"></a>BIT_COUNT() の操作</h3></div></div></div><p>
        <code class="literal">BIT_COUNT()</code> 関数は、常に符号なし 64 ビット整数、または引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT(127);</code></strong>
+----------------+
| BIT_COUNT(127) |
+----------------+
|              7 |
+----------------+
mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT(b'010101'), BIT_COUNT(_binary b'010101');</code></strong>
+----------------------+------------------------------+
| BIT_COUNT(b'010101') | BIT_COUNT(_binary b'010101') |
+----------------------+------------------------------+
|                    3 |                            3 |
+----------------------+------------------------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-bit-aggregate"></a>BIT_AND()、BIT_OR() および BIT_XOR() の操作</h3></div></div></div><p>
        <code class="literal">BIT_AND()</code>、<code class="literal">BIT_OR()</code> および <code class="literal">BIT_XOR()</code> ビット関数の場合、結果の型は、関数の引数値がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            バイナリ文字列の評価は、引数値がバイナリ文字列型で、引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、必要に応じて引数値が符号なし 64 ビット整数に変換されます。 
          </p></li><li class="listitem"><p>
            バイナリ文字列の評価では、引数値と同じ長さのバイナリ文字列が生成されます。 引数値の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 引数のサイズが 511 バイトを超えると、<code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
          </p></li></ul></div><p>
        すべての値が <code class="literal">NULL</code> でないかぎり、<code class="literal">NULL</code> 値は結果に影響しません。 その場合、結果は引数値の長さと同じ長さの中立値になります (<code class="literal">BIT_AND()</code> の場合はすべてのビット 1、<code class="literal">BIT_OR()</code> の場合はすべてのビット 0 および <code class="literal">BIT_XOR()</code>)。 
      </p><p>
        例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (group_id INT, a VARBINARY(6));</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (1, NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (1, NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (2, NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (2, X'1234');</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (2, X'FF34');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(BIT_AND(a)), HEX(BIT_OR(a)), HEX(BIT_XOR(a))</code></strong>
       <strong class="userinput"><code>FROM t GROUP BY group_id;</code></strong>
+-----------------+----------------+-----------------+
| HEX(BIT_AND(a)) | HEX(BIT_OR(a)) | HEX(BIT_XOR(a)) |
+-----------------+----------------+-----------------+
| FFFFFFFFFFFF    | 000000000000   | 000000000000    |
| 1234            | FF34           | ED00            |
+-----------------+----------------+-----------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-literal-handling"></a>16 進数リテラル、ビットリテラルおよび NULL リテラルの特殊な処理</h3></div></div></div><p>
        下位互換性のため、すべてのビット引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルの場合、MySQL 8.0 は数値コンテキストでビット操作を評価します。 つまり、すべてのビット引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルである場合、バイナリ文字列ビット引数に対するビット操作ではバイナリ文字列評価は使用されません。 (<code class="literal">_binary</code> イントロデューサ、<code class="literal">BINARY</code> 演算子、またはバイナリ文字列として明示的に指定するその他の方法を使用して記述されている場合、このようなリテラルには適用されません。) 
      </p><p>
        ここで説明したリテラル処理は、MySQL 8.0 の前と同じです。 例: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            次のビット操作では、数値コンテキストのリテラルが評価され、<code class="literal">BIGINT</code> 結果が生成されます:
          </p><pre class="programlisting">b'0001' | b'0010'
X'0008' &lt;&lt; 8
</pre></li><li class="listitem"><p>
            これらのビット操作は、数値コンテキストで <code class="literal">NULL</code> を評価し、<code class="literal">NULL</code> 値を持つ <code class="literal">BIGINT</code> 結果を生成します:
          </p><pre class="programlisting">NULL &amp; NULL
NULL &gt;&gt; 4
</pre></li></ul></div><p>
        MySQL 8.0 では、少なくとも 1 つの引数がバイナリ文字列であることを明示的に示すことで、これらの操作でバイナリ文字列コンテキストの引数を評価できます:
      </p><pre class="programlisting">_binary b'0001' | b'0010'
_binary X'0008' &lt;&lt; 8
BINARY NULL &amp; NULL
BINARY NULL &gt;&gt; 4
</pre><p>
        最後の 2 つの式の結果は、<code class="literal">BINARY</code> 演算子を使用しない場合と同様に <code class="literal">NULL</code> ですが、結果のデータ型は整数型ではなくバイナリ文字列型です。
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="bit-operations-incompatibilities"></a>MySQL 5.7 とのビット操作の非互換性</h3></div></div></div><p>
        ビット操作ではバイナリ文字列引数を MySQL 8.0 でネイティブに処理できるため、一部の式では 5.7 とは異なる結果が MySQL 8.0 で生成されます。 監視する問題のある 5 つの式タイプは次のとおりです: 
      </p><pre class="programlisting"><em class="replaceable"><code>nonliteral_binary</code></em> { &amp; | ^ } <em class="replaceable"><code>binary</code></em>
<em class="replaceable"><code>binary</code></em>  { &amp; | ^ } <em class="replaceable"><code>nonliteral_binary</code></em>
<em class="replaceable"><code>nonliteral_binary</code></em> { &lt;&lt; &gt;&gt; } <em class="replaceable"><code>anything</code></em>
~ <em class="replaceable"><code>nonliteral_binary</code></em>
<em class="replaceable"><code>AGGR_BIT_FUNC</code></em>(<em class="replaceable"><code>nonliteral_binary</code></em>)
</pre><p>
        これらの式は、8.0 のバイナリ文字列である MySQL 5.7 の <code class="literal">BIGINT</code> を返します。
      </p><p>
        表記法:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">{ <em class="replaceable"><code>op1</code></em> <em class="replaceable"><code>op2</code></em> ... }</code>: 指定された式タイプに適用される演算子のリスト。
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>binary</code></em>: 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルを含む任意の種類のバイナリ文字列引数。
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>nonliteral_binary</code></em>: 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラル以外のバイナリ文字列値である引数。
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>AGGR_BIT_FUNC</code></em>: ビット値引数を取る集計関数: <code class="literal">BIT_AND()</code>, <code class="literal">BIT_OR()</code>, <code class="literal">BIT_XOR()</code>。
          </p></li></ul></div><p>
        MySQL 5.7 と 8.0 間の潜在的な非互換性のために MySQL 5.7 で準備する方法の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/" target="_top">MySQL 5.7 Reference Manual</a> の <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/bit-functions.html" target="_top">Bit Functions and Operators</a> を参照してください。
      </p><p>
        次のリストでは、使用可能なビット関数および演算子について説明します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_bitwise-or"></a><p>
            <code class="literal">|</code>
          </p><a class="indexterm" name="idm46041620157376"></a><a class="indexterm" name="idm46041620155872"></a><p>
            ビット単位の OR
          </p><p>
            結果の型は、引数がバイナリ文字列として評価されるか数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数がバイナリ文字列型で、少なくともそのいずれかが 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、引数は必要に応じて符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数と同じ長さのバイナリ文字列が生成されます。 引数の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 29 | 15;</code></strong>
        -&gt; 31
mysql&gt; <strong class="userinput"><code>SELECT _binary X'40404040' | X'01020304';</code></strong>
        -&gt; 'ABCD'
</pre></li><li class="listitem"><a name="operator_bitwise-and"></a><p>
            <code class="literal">&amp;</code>
          </p><a class="indexterm" name="idm46041620138400"></a><a class="indexterm" name="idm46041620136896"></a><p>
            ビット単位の AND
          </p><p>
            結果の型は、引数がバイナリ文字列として評価されるか数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数がバイナリ文字列型で、少なくともそのいずれかが 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、引数は必要に応じて符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数と同じ長さのバイナリ文字列が生成されます。 引数の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 29 &amp; 15;</code></strong>
        -&gt; 13
mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'FF' &amp; b'11110000');</code></strong>
        -&gt; 'F0'
</pre></li><li class="listitem"><a name="operator_bitwise-xor"></a><p>
            <code class="literal">^</code>
          </p><a class="indexterm" name="idm46041620119648"></a><a class="indexterm" name="idm46041620118144"></a><p>
            ビット単位の XOR
          </p><p>
            結果の型は、引数がバイナリ文字列として評価されるか数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数がバイナリ文字列型で、少なくともそのいずれかが 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、引数は必要に応じて符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数と同じ長さのバイナリ文字列が生成されます。 引数の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 ^ 1;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 ^ 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 11 ^ 3;</code></strong>
        -&gt; 8
mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'FEDC' ^ X'1111');</code></strong>
        -&gt; 'EFCD'
</pre></li><li class="listitem"><a name="operator_left-shift"></a><p>
            <code class="literal">&lt;&lt;</code>
          </p><a class="indexterm" name="idm46041620099312"></a><p>
            longlong (<code class="literal">BIGINT</code>) 数値またはバイナリ文字列を左にシフトします。
          </p><p>
            結果の型は、bit 引数がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、bit 引数がバイナリ文字列型で、16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は、必要に応じて引数を符号なし 64 ビット整数に変換することで、数値の評価が行われます。 
              </p></li><li class="listitem"><p>
                binary-string 評価では、bit 引数と同じ長さのバイナリ文字列が生成されます。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            値の末尾からシフトされたビットは、引数の型に関係なく、警告なしで失われます。 特に、シフトカウントが bit 引数のビット数以上の場合、結果のすべてのビットは 0 になります。 
          </p><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 &lt;&lt; 2;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'00FF00FF00FF' &lt;&lt; 8);</code></strong>
        -&gt; 'FF00FF00FF00'
</pre></li><li class="listitem"><a name="operator_right-shift"></a><p>
            <code class="literal">&gt;&gt;</code>
          </p><a class="indexterm" name="idm46041620081392"></a><p>
            longlong (<code class="literal">BIGINT</code>) 数値またはバイナリ文字列を右にシフトします。
          </p><p>
            結果の型は、bit 引数がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、bit 引数がバイナリ文字列型で、16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は、必要に応じて引数を符号なし 64 ビット整数に変換することで、数値の評価が行われます。 
              </p></li><li class="listitem"><p>
                binary-string 評価では、bit 引数と同じ長さのバイナリ文字列が生成されます。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            値の末尾からシフトされたビットは、引数の型に関係なく、警告なしで失われます。 特に、シフトカウントが bit 引数のビット数以上の場合、結果のすべてのビットは 0 になります。 
          </p><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 4 &gt;&gt; 2;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT HEX(_binary X'00FF00FF00FF' &gt;&gt; 8);</code></strong>
        -&gt; '0000FF00FF00'
</pre></li><li class="listitem"><a name="operator_bitwise-invert"></a><p>
            <code class="literal">~</code>
          </p><a class="indexterm" name="idm46041620063536"></a><p>
            すべてのビットを反転します。
          </p><p>
            結果の型は、bit 引数がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、bit 引数がバイナリ文字列型で、16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は、必要に応じて引数を符号なし 64 ビット整数に変換することで、数値の評価が行われます。 
              </p></li><li class="listitem"><p>
                binary-string 評価では、bit 引数と同じ長さのバイナリ文字列が生成されます。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            詳細は、このセクションの概要の説明を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 5 &amp; ~1;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT HEX(~X'0000FFFF1111EEEE');</code></strong>
        -&gt; 'FFFF0000EEEE1111'
</pre></li><li class="listitem"><a name="function_bit-count"></a><p>
            <code class="literal">BIT_COUNT(<em class="replaceable"><code>N</code></em>)</code>
          </p><a class="indexterm" name="idm46041620047488"></a><p>
            引数 <em class="replaceable"><code>N</code></em> に符号なし 64 ビット整数として設定されているビット数を返します。引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT(64), BIT_COUNT(BINARY 64);</code></strong>
        -&gt; 1, 7
mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT('64'), BIT_COUNT(_binary '64');</code></strong>
        -&gt; 1, 7
mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT(X'40'), BIT_COUNT(_binary X'40');</code></strong>
        -&gt; 1, 1
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="encryption-functions"></a>12.14 暗号化関数と圧縮関数</h2></div></div></div><a class="indexterm" name="idm46041620036512"></a><a class="indexterm" name="idm46041620035072"></a><div class="table"><a name="idm46041620033040"></a><p class="title"><b>表 12.18 「暗号化関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「暗号化関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></td>
<td>
      AES を使用して復号化します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></td>
<td>
      AES を使用して暗号化します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></td>
<td>
      バイナリ文字列として結果を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></td>
<td>
      MD5 チェックサムを計算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></td>
<td>
      ランダムなバイトベクトルを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code>, <code class="literal">SHA()</code></a></td>
<td>
      SHA-1 160 ビットチェックサムを計算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></td>
<td>
      SHA-2 チェックサムを計算します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a></td>
<td>
      ステートメントダイジェストハッシュ値の計算
    </td>
</tr><tr><td><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a></td>
<td>
      正規化されたステートメントダイジェストの計算
    </td>
</tr><tr><td><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></td>
<td>
      圧縮された文字列を圧縮解除します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></td>
<td>
      圧縮前の文字列長を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></td>
<td>
      パスワードの強度を判断します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
      多くの暗号化関数および圧縮関数では、結果に任意のバイト値が含まれている可能性のある文字列が返されます。 これらの結果を格納する場合は、<code class="literal">VARBINARY</code> または <code class="literal">BLOB</code> バイナリ文字列データ型のカラムを使用します。 これにより、バイナリ以外の文字列データ型 (<code class="literal">CHAR</code>, <code class="literal">VARCHAR</code>, <code class="literal">TEXT</code>) を使用している場合など、データ値を変更する可能性がある後続の領域削除または文字セット変換の潜在的な問題を回避できます。 
    </p><p>
      一部の暗号化関数は ASCII 文字の文字列を返します: <code class="literal">MD5()</code>, <code class="literal">SHA()</code>, <code class="literal">SHA1()</code>, <code class="literal">SHA2()</code>, <code class="literal">STATEMENT_DIGEST()</code>, <code class="literal">STATEMENT_DIGEST_TEXT()</code>。 戻り値は、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数によって決定される文字セットと照合順序を持つ文字列です。 これは、文字セットが <code class="literal">binary</code> でないかぎり、非バイナリ文字列です。 
    </p><p>
      アプリケーションで 16 進数の文字列を返す関数 (<code class="literal">MD5()</code> や <code class="literal">SHA1()</code> など) からの値を格納する場合は、<code class="literal">UNHEX()</code> を使用して 16 進表現をバイナリに変換し、その結果を <code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code> カラムに格納すれば、より効率的な格納および比較を実現できます。 16 進数の各ペアにはバイナリ形式で 1 バイトが必要であるため、<em class="replaceable"><code>N</code></em> の値は 16 進数文字列の長さに依存します。 <em class="replaceable"><code>N</code></em> は、<code class="literal">MD5()</code> 値の場合は 16、<code class="literal">SHA1()</code> の場合は 20 です。 <code class="literal">SHA2()</code> の場合、<em class="replaceable"><code>N</code></em> の範囲は、結果の目的のビット長を指定する引数に応じて 28 から 32 までです。 
    </p><p>
      <code class="literal">utf8</code> 文字セット (文字ごとに 4 バイト使用されます) が使用されるカラムに値が格納される場合に、16 進文字列を <code class="literal">CHAR</code> カラムに格納する際のサイズのペナルティーは最小で 2 回、最大で 8 回です。 また、文字列を格納すると、値が大きくなり、文字セットの照合順序ルールを考慮に入れる必要があるため、比較が遅くなります。 
    </p><p>
      アプリケーションで <code class="literal">MD5()</code> 文字列値が <code class="literal">CHAR(32)</code> カラムに格納されると仮定します。
    </p><pre class="programlisting">CREATE TABLE md5_tbl (md5_val CHAR(32), ...);
INSERT INTO md5_tbl (md5_val, ...) VALUES(MD5('abcdef'), ...);
</pre><p>
      16 進文字列をよりコンパクトな形式に変換するには、次のように、代わりに <code class="literal">UNHEX()</code> および <code class="literal">BINARY(16)</code> が使用されるようにアプリケーションを変更します。
    </p><pre class="programlisting">CREATE TABLE md5_tbl (md5_val BINARY(16), ...);
INSERT INTO md5_tbl (md5_val, ...) VALUES(UNHEX(MD5('abcdef')), ...);
</pre><p>
      ハッシュ関数が 2 つの異なる入力値に同じ値を生成するという非常にまれなケースに対応できるように、アプリケーションが準備されるはずです。 競合を検出可能にする方法の 1 つは、ハッシュカラムを主キーにすることです。 
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        MD5 および SHA-1 アルゴリズムの悪用が知られています。 かわりに、このセクションで説明されている別の一方向暗号化機能 (<code class="literal">SHA2()</code> など) の使用を検討してください。 
      </p></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
        暗号化機能の引数として指定されたパスワードまたはその他の機密値は、SSL 接続が使用されないかぎり、クリアテキストとして MySQL サーバーに送信されます。 また、このような値は、書き込まれるすべての MySQL ログに表示されます。 このようなタイプの露出を回避するために、アプリケーションはクライアント側で機密の値を暗号化してから、サーバーに送信できます。 同じ考慮事項が暗号化鍵にも適用されます。 これらの露出を回避するために、アプリケーションはストアドプロシージャーを使用して、サーバー側で値を暗号化および復号化できます。 
      </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_aes-decrypt"></a><p>
          <code class="literal">AES_DECRYPT(<em class="replaceable"><code>crypt_str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code>
        </p><a class="indexterm" name="idm46041619941264"></a><p>
          この関数は、公式の AES (Advanced Encryption Standard) アルゴリズムを使用してデータを復号化します。 詳細は、<code class="literal">AES_ENCRYPT()</code> の説明を参照してください。 
        </p><p>
          <code class="literal">AES_DECRYPT()</code> を使用するステートメントは、ステートメントベースのレプリケーションでは安全ではありません。
        </p></li><li class="listitem"><a name="function_aes-encrypt"></a><p>
          <code class="literal">AES_ENCRYPT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code>
        </p><a class="indexterm" name="idm46041619929520"></a><p>
          <code class="literal">AES_ENCRYPT()</code> および <code class="literal">AES_DECRYPT()</code> では、AES (Advanced Encryption Standard) アルゴリズム (以前は <span class="quote">「<span class="quote">Rijndael</span>」</span> と呼ばれていました) を使用したデータの暗号化および復号化が実装されます。 AES の標準では、さまざまな鍵の長さが許可されます。 デフォルトでは、これらの関数で鍵の長さが 128 ビットの AES が実装されます。 あとで説明するように、196 または 256 ビットの鍵の長さを使用できます。 鍵の長さは、パフォーマンスとセキュリティーの間でのトレードオフです。 
        </p><p>
          <code class="literal">AES_ENCRYPT()</code> は、鍵文字列 <em class="replaceable"><code>key_str</code></em> を使用して文字列 <em class="replaceable"><code>str</code></em> を暗号化し、暗号化された出力を含むバイナリ文字列を返します。 <code class="literal">AES_DECRYPT()</code> は、鍵文字列 <em class="replaceable"><code>key_str</code></em> を使用して暗号化された文字列 <em class="replaceable"><code>crypt_str</code></em> を復号化し、元のプレーンテキスト文字列を返します。 関数引数のいずれかが <code class="literal">NULL</code> の場合は、関数で <code class="literal">NULL</code> が返されます。 
        </p><p>
          <em class="replaceable"><code>str</code></em> および <em class="replaceable"><code>crypt_str</code></em> 引数は任意の長さにすることができ、AES などのブロックベースのアルゴリズムによって、必要に応じてブロックの倍数になるように、自動的にパディングが <em class="replaceable"><code>str</code></em> に追加されます。 このパディングは、<code class="literal">AES_DECRYPT()</code> 関数によって自動的に削除されます。 <em class="replaceable"><code>crypt_str</code></em> の長さは、次の公式を使用して計算できます。 
        </p><pre class="programlisting">16 * (trunc(<em class="replaceable"><code>string_length</code></em> / 16) + 1)
</pre><p>
          鍵の長さが 128 ビットの場合、<em class="replaceable"><code>key_str</code></em> 引数に鍵を渡すもっともセキュアな方法は、完全にランダムな 128 ビット値を作成し、それをバイナリ値として渡すことです。 例: 
        </p><pre class="programlisting">INSERT INTO t
VALUES (1,AES_ENCRYPT('text',UNHEX('F3229A0B371ED2D9441B830D21A390C3')));
</pre><p>
          パスフレーズを使用すると、パスフレーズをハッシュ化することで AES 鍵を生成できます。 例: 
        </p><pre class="programlisting">INSERT INTO t
VALUES (1,AES_ENCRYPT('text', UNHEX(SHA2('My secret passphrase',512))));
</pre><p>
          パスワードまたはパスフレーズは直接 <em class="replaceable"><code>crypt_str</code></em> に渡さず、最初にハッシュ化してください。 このドキュメントの以前のバージョンでは、従来のアプローチが提案されていましたが、ここで示す例の方がセキュアであるため、推奨されなくなりました。 
        </p><p>
          <code class="literal">AES_DECRYPT()</code> で無効な日付または不正なパディングが検出された場合は、<code class="literal">NULL</code> が返されます。 ただし、入力データまたは鍵が無効になっている場合は、<code class="literal">AES_DECRYPT()</code> で <code class="literal">NULL</code> 以外の値 (ごみの可能性もあります) が返される可能性があります。 
        </p><p>
          <code class="literal">AES_ENCRYPT()</code> および <code class="literal">AES_DECRYPT()</code> は、ブロック暗号化モードの制御を許可し、オプションの <em class="replaceable"><code>init_vector</code></em> 初期化ベクトル引数を取ります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">block_encryption_mode</code> システム変数は、ブロックベースの暗号化アルゴリズムのモードを制御します。 そのデフォルト値は、128 ビットの鍵の長さと ECB モードを使用した暗号化を表す <code class="literal">aes-128-ecb</code> です。 この変数で許可されている値については、<a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              オプションの <em class="replaceable"><code>init_vector</code></em> 引数では、必要とするブロック暗号化モードに対応する初期化ベクトルが提供されます。
            </p></li></ul></div><p>
          オプションの <em class="replaceable"><code>init_vector</code></em> 引数が必要なモードでは、16 バイト以上の長さにする必要があります (16 を超えるバイトは無視されます)。 <em class="replaceable"><code>init_vector</code></em> が欠落している場合は、エラーが発生します。 
        </p><p>
          <em class="replaceable"><code>init_vector</code></em> が必要ないモードでは、これが無視され、指定されている場合は警告が生成されます。
        </p><p>
          <code class="literal">RANDOM_BYTES(16)</code> を呼び出すと、初期化ベクトルに使用されるバイトのランダム文字列を生成できます。 初期化ベクトルが必要な暗号化モードでは、暗号化および復号化でも同じベクトルを使用する必要があります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET block_encryption_mode = 'aes-256-cbc';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @key_str = SHA2('My secret passphrase',512);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @init_vector = RANDOM_BYTES(16);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @crypt_str = AES_ENCRYPT('text',@key_str,@init_vector);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AES_DECRYPT(@crypt_str,@key_str,@init_vector);</code></strong>
+-----------------------------------------------+
| AES_DECRYPT(@crypt_str,@key_str,@init_vector) |
+-----------------------------------------------+
| text                                          |
+-----------------------------------------------+
</pre><p>
          次のテーブルに、許可される各ブロック暗号化モードと、初期化ベクトル引数が必要かどうかを示します。
        </p><div class="informaltable"><table summary="The permitted encryption modes and whether the initialization vector argument is required for the mode."><col style="width: 30%"><col style="width: 35%"><thead><tr>
              <th>ブロック暗号化モード</th>
              <th>初期化ベクトルが必要</th>
            </tr></thead><tbody><tr>
              <td>ECB</td>
              <td>いいえ</td>
            </tr><tr>
              <td>CBC</td>
              <td>はい</td>
            </tr><tr>
              <td>CFB1</td>
              <td>はい</td>
            </tr><tr>
              <td>CFB8</td>
              <td>はい</td>
            </tr><tr>
              <td>CFB128</td>
              <td>はい</td>
            </tr><tr>
              <td>OFB</td>
              <td>はい</td>
            </tr></tbody></table></div><p>
          <code class="literal">AES_ENCRYPT()</code> または <code class="literal">AES_DECRYPT()</code> を使用するステートメントは、ステートメントベースのレプリケーションでは安全ではありません。
        </p></li><li class="listitem"><a name="function_compress"></a><p>
          <code class="literal">COMPRESS(<em class="replaceable"><code>string_to_compress</code></em>)</code>
        </p><a class="indexterm" name="idm46041619856608"></a><p>
          文字列を圧縮し、その結果をバイナリ文字列として返します。 この関数を使用するには、MySQL が <code class="literal">zlib</code> などの圧縮ライブラリを使用してコンパイルされている必要があります。 そうでない場合、戻り値は常に <code class="literal">NULL</code> になります。 圧縮された文字列は、<code class="literal">UNCOMPRESS()</code> を使用して圧縮解除できます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',1000)));</code></strong>
        -&gt; 21
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(''));</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS('a'));</code></strong>
        -&gt; 13
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',16)));</code></strong>
        -&gt; 15
</pre><p>
          圧縮された文字列の内容は、次の方法で格納されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              空の文字列は、空の文字列として格納されます。
            </p></li><li class="listitem"><p>
              空以外の文字列は、4 バイトの長さの圧縮されていない文字列として格納され (低いバイトが 1 番目)、そのあとに圧縮された文字列が続きます。 文字列が空白文字で終わる場合は、結果が <code class="literal">CHAR</code> または <code class="literal">VARCHAR</code> カラムに格納されていても、末尾の空白文字が削除されるという問題が回避されるように、<code class="literal">.</code> 文字が追加されます。 (ただし、<code class="literal">CHAR</code> や <code class="literal">VARCHAR</code> などの非バイナリ文字列のデータ型を使用して圧縮された文字列を格納すると、文字セットの変換が発生する可能性があるため、いずれにしても推奨されません。 代わりに、<code class="literal">VARBINARY</code> または <code class="literal">BLOB</code> バイナリ文字列のカラムを使用してください。) 
            </p></li></ul></div></li><li class="listitem"><a name="function_md5"></a><p>
          <code class="literal">MD5(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619830256"></a><p>
          文字列の MD5 128 ビットチェックサムを計算します。 値は 32 桁の 16 進数の文字列、または引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> として返されます。 たとえば、戻り値をハッシュ鍵として使用できます。 効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。 
        </p><p>
          戻り値は、接続文字セットの文字列です。
        </p><p>
          FIPS モードが有効な場合、<code class="function">MD5()</code> は <code class="literal">NULL</code> を返します。 <a class="xref" href="security.html#fips-mode" title="6.8 FIPS のサポート">セクション6.8「FIPS のサポート」</a>を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MD5('testing');</code></strong>
        -&gt; 'ae2b1fca515949e5d54fb22b8ed95575'
</pre><p>
          これは、<span class="quote">「<span class="quote">RSA Data Security, Inc. MD5 Message-Digest Algorithm</span>」</span> です。
        </p><p>
          このセクションの冒頭で示した MD5 アルゴリズムに関する注記を参照してください。
        </p></li><li class="listitem"><a name="function_random-bytes"></a><p>
          <code class="literal">RANDOM_BYTES(<em class="replaceable"><code>len</code></em>)</code>
        </p><a class="indexterm" name="idm46041619812752"></a><p>
          この関数は、SSL ライブラリの乱数ジェネレータを使用して生成された <em class="replaceable"><code>len</code></em> ランダムバイトのバイナリ文字列を戻します。 <em class="replaceable"><code>len</code></em> で許可されている値は、1 から 1024 までの範囲内です。 その範囲外の値の場合は、エラーが発生します。 
        </p><p>
          <code class="literal">RANDOM_BYTES()</code> を使用すると、<code class="literal">AES_DECRYPT()</code> および <code class="literal">AES_ENCRYPT()</code> 関数に初期化ベクトルを提供できます。 このコンテキストで使用するには、<em class="replaceable"><code>len</code></em> を 16 以上にする必要があります。 さらに大きい値も許可されますが、16 を超えるバイトは無視されます。 
        </p><p>
          <code class="literal">RANDOM_BYTES()</code> は、その結果を非決定的にするランダムな値を生成します。 したがって、この関数を使用するステートメントは、ステートメントベースレプリケーションでは安全ではありません。 
        </p></li><li class="listitem"><a name="function_sha1"></a><p>
          <code class="literal">SHA1(<em class="replaceable"><code>str</code></em>)</code>, <code class="literal">SHA(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619795648"></a><a class="indexterm" name="idm46041619794304"></a><p>
          RFC 3174 (Secure Hash Algorithm) で説明されているように、文字列の SHA-1 160 ビットチェックサムを計算します。 値は 40 桁の 16 進数の文字列、または引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> として返されます。 この関数を使用する一例として、ハッシュ鍵が考えられます。 効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。 <code class="literal">SHA()</code> は <code class="literal">SHA1()</code> のシノニムです。 
        </p><p>
          戻り値は、接続文字セットの文字列です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SHA1('abc');</code></strong>
        -&gt; 'a9993e364706816aba3e25717850c26c9cd0d89d'
</pre><p>
          <code class="literal">SHA1()</code> は <code class="literal">MD5()</code> と同等ですが、暗号化に関してはよりセキュアであると考えられます。 ただし、このセクションの冒頭で示した MD5 と SHA-1 アルゴリズムに関する注記を参照してください。 
        </p></li><li class="listitem"><a name="function_sha2"></a><p>
          <code class="literal">SHA2(<em class="replaceable"><code>str</code></em>, <em class="replaceable"><code>hash_length</code></em>)</code>
        </p><a class="indexterm" name="idm46041619775648"></a><p>
          SHA-2 ファミリのハッシュ関数 (SHA-224、SHA-256、SHA-384、および SHA-512) を計算します。 最初の引数は、ハッシュされるプレーンテキスト文字列です。 2 番目の引数には、結果の目的のビット長が指定されます。値は、224、256、384、512、または 0 (256 と同等です) にする必要があります。 引数のいずれかが <code class="literal">NULL</code> の場合や、ハッシュの長さが許可される値のいずれでもない場合は、戻り値が <code class="literal">NULL</code> になります。 それ以外の場合は、関数の結果が目的のビット数が含まれるハッシュ値になります。 効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。 
        </p><p>
          戻り値は、接続文字セットの文字列です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SHA2('abc', 224);</code></strong>
        -&gt; '23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7'
</pre><p>
          この関数は、MySQL が SSL サポートで構成されている場合のみ機能します。 <a class="xref" href="security.html#encrypted-connections" title="6.3 暗号化された接続の使用">セクション6.3「暗号化された接続の使用」</a>を参照してください。 
        </p><p>
          <code class="literal">SHA2()</code> は <code class="literal">MD5()</code> や <code class="literal">SHA1()</code> よりも、暗号化に関してはよりセキュアであると考えられます。
        </p></li><li class="listitem"><a name="function_statement-digest"></a><p>
          <code class="literal">STATEMENT_DIGEST(<em class="replaceable"><code>statement</code></em>)</code>
        </p><a class="indexterm" name="idm46041619757072"></a><p>
          SQL ステートメントを文字列として指定すると、ステートメントダイジェストハッシュ値を接続文字セットの文字列として、または引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> として戻します。 関連する <code class="literal">STATEMENT_DIGEST_TEXT()</code> 関数は、正規化されたステートメントダイジェストを返します。 ステートメントダイジェストの詳細は、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a> を参照してください。 
        </p><p>
          どちらの関数も、MySQL パーサーを使用してステートメントを解析します。 解析に失敗すると、エラーが発生します。 エラーメッセージに解析エラーが含まれるのは、ステートメントがリテラル文字列として指定されている場合のみです。 
        </p><p>
          <code class="literal">max_digest_length</code> システム変数は、正規化されたステートメントダイジェストを計算するためにこれらの関数で使用できる最大バイト数を決定します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @stmt = 'SELECT * FROM mytable WHERE cola = 10 AND colb = 20';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STATEMENT_DIGEST(@stmt);</code></strong>
+------------------------------------------------------------------+
| STATEMENT_DIGEST(@stmt)                                          |
+------------------------------------------------------------------+
| 3bb95eeade896657c4526e74ff2a2862039d0a0fe8a9e7155b5fe492cbd78387 |
+------------------------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT STATEMENT_DIGEST_TEXT(@stmt);</code></strong>
+----------------------------------------------------------+
| STATEMENT_DIGEST_TEXT(@stmt)                             |
+----------------------------------------------------------+
| SELECT * FROM `mytable` WHERE `cola` = ? AND `colb` = ?  |
+----------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_statement-digest-text"></a><p>
          <code class="literal">STATEMENT_DIGEST_TEXT(<em class="replaceable"><code>statement</code></em>)</code>
        </p><a class="indexterm" name="idm46041619738256"></a><p>
          SQL ステートメントを文字列として指定すると、正規化されたステートメントダイジェストを接続文字セットの文字列として、または引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> として返します。 その他の説明と例については、関連する <code class="literal">STATEMENT_DIGEST()</code> 関数の説明を参照してください。 
        </p></li><li class="listitem"><a name="function_uncompress"></a><p>
          <code class="literal">UNCOMPRESS(<em class="replaceable"><code>string_to_uncompress</code></em>)</code>
        </p><a class="indexterm" name="idm46041619728304"></a><p>
          <code class="literal">COMPRESS()</code> 関数で圧縮された文字列を圧縮解除します。 引数が圧縮された値でない場合は、結果が <code class="literal">NULL</code> になります。 この関数を使用するには、MySQL が <code class="literal">zlib</code> などの圧縮ライブラリを使用してコンパイルされている必要があります。 そうでない場合、戻り値は常に <code class="literal">NULL</code> になります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESS(COMPRESS('any string'));</code></strong>
        -&gt; 'any string'
mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESS('any string');</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_uncompressed-length"></a><p>
          <code class="literal">UNCOMPRESSED_LENGTH(<em class="replaceable"><code>compressed_string</code></em>)</code>
        </p><a class="indexterm" name="idm46041619713552"></a><p>
          圧縮された文字列が圧縮される前の長さを返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESSED_LENGTH(COMPRESS(REPEAT('a',30)));</code></strong>
        -&gt; 30
</pre></li><li class="listitem"><a name="function_validate-password-strength"></a><p>
          <code class="literal">VALIDATE_PASSWORD_STRENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619703232"></a><p>
          プレーンテキストパスワードを表す引数を指定すると、この関数はパスワードの強さを示す整数を戻します。 戻り値は、0 (弱) から 100 (強) までの範囲内です。 
        </p><p>
          <code class="literal">VALIDATE_PASSWORD_STRENGTH()</code> によるパスワード評価は、<code class="literal">validate_password</code> コンポーネントによって実行されます。 そのコンポーネントがインストールされていない場合、この関数は常に 0 を返します。 <code class="literal">validate_password</code> のインストールの詳細は、<a class="xref" href="security.html#validate-password" title="6.4.3 パスワード検証コンポーネント">セクション6.4.3「パスワード検証コンポーネント」</a> を参照してください。 パスワードテストに影響するパラメータを調査または構成するには、<code class="literal">validate_password</code> によって実装されるシステム変数を確認または設定します。 <a class="xref" href="security.html#validate-password-options-variables" title="6.4.3.2 パスワード検証オプションおよび変数">セクション6.4.3.2「パスワード検証オプションおよび変数」</a>を参照してください。 
        </p><p>
          パスワードは、一段と厳密になったテストの対象であり、戻り値は、次の表に示すように、どのテストに合格したのかを示します。 また、<code class="literal">validate_password.check_user_name</code> システム変数が有効で、パスワードがユーザー名と一致する場合、他の <code class="literal">validate_password</code> システム変数の設定方法に関係なく、<code class="literal">VALIDATE_PASSWORD_STRENGTH()</code> は 0 を返します。 
        </p><div class="informaltable"><table summary="Password tests of the VALIDATE_PASSWORD_STRENGTH() function and the values returned by each password test."><col style="width: 60%"><col style="width: 20%"><thead><tr>
              <th>パスワードテスト</th>
              <th>戻り値</th>
            </tr></thead><tbody><tr>
              <td>長さ &lt;= 4</td>
              <td>0</td>
            </tr><tr>
              <td>長さ ≥4 および &lt; <code class="literal">validate_password.length</code></td>
              <td>25</td>
            </tr><tr>
              <td>ポリシー 1 を満たす (<code class="literal">LOW</code>)</td>
              <td>50</td>
            </tr><tr>
              <td>ポリシー 2 を満たす (<code class="literal">MEDIUM</code>)</td>
              <td>75</td>
            </tr><tr>
              <td>ポリシー 3 を満たす (<code class="literal">STRONG</code>)</td>
              <td>100</td>
            </tr></tbody></table></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="locking-functions"></a>12.15 ロック関数</h2></div></div></div><a class="indexterm" name="idm46041619669376"></a><a class="indexterm" name="idm46041619667920"></a><p>
      このセクションでは、ユーザーレベルロックの操作に使用される関数について説明します。
    </p><div class="table"><a name="idm46041619665216"></a><p class="title"><b>表 12.19 「ロック関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「ロック関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></td>
<td>
      名前付きロックを取得します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></td>
<td>
      名前付きロックが解放されているかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></td>
<td>
      指定されたロックが使用中かどうか。true の場合は接続識別子を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_release-all-locks"><code class="literal">RELEASE_ALL_LOCKS()</code></a></td>
<td>
      現在の名前付きロックをすべて解放
    </td>
</tr><tr><td><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></td>
<td>
      指定したロックを解放
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_get-lock"></a><p>
          <code class="literal">GET_LOCK(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>timeout</code></em>)</code>
        </p><a class="indexterm" name="idm46041619638048"></a><a class="indexterm" name="idm46041619636704"></a><p>
          <em class="replaceable"><code>timeout</code></em> 秒のタイムアウトを使用して、文字列 <em class="replaceable"><code>str</code></em> で指定された名前でロックの取得を試みます。 負の <em class="replaceable"><code>timeout</code></em> 値は、無限のタイムアウトを表します。 ロックは排他的です。 あるセッションで保持されている間は、他のセッションは同じ名前のロックを取得できません。 
        </p><p>
          ロックの取得に成功した場合は <code class="literal">1</code> を返し、試行がタイムアウトになった場合 (たとえば、ほかのクライアントがすでにその名前をロックしている場合) は <code class="literal">0</code> を返し、エラー (メモリー不足や <span class="command"><strong>mysqladmin kill</strong></span> によるスレッドの停止など) が発生した場合は <code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">GET_LOCK()</code> で取得されたロックは、<code class="literal">RELEASE_LOCK()</code> を実行して明示的に解放されるか、セッションの終了時に暗黙的に解放されます (通常または異常)。 <code class="literal">GET_LOCK()</code> で取得されたロックは、トランザクションのコミットまたはロールバック時に解放されません。 
        </p><p>
          <code class="literal">GET_LOCK()</code> は、メタデータロック (MDL) サブシステムを使用して実装されます。 複数の同時ロックを取得でき、<code class="literal">GET_LOCK()</code> は既存のロックを解放しません。 たとえば、次のステートメントを実行するとします: 
        </p><pre class="programlisting">SELECT GET_LOCK('lock1',10);
SELECT GET_LOCK('lock2',10);
SELECT RELEASE_LOCK('lock2');
SELECT RELEASE_LOCK('lock1');
</pre><p>
          2 つ目の <code class="literal">GET_LOCK()</code> は 2 つ目のロックを取得し、両方の <code class="literal">RELEASE_LOCK()</code> コールは 1 (成功) を返します。
        </p><p>
          特定のセッションで同じ名前の複数のロックを取得することもできます。 他のセッションは、取得しているセッションがその名前のロックをすべて解放するまで、その名前のロックを取得できません。 
        </p><p>
          <code class="literal">GET_LOCK()</code> で取得された一意の名前付きロックは、パフォーマンススキーマの <code class="literal">metadata_locks</code> テーブルに表示されます。 <code class="literal">OBJECT_TYPE</code> カラムには <code class="literal">USER LEVEL LOCK</code> と示され、<code class="literal">OBJECT_NAME</code> カラムにはロック名が示されます。 <span class="emphasis"><em>same</em></span> 名に対して複数のロックが取得された場合、その名前の最初のロックのみが <code class="literal">metadata_locks</code> テーブルの行を登録します。 名前の後続のロックでは、ロック内のカウンタが増分されますが、追加のメタデータロックは取得されません。 名前の最後のロックインスタンスが解放されると、ロックの <code class="literal">metadata_locks</code> 行が削除されます。 
        </p><p>
          複数のロックを取得する機能は、クライアント間でデッドロックが発生する可能性があることを意味します。 これが発生すると、サーバーは呼出し側を選択し、そのロック取得リクエストを <code class="literal">ER_USER_LOCK_DEADLOCK</code> エラーで終了します。 このエラーによってトランザクションがロールバックされることはありません。 
        </p><p>
          MySQL では、64 文字のロック名に最大長が適用されます。
        </p><p>
          <code class="literal">GET_LOCK()</code> を使用すると、アプリケーションロックを実装したり、レコードロックのシミュレーションを行なったりできます。 名前はサーバー全体にわたってロックされます。 1 つのセッション内で名前がロックされた場合は、<code class="literal">GET_LOCK()</code> によって、別のセッションによる同じ名前を持つロックのリクエストがブロックされます。 これにより、指定されたロック名について合意したクライアントは、その名前を使用すると共同のアドバイザリロックを実行できます。 ただし、共同するクライアントのセットに属さないクライアントも、不注意と故意のどちらででも、名前をロックできることに注意してください。したがって、共同するクライアントがその名前をロックできないようにしてください。 この可能性を減らす方法の 1 つは、データベース固有またはアプリケーション固有のロック名を使用することです。 たとえば、<em class="replaceable"><code>db_name.str</code></em> または <em class="replaceable"><code>app_name.str</code></em> 形式のロック名を使用します。 
        </p><p>
          複数のクライアントがロックを待機している場合、それらがロックを取得する順序は定義されていません。 アプリケーションでは、クライアントがロックリクエストを発行した順序と同じ順序でロックを取得することを想定しないでください。 
        </p><p>
          <code class="literal">GET_LOCK()</code> は、ステートメントベースのレプリケーションでは安全ではありません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            複数の名前付きロックを取得する機能を使用すると、単一のステートメントで多数のロックを取得できます。 例: 
          </p><pre class="programlisting">INSERT INTO ... SELECT GET_LOCK(t1.col_name) FROM t1;
</pre><p>
            これらのタイプのステートメントには、特定の悪影響がある場合があります。 たとえば、ステートメントが途中で失敗してロールバックされた場合、障害ポイントまで取得されたロックは引き続き存在します。 目的が、挿入された行と取得されたロックの間に対応するものである場合、その目的は満たされません。 また、ロックが特定の順序で付与されることが重要な場合は、オプティマイザが選択する実行計画によって結果セットの順序が異なる可能性があることに注意してください。 このような理由から、アプリケーションをステートメントごとに単一のロック取得コールに制限することをお薦めします。 
          </p></div><p>
          プラグインサービスまたは一連のユーザー定義関数として、別のロックインタフェースを使用できます。 このインタフェースは、<code class="literal">GET_LOCK()</code> および関連する関数によって提供されるインタフェースとは異なり、ロック名前空間と個別の読み取り/書き込みロックを提供します。 詳細は、<a class="xref" href="server-administration.html#locking-service" title="5.6.8.1 ロックサービス">セクション5.6.8.1「ロックサービス」</a>を参照してください。 
        </p></li><li class="listitem"><a name="function_is-free-lock"></a><p>
          <code class="literal">IS_FREE_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619583648"></a><p>
          <em class="replaceable"><code>str</code></em> という名前が付けられたロックが使用可能であるか (つまり、ロックされていないか) どうかをチェックします。 ロックが使用可能である (だれもロックを使用していない) 場合は <code class="literal">1</code> を返し、使用中である場合は <code class="literal">0</code> を返し、エラー (不正な引数など) が発生した場合は <code class="literal">NULL</code> を返します。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_is-used-lock"></a><p>
          <code class="literal">IS_USED_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619569968"></a><p>
          <em class="replaceable"><code>str</code></em> という名前が付けられたロックが使用中であるか (つまり、ロックされているか) どうかをチェックします。 その場合は、ロックを保持するクライアントセッションの接続識別子を返します。 そうでない場合は、<code class="literal">NULL</code> を返します。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_release-all-locks"></a><p>
          <code class="literal">RELEASE_ALL_LOCKS()</code>
        </p><a class="indexterm" name="idm46041619558064"></a><p>
          現在のセッションで保持されているすべての名前付きロックを解放し、解放されたロックの数を返します (存在しなかった場合は 0)
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_release-lock"></a><p>
          <code class="literal">RELEASE_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619547248"></a><p>
          <code class="literal">GET_LOCK()</code> を使用して取得された文字列 <em class="replaceable"><code>str</code></em> によって名前が付けられたロックを解除します。 ロックが解除された場合は <code class="literal">1</code> を返し、このスレッドによってロックが確立されなかった場合 (その場合、ロックは解除されません) は <code class="literal">0</code> を返し、名前付きのロックが存在しない場合は <code class="literal">NULL</code> を返します。 <code class="literal">GET_LOCK()</code> を呼び出しても取得されなかった場合や、事前に解除された場合は、ロックが存在しません。 
        </p><p>
          <code class="literal">DO</code> ステートメントは、<code class="literal">RELEASE_LOCK()</code> とともに使用すると便利です。 <a class="xref" href="sql-statements.html#do" title="13.2.3 DO ステートメント">セクション13.2.3「DO ステートメント」</a>を参照してください。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="information-functions"></a>12.16 情報関数</h2></div></div></div><a class="indexterm" name="idm46041619531280"></a><a class="indexterm" name="idm46041619529808"></a><div class="table"><a name="idm46041619527776"></a><p class="title"><b>表 12.20 「情報関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「情報関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></td>
<td>
      式を繰り返し実行します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></td>
<td>
      引数の文字セットを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></td>
<td>
      文字列引数の照合順序強制性値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></td>
<td>
      文字列引数の照合順序を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></td>
<td>
      接続のための接続 ID (スレッド ID) を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a></td>
<td>
      現在アクティブなロールを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code>, <code class="literal">CURRENT_USER</code></a></td>
<td>
      認証済みユーザー名とホスト名
    </td>
</tr><tr><td><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></td>
<td>
      デフォルト (現在) のデータベース名を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></td>
<td>
      LIMIT 句付き SELECT で、LIMIT 句がない場合に戻される可能性がある行の数です
    </td>
</tr><tr><td><a class="link" href="functions.html#function_icu-version"><code class="literal">ICU_VERSION()</code></a></td>
<td>
      ICU ライブラリバージョン
    </td>
</tr><tr><td><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></td>
<td>
      前回の INSERT での AUTOINCREMENT カラムの値です
    </td>
</tr><tr><td><a class="link" href="functions.html#function_roles-graphml"><code class="literal">ROLES_GRAPHML()</code></a></td>
<td>
      メモリーロールのサブグラフを表す GraphML ドキュメントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></td>
<td>
      更新された行数
    </td>
</tr><tr><td><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></td>
<td>
      DATABASE() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></td>
<td>
      USER() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></td>
<td>
      USER() のシノニムです
    </td>
</tr><tr><td><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></td>
<td>
      ユーザー名と、クライアントによって提供されるホスト名です
    </td>
</tr><tr><td><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></td>
<td>
      MySQL サーバーのバージョンを示す文字列を返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_benchmark"></a><p>
          <code class="literal">BENCHMARK(<em class="replaceable"><code>count</code></em>,<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041619459984"></a><p>
          <code class="literal">BENCHMARK()</code> 関数は、式 <em class="replaceable"><code>expr</code></em> を <em class="replaceable"><code>count</code></em> の回数だけ繰り返し実行します。 MySQL による式の処理速度を計測する際に使用される場合もあります。 <code class="literal">NULL</code> や負の繰返し回数などの不適切な引数の場合、結果値は <code class="literal">0</code> または <code class="literal">NULL</code> です。 
        </p><p>
          この使用目的は、<span class="command"><strong>mysql</strong></span> クライアント内から、クエリーの実行時間をレポートすることです。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BENCHMARK(1000000,AES_ENCRYPT('hello','goodbye'));</code></strong>
+---------------------------------------------------+
| BENCHMARK(1000000,AES_ENCRYPT('hello','goodbye')) |
+---------------------------------------------------+
|                                                 0 |
+---------------------------------------------------+
1 row in set (4.74 sec)
</pre><p>
          レポートされる時間は、クライアント側での経過時間であり、サーバー側での CPU 時間ではありません。 <code class="literal">BENCHMARK()</code> を複数回実行し、サーバーマシン上の負荷量について結果を解釈することをお勧めします。 
        </p><p>
          <code class="literal">BENCHMARK()</code> の目的は、スカラー式の実行時パフォーマンスを測定することです。これにより、その使用方法や結果の解釈方法について、重要ないくつかの推測が提供されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              スカラー式しか使用できません。 式をサブクエリーにすることはできますが、単一のカラムおよび最大でも単一の行が返される必要があります。 たとえば、テーブル <code class="literal">t</code> に複数のカラムまたは複数の行がある場合、<code class="literal">BENCHMARK(10, (SELECT * FROM t))</code> は失敗します。 
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT <em class="replaceable"><code>expr</code></em></code> ステートメントを <em class="replaceable"><code>N</code></em> 回実行する場合と、<code class="literal">SELECT BENCHMARK(<em class="replaceable"><code>N</code></em>, <em class="replaceable"><code>expr</code></em>)</code> を実行する場合とでは、発生するオーバーヘッドの量が異なります。 この 2 つは非常に異なる実行プロファイルを持つため、両者の所要時間は同一になりません。 前者では、パーサー、オプティマイザ、テーブルロック、および実行時評価がそれぞれ <em class="replaceable"><code>N</code></em> 回ずつ発生します。 後者では、実行時評価のみが <em class="replaceable"><code>N</code></em> 回発生し、その他のすべてのコンポーネントは 1 回だけ発生します。 割り当て済みのメモリー構造体は再使用され、集約関数で評価済みの結果をローカルキャッシュに入れるなどの実行時最適化によって、結果が変わる可能性もあります。 したがって、<code class="literal">BENCHMARK()</code> を使用して、実行時コンポーネントに高い重みを付加し、ネットワーク、パーサー、オプティマイザなどで導入された<span class="quote">「<span class="quote">ノイズ</span>」</span>を削除することで、そのコンポーネントのパフォーマンスが測定されます。 
            </p></li></ul></div></li><li class="listitem"><a name="function_charset"></a><p>
          <code class="literal">CHARSET(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619428688"></a><p>
          文字列引数の文字セットを返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET('abc');</code></strong>
        -&gt; 'utf8'
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(CONVERT('abc' USING latin1));</code></strong>
        -&gt; 'latin1'
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(USER());</code></strong>
        -&gt; 'utf8'
</pre></li><li class="listitem"><a name="function_coercibility"></a><p>
          <code class="literal">COERCIBILITY(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619416944"></a><p>
          文字列引数の照合順序強制性値を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY('abc' COLLATE utf8_swedish_ci);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY(USER());</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY('abc');</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY(1000);</code></strong>
        -&gt; 5
</pre><p>
          戻り値の意味は、次の表に示すとおりです。 値が低いほど、優先順位は高くなります。 
        </p><div class="informaltable"><table summary="Collation coercibility return values, the meaning of each value, and an example of each."><col style="width: 15%"><col style="width: 15%"><col style="width: 70%"><thead><tr>
              <th scope="col">型変換属性</th>
              <th scope="col">意味</th>
              <th scope="col">例</th>
            </tr></thead><tbody><tr>
              <th scope="row"><code class="literal">0</code></th>
              <td>明示的な照合順序</td>
              <td><code class="literal">COLLATE</code> 句の値</td>
            </tr><tr>
              <th scope="row"><code class="literal">1</code></th>
              <td>照合順序なし</td>
              <td>さまざまな照合順序との文字列の連結</td>
            </tr><tr>
              <th scope="row"><code class="literal">2</code></th>
              <td>暗黙的な照合順序</td>
              <td>カラム値、ストアドルーチンパラメータ、またはローカル変数</td>
            </tr><tr>
              <th scope="row"><code class="literal">3</code></th>
              <td>系統定数</td>
              <td><code class="literal">USER()</code> の戻り値</td>
            </tr><tr>
              <th scope="row"><code class="literal">4</code></th>
              <td>型変換可能</td>
              <td>リテラル文字列</td>
            </tr><tr>
              <th scope="row"><code class="literal">5</code></th>
              <td>数値</td>
              <td>数値または時間値</td>
            </tr><tr>
              <th scope="row"><code class="literal">5</code></th>
              <td>無視可能</td>
              <td><code class="literal">NULL</code> または <code class="literal">NULL</code> から派生した式</td>
            </tr></tbody></table></div><p>
          詳細は、<a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4 式での照合の強制性">セクション10.8.4「式での照合の強制性」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_collation"></a><p>
          <code class="literal">COLLATION(<em class="replaceable"><code>str</code></em>)</code>
        </p><a class="indexterm" name="idm46041619366416"></a><p>
          文字列引数の照合順序を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COLLATION('abc');</code></strong>
        -&gt; 'utf8_general_ci'
mysql&gt; <strong class="userinput"><code>SELECT COLLATION(_utf8mb4'abc');</code></strong>
        -&gt; 'utf8mb4_0900_ai_ci'
mysql&gt; <strong class="userinput"><code>SELECT COLLATION(_latin1'abc');</code></strong>
        -&gt; 'latin1_swedish_ci'
</pre></li><li class="listitem"><a name="function_connection-id"></a><p>
          <code class="literal">CONNECTION_ID()</code>
        </p><a class="indexterm" name="idm46041619354864"></a><p>
          接続用の接続 ID (スレッド ID) を返します。 すべての接続は、現在接続されているクライアントのセット間で一意の ID を持っています。 
        </p><p>
          <code class="literal">CONNECTION_ID()</code> で返される値の型は、<code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルの <code class="literal">ID</code> カラム、<code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラム、およびパフォーマンススキーマ <code class="literal">threads</code> テーブルの <code class="literal">PROCESSLIST_ID</code> カラムに表示される値と同じです。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONNECTION_ID();</code></strong>
        -&gt; 23786
</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">警告</div><p>
            <code class="literal">pseudo_thread_id</code> システム変数のセッション値を変更すると、<code class="literal">CONNECTION_ID()</code> 関数によって返される値が変更されます。
          </p></div></li><li class="listitem"><a name="function_current-role"></a><p>
          <code class="literal">CURRENT_ROLE()</code>
        </p><a class="indexterm" name="idm46041619335152"></a><p>
          現在のセッションの現在アクティブなロールをカンマで区切って含む <code class="literal">utf8</code> 文字列を返します。存在しない場合は <code class="literal">NONE</code> を返します。 この値は、<code class="literal">sql_quote_show_create</code> システム変数の設定を反映します。 
        </p><p>
          アカウントに次のようなロールが付与されているとします:
        </p><pre class="programlisting">GRANT 'r1', 'r2' TO 'u1'@'localhost';
SET DEFAULT ROLE ALL TO 'u1'@'localhost';
</pre><p>
          <code class="literal">u1</code> のセッションでは、<code class="literal">CURRENT_ROLE()</code> の初期値によってデフォルトのアカウントロールが指定されます。 次のような <code class="literal">SET ROLE</code> の変更を使用: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CURRENT_ROLE();</code></strong>
+-------------------+
| CURRENT_ROLE()    |
+-------------------+
| `r1`@`%`,`r2`@`%` |
+-------------------+
mysql&gt; <strong class="userinput"><code>SET ROLE 'r1'; SELECT CURRENT_ROLE();</code></strong>
+----------------+
| CURRENT_ROLE() |
+----------------+
| `r1`@`%`       |
+----------------+
</pre></li><li class="listitem"><a name="function_current-user"></a><p>
          <code class="literal">CURRENT_USER</code>, <code class="literal">CURRENT_USER()</code>
        </p><a class="indexterm" name="idm46041619316176"></a><p>
          現在のクライアントを認証する際にサーバーで使用された MySQL アカウントを表すユーザー名とホスト名の組み合わせを返します。 このアカウントで、アクセス権限が決まります。 戻り値は、<code class="literal">utf8</code> 文字セット内の文字列です。 
        </p><p>
          <code class="literal">CURRENT_USER()</code> の値は、<code class="literal">USER()</code> の値とは異なる可能性があります。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT USER();</code></strong>
        -&gt; 'davida@localhost'
mysql&gt; <strong class="userinput"><code>SELECT * FROM mysql.user;</code></strong>
ERROR 1044: Access denied for user ''@'localhost' to
database 'mysql'
mysql&gt; <strong class="userinput"><code>SELECT CURRENT_USER();</code></strong>
        -&gt; '@localhost'
</pre><p>
          この例は、クライアントが <code class="literal">davida</code> のユーザー名を指定 (<code class="literal">USER()</code> 関数の値で指定されます) したが、サーバーは匿名のユーザーアカウント (<code class="literal">CURRENT_USER()</code> 値の空のユーザー名部分に表示されます) を使用してクライアントを認証したことを示しています。 これが発生する原因として、<code class="literal">davida</code> の付与テーブルにアカウントが一覧表示されていないことが考えられます。 
        </p><p>
          ストアドプログラムまたはビューでは、<code class="literal">SQL SECURITY INVOKER</code> 特性で定義されていなければ、<code class="literal">CURRENT_USER()</code> はオブジェクトを定義したユーザー (その <code class="literal">DEFINER</code> 値で指定されます) のアカウントを返します。 後者の場合、<code class="literal">CURRENT_USER()</code> はオブジェクトを呼び出したユーザーを返します。 
        </p><p>
          トリガーおよびイベントには、<code class="literal">SQL SECURITY</code> 特性を定義するためのオプションがありません。したがって、このようなオブジェクトの場合、<code class="literal">CURRENT_USER()</code> はオブジェクトを定義したユーザーのアカウントを返します。 呼び出したユーザーを返すには、<code class="literal">USER()</code> または <code class="literal">SESSION_USER()</code> を使用します。 
        </p><p>
          次のステートメントでは、影響を受けるユーザーや定義したユーザーの名前 (ホストの可能性もあります) の代わりに、<code class="literal">CURRENT_USER()</code> 関数を使用することがサポートされています。このような場合、必要に応じて <code class="literal">CURRENT_USER()</code> が拡張されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">DROP USER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">RENAME USER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">GRANT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">REVOKE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE FUNCTION</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE PROCEDURE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE TRIGGER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE EVENT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE VIEW</code>
            </p></li><li class="listitem"><p>
              <code class="literal">ALTER EVENT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">ALTER VIEW</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SET PASSWORD</code>
            </p></li></ul></div><p>
          <code class="literal">CURRENT_USER()</code> のこの拡張によるレプリケーションへの影響については、<a class="xref" href="replication.html#replication-features-current-user" title="17.5.1.8 CURRENT_USER() のレプリケーション">セクション17.5.1.8「CURRENT_USER() のレプリケーション」</a> を参照してください。
        </p></li><li class="listitem"><a name="function_database"></a><p>
          <code class="literal">DATABASE()</code>
        </p><a class="indexterm" name="idm46041619260496"></a><p>
          デフォルト (現在) のデータベース名を <code class="literal">utf8</code> 文字セット内の文字列として返します。 デフォルトのデータベースがない場合は、<code class="literal">DATABASE()</code> は <code class="literal">NULL</code> を返します。 ストアドルーチン内では、デフォルトのデータベースはルーチンが関連付けられたデータベースですが、これは呼び出し元のコンテキストでのデフォルトのデータベースと同じであるとはかぎりません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATABASE();</code></strong>
        -&gt; 'test'
</pre><p>
          デフォルトのデータベースがない場合は、<code class="literal">DATABASE()</code> は <code class="literal">NULL</code> を返します。
        </p></li><li class="listitem"><a name="function_found-rows"></a><p>
          <code class="literal">FOUND_ROWS()</code>
        </p><a class="indexterm" name="idm46041619245152"></a><a class="indexterm" name="idm46041619243808"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">SQL_CALC_FOUND_ROWS</code> クエリー修飾子および付随する <code class="literal">FOUND_ROWS()</code> 関数は、MySQL 8.0.17 で非推奨になりました。これらは、MySQL の将来のバージョンで削除される予定です。 かわりに、<code class="literal">LIMIT</code> を使用してクエリーを実行してから、追加の行があるかどうかを判断するために <code class="literal">COUNT(*)</code> および <code class="literal">LIMIT</code> を使用しない別のクエリーを検討してください。 たとえば、次のクエリーのかわりに: 
          </p><pre class="programlisting">SELECT SQL_CALC_FOUND_ROWS * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE id &gt; 100 LIMIT 10;
SELECT FOUND_ROWS();
</pre><p>
            かわりに次のクエリーを使用します:
          </p><pre class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE id &gt; 100 LIMIT 10;
SELECT COUNT(*) FROM <em class="replaceable"><code>tbl_name</code></em> WHERE id &gt; 100;
</pre><p>
            <code class="literal">COUNT(*)</code> は、特定の最適化の対象となります。 <code class="literal">SQL_CALC_FOUND_ROWS</code> では、一部の最適化が無効になります。 
          </p></div><p>
          サーバーからクライアントに返される行の数を制限するために、<code class="literal">SELECT</code> ステートメントに <code class="literal">LIMIT</code> 句が含まれている場合があります。 場合によっては、ステートメントを再度実行せずに、<code class="literal">LIMIT</code> を付けなかった場合にステートメントで返されるはずの行数を知っておくことが望ましいことがあります。 この行数を取得するには、<code class="literal">SELECT</code> ステートメントに <code class="literal">SQL_CALC_FOUND_ROWS</code> オプションを含めてから、<code class="literal">FOUND_ROWS()</code> を起動します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM <em class="replaceable"><code>tbl_name</code></em></code></strong>
    -&gt; <strong class="userinput"><code>WHERE id &gt; 100 LIMIT 10;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT FOUND_ROWS();</code></strong>
</pre><p>
          2 番目の <code class="literal">SELECT</code> は、1 番目の <code class="literal">SELECT</code> を <code class="literal">LIMIT</code> 句なしで記述した場合に返される行数を示す数字を返します。
        </p><p>
          最近成功した <code class="literal">SELECT</code> ステートメントに <code class="literal">SQL_CALC_FOUND_ROWS</code> オプションを付けなければ、<code class="literal">FOUND_ROWS()</code> は、そのステートメントで返された結果セットの行数を返します。 ステートメントに <code class="literal">LIMIT</code> 句が含まれている場合、<code class="literal">FOUND_ROWS()</code> はその制限値以下の行数を返します。 たとえば、ステートメントに <code class="literal">LIMIT 10</code> または <code class="literal">LIMIT 50, 10</code> が含まれている場合、<code class="literal">FOUND_ROWS()</code> はそれぞれ 10 と 60 を返します。 
        </p><p>
          <code class="literal">FOUND_ROWS()</code> から取得できる行数は一時的なもので、<code class="literal">SELECT SQL_CALC_FOUND_ROWS</code> ステートメントのあとに、このステートメントを発行しても取得できるようには設計されていません。 あとで値を参照する必要がある場合は、保存してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM ... ;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @rows = FOUND_ROWS();</code></strong>
</pre><p>
          <code class="literal">SELECT SQL_CALC_FOUND_ROWS</code> を使用している場合は、MySQL では完全な結果セット内の行数を計算する必要があります。 ただし、結果セットはクライアントに送信される必要がないため、<code class="literal">LIMIT</code> なしでクエリーを再度実行するよりも速くなります。 
        </p><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code> および <code class="literal">FOUND_ROWS()</code> は、クエリーで返される行数を制限するが、クエリーを再度実行しないで完全な結果セット内の行数を確認する必要がある状況でも役立ちます。 例として、検索結果のほかのセクションを表示するページへのリンクを含むページが表示される Web スクリプトがあります。 <code class="literal">FOUND_ROWS()</code> を使用すると、残りの結果を表示するために必要なその他のページ数を確認できます。 
        </p><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code> および <code class="literal">FOUND_ROWS()</code> を使用すると、<code class="literal">UNION</code> の複数箇所で <code class="literal">LIMIT</code> が発生する可能性があるため、単純な <code class="literal">SELECT</code> ステートメントよりも、<code class="literal">UNION</code> ステートメントで使用した方が複雑になります。 これは、<code class="literal">UNION</code> 内の個々の <code class="literal">SELECT</code> ステートメントに適用される場合と、<code class="literal">UNION</code> の結果全体にグローバルに適用される場合があります。 
        </p><p>
          <code class="literal">UNION</code> で <code class="literal">SQL_CALC_FOUND_ROWS</code> を使用する目的は、グローバルな <code class="literal">LIMIT</code> なしで返される行数を返すことです。 <code class="literal">UNION</code> で <code class="literal">SQL_CALC_FOUND_ROWS</code> を使用する条件は、次のとおりです。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">UNION</code> の 1 番目の <code class="literal">SELECT</code> に、<code class="literal">SQL_CALC_FOUND_ROWS</code> キーワードが表示される必要があります。
            </p></li><li class="listitem"><p>
              <code class="literal">FOUND_ROWS()</code> の値は、<code class="literal">UNION ALL</code> が使用されている場合にのみ正確です。 <code class="literal">ALL</code> なしで <code class="literal">UNION</code> が使用される場合は、重複の削除が発生し、<code class="literal">FOUND_ROWS()</code> の値が単なる近似値になります。 
            </p></li><li class="listitem"><p>
              <code class="literal">UNION</code> で <code class="literal">LIMIT</code> が表示されない場合は、<code class="literal">SQL_CALC_FOUND_ROWS</code> が無視され、<code class="literal">UNION</code> を処理するために作成された一時テーブル内の行数が返されます。
            </p></li></ul></div><p>
          ここで説明した以外のケースでは、<code class="literal">FOUND_ROWS()</code> の動作 (エラーが発生して <code class="literal">SELECT</code> ステートメントに失敗したあとの値など) が定義されません。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            ステートメントベースのレプリケーションでは、確実に <code class="literal">FOUND_ROWS()</code> をレプリケートすることはできません。 行ベースのレプリケーションを使用すると、この関数は自動的にレプリケートされます。 
          </p></div></li><li class="listitem"><a name="function_icu-version"></a><p>
          <code class="literal">ICU_VERSION()</code>
        </p><a class="indexterm" name="idm46041619157968"></a><p>
          正規表現操作のサポートに使用される International Components for Unicode (ICU) ライブラリのバージョン (<a class="xref" href="functions.html#regexp" title="12.8.2 正規表現">セクション12.8.2「正規表現」</a> を参照)。 この関数は、主にテストケースでの使用を目的としています。 
        </p></li><li class="listitem"><a name="function_last-insert-id"></a><p>
          <code class="literal">LAST_INSERT_ID()</code>, <code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041619149040"></a><p>
          引数を指定しない場合、<code class="literal">LAST_INSERT_ID()</code> は、最後に実行された <code class="literal">INSERT</code> ステートメントの結果として <code class="literal">AUTO_INCREMENT</code> カラムに正常に挿入された最初の自動生成値を表す <code class="literal">BIGINT UNSIGNED</code> (64-bit) 値を返します。 正常に挿入された行がない場合は、<code class="literal">LAST_INSERT_ID()</code> の値は未変更のままです。 
        </p><p>
          引数を指定すると、<code class="literal">LAST_INSERT_ID()</code> は符号なし整数を戻します。
        </p><p>
          たとえば、<code class="literal">AUTO_INCREMENT</code> 値を生成する行を挿入したあとは、次のようにして値を取得できます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
        -&gt; 195
</pre><p>
          現在実行中のステートメントによって、<code class="literal">LAST_INSERT_ID()</code> の値は影響を受けません。 1 つのステートメントで <code class="literal">AUTO_INCREMENT</code> 値を生成してから、独自の <code class="literal">AUTO_INCREMENT</code> カラムを含むテーブルに行を挿入する複数行の <code class="literal">INSERT</code> ステートメントで <code class="literal">LAST_INSERT_ID()</code> を参照すると仮定します。 2 番目のステートメントでは、<code class="literal">LAST_INSERT_ID()</code> の値は安定したままです。2 番目以降の行の値は、前の行の挿入の影響を受けません。 (<code class="literal">LAST_INSERT_ID()</code> と <code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code> への参照を混在させる場合、影響は定義されていないことに注意してください。) 
        </p><p>
          以前のステートメントでエラーが返された場合は、<code class="literal">LAST_INSERT_ID()</code> の値が定義されません。 トランザクションテーブルでは、エラーによってステートメントがロールバックされる場合、<code class="literal">LAST_INSERT_ID()</code> の値は未定義のままです。 手動の <code class="literal">ROLLBACK</code> では、<code class="literal">LAST_INSERT_ID()</code> の値はトランザクション前の値にリストアされず、<code class="literal">ROLLBACK</code> 時点と同じままです。 
        </p><p>
          ストアドルーチン (プロシージャーや関数) またはトリガーの本文内では、<code class="literal">LAST_INSERT_ID()</code> の値は、このような種類のオブジェクトの本文外で実行されたステートメントと同様に変更されます。 あとに続くステートメントで参照される <code class="literal">LAST_INSERT_ID()</code> の値でのストアドルーチンまたはトリガーの効果は、ルーチンの種類によって異なります。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ストアドプロシージャーで <code class="literal">LAST_INSERT_ID()</code> の値を変更するステートメントが実行される場合は、プロシージャー呼び出しが続くステートメントで変更された値が参照されます。
            </p></li><li class="listitem"><p>
              値を変更するストアドファンクションおよびトリガーの場合、関数またはトリガーの終了時に値がリストアされるため、後に続くステートメントには変更された値が表示されません。
            </p></li></ul></div><p>
          生成された ID は、<span class="emphasis"><em>接続ごとに</em></span>サーバー内に保持されます。 つまり、関数によって指定されたクライアントに返された値は、<span class="emphasis"><em>そのクライアントによって</em></span> <code class="literal">AUTO_INCREMENT</code> カラムに影響を与える最近のステートメント用に最初に生成された <code class="literal">AUTO_INCREMENT</code> 値です。 この値は、ほかのクライアントが独自の <code class="literal">AUTO_INCREMENT</code> 値を生成した場合でも影響を受ける可能性はありません。 この動作によって、各クライアントはほかのクライアントのアクティビティーを気にすることなく、ロックやトランザクションを実行しないで独自の ID を取得できます。 
        </p><p>
          行の <code class="literal">AUTO_INCREMENT</code> カラムを非<span class="quote">「<span class="quote">マジック</span>」</span>値 (つまり、<code class="literal">NULL</code> でも <code class="literal">0</code> でもない値) に設定する場合は、<code class="literal">LAST_INSERT_ID()</code> の値が変更されません。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            単一の <code class="literal">INSERT</code> ステートメントを使用して複数の行を挿入する場合、<code class="literal">LAST_INSERT_ID()</code> は、<span class="emphasis"><em>最初に</em></span>挿入された行<span class="emphasis"><em>のみ</em></span>に対して生成された値を返します。 この理由は、ほかの一部のサーバーに対して同じ <code class="literal">INSERT</code> ステートメントを簡単に再現できるようにするためです。 
          </p></div><p>
          例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE test;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (</code></strong>
       <strong class="userinput"><code>id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
       <strong class="userinput"><code>name VARCHAR(10) NOT NULL</code></strong>
       <strong class="userinput"><code>);</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (NULL, 'Bob');</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT * FROM t;</code></strong>
+----+------+
| id | name |
+----+------+
|  1 | Bob  |
+----+------+

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES</code></strong>
       <strong class="userinput"><code>(NULL, 'Mary'), (NULL, 'Jane'), (NULL, 'Lisa');</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT * FROM t;</code></strong>
+----+------+
| id | name |
+----+------+
|  1 | Bob  |
|  2 | Mary |
|  3 | Jane |
|  4 | Lisa |
+----+------+

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                2 |
+------------------+
</pre><p>
          2 番目の <code class="literal">INSERT</code> ステートメントで 3 つの新しい行が <code class="literal">t</code> に挿入されましたが、これらの行の 1 番目に生成された ID は <code class="literal">2</code> であり、あとに続く <code class="literal">SELECT</code> ステートメントでも、この値が <code class="literal">LAST_INSERT_ID()</code> によって返されます。
        </p><p>
          <code class="literal">INSERT IGNORE</code> を使用し、その行が無視された場合、<code class="literal">LAST_INSERT_ID()</code> は現在の値から未変更のままです (接続で正常な <code class="literal">INSERT</code> が実行されていない場合は、0 が返されます)。トランザクショナル以外のテーブルでは、<code class="literal">AUTO_INCREMENT</code> カウンタが増分されません。 <code class="literal">InnoDB</code> テーブルでは、<code class="literal">innodb_autoinc_lock_mode</code> が <code class="literal">1</code> または <code class="literal">2</code> に設定されている場合は、次の例で示すように <code class="literal">AUTO_INCREMENT</code> が増分されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE test;</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT @@innodb_autoinc_lock_mode;</code></strong>
+----------------------------+
| @@innodb_autoinc_lock_mode |
+----------------------------+
|                          1 |
+----------------------------+

mysql&gt; <strong class="userinput"><code>CREATE TABLE `t` (</code></strong>
       <strong class="userinput"><code>`id` INT(11) NOT NULL AUTO_INCREMENT,</code></strong>
       <strong class="userinput"><code>`val` INT(11) DEFAULT NULL,</code></strong>
       <strong class="userinput"><code>PRIMARY KEY (`id`),</code></strong>
       <strong class="userinput"><code>UNIQUE KEY `i1` (`val`)</code></strong>
       <strong class="userinput"><code>) ENGINE=InnoDB DEFAULT CHARSET=latin1;</code></strong>

# Insert two rows

mysql&gt; <strong class="userinput"><code>INSERT INTO t (val) VALUES (1),(2);</code></strong>

# With auto_increment_offset=1, the inserted rows
# result in an AUTO_INCREMENT value of 3

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong>
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `val` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `i1` (`val`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1

# LAST_INSERT_ID() returns the first automatically generated
# value that is successfully inserted for the AUTO_INCREMENT column

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+

# The attempted insertion of duplicate rows fail but errors are ignored

mysql&gt; <strong class="userinput"><code>INSERT IGNORE INTO t (val) VALUES (1),(2);</code></strong>
Query OK, 0 rows affected (0.00 sec)
Records: 2  Duplicates: 2  Warnings: 0

# With innodb_autoinc_lock_mode=1, the AUTO_INCREMENT counter
# is incremented for the ignored rows

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong>
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `val` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `i1` (`val`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=latin1

# The LAST_INSERT_ID is unchanged because the previous insert was unsuccessful

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+
</pre><p>
          詳細は、<a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="15.6.1.6 InnoDB での AUTO_INCREMENT 処理">セクション15.6.1.6「InnoDB での AUTO_INCREMENT 処理」</a>を参照してください。
        </p><a class="indexterm" name="idm46041619059744"></a><p>
          <em class="replaceable"><code>expr</code></em> が <code class="literal">LAST_INSERT_ID()</code> の引数として指定されている場合、引数の値は関数によって返され、<code class="literal">LAST_INSERT_ID()</code> によって返される次の値として記憶されます。 これを使用すると、シーケンスのシミュレーションを行うことができます。 
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              シーケンスカウンタを保持するテーブルを作成し、それを初期化します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE sequence (id INT NOT NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO sequence VALUES (0);</code></strong>
</pre></li><li class="listitem"><p>
              そのテーブルを使用して、次のようにシーケンス番号を生成します。
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE sequence SET id=LAST_INSERT_ID(id+1);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
</pre><p>
              <code class="literal">UPDATE</code> ステートメントは、シーケンスカウンタを増分し、<code class="literal">LAST_INSERT_ID()</code> への次の呼び出しで更新された値が返されるようにします。 <code class="literal">SELECT</code> ステートメントは、その値を取得します。 <code class="literal">mysql_insert_id()</code> C API 関数を使用して、値を取得することもできます。 <a class="ulink" href="https://dev.mysql.com/doc/c-api/8.0/en/mysql-insert-id.html" target="_top">mysql_insert_id()</a>を参照してください。 
            </p></li></ol></div><p>
          <code class="literal">LAST_INSERT_ID()</code> を呼び出さずに、シーケンスを生成できます。このように関数を使用する有用性は、ID 値が最後に自動的に生成された値として保持されることです。 独自のシーケンス値を生成するほかのクライアントと互いに影響しあうことなく、複数のクライアントが <code class="literal">UPDATE</code> ステートメントを発行し、<code class="literal">SELECT</code> ステートメント (または <code class="literal">mysql_insert_id()</code>) で独自のシーケンス値を取得できるため、マルチユーザーでも安全です。 
        </p><p>
          <code class="literal">mysql_insert_id()</code> は <code class="literal">INSERT</code> および <code class="literal">UPDATE</code> ステートメントの後にのみ更新されるため、<code class="literal">SELECT</code> や <code class="literal">SET</code> などの他の SQL ステートメントを実行した後は、C API 関数を使用して <code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code> の値を取得できません。
        </p></li><li class="listitem"><a name="function_roles-graphml"></a><p>
          <code class="literal">ROLES_GRAPHML()</code>
        </p><a class="indexterm" name="idm46041619025104"></a><p>
          メモリーロールサブグラフを表す GraphML 文書を含む <code class="literal">utf8</code> 文字列を返します。 <code class="literal">&lt;graphml&gt;</code> 要素のコンテンツを表示するには、<code class="literal">ROLE_ADMIN</code> 権限 (または非推奨の <code class="literal">SUPER</code> 権限) が必要です。 それ以外の場合、結果には空の要素のみが表示されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROLES_GRAPHML();</code></strong>
+---------------------------------------------------+
| ROLES_GRAPHML()                                   |
+---------------------------------------------------+
| &lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;graphml /&gt; |
+---------------------------------------------------+
</pre></li><li class="listitem"><a name="function_row-count"></a><p>
          <code class="literal">ROW_COUNT()</code>
        </p><a class="indexterm" name="idm46041619012720"></a><p>
          <code class="literal">ROW_COUNT()</code> は、次のように値を返します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              DDL ステートメント: 0。 これは、<code class="literal">CREATE TABLE</code> や <code class="literal">DROP TABLE</code> などのステートメントに適用されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT</code> 以外の DML ステートメント: 影響を受ける行数です。 これは、<code class="literal">UPDATE</code>、<code class="literal">INSERT</code> または <code class="literal">DELETE</code> (以前と同様) などのステートメントに適用されますが、<code class="literal">ALTER TABLE</code> や <code class="literal">LOAD DATA</code> などのステートメントにも適用されるようになりました。 
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT</code>: ステートメントで結果セットが返される場合は -1、そうでない場合は<span class="quote">「<span class="quote">影響を受ける</span>」</span>行数。 たとえば、<code class="literal">SELECT * FROM t1</code> の場合、<code class="literal">ROW_COUNT()</code> は -1 を返します。 <code class="literal">SELECT * FROM t1 INTO OUTFILE '<em class="replaceable"><code>file_name</code></em>'</code> の場合、<code class="literal">ROW_COUNT()</code> はファイルに書き込まれた行の数を返します。 
            </p></li><li class="listitem"><p>
              <code class="literal">SIGNAL</code> ステートメント: 0。
            </p></li></ul></div><p>
          <code class="literal">UPDATE</code> ステートメントの場合、デフォルトで影響を受けた行の値は実際に変更された行の数です。 <span class="command"><strong>mysqld</strong></span> への接続時に <code class="literal">CLIENT_FOUND_ROWS</code> フラグを <code class="literal">mysql_real_connect()</code> に指定した場合、影響を受けた行の値は<span class="quote">「<span class="quote">見つかった</span>」</span>、つまり <code class="literal">WHERE</code> 句に一致した行数です。 
        </p><p>
          <code class="literal">REPLACE</code> ステートメントの場合、影響を受けた行の値は、新しい行が古い行に置き換わった場合 2 です。この場合、重複が削除されたあとに行が挿入されたためです。
        </p><p>
          <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code> ステートメントの場合、行ごとの影響を受けた行の値は、その行が新しい行として挿入された場合は 1、既存の行が更新された場合は 2、既存の行がその現在の値に設定された場合は 0 です。 <code class="literal">CLIENT_FOUND_ROWS</code> フラグを指定した場合、影響を受けた行の値は、既存の行がその現在の値に設定された場合は (0 ではなく) 1 になります。 
        </p><p>
          <code class="literal">ROW_COUNT()</code> は、<code class="literal">mysql_affected_rows()</code> C API 関数から取得される値と同様で、ステートメントの実行後に <span class="command"><strong>mysql</strong></span> クライアントに表示される行数です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT ROW_COUNT();</code></strong>
+-------------+
| ROW_COUNT() |
+-------------+
|           3 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DELETE FROM t WHERE i IN(1,2);</code></strong>
Query OK, 2 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ROW_COUNT();</code></strong>
+-------------+
| ROW_COUNT() |
+-------------+
|           2 |
+-------------+
1 row in set (0.00 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            ステートメントベースのレプリケーションでは、確実に <code class="literal">ROW_COUNT()</code> をレプリケートすることはできません。 行ベースのレプリケーションを使用すると、この関数は自動的にレプリケートされます。 
          </p></div></li><li class="listitem"><a name="function_schema"></a><p>
          <code class="literal">SCHEMA()</code>
        </p><a class="indexterm" name="idm46041618963696"></a><p>
          この関数は <code class="literal">DATABASE()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_session-user"></a><p>
          <code class="literal">SESSION_USER()</code>
        </p><a class="indexterm" name="idm46041618955104"></a><p>
          <code class="literal">SESSION_USER()</code> は <code class="literal">USER()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_system-user"></a><p>
          <code class="literal">SYSTEM_USER()</code>
        </p><a class="indexterm" name="idm46041618945584"></a><p>
          <code class="literal">SYSTEM_USER()</code> は <code class="literal">USER()</code> のシノニムです。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">SYSTEM_USER()</code> 関数は、<code class="literal">SYSTEM_USER</code> 権限とは異なります。 前者は、現在の MySQL アカウント名を返します。 後者は、システムユーザーと通常のユーザーアカウントカテゴリを区別します (<a class="xref" href="security.html#account-categories" title="6.2.11 アカウントカテゴリ">セクション6.2.11「アカウントカテゴリ」</a> を参照)。 
          </p></div></li><li class="listitem"><a name="function_user"></a><p>
          <code class="literal">USER()</code>
        </p><a class="indexterm" name="idm46041618932192"></a><p>
          現在の MySQL ユーザー名とホスト名を <code class="literal">utf8</code> 文字セット内の文字列として返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT USER();</code></strong>
        -&gt; 'davida@localhost'
</pre><p>
          この値は、サーバーへの接続時に指定したユーザー名および接続元のクライアントホストを示します。 <code class="literal">CURRENT_USER()</code> の値とは異なる可能性があります。 
        </p></li><li class="listitem"><a name="function_version"></a><p>
          <code class="literal">VERSION()</code>
        </p><a class="indexterm" name="idm46041618919696"></a><p>
          MySQL サーバーのバージョンを示す文字列を返します。 この文字列では、<code class="literal">utf8</code> 文字セットが使用されます。 値にはバージョン番号に加えて、サフィクスが付いている場合もあります。 <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a>内の <code class="literal">version</code> システム変数の説明を参照してください。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT VERSION();</code></strong>
        -&gt; '8.0.25-standard'
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spatial-analysis-functions"></a>12.17 空間分析関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#spatial-function-reference">12.17.1 空間関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling">12.17.2 空間関数による引数処理</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions">12.17.3 WKT 値からジオメトリ値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions">12.17.4 WKB 値からジオメトリ値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions">12.17.5 ジオメトリ値を作成する MySQL 固有の関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions">12.17.6 ジオメトリ形式変換関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions">12.17.7 ジオメトリプロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions">12.17.8 空間演算子関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions">12.17.9 ジオメトリオブジェクト間の空間関係をテストする関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geohash-functions">12.17.10 空間 Geohash 関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geojson-functions">12.17.11 空間 GeoJSON 関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-aggregate-functions">12.17.12 空間集計関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-convenience-functions">12.17.13 空間の便利な関数</a></span></dt></dl></div><p>
    MySQL には、空間データに対してさまざまな操作を実行する関数が用意されています。 これらの関数は、実行する操作の種類に従って、次のいくつかの主なカテゴリにグループ化できます。 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        さまざまな形式 (WKT、WKB、内部) のジオメトリを作成する関数
      </p></li><li class="listitem"><p>
        ジオメトリの形式を変換する関数
      </p></li><li class="listitem"><p>
        ジオメトリの定性的または定量的なプロパティーにアクセスする関数
      </p></li><li class="listitem"><p>
        2 つのジオメトリ間の関係を記述する関数
      </p></li><li class="listitem"><p>
        既存のジオメトリから新しいジオメトリを作成する関数
      </p></li></ul></div><p>
    空間データを使用するための MySQL のサポートに関する一般的なバックグラウンドについては、<a class="xref" href="data-types.html#spatial-types" title="11.4 空間データ型">セクション11.4「空間データ型」</a>を参照してください。
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-function-reference"></a>12.17.1 空間関数のリファレンス</h3></div></div></div><a class="indexterm" name="idm46041618897568"></a><p>
      次のテーブルに、各空間関数を示し、それぞれについて簡単に説明します。
    </p><div class="table"><a name="idm46041618895504"></a><p class="title"><b>表 12.21 「空間関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「すべての空間関数をリストする参照。」"><col style="width: 25%"><col style="width: 62%"><col style="width: 12%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a></th>
<td>
      ジオメトリからジオメトリコレクションを構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></th>
<td>
      ジオメトリからジオメトリコレクションを構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></th>
<td>
      Point 値から LineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></th>
<td>
      あるジオメトリの MBR に、別のジオメトリの MBR が含まれているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a></th>
<td>
      ある MBR が別の MBR でカバーされているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a></th>
<td>
      ある MBR が別の MBR をカバーしているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></th>
<td>
      2 つのジオメトリの MBR が切り離されているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals()</code></a></th>
<td>
      2 つのジオメトリの MBR が等しいかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></th>
<td>
      2 つのジオメトリの MBR が交差しているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></th>
<td>
      2 つのジオメトリの MBR がオーバーラップしているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></th>
<td>
      2 つのジオメトリの MBR が接しているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></th>
<td>
      あるジオメトリの MBR が、別のジオメトリの MBR の内部にあるかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></th>
<td>
      LineString 値から MultiLineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></th>
<td>
      Point 値から MultiPoint を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></th>
<td>
      Polygon 値から MultiPolygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></th>
<td>
      座標から Point を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></th>
<td>
      LineString 引数から Polygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></th>
<td>
      Polygon または MultiPolygon 領域を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary()</code>, <code class="literal">ST_AsWKB()</code></a></th>
<td>
      内部ジオメトリ形式から WKB に変換します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON()</code></a></th>
<td>
      ジオメトリから GeoJSON オブジェクトを生成します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText()</code>, <code class="literal">ST_AsWKT()</code></a></th>
<td>
      内部ジオメトリ形式から WKT に変換します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a></th>
<td>
      ジオメトリから指定された距離内にある点のジオメトリを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a></th>
<td>
      ST_Buffer() の作成戦略オプション
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></th>
<td>
      重心を Point として返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-collect"><code class="literal">ST_Collect()</code></a></th>
<td>
      空間値をコレクションに集約
    </td>
<td>8.0.24</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></th>
<td>
      あるジオメトリに別のジオメトリが含まれているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull()</code></a></th>
<td>
      ジオメトリの凸包を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></th>
<td>
      あるジオメトリが別のジオメトリと交差しているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></th>
<td>
      2 つのジオメトリの点集合の差集合を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension()</code></a></th>
<td>
      ジオメトリの次元
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></th>
<td>
      あるジオメトリが別のジオメトリから切り離されているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></th>
<td>
      あるジオメトリの別のジオメトリからの距離
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a></th>
<td>
      2 つのジオメトリ間の地球上の最小距離
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a></th>
<td>
      LineString の終点
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></th>
<td>
      ジオメトリの MBR を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></th>
<td>
      あるジオメトリが別のジオメトリに等しいかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing()</code></a></th>
<td>
      Polygon の外側のリングを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-frechetdistance"><code class="literal">ST_FrechetDistance()</code></a></th>
<td>
      ジオメトリ間の離散フレシェ距離
    </td>
<td>8.0.23</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash()</code></a></th>
<td>
      geohash 値を生成します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromText()</code>, <code class="literal">ST_GeometryCollectionFromText()</code>, <code class="literal">ST_GeomCollFromTxt()</code></a></th>
<td>
      WKT からジオメトリコレクションを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeomCollFromWKB()</code>, <code class="literal">ST_GeometryCollectionFromWKB()</code></a></th>
<td>
      WKB からジオメトリコレクションを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN()</code></a></th>
<td>
      ジオメトリコレクションから N 番目のジオメトリを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType()</code></a></th>
<td>
      ジオメトリ型の名前を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON()</code></a></th>
<td>
      GeoJSON オブジェクトからジオメトリを生成します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code>, <code class="literal">ST_GeometryFromText()</code></a></th>
<td>
      WKT からジオメトリを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB()</code>, <code class="literal">ST_GeometryFromWKB()</code></a></th>
<td>
      WKB からジオメトリを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-hausdorffdistance"><code class="literal">ST_HausdorffDistance()</code></a></th>
<td>
      ジオメトリ間の離散ハスドルフ距離
    </td>
<td>8.0.23</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN()</code></a></th>
<td>
      Polygon の N 番目の内側のリングを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></th>
<td>
      2 つのジオメトリの点集合の積集合を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></th>
<td>
      あるジオメトリが別のジオメトリと交差しているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a></th>
<td>
      ジオメトリが閉じていて単純かどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty()</code></a></th>
<td>
      ジオメトリが空かどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a></th>
<td>
      ジオメトリが単純かどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a></th>
<td>
      ジオメトリが有効かどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a></th>
<td>
      geohash 値から緯度を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a></th>
<td>
      点の緯度を返します
    </td>
<td>8.0.12</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a></th>
<td>
      LineString の長さを返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineFromText()</code>, <code class="literal">ST_LineStringFromText()</code></a></th>
<td>
      WKT から LineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineFromWKB()</code>, <code class="literal">ST_LineStringFromWKB()</code></a></th>
<td>
      WKB から LineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-lineinterpolatepoint"><code class="literal">ST_LineInterpolatePoint()</code></a></th>
<td>
      LineString に沿った特定のパーセンテージのポイント
    </td>
<td>8.0.24</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-lineinterpolatepoints"><code class="literal">ST_LineInterpolatePoints()</code></a></th>
<td>
      LineString に沿って指定された割合をポイント
    </td>
<td>8.0.24</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a></th>
<td>
      geohash 値から経度を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a></th>
<td>
      点の経度を返します
    </td>
<td>8.0.12</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a></th>
<td>
      2 点周りの長方形
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MLineFromText()</code>, <code class="literal">ST_MultiLineStringFromText()</code></a></th>
<td>
      WKT から MultiLineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MLineFromWKB()</code>, <code class="literal">ST_MultiLineStringFromWKB()</code></a></th>
<td>
      WKB から MultiLineString を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText()</code>, <code class="literal">ST_MultiPointFromText()</code></a></th>
<td>
      WKT から MultiPoint を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MPointFromWKB()</code>, <code class="literal">ST_MultiPointFromWKB()</code></a></th>
<td>
      WKB から MultiPoint を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MPolyFromText()</code>, <code class="literal">ST_MultiPolygonFromText()</code></a></th>
<td>
      WKT から MultiPolygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MPolyFromWKB()</code>, <code class="literal">ST_MultiPolygonFromWKB()</code></a></th>
<td>
      WKB から MultiPolygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries()</code></a></th>
<td>
      ジオメトリコレクション内のジオメトリ数を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing()</code>, <code class="literal">ST_NumInteriorRings()</code></a></th>
<td>
      Polygon 内の内側のリング数を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints()</code></a></th>
<td>
      LineString 内の Point の数を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></th>
<td>
      あるジオメトリが別のジオメトリとオーバーラップしているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointatdistance"><code class="literal">ST_PointAtDistance()</code></a></th>
<td>
      LineString に沿った特定の距離の点
    </td>
<td>8.0.24</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a></th>
<td>
      geohash 値を POINT 値に変換します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText()</code></a></th>
<td>
      WKT から Point を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB()</code></a></th>
<td>
      WKB から Point を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN()</code></a></th>
<td>
      LineString から N 番目の Point を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolyFromText()</code>, <code class="literal">ST_PolygonFromText()</code></a></th>
<td>
      WKT から Polygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolyFromWKB()</code>, <code class="literal">ST_PolygonFromWKB()</code></a></th>
<td>
      WKB から Polygon を構築します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify()</code></a></th>
<td>
      簡略化されたジオメトリを返す
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a></th>
<td>
      ジオメトリの空間参照システム ID を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a></th>
<td>
      LineString の始点
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY()</code></a></th>
<td>
      X/Y 座標が入れ替えられた引数を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></th>
<td>
      2 つのジオメトリの点集合の対称差を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></th>
<td>
      あるジオメトリが別のジオメトリに接しているかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a></th>
<td>
      ジオメトリの座標を変換
    </td>
<td>8.0.13</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></th>
<td>
      2 つのジオメトリの点集合の和集合を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a></th>
<td>
      検証済ジオメトリを戻します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></th>
<td>
      あるジオメトリが別のジオメトリの内部にあるかどうか
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a></th>
<td>
      Point の X 座標を返します
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a></th>
<td>
      Point の Y 座標を返します
    </td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-function-argument-handling"></a>12.17.2 空間関数による引数処理</h3></div></div></div><p>
      空間値 (ジオメトリ) には、<a class="xref" href="data-types.html#gis-class-geometry" title="11.4.2.2 Geometry クラス">セクション11.4.2.2「Geometry クラス」</a> で説明されているプロパティがあります。 次の説明では、空間関数の一般的な引数処理特性を一覧表示します。 特定の関数または関数のグループは、これらの関数の説明が発生するセクションで説明されているように、追加または異なる引数処理特性を持つことができます。 true の場合、これらの説明はここでの一般的な説明よりも優先されます。 
    </p><p>
      空間関数は、有効なジオメトリ値に対してのみ定義されています。 <a class="xref" href="data-types.html#geometry-well-formedness-validity" title="11.4.4 ジオメトリの整形式と妥当性">セクション11.4.4「ジオメトリの整形式と妥当性」</a>を参照してください。 
    </p><p>
      各ジオメトリ値は、地理的位置の座標ベースのシステムである空間参照システム (SRS) に関連付けられています。 <a class="xref" href="data-types.html#spatial-reference-systems" title="11.4.5 空間参照システムのサポート">セクション11.4.5「空間参照システムのサポート」</a>を参照してください。 
    </p><a class="indexterm" name="idm46041618490496"></a><p>
      ジオメトリの空間参照識別子 (SRID) は、ジオメトリが定義されている SRS を識別します。 MySQL の SRID 値は、ジオメトリ値に関連付けられた整数です。 使用可能な SRID の最大値は 2<sup>32</sup>−1 です。 より大きな値が指定されると、低位の 32 ビットだけが使用されます。 
    </p><p>
      SRID 0 は、軸に単位が割り当てられていない無限平坦なデカルト平面を表します。 SRID 0 の動作を保証するには、SRID 0 を使用してジオメトリ値を作成します。 SRID 0 は、SRID が指定されていない場合の新しいジオメトリ値のデフォルトです。 
    </p><p>
      複数のジオメトリ値の計算では、すべての値が同じ SRS 内にある必要があり、そうでない場合はエラーが発生します。 したがって、複数のジオメトリ引数を取る空間関数では、それらの引数が同じ SRS 内にある必要があります。 空間関数が <code class="literal">ER_GIS_DIFFERENT_SRIDS</code> を戻す場合、ジオメトリ引数がすべて同じ SRS 内にあったわけではありません。 SRS が同じになるように修正する必要があります。 
    </p><p>
      空間関数によって生成されたジオメトリ値はジオメトリ引数の SRID を継承するため、空間関数によって戻されたジオメトリはジオメトリ引数の SRS と同一のものになります。
    </p><p>
      <a class="ulink" href="http://www.opengeospatial.org" target="_top">Open Geospatial Consortium</a> ガイドラインでは、入力ポリゴンがすでに閉じられている必要があるため、閉じられていないポリゴンは閉じられるのではなく、無効として拒否されます。
    </p><p>
      MySQL では、有効な空のジオメトリのみが空のジオメトリコレクションの形式で表されます。 空のジオメトリコレクションの処理は次のとおりです: 空の WKT 入力ジオメトリコレクションを<code class="literal">'GEOMETRYCOLLECTION()'</code>として指定できます。 これは、空のジオメトリコレクションを生成する空間操作による出力 WKT でもあります。 
    </p><p>
      ネストされたジオメトリコレクションの解析中に、コレクションがフラット化され、その基本コンポーネントが様々な GIS 操作で使用されて結果が計算されます。 これにより、ジオメトリデータの一意性を考慮する必要がなくなるため、ユーザーに柔軟性が向上します。 ネストされたジオメトリコレクションは、最初に明示的にフラット化しなくても、ネストされた GIS 関数コールから生成できます。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-wkt-functions"></a>12.17.3 WKT 値からジオメトリ値を作成する関数</h3></div></div></div><p>
      これらの関数は、引数として Well-Known Text (WKT) 表現と、オプションで空間参照システム識別子 (SRID) を受け取ります。 これらは、対応するジオメトリを返します。 WKT 形式については、<a class="xref" href="data-types.html#gis-wkt-format" title="WKT (Well-Known Text) 形式">WKT (Well-Known Text) 形式</a>を参照してください。 
    </p><p>
      このセクションの関数は、デカルトまたは地理空間参照システム (SRS) の引数を検出し、SRS に適した結果を戻します。
    </p><p>
      <code class="literal">ST_GeomFromText()</code> は、ジオメトリタイプの WKT 値を最初の引数として受け入れます。 その他の関数は、各ジオメトリ型のジオメトリ値の構築のための型固有の構築関数を提供します。 
    </p><p>
      <code class="literal">MultiPoint</code> 値の WKT 形式表現を受け入れる <code class="literal">ST_MPointFromText()</code> や <code class="literal">ST_GeomFromText()</code> などの関数では、値内の個々のポイントをカッコで囲むことができます。 たとえば、次の関数コールは両方とも有効です: 
    </p><pre class="programlisting">ST_MPointFromText('MULTIPOINT (1 1, 2 2, 3 3)')
ST_MPointFromText('MULTIPOINT ((1 1), (2 2), (3 3))')
</pre><p>
      WKT ジオメトリコレクション引数を受け入れる <code class="literal">ST_GeomFromText()</code> などの関数は、OpenGIS <code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文と MySQL <code class="literal">'GEOMETRYCOLLECTION()'</code>非標準構文の両方を理解します。 WKT 値を生成する <code class="literal">ST_AsWKT()</code> などの関数は、<code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文を生成します: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s1 = ST_GeomFromText('GEOMETRYCOLLECTION()');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s2 = ST_GeomFromText('GEOMETRYCOLLECTION EMPTY');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsWKT(@s1), ST_AsWKT(@s2);</code></strong>
+--------------------------+--------------------------+
| ST_AsWKT(@s1)            | ST_AsWKT(@s2)            |
+--------------------------+--------------------------+
| GEOMETRYCOLLECTION EMPTY | GEOMETRYCOLLECTION EMPTY |
+--------------------------+--------------------------+
</pre><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          ジオメトリ引数が <code class="literal">NULL</code> の場合、構文的に整形式のジオメトリでない場合、または SRID 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          デフォルトでは、地理座標 (緯度、経度) は、ジオメトリ引数の空間参照システムで指定された順序で解釈されます。 オプションの <em class="replaceable"><code>options</code></em> 引数を指定して、デフォルトの軸の順序をオーバーライドできます。<code class="option">options</code> は、カンマ区切りの <code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code> のリストで構成されます。 許可されている <em class="replaceable"><code>key</code></em> 値は <code class="literal">axis-order</code> のみで、<code class="literal">lat-long</code>、<code class="literal">long-lat</code> および <code class="literal">srid-defined</code> (デフォルト) の値が許可されています。 
        </p><p>
          <em class="replaceable"><code>options</code></em> 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 <em class="replaceable"><code>options</code></em> 引数が無効な場合は、理由を示すエラーが発生します。 
        </p></li><li class="listitem"><p>
          SRID 引数が未定義の空間参照システム (SRS) を参照すると、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              経度の値が (−180, 180]の範囲にない場合は、<code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              緯度の値が[−90, 90]の範囲にない場合は、<code class="literal">ER_LATITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><p>
          表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
        </p></li></ul></div><p>
      WKT 値からジオメトリを作成するには、次の関数を使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geomcollfromtext"></a><p>
          <code class="literal">ST_GeomCollFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_GeometryCollectionFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_GeomCollFromTxt(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618423712"></a><a class="indexterm" name="idm46041618422368"></a><p>
          WKT 表現と SRID を使用して <code class="literal">GeometryCollection</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = "MULTILINESTRING((10 10, 11 11), (9 9, 10 10))";</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomCollFromText(@g));</code></strong>
+--------------------------------------------+
| ST_AsText(ST_GeomCollFromText(@g))         |
+--------------------------------------------+
| MULTILINESTRING((10 10,11 11),(9 9,10 10)) |
+--------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-geomfromtext"></a><p>
          <code class="literal">ST_GeomFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_GeometryFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618406784"></a><a class="indexterm" name="idm46041618405440"></a><p>
          WKT 表現と SRID を使用して任意の型のジオメトリ値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-linefromtext"></a><p>
          <code class="literal">ST_LineFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_LineStringFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618394256"></a><a class="indexterm" name="idm46041618392912"></a><p>
          WKT 表現と SRID を使用して <code class="literal">LineString</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mlinefromtext"></a><p>
          <code class="literal">ST_MLineFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiLineStringFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618381056"></a><a class="indexterm" name="idm46041618379712"></a><p>
          WKT 表現と SRID を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mpointfromtext"></a><p>
          <code class="literal">ST_MPointFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiPointFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618367792"></a><a class="indexterm" name="idm46041618366448"></a><p>
          WKT 表現と SRID を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mpolyfromtext"></a><p>
          <code class="literal">ST_MPolyFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiPolygonFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618354640"></a><a class="indexterm" name="idm46041618353296"></a><p>
          WKT 表現と SRID を使用して <code class="literal">MultiPolygon</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-pointfromtext"></a><p>
          <code class="literal">ST_PointFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618343920"></a><p>
          WKT 表現と SRID を使用して <code class="literal">Point</code> 値を構築します。
        </p><p>
          <code class="literal">ST_PointFromText()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p></li><li class="listitem"><a name="function_st-polyfromtext"></a><p>
          <code class="literal">ST_PolyFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_PolygonFromText(<em class="replaceable"><code>wkt</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618331312"></a><a class="indexterm" name="idm46041618329968"></a><p>
          WKT 表現と SRID を使用して <code class="literal">Polygon</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-wkb-functions"></a>12.17.4 WKB 値からジオメトリ値を作成する関数</h3></div></div></div><p>
      これらの関数は、引数として Well-Known Binary (WKB) 表現を含む <code class="literal">BLOB</code> と、オプションで空間参照システム識別子 (SRID) を受け取ります。 これらは、対応するジオメトリを返します。 WKB 形式については、<a class="xref" href="data-types.html#gis-wkb-format" title="WKB (Well-Known Binary) 形式">WKB (Well-Known Binary) 形式</a>を参照してください。 
    </p><p>
      このセクションの関数は、デカルトまたは地理空間参照システム (SRS) の引数を検出し、SRS に適した結果を戻します。
    </p><p>
      <code class="literal">ST_GeomFromWKB()</code> は、ジオメトリタイプの WKB 値を最初の引数として受け入れます。 その他の関数は、各ジオメトリ型のジオメトリ値の構築のための型固有の構築関数を提供します。 
    </p><p>
      MySQL 8.0 より前は、これらの関数は <a class="xref" href="functions.html#gis-mysql-specific-functions" title="12.17.5 ジオメトリ値を作成する MySQL 固有の関数">セクション12.17.5「ジオメトリ値を作成する MySQL 固有の関数」</a> の関数によって戻されたジオメトリオブジェクトも受け入れていました。 ジオメトリ引数は許可されなくなり、エラーが発生します。 ジオメトリ引数の使用から WKB 引数の使用にコールを移行するには、次のガイドラインに従います: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">ST_GeomFromWKB(Point(0, 0))</code> などの構成を <code class="literal">Point(0, 0)</code> として書き換えます。
        </p></li><li class="listitem"><p>
          <code class="literal">ST_SRID(Point(0, 0), 4326)</code> や <code class="literal">ST_GeomFromWKB(ST_AsWKB(Point(0, 0)), 4326)</code> などの <code class="literal">ST_GeomFromWKB(Point(0, 0), 4326)</code> の構成を書き換えます。
        </p></li></ul></div><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          WKB または SRID 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          デフォルトでは、地理座標 (緯度、経度) は、ジオメトリ引数の空間参照システムで指定された順序で解釈されます。 オプションの <em class="replaceable"><code>options</code></em> 引数を指定して、デフォルトの軸の順序をオーバーライドできます。<code class="option">options</code> は、カンマ区切りの <code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code> のリストで構成されます。 許可されている <em class="replaceable"><code>key</code></em> 値は <code class="literal">axis-order</code> のみで、<code class="literal">lat-long</code>、<code class="literal">long-lat</code> および <code class="literal">srid-defined</code> (デフォルト) の値が許可されています。 
        </p><p>
          <em class="replaceable"><code>options</code></em> 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 <em class="replaceable"><code>options</code></em> 引数が無効な場合は、理由を示すエラーが発生します。 
        </p></li><li class="listitem"><p>
          SRID 引数が未定義の空間参照システム (SRS) を参照すると、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              経度の値が (−180, 180]の範囲にない場合は、<code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              緯度の値が[−90, 90]の範囲にない場合は、<code class="literal">ER_LATITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><p>
          表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
        </p></li></ul></div><p>
      WKB 値からジオメトリを作成するには、次の関数を使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geomcollfromwkb"></a><p>
          <code class="literal">ST_GeomCollFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_GeometryCollectionFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618278720"></a><a class="indexterm" name="idm46041618277376"></a><p>
          WKB 表現と SRID を使用して <code class="literal">GeometryCollection</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-geomfromwkb"></a><p>
          <code class="literal">ST_GeomFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_GeometryFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618265552"></a><a class="indexterm" name="idm46041618264208"></a><p>
          WKB 表現と SRID を使用して任意の型のジオメトリ値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-linefromwkb"></a><p>
          <code class="literal">ST_LineFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_LineStringFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618253056"></a><a class="indexterm" name="idm46041618251712"></a><p>
          WKB 表現と SRID を使用して <code class="literal">LineString</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mlinefromwkb"></a><p>
          <code class="literal">ST_MLineFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiLineStringFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618239856"></a><a class="indexterm" name="idm46041618238512"></a><p>
          WKB 表現と SRID を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mpointfromwkb"></a><p>
          <code class="literal">ST_MPointFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiPointFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618226656"></a><a class="indexterm" name="idm46041618225312"></a><p>
          WKB 表現と SRID を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-mpolyfromwkb"></a><p>
          <code class="literal">ST_MPolyFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_MultiPolygonFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618213424"></a><a class="indexterm" name="idm46041618212080"></a><p>
          WKB 表現と SRID を使用して <code class="literal">MultiPolygon</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li><li class="listitem"><a name="function_st-pointfromwkb"></a><p>
          <code class="literal">ST_PointFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618202816"></a><p>
          WKB 表現と SRID を使用して <code class="literal">Point</code> 値を構築します。
        </p><p>
          <code class="literal">ST_PointFromWKB()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p></li><li class="listitem"><a name="function_st-polyfromwkb"></a><p>
          <code class="literal">ST_PolyFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>, <code class="literal">ST_PolygonFromWKB(<em class="replaceable"><code>wkb</code></em> [, <em class="replaceable"><code>srid</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041618190176"></a><a class="indexterm" name="idm46041618188832"></a><p>
          WKB 表現と SRID を使用して <code class="literal">Polygon</code> 値を構築します。
        </p><p>
          これらの関数は、このセクションの概要で説明されているように、引数を処理します。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-mysql-specific-functions"></a>12.17.5 ジオメトリ値を作成する MySQL 固有の関数</h3></div></div></div><p>
      MySQL には、ジオメトリ値を作成するために役立つ一連の非標準関数が用意されています。 このセクションで説明されている関数は、OpenGIS 仕様への MySQL 拡張です。 
    </p><p>
      これらの関数は、引数としての WKB 値またはジオメトリオブジェクトからジオメトリオブジェクトを生成します。 いずれかの引数が適切な WKB でも、適切なオブジェクト型のジオメトリ表現でもない場合、戻り値は <code class="literal">NULL</code> になります。 
    </p><p>
      たとえば、<code class="literal">Point()</code> からのジオメトリの戻り値を <code class="literal">POINT</code> カラムに直接挿入できます。
    </p><pre class="programlisting">INSERT INTO t1 (pt_col) VALUES(Point(1,2));
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geomcollection"></a><p>
          <code class="literal">GeomCollection(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>g</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618171648"></a><p>
          ジオメトリ引数から <code class="literal">GeomCollection</code> 値を構築します。
        </p><p>
          <code class="literal">GeomCollection()</code> は、サポートされていないジオメトリが存在する場合でも、引数に含まれるすべての適切なジオメトリを戻します。
        </p><p>
          引数のない <code class="literal">GeomCollection()</code> は、空のジオメトリを作成する方法として許可されています。 また、WKT ジオメトリコレクション引数を受け入れる <code class="literal">ST_GeomFromText()</code> などの関数は、OpenGIS <code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文と MySQL <code class="literal">'GEOMETRYCOLLECTION()'</code>非標準構文の両方を理解します。 
        </p><p>
          <code class="literal">GeomCollection()</code> と <code class="literal">GeometryCollection()</code> は同義ですが、<code class="literal">GeomCollection()</code> を使用することをお薦めします。
        </p></li><li class="listitem"><a name="function_geometrycollection"></a><p>
          <code class="literal">GeometryCollection(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>g</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618153984"></a><p>
          ジオメトリ引数から <code class="literal">GeomCollection</code> 値を構築します。
        </p><p>
          <code class="literal">GeometryCollection()</code> は、サポートされていないジオメトリが存在する場合でも、引数に含まれるすべての適切なジオメトリを戻します。
        </p><p>
          引数のない <code class="literal">GeometryCollection()</code> は、空のジオメトリを作成する方法として許可されています。 また、WKT ジオメトリコレクション引数を受け入れる <code class="literal">ST_GeomFromText()</code> などの関数は、OpenGIS <code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文と MySQL <code class="literal">'GEOMETRYCOLLECTION()'</code>非標準構文の両方を理解します。 
        </p><p>
          <code class="literal">GeomCollection()</code> と <code class="literal">GeometryCollection()</code> は同義ですが、<code class="literal">GeomCollection()</code> を使用することをお薦めします。
        </p></li><li class="listitem"><a name="function_linestring"></a><p>
          <code class="literal">LineString(<em class="replaceable"><code>pt</code></em> [, <em class="replaceable"><code>pt</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618136400"></a><p>
          複数の <code class="literal">Point</code> または WKB <code class="literal">Point</code> 引数から <code class="literal">LineString</code> 値を構築します。 引数の数が 2 未満の場合、戻り値は <code class="literal">NULL</code> になります。 
        </p></li><li class="listitem"><a name="function_multilinestring"></a><p>
          <code class="literal">MultiLineString(<em class="replaceable"><code>ls</code></em> [, <em class="replaceable"><code>ls</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618125904"></a><p>
          <code class="literal">LineString</code> または WKB <code class="literal">LineString</code> 引数を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_multipoint"></a><p>
          <code class="literal">MultiPoint(<em class="replaceable"><code>pt</code></em> [, <em class="replaceable"><code>pt2</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618116384"></a><p>
          <code class="literal">Point</code> または WKB <code class="literal">Point</code> 引数を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_multipolygon"></a><p>
          <code class="literal">MultiPolygon(<em class="replaceable"><code>poly</code></em> [, <em class="replaceable"><code>poly</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618106864"></a><p>
          一連の <code class="literal">Polygon</code> または WKB <code class="literal">Polygon</code> 引数から <code class="literal">MultiPolygon</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_point"></a><p>
          <code class="literal">Point(<em class="replaceable"><code>x</code></em>, <em class="replaceable"><code>y</code></em>)</code>
        </p><a class="indexterm" name="idm46041618097360"></a><p>
          座標を使用して <code class="literal">Point</code> を構築します。
        </p></li><li class="listitem"><a name="function_polygon"></a><p>
          <code class="literal">Polygon(<em class="replaceable"><code>ls</code></em> [, <em class="replaceable"><code>ls</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041618089248"></a><p>
          複数の <code class="literal">LineString</code> または WKB <code class="literal">LineString</code> 引数から <code class="literal">Polygon</code> 値を構築します。 いずれかの引数が <code class="literal">LinearRing</code> を表していない (つまり、閉じた単純な <code class="literal">LineString</code> でない) 場合、戻り値は <code class="literal">NULL</code> になります。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-format-conversion-functions"></a>12.17.6 ジオメトリ形式変換関数</h3></div></div></div><p>
      MySQL では、ジオメトリ値を内部ジオメトリフォーマットから WKT フォーマットまたは WKB フォーマットに変換したり、X 座標と Y 座標の順序を入れ替えるために、このセクションにリストされている関数がサポートされています。
    </p><p>
      文字列を WKT または WKB 形式から内部ジオメトリ形式に変換する関数もあります。 <a class="xref" href="functions.html#gis-wkt-functions" title="12.17.3 WKT 値からジオメトリ値を作成する関数">セクション12.17.3「WKT 値からジオメトリ値を作成する関数」</a>および<a class="xref" href="functions.html#gis-wkb-functions" title="12.17.4 WKB 値からジオメトリ値を作成する関数">セクション12.17.4「WKB 値からジオメトリ値を作成する関数」</a>を参照してください。 
    </p><p>
      WKT ジオメトリコレクション引数を受け入れる <code class="literal">ST_GeomFromText()</code> などの関数は、OpenGIS <code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文と MySQL <code class="literal">'GEOMETRYCOLLECTION()'</code>非標準構文の両方を理解します。 空のジオメトリコレクションを生成する別の方法は、引数を指定せずに <code class="literal">GeometryCollection()</code> をコールすることです。 WKT 値を生成する <code class="literal">ST_AsWKT()</code> などの関数は、<code class="literal">'GEOMETRYCOLLECTION EMPTY'</code>標準構文を生成します: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s1 = ST_GeomFromText('GEOMETRYCOLLECTION()');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s2 = ST_GeomFromText('GEOMETRYCOLLECTION EMPTY');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsWKT(@s1), ST_AsWKT(@s2);</code></strong>
+--------------------------+--------------------------+
| ST_AsWKT(@s1)            | ST_AsWKT(@s2)            |
+--------------------------+--------------------------+
| GEOMETRYCOLLECTION EMPTY | GEOMETRYCOLLECTION EMPTY |
+--------------------------+--------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsWKT(GeomCollection());</code></strong>
+----------------------------+
| ST_AsWKT(GeomCollection()) |
+----------------------------+
| GEOMETRYCOLLECTION EMPTY   |
+----------------------------+
</pre><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          ジオメトリ引数が未定義の空間参照システムにある場合、軸はジオメトリに出現する順序で出力され、<code class="literal">ER_WARN_SRS_NOT_FOUND_AXIS_ORDER</code> 警告が発生します。
        </p></li><li class="listitem"><p>
          デフォルトでは、地理座標 (緯度、経度) は、ジオメトリ引数の空間参照システムで指定された順序で解釈されます。 オプションの <em class="replaceable"><code>options</code></em> 引数を指定して、デフォルトの軸の順序をオーバーライドできます。<code class="option">options</code> は、カンマ区切りの <code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code> のリストで構成されます。 許可されている <em class="replaceable"><code>key</code></em> 値は <code class="literal">axis-order</code> のみで、<code class="literal">lat-long</code>、<code class="literal">long-lat</code> および <code class="literal">srid-defined</code> (デフォルト) の値が許可されています。 
        </p><p>
          <em class="replaceable"><code>options</code></em> 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 <em class="replaceable"><code>options</code></em> 引数が無効な場合は、理由を示すエラーが発生します。 
        </p></li><li class="listitem"><p>
          それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
        </p></li></ul></div><p>
      次の関数は、フォーマット変換または座標の入替えに使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-asbinary"></a><p>
          <code class="literal">ST_AsBinary(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>options</code></em>])</code>, <code class="literal">ST_AsWKB(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>options</code></em>])</code>
        </p><a class="indexterm" name="idm46041618038880"></a><p>
          内部ジオメトリ形式の値を WKB 表現に変換し、そのバイナリの結果を返します。
        </p><p>
          関数の戻り値には、ジオメトリ引数に適用される空間参照システムで指定された順序で地理座標 (緯度、経度) が含まれます。 オプションの <em class="replaceable"><code>options</code></em> 引数を指定して、デフォルトの軸の順序をオーバーライドできます。 
        </p><p>
          <code class="literal">ST_AsBinary()</code> および <code class="literal">ST_AsWKB()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = ST_LineFromText('LINESTRING(0 5,5 10,10 15)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g)));</code></strong>
+-----------------------------------------+
| ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g))) |
+-----------------------------------------+
| LINESTRING(5 0,10 5,15 10)              |
+-----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=long-lat')));</code></strong>
+----------------------------------------------------------------+
| ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=long-lat'))) |
+----------------------------------------------------------------+
| LINESTRING(0 5,5 10,10 15)                                     |
+----------------------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=lat-long')));</code></strong>
+----------------------------------------------------------------+
| ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=lat-long'))) |
+----------------------------------------------------------------+
| LINESTRING(5 0,10 5,15 10)                                     |
+----------------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-astext"></a><p>
          <code class="literal">ST_AsText(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>options</code></em>])</code>, <code class="literal">ST_AsWKT(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>options</code></em>])</code>
        </p><a class="indexterm" name="idm46041618019072"></a><p>
          内部ジオメトリ形式の値を WKT 表現に変換し、その文字列の結果を返します。
        </p><p>
          関数の戻り値には、ジオメトリ引数に適用される空間参照システムで指定された順序で地理座標 (緯度、経度) が含まれます。 オプションの <em class="replaceable"><code>options</code></em> 引数を指定して、デフォルトの軸の順序をオーバーライドできます。 
        </p><p>
          <code class="literal">ST_AsText()</code> および <code class="literal">ST_AsWKT()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromText(@g));</code></strong>
+--------------------------------+
| ST_AsText(ST_GeomFromText(@g)) |
+--------------------------------+
| LINESTRING(1 1,2 2,3 3)        |
+--------------------------------+
</pre><p>
          <code class="literal">MultiPoint</code> 値の出力では、各点の周囲にカッコが含まれます。 例: 
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromText(@mp));</code></strong>
+---------------------------------+
| ST_AsText(ST_GeomFromText(@mp)) |
+---------------------------------+
| MULTIPOINT((1 1),(2 2),(3 3))   |
+---------------------------------+
</pre></li><li class="listitem"><a name="function_st-swapxy"></a><p>
          <code class="literal">ST_SwapXY(<em class="replaceable"><code>g</code></em>)</code>
        </p><a class="indexterm" name="idm46041618001536"></a><p>
          内部ジオメトリ形式の引数を受け入れ、ジオメトリ内の各座標ペアの X 値と Y 値を入れ替えて、結果を返します。
        </p><p>
          <code class="literal">ST_SwapXY()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = ST_LineFromText('LINESTRING(0 5,5 10,10 15)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(@g);</code></strong>
+----------------------------+
| ST_AsText(@g)              |
+----------------------------+
| LINESTRING(0 5,5 10,10 15) |
+----------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_SwapXY(@g));</code></strong>
+----------------------------+
| ST_AsText(ST_SwapXY(@g))   |
+----------------------------+
| LINESTRING(5 0,10 5,15 10) |
+----------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-property-functions"></a>12.17.7 ジオメトリプロパティー関数</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#gis-general-property-functions">12.17.7.1 一般的なジオメトリプロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-point-property-functions">12.17.7.2 Pointプロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-linestring-property-functions">12.17.7.3 LineString および MultiLineString のプロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-polygon-property-functions">12.17.7.4 Polygon および MultiPolygon プロパティ関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-geometrycollection-property-functions">12.17.7.5 GeometryCollection プロパティー関数</a></span></dt></dl></div><p>
      このグループに属する各関数は、引数としてジオメトリ値を受け取り、そのジオメトリの何らかの定量的または定性的なプロパティーを返します。 一部の関数では、その引数の型が制限されます。 このような関数は、その引数のジオメトリ型が正しくない場合は <code class="literal">NULL</code> を返します。 たとえば、オブジェクトタイプが <code class="literal">Polygon</code> でも <code class="literal">MultiPolygon</code> でもない場合、<code class="literal">ST_Area()</code> ポリゴン関数は <code class="literal">NULL</code> を返します。 
    </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-general-property-functions"></a>12.17.7.1 一般的なジオメトリプロパティー関数</h4></div></div></div><p>
        このセクションに示されている関数では引数が制限されず、任意の型のジオメトリ値が受け入れられます。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            SRID 引数が 32 ビット符号なし整数の範囲内にない場合は、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            SRID 引数が未定義の SRS を参照すると、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        ジオメトリプロパティを取得するには、次の関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-dimension"></a><p>
            <code class="literal">ST_Dimension(<em class="replaceable"><code>g</code></em>)</code>
          </p><a class="indexterm" name="idm46041617964848"></a><p>
            ジオメトリ値 <em class="replaceable"><code>g</code></em> の固有の次元を返します。 dimension は −1、0、1、または 2 の値を取ります。 これらの値の意味は、<a class="xref" href="data-types.html#gis-class-geometry" title="11.4.2.2 Geometry クラス">セクション11.4.2.2「Geometry クラス」</a>で指定されています。 
          </p><p>
            <code class="literal">ST_Dimension()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_Dimension(ST_GeomFromText('LineString(1 1,2 2)'));</code></strong>
+------------------------------------------------------+
| ST_Dimension(ST_GeomFromText('LineString(1 1,2 2)')) |
+------------------------------------------------------+
|                                                    1 |
+------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-envelope"></a><p>
            <code class="literal">ST_Envelope(<em class="replaceable"><code>g</code></em>)</code>
          </p><a class="indexterm" name="idm46041617952544"></a><p>
            ジオメトリ値 <em class="replaceable"><code>g</code></em> の最小境界矩形 (MBR) を返します。 結果は、その境界矩形の角の点によって定義される <code class="literal">Polygon</code> 値として返されます。 
          </p><pre class="programlisting">POLYGON((MINX MINY, MAXX MINY, MAXX MAXY, MINX MAXY, MINX MINY))
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,2 2)')));</code></strong>
+----------------------------------------------------------------+
| ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,2 2)'))) |
+----------------------------------------------------------------+
| POLYGON((1 1,2 1,2 2,1 2,1 1))                                 |
+----------------------------------------------------------------+
</pre><p>
            引数が点、垂直または水平の線セグメントの場合、<code class="literal">ST_Envelope()</code> は無効なポリゴンを戻すのではなく、点または線セグメントを MBR として戻します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,1 2)')));</code></strong>
+----------------------------------------------------------------+
| ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,1 2)'))) |
+----------------------------------------------------------------+
| LINESTRING(1 1,1 2)                                            |
+----------------------------------------------------------------+
</pre><p>
            <code class="literal">ST_Envelope()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリに地理空間参照システム (SRS) の SRID 値がある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
              </p></li></ul></div></li><li class="listitem"><a name="function_st-geometrytype"></a><p>
            <code class="literal">ST_GeometryType(<em class="replaceable"><code>g</code></em>)</code>
          </p><a class="indexterm" name="idm46041617933264"></a><p>
            ジオメトリインスタンス <em class="replaceable"><code>g</code></em> がメンバーになっているジオメトリ型の名前を示すバイナリ文字列を返します。 この名前は、インスタンス化可能な <code class="literal">Geometry</code> サブクラスのいずれかに対応します。 
          </p><p>
            <code class="literal">ST_GeometryType()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_GeometryType(ST_GeomFromText('POINT(1 1)'));</code></strong>
+------------------------------------------------+
| ST_GeometryType(ST_GeomFromText('POINT(1 1)')) |
+------------------------------------------------+
| POINT                                          |
+------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-isempty"></a><p>
            <code class="literal">ST_IsEmpty(<em class="replaceable"><code>g</code></em>)</code>
          </p><a class="indexterm" name="idm46041617920752"></a><p>
            この関数は、空のジオメトリコレクション値の場合は 1 を戻し、それ以外の場合は 0 を戻すプレースホルダです。
          </p><p>
            有効な空のジオメトリのみが、空のジオメトリコレクション値の形式で表されます。 MySQL は、<code class="literal">POINT EMPTY</code> などの GIS の <code class="literal">EMPTY</code> 値をサポートしていません。 
          </p><p>
            <code class="literal">ST_IsEmpty()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_st-issimple"></a><p>
            <code class="literal">ST_IsSimple(<em class="replaceable"><code>g</code></em>)</code>
          </p><a class="indexterm" name="idm46041617909808"></a><p>
            ISO <em class="citetitle">「SQL/MM パート 3: 空間」</em>標準に従ってジオメトリ値 <em class="replaceable"><code>g</code></em> が単純な場合、1 を返します。 引数が単純でない場合、<code class="literal">ST_IsSimple()</code> は 0 を返します。 
          </p><p>
            <a class="xref" href="data-types.html#opengis-geometry-model" title="11.4.2 OpenGIS ジオメトリモデル">セクション11.4.2「OpenGIS ジオメトリモデル」</a> で指定されるインスタンス化可能ジオメトリクラスの説明には、クラスインスタンスが単純ではないと分類される特定の条件が含まれます。
          </p><p>
            <code class="literal">ST_IsSimple()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリに経度または緯度が範囲外の地理 SRS がある場合、エラーが発生します:
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                    経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                  </p></li><li class="listitem"><p>
                    緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                  </p></li></ul></div><p>
                表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
              </p></li></ul></div></li><li class="listitem"><a name="function_st-srid"></a><p>
            <code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>srid</code></em>])</code>
          </p><a class="indexterm" name="idm46041617888704"></a><p>
            引数として有効なジオメトリオブジェクト <em class="replaceable"><code>g</code></em> を 1 つだけ与えた場合、<code class="literal">ST_SRID()</code> は、<em class="replaceable"><code>g</code></em> に関連付けられた空間参照システム (SRS) の ID を示す整数を戻します。
          </p><p>
            オプションである 2 番目の引数として有効な SRID 値を与えた場合、<code class="literal">ST_SRID()</code> は、SRID 値が 2 番目の引数と等しい最初の引数と同じ型のオブジェクトを戻します。 これにより、オブジェクトの SRID 値のみが設定され、座標値の変換は実行されません。 
          </p><p>
            <code class="literal">ST_SRID()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                単一引数構文の場合、<code class="literal">ST_SRID()</code> は未定義の SRS を参照していてもジオメトリ SRID を戻します。 <code class="literal">ER_SRS_NOT_FOUND</code> エラーは発生しません。 
              </p></li></ul></div><p>
            <code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>target_srid</code></em>)</code> と <code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>target_srid</code></em>)</code> は、次の点で異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">ST_SRID()</code> は、座標を変換せずにジオメトリ SRID 値を変更します。
              </p></li><li class="listitem"><p>
                <code class="literal">ST_Transform()</code> は、SRID 値の変更に加えてジオメトリ座標を変換します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = ST_GeomFromText('LineString(1 1,2 2)', 0);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_SRID(@g);</code></strong>
+-------------+
| ST_SRID(@g) |
+-------------+
|           0 |
+-------------+
mysql&gt; <strong class="userinput"><code>SET @g = ST_SRID(@g, 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_SRID(@g);</code></strong>
+-------------+
| ST_SRID(@g) |
+-------------+
|        4326 |
+-------------+
</pre><p>
            空間値を作成するための MySQL 固有関数の結果を SRID 値とともに <code class="literal">ST_SRID()</code> に渡すことで、特定の SRID にジオメトリを作成できます。 例: 
          </p><pre class="programlisting">SET @g1 = ST_SRID(Point(1, 1), 4326);
</pre><p>
            ただし、このメソッドは SRID 0 にジオメトリを作成し、SRID 4326 (WGS 84) にキャストします。 最初に正しい空間参照システムを使用してジオメトリを作成することをお薦めします。 例: 
          </p><pre class="programlisting">SET @g1 = ST_PointFromText('POINT(1 1)', 4326);
SET @g1 = ST_GeomFromText('POINT(1 1)', 4326);
</pre><p>
            <code class="literal">ST_SRID()</code> の 2 引数形式は、SRID が正しくないジオメトリの SRS の修正や変更などのタスクに役立ちます。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-point-property-functions"></a>12.17.7.2 Pointプロパティー関数</h4></div></div></div><p>
        <code class="literal">Point</code> は X 座標と Y 座標で構成され、それぞれ <code class="literal">ST_X()</code> 関数と <code class="literal">ST_Y()</code> 関数を使用して取得できます。 これらの関数では、X または Y 座標値を指定するオプションの第 2 引数も許可されます。この場合、関数の結果は最初の引数の <code class="literal">Point</code> オブジェクトになり、X 座標または Y 座標が 2 番目の引数と等しくなるように変更されます。 
      </p><p>
        地理空間参照システム (SRS) を持つ <code class="literal">Point</code> オブジェクトの場合、経度および緯度は、それぞれ <code class="literal">ST_Longitude()</code> 関数および <code class="literal">ST_Latitude()</code> 関数を使用して取得できます。 これらの関数では、経度または緯度の値を指定するオプションの第 2 引数も許可されます。この場合、関数の結果は、経度または緯度が変更された最初の引数の <code class="literal">Point</code> オブジェクトとなり、2 番目の引数と等しくなります。 
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が有効なジオメトリであるが、<code class="literal">Point</code> オブジェクトではない場合、<code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            X または Y 座標引数が指定され、値が <code class="literal">-inf</code>、<code class="literal">+inf</code> または <code class="literal">NaN</code> の場合、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            経度または緯度の値が範囲外の場合は、エラーが発生します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                経度の値が (−180, 180]の範囲にない場合は、<code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                緯度の値が[−90, 90]の範囲にない場合は、<code class="literal">ER_LATITUDE_OUT_OF_RANGE</code> エラーが発生します。
              </p></li></ul></div><p>
            表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        ポイントプロパティを取得するには、次の関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-latitude"></a><p>
            <code class="literal">ST_Latitude(<em class="replaceable"><code>p</code></em> [, <em class="replaceable"><code>new_latitude_val</code></em>])</code>
          </p><a class="indexterm" name="idm46041617816544"></a><p>
            地理空間参照システム (SRS) を持つ有効な <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> を表す単一の引数を使用すると、<code class="literal">ST_Latitude()</code> は <em class="replaceable"><code>p</code></em> の緯度値を倍精度数値として返します。
          </p><p>
            有効な緯度値を表すオプションの第 2 引数を使用すると、<code class="literal">ST_Latitude()</code> は、最初の引数のように、緯度が 2 番目の引数と等しい <code class="literal">Point</code> オブジェクトを返します。
          </p><p>
            <code class="literal">ST_Latitude()</code> では、このセクションの概要で説明されているように引数が処理されますが、<code class="literal">Point</code> オブジェクトは有効ですが地理 SRS がない場合は、<code class="literal">ER_SRS_NOT_GEOGRAPHIC</code> エラーが発生します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(45 90)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Latitude(@pt);</code></strong>
+------------------+
| ST_Latitude(@pt) |
+------------------+
|               45 |
+------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Latitude(@pt, 10));</code></strong>
+---------------------------------+
| ST_AsText(ST_Latitude(@pt, 10)) |
+---------------------------------+
| POINT(10 90)                    |
+---------------------------------+
</pre><p>
            この関数は、MySQL 8.0.12 で追加されました。
          </p></li><li class="listitem"><a name="function_st-longitude"></a><p>
            <code class="literal">ST_Longitude(<em class="replaceable"><code>p</code></em> [, <em class="replaceable"><code>new_longitude_val</code></em>])</code>
          </p><a class="indexterm" name="idm46041617795232"></a><p>
            地理空間参照システム (SRS) を持つ有効な <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> を表す単一の引数を使用すると、<code class="literal">ST_Longitude()</code> は <em class="replaceable"><code>p</code></em> の経度値を倍精度数値として返します。
          </p><p>
            オプションの第 2 引数が有効な経度値を表す場合、<code class="literal">ST_Longitude()</code> は、経度が 2 番目の引数と等しい最初の引数のような <code class="literal">Point</code> オブジェクトを返します。
          </p><p>
            <code class="literal">ST_Longitude()</code> では、このセクションの概要で説明されているように引数が処理されますが、<code class="literal">Point</code> オブジェクトは有効ですが地理 SRS がない場合は、<code class="literal">ER_SRS_NOT_GEOGRAPHIC</code> エラーが発生します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(45 90)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Longitude(@pt);</code></strong>
+-------------------+
| ST_Longitude(@pt) |
+-------------------+
|                90 |
+-------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Longitude(@pt, 10));</code></strong>
+----------------------------------+
| ST_AsText(ST_Longitude(@pt, 10)) |
+----------------------------------+
| POINT(45 10)                     |
+----------------------------------+
</pre><p>
            この関数は、MySQL 8.0.12 で追加されました。
          </p></li><li class="listitem"><a name="function_st-x"></a><p>
            <code class="literal">ST_X(<em class="replaceable"><code>p</code></em> [, <em class="replaceable"><code>new_x_val</code></em>])</code>
          </p><a class="indexterm" name="idm46041617773904"></a><p>
            有効な <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> を表す単一の引数を使用すると、<code class="literal">ST_X()</code> は <em class="replaceable"><code>p</code></em> の X 座標値を倍精度数値として返します。 MySQL 8.0.12 では、X 座標は <code class="literal">Point</code> 空間参照システム (SRS) 定義で最初に表示される軸を参照しているとみなされます。 
          </p><p>
            オプションの second 引数を指定すると、<code class="literal">ST_X()</code> は、X 座標が 2 番目の引数と等しい最初の引数のような <code class="literal">Point</code> オブジェクトを返します。 MySQL 8.0.12 では、<code class="literal">Point</code> オブジェクトに地理 SRS がある場合、2 番目の引数は経度または緯度の値の適切な範囲内にある必要があります。 
          </p><p>
            <code class="literal">ST_X()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_X(Point(56.7, 53.34));</code></strong>
+--------------------------+
| ST_X(Point(56.7, 53.34)) |
+--------------------------+
|                     56.7 |
+--------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_X(Point(56.7, 53.34), 10.5));</code></strong>
+-------------------------------------------+
| ST_AsText(ST_X(Point(56.7, 53.34), 10.5)) |
+-------------------------------------------+
| POINT(10.5 53.34)                         |
+-------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-y"></a><p>
            <code class="literal">ST_Y(<em class="replaceable"><code>p</code></em> [, <em class="replaceable"><code>new_y_val</code></em>])</code>
          </p><a class="indexterm" name="idm46041617754224"></a><p>
            有効な <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> を表す単一の引数を使用すると、<code class="literal">ST_Y()</code> は <em class="replaceable"><code>p</code></em> の Y 座標値を倍精度の数値として返します。 MySQL 8.0.12 では、Y 座標は <code class="literal">Point</code> 空間参照システム (SRS) 定義で次に表示される軸を参照しているとみなされます。 
          </p><p>
            オプションの second 引数を指定すると、<code class="literal">ST_Y()</code> は、Y 座標が 2 番目の引数と等しい最初の引数のような <code class="literal">Point</code> オブジェクトを返します。 MySQL 8.0.12 では、<code class="literal">Point</code> オブジェクトに地理 SRS がある場合、2 番目の引数は経度または緯度の値の適切な範囲内にある必要があります。 
          </p><p>
            <code class="literal">ST_Y()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_Y(Point(56.7, 53.34));</code></strong>
+--------------------------+
| ST_Y(Point(56.7, 53.34)) |
+--------------------------+
|                    53.34 |
+--------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Y(Point(56.7, 53.34), 10.5));</code></strong>
+-------------------------------------------+
| ST_AsText(ST_Y(Point(56.7, 53.34), 10.5)) |
+-------------------------------------------+
| POINT(56.7 10.5)                          |
+-------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-linestring-property-functions"></a>12.17.7.3 LineString および MultiLineString のプロパティー関数</h4></div></div></div><p>
        <code class="literal">LineString</code> は、<code class="literal">Point</code> 値で構成されます。 <code class="literal">LineString</code> の特定の点を抽出したり、そこに含まれている点の数をカウントしたり、その長さを取得したりできます。 
      </p><p>
        このセクションの一部の関数は、<code class="literal">MultiLineString</code> 値に対しても機能します。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数が <code class="literal">NULL</code> の場合、またはジオメトリ引数が空のジオメトリの場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        linestring プロパティーを取得するには、次の関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-endpoint"></a><p>
            <code class="literal">ST_EndPoint(<em class="replaceable"><code>ls</code></em>)</code>
          </p><a class="indexterm" name="idm46041617718256"></a><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> の終点である <code class="literal">Point</code> を返します。
          </p><p>
            <code class="literal">ST_EndPoint()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_EndPoint(ST_GeomFromText(@ls)));</code></strong>
+----------------------------------------------+
| ST_AsText(ST_EndPoint(ST_GeomFromText(@ls))) |
+----------------------------------------------+
| POINT(3 3)                                   |
+----------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-isclosed"></a><p>
            <code class="literal">ST_IsClosed(<em class="replaceable"><code>ls</code></em>)</code>
          </p><a class="indexterm" name="idm46041617704800"></a><p>
            <code class="literal">LineString</code> 値が <em class="replaceable"><code>ls</code></em> の場合、<em class="replaceable"><code>ls</code></em> がクローズされると、<code class="literal">ST_IsClosed()</code> は 1 を返します (つまり、<code class="literal">ST_StartPoint()</code> と <code class="literal">ST_EndPoint()</code> の値が同じです)。
          </p><p>
            <code class="literal">MultiLineString</code> 値が <em class="replaceable"><code>ls</code></em> の場合、<em class="replaceable"><code>ls</code></em> がクローズされると、<code class="literal">ST_IsClosed()</code> は 1 を返します (つまり、<code class="literal">ST_StartPoint()</code> と <code class="literal">ST_EndPoint()</code> の値は <em class="replaceable"><code>ls</code></em> の <code class="literal">LineString</code> ごとに同じです)。
          </p><p>
            <code class="literal">ST_IsClosed()</code> は、<em class="replaceable"><code>ls</code></em> がクローズされていない場合は 0 を返し、<em class="replaceable"><code>ls</code></em> が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。
          </p><p>
            <code class="literal">ST_IsClosed()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリに地理空間参照システム (SRS) の SRID 値がある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = 'LineString(1 1,2 2,3 3,2 2)';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = 'LineString(1 1,2 2,3 3,1 1)';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls1));</code></strong>
+------------------------------------+
| ST_IsClosed(ST_GeomFromText(@ls1)) |
+------------------------------------+
|                                  0 |
+------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls2));</code></strong>
+------------------------------------+
| ST_IsClosed(ST_GeomFromText(@ls2)) |
+------------------------------------+
|                                  1 |
+------------------------------------+

mysql&gt; <strong class="userinput"><code>SET @ls3 = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls3));</code></strong>
+------------------------------------+
| ST_IsClosed(ST_GeomFromText(@ls3)) |
+------------------------------------+
|                                  0 |
+------------------------------------+
</pre></li><li class="listitem"><a name="function_st-length"></a><p>
            <code class="literal">ST_Length(<em class="replaceable"><code>ls</code></em> [, <em class="replaceable"><code>unit</code></em>])</code>
          </p><a class="indexterm" name="idm46041617671760"></a><p>
            関連付けられた空間参照システムにおける <code class="literal">LineString</code> または <code class="literal">MultiLineString</code> 値 <em class="replaceable"><code>ls</code></em> の長さを示す倍精度数値を戻します。 <code class="literal">MultiLineString</code> 値の長さは、その要素の長さの合計と等しくなります。 
          </p><p>
            <code class="literal">ST_Length()</code> では、次のように結果が計算されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリがデカルト SRS の有効な <code class="literal">LineString</code> である場合、戻り値はジオメトリのデカルト長です。
              </p></li><li class="listitem"><p>
                ジオメトリがデカルト SRS 内の有効な <code class="literal">MultiLineString</code> である場合、戻り値はその要素のデカルト長の合計です。
              </p></li><li class="listitem"><p>
                ジオメトリが地理 SRS 内の有効な <code class="literal">LineString</code> である場合、戻り値はその SRS 内のジオメトリの測地長 (メートル) です。
              </p></li><li class="listitem"><p>
                ジオメトリが地理 SRS 内の有効な <code class="literal">MultiLineString</code> である場合、戻り値は SRS 内の要素の測地長の合計 (メートル) です。
              </p></li></ul></div><p>
            <code class="literal">ST_Length()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリが <code class="literal">LineString</code> または <code class="literal">MultiLineString</code> でない場合、戻り値は <code class="literal">NULL</code> です。
              </p></li><li class="listitem"><p>
                ジオメトリがジオメトリ学的に無効な場合は、結果の長さが未定義 (任意の数値) であるか、エラーが発生します。
              </p></li><li class="listitem"><p>
                長さの計算結果が <code class="literal">+inf</code> の場合、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                ジオメトリに経度または緯度が範囲外の地理 SRS がある場合、エラーが発生します:
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                    経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                  </p></li><li class="listitem"><p>
                    緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                  </p></li></ul></div><p>
                表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
              </p></li></ul></div><p>
            MySQL 8.0.16 以降、<code class="literal">ST_Length()</code> では、戻される長さの値の線形単位を指定するオプションの <em class="replaceable"><code>unit</code></em> 引数が許可されます。 次のルールが適用されます: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ユニットが指定されているが、MySQL でサポートされていない場合は、<code class="literal">ER_UNIT_NOT_FOUND</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                サポートされている線形単位が指定され、SRID が 0 の場合、<code class="literal">ER_GEOMETRY_IN_UNKNOWN_LENGTH_UNIT</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                サポートされている線形単位が指定され、SRID が 0 でない場合、結果はその単位になります。
              </p></li><li class="listitem"><p>
                単位が指定されていない場合、結果はデカルトか地理的かにかかわらず、ジオメトリの SRS の単位になります。 現在、すべての MySQL SRS はメーターで表されます。 
              </p></li></ul></div><p>
            ユニットは、<code class="literal">INFORMATION_SCHEMA</code> <code class="literal">ST_UNITS_OF_MEASURE</code> テーブルで見つかった場合にサポートされます。 <a class="xref" href="information-schema.html#information-schema-st-units-of-measure-table" title="26.37 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE テーブル">セクション26.37「INFORMATION_SCHEMA ST_UNITS_OF_MEASURE テーブル」</a>を参照してください。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = ST_GeomFromText('LineString(1 1,2 2,3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Length(@ls);</code></strong>
+--------------------+
| ST_Length(@ls)     |
+--------------------+
| 2.8284271247461903 |
+--------------------+

mysql&gt; <strong class="userinput"><code>SET @mls = ST_GeomFromText('MultiLineString((1 1,2 2,3 3),(4 4,5 5))');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Length(@mls);</code></strong>
+-------------------+
| ST_Length(@mls)   |
+-------------------+
| 4.242640687119286 |
+-------------------+

mysql&gt; <strong class="userinput"><code>SET @ls = ST_GeomFromText('LineString(1 1,2 2,3 3)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Length(@ls);</code></strong>
+-------------------+
| ST_Length(@ls)    |
+-------------------+
| 313701.9623204328 |
+-------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_Length(@ls, 'metre');</code></strong>
+-------------------------+
| ST_Length(@ls, 'metre') |
+-------------------------+
|       313701.9623204328 |
+-------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_Length(@ls, 'foot');</code></strong>
+------------------------+
| ST_Length(@ls, 'foot') |
+------------------------+
|     1029205.9131247795 |
+------------------------+
</pre></li><li class="listitem"><a name="function_st-numpoints"></a><p>
            <code class="literal">ST_NumPoints(<em class="replaceable"><code>ls</code></em>)</code>
          </p><a class="indexterm" name="idm46041617614720"></a><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> 内の <code class="literal">Point</code> オブジェクトの数を返します。
          </p><p>
            <code class="literal">ST_NumPoints()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_NumPoints(ST_GeomFromText(@ls));</code></strong>
+------------------------------------+
| ST_NumPoints(ST_GeomFromText(@ls)) |
+------------------------------------+
|                                  3 |
+------------------------------------+
</pre></li><li class="listitem"><a name="function_st-pointn"></a><p>
            <code class="literal">ST_PointN(<em class="replaceable"><code>ls</code></em>, <em class="replaceable"><code>N</code></em>)</code>
          </p><a class="indexterm" name="idm46041617600864"></a><p>
            <code class="literal">Linestring</code> 値 <em class="replaceable"><code>ls</code></em> 内の <em class="replaceable"><code>N</code></em> 番目の <code class="literal">Point</code> を返します。 点の番号は 1 から始まります。 
          </p><p>
            <code class="literal">ST_PointN()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_PointN(ST_GeomFromText(@ls),2));</code></strong>
+----------------------------------------------+
| ST_AsText(ST_PointN(ST_GeomFromText(@ls),2)) |
+----------------------------------------------+
| POINT(2 2)                                   |
+----------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-startpoint"></a><p>
            <code class="literal">ST_StartPoint(<em class="replaceable"><code>ls</code></em>)</code>
          </p><a class="indexterm" name="idm46041617586896"></a><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> の始点である <code class="literal">Point</code> を返します。
          </p><p>
            <code class="literal">ST_StartPoint()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_StartPoint(ST_GeomFromText(@ls)));</code></strong>
+------------------------------------------------+
| ST_AsText(ST_StartPoint(ST_GeomFromText(@ls))) |
+------------------------------------------------+
| POINT(1 1)                                     |
+------------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-polygon-property-functions"></a>12.17.7.4 Polygon および MultiPolygon プロパティ関数</h4></div></div></div><p>
        このセクションの関数は、<code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> の値のプロパティを返します。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数が <code class="literal">NULL</code> の場合、またはジオメトリ引数が空のジオメトリの場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            複数のジオメトリ引数を取る関数では、それらの引数が同じ SRS 内にない場合、<code class="literal">ER_GIS_DIFFERENT_SRIDS</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        ポリゴンのプロパティを取得するには、次の関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-area"></a><p>
            <code class="literal">ST_Area({<em class="replaceable"><code>poly</code></em>|<em class="replaceable"><code>mpoly</code></em>})</code>
          </p><a class="indexterm" name="idm46041617556224"></a><p>
            空間参照システムで測定された、<code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> 引数の領域を示す倍精度数値を返します。
          </p><p>
            MySQL 8.0.13 では、<code class="literal">ST_Area()</code> はこのセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリがジオメトリ学的に無効な場合は、結果が未定義の領域 (任意の数値) であるか、エラーが発生します。
              </p></li><li class="listitem"><p>
                ジオメトリは有効だが、<code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> オブジェクトではない場合、<code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                ジオメトリがデカルト SRS 内の有効な <code class="literal">Polygon</code> である場合、結果はポリゴンのデカルト領域になります。
              </p></li><li class="listitem"><p>
                ジオメトリがデカルト SRS 内の有効な <code class="literal">MultiPolygon</code> である場合、結果はポリゴンのデカルト領域の合計になります。
              </p></li><li class="listitem"><p>
                ジオメトリが地理 SRS 内の有効な <code class="literal">Polygon</code> である場合、結果はその SRS 内のポリゴンの測地領域 (平方メートル) になります。
              </p></li><li class="listitem"><p>
                ジオメトリが地理 SRS 内の有効な <code class="literal">MultiPolygon</code> である場合、結果はその SRS 内のポリゴンの測地領域の合計 (平方メートル) になります。
              </p></li><li class="listitem"><p>
                面積計算の結果が <code class="literal">+inf</code> になった場合は、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
              </p></li><li class="listitem"><p>
                ジオメトリに経度または緯度が範囲外の地理 SRS がある場合、エラーが発生します:
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                    経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                  </p></li><li class="listitem"><p>
                    緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                  </p></li></ul></div><p>
                表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
              </p></li></ul></div><p>
            MySQL 8.0.13 より前では、<code class="literal">ST_Area()</code> はこのセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                次元 0 または 1 の引数の場合、結果は 0 です。
              </p></li><li class="listitem"><p>
                ジオメトリが空の場合、戻り値は <code class="literal">NULL</code> ではなく 0 です。
              </p></li><li class="listitem"><p>
                ジオメトリコレクションの場合、結果はすべてのコンポーネントの面積値の合計になります。 ジオメトリコレクションが空の場合、その領域は 0(ゼロ) として返されます。 
              </p></li><li class="listitem"><p>
                ジオメトリに地理空間参照システム (SRS) の SRID 値がある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 0,0 0),(1 1,1 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Area(ST_GeomFromText(@poly));</code></strong>
+---------------------------------+
| ST_Area(ST_GeomFromText(@poly)) |
+---------------------------------+
|                               4 |
+---------------------------------+

mysql&gt; <strong class="userinput"><code>SET @mpoly =</code></strong>
       <strong class="userinput"><code>'MultiPolygon(((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1)))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Area(ST_GeomFromText(@mpoly));</code></strong>
+----------------------------------+
| ST_Area(ST_GeomFromText(@mpoly)) |
+----------------------------------+
|                                8 |
+----------------------------------+
</pre></li><li class="listitem"><a name="function_st-centroid"></a><p>
            <code class="literal">ST_Centroid({<em class="replaceable"><code>poly</code></em>|<em class="replaceable"><code>mpoly</code></em>})</code>
          </p><a class="indexterm" name="idm46041617507072"></a><p>
            <code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> 引数の数学的重心を <code class="literal">Point</code> として返します。 結果が <code class="literal">MultiPolygon</code> 上にある保証はありません。 
          </p><p>
            この関数は、コレクション内の最上位ディメンションのコンポーネントの中心点を計算してジオメトリコレクションを処理します。 このようなコンポーネントは、集中計算のために単一の <code class="literal">MultiPolygon</code>、<code class="literal">MultiLineString</code> または <code class="literal">MultiPoint</code> に抽出および作成されます。 
          </p><p>
            <code class="literal">ST_Centroid()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                引数が空のジオメトリコレクションであるという追加条件では、戻り値は <code class="literal">NULL</code> です。
              </p></li><li class="listitem"><p>
                ジオメトリに地理空間参照システム (SRS) の SRID 値がある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
              </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>ST_GeomFromText('POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7,5 5))');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_GeometryType(@poly),ST_AsText(ST_Centroid(@poly));</code></strong>
+------------------------+--------------------------------------------+
| ST_GeometryType(@poly) | ST_AsText(ST_Centroid(@poly))              |
+------------------------+--------------------------------------------+
| POLYGON                | POINT(4.958333333333333 4.958333333333333) |
+------------------------+--------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-exteriorring"></a><p>
            <code class="literal">ST_ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code>
          </p><a class="indexterm" name="idm46041617483424"></a><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> の外側のリングを <code class="literal">LineString</code> として返します。
          </p><p>
            <code class="literal">ST_ExteriorRing()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_ExteriorRing(ST_GeomFromText(@poly)));</code></strong>
+----------------------------------------------------+
| ST_AsText(ST_ExteriorRing(ST_GeomFromText(@poly))) |
+----------------------------------------------------+
| LINESTRING(0 0,0 3,3 3,3 0,0 0)                    |
+----------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-interiorringn"></a><p>
            <code class="literal">ST_InteriorRingN(<em class="replaceable"><code>poly</code></em>, <em class="replaceable"><code>N</code></em>)</code>
          </p><a class="indexterm" name="idm46041617468672"></a><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> の <em class="replaceable"><code>N</code></em> 番目の内側のリングを <code class="literal">LineString</code> として返します。 リングの番号は 1 から始まります。 
          </p><p>
            <code class="literal">ST_InteriorRingN()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_InteriorRingN(ST_GeomFromText(@poly),1));</code></strong>
+-------------------------------------------------------+
| ST_AsText(ST_InteriorRingN(ST_GeomFromText(@poly),1)) |
+-------------------------------------------------------+
| LINESTRING(1 1,1 2,2 2,2 1,1 1)                       |
+-------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-numinteriorrings"></a><p>
            <code class="literal">ST_NumInteriorRing(<em class="replaceable"><code>poly</code></em>)</code>, <code class="literal">ST_NumInteriorRings(<em class="replaceable"><code>poly</code></em>)</code>
          </p><a class="indexterm" name="idm46041617452080"></a><a class="indexterm" name="idm46041617450736"></a><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> 内の内側のリングの数を返します。
          </p><p>
            <code class="literal">ST_NumInteriorRing()</code> および <code class="literal">ST_NuminteriorRings()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_NumInteriorRings(ST_GeomFromText(@poly));</code></strong>
+---------------------------------------------+
| ST_NumInteriorRings(ST_GeomFromText(@poly)) |
+---------------------------------------------+
|                                           1 |
+---------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-geometrycollection-property-functions"></a>12.17.7.5 GeometryCollection プロパティー関数</h4></div></div></div><p>
        これらの関数は、<code class="literal">GeometryCollection</code> 値のプロパティーを返します。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数が <code class="literal">NULL</code> の場合、またはジオメトリ引数が空のジオメトリの場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        ジオメトリコレクションプロパティを取得するには、次の関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geometryn"></a><p>
            <code class="literal">ST_GeometryN(<em class="replaceable"><code>gc</code></em>, <em class="replaceable"><code>N</code></em>)</code>
          </p><a class="indexterm" name="idm46041617421728"></a><p>
            <code class="literal">GeometryCollection</code> 値 <em class="replaceable"><code>gc</code></em> 内の <em class="replaceable"><code>N</code></em> 番目のジオメトリを返します。 ジオメトリの番号は 1 から始まります。 
          </p><p>
            <code class="literal">ST_GeometryN()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc),1));</code></strong>
+-------------------------------------------------+
| ST_AsText(ST_GeometryN(ST_GeomFromText(@gc),1)) |
+-------------------------------------------------+
| POINT(1 1)                                      |
+-------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-numgeometries"></a><p>
            <code class="literal">ST_NumGeometries(<em class="replaceable"><code>gc</code></em>)</code>
          </p><a class="indexterm" name="idm46041617408272"></a><p>
            <code class="literal">GeometryCollection</code> 値 <em class="replaceable"><code>gc</code></em> 内のジオメトリの数を返します。
          </p><p>
            <code class="literal">ST_NumGeometries()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_NumGeometries(ST_GeomFromText(@gc));</code></strong>
+----------------------------------------+
| ST_NumGeometries(ST_GeomFromText(@gc)) |
+----------------------------------------+
|                                      2 |
+----------------------------------------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-operator-functions"></a>12.17.8 空間演算子関数</h3></div></div></div><p>
      OpenGIS では、ジオメトリを生成できる関数がいくつか提案されています。 これらは、空間演算子を実装するように設計されています。 これらの関数は、<a class="ulink" href="http://www.opengeospatial.org" target="_top">Open Geospatial Consortium</a> 仕様に従って適用できないものを除き、すべての引数タイプの組合せをサポートします。 
    </p><p>
      MySQL は、関数の説明に記載されているように、OpenGIS の拡張機能である特定の関数も実装します。
    </p><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          複数のジオメトリ引数を取る関数では、それらの引数が同じ SRS 内にない場合、<code class="literal">ER_GIS_DIFFERENT_SRIDS</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          ジオメトリ引数に地理 SRS の SRID 値があり、関数が地理ジオメトリを処理しない場合は、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
            </p></li><li class="listitem"><p>
              緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
            </p></li></ul></div><p>
          表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
        </p></li><li class="listitem"><p>
          それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
        </p></li></ul></div><p>
      次の空間演算子関数を使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-buffer"></a><p>
          <code class="literal">ST_Buffer(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>d</code></em> [, <em class="replaceable"><code>strategy1</code></em> [, <em class="replaceable"><code>strategy2</code></em> [, <em class="replaceable"><code>strategy3</code></em>]]])</code>
        </p><a class="indexterm" name="idm46041617367008"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g</code></em> からの距離が <em class="replaceable"><code>d</code></em> の距離以下であるすべての点を表すジオメトリを返します。
        </p><p>
          ジオメトリ引数が空の場合、<code class="literal">ST_Buffer()</code> は空のジオメトリを戻します。
        </p><p>
          距離が 0 の場合、<code class="literal">ST_Buffer()</code> はジオメトリ引数を変更せずに戻します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@pt, 0));</code></strong>
+------------------------------+
| ST_AsText(ST_Buffer(@pt, 0)) |
+------------------------------+
| POINT(0 0)                   |
+------------------------------+
</pre><p>
          <code class="literal">ST_Buffer()</code> では、<code class="literal">Polygon</code> 値と <code class="literal">MultiPolygon</code> 値、および <code class="literal">Polygon</code> 値または <code class="literal">MultiPolygon</code> 値を含むジオメトリコレクションに対して負の距離がサポートされています。 結果は空のジオメトリである可能性があります。 
        </p><p>
          <code class="literal">ST_Buffer()</code> では、distance 引数の後に最大 3 つのオプションの戦略引数を指定できます。 戦略はバッファ計算に影響します。 これらの引数は、<code class="literal">ST_Buffer_Strategy()</code> 関数によって生成されるバイト文字列値で、点、結合および終了方針に使用されます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              点方針は、<code class="literal">Point</code> および <code class="literal">MultiPoint</code> ジオメトリに適用されます。 点ストラテジが指定されていない場合、デフォルトは <code class="literal">ST_Buffer_Strategy('point_circle', 32)</code> です。 
            </p></li><li class="listitem"><p>
              結合方法は、<code class="literal">LineString</code>, <code class="literal">MultiLineString</code>, <code class="literal">Polygon</code> および <code class="literal">MultiPolygon</code> ジオメトリに適用されます。 結合方針が指定されていない場合、デフォルトは <code class="literal">ST_Buffer_Strategy('join_round', 32)</code> です。 
            </p></li><li class="listitem"><p>
              終了方針は、<code class="literal">LineString</code> および <code class="literal">MultiLineString</code> ジオメトリに適用されます。 終了方針が指定されていない場合、デフォルトは <code class="literal">ST_Buffer_Strategy('end_round', 32)</code> です。 
            </p></li></ul></div><p>
          各タイプの最大 1 つの戦略を指定でき、任意の順序で指定できます。
        </p><p>
          <code class="literal">ST_Buffer()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">Point</code>, <code class="literal">MultiPoint</code>, <code class="literal">LineString</code> の負の距離と <code class="literal">MultiLineString</code> 値、および <code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> 値を含まないジオメトリコレクションでは、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              特定のタイプの戦略が複数指定されている場合は、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @pt_strategy = ST_Buffer_Strategy('point_square');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@pt, 2, @pt_strategy));</code></strong>
+--------------------------------------------+
| ST_AsText(ST_Buffer(@pt, 2, @pt_strategy)) |
+--------------------------------------------+
| POLYGON((-2 -2,2 -2,2 2,-2 2,-2 -2))       |
+--------------------------------------------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @end_strategy = ST_Buffer_Strategy('end_flat');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @join_strategy = ST_Buffer_Strategy('join_round', 10);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@ls, 5, @end_strategy, @join_strategy))</code></strong>
+---------------------------------------------------------------+
| ST_AsText(ST_Buffer(@ls, 5, @end_strategy, @join_strategy))   |
+---------------------------------------------------------------+
| POLYGON((5 5,5 10,0 10,-3.5355339059327373 8.535533905932738, |
| -5 5,-5 0,0 0,5 0,5 5))                                       |
+---------------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-buffer-strategy"></a><p>
          <code class="literal">ST_Buffer_Strategy(<em class="replaceable"><code>strategy</code></em> [, <em class="replaceable"><code>points_per_circle</code></em>])</code>
        </p><a class="indexterm" name="idm46041617312384"></a><p>
          この関数は、バッファの計算に影響を与えるために <code class="literal">ST_Buffer()</code> で使用する戦略バイト文字列を戻します。
        </p><p>
          戦略に関する情報は、<a class="ulink" href="http://www.boost.org" target="_top">Boost.org</a> で入手できます。
        </p><p>
          最初の引数は、戦略オプションを示す文字列である必要があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ポイント戦略の場合、許可される値は<code class="literal">'point_circle'</code>および<code class="literal">'point_square'</code>です。
            </p></li><li class="listitem"><p>
              結合方針の場合、許可される値は<code class="literal">'join_round'</code>および<code class="literal">'join_miter'</code>です。
            </p></li><li class="listitem"><p>
              終了戦略の場合、許可される値は<code class="literal">'end_round'</code>および<code class="literal">'end_flat'</code>です。
            </p></li></ul></div><p>
          最初の引数が<code class="literal">'point_circle'</code>, <code class="literal">'join_round'</code>, <code class="literal">'join_miter'</code>または<code class="literal">'end_round'</code>の場合、<em class="replaceable"><code>points_per_circle</code></em> 引数は正の数値で指定する必要があります。 <em class="replaceable"><code>points_per_circle</code></em> の最大値は、<code class="literal">max_points_in_geometry</code> システム変数の値です。 
        </p><p>
          例については、<code class="literal">ST_Buffer()</code> の説明を参照してください。
        </p><p>
          <code class="literal">ST_Buffer_Strategy()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              無効な引数があると、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              最初の引数が<code class="literal">'point_square'</code>または<code class="literal">'end_flat'</code>の場合、<em class="replaceable"><code>points_per_circle</code></em> 引数を指定しないでください。指定すると、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li></ul></div></li><li class="listitem"><a name="function_st-convexhull"></a><p>
          <code class="literal">ST_ConvexHull(<em class="replaceable"><code>g</code></em>)</code>
        </p><a class="indexterm" name="idm46041617280160"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g</code></em> の凸型ハルを表すジオメトリを戻します。
        </p><p>
          この関数は、まず頂点ポイントが同一直線かどうかをチェックして、ジオメトリ凸型を計算します。 その場合は線形ハルを返し、それ以外の場合はポリゴンハルを返します。 この関数は、コレクションのすべてのコンポーネントのすべての頂点ポイントを抽出し、そこから <code class="literal">MultiPoint</code> 値を作成して凸型を計算することで、ジオメトリコレクションを処理します。 
        </p><p>
          <code class="literal">ST_ConvexHull()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              引数が空のジオメトリコレクションであるという追加条件では、戻り値は <code class="literal">NULL</code> です。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = 'MULTIPOINT(5 0,25 0,15 10,15 25)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_ConvexHull(ST_GeomFromText(@g)));</code></strong>
+-----------------------------------------------+
| ST_AsText(ST_ConvexHull(ST_GeomFromText(@g))) |
+-----------------------------------------------+
| POLYGON((5 0,25 0,15 25,5 0))                 |
+-----------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-difference"></a><p>
          <code class="literal">ST_Difference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><a class="indexterm" name="idm46041617262832"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の差集合を表すジオメトリを返します。
        </p><p>
          <code class="literal">ST_Difference()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Difference(@g1, @g2));</code></strong>
+------------------------------------+
| ST_AsText(ST_Difference(@g1, @g2)) |
+------------------------------------+
| POINT(1 1)                         |
+------------------------------------+
</pre></li><li class="listitem"><a name="function_st-intersection"></a><p>
          <code class="literal">ST_Intersection(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><a class="indexterm" name="idm46041617249344"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の共通集合を表すジオメトリを返します。
        </p><p>
          <code class="literal">ST_Intersection()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('LineString(1 1, 3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('LineString(1 3, 3 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Intersection(@g1, @g2));</code></strong>
+--------------------------------------+
| ST_AsText(ST_Intersection(@g1, @g2)) |
+--------------------------------------+
| POINT(2 2)                           |
+--------------------------------------+
</pre></li><li class="listitem"><a name="function_st-lineinterpolatepoint"></a><p>
          <code class="literal">ST_LineInterpolatePoint(<em class="replaceable"><code>ls</code></em>, <em class="replaceable"><code>fractional_distance</code></em>)</code>
        </p><a class="indexterm" name="idm46041617235040"></a><p>
          この関数は、範囲[0.0, 1.0]内の <code class="literal">LineString</code> ジオメトリと小数距離を取得し、<code class="literal">LineString</code> に沿って、始点から終点までの指定された距離分の <code class="literal">Point</code> を戻します。 これを使用すると、ジオメトリ引数で記述された道路の途中に <code class="literal">Point</code> があるかどうかなどの質問に回答できます。 
        </p><p>
          この関数は、すべての空間参照システム (デカルトと地理の両方) の <code class="literal">LineString</code> ジオメトリに対して実装されます。
        </p><p>
          <em class="replaceable"><code>fractional_distance</code></em> 引数が 1.0 の場合、近似値の計算で数値が不正確になるため、結果は <code class="literal">LineString</code> 引数の正確な最後のポイントではなく、その近くのポイントになる可能性があります。
        </p><p>
          関連する関数 <code class="literal">ST_LineInterpolatePoints()</code> は同様の引数を取りますが、開始点からそのエンドポイントまでの距離の各部分の <code class="literal">LineString</code> に沿った <code class="literal">Point</code> 値で構成される <code class="literal">MultiPoint</code> を返します。 両方の関数の例については、<code class="literal">ST_LineInterpolatePoints()</code> の説明を参照してください。 
        </p><p>
          <code class="literal">ST_LineInterpolatePoint()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリ引数が <code class="literal">LineString</code> でない場合は、<code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              分数距離引数が[0.0, 1.0]の範囲外の場合、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><p>
          <code class="literal">ST_LineInterpolatePoint()</code> は、OpenGIS の MySQL 拡張機能です。 この関数は、MySQL 8.0.24 で追加されました。 
        </p></li><li class="listitem"><a name="function_st-lineinterpolatepoints"></a><p>
          <code class="literal">ST_LineInterpolatePoints(<em class="replaceable"><code>ls</code></em>, <em class="replaceable"><code>fractional_distance</code></em>)</code>
        </p><a class="indexterm" name="idm46041617206592"></a><p>
          この関数は、範囲 (0.0、1.0) 内の <code class="literal">LineString</code> ジオメトリおよび小数距離を取得し、<code class="literal">LineString</code> の開始点と、その開始点からエンドポイントまでの距離の各部分の <code class="literal">LineString</code> に沿った <code class="literal">Point</code> 値で構成される <code class="literal">MultiPoint</code> を戻します。 これを使用すると、ジオメトリ引数で記述された道路に沿って 10% ずつどの <code class="literal">Point</code> 値があるかなどの質問に答えることができます。 
        </p><p>
          この関数は、すべての空間参照システム (デカルトと地理の両方) の <code class="literal">LineString</code> ジオメトリに対して実装されます。
        </p><p>
          <em class="replaceable"><code>fractional_distance</code></em> 引数がゼロの余りで 1.0 を除算する場合、結果には <code class="literal">LineString</code> 引数の最後のポイントが含まれず、近似値の計算における数値の不正確のためにその近くのポイントが含まれる可能性があります。
        </p><p>
          関連する関数である <code class="literal">ST_LineInterpolatePoint()</code> は、同様の引数を取りますが、開始点からエンドポイントまでの指定された距離で、<code class="literal">LineString</code> に沿って <code class="literal">Point</code> を返します。
        </p><p>
          <code class="literal">ST_LineInterpolatePoints()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリ引数が <code class="literal">LineString</code> でない場合は、<code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              分数距離引数が[0.0, 1.0]の範囲外の場合、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_LineInterpolatePoint(@ls1, .5));</code></strong>
+----------------------------------------------+
| ST_AsText(ST_LineInterpolatePoint(@ls1, .5)) |
+----------------------------------------------+
| POINT(0 5)                                   |
+----------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_LineInterpolatePoint(@ls1, .75));</code></strong>
+-----------------------------------------------+
| ST_AsText(ST_LineInterpolatePoint(@ls1, .75)) |
+-----------------------------------------------+
| POINT(2.5 5)                                  |
+-----------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_LineInterpolatePoint(@ls1, 1));</code></strong>
+---------------------------------------------+
| ST_AsText(ST_LineInterpolatePoint(@ls1, 1)) |
+---------------------------------------------+
| POINT(5 5)                                  |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_LineInterpolatePoints(@ls1, .25));</code></strong>
+------------------------------------------------+
| ST_AsText(ST_LineInterpolatePoints(@ls1, .25)) |
+------------------------------------------------+
| MULTIPOINT((0 2.5),(0 5),(2.5 5),(5 5))        |
+------------------------------------------------+
</pre><p>
          <code class="literal">ST_LineInterpolatePoints()</code> は、OpenGIS の MySQL 拡張機能です。 この関数は、MySQL 8.0.24 で追加されました。 
        </p></li><li class="listitem"><a name="function_st-pointatdistance"></a><p>
          <code class="literal">ST_PointAtDistance(<em class="replaceable"><code>ls</code></em>, <em class="replaceable"><code>distance</code></em>)</code>
        </p><a class="indexterm" name="idm46041617171648"></a><p>
          この関数は、<code class="literal">LineString</code> ジオメトリと、<code class="literal">LineString</code> の空間参照システム (SRS) の単位で測定された[0.0, <code class="literal">ST_Length(<em class="replaceable"><code>ls</code></em>)</code>]の範囲内の距離を取得し、開始点からその距離にある <code class="literal">LineString</code> に沿って <code class="literal">Point</code> を戻します。 geometry 引数で記述された道路の始点から 400 メートルの <code class="literal">Point</code> 値などの質問に答えるために使用できます。 
        </p><p>
          この関数は、すべての空間参照システム (デカルトと地理の両方) の <code class="literal">LineString</code> ジオメトリに対して実装されます。
        </p><p>
          <code class="literal">ST_PointAtDistance()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリ引数が <code class="literal">LineString</code> でない場合は、<code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              分数距離引数が[0.0, <code class="literal">ST_Length(<em class="replaceable"><code>ls</code></em>)</code>]の範囲外の場合、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><p>
          <code class="literal">ST_PointAtDistance()</code> は、OpenGIS の MySQL 拡張機能です。 この関数は、MySQL 8.0.24 で追加されました。 
        </p></li><li class="listitem"><a name="function_st-symdifference"></a><p>
          <code class="literal">ST_SymDifference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><a class="indexterm" name="idm46041617147632"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の対称差を表すジオメトリを返します。これは、次のように定義されます。
        </p><pre class="programlisting"><em class="replaceable"><code>g1</code></em> symdifference <em class="replaceable"><code>g2</code></em> := (<em class="replaceable"><code>g1</code></em> union <em class="replaceable"><code>g2</code></em>) difference (<em class="replaceable"><code>g1</code></em> intersection <em class="replaceable"><code>g2</code></em>)
</pre><p>
          または、関数呼び出しの表記では次のようになります。
        </p><pre class="programlisting">ST_SymDifference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>) = ST_Difference(ST_Union(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>), ST_Intersection(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>))
</pre><p>
          <code class="literal">ST_SymDifference()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_SymDifference(@g1, @g2));</code></strong>
+---------------------------------------+
| ST_AsText(ST_SymDifference(@g1, @g2)) |
+---------------------------------------+
| MULTIPOINT((1 1),(2 2))               |
+---------------------------------------+
</pre></li><li class="listitem"><a name="function_st-transform"></a><p>
          <code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>target_srid</code></em>)</code>
        </p><a class="indexterm" name="idm46041617126864"></a><p>
          ジオメトリをある空間参照システム (SRS) から別の空間参照システムに変換します。 戻り値は、すべての座標がターゲット SRID (<em class="replaceable"><code>target_srid</code></em>) に変換された入力ジオメトリと同じタイプのジオメトリです。 ジオメトリ引数の SRID がターゲット SRID 値と同じでないかぎり、変換のサポートは地理的 SRS に制限されます。この場合、戻り値は有効な SRS の入力ジオメトリです。 
        </p><p>
          <code class="literal">ST_Transform()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              地理 SRS の SRID 値を持つジオメトリ引数では、エラーは発生しません。
            </p></li><li class="listitem"><p>
              ジオメトリまたはターゲット SRID 引数に、未定義の空間参照システム (SRS) を参照する SRID 値がある場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              ジオメトリが <code class="literal">ST_Transform()</code> で変換できない SRS 内にある場合は、<code class="literal">ER_TRANSFORM_SOURCE_SRS_NOT_SUPPORTED</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              ターゲット SRID が <code class="literal">ST_Transform()</code> が変換できない SRS 内にある場合は、<code class="literal">ER_TRANSFORM_TARGET_SRS_NOT_SUPPORTED</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              ジオメトリが WGS 84 以外の SRS にあり、TOWGS84 句がない場合は、<code class="literal">ER_TRANSFORM_SOURCE_SRS_MISSING_TOWGS84</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              ターゲット SRID が WGS 84 以外の SRS にあり、TOWGS84 句がない場合は、<code class="literal">ER_TRANSFORM_TARGET_SRS_MISSING_TOWGS84</code> エラーが発生します。
            </p></li></ul></div><p>
          <code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>target_srid</code></em>)</code> と <code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>target_srid</code></em>)</code> は、次の点で異なります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">ST_SRID()</code> は、座標を変換せずにジオメトリ SRID 値を変更します。
            </p></li><li class="listitem"><p>
              <code class="literal">ST_Transform()</code> は、SRID 値の変更に加えてジオメトリ座標を変換します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @p = ST_GeomFromText('POINT(52.381389 13.064444)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(@p);</code></strong>
+----------------------------+
| ST_AsText(@p)              |
+----------------------------+
| POINT(52.381389 13.064444) |
+----------------------------+
mysql&gt; <strong class="userinput"><code>SET @p = ST_Transform(@p, 4230);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(@p);</code></strong>
+---------------------------------------------+
| ST_AsText(@p)                               |
+---------------------------------------------+
| POINT(52.38208611407426 13.065520672345304) |
+---------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-union"></a><p>
          <code class="literal">ST_Union(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><a class="indexterm" name="idm46041617089104"></a><p>
          ジオメトリ値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の和集合を表すジオメトリを返します。
        </p><p>
          <code class="literal">ST_Union()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('LineString(1 1, 3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('LineString(1 3, 3 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Union(@g1, @g2));</code></strong>
+--------------------------------------+
| ST_AsText(ST_Union(@g1, @g2))        |
+--------------------------------------+
| MULTILINESTRING((1 1,3 3),(1 3,3 1)) |
+--------------------------------------+
</pre></li></ul></div><p>
      さらに、<a class="xref" href="functions.html#gis-property-functions" title="12.17.7 ジオメトリプロパティー関数">セクション12.17.7「ジオメトリプロパティー関数」</a>では、既存のジオメトリから新しいジオメトリを構築するいくつかの関数について説明しています。 これらの関数の説明については、そのセクションを参照してください。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">ST_Envelope(<em class="replaceable"><code>g</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_StartPoint(<em class="replaceable"><code>ls</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_EndPoint(<em class="replaceable"><code>ls</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_PointN(<em class="replaceable"><code>ls</code></em>, <em class="replaceable"><code>N</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_InteriorRingN(<em class="replaceable"><code>poly</code></em>, <em class="replaceable"><code>N</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ST_GeometryN(<em class="replaceable"><code>gc</code></em>, <em class="replaceable"><code>N</code></em>)</code>
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-relation-functions"></a>12.17.9 ジオメトリオブジェクト間の空間関係をテストする関数</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#spatial-relation-functions-object-shapes">12.17.9.1 オブジェクト形状を使用する空間関係関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions-mbr">12.17.9.2 最小境界矩形を使用する空間リレーション関数</a></span></dt></dl></div><p>
      このセクションで説明されている関数は、引数として 2 つのジオメトリを受け取り、それらの間の定性的または定量的な関係を返します。
    </p><p>
      MySQL は、OpenGIS 仕様で定義されている関数名を使用して、2 つの関数セットを実装します。 一方のセットは正確なオブジェクトシェイプを使用して 2 つのジオメトリ値間の関係をテストし、もう一方のセットはオブジェクトの最小境界矩形 (MBR) を使用します。 
    </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spatial-relation-functions-object-shapes"></a>12.17.9.1 オブジェクト形状を使用する空間関係関数</h4></div></div></div><p>
        OpenGIS 仕様では、正確なオブジェクト形状を使用して、<em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の 2 つのジオメトリ値間の関係をテストする次の関数が定義されています。 戻り値 1 および 0 はそれぞれ true および false を示しますが、距離関数は距離値を返します。 
      </p><p>
        このセクションの関数は、デカルトまたは地理空間参照システム (SRS) の引数を検出し、SRS に適した結果を戻します。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数が <code class="literal">NULL</code> の場合、またはジオメトリ引数が空のジオメトリの場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            複数のジオメトリ引数を取る関数では、それらの引数が同じ SRS 内にない場合、<code class="literal">ER_GIS_DIFFERENT_SRIDS</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            ジオメトリ学的に無効なジオメトリ引数がある場合は、結果が true または false (どちらでも定義されていない) か、エラーが発生します。
          </p></li><li class="listitem"><p>
            地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
              </p></li><li class="listitem"><p>
                緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
              </p></li></ul></div><p>
            表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        このセクションの一部の関数では、戻り値の長さの単位を指定する unit 引数が許可されます。 特に指定がないかぎり、関数は単位引数を次のように処理します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ユニットは、<code class="literal">INFORMATION_SCHEMA</code> <code class="literal">ST_UNITS_OF_MEASURE</code> テーブルで見つかった場合にサポートされます。 <a class="xref" href="information-schema.html#information-schema-st-units-of-measure-table" title="26.37 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE テーブル">セクション26.37「INFORMATION_SCHEMA ST_UNITS_OF_MEASURE テーブル」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            ユニットが指定されているが、MySQL でサポートされていない場合は、<code class="literal">ER_UNIT_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            サポートされている線形単位が指定され、SRID が 0 の場合、<code class="literal">ER_GEOMETRY_IN_UNKNOWN_LENGTH_UNIT</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            サポートされている線形単位が指定され、SRID が 0 でない場合、結果はその単位になります。
          </p></li><li class="listitem"><p>
            単位が指定されていない場合、結果はデカルトか地理的かにかかわらず、ジオメトリの SRS の単位になります。 現在、すべての MySQL SRS はメーターで表されます。 
          </p></li></ul></div><p>
        ジオメトリ関係のテストには、次のオブジェクト形状関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-contains"></a><p>
            <code class="literal">ST_Contains(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041617015872"></a><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> を完全に含んでいるかどうかを示す 1 または 0 を返します。 これは、<code class="literal">ST_Within()</code> とは逆の関係をテストします。 
          </p><p>
            <code class="literal">ST_Contains()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_st-crosses"></a><p>
            <code class="literal">ST_Crosses(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041617004992"></a><p>
            空間リレーションに次のプロパティがある場合、2 つのジオメトリが<span class="emphasis"><em>空間的に交差</em></span>になります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の両方がディメンション 1 でない場合: <em class="replaceable"><code>g2</code></em> の内部に <em class="replaceable"><code>g1</code></em> の内部と共通の点があるが、<em class="replaceable"><code>g2</code></em> が <em class="replaceable"><code>g1</code></em> の内部全体をカバーしていない場合、<em class="replaceable"><code>g1</code></em> は <em class="replaceable"><code>g2</code></em> を横断します。
              </p></li><li class="listitem"><p>
                <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の両方がディメンション 1 の場合: 有限の数の点で線が相互に交差する場合 (つまり、共通の線セグメントがない場合、共通の単一の点のみ)。
              </p></li></ul></div><p>
            この関数は、<em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> を空間的に横断するかどうかを示す 1 または 0 を戻します。
          </p><p>
            <code class="literal">ST_Crosses()</code> は、次の追加条件で戻り値が <code class="literal">NULL</code> であることを除き、このセクションの概要で説明されているように引数を処理します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <em class="replaceable"><code>g1</code></em> のディメンションは 2 (<code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code>) です。
              </p></li><li class="listitem"><p>
                <em class="replaceable"><code>g2</code></em> のディメンションは 1 (<code class="literal">Point</code> または <code class="literal">MultiPoint</code>) です。
              </p></li></ul></div></li><li class="listitem"><a name="function_st-disjoint"></a><p>
            <code class="literal">ST_Disjoint(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616980624"></a><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に切り離されている (交差していない) かどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">ST_Disjoint()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_st-distance"></a><p>
            <code class="literal">ST_Distance(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em> [, <em class="replaceable"><code>unit</code></em>])</code>
          </p><a class="indexterm" name="idm46041616970320"></a><p>
            <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の間の距離を戻します。ジオメトリ引数の空間参照システム (SRS) の長さ単位で測定されるか、オプションの <em class="replaceable"><code>unit</code></em> 引数 (指定されている場合) の単位で測定されます。
          </p><p>
            この関数は、2 つのジオメトリ引数のコンポーネントのすべての組合せ間の最短距離を戻すことで、ジオメトリコレクションを処理します。
          </p><p>
            <code class="literal">ST_Distance()</code> は、このセクションの概要で説明されているようにジオメトリ引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">ST_Distance()</code> は、地理的 (楕円体) 空間参照システム内の引数を検出し、楕円体上の測地距離を戻します。 MySQL 8.0.18 では、<code class="literal">ST_Distance()</code> はすべてのジオメトリタイプの地理 SRS 引数の距離計算をサポートしています。 MySQL 8.0.18 より前では、許可されている地理的引数の型は、<code class="literal">Point</code> と <code class="literal">Point</code>、または <code class="literal">Point</code> と <code class="literal">MultiPoint</code> (任意の引数の順序) のみです。 地理 SRS で他のジオメトリタイプの引数の組合せを使用してコールすると、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。 
              </p></li><li class="listitem"><p>
                いずれかの引数がジオメトリ学的に無効な場合は、結果が未定義の距離 (任意の数値) であるか、エラーが発生します。
              </p></li><li class="listitem"><p>
                中間結果または最終結果で <code class="literal">NaN</code> または負の数値が生成されると、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
              </p></li></ul></div><p>
            MySQL 8.0.14 以降、<code class="literal">ST_Distance()</code> では、戻される距離値の線形単位を指定するオプションの <em class="replaceable"><code>unit</code></em> 引数が許可されます。 <code class="literal">ST_Distance()</code> は、このセクションの概要で説明されているように、その <em class="replaceable"><code>unit</code></em> 引数を処理します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('POINT(1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('POINT(2 2)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance(@g1, @g2);</code></strong>
+-----------------------+
| ST_Distance(@g1, @g2) |
+-----------------------+
|    1.4142135623730951 |
+-----------------------+

mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('POINT(1 1)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('POINT(2 2)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance(@g1, @g2);</code></strong>
+-----------------------+
| ST_Distance(@g1, @g2) |
+-----------------------+
|     156874.3859490455 |
+-----------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance(@g1, @g2, 'metre');</code></strong>
+--------------------------------+
| ST_Distance(@g1, @g2, 'metre') |
+--------------------------------+
|              156874.3859490455 |
+--------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance(@g1, @g2, 'foot');</code></strong>
+-------------------------------+
| ST_Distance(@g1, @g2, 'foot') |
+-------------------------------+
|             514679.7439273146 |
+-------------------------------+
</pre><p>
            球の距離計算の特殊なケースについては、<code class="literal">ST_Distance_Sphere()</code> 関数を参照してください。
          </p></li><li class="listitem"><a name="function_st-equals"></a><p>
            <code class="literal">ST_Equals(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616932672"></a><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に等しいかどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">ST_Equals()</code> は、空のジオメトリ引数に対して <code class="literal">NULL</code> を返さない点を除き、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Equals(@g1, @g1), ST_Equals(@g1, @g2);</code></strong>
+---------------------+---------------------+
| ST_Equals(@g1, @g1) | ST_Equals(@g1, @g2) |
+---------------------+---------------------+
|                   1 |                   0 |
+---------------------+---------------------+
</pre></li><li class="listitem"><a name="function_st-frechetdistance"></a><p>
            <code class="literal">ST_FrechetDistance(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em> [, <em class="replaceable"><code>unit</code></em>])</code>
          </p><a class="indexterm" name="idm46041616917840"></a><p>
            ジオメトリがどの程度類似しているかを反映して、2 つのジオメトリ間の離散フレシェ距離を返します。 結果は、ジオメトリ引数の空間参照システム (SRS) の長さ単位、または引数が指定されている場合は <em class="replaceable"><code>unit</code></em> 引数の長さ単位で測定された倍精度の数値です。 
          </p><p>
            この関数は、離散フレシェ距離を実装します。つまり、ジオメトリの点間の距離に制限されます。 たとえば、2 つの <code class="literal">LineString</code> 引数がある場合、ジオメトリに明示的に記述された点のみが考慮されます。 これらの点の間の線分セグメント上の点は考慮されません。 
          </p><p>
            <code class="literal">ST_FrechetDistance()</code> は、このセクションの概要で説明されているようにジオメトリ引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリはデカルトまたは地理 SRS を持つことができますが、<code class="literal">LineString</code> 値のみがサポートされています。 引数が同一のデカルト SRS または地理 SRS 内にあり、どちらかが <code class="literal">LineString</code> でない場合は、SRS タイプに応じて <code class="literal">ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS</code> または <code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。 
              </p></li></ul></div><p>
            <code class="literal">ST_FrechetDistance()</code> は、このセクションの概要で説明されているように、オプションの <em class="replaceable"><code>unit</code></em> 引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 1,0 6,3 3,5 6)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_FrechetDistance(@ls1, @ls2);</code></strong>
+--------------------------------+
| ST_FrechetDistance(@ls1, @ls2) |
+--------------------------------+
|             2.8284271247461903 |
+--------------------------------+

mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 1,0 6,3 3,5 6)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_FrechetDistance(@ls1, @ls2);</code></strong>
+--------------------------------+
| ST_FrechetDistance(@ls1, @ls2) |
+--------------------------------+
|              313421.1999416798 |
+--------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_FrechetDistance(@ls1, @ls2, 'foot');</code></strong>
+----------------------------------------+
| ST_FrechetDistance(@ls1, @ls2, 'foot') |
+----------------------------------------+
|                     1028284.7767115477 |
+----------------------------------------+
</pre><p>
            この関数は、MySQL 8.0.23 で追加されました。
          </p></li><li class="listitem"><a name="function_st-hausdorffdistance"></a><p>
            <code class="literal">ST_HausdorffDistance(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em> [, <em class="replaceable"><code>unit</code></em>])</code>
          </p><a class="indexterm" name="idm46041616889424"></a><p>
            ジオメトリがどの程度類似しているかを反映して、2 つのジオメトリ間の離散ハスドルフ距離を返します。 結果は、ジオメトリ引数の空間参照システム (SRS) の長さ単位、または引数が指定されている場合は <em class="replaceable"><code>unit</code></em> 引数の長さ単位で測定された倍精度の数値です。 
          </p><p>
            この関数は、離散ハスドルフ距離を実装します。つまり、ジオメトリの点間の距離に制限されます。 たとえば、2 つの <code class="literal">LineString</code> 引数がある場合、ジオメトリに明示的に記述された点のみが考慮されます。 これらの点の間の線分セグメント上の点は考慮されません。 
          </p><p>
            <code class="literal">ST_HausdorffDistance()</code> は、このセクションの概要で説明されているようにジオメトリ引数を処理しますが、次の例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ジオメトリ引数が同じデカルト SRS または地理 SRS 内にあるが、サポートされている組合せにない場合は、SRS タイプに応じて <code class="literal">ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS</code> または <code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。 次の組合せがサポートされています: 
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                    <code class="literal">LineString</code> および <code class="literal">LineString</code>
                  </p></li><li class="listitem"><p>
                    <code class="literal">Point</code> および <code class="literal">MultiPoint</code>
                  </p></li><li class="listitem"><p>
                    <code class="literal">LineString</code> および <code class="literal">MultiLineString</code>
                  </p></li><li class="listitem"><p>
                    <code class="literal">MultiPoint</code> および <code class="literal">MultiPoint</code>
                  </p></li><li class="listitem"><p>
                    <code class="literal">MultiLineString</code> および <code class="literal">MultiLineString</code>
                  </p></li></ul></div></li></ul></div><p>
            <code class="literal">ST_HausdorffDistance()</code> は、このセクションの概要で説明されているように、オプションの <em class="replaceable"><code>unit</code></em> 引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 1,0 6,3 3,5 6)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_HausdorffDistance(@ls1, @ls2);</code></strong>
+----------------------------------+
| ST_HausdorffDistance(@ls1, @ls2) |
+----------------------------------+
|                                1 |
+----------------------------------+

mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 1,0 6,3 3,5 6)', 4326);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_HausdorffDistance(@ls1, @ls2);</code></strong>
+----------------------------------+
| ST_HausdorffDistance(@ls1, @ls2) |
+----------------------------------+
|               111319.49079326246 |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_HausdorffDistance(@ls1, @ls2, 'foot');</code></strong>
+------------------------------------------+
| ST_HausdorffDistance(@ls1, @ls2, 'foot') |
+------------------------------------------+
|                        365221.4264870815 |
+------------------------------------------+
</pre><p>
            この関数は、MySQL 8.0.23 で追加されました。
          </p></li><li class="listitem"><a name="function_st-intersects"></a><p>
            <code class="literal">ST_Intersects(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616851712"></a><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に交差しているかどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">ST_Intersects()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_st-overlaps"></a><p>
            <code class="literal">ST_Overlaps(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616841920"></a><p>
            2 つのジオメトリが交差し、その交差によって同じディメンションのジオメトリが生成され、指定されたジオメトリのいずれとも等しくない場合、これらのジオメトリは<span class="emphasis"><em>空間的にオーバーラップ</em></span>になります。
          </p><p>
            この関数は、<em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的にオーバーラップするかどうかを示す 1 または 0 を戻します。
          </p><p>
            <code class="literal">ST_Overlaps()</code> は、このセクションの概要で説明されているように引数を処理します。ただし、戻り値は、2 つのジオメトリのディメンションが等しくないという追加条件では <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><a name="function_st-touches"></a><p>
            <code class="literal">ST_Touches(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616829696"></a><p>
            内部が交差しないが、いずれかのジオメトリの境界が他のジオメトリの境界または内部と交差する場合、2 つのジオメトリは<span class="emphasis"><em>空間的なタッチ</em></span>です。
          </p><p>
            この関数は、<em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> に空間的に接触するかどうかを示す 1 または 0 を戻します。
          </p><p>
            <code class="literal">ST_Touches()</code> では、両方のジオメトリのディメンションが 0 (<code class="literal">Point</code> または <code class="literal">MultiPoint</code>) である追加条件の戻り値が <code class="literal">NULL</code> であることを除き、このセクションの概要で説明するように引数が処理されます。
          </p></li><li class="listitem"><a name="function_st-within"></a><p>
            <code class="literal">ST_Within(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616816256"></a><p>
            <em class="replaceable"><code>g1</code></em> が空間的に <em class="replaceable"><code>g2</code></em> の内部にあるかどうかを示す 1 または 0 を返します。 これは、<code class="literal">ST_Contains()</code> とは逆の関係をテストします。 
          </p><p>
            <code class="literal">ST_Within()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spatial-relation-functions-mbr"></a>12.17.9.2 最小境界矩形を使用する空間リレーション関数</h4></div></div></div><a class="indexterm" name="idm46041616808720"></a><a class="indexterm" name="idm46041616807440"></a><p>
        MySQL には、<em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の 2 つのジオメトリの最小境界矩形 (MBR) 間の関係をテストする複数の MySQL 固有関数が用意されています。 戻り値 1 と 0 は、それぞれ true と false を示します。 
      </p><p>
        ポイントのバウンディングボックスは、境界と内部の両方のポイントとして解釈されます。
      </p><p>
        直線の水平線または垂直線の枠ボックスは、線の内側も境界である線として解釈されます。 端点は境界点です。 
      </p><p>
        いずれかのパラメータがジオメトリコレクションの場合、それらのパラメータの内部、境界および外部は、コレクション内のすべての要素の和集合のパラメータです。
      </p><p>
        このセクションの関数は、デカルトまたは地理空間参照システム (SRS) の引数を検出し、SRS に適した結果を戻します。
      </p><p>
        特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数が <code class="literal">NULL</code> または空のジオメトリの場合、戻り値は <code class="literal">NULL</code> です。
          </p></li><li class="listitem"><p>
            ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            複数のジオメトリ引数を取る関数では、それらの引数が同じ SRS 内にない場合、<code class="literal">ER_GIS_DIFFERENT_SRIDS</code> エラーが発生します。
          </p></li><li class="listitem"><p>
            いずれかの引数がジオメトリ学的に無効な場合、結果は true または false (どちらでも定義されていない) になるか、エラーが発生します。
          </p></li><li class="listitem"><p>
            地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
              </p></li><li class="listitem"><p>
                緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
              </p></li></ul></div><p>
            表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
          </p></li><li class="listitem"><p>
            それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
          </p></li></ul></div><p>
        ジオメトリ関係のテストには、次の MBR 関数を使用できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_mbrcontains"></a><p>
            <code class="literal">MBRContains(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616773776"></a><p>
            <em class="replaceable"><code>g1</code></em> の最小境界矩形が <em class="replaceable"><code>g2</code></em> の最小境界矩形を含んでいるかどうかを示す 1 または 0 を返します。 これは、<code class="literal">MBRWithin()</code> とは逆の関係をテストします。 
          </p><p>
            <code class="literal">MBRContains()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('Point(1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT MBRContains(@g1,@g2), MBRWithin(@g2,@g1);</code></strong>
+----------------------+--------------------+
| MBRContains(@g1,@g2) | MBRWithin(@g2,@g1) |
+----------------------+--------------------+
|                    1 |                  1 |
+----------------------+--------------------+
</pre></li><li class="listitem"><a name="function_mbrcoveredby"></a><p>
            <code class="literal">MBRCoveredBy(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616758912"></a><p>
            <em class="replaceable"><code>g1</code></em> の最小境界矩形が <em class="replaceable"><code>g2</code></em> の最小境界矩形で覆われているかどうかを示す 1 または 0 を返します。 これにより、<code class="literal">MBRCovers()</code> とは反対の関係がテストされます。 
          </p><p>
            <code class="literal">MBRCoveredBy()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('Point(1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT MBRCovers(@g1,@g2), MBRCoveredby(@g1,@g2);</code></strong>
+--------------------+-----------------------+
| MBRCovers(@g1,@g2) | MBRCoveredby(@g1,@g2) |
+--------------------+-----------------------+
|                  1 |                     0 |
+--------------------+-----------------------+
mysql&gt; <strong class="userinput"><code>SELECT MBRCovers(@g2,@g1), MBRCoveredby(@g2,@g1);</code></strong>
+--------------------+-----------------------+
| MBRCovers(@g2,@g1) | MBRCoveredby(@g2,@g1) |
+--------------------+-----------------------+
|                  0 |                     1 |
+--------------------+-----------------------+
</pre></li><li class="listitem"><a name="function_mbrcovers"></a><p>
            <code class="literal">MBRCovers(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616742768"></a><p>
            <em class="replaceable"><code>g1</code></em> の最小境界矩形が <em class="replaceable"><code>g2</code></em> の最小境界矩形をカバーしているかどうかを示す 1 または 0 を返します。 これにより、<code class="literal">MBRCoveredBy()</code> とは反対の関係がテストされます。 例については、<code class="literal">MBRCoveredBy()</code> の説明を参照してください。 
          </p><p>
            <code class="literal">MBRCovers()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbrdisjoint"></a><p>
            <code class="literal">MBRDisjoint(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616730752"></a><p>
            2 つのジオメトリ <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小境界矩形が切り離されている (交差していない) かどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">MBRDisjoint()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbrequals"></a><p>
            <code class="literal">MBREquals(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616720784"></a><p>
            2 つのジオメトリ <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小境界矩形が同じであるかどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">MBREquals()</code> は、空のジオメトリ引数に対して <code class="literal">NULL</code> を返さない点を除き、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbrintersects"></a><p>
            <code class="literal">MBRIntersects(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616710032"></a><p>
            2 つのジオメトリ <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小境界矩形が交差しているかどうかを示す 1 または 0 を返します。
          </p><p>
            <code class="literal">MBRIntersects()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbroverlaps"></a><p>
            <code class="literal">MBROverlaps(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616700112"></a><p>
            2 つのジオメトリが交差し、その交差によって同じディメンションのジオメトリが生成され、指定されたジオメトリのいずれとも等しくない場合、これらのジオメトリは<span class="emphasis"><em>空間的にオーバーラップ</em></span>になります。
          </p><p>
            この関数は、2 つのジオメトリ <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小境界矩形が重複しているかどうかを示す 1 または 0 を戻します。
          </p><p>
            <code class="literal">MBROverlaps()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbrtouches"></a><p>
            <code class="literal">MBRTouches(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616688800"></a><p>
            内部が交差しないが、いずれかのジオメトリの境界が他のジオメトリの境界または内部と交差する場合、2 つのジオメトリは<span class="emphasis"><em>空間的なタッチ</em></span>です。
          </p><p>
            この関数は、2 つのジオメトリ <em class="replaceable"><code>g1</code></em> および <em class="replaceable"><code>g2</code></em> の最小境界矩形が接触するかどうかを示す 1 または 0 を戻します。
          </p><p>
            <code class="literal">MBRTouches()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p></li><li class="listitem"><a name="function_mbrwithin"></a><p>
            <code class="literal">MBRWithin(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
          </p><a class="indexterm" name="idm46041616677648"></a><p>
            <em class="replaceable"><code>g1</code></em> の最小境界矩形が <em class="replaceable"><code>g2</code></em> の最小境界矩形の内部にあるかどうかを示す 1 または 0 を返します。 これは、<code class="literal">MBRContains()</code> とは逆の関係をテストします。 
          </p><p>
            <code class="literal">MBRWithin()</code> は、このセクションの概要で説明されているように引数を処理します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = ST_GeomFromText('Polygon((0 0,0 5,5 5,5 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT MBRWithin(@g1,@g2), MBRWithin(@g2,@g1);</code></strong>
+--------------------+--------------------+
| MBRWithin(@g1,@g2) | MBRWithin(@g2,@g1) |
+--------------------+--------------------+
|                  1 |                  0 |
+--------------------+--------------------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-geohash-functions"></a>12.17.10 空間 Geohash 関数</h3></div></div></div><p>
      geohash は、任意の精度の緯度と経度の座標をテキスト文字列にエンコードするためのシステムです。 geohash 値は、<code class="literal">"0123456789bcdefghjkmnpqrstuvwxyz"</code>から選択された文字のみを含む文字列です。 
    </p><p>
      このセクションの関数を使用すると、geohash データのインポートとエクスポート、および geohash 値のインデックス付けと検索の機能をアプリケーションに提供する geohash 値を操作できます。
    </p><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          無効な引数がある場合は、エラーが発生します。
        </p></li><li class="listitem"><p>
          範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
            </p></li><li class="listitem"><p>
              緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
            </p></li></ul></div><p>
          表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
        </p></li><li class="listitem"><p>
          いずれかの点引数に SRID 0 または 4326 がない場合は、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。<em class="replaceable"><code>point</code></em> 引数 SRID の有効性はチェックされません。
        </p></li><li class="listitem"><p>
          SRID 引数が未定義の空間参照システム (SRS) を参照している場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          SRID 引数が 32 ビット符号なし整数の範囲内にない場合は、<code class="literal">ER_DATA_OUT_OF_RANGE</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
        </p></li></ul></div><p>
      次の geohash 関数を使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geohash"></a><p>
          <code class="literal">ST_GeoHash(<em class="replaceable"><code>longitude</code></em>, <em class="replaceable"><code>latitude</code></em>, <em class="replaceable"><code>max_length</code></em>)</code>, <code class="literal">ST_GeoHash(<em class="replaceable"><code>point</code></em>, <em class="replaceable"><code>max_length</code></em>)</code>
        </p><a class="indexterm" name="idm46041616634896"></a><p>
          接続文字セットおよび照合順序で geohash 文字列を戻します。
        </p><p>
          最初の構文では、<em class="replaceable"><code>longitude</code></em> は[-180, 180]の範囲の数値である必要があり、<em class="replaceable"><code>latitude</code></em> は[-90, 90]の範囲の数値である必要があります。 2 番目の構文では、<code class="literal">POINT</code> 値が必要です。X 座標と Y 座標は、それぞれ経度と緯度の有効範囲内にあります。 
        </p><p>
          結果の文字列は <em class="replaceable"><code>max_length</code></em> 文字以下で、上限は 100 です。 geohash 値を作成するアルゴリズムでは、場所または <em class="replaceable"><code>max_length</code></em> 文字の正確な表現のいずれか (いずれか早い方) の文字列が作成されるまで続行されるため、文字列が <em class="replaceable"><code>max_length</code></em> 文字より短い場合があります。 
        </p><p>
          <code class="literal">ST_GeoHash()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_GeoHash(180,0,10), ST_GeoHash(-180,-90,15);</code></strong>
+----------------------+-------------------------+
| ST_GeoHash(180,0,10) | ST_GeoHash(-180,-90,15) |
+----------------------+-------------------------+
| xbpbpbpbpb           | 000000000000000         |
+----------------------+-------------------------+
</pre></li><li class="listitem"><a name="function_st-latfromgeohash"></a><p>
          <code class="literal">ST_LatFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>)</code>
        </p><a class="indexterm" name="idm46041616618784"></a><p>
          geohash 文字列値から緯度を範囲[−90, 90]の倍精度数値として返します。
        </p><p>
          <code class="literal">ST_LatFromGeoHash()</code> デコード関数は、<em class="replaceable"><code>geohash_str</code></em> 引数から 433 文字以内を読み取ります。 座標値の内部表現における情報の上限を表します。 433rd を超える文字は、それ以外の場合でも無視され、エラーが発生します。 
        </p><p>
          <code class="literal">ST_LatFromGeoHash()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_LatFromGeoHash(ST_GeoHash(45,-20,10));</code></strong>
+------------------------------------------+
| ST_LatFromGeoHash(ST_GeoHash(45,-20,10)) |
+------------------------------------------+
|                                      -20 |
+------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-longfromgeohash"></a><p>
          <code class="literal">ST_LongFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>)</code>
        </p><a class="indexterm" name="idm46041616605424"></a><p>
          geohash 文字列値から経度を範囲[−180, 180]の倍精度数値として返します。
        </p><p>
          <em class="replaceable"><code>geohash_str</code></em> 引数から処理される最大文字数に関する <code class="literal">ST_LatFromGeoHash()</code> の説明の注釈は、<code class="literal">ST_LongFromGeoHash()</code> にも適用されます。
        </p><p>
          <code class="literal">ST_LongFromGeoHash()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_LongFromGeoHash(ST_GeoHash(45,-20,10));</code></strong>
+-------------------------------------------+
| ST_LongFromGeoHash(ST_GeoHash(45,-20,10)) |
+-------------------------------------------+
|                                        45 |
+-------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-pointfromgeohash"></a><p>
          <code class="literal">ST_PointFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>, <em class="replaceable"><code>srid</code></em>)</code>
        </p><a class="indexterm" name="idm46041616590880"></a><p>
          geohash 文字列値を指定して、デコードされた geohash 値を含む <code class="literal">POINT</code> 値を戻します。
        </p><p>
          点の X 座標と Y 座標は、それぞれ[−180, 180]の範囲の経度と[−90, 90]の範囲の緯度です。
        </p><p>
          <em class="replaceable"><code>srid</code></em> 引数は 32 ビットの符号なし整数です。
        </p><p>
          <em class="replaceable"><code>geohash_str</code></em> 引数から処理される最大文字数に関する <code class="literal">ST_LatFromGeoHash()</code> の説明の注釈は、<code class="literal">ST_PointFromGeoHash()</code> にも適用されます。
        </p><p>
          <code class="literal">ST_PointFromGeoHash()</code> は、このセクションの概要で説明されているように引数を処理します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @gh = ST_GeoHash(45,-20,10);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_PointFromGeoHash(@gh,0));</code></strong>
+---------------------------------------+
| ST_AsText(ST_PointFromGeoHash(@gh,0)) |
+---------------------------------------+
| POINT(45 -20)                         |
+---------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-geojson-functions"></a>12.17.11 空間 GeoJSON 関数</h3></div></div></div><p>
      このセクションでは、GeoJSON ドキュメントと空間値の間の変換関数について説明します。 GeoJSON は、ジオメトリ/地理的特徴をエンコードするためのオープンスタンダードです。 詳細は、<a class="ulink" href="http://geojson.org" target="_top">http://geojson.org</a>を参照してください。 ここで説明する関数は、GeoJSON 仕様リビジョン 1.0 に従います。 
    </p><p>
      GeoJSON では、MySQL でサポートされているものと同じジオメトリデータ型または地理データ型がサポートされます。 ジオメトリオブジェクトが抽出される点を除き、フィーチャおよび FeatureCollection オブジェクトはサポートされていません。 CRS のサポートは SRID を識別する値に制限されています。 
    </p><p>
      MySQL では、JSON 値に対する操作を可能にするために、ネイティブの <code class="literal">JSON</code> データ型および一連の SQL 関数もサポートされています。 詳細は、<a class="xref" href="data-types.html#json" title="11.5 JSON データ型">セクション11.5「JSON データ型」</a>および<a class="xref" href="functions.html#json-functions" title="12.18 JSON 関数">セクション12.18「JSON 関数」</a>を参照してください。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-asgeojson"></a><p>
          <code class="literal">ST_AsGeoJSON(<em class="replaceable"><code>g</code></em> [, <em class="replaceable"><code>max_dec_digits</code></em> [, <em class="replaceable"><code>options</code></em>]])</code>
        </p><a class="indexterm" name="idm46041616565536"></a><p>
          ジオメトリ <em class="replaceable"><code>g</code></em> から GeoJSON オブジェクトを生成します。 オブジェクト文字列には、接続文字セットと照合順序があります。 
        </p><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 <code class="literal">NULL</code> 以外の引数が無効な場合は、エラーが発生します。 
        </p><p>
          <em class="replaceable"><code>max_dec_digits</code></em> を指定すると、座標の小数点以下の桁数が制限され、出力が丸められます。 指定しない場合、この引数のデフォルトは 2 <sup>32</sup>− 1 の最大値です。 最小値は 0 です。 
        </p><p>
          <em class="replaceable"><code>options</code></em> はビットマスクです (指定されている場合)。 次のテーブルに、許可されるフラグ値を示します。 ジオメトリ引数の SRID が 0 の場合は、要求するフラグ値に対しても CRS オブジェクトは生成されません。 
        </p><div class="informaltable"><table summary="Option flags for the ST_AsGeoJSON() function."><col style="width: 10%"><col style="width: 90%"><thead><tr>
              <th>フラグ値</th>
              <th>意味</th>
            </tr></thead><tbody><tr>
              <td>0</td>
              <td>オプションなし。 これは、<em class="replaceable"><code>options</code></em> が指定されていない場合のデフォルトです。 </td>
            </tr><tr>
              <td>1</td>
              <td>バウンディングボックスを出力に追加します。</td>
            </tr><tr>
              <td>2</td>
              <td>短い形式の CRS URN を出力に追加します。 デフォルトの形式は短い形式 (<code class="literal">EPSG:<em class="replaceable"><code>srid</code></em></code>) です。 </td>
            </tr><tr>
              <td>4</td>
              <td>長い形式の CRS URN (<code class="literal">urn:ogc:def:crs:EPSG::<em class="replaceable"><code>srid</code></em></code>) を追加します。 このフラグはフラグ 2 をオーバーライドします。 たとえば、オプション値 5 と 7 は同じことを意味します (バウンディングボックスと長い形式の CRS URN を追加します)。 </td>
            </tr></tbody></table></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_AsGeoJSON(ST_GeomFromText('POINT(11.11111 12.22222)'),2);</code></strong>
+-------------------------------------------------------------+
| ST_AsGeoJSON(ST_GeomFromText('POINT(11.11111 12.22222)'),2) |
+-------------------------------------------------------------+
| {"type": "Point", "coordinates": [11.11, 12.22]}            |
+-------------------------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-geomfromgeojson"></a><p>
          <code class="literal">ST_GeomFromGeoJSON(<em class="replaceable"><code>str</code></em> [, <em class="replaceable"><code>options</code></em> [, <em class="replaceable"><code>srid</code></em>]])</code>
        </p><a class="indexterm" name="idm46041616531648"></a><p>
          GeoJSON オブジェクトを表す文字列 <em class="replaceable"><code>str</code></em> を解析し、ジオメトリを戻します。
        </p><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 <code class="literal">NULL</code> 以外の引数が無効な場合は、エラーが発生します。 
        </p><p>
          <em class="replaceable"><code>options</code></em> では、座標ディメンションが 2 より大きいジオメトリを含む GeoJSON 文書の処理方法を説明します (指定されている場合)。 次のテーブルに、許可される <em class="replaceable"><code>options</code></em> 値を示します。 
        </p><div class="informaltable"><table summary="Option flags for the ST_GeomFromGeoJSON() function."><col style="width: 10%"><col style="width: 90%"><thead><tr>
              <th>オプション値</th>
              <th>意味</th>
            </tr></thead><tbody><tr>
              <td>1</td>
              <td>ドキュメントを却下し、エラーを生成します。 これは、<em class="replaceable"><code>options</code></em> が指定されていない場合のデフォルトです。 </td>
            </tr><tr>
              <td>2, 3, 4</td>
              <td>ドキュメントを受け入れ、より高い座標寸法の座標を除去します。</td>
            </tr></tbody></table></div><p>
          <em class="replaceable"><code>options</code></em> の値が 2、3 および 4 の場合、現在も同じ結果になります。 座標ディメンションが 2 より大きいジオメトリが将来サポートされる場合は、これらの値によって異なる効果が生じる可能性があります。 
        </p><p>
          <em class="replaceable"><code>srid</code></em> 引数を指定する場合は、32 ビットの符号なし整数である必要があります。 指定しない場合、ジオメトリの戻り値の SRID は 4326 になります。 
        </p><p>
          <em class="replaceable"><code>srid</code></em> が未定義の空間参照システム (SRS) を参照すると、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p><p>
          地理 SRS ジオメトリ引数で、範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              経度の値が (−180, 180]の範囲にない場合は、<code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              緯度の値が[−90, 90]の範囲にない場合は、<code class="literal">ER_LATITUDE_OUT_OF_RANGE</code> エラーが発生します。
            </p></li></ul></div><p>
          表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
        </p><p>
          GeoJSON ジオメトリ、地物および地物コレクションオブジェクトには、<code class="literal">crs</code> プロパティがある場合があります。 解析関数は、<code class="literal">urn:ogc:def:crs:EPSG::<em class="replaceable"><code>srid</code></em></code> および <code class="literal">EPSG:<em class="replaceable"><code>srid</code></em></code> ネームスペース内の名前付き CRS URN を解析しますが、リンクオブジェクトとして指定された CRS は解析しません。 また、<code class="literal">urn:ogc:def:crs:OGC:1.3:CRS84</code> は SRID 4326 として認識されます。 オブジェクトに認識されない CRS がある場合、エラーが発生しますが、オプションの <em class="replaceable"><code>srid</code></em> 引数が指定された場合、CRS は無効であっても無視されます。 
        </p><p>
          トップレベルオブジェクト SRID とは異なる SRID を指定する <code class="literal">crs</code> メンバーが GeoJSON 文書の下位レベルで見つかった場合、<code class="literal">ER_INVALID_GEOJSON_CRS_NOT_TOP_LEVEL</code> エラーが発生します。
        </p><p>
          GeoJSON 仕様で指定されているように、GeoJSON 入力 (<code class="literal">Point</code>、<code class="literal">LineString</code> など) の <code class="literal">type</code> メンバーの解析では大/小文字が区別されます。 この指定は、MySQL では大/小文字が区別されない、他の解析の大/小文字の区別に関するサイレントです。 
        </p><p>
          この例は、単純な GeoJSON オブジェクトの解析結果を示しています。 座標の順序が使用される SRID に依存することを確認します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @json = '{ "type": "Point", "coordinates": [102.0, 0.0]}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromGeoJSON(@json));</code></strong>
+--------------------------------------+
| ST_AsText(ST_GeomFromGeoJSON(@json)) |
+--------------------------------------+
| POINT(0 102)                         |
+--------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_SRID(ST_GeomFromGeoJSON(@json));</code></strong>
+------------------------------------+
| ST_SRID(ST_GeomFromGeoJSON(@json)) |
+------------------------------------+
|                               4326 |
+------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_SRID(ST_GeomFromGeoJSON(@json),0));</code></strong>
+-------------------------------------------------+
| ST_AsText(ST_SRID(ST_GeomFromGeoJSON(@json),0)) |
+-------------------------------------------------+
| POINT(102 0)                                    |
+-------------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-aggregate-functions"></a>12.17.12 空間集計関数</h3></div></div></div><a class="indexterm" name="idm46041616482384"></a><a class="indexterm" name="idm46041616480944"></a><p>
      MySQL は、一連の値に対して計算を実行する集計関数をサポートしています。 これらの関数の一般的な情報は、<a class="xref" href="functions.html#aggregate-functions" title="12.20.1 集計関数の説明">セクション12.20.1「集計関数の説明」</a> を参照してください。 このセクションでは、<code class="literal">ST_Collect()</code> の空間集計関数について説明します。 
    </p><p>
      <code class="literal">ST_Collect()</code> は、オプションの <code class="literal">OVER</code> 句を表す、<code class="literal">[<em class="replaceable"><code>over_clause</code></em>]</code>による構文の説明で示されているように、ウィンドウ関数として使用できます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されています。<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> には、ウィンドウ関数の使用方法に関するその他の情報も含まれています。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-collect"></a><p>
          <code class="literal">ST_Collect([DISTINCT] <em class="replaceable"><code>g</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
        </p><a class="indexterm" name="idm46041616465808"></a><p>
          ジオメトリ値を集計し、単一のジオメトリコレクション値を戻します。 <code class="literal">DISTINCT</code> オプションを指定すると、個別のジオメトリ引数の集計が戻されます。 
        </p><p>
          他の集計関数と同様に、<code class="literal">GROUP BY</code> を使用して引数をサブセットにグループ化できます。 <code class="literal">ST_Collect()</code> は、各サブセットの集計値を返します。 
        </p><p>
          <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。 ウィンドウ集計をサポートするほとんどの集計関数とは対照的に、<code class="literal">ST_Collect()</code> では <em class="replaceable"><code>over_clause</code></em> を <code class="literal">DISTINCT</code> とともに使用できます。 
        </p><p>
          <code class="literal">ST_Collect()</code> は、その引数を次のように処理します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL</code> 引数は無視されます。
            </p></li><li class="listitem"><p>
              すべての引数が <code class="literal">NULL</code> の場合、または集計結果が空の場合、戻り値は <code class="literal">NULL</code> です。
            </p></li><li class="listitem"><p>
              ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              複数のジオメトリ引数があり、それらの引数が同じ SRS 内にある場合、戻り値はその SRS 内にあります。 これらの引数が同じ SRS 内にない場合は、<code class="literal">ER_GIS_DIFFERENT_SRIDS_AGGREGATION</code> エラーが発生します。 
            </p></li><li class="listitem"><p>
              結果は、次のように <code class="literal">NULL</code> 以外のジオメトリ引数から決定された結果タイプを使用して、可能なかぎり狭い <code class="literal">Multi<em class="replaceable"><code>Xxx</code></em></code> または <code class="literal">GeometryCollection</code> 値になります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  すべての引数が <code class="literal">Point</code> 値の場合、結果は <code class="literal">MultiPoint</code> 値になります。
                </p></li><li class="listitem"><p>
                  すべての引数が <code class="literal">LineString</code> 値の場合、結果は <code class="literal">MultiLineString</code> 値になります。
                </p></li><li class="listitem"><p>
                  すべての引数が <code class="literal">Polygon</code> 値の場合、結果は <code class="literal">MultiPolygon</code> 値になります。
                </p></li><li class="listitem"><p>
                  それ以外の場合、引数はジオメトリタイプが混在し、結果は <code class="literal">GeometryCollection</code> 値になります。
                </p></li></ul></div></li></ul></div><p>
          このデータセットの例は、製造年および製造場所別の仮想製品を示しています:
        </p><pre class="programlisting">CREATE TABLE product (
  year INTEGER,
  product VARCHAR(256),
  location Geometry
);

INSERT INTO product
(year,  product,     location) VALUES
(2000, "Calculator", ST_GeomFromText('point(60 -24)',4326)),
(2000, "Computer"  , ST_GeomFromText('point(28 -77)',4326)),
(2000, "Abacus"    , ST_GeomFromText('point(28 -77)',4326)),
(2000, "TV"        , ST_GeomFromText('point(38  60)',4326)),
(2001, "Calculator", ST_GeomFromText('point(60 -24)',4326)),
(2001, "Computer"  , ST_GeomFromText('point(28 -77)',4326));
</pre><p>
          データセットに対して <code class="literal">ST_Collect()</code> を使用するクエリーの例を次に示します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Collect(location)) AS result</code></strong>
       <strong class="userinput"><code>FROM product;</code></strong>
+------------------------------------------------------------------+
| result                                                           |
+------------------------------------------------------------------+
| MULTIPOINT((60 -24),(28 -77),(28 -77),(38 60),(60 -24),(28 -77)) |
+------------------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Collect(DISTINCT location)) AS result</code></strong>
       <strong class="userinput"><code>FROM product;</code></strong>
+---------------------------------------+
| result                                |
+---------------------------------------+
| MULTIPOINT((60 -24),(28 -77),(38 60)) |
+---------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT year, ST_AsText(ST_Collect(location)) AS result</code></strong>
       <strong class="userinput"><code>FROM product GROUP BY year;</code></strong>
+------+------------------------------------------------+
| year | result                                         |
+------+------------------------------------------------+
| 2000 | MULTIPOINT((60 -24),(28 -77),(28 -77),(38 60)) |
| 2001 | MULTIPOINT((60 -24),(28 -77))                  |
+------+------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT year, ST_AsText(ST_Collect(DISTINCT location)) AS result</code></strong>
       <strong class="userinput"><code>FROM product GROUP BY year;</code></strong>
+------+---------------------------------------+
| year | result                                |
+------+---------------------------------------+
| 2000 | MULTIPOINT((60 -24),(28 -77),(38 60)) |
| 2001 | MULTIPOINT((60 -24),(28 -77))         |
+------+---------------------------------------+

# selects nothing
mysql&gt; <strong class="userinput"><code>SELECT ST_Collect(location) AS result</code></strong>
       <strong class="userinput"><code>FROM product WHERE year = 1999;</code></strong>
+--------+
| result |
+--------+
| NULL   |
+--------+

mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Collect(location)</code></strong>
         <strong class="userinput"><code>OVER (ORDER BY year, product ROWS BETWEEN 1 PRECEDING AND CURRENT ROW))</code></strong>
         <strong class="userinput"><code>AS result</code></strong>
       <strong class="userinput"><code>FROM product;</code></strong>
+-------------------------------+
| result                        |
+-------------------------------+
| MULTIPOINT((28 -77))          |
| MULTIPOINT((28 -77),(60 -24)) |
| MULTIPOINT((60 -24),(28 -77)) |
| MULTIPOINT((28 -77),(38 60))  |
| MULTIPOINT((38 60),(60 -24))  |
| MULTIPOINT((60 -24),(28 -77)) |
+-------------------------------+
</pre><p>
          この関数は、MySQL 8.0.24 で追加されました。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-convenience-functions"></a>12.17.13 空間の便利な関数</h3></div></div></div><p>
      このセクションの関数は、ジオメトリ値に対する便利な操作を提供します。
    </p><p>
      特に指定がないかぎり、このセクションの関数はジオメトリ引数を次のように処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          いずれかの引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。
        </p></li><li class="listitem"><p>
          ジオメトリ引数が構文的に整形式のジオメトリでない場合は、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          未定義の空間参照システム (SRS) でジオメトリ引数が構文的に整形式のジオメトリである場合、<code class="literal">ER_SRS_NOT_FOUND</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          複数のジオメトリ引数を取る関数では、それらの引数が同じ SRS 内にない場合、<code class="literal">ER_GIS_DIFFERENT_SRIDS</code> エラーが発生します。
        </p></li><li class="listitem"><p>
          それ以外の場合、戻り値は <code class="literal">NULL</code> 以外です。
        </p></li></ul></div><p>
      次の便利な関数を使用できます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-distance-sphere"></a><p>
          <code class="literal">ST_Distance_Sphere(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em> [, <em class="replaceable"><code>radius</code></em>])</code>
        </p><a class="indexterm" name="idm46041616391344"></a><p>
          スフィア上の <code class="literal">Point</code> または <code class="literal">MultiPoint</code> 引数間の最小球面距離をメートル単位で返します。 (汎用の距離計算については、<code class="literal">ST_Distance()</code> 関数を参照してください。) オプションの <em class="replaceable"><code>radius</code></em> 引数はメートル単位で指定する必要があります。 
        </p><p>
          両方のジオメトリパラメータが SRID 0 の有効なデカルト <code class="literal">Point</code> 値または <code class="literal">MultiPoint</code> 値である場合、戻り値は指定された半径を持つ球上の 2 つのジオメトリ間の最短距離です。 省略すると、デフォルトの半径は 6,370,986 メートル、点 X および Y 座標はそれぞれ経度および緯度 (度) として解釈されます。 
        </p><p>
          地理空間参照システム (SRS) で両方のジオメトリパラメータが有効な <code class="literal">Point</code> 値または <code class="literal">MultiPoint</code> 値である場合、戻り値は球上の 2 つのジオメトリ間の最短距離となり、半径が指定されます。 省略した場合、デフォルトの半径は (2a+b)/3,として定義された平均半径と等しくなります。a は半主軸、b は SRS の半最小軸です。 
        </p><p>
          <code class="literal">ST_Distance_Sphere()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              サポートされているジオメトリ引数の組合せは、<code class="literal">Point</code> と <code class="literal">Point</code>、または <code class="literal">Point</code> と <code class="literal">MultiPoint</code> (任意の引数の順序) です。 少なくともいずれかのジオメトリが <code class="literal">Point</code> でも <code class="literal">MultiPoint</code> でもなく、SRID が 0 の場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS</code> エラーが発生します。 少なくともいずれかのジオメトリが <code class="literal">Point</code> でも <code class="literal">MultiPoint</code> でもなく、SRID が地理 SRS を参照している場合は、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。 ジオメトリが投影 SRS を参照している場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_PROJECTED_SRS</code> エラーが発生します。 
            </p></li><li class="listitem"><p>
              範囲外の経度または緯度を持つ引数がある場合、エラーが発生します:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                </p></li><li class="listitem"><p>
                  緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                </p></li></ul></div><p>
              表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>radius</code></em> 引数が存在するが正でない場合は、<code class="literal">ER_NONPOSITIVE_RADIUS</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              距離が倍精度数値の範囲を超えると、<code class="literal">ER_STD_OVERFLOW_ERROR</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt1 = ST_GeomFromText('POINT(0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @pt2 = ST_GeomFromText('POINT(180 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance_Sphere(@pt1, @pt2);</code></strong>
+--------------------------------+
| ST_Distance_Sphere(@pt1, @pt2) |
+--------------------------------+
|             20015042.813723423 |
+--------------------------------+
</pre></li><li class="listitem"><a name="function_st-isvalid"></a><p>
          <code class="literal">ST_IsValid(<em class="replaceable"><code>g</code></em>)</code>
        </p><a class="indexterm" name="idm46041616346112"></a><p>
          引数がジオメトリ学的に有効な場合は 1 を返し、ジオメトリ学的に有効でない場合は 0 を返します。 ジオメトリの有効性は OGC 仕様で定義されます。 
        </p><p>
          有効な空のジオメトリのみが、空のジオメトリコレクション値の形式で表されます。 この場合、<code class="literal">ST_IsValid()</code> は 1 を返します。 MySQL は、<code class="literal">POINT EMPTY</code> などの GIS の <code class="literal">EMPTY</code> 値をサポートしていません。 
        </p><p>
          <code class="literal">ST_IsValid()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリに経度または緯度が範囲外の地理 SRS がある場合、エラーが発生します:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                </p></li><li class="listitem"><p>
                  緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                </p></li></ul></div><p>
              表示される範囲は度数です。 SRS で別の単位が使用されている場合、範囲ではその単位に対応する値が使用されます。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,-0.00 0,0.0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 0, 1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_IsValid(@ls1);</code></strong>
+------------------+
| ST_IsValid(@ls1) |
+------------------+
|                0 |
+------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_IsValid(@ls2);</code></strong>
+------------------+
| ST_IsValid(@ls2) |
+------------------+
|                1 |
+------------------+
</pre></li><li class="listitem"><a name="function_st-makeenvelope"></a><p>
          <code class="literal">ST_MakeEnvelope(<em class="replaceable"><code>pt1</code></em>, <em class="replaceable"><code>pt2</code></em>)</code>
        </p><a class="indexterm" name="idm46041616319216"></a><p>
          <code class="literal">Point</code>、<code class="literal">LineString</code> または <code class="literal">Polygon</code> として、2 つの点を中心にエンベロープを形成する矩形を返します。
        </p><p>
          計算は、球、回転楕円体、または地球でではなくデカルト座標系を使用して行われます。
        </p><p>
          <em class="replaceable"><code>pt1</code></em> と <em class="replaceable"><code>pt2</code></em> の 2 つの点を指定すると、<code class="literal">ST_MakeEnvelope()</code> は次のような抽象平面上に結果ジオメトリを作成します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>pt1</code></em> と <em class="replaceable"><code>pt2</code></em> が等しい場合、結果はポイント <em class="replaceable"><code>pt1</code></em> になります。
            </p></li><li class="listitem"><p>
              それ以外の場合、<code class="literal">(<em class="replaceable"><code>pt1</code></em>, <em class="replaceable"><code>pt2</code></em>)</code> が垂直または水平線セグメントの場合、結果は線セグメント <code class="literal">(<em class="replaceable"><code>pt1</code></em>, <em class="replaceable"><code>pt2</code></em>)</code> になります。
            </p></li><li class="listitem"><p>
              それ以外の場合、結果は <em class="replaceable"><code>pt1</code></em> および <em class="replaceable"><code>pt2</code></em> を対角ポイントとして使用するポリゴンになります。
            </p></li></ul></div><p>
          結果のジオメトリの SRID は 0 です。
        </p><p>
          <code class="literal">ST_MakeEnvelope()</code> は、このセクションの概要で説明されているように、引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              引数が <code class="literal">Point</code> 値でない場合は、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              2 つの点の座標値が無限または <code class="literal">NaN</code> であるという追加条件で、<code class="literal">ER_GIS_INVALID_DATA</code> エラーが発生します。
            </p></li><li class="listitem"><p>
              地理空間参照システム (SRS) の SRID 値を持つジオメトリがある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @pt1 = ST_GeomFromText('POINT(0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @pt2 = ST_GeomFromText('POINT(1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_MakeEnvelope(@pt1, @pt2));</code></strong>
+----------------------------------------+
| ST_AsText(ST_MakeEnvelope(@pt1, @pt2)) |
+----------------------------------------+
| POLYGON((0 0,1 0,1 1,0 1,0 0))         |
+----------------------------------------+
</pre></li><li class="listitem"><a name="function_st-simplify"></a><p>
          <code class="literal">ST_Simplify(<em class="replaceable"><code>g</code></em>, <em class="replaceable"><code>max_distance</code></em>)</code>
        </p><a class="indexterm" name="idm46041616283664"></a><p>
          Douglas-Peucker アルゴリズムを使用してジオメトリを簡略化し、同じタイプの簡略化された値を返します。
        </p><p>
          ジオメトリは任意のジオメトリタイプにできますが、Douglas-Peucker アルゴリズムは実際にはすべてのタイプを処理するわけではありません。 ジオメトリコレクションは、そのコンポーネントに 1 つずつ簡略化アルゴリズムを指定することで処理され、戻されたジオメトリは結果としてジオメトリコレクションに格納されます。 
        </p><p>
          <em class="replaceable"><code>max_distance</code></em> 引数は、削除する頂点から他のセグメントまでの距離 (入力座標の単位) です。 簡略化された線ストリングのこの距離内の頂点が削除されます。 
        </p><p>
          Boost.Geometry によると、ジオメトリは簡略化プロセスの結果として無効になり、プロセスによって自己交差が作成される可能性があります。 結果の妥当性をチェックするには、<code class="literal">ST_IsValid()</code> に渡します。 
        </p><p>
          <code class="literal">ST_Simplify()</code> は、このセクションの概要で説明されているように引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>max_distance</code></em> 引数が正でないか、<code class="literal">NaN</code> である場合、<code class="literal">ER_WRONG_ARGUMENTS</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @g = ST_GeomFromText('LINESTRING(0 0,0 1,1 1,1 2,2 2,2 3,3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Simplify(@g, 0.5));</code></strong>
+---------------------------------+
| ST_AsText(ST_Simplify(@g, 0.5)) |
+---------------------------------+
| LINESTRING(0 0,0 1,1 1,2 3,3 3) |
+---------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Simplify(@g, 1.0));</code></strong>
+---------------------------------+
| ST_AsText(ST_Simplify(@g, 1.0)) |
+---------------------------------+
| LINESTRING(0 0,3 3)             |
+---------------------------------+
</pre></li><li class="listitem"><a name="function_st-validate"></a><p>
          <code class="literal">ST_Validate(<em class="replaceable"><code>g</code></em>)</code>
        </p><a class="indexterm" name="idm46041616262528"></a><p>
          OGC 仕様に従ってジオメトリを検証します。 ジオメトリは構文的に整形式 (WKB 値と SRID) にすることができますが、ジオメトリ学的には無効です。 たとえば、このポリゴンはジオメトリ学的に無効です: <code class="literal">POLYGON((0 0, 0 0, 0 0, 0 0, 0 0))</code> 
        </p><p>
          <code class="literal">ST_Validate()</code> は、ジオメトリが構文的に整形式でジオメトリが有効な場合はジオメトリを戻し、引数が構文的に整形式でないか、形状的に有効でないか、または <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を戻します。
        </p><p>
          <code class="literal">ST_Validate()</code> を使用すると、コストがかかりますが、無効なジオメトリデータをフィルタ処理で除外できます。 無効なデータによって保持されないより正確な結果を必要とするアプリケーションの場合、このペナルティは価値がある可能性があります。 
        </p><p>
          ジオメトリ引数が有効な場合、入力 <code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> に時計回りのリングがある場合を除き、それらのリングは有効性をチェックする前に逆になります。 ジオメトリが有効な場合は、反転リングの値が返されます。 
        </p><p>
          有効な空のジオメトリのみが、空のジオメトリコレクション値の形式で表されます。 この場合、<code class="literal">ST_Validate()</code> はそれを直接返し、それ以上のチェックは行いません。 
        </p><p>
          MySQL 8.0.13 では、<code class="literal">ST_Validate()</code> はこのセクションの概要で説明されているように引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリに経度または緯度が範囲外の地理 SRS がある場合、エラーが発生します:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  経度の値が (−180, 180]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code>)。
                </p></li><li class="listitem"><p>
                  緯度の値が[−90, 90]の範囲内にない場合は、<code class="literal">ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE</code> エラーが発生します (MySQL 8.0.12 より前の <code class="literal">ER_LATITUDE_OUT_OF_RANGE</code>)。
                </p></li></ul></div><p>
              表示される範囲は度数です。 浮動小数点演算のため、正確な範囲制限はわずかに偏差します。 
            </p></li></ul></div><p>
          MySQL 8.0.13 より前では、<code class="literal">ST_Validate()</code> はこのセクションの概要で説明されているように引数を処理しますが、次の例外があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ジオメトリが構文的に整形式でない場合、戻り値は <code class="literal">NULL</code> です。 <code class="literal">ER_GIS_INVALID_DATA</code> エラーは発生しません。 
            </p></li><li class="listitem"><p>
              ジオメトリに地理空間参照システム (SRS) の SRID 値がある場合、<code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code> エラーが発生します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 0, 1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Validate(@ls1));</code></strong>
+------------------------------+
| ST_AsText(ST_Validate(@ls1)) |
+------------------------------+
| NULL                         |
+------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT ST_AsText(ST_Validate(@ls2));</code></strong>
+------------------------------+
| ST_AsText(ST_Validate(@ls2)) |
+------------------------------+
| LINESTRING(0 0,1 1)          |
+------------------------------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="json-functions"></a>12.18 JSON 関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#json-function-reference">12.18.1 JSON 関数リファレンス</a></span></dt><dt><span class="section"><a href="functions.html#json-creation-functions">12.18.2 JSON 値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-search-functions">12.18.3 JSON 値を検索する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-modification-functions">12.18.4 JSON 値を変更する関数</a></span></dt><dt><span class="section"><a href="functions.html#json-attribute-functions">12.18.5 JSON 値属性を返す関数</a></span></dt><dt><span class="section"><a href="functions.html#json-table-functions">12.18.6 JSON テーブル関数</a></span></dt><dt><span class="section"><a href="functions.html#json-validation-functions">12.18.7 JSON スキーマ検証関数</a></span></dt><dt><span class="section"><a href="functions.html#json-utility-functions">12.18.8 JSON ユーティリティ関数</a></span></dt></dl></div><a class="indexterm" name="idm46041616225040"></a><p>
    このセクションで説明する関数は、JSON 値に対する操作を実行します。 <code class="literal">JSON</code> データ型の説明およびこれらの関数の使用方法を示すその他の例は、<a class="xref" href="data-types.html#json" title="11.5 JSON データ型">セクション11.5「JSON データ型」</a> を参照してください。 
  </p><p>
    JSON 引数を取る関数の場合、引数が有効な JSON 値でないとエラーが発生します。 JSON として解析された引数は <em class="replaceable"><code>json_doc</code></em> によって示され、<em class="replaceable"><code>val</code></em> によって示された引数は解析されません。 
  </p><p>
    GeoJSON 値を操作するための一連の空間関数も使用できます。 <a class="xref" href="functions.html#spatial-geojson-functions" title="12.17.11 空間 GeoJSON 関数">セクション12.17.11「空間 GeoJSON 関数」</a>を参照してください。 
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-function-reference"></a>12.18.1 JSON 関数リファレンス</h3></div></div></div><a class="indexterm" name="idm46041616217216"></a><div class="table"><a name="idm46041616216048"></a><p class="title"><b>表 12.22 「JSON 関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「すべての JSON 関数をリストする参照。」"><col style="width: 22%"><col style="width: 55%"><col style="width: 11%"><col style="width: 11%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
<th>非推奨</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></th>
<td>
      パスを評価した後の JSON カラムからの戻り値 (JSON_EXTRACT() と同等)。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></th>
<td>
      パスを評価して結果を引用符で囲まずに JSON カラムから値を返します (JSON_UNQUOTE(JSON_EXTRACT() と同等)。
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a></th>
<td>
      JSON 配列の作成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array-append"><code class="literal">JSON_ARRAY_APPEND()</code></a></th>
<td>
      JSON ドキュメントへのデータの追加
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT()</code></a></th>
<td>
      JSON 配列に挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a></th>
<td>
      JSON ドキュメントのパスに特定のオブジェクトが含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a></th>
<td>
      JSON ドキュメントにパスのデータが含まれているかどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-depth"><code class="literal">JSON_DEPTH()</code></a></th>
<td>
      JSON ドキュメントの最大深度
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a></th>
<td>
      JSON ドキュメントからデータを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a></th>
<td>
      JSON ドキュメントへのデータの挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-keys"><code class="literal">JSON_KEYS()</code></a></th>
<td>
      JSON ドキュメントからのキーの配列
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-length"><code class="literal">JSON_LENGTH()</code></a></th>
<td>
      JSON ドキュメント内の要素数
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE()</code></a></th>
<td>
      JSON ドキュメントをマージし、重複するキーを保持します。 JSON_MERGE_PRESERVE() の非推奨シノニム 
    </td>
<td></td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a></th>
<td>
      重複キーの値を置換して JSON ドキュメントをマージ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a></th>
<td>
      重複キーを保持した JSON ドキュメントのマージ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a></th>
<td>
      JSON オブジェクトの作成
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-overlaps"><code class="literal">JSON_OVERLAPS()</code></a></th>
<td>
      2 つの JSON ドキュメントを比較し、共通のキーと値のペアまたは配列要素がある場合は TRUE (1) を戻し、それ以外の場合は FALSE (0) を戻します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a></th>
<td>
      JSON ドキュメントを人間が読める形式で出力
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE()</code></a></th>
<td>
      見積 JSON 文書
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a></th>
<td>
      JSON ドキュメントからのデータの削除
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a></th>
<td>
      JSON ドキュメントの値の置換
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID()</code></a></th>
<td>
      JSON スキーマに対して JSON ドキュメントを検証します。ドキュメントがスキーマに対して検証される場合は TRUE/1 を返し、検証されない場合は FALSE/0 を返します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code></a></th>
<td>
      JSON スキーマに対して JSON ドキュメントを検証します。成功や失敗、失敗の理由など、検証の結果に関するレポートを JSON 形式で返します
    </td>
<td>8.0.17</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a></th>
<td>
      JSON ドキュメント内の値へのパス
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a></th>
<td>
      JSON ドキュメントへのデータの挿入
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a></th>
<td>
      部分更新後の JSON カラム値のバイナリ表現内の空き領域
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a></th>
<td>
      JSON ドキュメントのバイナリ表現の格納に使用される領域
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a></th>
<td>
      JSON 式からリレーショナルテーブルとしてデータを返します
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a></th>
<td>
      JSON 値のタイプ
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a></th>
<td>
      JSON 値の引用符なし
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-valid"><code class="literal">JSON_VALID()</code></a></th>
<td>
      JSON 値が有効かどうか
    </td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_json-value"><code class="literal">JSON_VALUE()</code></a></th>
<td>
      指定されたパスでポイントされた場所にある JSON ドキュメントから値を抽出します。この値を VARCHAR(512) または指定されたタイプとして返します
    </td>
<td>8.0.21</td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></th>
<td>
      最初のオペランドが 2 番目のオペランドとして渡された JSON 配列のいずれかの要素と一致する場合は true (1) を返し、それ以外の場合は false (0) を返します
    </td>
<td>8.0.17</td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"><p>
      MySQL は、<code class="literal">JSON_ARRAYAGG()</code> および <code class="literal">JSON_OBJECTAGG()</code> の 2 つの集計 JSON 関数をサポートしています。 これらの詳細は、<a class="xref" href="functions.html#aggregate-functions-and-modifiers" title="12.20 集計関数">セクション12.20「集計関数」</a> を参照してください。 
    </p><p>
      MySQL では、<code class="literal">JSON_PRETTY()</code> 関数を使用して、読みやすい形式の JSON 値の <span class="quote">「<span class="quote">pretty-printing</span>」</span> もサポートしています。 <code class="literal">JSON_STORAGE_SIZE()</code> および <code class="literal">JSON_STORAGE_FREE()</code> をそれぞれ使用して、特定の JSON 値が占有するストレージ領域の量、および追加のストレージ用に残っている領域の量を確認できます。 これらの関数の詳細は、<a class="xref" href="functions.html#json-utility-functions" title="12.18.8 JSON ユーティリティ関数">セクション12.18.8「JSON ユーティリティ関数」</a> を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-creation-functions"></a>12.18.2 JSON 値を作成する関数</h3></div></div></div><p>
      このセクションにリストされている関数は、コンポーネント要素から JSON 値を構成します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-array"></a><p>
          <code class="literal">JSON_ARRAY([<em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>val</code></em>] ...])</code>
        </p><a class="indexterm" name="idm46041616030496"></a><p>
          値リスト (空の場合もある) を評価し、それらの値を含む JSON 配列を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY(1, "abc", NULL, TRUE, CURTIME());</code></strong>
+---------------------------------------------+
| JSON_ARRAY(1, "abc", NULL, TRUE, CURTIME()) |
+---------------------------------------------+
| [1, "abc", null, true, "11:30:24.000000"]   |
+---------------------------------------------+
</pre></li><li class="listitem"><a name="function_json-object"></a><p>
          <code class="literal">JSON_OBJECT([<em class="replaceable"><code>key</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>key</code></em>, <em class="replaceable"><code>val</code></em>] ...])</code>
        </p><a class="indexterm" name="idm46041616018208"></a><p>
          キーと値のペアの (空の可能性がある) リストを評価し、それらのペアを含む JSON オブジェクトを返します。 いずれかのキー名が <code class="literal">NULL</code> であるか、引数の数が奇数の場合、エラーが発生します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECT('id', 87, 'name', 'carrot');</code></strong>
+-----------------------------------------+
| JSON_OBJECT('id', 87, 'name', 'carrot') |
+-----------------------------------------+
| {"id": 87, "name": "carrot"}            |
+-----------------------------------------+
</pre></li><li class="listitem"><a name="function_json-quote"></a><p>
          <code class="literal">JSON_QUOTE(<em class="replaceable"><code>string</code></em>)</code>
        </p><a class="indexterm" name="idm46041616006096"></a><p>
          文字列を二重引用符で囲み、内部引用符やその他の文字をエスケープして JSON 値として引用符で囲み、結果を <code class="literal">utf8mb4</code> 文字列として返します。 引数が <code class="literal">NULL</code> の場合、<code class="literal">NULL</code> を返します。 
        </p><p>
          この関数は通常、JSON ドキュメントに含める有効な JSON 文字列リテラルを生成するために使用されます。
        </p><p>
          特定の特殊文字は、<a class="xref" href="functions.html#json-unquote-character-escape-sequences" title="表 12.23 JSON_UNQUOTE() 特殊文字エスケープシーケンス">表12.23「JSON_UNQUOTE() 特殊文字エスケープシーケンス」</a> に示されているエスケープシーケンスごとにバックスラッシュでエスケープされます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_QUOTE('null'), JSON_QUOTE('"null"');</code></strong>
+--------------------+----------------------+
| JSON_QUOTE('null') | JSON_QUOTE('"null"') |
+--------------------+----------------------+
| "null"             | "\"null\""           |
+--------------------+----------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_QUOTE('[1, 2, 3]');</code></strong>
+-------------------------+
| JSON_QUOTE('[1, 2, 3]') |
+-------------------------+
| "[1, 2, 3]"             |
+-------------------------+
</pre></li></ul></div><p>
      <code class="literal">CAST(<em class="replaceable"><code>value</code></em> AS JSON)</code> を使用して他の型の値を <code class="literal">JSON</code> 型にキャストすることで、JSON 値を取得することもできます。詳細は、<a class="xref" href="data-types.html#json-converting-between-types" title="JSON 値と非 JSON 値の間の変換">JSON 値と非 JSON 値の間の変換</a> を参照してください。
    </p><p>
      JSON 値を生成する 2 つの集計関数を使用できます。 <code class="literal">JSON_ARRAYAGG()</code> は結果セットを単一の JSON 配列として返し、<code class="literal">JSON_OBJECTAGG()</code> は結果セットを単一の JSON オブジェクトとして返します。 詳細は、<a class="xref" href="functions.html#aggregate-functions-and-modifiers" title="12.20 集計関数">セクション12.20「集計関数」</a>を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-search-functions"></a>12.18.3 JSON 値を検索する関数</h3></div></div></div><p>
      このセクションの関数では、JSON 値に対して検索または比較操作を実行して、JSON 値からデータを抽出したり、データが JSON 値内の場所に存在するかどうかをレポートしたり、JSON 値内のデータへのパスをレポートします。 ここでは、<code class="literal">MEMBER OF()</code> 演算子についても説明します。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-contains"></a><p>
          <code class="literal">JSON_CONTAINS(<em class="replaceable"><code>target</code></em>, <em class="replaceable"><code>candidate</code></em>[, <em class="replaceable"><code>path</code></em>])</code>
        </p><a class="indexterm" name="idm46041615977520"></a><p>
          特定の <em class="replaceable"><code>candidate</code></em> JSON ドキュメントが <em class="replaceable"><code>target</code></em> JSON ドキュメント内に含まれているかどうか、または <em class="replaceable"><code>path</code></em> 引数が指定されているかどうか (候補がターゲット内の特定のパスで見つかったかどうか) を 1 または 0 を返して示します。 いずれかの引数が <code class="literal">NULL</code> の場合、またはパス引数がターゲットドキュメントのセクションを識別しない場合、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>target</code></em> または <em class="replaceable"><code>candidate</code></em> が有効な JSON ドキュメントでない場合、または <em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合は、エラーが発生します。 
        </p><p>
          パスにデータが存在するかどうかのみを確認するには、かわりに <code class="literal">JSON_CONTAINS_PATH()</code> を使用します。
        </p><p>
          次のルールは包含を定義します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              候補スカラーは、比較可能で等しい場合にのみターゲットスカラーに含まれます。 同じ <code class="literal">JSON_TYPE()</code> 型を持つ場合、2 つのスカラー値が比較可能ですが、<code class="literal">INTEGER</code> 型と <code class="literal">DECIMAL</code> 型の値も相互に比較可能である点が異なります。 
            </p></li><li class="listitem"><p>
              候補配列は、候補のすべての要素がターゲットの一部の要素に含まれている場合にのみ、ターゲット配列に含まれます。
            </p></li><li class="listitem"><p>
              候補がターゲットの一部の要素に含まれている場合にのみ、候補の非配列がターゲット配列に含まれます。
            </p></li><li class="listitem"><p>
              候補オブジェクトがターゲットオブジェクトに含まれるのは、候補の各キーに対して同じ名前のキーがターゲットにあり、候補キーに関連付けられた値がターゲットキーに関連付けられた値に含まれている場合のみです。
            </p></li></ul></div><p>
          それ以外の場合、候補値はターゲットドキュメントに含まれません。
        </p><p>
          MySQL 8.0.17 以降、<code class="literal">InnoDB</code> テーブルで <code class="literal">JSON_CONTAINS()</code> を使用するクエリーは、複数値インデックスを使用して最適化できます。詳細は、<a class="xref" href="sql-statements.html#create-index-multi-valued" title="複数値インデックス">複数値インデックス</a> を参照してください。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{"a": 1, "b": 2, "c": {"d": 4}}';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @j2 = '1';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.a');</code></strong>
+-------------------------------+
| JSON_CONTAINS(@j, @j2, '$.a') |
+-------------------------------+
|                             1 |
+-------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.b');</code></strong>
+-------------------------------+
| JSON_CONTAINS(@j, @j2, '$.b') |
+-------------------------------+
|                             0 |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SET @j2 = '{"d": 4}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.a');</code></strong>
+-------------------------------+
| JSON_CONTAINS(@j, @j2, '$.a') |
+-------------------------------+
|                             0 |
+-------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.c');</code></strong>
+-------------------------------+
| JSON_CONTAINS(@j, @j2, '$.c') |
+-------------------------------+
|                             1 |
+-------------------------------+
</pre></li><li class="listitem"><a name="function_json-contains-path"></a><p>
          <code class="literal">JSON_CONTAINS_PATH(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>one_or_all</code></em>, <em class="replaceable"><code>path</code></em>[, <em class="replaceable"><code>path</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615939488"></a><p>
          JSON ドキュメントに指定されたパスのデータが含まれているかどうかを示す 0 または 1 を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでない場合、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でない場合、または <em class="replaceable"><code>one_or_all</code></em> が<code class="literal">'one'</code>または<code class="literal">'all'</code>でない場合は、エラーが発生します。 
        </p><p>
          パスで特定の値を確認するには、かわりに <code class="literal">JSON_CONTAINS()</code> を使用します。
        </p><p>
          指定されたパスがドキュメント内に存在しない場合、戻り値は 0 です。 それ以外の場合、戻り値は <em class="replaceable"><code>one_or_all</code></em> 引数によって異なります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">'one'</code>: ドキュメント内に少なくとも 1 つのパスが存在する場合は 1、それ以外の場合は 0。
            </p></li><li class="listitem"><p>
              <code class="literal">'all'</code>: ドキュメント内にすべてのパスが存在する場合は 1、それ以外の場合は 0。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{"a": 1, "b": 2, "c": {"d": 4}}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.a', '$.e');</code></strong>
+---------------------------------------------+
| JSON_CONTAINS_PATH(@j, 'one', '$.a', '$.e') |
+---------------------------------------------+
|                                           1 |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'all', '$.a', '$.e');</code></strong>
+---------------------------------------------+
| JSON_CONTAINS_PATH(@j, 'all', '$.a', '$.e') |
+---------------------------------------------+
|                                           0 |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.c.d');</code></strong>
+----------------------------------------+
| JSON_CONTAINS_PATH(@j, 'one', '$.c.d') |
+----------------------------------------+
|                                      1 |
+----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.a.d');</code></strong>
+----------------------------------------+
| JSON_CONTAINS_PATH(@j, 'one', '$.a.d') |
+----------------------------------------+
|                                      0 |
+----------------------------------------+
</pre></li><li class="listitem"><a name="function_json-extract"></a><p>
          <code class="literal">JSON_EXTRACT(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>[, <em class="replaceable"><code>path</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615911872"></a><p>
          <em class="replaceable"><code>path</code></em> 引数に一致するドキュメントの一部から選択された JSON ドキュメントからデータを返します。 いずれかの引数が <code class="literal">NULL</code> の場合、またはドキュメント内の値を特定するパスがない場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでない場合、または <em class="replaceable"><code>path</code></em> 引数が有効なパス式でない場合は、エラーが発生します。 
        </p><p>
          戻り値は、<em class="replaceable"><code>path</code></em> 引数に一致するすべての値で構成されます。 これらの引数が複数の値を返す可能性がある場合、一致した値は、それらを生成したパスに対応する順序で配列として自動ラップされます。 それ以外の場合、戻り値は単一の一致値です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]');</code></strong>
+--------------------------------------------+
| JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]') |
+--------------------------------------------+
| 20                                         |
+--------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]', '$[0]');</code></strong>
+----------------------------------------------------+
| JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]', '$[0]') |
+----------------------------------------------------+
| [20, 10]                                           |
+----------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[2][*]');</code></strong>
+-----------------------------------------------+
| JSON_EXTRACT('[10, 20, [30, 40]]', '$[2][*]') |
+-----------------------------------------------+
| [30, 40]                                      |
+-----------------------------------------------+
</pre><p>
          MySQL では、この関数の短縮形として <code class="literal">-&gt;</code> 演算子がサポートされており、左側が <code class="literal">JSON</code> カラム識別子 (式ではなく) であり、右側がカラム内で照合される JSON パスである 2 つの引数で使用されます。
        </p></li><li class="listitem"><a name="operator_json-column-path"></a><p>
          <code class="literal"><em class="replaceable"><code>column</code></em>-&gt;<em class="replaceable"><code>path</code></em></code>
        </p><a class="indexterm" name="idm46041615889808"></a><p>
          <code class="literal">-&gt;</code> 演算子は、左側のカラム識別子と JSON ドキュメント (カラム値) に対して評価される右側の JSON パスの 2 つの引数で使用される <code class="literal">JSON_EXTRACT()</code> 関数のエイリアスとして機能します。 このような式は、SQL ステートメントのどこにあるかにかかわらず、カラム識別子のかわりに使用できます。 
        </p><p>
          次に示す 2 つの <code class="literal">SELECT</code> ステートメントでは、同じ出力が生成されます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT c, JSON_EXTRACT(c, "$.id"), g</code></strong>
     &gt; <strong class="userinput"><code>FROM jemp</code></strong>
     &gt; <strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong>
     &gt; <strong class="userinput"><code>ORDER BY JSON_EXTRACT(c, "$.name");</code></strong>
+-------------------------------+-----------+------+
| c                             | c-&gt;"$.id" | g    |
+-------------------------------+-----------+------+
| {"id": "3", "name": "Barney"} | "3"       |    3 |
| {"id": "4", "name": "Betty"}  | "4"       |    4 |
| {"id": "2", "name": "Wilma"}  | "2"       |    2 |
+-------------------------------+-----------+------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT c, c-&gt;"$.id", g</code></strong>
     &gt; <strong class="userinput"><code>FROM jemp</code></strong>
     &gt; <strong class="userinput"><code>WHERE c-&gt;"$.id" &gt; 1</code></strong>
     &gt; <strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong>
+-------------------------------+-----------+------+
| c                             | c-&gt;"$.id" | g    |
+-------------------------------+-----------+------+
| {"id": "3", "name": "Barney"} | "3"       |    3 |
| {"id": "4", "name": "Betty"}  | "4"       |    4 |
| {"id": "2", "name": "Wilma"}  | "2"       |    2 |
+-------------------------------+-----------+------+
3 rows in set (0.00 sec)
</pre><p>
          次に示すように、この機能は <code class="literal">SELECT</code> に限定されません:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>ALTER TABLE jemp ADD COLUMN n INT;</code></strong>
Query OK, 0 rows affected (0.68 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>UPDATE jemp SET n=1 WHERE c-&gt;"$.id" = "4";</code></strong>
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT c, c-&gt;"$.id", g, n</code></strong>
     &gt; <strong class="userinput"><code>FROM jemp</code></strong>
     &gt; <strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong>
     &gt; <strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong>
+-------------------------------+-----------+------+------+
| c                             | c-&gt;"$.id" | g    | n    |
+-------------------------------+-----------+------+------+
| {"id": "3", "name": "Barney"} | "3"       |    3 | NULL |
| {"id": "4", "name": "Betty"}  | "4"       |    4 |    1 |
| {"id": "2", "name": "Wilma"}  | "2"       |    2 | NULL |
+-------------------------------+-----------+------+------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DELETE FROM jemp WHERE c-&gt;"$.id" = "4";</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT c, c-&gt;"$.id", g, n</code></strong>
     &gt; <strong class="userinput"><code>FROM jemp</code></strong>
     &gt; <strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong>
     &gt; <strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong>
+-------------------------------+-----------+------+------+
| c                             | c-&gt;"$.id" | g    | n    |
+-------------------------------+-----------+------+------+
| {"id": "3", "name": "Barney"} | "3"       |    3 | NULL |
| {"id": "2", "name": "Wilma"}  | "2"       |    2 | NULL |
+-------------------------------+-----------+------+------+
2 rows in set (0.00 sec)
</pre><p>
          (前述のテーブルの作成および移入に使用されるステートメントについては、<a class="xref" href="sql-statements.html#json-column-indirect-index" title="JSON カラムインデックスを提供するための生成されたカラムのインデックス付け">JSON カラムインデックスを提供するための生成されたカラムのインデックス付け</a> を参照してください。)
        </p><p>
          これは、次に示すように JSON 配列値でも機能します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE tj10 (a JSON, b INT);</code></strong>
Query OK, 0 rows affected (0.26 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO tj10</code></strong>
     &gt; <strong class="userinput"><code>VALUES ("[3,10,5,17,44]", 33), ("[3,10,5,17,[22,44,66]]", 0);</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT a-&gt;"$[4]" FROM tj10;</code></strong>
+--------------+
| a-&gt;"$[4]"    |
+--------------+
| 44           |
| [22, 44, 66] |
+--------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM tj10 WHERE a-&gt;"$[0]" = 3;</code></strong>
+------------------------------+------+
| a                            | b    |
+------------------------------+------+
| [3, 10, 5, 17, 44]           |   33 |
| [3, 10, 5, 17, [22, 44, 66]] |    0 |
+------------------------------+------+
2 rows in set (0.00 sec)
</pre><p>
          ネストされた配列がサポートされています。 次に示すように、ターゲット JSON ドキュメントに一致するキーが見つからない場合、<code class="literal">-&gt;</code> を使用する式は <code class="literal">NULL</code> として評価されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM tj10 WHERE a-&gt;"$[4][1]" IS NOT NULL;</code></strong>
+------------------------------+------+
| a                            | b    |
+------------------------------+------+
| [3, 10, 5, 17, [22, 44, 66]] |    0 |
+------------------------------+------+

mysql&gt; <strong class="userinput"><code>SELECT a-&gt;"$[4][1]" FROM tj10;</code></strong>
+--------------+
| a-&gt;"$[4][1]" |
+--------------+
| NULL         |
| 44           |
+--------------+
2 rows in set (0.00 sec)
</pre><p>
          これは、<code class="literal">JSON_EXTRACT()</code> を使用している場合と同じ動作です:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(a, "$[4][1]") FROM tj10;</code></strong>
+----------------------------+
| JSON_EXTRACT(a, "$[4][1]") |
+----------------------------+
| NULL                       |
| 44                         |
+----------------------------+
2 rows in set (0.00 sec)
</pre></li><li class="listitem"><a name="operator_json-inline-path"></a><p>
          <code class="literal"><em class="replaceable"><code>column</code></em>-&gt;&gt;<em class="replaceable"><code>path</code></em></code>
        </p><a class="indexterm" name="idm46041615838112"></a><p>
          これは、改善された引用符で囲まれていない抽出演算子です。 <code class="literal">-&gt;</code> 演算子は単に値を抽出するだけですが、<code class="literal">-&gt;&gt;</code> 演算子は抽出された結果を引用符で囲みません。 つまり、<code class="literal">JSON</code> カラム値が <em class="replaceable"><code>column</code></em> で、パス式が <em class="replaceable"><code>path</code></em> の場合、次の 3 つの式は同じ値を返します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">JSON_UNQUOTE(</code> <code class="literal">JSON_EXTRACT(<em class="replaceable"><code>column</code></em>, <em class="replaceable"><code>path</code></em>) )</code>
            </p></li><li class="listitem"><p>
              <code class="literal">JSON_UNQUOTE(<em class="replaceable"><code>column</code></em></code> <code class="literal">-&gt;</code> <code class="literal"><em class="replaceable"><code>path</code></em>)</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>column</code></em>-&gt;&gt;<em class="replaceable"><code>path</code></em></code>
            </p></li></ul></div><p>
          <code class="literal">-&gt;&gt;</code> 演算子は、<code class="literal">JSON_UNQUOTE(JSON_EXTRACT())</code> が許可される場所であればどこでも使用できます。 これには、<code class="literal">SELECT</code> リスト、<code class="literal">WHERE</code> 句と <code class="literal">HAVING</code> 句、<code class="literal">ORDER BY</code> 句と <code class="literal">GROUP BY</code> 句が含まれます (これらに限定されません)。 
        </p><p>
          次のいくつかのステートメントは、<span class="command"><strong>mysql</strong></span> クライアントの他の式と同等の <code class="literal">-&gt;&gt;</code> 演算子を示しています:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM jemp WHERE g &gt; 2;</code></strong>
+-------------------------------+------+
| c                             | g    |
+-------------------------------+------+
| {"id": "3", "name": "Barney"} |    3 |
| {"id": "4", "name": "Betty"}  |    4 |
+-------------------------------+------+
2 rows in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT c-&gt;'$.name' AS name</code></strong>
    -&gt;     <strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong>
+----------+
| name     |
+----------+
| "Barney" |
| "Betty"  |
+----------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_UNQUOTE(c-&gt;'$.name') AS name</code></strong>
    -&gt;     <strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong>
+--------+
| name   |
+--------+
| Barney |
| Betty  |
+--------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT c-&gt;&gt;'$.name' AS name</code></strong>
    -&gt;     <strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong>
+--------+
| name   |
+--------+
| Barney |
| Betty  |
+--------+
2 rows in set (0.00 sec)
</pre><p>
          前述の一連の例で <code class="literal">jemp</code> テーブルの作成および移入に使用される SQL ステートメントについては、<a class="xref" href="sql-statements.html#json-column-indirect-index" title="JSON カラムインデックスを提供するための生成されたカラムのインデックス付け">JSON カラムインデックスを提供するための生成されたカラムのインデックス付け</a> を参照してください。
        </p><p>
          この演算子は、次に示すように JSON 配列でも使用できます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE tj10 (a JSON, b INT);</code></strong>
Query OK, 0 rows affected (0.26 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO tj10 VALUES</code></strong>
    -&gt;     <strong class="userinput"><code>('[3,10,5,"x",44]', 33),</code></strong>
    -&gt;     <strong class="userinput"><code>('[3,10,5,17,[22,"y",66]]', 0);</code></strong>
Query OK, 2 rows affected (0.04 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT a-&gt;"$[3]", a-&gt;"$[4][1]" FROM tj10;</code></strong>
+-----------+--------------+
| a-&gt;"$[3]" | a-&gt;"$[4][1]" |
+-----------+--------------+
| "x"       | NULL         |
| 17        | "y"          |
+-----------+--------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT a-&gt;&gt;"$[3]", a-&gt;&gt;"$[4][1]" FROM tj10;</code></strong>
+------------+---------------+
| a-&gt;&gt;"$[3]" | a-&gt;&gt;"$[4][1]" |
+------------+---------------+
| x          | NULL          |
| 17         | y             |
+------------+---------------+
2 rows in set (0.00 sec)
</pre><p>
          <code class="literal">-&gt;</code> と同様に、次の例に示すように、<code class="literal">-&gt;&gt;</code> 演算子は常に <code class="literal">EXPLAIN</code> の出力で展開されます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT c-&gt;&gt;'$.name' AS name</code></strong>
    -&gt;     <strong class="userinput"><code>FROM jemp WHERE g &gt; 2\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: jemp
   partitions: NULL
         type: range
possible_keys: i
          key: i
      key_len: 5
          ref: NULL
         rows: 2
     filtered: 100.00
        Extra: Using where
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1003
Message: /* select#1 */ select
json_unquote(json_extract(`jtest`.`jemp`.`c`,'$.name')) AS `name` from
`jtest`.`jemp` where (`jtest`.`jemp`.`g` &gt; 2)
1 row in set (0.00 sec)
</pre><p>
          これは、同じ状況で MySQL が <code class="literal">-&gt;</code> 演算子を拡張する方法と似ています。
        </p></li><li class="listitem"><a name="function_json-keys"></a><p>
          <code class="literal">JSON_KEYS(<em class="replaceable"><code>json_doc</code></em>[, <em class="replaceable"><code>path</code></em>])</code>
        </p><a class="indexterm" name="idm46041615780992"></a><p>
          JSON オブジェクトの最上位値からキーを JSON 配列として返します。<em class="replaceable"><code>path</code></em> 引数が指定されている場合は、選択されたパスの最上位キーを返します。 いずれかの引数が <code class="literal">NULL</code> の場合、<em class="replaceable"><code>json_doc</code></em> 引数がオブジェクトでない場合、または <em class="replaceable"><code>path</code></em>(指定されている場合) がオブジェクトを検出しない場合に、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          選択したオブジェクトが空の場合、結果配列は空です。 最上位の値にネストされたサブオブジェクトがある場合、戻り値にはそれらのサブオブジェクトのキーは含まれません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_KEYS('{"a": 1, "b": {"c": 30}}');</code></strong>
+---------------------------------------+
| JSON_KEYS('{"a": 1, "b": {"c": 30}}') |
+---------------------------------------+
| ["a", "b"]                            |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_KEYS('{"a": 1, "b": {"c": 30}}', '$.b');</code></strong>
+----------------------------------------------+
| JSON_KEYS('{"a": 1, "b": {"c": 30}}', '$.b') |
+----------------------------------------------+
| ["c"]                                        |
+----------------------------------------------+
</pre></li><li class="listitem"><a name="function_json-overlaps"></a><p>
          <code class="literal">JSON_OVERLAPS(<em class="replaceable"><code>json_doc1</code></em>, <em class="replaceable"><code>json_doc2</code></em>)</code>
        </p><a class="indexterm" name="idm46041615761488"></a><p>
          2 つの JSON ドキュメントを比較します。 2 つのドキュメントに共通のキーと値のペアまたは配列要素がある場合、true (1) を返します。 両方の引数がスカラーの場合、この関数は単純な等価性テストを実行します。 
        </p><p>
          この関数は <code class="literal">JSON_CONTAINS()</code> と同等の役割を果たします。これには、検索対象の配列のすべての要素が検索対象の配列に存在する必要があります。 したがって、<code class="literal">JSON_CONTAINS()</code> は検索キーに対して <code class="literal">AND</code> 操作を実行し、<code class="literal">JSON_OVERLAPS()</code> は <code class="literal">OR</code> 操作を実行します。 
        </p><p>
          <code class="literal">WHERE</code> 句で <code class="literal">JSON_OVERLAPS()</code> を使用する <code class="literal">InnoDB</code> テーブルの JSON カラムに対するクエリーは、複数値インデックスを使用して最適化できます。<a class="xref" href="sql-statements.html#create-index-multi-valued" title="複数値インデックス">複数値インデックス</a> では、詳細な情報と例を示します。
        </p><p>
          2 つの配列を比較する場合、<code class="literal">JSON_OVERLAPS()</code> は共通の配列要素を共有すると true を返し、共有しない場合は false を返します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,5,7]");</code></strong>
+---------------------------------------+
| JSON_OVERLAPS("[1,3,5,7]", "[2,5,7]") |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,6,7]");</code></strong>
+---------------------------------------+
| JSON_OVERLAPS("[1,3,5,7]", "[2,6,7]") |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,6,8]");</code></strong>
+---------------------------------------+
| JSON_OVERLAPS("[1,3,5,7]", "[2,6,8]") |
+---------------------------------------+
|                                     0 |
+---------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          部分一致は、次に示すように一致なしとして処理されます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('[[1,2],[3,4],5]', '[1,[2,3],[4,5]]');</code></strong>
+-----------------------------------------------------+
| JSON_OVERLAPS('[[1,2],[3,4],5]', '[1,[2,3],[4,5]]') |
+-----------------------------------------------------+
|                                                   0 |
+-----------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          オブジェクトを比較する場合、共通のキーと値のペアが 1 つ以上あると、結果は true になります。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}');</code></strong>
+-----------------------------------------------------------------------+
| JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}') |
+-----------------------------------------------------------------------+
|                                                                     1 |
+-----------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"a":5,"e":10,"f":1,"d":20}');</code></strong>
+-----------------------------------------------------------------------+
| JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"a":5,"e":10,"f":1,"d":20}') |
+-----------------------------------------------------------------------+
|                                                                     0 |
+-----------------------------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          関数の引数として 2 つのスカラーが使用されている場合、<code class="literal">JSON_OVERLAPS()</code> は等価性の単純なテストを実行します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('5', '5');</code></strong>
+-------------------------+
| JSON_OVERLAPS('5', '5') |
+-------------------------+
|                       1 |
+-------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('5', '6');</code></strong>
+-------------------------+
| JSON_OVERLAPS('5', '6') |
+-------------------------+
|                       0 |
+-------------------------+
1 row in set (0.00 sec)
</pre><p>
          スカラーを配列と比較する場合、<code class="literal">JSON_OVERLAPS()</code> はスカラーを配列要素として処理しようとします。 この例では、次に示すように、2 番目の引数 <code class="literal">6</code> が<code class="literal">[6]</code>として解釈されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,6,7]', '6');</code></strong>
+---------------------------------+
| JSON_OVERLAPS('[4,5,6,7]', '6') |
+---------------------------------+
|                               1 |
+---------------------------------+
1 row in set (0.00 sec)
</pre><p>
          この関数は型変換を実行しません:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,"6",7]', '6');</code></strong>
+-----------------------------------+
| JSON_OVERLAPS('[4,5,"6",7]', '6') |
+-----------------------------------+
|                                 0 |
+-----------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,6,7]', '"6"');</code></strong>
+-----------------------------------+
| JSON_OVERLAPS('[4,5,6,7]', '"6"') |
+-----------------------------------+
|                                 0 |
+-----------------------------------+
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">JSON_OVERLAPS()</code> が MySQL 8.0.17 に追加されました。
        </p></li><li class="listitem"><a name="function_json-search"></a><p>
          <code class="literal">JSON_SEARCH(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>one_or_all</code></em>, <em class="replaceable"><code>search_str</code></em>[, <em class="replaceable"><code>escape_char</code></em>[, <em class="replaceable"><code>path</code></em>] ...])</code>
        </p><a class="indexterm" name="idm46041615715312"></a><p>
          JSON ドキュメント内の指定された文字列へのパスを返します。 <em class="replaceable"><code>json_doc</code></em>、<em class="replaceable"><code>search_str</code></em> または <em class="replaceable"><code>path</code></em> 引数のいずれかが <code class="literal">NULL</code> の場合、ドキュメント内に <em class="replaceable"><code>path</code></em> が存在しない場合、または <em class="replaceable"><code>search_str</code></em> が見つからない場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでない場合、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でない場合、<em class="replaceable"><code>one_or_all</code></em> が<code class="literal">'one'</code>または<code class="literal">'all'</code>でない場合、または <em class="replaceable"><code>escape_char</code></em> が定数式でない場合は、エラーが発生します。 
        </p><p>
          <em class="replaceable"><code>one_or_all</code></em> 引数は、次のように検索に影響します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">'one'</code>: 最初の一致の後に検索が終了し、1 つのパス文字列が返されます。 一致が最初に考慮されるのは未定義です。 
            </p></li><li class="listitem"><p>
              <code class="literal">'all'</code>: 検索では、重複するパスが含まれないように、一致するすべてのパス文字列が返されます。 複数の文字列がある場合は、配列として自動ラップされます。 配列要素の順序が未定義です。 
            </p></li></ul></div><p>
          <em class="replaceable"><code>search_str</code></em> 検索文字列引数内では、<code class="literal">%</code> および<code class="literal">_</code>文字は <code class="literal">LIKE</code> 演算子と同様に機能: <code class="literal">%</code> は任意の数の文字 (ゼロ文字を含む) に一致し、<code class="literal">_</code>は完全に 1 文字に一致します。
        </p><p>
          検索文字列にリテラル <code class="literal">%</code> または<code class="literal">_</code>文字を指定するには、その前にエスケープ文字を付けます。 <em class="replaceable"><code>escape_char</code></em> 引数がない場合、または <code class="literal">NULL</code> の場合、デフォルトは<code class="literal">\</code>です。 それ以外の場合、<em class="replaceable"><code>escape_char</code></em> は空または 1 文字の定数である必要があります。 
        </p><p>
          一致およびエスケープ文字の動作の詳細は、<a class="xref" href="functions.html#string-comparison-functions" title="12.8.1 文字列比較関数および演算子">セクション12.8.1「文字列比較関数および演算子」</a> の <code class="literal">LIKE</code> の説明を参照してください。 エスケープ文字処理の場合、<code class="literal">LIKE</code> の動作との違いは、<code class="literal">JSON_SEARCH()</code> のエスケープ文字は、実行時だけでなく、コンパイル時に定数に評価される必要があることです。 たとえば、<code class="literal">JSON_SEARCH()</code> がプリペアドステートメントで使用され、<code class="literal">?</code> パラメータを使用して <em class="replaceable"><code>escape_char</code></em> 引数が指定されている場合、パラメータ値は実行時には一定ですが、コンパイル時には一定ではありません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '["abc", [{"k": "10"}, "def"], {"x":"abc"}, {"y":"bcd"}]';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'one', 'abc');</code></strong>
+-------------------------------+
| JSON_SEARCH(@j, 'one', 'abc') |
+-------------------------------+
| "$[0]"                        |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'abc');</code></strong>
+-------------------------------+
| JSON_SEARCH(@j, 'all', 'abc') |
+-------------------------------+
| ["$[0]", "$[2].x"]            |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'ghi');</code></strong>
+-------------------------------+
| JSON_SEARCH(@j, 'all', 'ghi') |
+-------------------------------+
| NULL                          |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10');</code></strong>
+------------------------------+
| JSON_SEARCH(@j, 'all', '10') |
+------------------------------+
| "$[1][0].k"                  |
+------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$');</code></strong>
+-----------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$') |
+-----------------------------------------+
| "$[1][0].k"                             |
+-----------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[*]');</code></strong>
+--------------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$[*]') |
+--------------------------------------------+
| "$[1][0].k"                                |
+--------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$**.k');</code></strong>
+---------------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$**.k') |
+---------------------------------------------+
| "$[1][0].k"                                 |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[*][0].k');</code></strong>
+-------------------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$[*][0].k') |
+-------------------------------------------------+
| "$[1][0].k"                                     |
+-------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[1]');</code></strong>
+--------------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$[1]') |
+--------------------------------------------+
| "$[1][0].k"                                |
+--------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[1][0]');</code></strong>
+-----------------------------------------------+
| JSON_SEARCH(@j, 'all', '10', NULL, '$[1][0]') |
+-----------------------------------------------+
| "$[1][0].k"                                   |
+-----------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'abc', NULL, '$[2]');</code></strong>
+---------------------------------------------+
| JSON_SEARCH(@j, 'all', 'abc', NULL, '$[2]') |
+---------------------------------------------+
| "$[2].x"                                    |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%a%');</code></strong>
+-------------------------------+
| JSON_SEARCH(@j, 'all', '%a%') |
+-------------------------------+
| ["$[0]", "$[2].x"]            |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%');</code></strong>
+-------------------------------+
| JSON_SEARCH(@j, 'all', '%b%') |
+-------------------------------+
| ["$[0]", "$[2].x", "$[3].y"]  |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[0]');</code></strong>
+---------------------------------------------+
| JSON_SEARCH(@j, 'all', '%b%', NULL, '$[0]') |
+---------------------------------------------+
| "$[0]"                                      |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[2]');</code></strong>
+---------------------------------------------+
| JSON_SEARCH(@j, 'all', '%b%', NULL, '$[2]') |
+---------------------------------------------+
| "$[2].x"                                    |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[1]');</code></strong>
+---------------------------------------------+
| JSON_SEARCH(@j, 'all', '%b%', NULL, '$[1]') |
+---------------------------------------------+
| NULL                                        |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', '', '$[1]');</code></strong>
+-------------------------------------------+
| JSON_SEARCH(@j, 'all', '%b%', '', '$[1]') |
+-------------------------------------------+
| NULL                                      |
+-------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', '', '$[3]');</code></strong>
+-------------------------------------------+
| JSON_SEARCH(@j, 'all', '%b%', '', '$[3]') |
+-------------------------------------------+
| "$[3].y"                                  |
+-------------------------------------------+
</pre><p>
          ワイルドカード演算子 <code class="literal">*</code> および <code class="literal">**</code> を制御するルールなど、MySQL でサポートされている JSON パス構文の詳細は、<a class="xref" href="data-types.html#json-path-syntax" title="JSON パス構文">JSON パス構文</a> を参照してください。
        </p></li><li class="listitem"><a name="function_json-value"></a><p>
          <code class="literal">JSON_VALUE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>)</code>
        </p><a class="indexterm" name="idm46041615651232"></a><p>
          指定されたドキュメントで指定されたパスにある JSON ドキュメントから値を抽出し、抽出された値を返します。オプションで、必要なタイプに変換します。 完全な構文は次のとおりです: 
        </p><pre class="programlisting">JSON_VALUE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em> [RETURNING <em class="replaceable"><code>type</code></em>] [<em class="replaceable"><code>on_empty</code></em>] [<em class="replaceable"><code>on_error</code></em>])

<em class="replaceable"><code>on_empty</code></em>:
    {NULL | ERROR | DEFAULT <em class="replaceable"><code>value</code></em>} ON EMPTY

<em class="replaceable"><code>on_error</code></em>:
    {NULL | ERROR | DEFAULT <em class="replaceable"><code>value</code></em>} ON ERROR
</pre><p>
          <em class="replaceable"><code>json_doc</code></em> は有効な JSON ドキュメントです。
        </p><p>
          <em class="replaceable"><code>path</code></em> は、ドキュメント内の場所を指す JSON パスです。
        </p><p>
          <em class="replaceable"><code>type</code></em> は、次のいずれかのデータ型です:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">FLOAT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DOUBLE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DECIMAL</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SIGNED</code>
            </p></li><li class="listitem"><p>
              <code class="literal">UNSIGNED</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DATE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">TIME</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DATETIME</code>
            </p></li><li class="listitem"><p>
              <code class="literal">YEAR</code> (MySQL 8.0.22 以降)
            </p><p>
              1 桁または 2 桁の <code class="literal">YEAR</code> 値はサポートされていません。
            </p></li><li class="listitem"><p>
              <code class="literal">CHAR</code>
            </p></li><li class="listitem"><p>
              <code class="literal">JSON</code>
            </p></li></ul></div><p>
          リストされている型は、<code class="literal">CAST()</code> 関数でサポートされている (配列以外の) 型と同じです。
        </p><p>
          <code class="literal">RETURNING</code> 句で指定されていない場合、<code class="literal">JSON_VALUE()</code> 関数の戻り型は <code class="literal">VARCHAR(512)</code> です。 戻り型に文字セットが指定されていない場合、<code class="literal">JSON_VALUE()</code> はバイナリ照合順序で <code class="literal">utf8mb4</code> を使用します。これは大/小文字が区別されます。<code class="literal">utf8mb4</code> が結果の文字セットとして指定されている場合、サーバーはこの文字セットのデフォルト照合順序を使用しますが、大文字と小文字は区別されません。 
        </p><p>
          指定したパスのデータが JSON null リテラルで構成されているか、JSON NULL リテラルに解決されると、関数は SQL <code class="literal">NULL</code> を戻します。
        </p><p>
          <em class="replaceable"><code>on_empty</code></em> は、指定されたパスにデータが見つからない場合の <code class="literal">JSON_VALUE()</code> の動作を決定します。この句には、次のいずれかの値を指定します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL ON EMPTY</code>: この関数は <code class="literal">NULL</code> を戻します。これはデフォルトの <code class="literal">ON EMPTY</code> 動作です。
            </p></li><li class="listitem"><p>
              <code class="literal">DEFAULT <em class="replaceable"><code>value</code></em> ON EMPTY</code>: 指定された <em class="replaceable"><code>value</code></em> が返されます。 値の型は戻り値の型と一致する必要があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR ON EMPTY</code>: この関数はエラーをスローします。
            </p></li></ul></div><p>
          使用する場合、<em class="replaceable"><code>on_error</code></em> は、次に示すように、エラーが発生したときに対応する結果とともに次のいずれかの値を取ります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL ON ERROR</code>: <code class="literal">JSON_VALUE()</code> は <code class="literal">NULL</code> を返します。これは、<code class="literal">ON ERROR</code> 句が使用されていない場合のデフォルトの動作です。
            </p></li><li class="listitem"><p>
              <code class="literal">DEFAULT <em class="replaceable"><code>value</code></em> ON ERROR</code>: これは返される値です。その値は戻り型の値と一致する必要があります。
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR ON ERROR</code>: エラーがスローされます。
            </p></li></ul></div><p>
          <code class="literal">ON EMPTY</code> を使用する場合は、<code class="literal">ON ERROR</code> 句の前に置く必要があります。 間違った順序で指定すると、構文エラーが発生します。 
        </p><p><b>エラー処理. </b>
            通常、エラーは <code class="literal">JSON_VALUE()</code> によって次のように処理されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              すべての JSON 入力 (ドキュメントおよびパス) の有効性がチェックされます。 いずれかが有効でない場合、<code class="literal">ON ERROR</code> 句をトリガーせずに SQL エラーがスローされます。 
            </p></li><li class="listitem"><p>
              <code class="literal">ON ERROR</code> は、次のいずれかのイベントが発生するたびにトリガーされます:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  JSON ドキュメント内の複数の場所に解決されるパスから生成されたオブジェクトまたは配列を抽出しようとしています
                </p></li><li class="listitem"><p>
                  <code class="literal">'asdf'</code>を <code class="literal">UNSIGNED</code> 値に変換しようとするなどの変換エラー
                </p></li><li class="listitem"><p>
                  値の切捨て
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">NULL ON ERROR</code> または <code class="literal">DEFAULT ... ON ERROR</code> が指定されている場合でも、変換エラーによって常に警告がトリガーされます。
            </p></li><li class="listitem"><p>
              <code class="literal">ON EMPTY</code> 句は、ソース JSON ドキュメント (<em class="replaceable"><code>expr</code></em>) の指定した場所 (<em class="replaceable"><code>path</code></em>) にデータが含まれていない場合にトリガーされます。
            </p></li></ul></div><p>
          <code class="literal">JSON_VALUE()</code> は、MySQL 8.0.21 で導入されました。
        </p><p><b>例. </b>
            ここでは、2 つの簡単な例を示します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_VALUE('{"fname": "Joe", "lname": "Palmer"}', '$.fname');</code></strong>
+--------------------------------------------------------------+
| JSON_VALUE('{"fname": "Joe", "lname": "Palmer"}', '$.fname') |
+--------------------------------------------------------------+
| Joe                                                          |
+--------------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_VALUE('{"item": "shoes", "price": "49.95"}', '$.price'</code></strong>
    -&gt; <strong class="userinput"><code>RETURNING DECIMAL(4,2)) AS price;</code></strong>
+-------+
| price |
+-------+
| 49.95 |
+-------+
</pre><p>
          <code class="literal">SELECT JSON_VALUE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em> RETURNING <em class="replaceable"><code>type</code></em>)</code> というステートメントは、次のステートメントと同等です:
        </p><pre class="programlisting">SELECT CAST(
    JSON_UNQUOTE( JSON_EXTRACT(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>) )
    AS <em class="replaceable"><code>type</code></em>
);
</pre><p>
          <code class="literal">JSON_VALUE()</code> では、多くの場合、生成されたカラムを作成してから生成されたカラムのインデックスを作成する必要がなくなるため、JSON カラムのインデックスの作成が簡略化されます。 これを行うには、次に示すように、<code class="literal">JSON</code> カラムを含むテーブル <code class="literal">t1</code> を作成するときに、そのカラムで動作する <code class="literal">JSON_VALUE()</code> を使用する式にインデックスを作成します (そのカラムの値と一致するパスを使用): 
        </p><pre class="programlisting">CREATE TABLE t1(
    j JSON,
    INDEX i1 ( (JSON_VALUE(j, '$.id' RETURNING UNSIGNED)) )
);
</pre><p>
          次の <code class="literal">EXPLAIN</code> 出力は、<code class="literal">WHERE</code> 句でインデックス式を使用する <code class="literal">t1</code> に対するクエリーで、作成されたインデックスが使用されることを示しています:
        </p><pre class="programlisting">mysql&gt; EXPLAIN SELECT * FROM t1
    -&gt;     WHERE JSON_VALUE(j, '$.id' RETURNING UNSIGNED) = 123\G
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: t1
   partitions: NULL
         type: ref
possible_keys: i1
          key: i1
      key_len: 9
          ref: const
         rows: 1
     filtered: 100.00
        Extra: NULL
</pre><p>
          これは、次のように、生成されたカラム (<a class="xref" href="sql-statements.html#json-column-indirect-index" title="JSON カラムインデックスを提供するための生成されたカラムのインデックス付け">JSON カラムインデックスを提供するための生成されたカラムのインデックス付け</a> を参照) にインデックスを使用してテーブル <code class="literal">t2</code> を作成するのとほぼ同じ結果になります:
        </p><pre class="programlisting">CREATE TABLE t2 (
    j JSON,
    g INT GENERATED ALWAYS AS (j-&gt;"$.id"),
    INDEX i1 (j)
);
</pre><p>
          生成されたカラムを参照する、このテーブルに対するクエリーの <code class="literal">EXPLAIN</code> 出力は、テーブル <code class="literal">t1</code> に対する前述のクエリーと同じ方法でインデックスが使用されることを示しています:
        </p><pre class="programlisting">mysql&gt; EXPLAIN SELECT * FROM t2 WHERE g  = 123\G
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: t2
   partitions: NULL
         type: ref
possible_keys: i1
          key: i1
      key_len: 5
          ref: const
         rows: 1
     filtered: 100.00
        Extra: NULL
</pre><p>
          生成されたカラムに対するインデックスを使用した <code class="literal">JSON</code> カラムの間接インデックス付けの詳細は、<a class="xref" href="sql-statements.html#json-column-indirect-index" title="JSON カラムインデックスを提供するための生成されたカラムのインデックス付け">JSON カラムインデックスを提供するための生成されたカラムのインデックス付け</a> を参照してください。
        </p></li><li class="listitem"><a name="operator_member-of"></a><p>
          <code class="literal"><em class="replaceable"><code>value</code></em> MEMBER OF(<em class="replaceable"><code>json_array</code></em>)</code>
        </p><a class="indexterm" name="idm46041615536144"></a><p>
          <em class="replaceable"><code>value</code></em> が <em class="replaceable"><code>json_array</code></em> の要素である場合は true (1) を返し、それ以外の場合は false (0) を返します。<em class="replaceable"><code>value</code></em> はスカラーまたは JSON 文書である必要があります。スカラーの場合、演算子は JSON 配列の要素として処理しようとします。
        </p><p>
          <code class="literal">WHERE</code> 句の <code class="literal">InnoDB</code> テーブルの JSON カラムで <code class="literal">MEMBER OF()</code> を使用するクエリーは、複数値インデックスを使用して最適化できます。 詳細および例は、<a class="xref" href="sql-statements.html#create-index-multi-valued" title="複数値インデックス">複数値インデックス</a> を参照してください。 
        </p><p>
          単純なスカラーは、次に示すように配列値として扱われます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 17 MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong>
+-------------------------------------------+
| 17 MEMBER OF('[23, "abc", 17, "ab", 10]') |
+-------------------------------------------+
|                                         1 |
+-------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT 'ab' MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong>
+---------------------------------------------+
| 'ab' MEMBER OF('[23, "abc", 17, "ab", 10]') |
+---------------------------------------------+
|                                           1 |
+---------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          配列要素値の部分一致が一致しません:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 7 MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong>
+------------------------------------------+
| 7 MEMBER OF('[23, "abc", 17, "ab", 10]') |
+------------------------------------------+
|                                        0 |
+------------------------------------------+
1 row in set (0.00 sec)
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'a' MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong>
+--------------------------------------------+
| 'a' MEMBER OF('[23, "abc", 17, "ab", 10]') |
+--------------------------------------------+
|                                          0 |
+--------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          文字列型との間の変換は実行されません:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>17 MEMBER OF('[23, "abc", "17", "ab", 10]'),</code></strong>
    -&gt; <strong class="userinput"><code>"17" MEMBER OF('[23, "abc", 17, "ab", 10]')\G</code></strong>
*************************** 1. row ***************************
17 MEMBER OF('[23, "abc", "17", "ab", 10]'): 0
"17" MEMBER OF('[23, "abc", 17, "ab", 10]'): 0
1 row in set (0.00 sec)
</pre><p>
          この演算子をそれ自体が配列である値とともに使用するには、JSON 配列として明示的にキャストする必要があります。 これは、<code class="literal">CAST(... AS JSON)</code> で実行できます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CAST('[4,5]' AS JSON) MEMBER OF('[[3,4],[4,5]]');</code></strong>
+--------------------------------------------------+
| CAST('[4,5]' AS JSON) MEMBER OF('[[3,4],[4,5]]') |
+--------------------------------------------------+
|                                                1 |
+--------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          次のように、<code class="literal">JSON_ARRAY()</code> 関数を使用して必要なキャストを実行することもできます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY(4,5) MEMBER OF('[[3,4],[4,5]]');</code></strong>
+--------------------------------------------+
| JSON_ARRAY(4,5) MEMBER OF('[[3,4],[4,5]]') |
+--------------------------------------------+
|                                          1 |
+--------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          テストする値として使用される JSON オブジェクト、またはターゲット配列に表示される JSON オブジェクトは、<code class="literal">CAST(... AS JSON)</code> または <code class="literal">JSON_OBJECT()</code> を使用して正しい型に強制変換する必要があります。 また、JSON オブジェクトを含むターゲット配列自体は、<code class="literal">JSON_ARRAY</code> を使用してキャストする必要があります。 これは、次の一連のステートメントで示されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @a = CAST('{"a":1}' AS JSON);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @b = JSON_OBJECT("b", 2);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @c = JSON_ARRAY(17, @b, "abc", @a, 23);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @a MEMBER OF(@c), @b MEMBER OF(@c);</code></strong>
+------------------+------------------+
| @a MEMBER OF(@c) | @b MEMBER OF(@c) |
+------------------+------------------+
|                1 |                1 |
+------------------+------------------+
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">MEMBER OF()</code> 演算子が MySQL 8.0.17 に追加されました。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-modification-functions"></a>12.18.4 JSON 値を変更する関数</h3></div></div></div><p>
      このセクションの関数は、JSON 値を変更して結果を返します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-array-append"></a><p>
          <code class="literal">JSON_ARRAY_APPEND(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615489088"></a><p>
          JSON ドキュメント内の指定された配列の末尾に値を追加し、結果を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          パスと値のペアは左から右に評価されます。 あるペアを評価して生成されたドキュメントは、次のペアが評価される新しい値になります。 
        </p><p>
          パスがスカラー値またはオブジェクト値を選択すると、その値は配列内で自動ラップされ、新しい値がその配列に追加されます。 パスが JSON ドキュメント内の値を識別しないペアは無視されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '["a", ["b", "c"], "d"]';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[1]', 1);</code></strong>
+----------------------------------+
| JSON_ARRAY_APPEND(@j, '$[1]', 1) |
+----------------------------------+
| ["a", ["b", "c", 1], "d"]        |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[0]', 2);</code></strong>
+----------------------------------+
| JSON_ARRAY_APPEND(@j, '$[0]', 2) |
+----------------------------------+
| [["a", 2], ["b", "c"], "d"]      |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[1][0]', 3);</code></strong>
+-------------------------------------+
| JSON_ARRAY_APPEND(@j, '$[1][0]', 3) |
+-------------------------------------+
| ["a", [["b", 3], "c"], "d"]         |
+-------------------------------------+

mysql&gt; <strong class="userinput"><code>SET @j = '{"a": 1, "b": [2, 3], "c": 4}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$.b', 'x');</code></strong>
+------------------------------------+
| JSON_ARRAY_APPEND(@j, '$.b', 'x')  |
+------------------------------------+
| {"a": 1, "b": [2, 3, "x"], "c": 4} |
+------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$.c', 'y');</code></strong>
+--------------------------------------+
| JSON_ARRAY_APPEND(@j, '$.c', 'y')    |
+--------------------------------------+
| {"a": 1, "b": [2, 3], "c": [4, "y"]} |
+--------------------------------------+

mysql&gt; <strong class="userinput"><code>SET @j = '{"a": 1}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$', 'z');</code></strong>
+---------------------------------+
| JSON_ARRAY_APPEND(@j, '$', 'z') |
+---------------------------------+
| [{"a": 1}, "z"]                 |
+---------------------------------+
</pre><p>
          MySQL 5.7 では、この関数は <code class="literal">JSON_APPEND()</code> という名前でした。 この名前は、MySQL 8.0 ではサポートされなくなりました。 
        </p></li><li class="listitem"><a name="function_json-array-insert"></a><p>
          <code class="literal">JSON_ARRAY_INSERT(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615461104"></a><p>
          JSON ドキュメントを更新し、ドキュメント内の配列に挿入して、変更されたドキュメントを返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードを含んでいるか、配列要素識別子で終わらない場合、エラーが発生します。 
        </p><p>
          パスと値のペアは左から右に評価されます。 あるペアを評価して生成されたドキュメントは、次のペアが評価される新しい値になります。 
        </p><p>
          パスが JSON ドキュメント内の配列を識別しないペアは無視されます。 パスが配列要素を識別する場合、対応する値がその要素の位置に挿入され、後続の値は右にシフトされます。 パスが配列の末尾より後の配列位置を識別した場合、配列の末尾に値が挿入されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '["a", {"b": [1, 2]}, [3, 4]]';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[1]', 'x');</code></strong>
+------------------------------------+
| JSON_ARRAY_INSERT(@j, '$[1]', 'x') |
+------------------------------------+
| ["a", "x", {"b": [1, 2]}, [3, 4]]  |
+------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[100]', 'x');</code></strong>
+--------------------------------------+
| JSON_ARRAY_INSERT(@j, '$[100]', 'x') |
+--------------------------------------+
| ["a", {"b": [1, 2]}, [3, 4], "x"]    |
+--------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[1].b[0]', 'x');</code></strong>
+-----------------------------------------+
| JSON_ARRAY_INSERT(@j, '$[1].b[0]', 'x') |
+-----------------------------------------+
| ["a", {"b": ["x", 1, 2]}, [3, 4]]       |
+-----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[2][1]', 'y');</code></strong>
+---------------------------------------+
| JSON_ARRAY_INSERT(@j, '$[2][1]', 'y') |
+---------------------------------------+
| ["a", {"b": [1, 2]}, [3, "y", 4]]     |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[0]', 'x', '$[2][1]', 'y');</code></strong>
+----------------------------------------------------+
| JSON_ARRAY_INSERT(@j, '$[0]', 'x', '$[2][1]', 'y') |
+----------------------------------------------------+
| ["x", "a", {"b": [1, 2]}, [3, 4]]                  |
+----------------------------------------------------+
</pre><p>
          以前の変更は配列内の次の要素の位置に影響するため、同じ <code class="literal">JSON_ARRAY_INSERT()</code> コール内の後続のパスでこれを考慮する必要があります。 最後の例では、最初の挿入後にパスが何にも一致しなくなったため、2 番目のパスは何も挿入しません。 
        </p></li><li class="listitem"><a name="function_json-insert"></a><p>
          <code class="literal">JSON_INSERT(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615434720"></a><p>
          JSON ドキュメントにデータを挿入し、結果を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          パスと値のペアは左から右に評価されます。 あるペアを評価して生成されたドキュメントは、次のペアが評価される新しい値になります。 
        </p><p>
          ドキュメント内の既存のパスのパスと値のペアは無視され、既存のドキュメント値は上書きされません。 パスが次のいずれかのタイプの値を識別する場合、ドキュメント内の存在しないパスのパスと値のペアによって、ドキュメントに値が追加されます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              既存のオブジェクトにメンバーが存在しません。 メンバーがオブジェクトに追加され、新しい値に関連付けられます。 
            </p></li><li class="listitem"><p>
              既存の配列の末尾を越えた位置。 配列は新しい値で拡張されます。 既存の値が配列でない場合は、配列として自動ラップされ、新しい値で拡張されます。 
            </p></li></ul></div><p>
          それ以外の場合、ドキュメント内に存在しないパスのパスと値のペアは無視され、効果はありません。
        </p><p>
          <code class="literal">JSON_INSERT()</code>、<code class="literal">JSON_REPLACE()</code> および <code class="literal">JSON_SET()</code> の比較は、<code class="literal">JSON_SET()</code> の説明を参照してください。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]');</code></strong>
+----------------------------------------------------+
| JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]') |
+----------------------------------------------------+
| {"a": 1, "b": [2, 3], "c": "[true, false]"}        |
+----------------------------------------------------+
</pre><p>
          結果にリストされている 3 番目と最後の値は引用符で囲まれた文字列であり、2 番目の値 (出力で引用符で囲まれていない) のような配列ではありません。JSON 型への値のキャストは実行されません。 配列を配列として挿入するには、次に示すように、このようなキャストを明示的に実行する必要があります: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', CAST('[true, false]' AS JSON));</code></strong>
+------------------------------------------------------------------+
| JSON_INSERT(@j, '$.a', 10, '$.c', CAST('[true, false]' AS JSON)) |
+------------------------------------------------------------------+
| {"a": 1, "b": [2, 3], "c": [true, false]}                        |
+------------------------------------------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_json-merge"></a><p>
          <code class="literal">JSON_MERGE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>json_doc</code></em>[, <em class="replaceable"><code>json_doc</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615404992"></a><p>
          複数の JSON ドキュメントをマージします。 <code class="literal">JSON_MERGE_PRESERVE()</code> のシノニムです。MySQL 8.0.3 では非推奨であり、将来のリリースで削除される可能性があります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE('[1, 2]', '[true, false]');</code></strong>
+---------------------------------------+
| JSON_MERGE('[1, 2]', '[true, false]') |
+---------------------------------------+
| [1, 2, true, false]                   |
+---------------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1287
Message: 'JSON_MERGE' is deprecated and will be removed in a future release. \
 Please use JSON_MERGE_PRESERVE/JSON_MERGE_PATCH instead
1 row in set (0.00 sec)
</pre><p>
          その他の例については、<code class="literal">JSON_MERGE_PRESERVE()</code> のエントリを参照してください。
        </p></li><li class="listitem"><a name="function_json-merge-patch"></a><p>
          <code class="literal">JSON_MERGE_PATCH(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>json_doc</code></em>[, <em class="replaceable"><code>json_doc</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615389216"></a><p>
          複数の JSON ドキュメントの <a class="ulink" href="https://tools.ietf.org/html/rfc7396" target="_top">RFC 7396</a> 準拠マージを実行し、重複するキーを持つメンバーを保持せずにマージ結果を返します。 この関数に引数として渡されたドキュメントのいずれかが無効な場合は、エラーが発生します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            この関数と <code class="literal">JSON_MERGE_PRESERVE()</code> の違いの説明および例は、<a class="xref" href="functions.html#json-merge-patch-json-merge-preserve-compared" title="JSON_MERGE_PATCH() と JSON_MERGE_PRESERVE() の比較">JSON_MERGE_PATCH() と JSON_MERGE_PRESERVE() の比較</a> を参照してください。
          </p></div><p>
          <code class="literal">JSON_MERGE_PATCH()</code> は、次のようにマージを実行します:
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              最初の引数がオブジェクトでない場合、マージの結果は、空のオブジェクトが 2 番目の引数とマージされた場合と同じになります。
            </p></li><li class="listitem"><p>
              2 番目の引数がオブジェクトでない場合、マージの結果は 2 番目の引数になります。
            </p></li><li class="listitem"><p>
              両方の引数がオブジェクトの場合、マージの結果は次のメンバーを持つオブジェクトになります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  2 番目のオブジェクトに同じキーを持つ対応するメンバを持たない、1 番目のオブジェクトのすべてのメンバ。
                </p></li><li class="listitem"><p>
                  最初のオブジェクトに対応するキーがなく、値が JSON <code class="literal">null</code> リテラルではない、2 番目のオブジェクトのすべてのメンバー。
                </p></li><li class="listitem"><p>
                  最初と 2 番目の両方のオブジェクトに存在し、2 番目のオブジェクトの値が JSON <code class="literal">null</code> リテラルではないキーを持つすべてのメンバー。 これらのメンバーの値は、最初のオブジェクトの値を 2 番目のオブジェクトの値と再帰的にマージした結果です。 
                </p></li></ul></div></li></ol></div><p>
          追加情報については <a class="xref" href="data-types.html#json-normalization" title="JSON 値の正規化、マージおよび自動ラップ">JSON 値の正規化、マージおよび自動ラップ</a>を参照してください。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('[1, 2]', '[true, false]');</code></strong>
+---------------------------------------------+
| JSON_MERGE_PATCH('[1, 2]', '[true, false]') |
+---------------------------------------------+
| [true, false]                               |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"name": "x"}', '{"id": 47}');</code></strong>
+-------------------------------------------------+
| JSON_MERGE_PATCH('{"name": "x"}', '{"id": 47}') |
+-------------------------------------------------+
| {"id": 47, "name": "x"}                         |
+-------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('1', 'true');</code></strong>
+-------------------------------+
| JSON_MERGE_PATCH('1', 'true') |
+-------------------------------+
| true                          |
+-------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('[1, 2]', '{"id": 47}');</code></strong>
+------------------------------------------+
| JSON_MERGE_PATCH('[1, 2]', '{"id": 47}') |
+------------------------------------------+
| {"id": 47}                               |
+------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{ "a": 1, "b":2 }',</code></strong>
     &gt;     <strong class="userinput"><code>'{ "a": 3, "c":4 }');</code></strong>
+-----------------------------------------------------------+
| JSON_MERGE_PATCH('{ "a": 1, "b":2 }','{ "a": 3, "c":4 }') |
+-----------------------------------------------------------+
| {"a": 3, "b": 2, "c": 4}                                  |
+-----------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{ "a": 1, "b":2 }','{ "a": 3, "c":4 }',</code></strong>
     &gt;     <strong class="userinput"><code>'{ "a": 5, "d":6 }');</code></strong>
+-------------------------------------------------------------------------------+
| JSON_MERGE_PATCH('{ "a": 1, "b":2 }','{ "a": 3, "c":4 }','{ "a": 5, "d":6 }') |
+-------------------------------------------------------------------------------+
| {"a": 5, "b": 2, "c": 4, "d": 6}                                              |
+-------------------------------------------------------------------------------+
</pre><p>
          この関数を使用してメンバーを削除するには、次に示すように、seond 引数で同じメンバーの値として <code class="literal">null</code> を指定します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"a":1, "b":2}', '{"b":null}');</code></strong>
+--------------------------------------------------+
| JSON_MERGE_PATCH('{"a":1, "b":2}', '{"b":null}') |
+--------------------------------------------------+
| {"a": 1}                                         |
+--------------------------------------------------+
</pre><p>
          この例は、関数が再帰的に動作することを示しています。つまり、メンバーの値はスカラーに制限されず、JSON ドキュメントにすることもできます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"a":{"x":1}}', '{"a":{"y":2}}');</code></strong>
+----------------------------------------------------+
| JSON_MERGE_PATCH('{"a":{"x":1}}', '{"a":{"y":2}}') |
+----------------------------------------------------+
| {"a": {"x": 1, "y": 2}}                            |
+----------------------------------------------------+
</pre><p>
          <code class="literal">JSON_MERGE_PATCH()</code> は、MySQL 8.0.3 以降でサポートされます。
        </p><p><a name="json-merge-patch-json-merge-preserve-compared"></a><b>JSON_MERGE_PATCH() と JSON_MERGE_PRESERVE() の比較. </b>
            <code class="literal">JSON_MERGE_PATCH()</code> の動作は <code class="literal">JSON_MERGE_PRESERVE()</code> の動作と同じですが、次の 2 つの例外があります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              2 番目のオブジェクト内のキーに関連付けられた値が JSON <code class="literal">null</code> でない場合、<code class="literal">JSON_MERGE_PATCH()</code> は、2 番目のオブジェクト内の一致するキーを持つ最初のオブジェクト内のメンバーを削除します。
            </p></li><li class="listitem"><p>
              2 つ目のオブジェクトに、最初のオブジェクトのメンバーと一致するキーを持つメンバーがある場合、<code class="literal">JSON_MERGE_PATCH()</code> <span class="emphasis"><em>replaces</em></span> は最初のオブジェクトの値を 2 つ目のオブジェクトの値と照合し、<code class="literal">JSON_MERGE_PRESERVE()</code> <span class="emphasis"><em>appends</em></span> は 2 つ目の値を最初の値と照合します。
            </p></li></ul></div><p>
          この例では、同じ 3 つの JSON オブジェクトをマージした結果を比較します。それぞれに一致するキー<code class="literal">"a"</code>があり、次の 2 つの関数があります:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @x = '{ "a": 1, "b": 2 }',</code></strong>
     &gt;     <strong class="userinput"><code>@y = '{ "a": 3, "c": 4 }',</code></strong>
     &gt;     <strong class="userinput"><code>@z = '{ "a": 5, "d": 6 }';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT  JSON_MERGE_PATCH(@x, @y, @z)    AS Patch,</code></strong>
    -&gt;         <strong class="userinput"><code>JSON_MERGE_PRESERVE(@x, @y, @z) AS Preserve\G</code></strong>
*************************** 1. row ***************************
   Patch: {"a": 5, "b": 2, "c": 4, "d": 6}
Preserve: {"a": [1, 3, 5], "b": 2, "c": 4, "d": 6}
</pre></li><li class="listitem"><a name="function_json-merge-preserve"></a><p>
          <code class="literal">JSON_MERGE_PRESERVE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>json_doc</code></em>[, <em class="replaceable"><code>json_doc</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615329472"></a><p>
          複数の JSON ドキュメントをマージし、マージ結果を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 引数が有効な JSON ドキュメントでない場合は、エラーが発生します。 
        </p><p>
          マージは、次のルールに従って行われます。 追加情報については <a class="xref" href="data-types.html#json-normalization" title="JSON 値の正規化、マージおよび自動ラップ">JSON 値の正規化、マージおよび自動ラップ</a>を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              隣接する配列は単一の配列にマージされます。
            </p></li><li class="listitem"><p>
              隣接するオブジェクトは単一のオブジェクトにマージされます。
            </p></li><li class="listitem"><p>
              スカラー値は配列として自動ラップされ、配列としてマージされます。
            </p></li><li class="listitem"><p>
              隣接する配列とオブジェクトをマージするには、オブジェクトを配列として自動ラップし、2 つの配列をマージします。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('[1, 2]', '[true, false]');</code></strong>
+------------------------------------------------+
| JSON_MERGE_PRESERVE('[1, 2]', '[true, false]') |
+------------------------------------------------+
| [1, 2, true, false]                            |
+------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{"name": "x"}', '{"id": 47}');</code></strong>
+----------------------------------------------------+
| JSON_MERGE_PRESERVE('{"name": "x"}', '{"id": 47}') |
+----------------------------------------------------+
| {"id": 47, "name": "x"}                            |
+----------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('1', 'true');</code></strong>
+----------------------------------+
| JSON_MERGE_PRESERVE('1', 'true') |
+----------------------------------+
| [1, true]                        |
+----------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('[1, 2]', '{"id": 47}');</code></strong>
+---------------------------------------------+
| JSON_MERGE_PRESERVE('[1, 2]', '{"id": 47}') |
+---------------------------------------------+
| [1, 2, {"id": 47}]                          |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }',</code></strong>
     &gt;    <strong class="userinput"><code>'{ "a": 3, "c": 4 }');</code></strong>
+--------------------------------------------------------------+
| JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }','{ "a": 3, "c":4 }') |
+--------------------------------------------------------------+
| {"a": [1, 3], "b": 2, "c": 4}                                |
+--------------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }','{ "a": 3, "c": 4 }',</code></strong>
     &gt;    <strong class="userinput"><code>'{ "a": 5, "d": 6 }');</code></strong>
+----------------------------------------------------------------------------------+
| JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }','{ "a": 3, "c": 4 }','{ "a": 5, "d": 6 }') |
+----------------------------------------------------------------------------------+
| {"a": [1, 3, 5], "b": 2, "c": 4, "d": 6}                                         |
+----------------------------------------------------------------------------------+
</pre><p>
          この関数は、<code class="literal">JSON_MERGE()</code> のシノニムとして MySQL 8.0.3 に追加されました。 <code class="literal">JSON_MERGE()</code> 関数は非推奨になり、MySQL の将来のリリースで削除される予定です。 
        </p><p>
          この関数は、<code class="literal">JSON_MERGE_PATCH()</code> と似ていますが、重要な点で異なります。詳細は、<a class="xref" href="functions.html#json-merge-patch-json-merge-preserve-compared" title="JSON_MERGE_PATCH() と JSON_MERGE_PRESERVE() の比較">JSON_MERGE_PATCH() と JSON_MERGE_PRESERVE() の比較</a> を参照してください。
        </p></li><li class="listitem"><a name="function_json-remove"></a><p>
          <code class="literal">JSON_REMOVE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>[, <em class="replaceable"><code>path</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615297120"></a><p>
          JSON ドキュメントからデータを削除し、結果を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">$</code> であるか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          <em class="replaceable"><code>path</code></em> 引数は左から右に評価されます。 あるパスを評価して生成されたドキュメントは、次のパスが評価される新しい値になります。 
        </p><p>
          削除する要素がドキュメントに存在しない場合、エラーにはなりません。その場合、パスはドキュメントに影響しません。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '["a", ["b", "c"], "d"]';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_REMOVE(@j, '$[1]');</code></strong>
+-------------------------+
| JSON_REMOVE(@j, '$[1]') |
+-------------------------+
| ["a", "d"]              |
+-------------------------+
</pre></li><li class="listitem"><a name="function_json-replace"></a><p>
          <code class="literal">JSON_REPLACE(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615276992"></a><p>
          JSON ドキュメント内の既存の値を置換し、結果を返します。 引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          パスと値のペアは左から右に評価されます。 あるペアを評価して生成されたドキュメントは、次のペアが評価される新しい値になります。 
        </p><p>
          ドキュメント内の既存のパスのパスと値のペアによって、既存のドキュメント値が新しい値で上書きされます。 ドキュメント内に存在しないパスのパスと値のペアは無視され、効果はありません。 
        </p><p>
          MySQL 8.0.4 では、オプティマイザは、古いドキュメントを削除して新しいドキュメント全体をカラムに書き込むかわりに、<code class="literal">JSON</code> カラムの部分的なインプレース更新を実行できます。 この最適化は、<code class="literal">JSON_REPLACE()</code> 関数を使用し、<a class="xref" href="data-types.html#json-partial-updates" title="JSON 値の部分更新">JSON 値の部分更新</a> で説明されている条件を満たす UPDATE ステートメントに対して実行できます。 
        </p><p>
          <code class="literal">JSON_INSERT()</code>、<code class="literal">JSON_REPLACE()</code> および <code class="literal">JSON_SET()</code> の比較は、<code class="literal">JSON_SET()</code> の説明を参照してください。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]');</code></strong>
+-----------------------------------------------------+
| JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]') |
+-----------------------------------------------------+
| {"a": 10, "b": [2, 3]}                              |
+-----------------------------------------------------+
</pre></li><li class="listitem"><a name="function_json-set"></a><p>
          <code class="literal">JSON_SET(<em class="replaceable"><code>json_doc</code></em>, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>[, <em class="replaceable"><code>path</code></em>, <em class="replaceable"><code>val</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041615249536"></a><p>
          JSON ドキュメントのデータを挿入または更新し、結果を返します。 いずれかの引数が <code class="literal">NULL</code> または <em class="replaceable"><code>path</code></em> の場合、<code class="literal">NULL</code> を戻します (指定されている場合)。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          パスと値のペアは左から右に評価されます。 あるペアを評価して生成されたドキュメントは、次のペアが評価される新しい値になります。 
        </p><p>
          ドキュメント内の既存のパスのパスと値のペアによって、既存のドキュメント値が新しい値で上書きされます。 パスが次のいずれかのタイプの値を識別する場合、ドキュメント内の存在しないパスのパスと値のペアによって、ドキュメントに値が追加されます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              既存のオブジェクトにメンバーが存在しません。 メンバーがオブジェクトに追加され、新しい値に関連付けられます。 
            </p></li><li class="listitem"><p>
              既存の配列の末尾を越えた位置。 配列は新しい値で拡張されます。 既存の値が配列でない場合は、配列として自動ラップされ、新しい値で拡張されます。 
            </p></li></ul></div><p>
          それ以外の場合、ドキュメント内に存在しないパスのパスと値のペアは無視され、効果はありません。
        </p><p>
          MySQL 8.0.4 では、オプティマイザは、古いドキュメントを削除して新しいドキュメント全体をカラムに書き込むかわりに、<code class="literal">JSON</code> カラムの部分的なインプレース更新を実行できます。 この最適化は、<code class="literal">JSON_SET()</code> 関数を使用し、<a class="xref" href="data-types.html#json-partial-updates" title="JSON 値の部分更新">JSON 値の部分更新</a> で説明されている条件を満たす UPDATE ステートメントに対して実行できます。 
        </p><p>
          <code class="literal">JSON_SET()</code>、<code class="literal">JSON_INSERT()</code> および <code class="literal">JSON_REPLACE()</code> 関数が関連しています:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">JSON_SET()</code> では、既存の値が置換され、存在しない値が追加されます。
            </p></li><li class="listitem"><p>
              <code class="literal">JSON_INSERT()</code> は、既存の値を置換せずに値を挿入します。
            </p></li><li class="listitem"><p>
              <code class="literal">JSON_REPLACE()</code> は、<span class="emphasis"><em>のみ</em></span>の既存の値を置き換えます。
            </p></li></ul></div><p>
          次の例では、ドキュメント (<code class="literal">$.a</code>) に存在するパスと存在しないパス (<code class="literal">$.c</code>) を使用して、これらの違いを示します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_SET(@j, '$.a', 10, '$.c', '[true, false]');</code></strong>
+-------------------------------------------------+
| JSON_SET(@j, '$.a', 10, '$.c', '[true, false]') |
+-------------------------------------------------+
| {"a": 10, "b": [2, 3], "c": "[true, false]"}    |
+-------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]');</code></strong>
+----------------------------------------------------+
| JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]') |
+----------------------------------------------------+
| {"a": 1, "b": [2, 3], "c": "[true, false]"}        |
+----------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]');</code></strong>
+-----------------------------------------------------+
| JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]') |
+-----------------------------------------------------+
| {"a": 10, "b": [2, 3]}                              |
+-----------------------------------------------------+
</pre></li><li class="listitem"><a name="function_json-unquote"></a><p>
          <code class="literal">JSON_UNQUOTE(<em class="replaceable"><code>json_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041615209472"></a><p>
          JSON 値を引用符で囲まずに、結果を <code class="literal">utf8mb4</code> 文字列として返します。 引数が <code class="literal">NULL</code> の場合、<code class="literal">NULL</code> を返します。 値の先頭と末尾が二重引用符であるが、有効な JSON 文字列リテラルではない場合、エラーが発生します。 
        </p><p>
          <code class="literal">NO_BACKSLASH_ESCAPES</code> SQL モードが有効になっている場合を除いて、一部のシーケンスが文字列内で特別な意味を持ちます。 これらのシーケンスはいずれも、<span class="emphasis"><em>エスケープ文字</em></span>として知られるバックスラッシュ (<code class="literal">\</code>) で始まります。 MySQL は、<a class="xref" href="functions.html#json-unquote-character-escape-sequences" title="表 12.23 JSON_UNQUOTE() 特殊文字エスケープシーケンス">表12.23「JSON_UNQUOTE() 特殊文字エスケープシーケンス」</a>に示すエスケープシーケンスを認識します。 ほかのすべてのエスケープシーケンスでは、バックスラッシュは無視されます。 つまり、エスケープされた文字がエスケープされていないと解釈されます。 たとえば、<code class="literal">\x</code> は単なる <code class="literal">x</code> です。 これらの順序では、大/小文字が区別されます。 たとえば、<code class="literal">\b</code> はバックスペースとして解釈されますが、<code class="literal">\B</code> は <code class="literal">B</code> として解釈されます。 
        </p><div class="table"><a name="json-unquote-character-escape-sequences"></a><p class="title"><b>表 12.23 JSON_UNQUOTE() 特殊文字エスケープシーケンス</b></p><div class="table-contents"><table><col style="width: 15%"><col style="width: 85%"><thead><tr>
              <th>エスケープシーケンス</th>
              <th>シーケンスが表す文字</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">"</code><a class="indexterm" name="idm46041615188736"></a><a class="indexterm" name="idm46041615187376"></a></td>
              <td>二重引用符 (<code class="literal">"</code>) 文字</td>
            </tr><tr>
              <td><code class="literal">\b</code> <a class="indexterm" name="idm46041615182896"></a> <a class="indexterm" name="idm46041615181808"></a></td>
              <td>バックスペース文字</td>
            </tr><tr>
              <td><code class="literal">\f</code><a class="indexterm" name="idm46041615177952"></a><a class="indexterm" name="idm46041615176736"></a></td>
              <td>フォームフィード文字</td>
            </tr><tr>
              <td><code class="literal">\n</code><a class="indexterm" name="idm46041615172960"></a><a class="indexterm" name="idm46041615171744"></a><a class="indexterm" name="idm46041615170528"></a><a class="indexterm" name="idm46041615169312"></a></td>
              <td>改行 (ラインフィード) 文字</td>
            </tr><tr>
              <td><code class="literal">\r</code> <a class="indexterm" name="idm46041615165408"></a> <a class="indexterm" name="idm46041615163888"></a> <a class="indexterm" name="idm46041615162912"></a></td>
              <td>復帰改行文字</td>
            </tr><tr>
              <td><code class="literal">\t</code><a class="indexterm" name="idm46041615159120"></a><a class="indexterm" name="idm46041615157904"></a></td>
              <td>タブ文字</td>
            </tr><tr>
              <td><code class="literal">\\</code><a class="indexterm" name="idm46041615154144"></a><a class="indexterm" name="idm46041615152784"></a></td>
              <td>バックスラッシュ (<code class="literal">\</code>) 文字</td>
            </tr><tr>
              <td><code class="literal">\u<em class="replaceable"><code>XXXX</code></em></code> <a class="indexterm" name="idm46041615148016"></a> <a class="indexterm" name="idm46041615146544"></a></td>
              <td>UTF-8Unicode 値 <em class="replaceable"><code>XXXX</code></em> のバイト数</td>
            </tr></tbody></table></div></div><br class="table-break"><p>
          この関数の 2 つの簡単な使用例を次に示します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '"abc"';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_UNQUOTE(@j);</code></strong>
+-------+------------------+
| @j    | JSON_UNQUOTE(@j) |
+-------+------------------+
| "abc" | abc              |
+-------+------------------+
mysql&gt; <strong class="userinput"><code>SET @j = '[1, 2, 3]';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_UNQUOTE(@j);</code></strong>
+-----------+------------------+
| @j        | JSON_UNQUOTE(@j) |
+-----------+------------------+
| [1, 2, 3] | [1, 2, 3]        |
+-----------+------------------+
</pre><p>
          次の一連の例は、<code class="literal">NO_BACKSLASH_ESCAPES</code> を無効にして有効にした場合に <code class="literal">JSON_UNQUOTE</code> がエスケープを処理する方法を示しています:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @@sql_mode;</code></strong>
+------------+
| @@sql_mode |
+------------+
|            |
+------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_UNQUOTE('"\\t\\u0032"');</code></strong>
+------------------------------+
| JSON_UNQUOTE('"\\t\\u0032"') |
+------------------------------+
|       2                           |
+------------------------------+

mysql&gt; <strong class="userinput"><code>SET @@sql_mode = 'NO_BACKSLASH_ESCAPES';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_UNQUOTE('"\\t\\u0032"');</code></strong>
+------------------------------+
| JSON_UNQUOTE('"\\t\\u0032"') |
+------------------------------+
| \t\u0032                     |
+------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_UNQUOTE('"\t\u0032"');</code></strong>
+----------------------------+
| JSON_UNQUOTE('"\t\u0032"') |
+----------------------------+
|       2                         |
+----------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-attribute-functions"></a>12.18.5 JSON 値属性を返す関数</h3></div></div></div><p>
      このセクションの関数は、JSON 値の属性を戻します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-depth"></a><p>
          <code class="literal">JSON_DEPTH(<em class="replaceable"><code>json_doc</code></em>)</code>
        </p><a class="indexterm" name="idm46041615122720"></a><p>
          JSON ドキュメントの最大深度を返します。 引数が <code class="literal">NULL</code> の場合、<code class="literal">NULL</code> を返します。 引数が有効な JSON ドキュメントでない場合は、エラーが発生します。 
        </p><p>
          空の配列、空のオブジェクトまたはスカラー値の深さは 1 です。 深さ 1 の要素のみを含む空でない配列、または深さ 1 のメンバー値のみを含む空でないオブジェクトは深さ 2 です。 それ以外の場合、JSON ドキュメントの深さは 2 より大きくなります。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_DEPTH('{}'), JSON_DEPTH('[]'), JSON_DEPTH('true');</code></strong>
+------------------+------------------+--------------------+
| JSON_DEPTH('{}') | JSON_DEPTH('[]') | JSON_DEPTH('true') |
+------------------+------------------+--------------------+
|                1 |                1 |                  1 |
+------------------+------------------+--------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_DEPTH('[10, 20]'), JSON_DEPTH('[[], {}]');</code></strong>
+------------------------+------------------------+
| JSON_DEPTH('[10, 20]') | JSON_DEPTH('[[], {}]') |
+------------------------+------------------------+
|                      2 |                      2 |
+------------------------+------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_DEPTH('[10, {"a": 20}]');</code></strong>
+-------------------------------+
| JSON_DEPTH('[10, {"a": 20}]') |
+-------------------------------+
|                             3 |
+-------------------------------+
</pre></li><li class="listitem"><a name="function_json-length"></a><p>
          <code class="literal">JSON_LENGTH(<em class="replaceable"><code>json_doc</code></em>[, <em class="replaceable"><code>path</code></em>])</code>
        </p><a class="indexterm" name="idm46041615106048"></a><p>
          JSON ドキュメントの長さを戻します。<em class="replaceable"><code>path</code></em> 引数が指定されている場合は、パスで識別されるドキュメント内の値の長さを戻します。 いずれかの引数が <code class="literal">NULL</code> の場合、または <em class="replaceable"><code>path</code></em> 引数がドキュメント内の値を識別しない場合、<code class="literal">NULL</code> を返します。 <em class="replaceable"><code>json_doc</code></em> 引数が有効な JSON ドキュメントでないか、<em class="replaceable"><code>path</code></em> 引数が有効なパス式でないか、<code class="literal">*</code> または <code class="literal">**</code> ワイルドカードが含まれている場合、エラーが発生します。 
        </p><p>
          ドキュメントの長さは次のように決定されます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              スカラーの長さは 1 です。
            </p></li><li class="listitem"><p>
              配列の長さは配列要素の数です。
            </p></li><li class="listitem"><p>
              オブジェクトの長さは、オブジェクトメンバーの数です。
            </p></li><li class="listitem"><p>
              長さは、ネストされた配列またはオブジェクトの長さをカウントしません。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_LENGTH('[1, 2, {"a": 3}]');</code></strong>
+---------------------------------+
| JSON_LENGTH('[1, 2, {"a": 3}]') |
+---------------------------------+
|                               3 |
+---------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_LENGTH('{"a": 1, "b": {"c": 30}}');</code></strong>
+-----------------------------------------+
| JSON_LENGTH('{"a": 1, "b": {"c": 30}}') |
+-----------------------------------------+
|                                       2 |
+-----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_LENGTH('{"a": 1, "b": {"c": 30}}', '$.b');</code></strong>
+------------------------------------------------+
| JSON_LENGTH('{"a": 1, "b": {"c": 30}}', '$.b') |
+------------------------------------------------+
|                                              1 |
+------------------------------------------------+
</pre></li><li class="listitem"><a name="function_json-type"></a><p>
          <code class="literal">JSON_TYPE(<em class="replaceable"><code>json_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041615082528"></a><p>
          JSON 値のタイプを示す <code class="literal">utf8mb4</code> 文字列を返します。 次に示すように、オブジェクト型、配列型またはスカラー型を指定できます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{"a": [10, true]}';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(@j);</code></strong>
+---------------+
| JSON_TYPE(@j) |
+---------------+
| OBJECT        |
+---------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a'));</code></strong>
+------------------------------------+
| JSON_TYPE(JSON_EXTRACT(@j, '$.a')) |
+------------------------------------+
| ARRAY                              |
+------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a[0]'));</code></strong>
+---------------------------------------+
| JSON_TYPE(JSON_EXTRACT(@j, '$.a[0]')) |
+---------------------------------------+
| INTEGER                               |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a[1]'));</code></strong>
+---------------------------------------+
| JSON_TYPE(JSON_EXTRACT(@j, '$.a[1]')) |
+---------------------------------------+
| BOOLEAN                               |
+---------------------------------------+
</pre><p>
          引数が <code class="literal">NULL</code> の場合、<code class="literal">JSON_TYPE()</code> は <code class="literal">NULL</code> を返します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(NULL);</code></strong>
+-----------------+
| JSON_TYPE(NULL) |
+-----------------+
| NULL            |
+-----------------+
</pre><p>
          引数が有効な JSON 値でない場合は、エラーが発生します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(1);</code></strong>
ERROR 3146 (22032): Invalid data type for JSON data in argument 1
to function json_type; a JSON string or JSON type is required.
</pre><p>
          <code class="literal">NULL</code> 以外のエラー以外の結果の場合、次のリストに、考えられる <code class="literal">JSON_TYPE()</code> の戻り値を示します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              純粋な JSON 型:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">OBJECT</code>: JSON オブジェクト
                </p></li><li class="listitem"><p>
                  <code class="literal">ARRAY</code>: JSON 配列
                </p></li><li class="listitem"><p>
                  <code class="literal">BOOLEAN</code>: JSON true および false リテラル
                </p></li><li class="listitem"><p>
                  <code class="literal">NULL</code>: JSON null リテラル
                </p></li></ul></div></li><li class="listitem"><p>
              数値型:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">INTEGER</code>: MySQL <code class="literal">TINYINT</code>, <code class="literal">SMALLINT</code>, <code class="literal">MEDIUMINT</code> および <code class="literal">INT</code> と <code class="literal">BIGINT</code> のスカラー
                </p></li><li class="listitem"><p>
                  <code class="literal">DOUBLE</code>: MySQL <code class="literal">DOUBLE</code> <code class="literal">FLOAT</code> スカラー
                </p></li><li class="listitem"><p>
                  <code class="literal">DECIMAL</code>: MySQL <code class="literal">DECIMAL</code> および <code class="literal">NUMERIC</code> スカラー
                </p></li></ul></div></li><li class="listitem"><p>
              時間型:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">DATETIME</code>: MySQL <code class="literal">DATETIME</code> および <code class="literal">TIMESTAMP</code> スカラー
                </p></li><li class="listitem"><p>
                  <code class="literal">DATE</code>: MySQL <code class="literal">DATE</code> スカラー
                </p></li><li class="listitem"><p>
                  <code class="literal">TIME</code>: MySQL <code class="literal">TIME</code> スカラー
                </p></li></ul></div></li><li class="listitem"><p>
              文字列型:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">STRING</code>: MySQL <code class="literal">utf8</code> 文字型スカラー: <code class="literal">CHAR</code>, <code class="literal">VARCHAR</code>, <code class="literal">TEXT</code>, <code class="literal">ENUM</code> および <code class="literal">SET</code>
                </p></li></ul></div></li><li class="listitem"><p>
              バイナリ型:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">BLOB</code>: <code class="literal">BINARY</code>, <code class="literal">VARBINARY</code>, <code class="literal">BLOB</code> および <code class="literal">BIT</code> を含む MySQL バイナリ型スカラー
                </p></li></ul></div></li><li class="listitem"><p>
              他のすべてのタイプ:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">OPAQUE</code> (raw ビット)
                </p></li></ul></div></li></ul></div></li><li class="listitem"><a name="function_json-valid"></a><p>
          <code class="literal">JSON_VALID(<em class="replaceable"><code>val</code></em>)</code>
        </p><a class="indexterm" name="idm46041615007568"></a><p>
          値が有効な JSON かどうかを示す 0 または 1 を返します。 引数が <code class="literal">NULL</code> の場合、<code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_VALID('{"a": 1}');</code></strong>
+------------------------+
| JSON_VALID('{"a": 1}') |
+------------------------+
|                      1 |
+------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_VALID('hello'), JSON_VALID('"hello"');</code></strong>
+---------------------+-----------------------+
| JSON_VALID('hello') | JSON_VALID('"hello"') |
+---------------------+-----------------------+
|                   0 |                     1 |
+---------------------+-----------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-table-functions"></a>12.18.6 JSON テーブル関数</h3></div></div></div><p>
      このセクションでは、JSON データを表形式データに変換する JSON 関数について説明します。 MySQL 8.0.4 以降では、このような機能の <code class="literal">JSON_TABLE()</code> がサポートされています。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-table"></a><p>
          <code class="literal">JSON_TABLE(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>path</code></em> COLUMNS (<em class="replaceable"><code>column_list</code></em>) [AS] <em class="replaceable"><code>alias</code></em>)</code>
        </p><a class="indexterm" name="idm46041614989472"></a><p>
          JSON ドキュメントからデータを抽出し、指定されたカラムを持つリレーショナルテーブルとして戻します。 この関数の完全な構文を次に示します: 
        </p><pre class="programlisting">JSON_TABLE(
    <em class="replaceable"><code>expr</code></em>,
    <em class="replaceable"><code>path</code></em> COLUMNS (<em class="replaceable"><code>column_list</code></em>)
)   [AS] <em class="replaceable"><code>alias</code></em>

<em class="replaceable"><code>column_list</code></em>:
    <em class="replaceable"><code>column</code></em>[, <em class="replaceable"><code>column</code></em>][, ...]

<em class="replaceable"><code>column</code></em>:
    <em class="replaceable"><code>name</code></em> FOR ORDINALITY
    |  <em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em> PATH <em class="replaceable"><code>string path</code></em> [<em class="replaceable"><code>on_empty</code></em>] [<em class="replaceable"><code>on_error</code></em>]
    |  <em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em> EXISTS PATH <em class="replaceable"><code>string path</code></em>
    |  NESTED [PATH] <em class="replaceable"><code>path</code></em> COLUMNS (<em class="replaceable"><code>column_list</code></em>)

<em class="replaceable"><code>on_empty</code></em>:
    {NULL | DEFAULT <em class="replaceable"><code>json_string</code></em> | ERROR} ON EMPTY

<em class="replaceable"><code>on_error</code></em>:
    {NULL | DEFAULT <em class="replaceable"><code>json_string</code></em> | ERROR} ON ERROR
</pre><p>
          <em class="replaceable"><code>expr</code></em>: これは JSON データを返す式です。 定数 (<code class="literal">'{"a":1}'</code>)、カラム (<code class="literal">t1.json_data</code>、<code class="literal">FROM</code> 句で <code class="literal">JSON_TABLE()</code> の前に指定されたテーブル <code class="literal">t1</code>)、または関数コール (<code class="literal">JSON_EXTRACT(t1.json_data,'$.post.comments')</code>) を指定できます。 
        </p><p>
          <em class="replaceable"><code>path</code></em>: データソースに適用される JSON パス式。 パスに一致する JSON 値を<span class="emphasis"><em>行ソース</em></span>と呼びます。これはリレーショナルデータの行を生成するために使用されます。 <code class="literal">COLUMNS</code> 句は、行ソースを評価し、行ソース内の特定の JSON 値を検索して、リレーショナルデータの行の個々のカラムにそれらの JSON 値を SQL 値として返します。 
        </p><p>
          <em class="replaceable"><code>alias</code></em> は必須です。 テーブルのエイリアスの通常のルールが適用されます (<a class="xref" href="language-structure.html#identifiers" title="9.2 スキーマオブジェクト名">セクション9.2「スキーマオブジェクト名」</a> を参照)。 
        </p><p>
          <code class="literal">JSON_TABLE()</code> では、次のリストに示す 4 つのタイプのカラムがサポートされています:
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em> FOR ORDINALITY</code>: このタイプは、<code class="literal">COLUMNS</code> 句の行を列挙します。<em class="replaceable"><code>name</code></em> という名前のカラムは、タイプが <code class="literal">UNSIGNED INT</code> で初期値が 1 のカウンタです。 これは、<code class="literal">CREATE TABLE</code> ステートメントでカラムを <code class="literal">AUTO_INCREMENT</code> として指定することと同等で、<code class="literal">NESTED [PATH]</code>句によって生成された複数の行に対して同じ値を持つ親行を区別するために使用できます。 
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em> PATH <em class="replaceable"><code>string_path</code></em> [<em class="replaceable"><code>on_empty</code></em>] [<em class="replaceable"><code>on_error</code></em>]</code>: このタイプのカラムは、<em class="replaceable"><code>string_path</code></em> で指定された値を抽出するために使用されます。<em class="replaceable"><code>type</code></em> は MySQL スカラーデータ型です (つまり、オブジェクトまたは配カラムにすることはできません)。 <code class="literal">JSON_TABLE()</code> は、JSON としてデータを抽出し、MySQL の JSON データに適用される通常の自動型変換を使用して、そのデータをカラムタイプに強制的に変換します。 欠損値によって <em class="replaceable"><code>on_empty</code></em> 句がトリガーされます。 オブジェクトまたは配列を保存すると、オプションの <em class="replaceable"><code>on error</code></em> 句がトリガーされます。これは、文字列<code class="literal">'asd'</code>を整数カラムに保存しようとするなど、JSON として保存された値からテーブルのカラムへの強制変換中にエラーが発生した場合にも発生します。 
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em> EXISTS PATH <em class="replaceable"><code>path</code></em></code>: このカラムは、<em class="replaceable"><code>path</code></em> で指定された場所にデータが存在する場合は 1 を返し、それ以外の場合は 0 を返します。<em class="replaceable"><code>type</code></em> は任意の有効な MySQL データ型にできますが、通常は様々な <code class="literal">INT</code> として指定する必要があります。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTED [PATH] <em class="replaceable"><code>path</code></em> COLUMNS (<em class="replaceable"><code>column_list</code></em>)</code>: これにより、JSON データ内のネストされたオブジェクトまたは配列が、親オブジェクトまたは配列からの JSON 値とともに単一行にフラット化されます。 複数の <code class="literal">PATH</code> オプションを使用すると、複数レベルのネストから単一の行に JSON 値を投影できます。 
            </p><p>
              <em class="replaceable"><code>path</code></em> は、<code class="literal">JSON_TABLE()</code> の親パス行パス、またはネストされたパスの場合の親 <code class="literal">NESTED [PATH]</code>句のパスからの相対パスです。
            </p></li></ol></div><p>
          <em class="replaceable"><code>on empty</code></em> (指定されている場合) は、データが欠落している場合に <code class="literal">JSON_TABLE()</code> が何を行うかを決定します (タイプによって異なります)。 この句は、<code class="literal">NESTED PATH</code> 句のカラムに一致がなく、<code class="literal">NULL</code> 補完行が生成された場合にもトリガーされます。<em class="replaceable"><code>on empty</code></em> は、次のいずれかの値を取ります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL ON EMPTY</code>: カラムは <code class="literal">NULL</code> に設定されています。これはデフォルトの動作です。
            </p></li><li class="listitem"><p>
              <code class="literal">DEFAULT <em class="replaceable"><code>json_string</code></em> ON EMPTY</code>: 指定された <em class="replaceable"><code>json_string</code></em> は、有効であるかぎり JSON として解析され、欠落している値のかわりに格納されます。 カラムタイプのルールは、デフォルト値にも適用されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR ON EMPTY</code>: エラーがスローされます。
            </p></li></ul></div><p>
          使用する場合、<em class="replaceable"><code>on_error</code></em> は、次に示すように、対応する結果とともに次のいずれかの値を取ります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL ON ERROR</code>: カラムは <code class="literal">NULL</code> に設定されています。これはデフォルトの動作です。
            </p></li><li class="listitem"><p>
              <code class="literal">DEFAULT <em class="replaceable"><code>json string</code></em> ON ERROR</code>: <em class="replaceable"><code>json_string</code></em> は JSON として解析され (有効な場合)、オブジェクトまたは配列のかわりに格納されます。
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR ON ERROR</code>: エラーがスローされます。
            </p></li></ul></div><p>
          MySQL 8.0.20 より前は、<code class="literal">NULL ON ERROR</code> または <code class="literal">DEFAULT ... ON ERROR</code> で型変換エラーが発生した場合、または暗黙的に指定された場合に警告がスローされました。 MySQL 8.0.20 以降では、これは当てはまりません。 (Bug #30628330) 
        </p><p>
          以前は、<code class="literal">ON EMPTY</code> 句と <code class="literal">ON ERROR</code> 句をいずれかの順序で指定できました。 これにより、SQL 標準へのカウンタが実行されます。このカウンタは、指定されている場合、<code class="literal">ON ERROR</code> 句の前にその <code class="literal">ON EMPTY</code> を指定する必要があります。 このため、MySQL 8.0.20 以降では、<code class="literal">ON EMPTY</code> が非推奨になる前に <code class="literal">ON ERROR</code> を指定すると、サーバーで警告が発行されます。 非標準構文のサポートは、MySQL の将来のバージョンで削除される予定です。 
        </p><p>
          3.14159 を <code class="literal">DECIMAL(10,1)</code> カラムに保存するなど、カラムに保存された値が切り捨てられると、<code class="literal">ON ERROR</code> オプションとは関係なく警告が発行されます。 単一のステートメントで複数の値が切り捨てられた場合、警告は一度のみ発行されます。 
        </p><p>
          MySQL 8.0.21 より前は、この関数に渡された式およびパスが JSON null に解決されると、<code class="literal">JSON_TABLE()</code> でエラーが発生しました。 MySQL 8.0.21 以降では、次に示すように、SQL 標準に従って SQL <code class="literal">NULL</code> が返されます (Bug #31345503、Bug #99557): 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt;   <strong class="userinput"><code>FROM</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;       <strong class="userinput"><code>'[ {"c1": null} ]',</code></strong>
    -&gt;       <strong class="userinput"><code>'$[*]' COLUMNS( c1 INT PATH '$.c1' ERROR ON ERROR )</code></strong>
    -&gt;     <strong class="userinput"><code>) as jt;</code></strong>
+------+
| c1   |
+------+
| NULL |
+------+
1 row in set (0.00 sec)
</pre><p>
          次のクエリーは、<code class="literal">ON EMPTY</code> および <code class="literal">ON ERROR</code> の使用方法を示しています。 パス<code class="literal">"$.a"</code>の <code class="literal">{"b":1}</code> に対応する行が空で、<code class="literal">[1,2]</code>をスカラーとして保存しようとするとエラーが発生します。これらの行は、次に示す出力で強調表示されます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[{"a":"3"},{"a":2},{"b":1},{"a":0},{"a":[1,2]}]',</code></strong>
    -&gt;     <strong class="userinput"><code>"$[*]"</code></strong>
    -&gt;     <strong class="userinput"><code>COLUMNS(</code></strong>
    -&gt;       <strong class="userinput"><code>rowid FOR ORDINALITY,</code></strong>
    -&gt;       <strong class="userinput"><code>ac VARCHAR(100) PATH "$.a" DEFAULT '111' ON EMPTY DEFAULT '999' ON ERROR,</code></strong>
    -&gt;       <strong class="userinput"><code>aj JSON PATH "$.a" DEFAULT '{"x": 333}' ON EMPTY,</code></strong>
    -&gt;       <strong class="userinput"><code>bx INT EXISTS PATH "$.b"</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt;   <strong class="userinput"><code>) AS tt;</code></strong>

+-------+------+------------+------+
| rowid | ac   | aj         | bx   |
+-------+------+------------+------+
|     1 | 3    | "3"        |    0 |
|     2 | 2    | 2          |    0 |
<span class="emphasis"><em>|     3 | 111  | {"x": 333} |    1 |</em></span>
|     4 | 0    | 0          |    0 |
<span class="emphasis"><em>|     5 | 999  | [1, 2]     |    0 |</em></span>
+-------+------+------------+------+
5 rows in set (0.00 sec)
</pre><p>
          カラム名には、テーブルのカラム名を制御する通常のルールおよび制限が適用されます。 <a class="xref" href="language-structure.html#identifiers" title="9.2 スキーマオブジェクト名">セクション9.2「スキーマオブジェクト名」</a>を参照してください。 
        </p><p>
          すべての JSON および JSON パス式の妥当性がチェックされます。どちらのタイプの式も無効であると、エラーが発生します。
        </p><p>
          <code class="literal">COLUMNS</code> キーワードの前にある <em class="replaceable"><code>path</code></em> の各一致は、結果テーブルの個々の行にマップされます。 たとえば、次のクエリーを実行すると、次に示す結果が得られます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]',</code></strong>
    -&gt;     <strong class="userinput"><code>"$[*]" COLUMNS(</code></strong>
    -&gt;       <strong class="userinput"><code>xval VARCHAR(100) PATH "$.x",</code></strong>
    -&gt;       <strong class="userinput"><code>yval VARCHAR(100) PATH "$.y"</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt;   <strong class="userinput"><code>) AS  jt1;</code></strong>

+------+------+
| xval | yval |
+------+------+
| 2    | 8    |
| 3    | 7    |
| 4    | 6    |
+------+------+
</pre><p>
          式<code class="literal">"$[*]"</code>は配列の各要素と一致します。 パスを変更することで、結果の行をフィルタできます。 たとえば、<code class="literal">"$[1]"</code>を使用すると、次に示すように、抽出がソースとして使用される JSON 配列の 2 番目の要素に制限されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]',</code></strong>
    -&gt;     <strong class="userinput"><code>"$[1]" COLUMNS(</code></strong>
    -&gt;       <strong class="userinput"><code>xval VARCHAR(100) PATH "$.x",</code></strong>
    -&gt;       <strong class="userinput"><code>yval VARCHAR(100) PATH "$.y"</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt;   <strong class="userinput"><code>) AS  jt1;</code></strong>

+------+------+
| xval | yval |
+------+------+
| 3    | 7    |
+------+------+
</pre><p>
          カラム定義内では、<code class="literal">"$"</code>は一致全体をカラムに渡します。<code class="literal">"$.x"</code>および<code class="literal">"$.y"</code>は、キー <code class="literal">x</code> および <code class="literal">y</code> に対応する値のみをその一致内で渡します。 詳細は、<a class="xref" href="data-types.html#json-path-syntax" title="JSON パス構文">JSON パス構文</a>を参照してください。 
        </p><p>
          <code class="literal">NESTED PATH</code> (または単に <code class="literal">NESTED</code>。<code class="literal">PATH</code> はオプション) では、所属する <code class="literal">COLUMNS</code> 句の一致ごとに一連のレコードが生成されます。 一致しない場合、ネストされたパスのすべてのカラムが <code class="literal">NULL</code> に設定されます。 これにより、最上位の句と <code class="literal">NESTED [PATH]</code>の間の外部結合が実装されます。 内部結合をエミュレートするには、次に示すように、<code class="literal">WHERE</code> 句に適切な条件を適用します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[ {"a": 1, "b": [11,111]}, {"a": 2, "b": [22,222]}, {"a":3}]',</code></strong>
    -&gt;     <strong class="userinput"><code>'$[*]' COLUMNS(</code></strong>
    -&gt;             <strong class="userinput"><code>a INT PATH '$.a',</code></strong>
    -&gt;             <strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b INT PATH '$')</code></strong>
    -&gt;            <strong class="userinput"><code>)</code></strong>
    -&gt;    <strong class="userinput"><code>) AS jt</code></strong>
    -&gt; <strong class="userinput"><code>WHERE b IS NOT NULL;</code></strong>

+------+------+
| a    | b    |
+------+------+
|    1 |   11 |
|    1 |  111 |
|    2 |   22 |
|    2 |  222 |
+------+------+
</pre><p>
          兄弟のネストされたパス (同じ <code class="literal">COLUMNS</code> 句内の <code class="literal">NESTED [PATH]</code>の複数のインスタンス) は、一度に複数回処理されます。 あるネストされたパスがレコードを生成している間、兄弟のネストされたパス式のカラムは <code class="literal">NULL</code> に設定されます。 つまり、次に示すように、単一の包含 <code class="literal">COLUMNS</code> 句内の単一一致のレコードの合計数は合計であり、<code class="literal">NESTED [PATH]</code>修飾子によって生成されるすべてのレコードの積ではありません: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[{"a": 1, "b": [11,111]}, {"a": 2, "b": [22,222]}]',</code></strong>
    -&gt;     <strong class="userinput"><code>'$[*]' COLUMNS(</code></strong>
    -&gt;         <strong class="userinput"><code>a INT PATH '$.a',</code></strong>
    -&gt;         <strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b1 INT PATH '$'),</code></strong>
    -&gt;         <strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b2 INT PATH '$')</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt; <strong class="userinput"><code>) AS jt;</code></strong>

+------+------+------+
| a    | b1   | b2   |
+------+------+------+
|    1 |   11 | NULL |
|    1 |  111 | NULL |
|    1 | NULL |   11 |
|    1 | NULL |  111 |
|    2 |   22 | NULL |
|    2 |  222 | NULL |
|    2 | NULL |   22 |
|    2 | NULL |  222 |
+------+------+------+
</pre><p>
          <code class="literal">FOR ORDINALITY</code> カラムは、<code class="literal">COLUMNS</code> 句によって生成されたレコードを列挙し、ネストされたパスの親レコードを区別するために使用できます。特に、親レコードの値が同じ場合は、次のようになります:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
    -&gt; <strong class="userinput"><code>FROM</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_TABLE(</code></strong>
    -&gt;     <strong class="userinput"><code>'[{"a": "a_val",</code></strong>
    '&gt;       <strong class="userinput"><code>"b": [{"c": "c_val", "l": [1,2]}]},</code></strong>
    '&gt;     <strong class="userinput"><code>{"a": "a_val",</code></strong>
    '&gt;       <strong class="userinput"><code>"b": [{"c": "c_val","l": [11]}, {"c": "c_val", "l": [22]}]}]',</code></strong>
    -&gt;     <strong class="userinput"><code>'$[*]' COLUMNS(</code></strong>
    -&gt;       <strong class="userinput"><code>top_ord FOR ORDINALITY,</code></strong>
    -&gt;       <strong class="userinput"><code>apath VARCHAR(10) PATH '$.a',</code></strong>
    -&gt;       <strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (</code></strong>
    -&gt;         <strong class="userinput"><code>bpath VARCHAR(10) PATH '$.c',</code></strong>
    -&gt;         <strong class="userinput"><code>ord FOR ORDINALITY,</code></strong>
    -&gt;         <strong class="userinput"><code>NESTED PATH '$.l[*]' COLUMNS (lpath varchar(10) PATH '$')</code></strong>
    -&gt;         <strong class="userinput"><code>)</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt; <strong class="userinput"><code>) as jt;</code></strong>

+---------+---------+---------+------+-------+
| top_ord | apath   | bpath   | ord  | lpath |
+---------+---------+---------+------+-------+
|       1 |  a_val  |  c_val  |    1 | 1     |
|       1 |  a_val  |  c_val  |    1 | 2     |
|       2 |  a_val  |  c_val  |    1 | 11    |
|       2 |  a_val  |  c_val  |    2 | 22    |
+---------+---------+---------+------+-------+
</pre><p>
          ソースドキュメントには 2 つの要素の配列が含まれており、これらの各要素は 2 つの行を生成します。 <code class="literal">apath</code> と <code class="literal">bpath</code> の値は、結果セット全体で同じです。つまり、<code class="literal">lpath</code> 値が同じ親から取得されたのか、別の親から取得されたのかを判断するために使用できません。 <code class="literal">ord</code> カラムの値は、<code class="literal">top_ord</code> が 1 に等しいレコードのセットと同じままであるため、これらの 2 つの値は単一オブジェクトからの値です。 残りの 2 つの値は、<code class="literal">ord</code> カラムの値が異なるため、異なるオブジェクトの値です。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-validation-functions"></a>12.18.7 JSON スキーマ検証関数</h3></div></div></div><a class="indexterm" name="idm46041614806752"></a><p>
      MySQL 8.0.17 以降、MySQL では、<a class="ulink" href="https://json-schema.org/specification-links.html#draft-4" target="_top">「JSON スキーマ仕様のドラフト 4」</a>に準拠する JSON スキーマに対する JSON ドキュメントの検証がサポートされます。 これは、このセクションで説明する関数のいずれかを使用して実行できます。どちらの関数も、JSON スキーマと、スキーマに対して検証される JSON ドキュメントの 2 つの引数を取ります。 <code class="literal">JSON_SCHEMA_VALID()</code> は、ドキュメントがスキーマに対して検証される場合は true を返し、検証されない場合は false を返します。<code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code> は、検証に関する JSON 形式のレポートを提供します。 
    </p><p>
      どちらの関数も、次のように NULL または無効な入力を処理します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          少なくともいずれかの引数が <code class="literal">NULL</code> の場合、この関数は <code class="literal">NULL</code> を戻します。
        </p></li><li class="listitem"><p>
          少なくともいずれかの引数が有効な JSON でない場合、関数でエラーが発生します (<code class="literal">ER_INVALID_TYPE_FOR_JSON</code>)
        </p></li><li class="listitem"><p>
          また、スキーマが有効な JSON オブジェクトでない場合、関数は <code class="literal">ER_INVALID_JSON_TYPE</code> を戻します。
        </p></li></ul></div><p>
      MySQL では、JSON スキーマの <code class="literal">required</code> 属性をサポートして、必要なプロパティを強制的に含めることができます (関数の説明の例を参照)。
    </p><p>
      MySQL では、JSON スキーマの <code class="literal">id</code>, <code class="literal">$schema</code>, <code class="literal">description</code> および <code class="literal">type</code> 属性がサポートされていますが、これらは必要ありません。
    </p><p>
      MySQL では、JSON スキーマの外部リソースはサポートされていません。<code class="literal">$ref</code> キーワードを使用すると、<code class="literal">JSON_SCHEMA_VALID()</code> が <code class="literal">ER_NOT_SUPPORTED_YET</code> で失敗します。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        MySQL では、JSON スキーマの正規表現パターンがサポートされています。JSON スキーマでは、無効なパターンはサポートされますが、暗黙的に無視されます (例は、<code class="literal">JSON_SCHEMA_VALID()</code> の説明を参照)。
      </p></div><p>
      これらの関数の詳細は、次のリストを参照してください:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-schema-valid"></a><p>
          <code class="literal">JSON_SCHEMA_VALID(<em class="replaceable"><code>schema</code></em>,<em class="replaceable"><code>document</code></em>)</code>
        </p><a class="indexterm" name="idm46041614777984"></a><p>
          JSON <em class="replaceable"><code>schema</code></em> に対して JSON <em class="replaceable"><code>document</code></em> を検証します。 <em class="replaceable"><code>schema</code></em> と <em class="replaceable"><code>document</code></em> の両方が必要です。 スキーマは有効な JSON オブジェクトである必要があります。ドキュメントは有効な JSON ドキュメントである必要があります。 これらの条件が満たされている場合: ドキュメントがスキーマに対して検証される場合、関数は true (1) を戻し、それ以外の場合は false (0) を戻します。 
        </p><p>
          この例では、ユーザー変数<code class="literal">@schema</code> を地理座標の JSON スキーマの値に設定し、別の<code class="literal">@document</code> をその座標を含む JSON ドキュメントの値に設定します。 次に、<code class="literal">JSON_SCHEMA_VALID()</code> の引数として使用して、<code class="literal">@document</code> が<code class="literal">@schema</code> に従って検証されることを確認します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @schema = '{</code></strong>
    '&gt;  <strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong>
    '&gt; <strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong>
    '&gt; <strong class="userinput"><code>"description": "A geographical coordinate",</code></strong>
    '&gt; <strong class="userinput"><code>"type": "object",</code></strong>
    '&gt; <strong class="userinput"><code>"properties": {</code></strong>
    '&gt;   <strong class="userinput"><code>"latitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -90,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 90</code></strong>
    '&gt;   <strong class="userinput"><code>},</code></strong>
    '&gt;   <strong class="userinput"><code>"longitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -180,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 180</code></strong>
    '&gt;   <strong class="userinput"><code>}</code></strong>
    '&gt; <strong class="userinput"><code>},</code></strong>
    '&gt; <strong class="userinput"><code>"required": ["latitude", "longitude"]</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET @document = '{</code></strong>
    '&gt; <strong class="userinput"><code>"latitude": 63.444697,</code></strong>
    '&gt; <strong class="userinput"><code>"longitude": 10.445118</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong>
+---------------------------------------+
| JSON_SCHEMA_VALID(@schema, @document) |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">@schema</code> には <code class="literal">required</code> 属性が含まれているため、<code class="literal">@document</code> を、それ以外は有効だが必須プロパティを含まない値に設定し、次のように<code class="literal">@schema</code> に対してテストできます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @document = '{}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong>
+---------------------------------------+
| JSON_SCHEMA_VALID(@schema, @document) |
+---------------------------------------+
|                                     0 |
+---------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          次に示すように、<code class="literal">@schema</code> の値を同じ JSON スキーマに設定し、<code class="literal">required</code> 属性を指定しない場合、<code class="literal">@document</code> は、プロパティが含まれていなくても有効な JSON オブジェクトであるため検証します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @schema = '{</code></strong>
    '&gt; <strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong>
    '&gt; <strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong>
    '&gt; <strong class="userinput"><code>"description": "A geographical coordinate",</code></strong>
    '&gt; <strong class="userinput"><code>"type": "object",</code></strong>
    '&gt; <strong class="userinput"><code>"properties": {</code></strong>
    '&gt;   <strong class="userinput"><code>"latitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -90,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 90</code></strong>
    '&gt;   <strong class="userinput"><code>},</code></strong>
    '&gt;   <strong class="userinput"><code>"longitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -180,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 180</code></strong>
    '&gt;   <strong class="userinput"><code>}</code></strong>
    '&gt; <strong class="userinput"><code>}</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong>
+---------------------------------------+
| JSON_SCHEMA_VALID(@schema, @document) |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
1 row in set (0.00 sec)
</pre><a class="indexterm" name="idm46041614725408"></a><a class="indexterm" name="idm46041614723184"></a><p><a name="json-validation-functions-constraints"></a><b>JSON_SCHEMA_VALID() および CHECK 制約. </b>
            <code class="literal">JSON_SCHEMA_VALID()</code> を使用して、<code class="literal">CHECK</code> 制約を施行することもできます。
          </p><p>
          次のように作成されたテーブル <code class="literal">geo</code> について考えてみます。JSON カラム <code class="literal">coordinate</code> は、このテーブルの <code class="literal">CHECK</code> 制約の式として渡される <code class="literal">JSON_SCHEMA_VALID()</code> コールで引数として使用される JSON スキーマによって制御される、マップ上の緯度と経度の点を表します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE geo (</code></strong>
    -&gt;     <strong class="userinput"><code>coordinate JSON,</code></strong>
    -&gt;     <strong class="userinput"><code>CHECK(</code></strong>
    -&gt;         <strong class="userinput"><code>JSON_SCHEMA_VALID(</code></strong>
    -&gt;             <strong class="userinput"><code>'{</code></strong>
    '&gt;                 <strong class="userinput"><code>"type":"object",</code></strong>
    '&gt;                 <strong class="userinput"><code>"properties":{</code></strong>
    '&gt;                       <strong class="userinput"><code>"latitude":{"type":"number", "minimum":-90, "maximum":90},</code></strong>
    '&gt;                       <strong class="userinput"><code>"longitude":{"type":"number", "minimum":-180, "maximum":180}</code></strong>
    '&gt;                 <strong class="userinput"><code>},</code></strong>
    '&gt;                 <strong class="userinput"><code>"required": ["latitude", "longitude"]</code></strong>
    '&gt;             <strong class="userinput"><code>}',</code></strong>
    -&gt;             <strong class="userinput"><code>coordinate</code></strong>
    -&gt;         <strong class="userinput"><code>)</code></strong>
    -&gt;     <strong class="userinput"><code>)</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected (0.45 sec)
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            MySQL <code class="literal">CHECK</code> 制約には変数への参照を含めることができないため、JSON スキーマを使用してテーブルにこのような制約を指定する場合は、JSON スキーマを <code class="literal">JSON_SCHEMA_VALID()</code> インラインに渡す必要があります。
          </p></div><p>
          座標を表す JSON 値を次の 3 つの変数に割り当てます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @point1 = '{"latitude":59, "longitude":18}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @point2 = '{"latitude":91, "longitude":0}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @point3 = '{"longitude":120}';</code></strong>
Query OK, 0 rows affected (0.00 sec)
</pre><p>
          次の <code class="literal">INSERT</code> ステートメントに示すように、これらの最初の値は有効です:
        </p><pre class="programlisting">mysql&gt; INSERT INTO geo VALUES(@point1);
Query OK, 1 row affected (0.05 sec)
</pre><p>
          2 番目の JSON 値は無効であるため、次に示すように制約は失敗します:
        </p><pre class="programlisting">mysql&gt; INSERT INTO geo VALUES(@point2);
ERROR 3819 (HY000): Check constraint 'geo_chk_1' is violated.
</pre><p>
          MySQL 8.0.19 以降では、障害の性質に関する正確な情報を取得できます。この場合、<code class="literal">latitude</code> 値が <code class="literal">SHOW WARNINGS</code> ステートメントの発行によってスキーマで定義された最大値を超えています:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Error
   Code: 3934
Message: The JSON document location '#/latitude' failed requirement 'maximum' at
JSON Schema location '#/properties/latitude'.
*************************** 2. row ***************************
  Level: Error
   Code: 3819
Message: Check constraint 'geo_chk_1' is violated.
2 rows in set (0.00 sec)
</pre><p>
          必要な <code class="literal">latitude</code> プロパティがないため、前述の 3 番目の座標値も無効です。 以前と同様に、<code class="literal">geo</code> テーブルに値を挿入してから、<code class="literal">SHOW WARNINGS</code> を発行することで、これを確認できます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO geo VALUES(@point3);</code></strong>
ERROR 3819 (HY000): Check constraint 'geo_chk_1' is violated.
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Error
   Code: 3934
Message: The JSON document location '#' failed requirement 'required' at JSON
Schema location '#'.
*************************** 2. row ***************************
  Level: Error
   Code: 3819
Message: Check constraint 'geo_chk_1' is violated.
2 rows in set (0.00 sec)
</pre><p>
          詳しくは<a class="xref" href="sql-statements.html#create-table-check-constraints" title="13.1.20.6 CHECK 制約">セクション13.1.20.6「CHECK 制約」</a>,をご覧ください。
        </p><a class="indexterm" name="idm46041614678496"></a><p>
          JSON スキーマでは、文字列の正規表現パターンの指定がサポートされていますが、MySQL で使用される実装では、無効なパターンは暗黙的に無視されます。 つまり、次に示すように、正規表現パターンが無効な場合でも、<code class="literal">JSON_SCHEMA_VALID()</code> は true を返すことができます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALID('{"type":"string","pattern":"("}', '"abc"');</code></strong>
+---------------------------------------------------------------+
| JSON_SCHEMA_VALID('{"type":"string","pattern":"("}', '"abc"') |
+---------------------------------------------------------------+
|                                                             1 |
+---------------------------------------------------------------+
1 row in set (0.04 sec)
</pre></li><li class="listitem"><a name="function_json-schema-validation-report"></a><p>
          <code class="literal">JSON_SCHEMA_VALIDATION_REPORT(<em class="replaceable"><code>schema</code></em>,<em class="replaceable"><code>document</code></em>)</code>
        </p><a class="indexterm" name="idm46041614667280"></a><p>
          JSON <em class="replaceable"><code>schema</code></em> に対して JSON <em class="replaceable"><code>document</code></em> を検証します。 <em class="replaceable"><code>schema</code></em> と <em class="replaceable"><code>document</code></em> の両方が必要です。 JSON_VALID_SCHEMA() と同様に、スキーマは有効な JSON オブジェクトである必要があり、ドキュメントは有効な JSON ドキュメントである必要があります。 これらの条件が満たされている場合、関数は検証の結果に関するレポートを JSON ドキュメントとして返します。 JSON スキーマに従って JSON ドキュメントが有効とみなされる場合、この関数は、値が true のプロパティ <code class="literal">valid</code> を持つ JSON オブジェクトを戻します。 JSON ドキュメントが検証に失敗した場合、この関数は、次に示すプロパティを含む JSON オブジェクトを返します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">valid</code>: スキーマ検証に失敗した場合は常に false
            </p></li><li class="listitem"><p>
              <code class="literal">reason</code>: 失敗の理由を含む判読可能な文字列
            </p></li><li class="listitem"><p>
              <code class="literal">schema-location</code>: JSON スキーマ内で検証が失敗した場所を示す JSON ポインタ URI フラグメント識別子 (このリストの後のノートを参照)
            </p></li><li class="listitem"><p>
              <code class="literal">document-location</code>: JSON ドキュメント内で検証が失敗した場所を示す JSON ポインタ URI フラグメント識別子 (このリストの後のノートを参照)
            </p></li><li class="listitem"><p>
              <code class="literal">schema-failed-keyword</code>: 違反があった JSON スキーマ内のキーワードまたはプロパティの名前を含む文字列
            </p></li></ul></div><a class="indexterm" name="idm46041614652976"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            JSON ポインタ URI フラグメント識別子は、<a class="ulink" href="https://tools.ietf.org/html/rfc6901#page-5" target="_top">「RFC 6901 - JavaScript Object Notation (JSON) ポインタ」</a>で定義されます。 (これらは、<code class="literal">JSON_EXTRACT()</code> および他の MySQL JSON 関数で使用される JSON パス表記とは異なります。) この表記法では、<code class="literal">#</code>はドキュメント全体を表し、<code class="literal">#/myprop</code> は <code class="literal">myprop</code> という最上位プロパティに含まれるドキュメントの一部を表します。 詳細は、前述の仕様と、このセクションで後述する例を参照してください。 
          </p></div><p>
          この例では、ユーザー変数<code class="literal">@schema</code> を地理座標の JSON スキーマの値に設定し、別の<code class="literal">@document</code> をその座標を含む JSON ドキュメントの値に設定します。 次に、<code class="literal">JSON_SCHEMA_VALIDATION_REORT()</code> の引数として使用して、<code class="literal">@document</code> が<code class="literal">@schema</code> に従って検証されることを確認します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @schema = '{</code></strong>
    '&gt;  <strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong>
    '&gt; <strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong>
    '&gt; <strong class="userinput"><code>"description": "A geographical coordinate",</code></strong>
    '&gt; <strong class="userinput"><code>"type": "object",</code></strong>
    '&gt; <strong class="userinput"><code>"properties": {</code></strong>
    '&gt;   <strong class="userinput"><code>"latitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -90,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 90</code></strong>
    '&gt;   <strong class="userinput"><code>},</code></strong>
    '&gt;   <strong class="userinput"><code>"longitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -180,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 180</code></strong>
    '&gt;   <strong class="userinput"><code>}</code></strong>
    '&gt; <strong class="userinput"><code>},</code></strong>
    '&gt; <strong class="userinput"><code>"required": ["latitude", "longitude"]</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET @document = '{</code></strong>
    '&gt; <strong class="userinput"><code>"latitude": 63.444697,</code></strong>
    '&gt; <strong class="userinput"><code>"longitude": 10.445118</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALIDATION_REPORT(@schema, @document);</code></strong>
+---------------------------------------------------+
| JSON_SCHEMA_VALIDATION_REPORT(@schema, @document) |
+---------------------------------------------------+
| {"valid": true}                                   |
+---------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          次に示すように、いずれかのプロパティに不正な値が指定されるように<code class="literal">@document</code> を設定します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @document = '{</code></strong>
    '&gt; <strong class="userinput"><code>"latitude": 63.444697,</code></strong>
    '&gt; <strong class="userinput"><code>"longitude": 310.445118</code></strong>
    '&gt; <strong class="userinput"><code>}';</code></strong>
</pre><p>
          <code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code> でテストすると、<code class="literal">@document</code> の検証が失敗するようになりました。 関数コールからの出力には、次に示すように、失敗に関する詳細情報が含まれます (より適切な書式設定を提供するために <code class="literal">JSON_PRETTY()</code> でラップされた関数を使用): 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document))\G</code></strong>
*************************** 1. row ***************************
JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document)): {
  "valid": false,
  "reason": "The JSON document location '#/longitude' failed requirement 'maximum' at JSON Schema location '#/properties/longitude'",
  "schema-location": "#/properties/longitude",
  "document-location": "#/longitude",
  "schema-failed-keyword": "maximum"
}
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">@schema</code> には <code class="literal">required</code> 属性が含まれているため、<code class="literal">@document</code> を、それ以外は有効だが必須プロパティを含まない値に設定してから、<code class="literal">@schema</code> に対してテストできます。 <code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code> の出力は、次のように、必要な要素がないために検証が失敗することを示しています: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @document = '{}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document))\G</code></strong>
*************************** 1. row ***************************
JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document)): {
  "valid": false,
  "reason": "The JSON document location '#' failed requirement 'required' at JSON Schema location '#'",
  "schema-location": "#",
  "document-location": "#",
  "schema-failed-keyword": "required"
}
1 row in set (0.00 sec)
</pre><p>
          次に示すように、<code class="literal">@schema</code> の値を同じ JSON スキーマに設定し、<code class="literal">required</code> 属性を指定しない場合、<code class="literal">@document</code> は、プロパティが含まれていなくても有効な JSON オブジェクトであるため検証します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @schema = '{</code></strong>
    '&gt; <strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong>
    '&gt; <strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong>
    '&gt; <strong class="userinput"><code>"description": "A geographical coordinate",</code></strong>
    '&gt; <strong class="userinput"><code>"type": "object",</code></strong>
    '&gt; <strong class="userinput"><code>"properties": {</code></strong>
    '&gt;   <strong class="userinput"><code>"latitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -90,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 90</code></strong>
    '&gt;   <strong class="userinput"><code>},</code></strong>
    '&gt;   <strong class="userinput"><code>"longitude": {</code></strong>
    '&gt;     <strong class="userinput"><code>"type": "number",</code></strong>
    '&gt;     <strong class="userinput"><code>"minimum": -180,</code></strong>
    '&gt;     <strong class="userinput"><code>"maximum": 180</code></strong>
    '&gt;   <strong class="userinput"><code>}</code></strong>
    '&gt; <strong class="userinput"><code>}</code></strong>
    '&gt;<strong class="userinput"><code>}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_SCHEMA_VALIDATION_REPORT(@schema, @document);</code></strong>
+---------------------------------------------------+
| JSON_SCHEMA_VALIDATION_REPORT(@schema, @document) |
+---------------------------------------------------+
| {"valid": true}                                   |
+---------------------------------------------------+
1 row in set (0.00 sec)
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="json-utility-functions"></a>12.18.8 JSON ユーティリティ関数</h3></div></div></div><p>
      このセクションでは、JSON 値に作用するユーティリティ関数、または JSON 値として解析できる文字列について説明します。 <code class="literal">JSON_PRETTY()</code> は、読みやすい形式で JSON 値を出力します。 <code class="literal">JSON_STORAGE_SIZE()</code> および <code class="literal">JSON_STORAGE_FREE()</code> では、特定の JSON 値によって使用されるストレージ領域の量と、部分的な更新後に <code class="literal">JSON</code> カラムに残っている領域の量がそれぞれ表示されます。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-pretty"></a><p>
          <code class="literal">JSON_PRETTY(<em class="replaceable"><code>json_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041614574640"></a><p>
          PHP および他の言語やデータベースシステムで実装されているものと同様の JSON 値のプリティプリントを提供します。 指定する値は、JSON 値または JSON 値の有効な文字列表現である必要があります。 この値に存在する余分な空白および改行は、出力には影響しません。 <code class="literal">NULL</code> 値の場合、関数は <code class="literal">NULL</code> を戻します。 値が JSON ドキュメントでない場合、または JSON ドキュメントとして解析できない場合、関数はエラーで失敗します。 
        </p><p>
          この関数からの出力の書式設定は、次のルールに従います:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              各配列要素またはオブジェクトメンバーは、親と比較して 1 つの追加レベルでインデントされた個別の行に表示されます。
            </p></li><li class="listitem"><p>
              インデントの各レベルでは、先頭に 2 つのスペースが追加されます。
            </p></li><li class="listitem"><p>
              2 つの要素またはメンバーを区切る改行の前に、個々の配列要素またはオブジェクトメンバーを区切るカンマが出力されます。
            </p></li><li class="listitem"><p>
              オブジェクトメンバーのキーと値はコロンで区切られ、その後に空白 ('<code class="literal">: </code>') が続きます。
            </p></li><li class="listitem"><p>
              空のオブジェクトまたは配列は単一行に出力されます。 開きカッコと閉じカッコの間にスペースは印刷されません。 
            </p></li><li class="listitem"><p>
              文字列スカラーおよびキー名の特殊文字は、<code class="literal">JSON_QUOTE()</code> 関数で使用されるものと同じルールを使用してエスケープされます。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY('123'); # scalar</code></strong>
+--------------------+
| JSON_PRETTY('123') |
+--------------------+
| 123                |
+--------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY("[1,3,5]"); # array</code></strong>
+------------------------+
| JSON_PRETTY("[1,3,5]") |
+------------------------+
| [
  1,
  3,
  5
]      |
+------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY('{"a":"10","b":"15","x":"25"}'); # object</code></strong>
+---------------------------------------------+
| JSON_PRETTY('{"a":"10","b":"15","x":"25"}') |
+---------------------------------------------+
| {
  "a": "10",
  "b": "15",
  "x": "25"
}   |
+---------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_PRETTY('["a",1,{"key1":</code></strong>
    '&gt;    <strong class="userinput"><code>"value1"},"5",     "77" ,</code></strong>
    '&gt;       <strong class="userinput"><code>{"key2":["value3","valueX",</code></strong>
    '&gt; <strong class="userinput"><code>"valueY"]},"j", "2"   ]')\G  # nested arrays and objects</code></strong>
*************************** 1. row ***************************
JSON_PRETTY('["a",1,{"key1":
             "value1"},"5",     "77" ,
                {"key2":["value3","valuex",
          "valuey"]},"j", "2"   ]'): [
  "a",
  1,
  {
    "key1": "value1"
  },
  "5",
  "77",
  {
    "key2": [
      "value3",
      "valuex",
      "valuey"
    ]
  },
  "j",
  "2"
]
</pre></li><li class="listitem"><a name="function_json-storage-free"></a><p>
          <code class="literal">JSON_STORAGE_FREE(<em class="replaceable"><code>json_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041614547344"></a><p>
          <code class="literal">JSON</code> カラム値の場合、この関数は、<code class="literal">JSON_SET()</code>、<code class="literal">JSON_REPLACE()</code> または <code class="literal">JSON_REMOVE()</code> を使用して更新された後にバイナリ表現で解放された記憶領域の量を示します。 引数には、有効な JSON ドキュメントまたは文字列を指定することもできます。この文字列は、リテラル値として解析することも、ユーザー変数の値として解析することもできます。この場合、関数は 0 を返します。 引数が、前述のように更新された <code class="literal">JSON</code> カラム値である場合、バイナリ表現が更新前よりも少ない領域を占めるように、ゼロ以外の正の値を返します。 バイナリ表現が以前と同じかそれより大きくなるように更新された <code class="literal">JSON</code> カラムの場合、または更新で部分更新を利用できなかった場合は 0 を返し、引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。 
        </p><p>
          <em class="replaceable"><code>json_val</code></em> が <code class="literal">NULL</code> ではなく、有効な JSON ドキュメントでも正常に解析できない場合は、エラーが発生します。
        </p><p>
          この例では、<code class="literal">JSON</code> カラムを含むテーブルを作成し、JSON オブジェクトを含む行を挿入します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE jtable (jcol JSON);</code></strong>
Query OK, 0 rows affected (0.38 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO jtable VALUES</code></strong>
    -&gt;     <strong class="userinput"><code>('{"a": 10, "b": "wxyz", "c": "[true, false]"}');</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM jtable;</code></strong>
+----------------------------------------------+
| jcol                                         |
+----------------------------------------------+
| {"a": 10, "b": "wxyz", "c": "[true, false]"} |
+----------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          ここでは、部分更新を実行できるように、<code class="literal">JSON_SET()</code> を使用してカラム値を更新します。この場合、<code class="literal">c</code> キー (配カラム<code class="literal">[true, false]</code>) が指す値を、使用する領域 (整数 <code class="literal">1</code>) が少なくなる値に置き換えます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE jtable</code></strong>
    -&gt;     <strong class="userinput"><code>SET jcol = JSON_SET(jcol, "$.a", 10, "$.b", "wxyz", "$.c", 1);</code></strong>
Query OK, 1 row affected (0.03 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM jtable;</code></strong>
+--------------------------------+
| jcol                           |
+--------------------------------+
| {"a": 10, "b": "wxyz", "c": 1} |
+--------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong>
+-------------------------+
| JSON_STORAGE_FREE(jcol) |
+-------------------------+
|                      14 |
+-------------------------+
1 row in set (0.00 sec)
</pre><p>
          この空き領域に対する連続した部分更新の影響は累積されます (この例では、<code class="literal">JSON_SET()</code> を使用して、キー <code class="literal">b</code> を持つ値によって取得される領域を削減し、その他の変更は行いません):
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE jtable</code></strong>
    -&gt;     <strong class="userinput"><code>SET jcol = JSON_SET(jcol, "$.a", 10, "$.b", "wx", "$.c", 1);</code></strong>
Query OK, 1 row affected (0.03 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong>
+-------------------------+
| JSON_STORAGE_FREE(jcol) |
+-------------------------+
|                      16 |
+-------------------------+
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">JSON_SET()</code>、<code class="literal">JSON_REPLACE()</code> または <code class="literal">JSON_REMOVE()</code> を使用せずにカラムを更新することは、オプティマイザがインプレースで更新を実行できないことを意味します。この場合、<code class="literal">JSON_STORAGE_FREE()</code> は次のように 0 を返します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE jtable SET jcol = '{"a": 10, "b": 1}';</code></strong>
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong>
+-------------------------+
| JSON_STORAGE_FREE(jcol) |
+-------------------------+
|                       0 |
+-------------------------+
1 row in set (0.00 sec)
</pre><p>
          JSON ドキュメントの部分更新は、カラム値に対してのみ実行できます。 JSON 値を格納するユーザー変数の場合、<code class="literal">JSON_SET()</code> を使用して更新を実行しても、値は常に完全に置換されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '{"a": 10, "b": "wxyz", "c": "[true, false]"}';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @j = JSON_SET(@j, '$.a', 10, '$.b', 'wxyz', '$.c', '1');</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_STORAGE_FREE(@j) AS Free;</code></strong>
+----------------------------------+------+
| @j                               | Free |
+----------------------------------+------+
| {"a": 10, "b": "wxyz", "c": "1"} |    0 |
+----------------------------------+------+
1 row in set (0.00 sec)
</pre><p>
          JSON リテラルの場合、この関数は常に 0 を戻します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_STORAGE_FREE('{"a": 10, "b": "wxyz", "c": "1"}') AS Free;</code></strong>
+------+
| Free |
+------+
|    0 |
+------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_json-storage-size"></a><p>
          <code class="literal">JSON_STORAGE_SIZE(<em class="replaceable"><code>json_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041614495504"></a><p>
          この関数は、JSON ドキュメントのバイナリ表現の格納に使用されるバイト数を戻します。 引数が <code class="literal">JSON</code> カラムの場合、これは、後で実行された部分更新の前に、JSON ドキュメントをカラムに挿入したときに格納するために使用される領域です。<em class="replaceable"><code>json_val</code></em> は、有効な JSON ドキュメントまたは解析可能な文字列である必要があります。 文字列の場合、関数は、文字列を JSON として解析してバイナリに変換することで作成される JSON バイナリ表現の記憶領域の量を戻します。 引数が <code class="literal">NULL</code> の場合、<code class="literal">NULL</code> を返します。 
        </p><p>
          <em class="replaceable"><code>json_val</code></em> が <code class="literal">NULL</code> ではなく、JSON ドキュメントとして正常に解析できない場合、エラーが発生します。
        </p><p>
          <code class="literal">JSON</code> カラムを引数として使用する場合のこの関数の動作を説明するために、次に示すように、<code class="literal">JSON</code> カラム <code class="literal">jcol</code> を含む <code class="literal">jtable</code> という名前のテーブルを作成し、JSON 値をテーブルに挿入してから、<code class="literal">JSON_STORAGE_SIZE()</code> でこのカラムによって使用される記憶領域を取得します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE jtable (jcol JSON);</code></strong>
Query OK, 0 rows affected (0.42 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO jtable VALUES</code></strong>
    -&gt;     <strong class="userinput"><code>('{"a": 1000, "b": "wxyz", "c": "[1, 3, 5, 7]"}');</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;     <strong class="userinput"><code>jcol,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong>
    -&gt; <strong class="userinput"><code>FROM jtable;</code></strong>
+-----------------------------------------------+------+------+
| jcol                                          | Size | Free |
+-----------------------------------------------+------+------+
| {"a": 1000, "b": "wxyz", "c": "[1, 3, 5, 7]"} |   47 |    0 |
+-----------------------------------------------+------+------+
1 row in set (0.00 sec)
</pre><p>
          <code class="literal">JSON_STORAGE_SIZE()</code> の出力によると、カラムに挿入される JSON ドキュメントは 47 バイトを占めます。 また、<code class="literal">JSON_STORAGE_FREE()</code> を使用して、カラムの以前の部分更新によって解放された領域の量も確認しました。更新がまだ実行されていないため、これは予想どおり 0 です。 
        </p><p>
          次に、<code class="literal">jcol</code> に格納されているドキュメントを部分的に更新するテーブルで <code class="literal">UPDATE</code> を実行し、次に示すように結果をテストします:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE jtable SET jcol = </code></strong>
    -&gt;     <strong class="userinput"><code>JSON_SET(jcol, "$.b", "a");</code></strong>
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;     <strong class="userinput"><code>jcol,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong>
    -&gt; <strong class="userinput"><code>FROM jtable;</code></strong>
+--------------------------------------------+------+------+
| jcol                                       | Size | Free |
+--------------------------------------------+------+------+
| {"a": 1000, "b": "a", "c": "[1, 3, 5, 7]"} |   47 |    3 |
+--------------------------------------------+------+------+
1 row in set (0.00 sec)
</pre><p>
          前のクエリーで <code class="literal">JSON_STORAGE_FREE()</code> によって返された値は、JSON ドキュメントの部分更新が実行され、格納に使用された 3 バイトの領域が解放されたことを示しています。 <code class="literal">JSON_STORAGE_SIZE()</code> によって返される結果は、部分更新によって変更されません。 
        </p><p>
          部分更新は、<code class="literal">JSON_SET()</code>、<code class="literal">JSON_REPLACE()</code> または <code class="literal">JSON_REMOVE()</code> を使用した更新でサポートされています。 <code class="literal">JSON</code> カラムへの値の直接割当ては部分的には更新できません。このような更新の後、<code class="literal">JSON_STORAGE_SIZE()</code> には常に、新しく設定された値に使用される記憶域が表示されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE jtable</code></strong>
mysql&gt;     <strong class="userinput"><code>SET jcol = '{"a": 4.55, "b": "wxyz", "c": "[true, false]"}';</code></strong>
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;     <strong class="userinput"><code>jcol,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong>
    -&gt; <strong class="userinput"><code>FROM jtable;</code></strong>
+------------------------------------------------+------+------+
| jcol                                           | Size | Free |
+------------------------------------------------+------+------+
| {"a": 4.55, "b": "wxyz", "c": "[true, false]"} |   56 |    0 |
+------------------------------------------------+------+------+
1 row in set (0.00 sec)
</pre><p>
          JSON ユーザー変数は部分的に更新できません。 つまり、この関数は、JSON ドキュメントをユーザー変数に格納するために現在使用されている領域を常に表示します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = '[100, "sakila", [1, 3, 5], 425.05]';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong>
+------------------------------------+------+
| @j                                 | Size |
+------------------------------------+------+
| [100, "sakila", [1, 3, 5], 425.05] |   45 |
+------------------------------------+------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @j = JSON_SET(@j, '$[1]', "json");</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong>
+----------------------------------+------+
| @j                               | Size |
+----------------------------------+------+
| [100, "json", [1, 3, 5], 425.05] |   43 |
+----------------------------------+------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @j = JSON_SET(@j, '$[2][0]', JSON_ARRAY(10, 20, 30));</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong>
+---------------------------------------------+------+
| @j                                          | Size |
+---------------------------------------------+------+
| [100, "json", [[10, 20, 30], 3, 5], 425.05] |   56 |
+---------------------------------------------+------+
1 row in set (0.00 sec)
</pre><p>
          JSON リテラルの場合、この関数は常に現在使用されている記憶領域を戻します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE('[100, "sakila", [1, 3, 5], 425.05]') AS A,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE('{"a": 1000, "b": "a", "c": "[1, 3, 5, 7]"}') AS B,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE('{"a": 1000, "b": "wxyz", "c": "[1, 3, 5, 7]"}') AS C,</code></strong>
    -&gt;     <strong class="userinput"><code>JSON_STORAGE_SIZE('[100, "json", [[10, 20, 30], 3, 5], 425.05]') AS D;</code></strong>
+----+----+----+----+
| A  | B  | C  | D  |
+----+----+----+----+
| 45 | 44 | 47 | 56 |
+----+----+----+----+
1 row in set (0.00 sec)
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gtid-functions"></a>12.19 グローバルトランザクション識別子 (GTID) で使用される機能</h2></div></div></div><a class="indexterm" name="idm46041614433552"></a><a class="indexterm" name="idm46041614432128"></a><p>
      このセクションで説明する機能は GTID ベースのレプリケーションで使用されます。 これらの関数はすべて GTID セットの文字列表現を引数として取ることに注意してください。 そのため、GTID セットと一緒に使用する場合は、常に引用符で囲む必要があります。 詳しくは<a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID セット">GTID セット</a>をご覧ください。 
    </p><p>
      2 つの GTID セットの結合は、単にカンマを挿入して結合された文字列として表現されたものです。 言い換えると、ここで作成した関数と同様に、非常に単純な関数を定義すれば、GTID セットの結合を取得できます。 
    </p><pre class="programlisting">CREATE FUNCTION GTID_UNION(g1 TEXT, g2 TEXT)
    RETURNS TEXT DETERMINISTIC
    RETURN CONCAT(g1,',',g2);
</pre><p>
      GTID の詳細およびこれらの GTID 関数を実際に使用する方法については、<a class="xref" href="replication.html#replication-gtids" title="17.1.3 グローバルトランザクション識別子を使用したレプリケーション">セクション17.1.3「グローバルトランザクション識別子を使用したレプリケーション」</a>を参照してください。
    </p><div class="table"><a name="idm46041614424704"></a><p class="title"><b>表 12.24 「GTID 関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「グローバルトランザクション識別子 (GTID) で使用される関数をリストする参照。」"><col style="width: 25%"><col style="width: 62%"><col style="width: 12%"><thead><tr><th>名前</th>
<th>説明</th>
<th>非推奨</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></th>
<td>
      サブセット内のすべての GTID がセット内にもある場合は、true を返します。そうでない場合は、false を返します。
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></th>
<td>
      セット内の GTID のうち、サブセット内にないものをすべてを返します。
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_wait-for-executed-gtid-set"><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code></a></th>
<td>
      指定された GTID がレプリカで実行されるまで待機します。
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></th>
<td>
      <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code> の使用。
    </td>
<td>8.0.18</td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_gtid-subset"></a><p>
          <code class="literal">GTID_SUBSET(<em class="replaceable"><code>set1</code></em>,<em class="replaceable"><code>set2</code></em>)</code>
        </p><a class="indexterm" name="idm46041614393696"></a><p>
          グローバルトランザクション識別子 <em class="replaceable"><code>set1</code></em> および <em class="replaceable"><code>set2</code></em> の 2 つのセットが指定されている場合、<em class="replaceable"><code>set1</code></em> 内のすべての GTID も <em class="replaceable"><code>set2</code></em> 内にあると true を返します。 それ以外の場合は、false  を返します。 
        </p><p>
          この関数で使用される GTID セットは、次の例で示すように文字列で表現されます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 1
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23-25',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23-25',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 1
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 0
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_gtid-subtract"></a><p>
          <code class="literal">GTID_SUBTRACT(<em class="replaceable"><code>set1</code></em>,<em class="replaceable"><code>set2</code></em>)</code>
        </p><a class="indexterm" name="idm46041614375536"></a><p>
          グローバルトランザクション識別子 <em class="replaceable"><code>set1</code></em> および <em class="replaceable"><code>set2</code></em> の 2 つのセットがある場合、<em class="replaceable"><code>set2</code></em> にない GTID のみを <em class="replaceable"><code>set1</code></em> から返します。
        </p><p>
          この関数で使用される GTID セットはすべて文字列で表現されるため、次の例で示すように引用符で囲む必要があります。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:22-57
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:26-57
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong>
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:23-24')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:23-24'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:21-22:25-57
1 row in set (0.01 sec)
</pre></li><li class="listitem"><a name="function_wait-for-executed-gtid-set"></a><p>
          <code class="literal">WAIT_FOR_EXECUTED_GTID_SET(<em class="replaceable"><code>gtid_set</code></em>[, <em class="replaceable"><code>timeout</code></em>])</code>
        </p><a class="indexterm" name="idm46041614357072"></a><p>
          サーバーが、グローバルトランザクション識別子が <em class="replaceable"><code>gtid_set</code></em> に含まれているすべてのトランザクションを適用する (つまり、GTID_SUBSET(<em class="replaceable"><code>gtid_subset</code></em>, <code class="literal">@@GLOBAL.gtid_executed</code>) が保持する) まで待機します。 GTID セットの定義については、<a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID 形式および格納">セクション17.1.3.1「GTID 形式および格納」</a> を参照してください。 
        </p><p>
          タイムアウトが指定され、GTID セット内のすべてのトランザクションが適用されるまで <em class="replaceable"><code>timeout</code></em> 秒が経過すると、関数は待機を停止します。<em class="replaceable"><code>timeout</code></em> はオプションで、デフォルトのタイムアウトは 0 秒です。この場合、GTID セット内のすべてのトランザクションが適用されるまで、関数は常に待機します。
        </p><p>
          <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code> は、すべてのレプリケーションチャネルおよびユーザークライアントから到着したトランザクションを含め、サーバーに適用されている GTID をすべて監視します。 レプリケーションチャネルが起動しているか停止しているかは考慮されません。 
        </p><p>
          詳細は、<a class="xref" href="replication.html#replication-gtids" title="17.1.3 グローバルトランザクション識別子を使用したレプリケーション">セクション17.1.3「グローバルトランザクション識別子を使用したレプリケーション」</a>を参照してください。
        </p><p>
          この関数で使用される GTID セットは、次の例で示すように文字列で表現されるため、引用符で囲む必要があります。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT WAIT_FOR_EXECUTED_GTID_SET('3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5');</code></strong>
        -&gt; 0
</pre><p>
          GTID セットの構文の説明については、<a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID 形式および格納">セクション17.1.3.1「GTID 形式および格納」</a> を参照してください。
        </p><p>
          <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code> の場合、戻り値はクエリーの状態です。0 は成功を表し、1 はタイムアウトを表します。 その他の障害では、エラーが生成されます。 
        </p><p>
          GTID が適用されるのを待機するためにクライアントがこの機能を使用している間は、<code class="literal">gtid_mode</code> を OFF に変更できません。
        </p></li><li class="listitem"><a name="function_wait-until-sql-thread-after-gtids"></a><p>
          <code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS(<em class="replaceable"><code>gtid_set</code></em>[, <em class="replaceable"><code>timeout</code></em>][,<em class="replaceable"><code>channel</code></em>])</code>
        </p><a class="indexterm" name="idm46041614332608"></a><p>
          <code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code> は非推奨です。 かわりに <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code> を使用してください。これは、指定したトランザクションがサーバーに到着するレプリケーションチャネルまたはユーザークライアントに関係なく機能します。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aggregate-functions-and-modifiers"></a>12.20 集計関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#aggregate-functions">12.20.1 集計関数の説明</a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers">12.20.2 GROUP BY 修飾子</a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling">12.20.3 MySQL での GROUP BY の処理</a></span></dt><dt><span class="section"><a href="functions.html#group-by-functional-dependence">12.20.4 機能依存性の検出</a></span></dt></dl></div><p>
      集計関数は、値のセットを操作します。 多くの場合、値をサブセットにグループ化するために <code class="literal">GROUP BY</code> 句とともに使用されます。 このセクションでは、ほとんどの集計関数について説明します。 ジオメトリ値を操作する集計関数の詳細は、<a class="xref" href="functions.html#spatial-aggregate-functions" title="12.17.12 空間集計関数">セクション12.17.12「空間集計関数」</a> を参照してください。 
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="aggregate-functions"></a>12.20.1 集計関数の説明</h3></div></div></div><a class="indexterm" name="idm46041614322048"></a><a class="indexterm" name="idm46041614320624"></a><a class="indexterm" name="idm46041614318960"></a><a class="indexterm" name="idm46041614317488"></a><a class="indexterm" name="idm46041614315824"></a><p>
        このセクションでは、値のセットを操作する集計関数について説明します。 多くの場合、値をサブセットにグループ化するために <code class="literal">GROUP BY</code> 句とともに使用されます。 
      </p><div class="table"><a name="idm46041614312080"></a><p class="title"><b>表 12.25 「集計関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「集計関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></td>
<td>
      引数の平均値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></td>
<td>
      ビット単位 AND を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></td>
<td>
      ビット単位の OR を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></td>
<td>
      ビット単位 XOR を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></td>
<td>
      返された行数のカウントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></td>
<td>
      異なる値のカウントを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></td>
<td>
      連結された文字列を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a></td>
<td>
      結果セットを単一の JSON 配列として返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a></td>
<td>
      結果セットを単一の JSON オブジェクトとして返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></td>
<td>
      最大値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></td>
<td>
      最小値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></td>
<td>
      母標準偏差を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></td>
<td>
      母標準偏差を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></td>
<td>
      母標準偏差を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></td>
<td>
      標本標準偏差を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></td>
<td>
      集計を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></td>
<td>
      母標準分散を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></td>
<td>
      標本分散を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></td>
<td>
      母標準分散を返します
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        特に明記されていないかぎり、集計関数は <code class="literal">NULL</code> 値を無視します。
      </p><p>
        <code class="literal">GROUP BY</code> 句を含まないステートメントで集計関数を使用する場合、すべての行でのグループ化と同等です。 詳細は、<a class="xref" href="functions.html#group-by-handling" title="12.20.3 MySQL での GROUP BY の処理">セクション12.20.3「MySQL での GROUP BY の処理」</a>を参照してください。 
      </p><p>
        ほとんどの集計関数は、ウィンドウ関数として使用できます。 この方法で使用できるものは、オプションの <code class="literal">OVER</code> 句を表す<code class="literal">[<em class="replaceable"><code>over_clause</code></em>]</code>の構文の説明で示されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されており、ウィンドウ関数の使用方法に関するその他の情報も含まれています。 
      </p><p>
        数値の引数の場合、分散および標準偏差関数が <code class="literal">DOUBLE</code> 値を返します。 <code class="literal">SUM()</code> および <code class="literal">AVG()</code> 関数は、正確な値の引数 (整数または <code class="literal">DECIMAL</code>) の場合は <code class="literal">DECIMAL</code> 値を返し、近似値の引数 (<code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code>) の場合は <code class="literal">DOUBLE</code> 値を返します。 
      </p><p>
        <code class="literal">SUM()</code> および <code class="literal">AVG()</code> 集計関数は時間値を扱いません。 (これらは値を数字に変換するので、最初の数字以外の文字のあとのすべての情報が失われます。) この問題を回避するには、数値単位に変換し、集計操作を実行してから、時間値に戻します。 例: 
      </p><pre class="programlisting">SELECT SEC_TO_TIME(SUM(TIME_TO_SEC(<em class="replaceable"><code>time_col</code></em>))) FROM <em class="replaceable"><code>tbl_name</code></em>;
SELECT FROM_DAYS(SUM(TO_DAYS(<em class="replaceable"><code>date_col</code></em>))) FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
        数値引数を取る <code class="literal">SUM()</code> や <code class="literal">AVG()</code> などの関数は、必要に応じて引数を数値にキャストします。 <code class="literal">SET</code> や <code class="literal">ENUM</code> 値の場合、キャスト演算でベースとなる数値が使用されます。 
      </p><p>
        <code class="literal">BIT_AND()</code>、<code class="literal">BIT_OR()</code> および <code class="literal">BIT_XOR()</code> の集計関数は、ビット操作を実行します。 MySQL 8.0 より前では、ビット関数および演算子には <code class="literal">BIGINT</code> (64-bit 整数) 引数が必要であり、<code class="literal">BIGINT</code> 値が返されるため、最大範囲は 64 ビットでした。 操作の実行前に <code class="literal">BIGINT</code> 以外の引数が <code class="literal">BIGINT</code> に変換され、切捨てが発生する可能性があります。 
      </p><p>
        MySQL 8.0 では、ビット関数および演算子はバイナリ文字列型の引数 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code> および <code class="literal">BLOB</code> 型) を許可し、同様の型の値を返します。これにより、引数を受け取り、64 ビットを超える戻り値を生成できます。 ビット操作の引数評価および結果タイプの詳細は、<a class="xref" href="functions.html#bit-functions" title="12.13 ビット関数と演算子">セクション12.13「ビット関数と演算子」</a> の概要を参照してください。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_avg"></a><p>
            <code class="literal">AVG([DISTINCT] <em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041614203248"></a><a class="indexterm" name="idm46041614201904"></a><a class="indexterm" name="idm46041614200560"></a><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em></code> の平均値を返します。 <code class="literal">DISTINCT</code> オプションを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の平均を返すことができます。 
          </p><p>
            一致する行がない場合、<code class="literal">AVG()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているように、<code class="literal">DISTINCT</code> では使用できません。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student_name, AVG(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre></li><li class="listitem"><a name="function_bit-and"></a><p>
            <code class="literal">BIT_AND(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041614180560"></a><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">AND</code> を返します。
          </p><p>
            結果の型は、関数の引数値がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数値がバイナリ文字列型で、引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、必要に応じて引数値が符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数値と同じ長さのバイナリ文字列が生成されます。 引数値の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 引数のサイズが 511 バイトを超えると、<code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            一致する行がない場合、<code class="literal">BIT_AND()</code> は引数値と同じ長さのニュートラル値 (すべて 1 に設定されたビット) を返します。
          </p><p>
            すべての値が <code class="literal">NULL</code> でないかぎり、<code class="literal">NULL</code> 値は結果に影響しません。 その場合、結果は引数値と同じ長さの中立値になります。 
          </p><p>
            引数の評価および結果タイプの詳細は、<a class="xref" href="functions.html#bit-functions" title="12.13 ビット関数と演算子">セクション12.13「ビット関数と演算子」</a> の概要に関する説明を参照してください。
          </p><p>
            MySQL 8.0.12 では、<em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているとおりです。
          </p></li><li class="listitem"><a name="function_bit-or"></a><p>
            <code class="literal">BIT_OR(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041614156544"></a><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">OR</code> を返します。
          </p><p>
            結果の型は、関数の引数値がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数値がバイナリ文字列型で、引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、必要に応じて引数値が符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数値と同じ長さのバイナリ文字列が生成されます。 引数値の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 引数のサイズが 511 バイトを超えると、<code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            一致する行がない場合、<code class="literal">BIT_OR()</code> は引数値と同じ長さのニュートラル値 (すべて 0 に設定されたビット) を返します。
          </p><p>
            すべての値が <code class="literal">NULL</code> でないかぎり、<code class="literal">NULL</code> 値は結果に影響しません。 その場合、結果は引数値と同じ長さの中立値になります。 
          </p><p>
            引数の評価および結果タイプの詳細は、<a class="xref" href="functions.html#bit-functions" title="12.13 ビット関数と演算子">セクション12.13「ビット関数と演算子」</a> の概要に関する説明を参照してください。
          </p><p>
            MySQL 8.0.12 では、<em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているとおりです。
          </p></li><li class="listitem"><a name="function_bit-xor"></a><p>
            <code class="literal">BIT_XOR(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041614132592"></a><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">XOR</code> を返します。
          </p><p>
            結果の型は、関数の引数値がバイナリ文字列として評価されるか、数値として評価されるかによって異なります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                バイナリ文字列の評価は、引数値がバイナリ文字列型で、引数が 16 進数リテラル、ビットリテラルまたは <code class="literal">NULL</code> リテラルでない場合に発生します。 それ以外の場合は数値の評価が行われ、必要に応じて引数値が符号なし 64 ビット整数に変換されます。 
              </p></li><li class="listitem"><p>
                バイナリ文字列の評価では、引数値と同じ長さのバイナリ文字列が生成されます。 引数値の長さが等しくない場合は、<code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code> エラーが発生します。 引数のサイズが 511 バイトを超えると、<code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code> エラーが発生します。 数値評価では符号なし 64 ビット整数が生成されます。 
              </p></li></ul></div><p>
            一致する行がない場合、<code class="literal">BIT_XOR()</code> は引数値と同じ長さのニュートラル値 (すべて 0 に設定されたビット) を返します。
          </p><p>
            すべての値が <code class="literal">NULL</code> でないかぎり、<code class="literal">NULL</code> 値は結果に影響しません。 その場合、結果は引数値と同じ長さの中立値になります。 
          </p><p>
            引数の評価および結果タイプの詳細は、<a class="xref" href="functions.html#bit-functions" title="12.13 ビット関数と演算子">セクション12.13「ビット関数と演算子」</a> の概要に関する説明を参照してください。
          </p><p>
            MySQL 8.0.12 では、<em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているとおりです。
          </p></li><li class="listitem"><a name="function_count"></a><p>
            <code class="literal">COUNT(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041614108336"></a><p>
            <code class="literal">SELECT</code> ステートメントで取得された行に含まれる <em class="replaceable"><code>expr</code></em> の非 <code class="literal">NULL</code> 値の数を返します。 結果は <code class="literal">BIGINT</code> 値になります。 
          </p><p>
            一致する行がない場合、<code class="literal">COUNT()</code> は <code class="literal">0</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student.student_name,COUNT(*)</code></strong>
       <strong class="userinput"><code>FROM student,course</code></strong>
       <strong class="userinput"><code>WHERE student.student_id=course.student_id</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            <code class="literal">COUNT(*)</code> は、<code class="literal">NULL</code> 値が含まれるかどうかに関係なく、取得された行の数を返すという点で少し異なります。
          </p><p>
            <code class="literal">InnoDB</code> などのトランザクションストレージエンジンでは、正確な行数の格納に問題があります。 複数のトランザクションが同時に発生する可能性があり、それぞれがカウントに影響する可能性があります。 
          </p><p>
            並列トランザクションでは同時にさまざまな数の行が<span class="quote">「<span class="quote">参照</span>」</span>される可能性があるため、<code class="literal">InnoDB</code> のテーブルには、行の内部的なカウントが保持されません。 したがって、<code class="literal">SELECT COUNT(*)</code> ステートメントでは、現在のトランザクションで参照可能な行のみがカウントされます。 
          </p><p>
            MySQL 8.0.13 では、<code class="literal">WHERE</code>、<code class="literal">GROUP BY</code> などの追加句がない場合、<code class="literal">InnoDB</code> テーブルの <code class="literal">SELECT COUNT(*) FROM <em class="replaceable"><code>tbl_name</code></em></code> クエリーパフォーマンスはシングルスレッドワークロード用に最適化されます。
          </p><p>
            <code class="literal">InnoDB</code> は、インデックスまたはオプティマイザヒントがオプティマイザに別のインデックスを使用するように指示しないかぎり、使用可能な最小のセカンダリインデックスを横断することで <code class="literal">SELECT COUNT(*)</code> ステートメントを処理します。 セカンダリインデックスが存在しない場合、<code class="literal">InnoDB</code> はクラスタインデックスをスキャンして <code class="literal">SELECT COUNT(*)</code> ステートメントを処理します。 
          </p><p>
            インデックスレコードがバッファプールに完全に含まれていない場合、<code class="literal">SELECT COUNT(*)</code> ステートメントの処理には時間がかかります。 カウントを高速化するには、カウンタテーブルを作成し、挿入および削除に従ってカウンタテーブルを更新できるようにします。 ただし、何千もの同時トランザクションが同じカウンタテーブルへの更新を開始している状況では、この方法は適切にスケーリングされない場合があります。 概算の行数で十分な場合は、<code class="literal">SHOW TABLE STATUS</code> を使用します。 
          </p><p>
            <code class="literal">InnoDB</code> は、<code class="literal">SELECT COUNT(*)</code> と <code class="literal">SELECT COUNT(1)</code> の操作を同じ方法で処理します。 パフォーマンスに違いはありません。 
          </p><p>
            <code class="literal">MyISAM</code> テーブルの場合、<code class="literal">COUNT(*)</code> は、<code class="literal">SELECT</code> があるテーブルから取得し、他のカラムが取得されず、<code class="literal">WHERE</code> 句がない場合に非常に迅速に返すように最適化されます。 例: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM student;</code></strong>
</pre><p>
            この最適化は <code class="literal">MyISAM</code> テーブルにのみ適用されます。これは、正確な行数がこのストレージエンジン用に格納され、非常に迅速にアクセスできるためです。 <code class="literal">COUNT(1)</code> は、最初のカラムが <code class="literal">NOT NULL</code> として定義されている場合にのみ、同じ最適化の対象となります。 
          </p></li><li class="listitem"><a name="function_count-distinct"></a><p>
            <code class="literal">COUNT(DISTINCT <em class="replaceable"><code>expr</code></em>,[<em class="replaceable"><code>expr</code></em>...])</code>
          </p><a class="indexterm" name="idm46041614057152"></a><a class="indexterm" name="idm46041614055808"></a><p>
            さまざまな非 <code class="literal">NULL</code> <em class="replaceable"><code>expr</code></em> 値を含む行の数を返します。
          </p><p>
            一致する行がない場合、<code class="literal">COUNT(DISTINCT)</code> は <code class="literal">0</code> を返します。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COUNT(DISTINCT results) FROM student;</code></strong>
</pre><p>
            MySQL では、式のリストを指定することで、<code class="literal">NULL</code> が含まれない個別の式の組み合わせ数を取得できます。 標準 SQL では、<code class="literal">COUNT(DISTINCT ...)</code> 内部で、すべての式の連結を行う必要があります。 
          </p></li><li class="listitem"><a name="function_group-concat"></a><p>
            <code class="literal">GROUP_CONCAT(<em class="replaceable"><code>expr</code></em>)</code>
          </p><a class="indexterm" name="idm46041614038912"></a><p>
            この関数は、グループから連結された非 <code class="literal">NULL</code> 値を含む文字列の結果を返します。 非 <code class="literal">NULL</code> 値がない場合は、<code class="literal">NULL</code> を返します。 完全な構文は次のとおりです。 
          </p><pre class="programlisting">GROUP_CONCAT([DISTINCT] <em class="replaceable"><code>expr</code></em> [,<em class="replaceable"><code>expr</code></em> ...]
             [ORDER BY {<em class="replaceable"><code>unsigned_integer</code></em> | <em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em>}
                 [ASC | DESC] [,<em class="replaceable"><code>col_name</code></em> ...]]
             [SEPARATOR <em class="replaceable"><code>str_val</code></em>])
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student_name,</code></strong>
         <strong class="userinput"><code>GROUP_CONCAT(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            または:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student_name,</code></strong>
         <strong class="userinput"><code>GROUP_CONCAT(DISTINCT test_score</code></strong>
                      <strong class="userinput"><code>ORDER BY test_score DESC SEPARATOR ' ')</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            MySQL では、式の組み合わせを連結した値を取得できます。 重複する値を除去するには、<code class="literal">DISTINCT</code> 句を使用します。 結果の値をソートするには、<code class="literal">ORDER BY</code> 句を使用します。 逆順でソートするには、<code class="literal">ORDER BY</code> 句のソートするカラムの名前に <code class="literal">DESC</code> (降順) キーワードを追加します。 デフォルトは昇順です。これは、<code class="literal">ASC</code> キーワードを使用することで明示的に指定できます。 グループ内の値間のデフォルトの区切り文字は、カンマ (<code class="literal">,</code>) です。 区切り文字を明示的に指定するには、<code class="literal">SEPARATOR</code> に続けて、グループ値の間に挿入される文字列リテラル値を指定します。 区切り文字を完全に除去するには、<code class="literal">SEPARATOR ''</code> を指定します。 
          </p><p>
            結果は、<code class="literal">group_concat_max_len</code> システム変数で指定された最大長まで切り捨てられます。その変数のデフォルト値は 1024 です。 さらに高い値にも設定できますが、戻り値の有効な最大長は、<code class="literal">max_allowed_packet</code> の値によって制約されます。 実行時に <code class="literal">group_concat_max_len</code> の値を変更するための構文は、次のとおりです。ここで、<em class="replaceable"><code>val</code></em> は符号なし整数です。 
          </p><pre class="programlisting">SET [GLOBAL | SESSION] group_concat_max_len = <em class="replaceable"><code>val</code></em>;
</pre><p>
            戻り値は、引数が非バイナリとバイナリのどちらの文字列であるのかに応じて、非バイナリ文字列またはバイナリ文字列になります。 結果の型は、<code class="literal">group_concat_max_len</code> が 512 以下の場合 (この場合、結果の型は <code class="literal">VARCHAR</code> または <code class="literal">VARBINARY</code> です) を除いて、<code class="literal">TEXT</code> または <code class="literal">BLOB</code> です。 
          </p><p>
            <code class="literal">CONCAT()</code> および <code class="literal">CONCAT_WS()</code>: <a class="xref" href="functions.html#string-functions" title="12.8 文字列関数および演算子">セクション12.8「文字列関数および演算子」</a>も参照してください。
          </p></li><li class="listitem"><a name="function_json-arrayagg"></a><p>
            <code class="literal">JSON_ARRAYAGG(<em class="replaceable"><code>col_or_expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613992480"></a><p>
            結果セットを、要素が行で構成される単一の <code class="literal">JSON</code> 配列として集計します。 この配列の要素の順序が定義されていません。 この関数は、単一の値に評価されるカラムまたは式に対して機能します。 結果に行が含まれていない場合、またはエラーが発生した場合は、<code class="literal">NULL</code> を返します。 
          </p><p>
            MySQL 8.0.14 では、<em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているとおりです。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT o_id, attribute, value FROM t3;</code></strong>
+------+-----------+-------+
| o_id | attribute | value |
+------+-----------+-------+
|    2 | color     | red   |
|    2 | fabric    | silk  |
|    3 | color     | green |
|    3 | shape     | square|
+------+-----------+-------+
4 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT o_id, JSON_ARRAYAGG(attribute) AS attributes</code></strong>
     &gt; <strong class="userinput"><code>FROM t3 GROUP BY o_id;</code></strong>
+------+---------------------+
| o_id | attributes          |
+------+---------------------+
|    2 | ["color", "fabric"] |
|    3 | ["color", "shape"]  |
+------+---------------------+
2 rows in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_json-objectagg"></a><p>
            <code class="literal">JSON_OBJECTAGG(<em class="replaceable"><code>key</code></em>, <em class="replaceable"><code>value</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613974336"></a><p>
            2 つのカラム名または式を引数として取ります。最初のカラム名または式はキーとして使用され、2 番目のカラム名または式は値として使用され、キーと値のペアを含む JSON オブジェクトを返します。 結果に行が含まれていない場合、またはエラーが発生した場合は、<code class="literal">NULL</code> を返します。 いずれかのキー名が <code class="literal">NULL</code> であるか、引数の数が 2 でない場合、エラーが発生します。 
          </p><p>
            MySQL 8.0.14 では、<em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は <a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているとおりです。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT o_id, attribute, value FROM t3;</code></strong>
+------+-----------+-------+
| o_id | attribute | value |
+------+-----------+-------+
|    2 | color     | red   |
|    2 | fabric    | silk  |
|    3 | color     | green |
|    3 | shape     | square|
+------+-----------+-------+
4 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT o_id, JSON_OBJECTAGG(attribute, value)</code></strong>
     &gt; <strong class="userinput"><code>FROM t3 GROUP BY o_id;</code></strong>
+------+---------------------------------------+
| o_id | JSON_OBJECTAGG(attribute, value)      |
+------+---------------------------------------+
|    2 | {"color": "red", "fabric": "silk"}    |
|    3 | {"color": "green", "shape": "square"} |
+------+---------------------------------------+
2 rows in set (0.00 sec)
</pre><p><b>重複キーの処理. </b>
              この関数の結果が正規化されると、重複するキーを持つ値は破棄されます。 重複キーを許可しない MySQL <code class="literal">JSON</code> データ型指定に従うと、返されるオブジェクト (<span class="quote">「<span class="quote">「最後の重複キー優先」</span>」</span>) でそのキーで最後に検出された値のみが使用されます。 つまり、<code class="literal">SELECT</code> のカラムでこの関数を使用した結果は、戻される行の順序に依存する可能性がありますが、これは保証されていません。 
            </p><p>
            ウィンドウ関数として使用する場合、フレーム内に重複するキーがあると、そのキーの最後の値のみが結果に表示されます。 <code class="literal">ORDER BY</code> 仕様で値が特定の順序であることが保証されている場合、フレームの最後の行のキーの値は決定的です。 そうでない場合、キーの結果値は非決定的です。 
          </p><p>
            次について考えます。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t(c VARCHAR(10), i INT);</code></strong>
Query OK, 0 rows affected (0.33 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES ('key', 3), ('key', 4), ('key', 5);</code></strong>
Query OK, 3 rows affected (0.10 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT c, i FROM t;</code></strong>
+------+------+
| c    | i    |
+------+------+
| key  |    3 |
| key  |    4 |
| key  |    5 |
+------+------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i) FROM t;</code></strong>
+----------------------+
| JSON_OBJECTAGG(c, i) |
+----------------------+
| {"key": 5}           |
+----------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DELETE FROM t;</code></strong>
Query OK, 3 rows affected (0.08 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES ('key', 3), ('key', 5), ('key', 4);</code></strong>
Query OK, 3 rows affected (0.06 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT c, i FROM t;</code></strong>
+------+------+
| c    | i    |
+------+------+
| key  |    3 |
| key  |    5 |
| key  |    4 |
+------+------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i) FROM t;</code></strong>
+----------------------+
| JSON_OBJECTAGG(c, i) |
+----------------------+
| {"key": 4}           |
+----------------------+
1 row in set (0.00 sec)
</pre><p>
            最後のクエリーから選択されたキーは非決定的です。 特定のキーの順序付けが必要な場合は、フレーム行に特定の順序を適用する <code class="literal">ORDER BY</code> 仕様に <code class="literal">OVER</code> 句を含めることで、<code class="literal">JSON_OBJECTAGG()</code> をウィンドウ関数として起動できます。 次の例は、いくつかの異なるフレーム仕様について、<code class="literal">ORDER BY</code> の有無に応じて何が起こるかを示しています。 
          </p><p>
            <code class="literal">ORDER BY</code> がない場合、フレームはパーティション全体です:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER () AS json_object FROM t;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 4}  |
| {"key": 4}  |
| {"key": 4}  |
+-------------+
</pre><p>
            <code class="literal">ORDER BY</code> では、フレームはデフォルトの <code class="literal">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code> (昇順と降順の両方) です:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i) AS json_object FROM t;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 3}  |
| {"key": 4}  |
| {"key": 5}  |
+-------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i DESC) AS json_object FROM t;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 5}  |
| {"key": 4}  |
| {"key": 3}  |
+-------------+
</pre><p>
            <code class="literal">ORDER BY</code> およびパーティション全体の明示的なフレームを使用する場合:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i</code></strong>
            <strong class="userinput"><code>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)</code></strong>
        <strong class="userinput"><code>AS json_object</code></strong>
       <strong class="userinput"><code>FROM t;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 5}  |
| {"key": 5}  |
| {"key": 5}  |
+-------------+
</pre><p>
            特定のキー値 (最小値や最大値など) を返すには、適切なクエリーに <code class="literal">LIMIT</code> 句を含めます。 例: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i) AS json_object FROM t LIMIT 1;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 3}  |
+-------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i DESC) AS json_object FROM t LIMIT 1;</code></strong>
+-------------+
| json_object |
+-------------+
| {"key": 5}  |
+-------------+
</pre><p>
            追加情報および例については、<a class="xref" href="data-types.html#json-normalization" title="JSON 値の正規化、マージおよび自動ラップ">JSON 値の正規化、マージおよび自動ラップ</a>を参照してください。
          </p></li><li class="listitem"><a name="function_max"></a><p>
            <code class="literal">MAX([DISTINCT] <em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613914976"></a><a class="indexterm" name="idm46041613913632"></a><a class="indexterm" name="idm46041613912288"></a><p>
            <em class="replaceable"><code>expr</code></em> の最大値を返します。 <code class="literal">MAX()</code> には、文字列の引数を指定できます。このような場合は、最大の文字列値が返されます。 <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL のインデックスの使用の仕組み">セクション8.3.1「MySQL のインデックスの使用の仕組み」</a>を参照してください。 <code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の最大を検索できます。ただし、<code class="literal">DISTINCT</code> を省略した場合と同じ結果が生成されます。 
          </p><p>
            一致する行がない場合、<code class="literal">MAX()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているように、<code class="literal">DISTINCT</code> では使用できません。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            現在、MySQL の <code class="literal">MAX()</code> では、<code class="literal">ENUM</code> と <code class="literal">SET</code> カラムが、セット内の文字列の相対位置ではなく、文字列値について比較されます。 これは、<code class="literal">ORDER BY</code> による比較方法とは異なります。 
          </p></li><li class="listitem"><a name="function_min"></a><p>
            <code class="literal">MIN([DISTINCT] <em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613885568"></a><a class="indexterm" name="idm46041613884224"></a><a class="indexterm" name="idm46041613882880"></a><p>
            <em class="replaceable"><code>expr</code></em> の最小値を返します。 <code class="literal">MIN()</code> には、文字列の引数を指定できます。このような場合は、最小の文字列値が返されます。 <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL のインデックスの使用の仕組み">セクション8.3.1「MySQL のインデックスの使用の仕組み」</a>を参照してください。 <code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の最小を検索できます。ただし、<code class="literal">DISTINCT</code> を省略した場合と同じ結果が生成されます。 
          </p><p>
            一致する行がない場合、<code class="literal">MIN()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているように、<code class="literal">DISTINCT</code> では使用できません。
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            現在、MySQL の <code class="literal">MIN()</code> では、<code class="literal">ENUM</code> と <code class="literal">SET</code> カラムが、セット内の文字列の相対位置ではなく、文字列値について比較されます。 これは、<code class="literal">ORDER BY</code> による比較方法とは異なります。 
          </p></li><li class="listitem"><a name="function_std"></a><p>
            <code class="literal">STD(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613856096"></a><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差を返します。 <code class="literal">STD()</code> は、MySQL 拡張機能として提供される標準 SQL 関数 <code class="literal">STDDEV_POP()</code> のシノニムです。 
          </p><p>
            一致する行がない場合、<code class="literal">STD()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_stddev"></a><p>
            <code class="literal">STDDEV(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613840656"></a><a class="indexterm" name="idm46041613839568"></a><a class="indexterm" name="idm46041613838080"></a><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差を返します。 <code class="literal">STDDEV()</code> は、Oracle との互換性のために提供されている標準 SQL 関数 <code class="literal">STDDEV_POP()</code> のシノニムです。 
          </p><p>
            一致する行がない場合、<code class="literal">STDDEV()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_stddev-pop"></a><p>
            <code class="literal">STDDEV_POP(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613822144"></a><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差 (<code class="literal">VAR_POP()</code> の平方根) を返します。 <code class="literal">STD()</code> または <code class="literal">STDDEV()</code> を使用することもできます。これらは同等ですが、標準 SQL ではありません。 
          </p><p>
            一致する行がない場合、<code class="literal">STDDEV_POP()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_stddev-samp"></a><p>
            <code class="literal">STDDEV_SAMP(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613805648"></a><p>
            <em class="replaceable"><code>expr</code></em> の標本標準偏差 (<code class="literal">VAR_SAMP()</code> の平方根) を返します。
          </p><p>
            一致する行がない場合、<code class="literal">STDDEV_SAMP()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_sum"></a><p>
            <code class="literal">SUM([DISTINCT] <em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613790736"></a><a class="indexterm" name="idm46041613789392"></a><a class="indexterm" name="idm46041613788048"></a><p>
            <em class="replaceable"><code>expr</code></em> の集計を返します。 戻り値のセットに行が含まれていない場合、<code class="literal">SUM()</code> は <code class="literal">NULL</code> を返します。 <code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値のみを集計できます。 
          </p><p>
            一致する行がない場合、<code class="literal">SUM()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> は、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているように、<code class="literal">DISTINCT</code> では使用できません。
          </p></li><li class="listitem"><a name="function_var-pop"></a><p>
            <code class="literal">VAR_POP(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613770144"></a><p>
            <em class="replaceable"><code>expr</code></em> の母標準分散を返します。 行は標本ではなく、母集団全体とみなされるため、行の数が分母とみなされます。 また、<code class="literal">VARIANCE()</code> を使用することもできます。これは同等ですが、標準 SQL ではありません。 
          </p><p>
            一致する行がない場合、<code class="literal">VAR_POP()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_var-samp"></a><p>
            <code class="literal">VAR_SAMP(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613755424"></a><p>
            <em class="replaceable"><code>expr</code></em> の標本分散を返します。 つまり、分母は行の数から 1 を引いたものです。 
          </p><p>
            一致する行がない場合、<code class="literal">VAR_SAMP()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_variance"></a><p>
            <code class="literal">VARIANCE(<em class="replaceable"><code>expr</code></em>) [<em class="replaceable"><code>over_clause</code></em>]</code>
          </p><a class="indexterm" name="idm46041613742000"></a><p>
            <em class="replaceable"><code>expr</code></em> の母標準分散を返します。 <code class="literal">VARIANCE()</code> は、MySQL 拡張機能として提供される標準 SQL 関数 <code class="literal">VAR_POP()</code> のシノニムです。 
          </p><p>
            一致する行がない場合、<code class="literal">VARIANCE()</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> が存在する場合、この関数はウィンドウ関数として実行されます。<em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-modifiers"></a>12.20.2 GROUP BY 修飾子</h3></div></div></div><a class="indexterm" name="idm46041613730048"></a><a class="indexterm" name="idm46041613728736"></a><a class="indexterm" name="idm46041613727392"></a><a class="indexterm" name="idm46041613726048"></a><a class="indexterm" name="idm46041613724016"></a><p>
        <code class="literal">GROUP BY</code> 句を使用すると、サマリー出力に上位レベル (つまり、上位集計) のサマリー操作を表す追加の行を含めることができる <code class="literal">WITH ROLLUP</code> 修飾子が許可されます。 したがって、<code class="literal">ROLLUP</code> で単一のクエリーを使用すれば、複数レベルの分析で質問に回答できます。 たとえば、<code class="literal">ROLLUP</code> を使用して OLAP (オンライン分析処理) 操作をサポートできます。 
      </p><p>
        <code class="literal">sales</code> テーブルに、売上収益性を記録するための <code class="literal">year</code>, <code class="literal">country</code>, <code class="literal">product</code> カラムと <code class="literal">profit</code> カラムがあるとします:
      </p><pre class="programlisting">CREATE TABLE sales
(
    year    INT,
    country VARCHAR(20),
    product VARCHAR(32),
    profit  INT
);
</pre><p>
        年ごとにテーブルの内容を要約するには、次のような単純な <code class="literal">GROUP BY</code> を使用します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year;</code></strong>
+------+--------+
| year | profit |
+------+--------+
| 2000 |   4525 |
| 2001 |   3010 |
+------+--------+
</pre><p>
        出力には、各年の利益の合計 (集計) が表示されます。 すべての年の合計利益も決定するには、個々の値を自分で加算するか、追加のクエリーを実行する必要があります。 または、単一のクエリーで両方のレベルの分析を提供する <code class="literal">ROLLUP</code> も使用できます。 <code class="literal">GROUP BY</code> 句に <code class="literal">WITH ROLLUP</code> 修飾子を追加すると、クエリーによって、すべての年の値の総計を示す別の (スーパー集計) 行が生成されます: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong>
+------+--------+
| year | profit |
+------+--------+
| 2000 |   4525 |
| 2001 |   3010 |
| NULL |   7535 |
+------+--------+
</pre><p>
        <code class="literal">year</code> カラムの <code class="literal">NULL</code> 値は、超集計行の総計を識別します。
      </p><p>
        複数の <code class="literal">GROUP BY</code> カラムがある場合は、<code class="literal">ROLLUP</code> の効果がより複雑になります。 この場合、最後のグループ化カラム以外の値が変更されるたびに、クエリーは追加の超集計サマリー行を生成します。 
      </p><p>
        たとえば、<code class="literal">ROLLUP</code> がない場合、<code class="literal">year</code>、<code class="literal">country</code> および <code class="literal">product</code> に基づく <code class="literal">sales</code> テーブルのサマリーは次のようになります。出力には year/country/product レベルの分析でのみサマリー値が示されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product;</code></strong>
+------+---------+------------+--------+
| year | country | product    | profit |
+------+---------+------------+--------+
| 2000 | Finland | Computer   |   1500 |
| 2000 | Finland | Phone      |    100 |
| 2000 | India   | Calculator |    150 |
| 2000 | India   | Computer   |   1200 |
| 2000 | USA     | Calculator |     75 |
| 2000 | USA     | Computer   |   1500 |
| 2001 | Finland | Phone      |     10 |
| 2001 | USA     | Calculator |     50 |
| 2001 | USA     | Computer   |   2700 |
| 2001 | USA     | TV         |    250 |
+------+---------+------------+--------+
</pre><p>
        <code class="literal">ROLLUP</code> が追加されると、クエリーによっていくつかの追加の行が生成されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong>
+------+---------+------------+--------+
| year | country | product    | profit |
+------+---------+------------+--------+
| 2000 | Finland | Computer   |   1500 |
| 2000 | Finland | Phone      |    100 |
| 2000 | Finland | NULL       |   1600 |
| 2000 | India   | Calculator |    150 |
| 2000 | India   | Computer   |   1200 |
| 2000 | India   | NULL       |   1350 |
| 2000 | USA     | Calculator |     75 |
| 2000 | USA     | Computer   |   1500 |
| 2000 | USA     | NULL       |   1575 |
| 2000 | NULL    | NULL       |   4525 |
| 2001 | Finland | Phone      |     10 |
| 2001 | Finland | NULL       |     10 |
| 2001 | USA     | Calculator |     50 |
| 2001 | USA     | Computer   |   2700 |
| 2001 | USA     | TV         |    250 |
| 2001 | USA     | NULL       |   3000 |
| 2001 | NULL    | NULL       |   3010 |
| NULL | NULL    | NULL       |   7535 |
+------+---------+------------+--------+
</pre><p>
        出力には、1 つだけでなく、4 つの分析レベルのサマリー情報が含まれるようになりました:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            特定の年および国の各製品行の後に、すべての製品の合計を示す追加の上位集計サマリー行が表示されます。 これらの行には、<code class="literal">NULL</code> に設定された <code class="literal">product</code> カラムが含まれています。 
          </p></li><li class="listitem"><p>
            特定の年の各行の後に、追加の上位集計サマリー行が表示され、すべての国および製品の合計が示されます。 これらの行には、<code class="literal">NULL</code> に設定された <code class="literal">country</code> および <code class="literal">products</code> カラムが含まれています。 
          </p></li><li class="listitem"><p>
            最後に、他のすべての行の後に、追加の上位集計サマリー行が表示され、すべての年、国および製品の総計が示されます。 この行には、<code class="literal">NULL</code> に設定された <code class="literal">year</code>、<code class="literal">country</code>、および <code class="literal">products</code> カラムが含まれています。 
          </p></li></ul></div><p>
        各超集約行の <code class="literal">NULL</code> 指示子は、行がクライアントに送信されるときに生成されます。 サーバーでは、変更された値を持つ左端のカラムに続いて、<code class="literal">GROUP BY</code> 句で名前が指定されたカラムが調査されます。 これらの名前のいずれかと一致する名前を持つ結果セット内のカラムの場合、その値は <code class="literal">NULL</code> に設定されます。 (カラムの位置でカラムをグループ化するように指定した場合、サーバーは位置で <code class="literal">NULL</code> に設定するカラムを識別します。) 
      </p><p>
        上位集計行の <code class="literal">NULL</code> 値は、クエリー処理のこのような遅延ステージで結果セットに配置されるため、SELECT 構文のリストまたは <code class="literal">HAVING</code> 句でのみ <code class="literal">NULL</code> 値としてテストできます。 結合条件または <code class="literal">WHERE</code> 句で <code class="literal">NULL</code> 値としてテストして、選択する行を決定することはできません。 たとえば、<code class="literal">WHERE product IS NULL</code> をクエリーに追加して、スーパー集計行以外のすべての行を出力から除外することはできません。 
      </p><p>
        <code class="literal">NULL</code> 値は、クライアント側では <code class="literal">NULL</code> として表示され、任意の MySQL クライアントプログラミングインタフェースを使用してテストできます。 ただし、この時点では、<code class="literal">NULL</code> が通常のグループ化された値を表すか、スーパー集計値を表すかは区別できません。 区別をテストするには、後述する <code class="literal">GROUPING()</code> 関数を使用します。 
      </p><p>
        以前は、MySQL では、<code class="literal">WITH ROLLUP</code> オプションを持つクエリーで <code class="literal">DISTINCT</code> または <code class="literal">ORDER BY</code> を使用できませんでした。 この制限は、MySQL 8.0.12 以降ではなくなりました。 (Bug #87450、Bug #86311、Bug #26640100、Bug #26073513) 
      </p><p>
        <code class="literal">GROUP BY ... WITH ROLLUP</code> クエリーでは、結果の <code class="literal">NULL</code> 値が超集計値を表すかどうかをテストするために、<code class="literal">GROUPING()</code> 関数を選択リスト、<code class="literal">HAVING</code> 句および (MySQL 8.0.12 の時点) <code class="literal">ORDER BY</code> 句で使用できます。 たとえば、<code class="literal">GROUPING(year)</code> は、<code class="literal">year</code> カラムの <code class="literal">NULL</code> がスーパー集計行にある場合は 1 を返し、それ以外の場合は 0 を返します。 同様に、<code class="literal">country</code> カラムと <code class="literal">product</code> カラムのスーパー集計 <code class="literal">NULL</code> 値に対して、<code class="literal">GROUPING(country)</code> と <code class="literal">GROUPING(product)</code> はそれぞれ 1 を返します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, SUM(profit) AS profit,</code></strong>
         <strong class="userinput"><code>GROUPING(year) AS grp_year,</code></strong>
         <strong class="userinput"><code>GROUPING(country) AS grp_country,</code></strong>
         <strong class="userinput"><code>GROUPING(product) AS grp_product</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong>
+------+---------+------------+--------+----------+-------------+-------------+
| year | country | product    | profit | grp_year | grp_country | grp_product |
+------+---------+------------+--------+----------+-------------+-------------+
| 2000 | Finland | Computer   |   1500 |        0 |           0 |           0 |
| 2000 | Finland | Phone      |    100 |        0 |           0 |           0 |
| 2000 | Finland | NULL       |   1600 |        0 |           0 |           1 |
| 2000 | India   | Calculator |    150 |        0 |           0 |           0 |
| 2000 | India   | Computer   |   1200 |        0 |           0 |           0 |
| 2000 | India   | NULL       |   1350 |        0 |           0 |           1 |
| 2000 | USA     | Calculator |     75 |        0 |           0 |           0 |
| 2000 | USA     | Computer   |   1500 |        0 |           0 |           0 |
| 2000 | USA     | NULL       |   1575 |        0 |           0 |           1 |
| 2000 | NULL    | NULL       |   4525 |        0 |           1 |           1 |
| 2001 | Finland | Phone      |     10 |        0 |           0 |           0 |
| 2001 | Finland | NULL       |     10 |        0 |           0 |           1 |
| 2001 | USA     | Calculator |     50 |        0 |           0 |           0 |
| 2001 | USA     | Computer   |   2700 |        0 |           0 |           0 |
| 2001 | USA     | TV         |    250 |        0 |           0 |           0 |
| 2001 | USA     | NULL       |   3000 |        0 |           0 |           1 |
| 2001 | NULL    | NULL       |   3010 |        0 |           1 |           1 |
| NULL | NULL    | NULL       |   7535 |        1 |           1 |           1 |
+------+---------+------------+--------+----------+-------------+-------------+
</pre><p>
        <code class="literal">GROUPING()</code> の結果を直接表示するかわりに、<code class="literal">GROUPING()</code> を使用して、スーパー集計 <code class="literal">NULL</code> 値のラベルを置換できます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(year), 'All years', year) AS year,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(country), 'All countries', country) AS country,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(product), 'All products', product) AS product,</code></strong>
         <strong class="userinput"><code>SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong>
+-----------+---------------+--------------+--------+
| year      | country       | product      | profit |
+-----------+---------------+--------------+--------+
| 2000      | Finland       | Computer     |   1500 |
| 2000      | Finland       | Phone        |    100 |
| 2000      | Finland       | All products |   1600 |
| 2000      | India         | Calculator   |    150 |
| 2000      | India         | Computer     |   1200 |
| 2000      | India         | All products |   1350 |
| 2000      | USA           | Calculator   |     75 |
| 2000      | USA           | Computer     |   1500 |
| 2000      | USA           | All products |   1575 |
| 2000      | All countries | All products |   4525 |
| 2001      | Finland       | Phone        |     10 |
| 2001      | Finland       | All products |     10 |
| 2001      | USA           | Calculator   |     50 |
| 2001      | USA           | Computer     |   2700 |
| 2001      | USA           | TV           |    250 |
| 2001      | USA           | All products |   3000 |
| 2001      | All countries | All products |   3010 |
| All years | All countries | All products |   7535 |
+-----------+---------------+--------------+--------+
</pre><p>
        複数の式引数を使用すると、<code class="literal">GROUPING()</code> は、各式の結果を結合するビットマスクを表す結果を、右端の式の結果に対応する最下位ビットと返します。 たとえば、<code class="literal">GROUPING(year, country, product)</code> は次のように評価されます: 
      </p><pre class="programlisting">  result for GROUPING(<em class="replaceable"><code>product</code></em>)
+ result for GROUPING(<em class="replaceable"><code>country</code></em>) &lt;&lt; 1
+ result for GROUPING(<em class="replaceable"><code>year</code></em>) &lt;&lt; 2
</pre><p>
        このような <code class="literal">GROUPING()</code> の結果は、いずれかの式がスーパー集計 <code class="literal">NULL</code> を表す場合はゼロ以外であるため、スーパー集計行のみを返し、次のように通常のグループ化された行をフィルタで除外できます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(year, country, product) &lt;&gt; 0;</code></strong>
+------+---------+---------+--------+
| year | country | product | profit |
+------+---------+---------+--------+
| 2000 | Finland | NULL    |   1600 |
| 2000 | India   | NULL    |   1350 |
| 2000 | USA     | NULL    |   1575 |
| 2000 | NULL    | NULL    |   4525 |
| 2001 | Finland | NULL    |     10 |
| 2001 | USA     | NULL    |   3000 |
| 2001 | NULL    | NULL    |   3010 |
| NULL | NULL    | NULL    |   7535 |
+------+---------+---------+--------+
</pre><p>
        <code class="literal">sales</code> テーブルには <code class="literal">NULL</code> 値が含まれていないため、<code class="literal">ROLLUP</code> 結果のすべての <code class="literal">NULL</code> 値は超集計値をテーブルします。 データセットに <code class="literal">NULL</code> 値が含まれている場合、<code class="literal">ROLLUP</code> サマリーには、スーパー集計行だけでなく、通常のグループ化された行にも <code class="literal">NULL</code> 値が含まれることがあります。 <code class="literal">GROUPING()</code> では、これらを区別できます。 テーブル <code class="literal">t1</code> に、数量値のセットに対する 2 つのグループ化係数を持つ単純なデータセットが含まれているとします。ここで、<code class="literal">NULL</code> は <span class="quote">「<span class="quote">other</span>」</span> や<span class="quote">「<span class="quote">不明</span>」</span>などを示します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
+------+-------+----------+
| name | size  | quantity |
+------+-------+----------+
| ball | small |       10 |
| ball | large |       20 |
| ball | NULL  |        5 |
| hoop | small |       15 |
| hoop | large |        5 |
| hoop | NULL  |        3 |
+------+-------+----------+
</pre><p>
        単純な <code class="literal">ROLLUP</code> 操作では次の結果が生成されるため、通常のグループ化された行の <code class="literal">NULL</code> 値とスーパー集計行の <code class="literal">NULL</code> 値を区別するのはそれほど簡単ではありません:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+------+-------+----------+
| name | size  | quantity |
+------+-------+----------+
| ball | NULL  |        5 |
| ball | large |       20 |
| ball | small |       10 |
| ball | NULL  |       35 |
| hoop | NULL  |        3 |
| hoop | large |        5 |
| hoop | small |       15 |
| hoop | NULL  |       23 |
| NULL | NULL  |       58 |
+------+-------+----------+
</pre><p>
        <code class="literal">GROUPING()</code> を使用してスーパー集計 <code class="literal">NULL</code> 値のラベルを置換すると、結果の解釈が容易になります:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(name) = 1, 'All items', name) AS name,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(size) = 1, 'All sizes', size) AS size,</code></strong>
         <strong class="userinput"><code>SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+-----------+-----------+----------+
| name      | size      | quantity |
+-----------+-----------+----------+
| ball      | NULL      |        5 |
| ball      | large     |       20 |
| ball      | small     |       10 |
| ball      | All sizes |       35 |
| hoop      | NULL      |        3 |
| hoop      | large     |        5 |
| hoop      | small     |       15 |
| hoop      | All sizes |       23 |
| All items | All sizes |       58 |
+-----------+-----------+----------+
</pre><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="group-by-modifiers-other-considerations-when-using-rollup"></a>ROLLUP 使用時のその他の考慮事項</h4></div></div></div><p>
          次の説明では、<code class="literal">ROLLUP</code> の MySQL 実装に固有の動作の一部を示します。
        </p><p>
          MySQL 8.0.12 より前では、<code class="literal">ROLLUP</code> を使用する場合、<code class="literal">ORDER BY</code> 句を使用して結果をソートすることもできません。 つまり、<code class="literal">ROLLUP</code> と <code class="literal">ORDER BY</code> は MySQL で相互に排他的でした。 ただし、ソート順序を一部制御することはできます。 <code class="literal">ORDER BY</code> で <code class="literal">ROLLUP</code> を使用せず、グループ化された結果の特定のソート順序を達成するという制限を回避するには、グループ化された結果セットを導出テーブルとして生成し、それに <code class="literal">ORDER BY</code> を適用します。 例: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM</code></strong>
         <strong class="userinput"><code>(SELECT year, SUM(profit) AS profit</code></strong>
         <strong class="userinput"><code>FROM sales GROUP BY year WITH ROLLUP) AS dt</code></strong>
       <strong class="userinput"><code>ORDER BY year DESC;</code></strong>
+------+--------+
| year | profit |
+------+--------+
| 2001 |   3010 |
| 2000 |   4525 |
| NULL |   7535 |
+------+--------+
</pre><p>
          MySQL 8.0.12 では、<code class="literal">ORDER BY</code> と <code class="literal">ROLLUP</code> を一緒に使用できるため、<code class="literal">ORDER BY</code> と <code class="literal">GROUPING()</code> を使用して、グループ化された結果の特定のソート順序を実現できます。 例: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP</code></strong>
       <strong class="userinput"><code>ORDER BY GROUPING(year) DESC;</code></strong>
+------+--------+
| year | profit |
+------+--------+
| NULL |   7535 |
| 2000 |   4525 |
| 2001 |   3010 |
+------+--------+
</pre><p>
          どちらの場合も、集計上のサマリー行は計算元の行でソートされ、その配置はソート順 (昇順ソートの場合は末尾、降順ソートの場合は先頭) に依存します。
        </p><p>
          <code class="literal">LIMIT</code> を使用すると、クライアントに返される行の数を制限できます。 <code class="literal">LIMIT</code> は <code class="literal">ROLLUP</code> のあとに適用されるため、<code class="literal">ROLLUP</code> で追加された追加の行に対して制限が適用されます。 例: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP</code></strong>
       <strong class="userinput"><code>LIMIT 5;</code></strong>
+------+---------+------------+--------+
| year | country | product    | profit |
+------+---------+------------+--------+
| 2000 | Finland | Computer   |   1500 |
| 2000 | Finland | Phone      |    100 |
| 2000 | Finland | NULL       |   1600 |
| 2000 | India   | Calculator |    150 |
| 2000 | India   | Computer   |   1200 |
+------+---------+------------+--------+
</pre><p>
          <code class="literal">LIMIT</code> を <code class="literal">ROLLUP</code> とともに使用すると、スーパー集計行を理解するためのコンテキストが少なくなるため、解釈が困難な結果が生成される場合があります。
        </p><p>
          MySQL 拡張機能では、<code class="literal">GROUP BY</code> リストに表示されないカラムを選択リストに指定できます。 (非集計カラムおよび <code class="literal">GROUP BY</code> の詳細は、<a class="xref" href="functions.html#group-by-handling" title="12.20.3 MySQL での GROUP BY の処理">セクション12.20.3「MySQL での GROUP BY の処理」</a> を参照してください。) この場合、サーバーはサマリー行内のこのような非集約カラムから任意の値を自由に選択できます。これには、<code class="literal">WITH ROLLUP</code> で追加された追加の行も含まれます。 たとえば、次のクエリーでは、<code class="literal">country</code> は <code class="literal">GROUP BY</code> リストに表示されない非集計カラムであり、このカラムに選択された値は非決定的です: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, country, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong>
+------+---------+--------+
| year | country | profit |
+------+---------+--------+
| 2000 | India   |   4525 |
| 2001 | USA     |   3010 |
| NULL | USA     |   7535 |
+------+---------+--------+
</pre><p>
          この動作は、<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが有効になっていない場合に許可されます。 このモードが有効になっている場合は、<code class="literal">country</code> が <code class="literal">GROUP BY</code> 句に一覧表示されないため、サーバーはそのクエリーを不正として拒否します。 <code class="literal">ONLY_FULL_GROUP_BY</code> が有効になっている場合でも、非決定的値カラムに対して <code class="literal">ANY_VALUE()</code> 関数を使用してクエリーを実行できます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT year, ANY_VALUE(country) AS country, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong>
+------+---------+--------+
| year | country | profit |
+------+---------+--------+
| 2000 | India   |   4525 |
| 2001 | USA     |   3010 |
| NULL | USA     |   7535 |
+------+---------+--------+
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-handling"></a>12.20.3 MySQL での GROUP BY の処理</h3></div></div></div><a class="indexterm" name="idm46041613536656"></a><a class="indexterm" name="idm46041613535216"></a><a class="indexterm" name="idm46041613533136"></a><a class="indexterm" name="idm46041613531088"></a><p>
        SQL-92 以前では、選択リスト、<code class="literal">HAVING</code> 条件または <code class="literal">ORDER BY</code> リストが <code class="literal">GROUP BY</code> 句で指定されていない非集計カラムを参照するクエリーは許可されません。 たとえば、このクエリーは、選択リストの非集計 <code class="literal">name</code> カラムが <code class="literal">GROUP BY</code> に表示されないため、標準 SQL-92 では無効です: 
      </p><pre class="programlisting">SELECT o.custid, c.name, MAX(o.payment)
  FROM orders AS o, customers AS c
  WHERE o.custid = c.custid
  GROUP BY o.custid;
</pre><p>
        クエリーを SQL-92 で有効にするには、選択リストから <code class="literal">name</code> カラムを省略するか、<code class="literal">GROUP BY</code> 句で名前を指定する必要があります。
      </p><p>
        SQL:1999 以降では、<code class="literal">GROUP BY</code> カラムに機能的に依存している場合、オプション機能 T301 ごとにこのような非集計が許可されます: このような関係が <code class="literal">name</code> と <code class="literal">custid</code> の間に存在する場合、クエリーは有効です。 たとえば、これは <code class="literal">custid</code> が <code class="literal">customers</code> の主キーであった場合です。 
      </p><p>
        MySQL は、関数従属性の検出を実装しています。 <code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが有効な場合 (デフォルト)、MySQL は、選択リスト、<code class="literal">HAVING</code> 条件または <code class="literal">ORDER BY</code> リストが <code class="literal">GROUP BY</code> 句で名前が付けられておらず、機能的に依存していない非集計カラムを参照するクエリーを拒否します。 
      </p><p>
        次の例に示すように、SQL <code class="literal">ONLY_FULL_GROUP_BY</code> モードが有効になっている場合、MySQL では、<code class="literal">GROUP BY</code> 句で指定されていない非集計カラムも許可されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE mytable (</code></strong>
    -&gt;    <strong class="userinput"><code>id INT UNSIGNED NOT NULL PRIMARY KEY,</code></strong>
    -&gt;    <strong class="userinput"><code>a VARCHAR(10),</code></strong>
    -&gt;    <strong class="userinput"><code>b INT</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO mytable</code></strong>
    -&gt; <strong class="userinput"><code>VALUES (1, 'abc', 1000),</code></strong>
    -&gt;        <strong class="userinput"><code>(2, 'abc', 2000),</code></strong>
    -&gt;        <strong class="userinput"><code>(3, 'def', 4000);</code></strong>

mysql&gt; <strong class="userinput"><code>SET SESSION sql_mode = sys.list_add(@@session.sql_mode, 'ONLY_FULL_GROUP_BY');</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT a, SUM(b) FROM mytable WHERE a = 'abc';</code></strong>
+------+--------+
| a    | SUM(b) |
+------+--------+
| abc  |   3000 |
+------+--------+
</pre><p>
        <code class="literal">ONLY_FULL_GROUP_BY</code> を使用する場合は、<code class="literal">SELECT</code> リストに複数の非集計カラムを含めることもできます。 この場合、次に示すように、このようなカラムはすべて <code class="literal">WHERE</code> 句の単一の値に制限する必要があり、このような制限条件はすべて論理 <code class="literal">AND</code> によって結合する必要があります: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS mytable;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE mytable (</code></strong>
    -&gt;    <strong class="userinput"><code>id INT UNSIGNED NOT NULL PRIMARY KEY,</code></strong>
    -&gt;    <strong class="userinput"><code>a VARCHAR(10),</code></strong>
    -&gt;    <strong class="userinput"><code>b VARCHAR(10),</code></strong>
    -&gt;    <strong class="userinput"><code>c INT</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO mytable</code></strong>
    -&gt; <strong class="userinput"><code>VALUES (1, 'abc', 'qrs', 1000),</code></strong>
    -&gt;        <strong class="userinput"><code>(2, 'abc', 'tuv', 2000),</code></strong>
    -&gt;        <strong class="userinput"><code>(3, 'def', 'qrs', 4000),</code></strong>
    -&gt;        <strong class="userinput"><code>(4, 'def', 'tuv', 8000),</code></strong>
    -&gt;        <strong class="userinput"><code>(5, 'abc', 'qrs', 16000),</code></strong>
    -&gt;        <strong class="userinput"><code>(6, 'def', 'tuv', 32000);</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT @@session.sql_mode;</code></strong>
+---------------------------------------------------------------+
| @@session.sql_mode                                            |
+---------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION |
+---------------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT a, b, SUM(c) FROM mytable</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE a = 'abc' AND b = 'qrs';</code></strong>
+------+------+--------+
| a    | b    | SUM(c) |
+------+------+--------+
| abc  | qrs  |  17000 |
+------+------+--------+
</pre><p>
        <code class="literal">ONLY_FULL_GROUP_BY</code> が無効になっている場合、<code class="literal">GROUP BY</code> の標準 SQL 使用に対する MySQL 拡張機能を使用すると、カラムが <code class="literal">GROUP BY</code> カラムに機能的に依存していなくても、選択リスト、<code class="literal">HAVING</code> 条件または <code class="literal">ORDER BY</code> リストで集計されていないカラムを参照できます。 これにより、MySQL は前述のクエリーを受け入れます。 この場合、サーバーは各グループから任意の値を自由に選択できるため、それらが同じでないかぎり、選択される値は決定的ではなく、必要な値ではない可能性があります。 さらに、<code class="literal">ORDER BY</code> 句を追加しても、各グループからの値の選択が影響を受ける可能性はありません。 結果セットのソートは値が選択された後に行われ、<code class="literal">ORDER BY</code> はサーバーが選択する各グループ内の値には影響しません。 <code class="literal">ONLY_FULL_GROUP_BY</code> の無効化は、主に、データの一部のプロパティのために、<code class="literal">GROUP BY</code> で指定されていない集計されていない各カラムのすべての値がグループごとに同じであることがわかっている場合に役立ちます。 
      </p><p>
        <code class="literal">ANY_VALUE()</code> を使用して非集計カラムを参照することで、<code class="literal">ONLY_FULL_GROUP_BY</code> を無効にせずに同じ効果を得ることができます。
      </p><p>
        次の説明は、関数従属性、関数従属性が存在しない場合に MySQL が生成するエラーメッセージ、および関数従属性が存在しない場合に MySQL がクエリーを受け入れる方法を示しています。
      </p><p>
        選択リストの非集計 <code class="literal">address</code> カラムが <code class="literal">GROUP BY</code> 句で指定されていないため、<code class="literal">ONLY_FULL_GROUP_BY</code> が有効な場合、このクエリーは無効である可能性があります:
      </p><pre class="programlisting">SELECT name, address, MAX(age) FROM t GROUP BY name;
</pre><p>
        このクエリーは、<code class="literal">name</code> が <code class="literal">t</code> の主キーであるか、一意の <code class="literal">NOT NULL</code> カラムである場合に有効です。 このような場合、MySQL は、選択されたカラムが機能的にグループ化カラムに依存していることを認識します。 たとえば、<code class="literal">name</code> が主キーの場合、各グループには主キーの値が 1 つのみであるため、その値によって <code class="literal">address</code> の値が決まります。 そのため、グループ内の <code class="literal">address</code> 値の選択にランダム性はなく、クエリーを拒否する必要はありません。 
      </p><p>
        <code class="literal">name</code> が <code class="literal">t</code> の主キーまたは一意の <code class="literal">NOT NULL</code> カラムでない場合、クエリーは無効です。 この場合、関数従属性を推測できず、エラーが発生します: 
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT name, address, MAX(age) FROM t GROUP BY name;</code></strong>
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP
BY clause and contains nonaggregated column 'mydb.t.address' which
is not functionally dependent on columns in GROUP BY clause; this
is incompatible with sql_mode=only_full_group_by
</pre><p>
        それがわかっている場合、実際には<span class="emphasis"><em>特定のデータセット</em></span>の各 <code class="literal">name</code> 値によって <code class="literal">address</code> 値が一意に決定され、<code class="literal">address</code> は事実上 <code class="literal">name</code> に依存します。 クエリーを受け入れるように MySQL に指示するには、<code class="literal">ANY_VALUE()</code> 関数を使用します: 
      </p><pre class="programlisting">SELECT name, ANY_VALUE(address), MAX(age) FROM t GROUP BY name;
</pre><p>
        または、<code class="literal">ONLY_FULL_GROUP_BY</code> を無効にします。
      </p><p>
        ただし、前述の例は非常に単純です。 特に、すべてのグループに 1 つの行のみが含まれるため、単一の主キーカラムでグループ化することはほとんどありません。 より複雑なクエリーでの関数従属性を示す追加の例は、<a class="xref" href="functions.html#group-by-functional-dependence" title="12.20.4 機能依存性の検出">セクション12.20.4「機能依存性の検出」</a> を参照してください。 
      </p><p>
        クエリーに集計関数があり、<code class="literal">GROUP BY</code> 句がない場合、<code class="literal">ONLY_FULL_GROUP_BY</code> が有効になっている選択リスト、<code class="literal">HAVING</code> 条件または <code class="literal">ORDER BY</code> リストに非集計カラムを含めることはできません:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT name, MAX(age) FROM t;</code></strong>
ERROR 1140 (42000): In aggregated query without GROUP BY, expression
#1 of SELECT list contains nonaggregated column 'mydb.t.name'; this
is incompatible with sql_mode=only_full_group_by
</pre><p>
        <code class="literal">GROUP BY</code> がない場合、単一のグループが存在し、どの <code class="literal">name</code> 値をグループに選択するかは非決定的です。 ここでも、MySQL が選択する <code class="literal">name</code> 値が重要でない場合は、<code class="literal">ANY_VALUE()</code> を使用できます: 
      </p><pre class="programlisting">SELECT ANY_VALUE(name), MAX(age) FROM t;
</pre><p>
        <code class="literal">ONLY_FULL_GROUP_BY</code> は、<code class="literal">DISTINCT</code> および <code class="literal">ORDER BY</code> を使用するクエリーの処理にも影響します。 次の行を含む <code class="literal">c1</code>、<code class="literal">c2</code> および <code class="literal">c3</code> の 3 つのカラムを含むテーブル <code class="literal">t</code> の場合を考えてみます: 
      </p><pre class="programlisting">c1 c2 c3
1  2  A
3  4  B
1  2  C
</pre><p>
        次のクエリーを実行し、結果を <code class="literal">c3</code> で順序付けするとします:
      </p><pre class="programlisting">SELECT DISTINCT c1, c2 FROM t ORDER BY c3;
</pre><p>
        結果を並べ替えるには、最初に重複を排除する必要があります。 ただし、そのためには、最初の行または 3 番目の行を保持する必要がありますか。 この任意の選択は <code class="literal">c3</code> の保持された値に影響し、これは順序付けに影響を与え、任意にすることもできます。 この問題を回避するために、いずれかの <code class="literal">ORDER BY</code> 式が次のいずれかの条件を満たさない場合、<code class="literal">DISTINCT</code> および <code class="literal">ORDER BY</code> を含むクエリーは無効として拒否されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            式が選択リストの式と等しい
          </p></li><li class="listitem"><p>
            式によって参照され、クエリーで選択されたテーブルに属するすべてのカラムは、選択リストの要素です
          </p></li></ul></div><p>
        標準 SQL に対する別の MySQL 拡張機能では、選択リスト内のエイリアス式への <code class="literal">HAVING</code> 句内の参照が許可されます。 たとえば、次のクエリーは、<code class="literal">orders</code> テーブルで 1 回だけ発生する <code class="literal">name</code> 値を返します。 
      </p><pre class="programlisting">SELECT name, COUNT(name) FROM orders
  GROUP BY name
  HAVING COUNT(name) = 1;
</pre><p>
        MySQL 拡張機能では、集計カラムの <code class="literal">HAVING</code> 句でエイリアスを使用できます:
      </p><pre class="programlisting">SELECT name, COUNT(name) AS c FROM orders
  GROUP BY name
  HAVING c = 1;
</pre><a class="indexterm" name="idm46041613413120"></a><a class="indexterm" name="idm46041613410976"></a><a class="indexterm" name="idm46041613408928"></a><a class="indexterm" name="idm46041613407568"></a><p>
        標準 SQL では <code class="literal">GROUP BY</code> 句のカラム式のみが許可されるため、<code class="literal">FLOOR(value/100)</code> は非カラム式であるため、このようなステートメントは無効です:
      </p><pre class="programlisting">SELECT id, FLOOR(value/100)
  FROM <em class="replaceable"><code>tbl_name</code></em>
  GROUP BY id, FLOOR(value/100);
</pre><p>
        MySQL は、標準 SQL を拡張して <code class="literal">GROUP BY</code> 句でカラム以外の式を許可し、前述のステートメントが有効であるとみなします。
      </p><p>
        標準 SQL では、<code class="literal">GROUP BY</code> 句でエイリアスを使用することもできません。 MySQL は標準 SQL を拡張してエイリアスを許可するため、クエリーを記述する別の方法は次のとおりです: 
      </p><pre class="programlisting">SELECT id, FLOOR(value/100) AS val
  FROM <em class="replaceable"><code>tbl_name</code></em>
  GROUP BY id, val;
</pre><p>
        エイリアス <code class="literal">val</code> は、<code class="literal">GROUP BY</code> 句のカラム式とみなされます。
      </p><p>
        <code class="literal">GROUP BY</code> 句にカラム以外の式が存在する場合、MySQL はその式と選択リスト内の式の等価性を認識します。 つまり、<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが有効になっている場合、選択リストに同じ <code class="literal">FLOOR()</code> 式が出現するため、<code class="literal">GROUP BY id, FLOOR(value/100)</code> を含むクエリーは有効です。 ただし、MySQL は <code class="literal">GROUP BY</code> の非カラム式への関数従属性を認識しないため、3 番目に選択された式が <code class="literal">id</code> カラムと <code class="literal">GROUP BY</code> 句の <code class="literal">FLOOR()</code> 式の単純な式であっても、<code class="literal">ONLY_FULL_GROUP_BY</code> が有効な場合は次のクエリーは無効です: 
      </p><pre class="programlisting">SELECT id, FLOOR(value/100), id+FLOOR(value/100)
  FROM <em class="replaceable"><code>tbl_name</code></em>
  GROUP BY id, FLOOR(value/100);
</pre><p>
        回避策は、導出テーブルを使用することです:
      </p><pre class="programlisting">SELECT id, F, id+F
  FROM
    (SELECT id, FLOOR(value/100) AS F
     FROM <em class="replaceable"><code>tbl_name</code></em>
     GROUP BY id, FLOOR(value/100)) AS dt;
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-functional-dependence"></a>12.20.4 機能依存性の検出</h3></div></div></div><a class="indexterm" name="idm46041613382080"></a><p>
        次の説明では、MySQL が関数従属性を検出する方法の例をいくつか示します。 この例では、次の表記法を使用します: 
      </p><pre class="programlisting">{<em class="replaceable"><code>X</code></em>} -&gt; {<em class="replaceable"><code>Y</code></em>}
</pre><p>
        これを<span class="quote">「<span class="quote">「<em class="replaceable"><code>X</code></em> は、<em class="replaceable"><code>Y</code></em> を一意に決定」</span>」</span>として理解します。つまり、<em class="replaceable"><code>Y</code></em> は機能的に <em class="replaceable"><code>X</code></em> に依存しています。
      </p><p>
        この例では、<a class="ulink" href="https://dev.mysql.com/doc/index-other.html" target="_top">https://dev.mysql.com/doc/index-other.html</a> からダウンロードできる <code class="literal">world</code> データベースを使用します。 データベースのインストール方法の詳細は、同じページを参照してください。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-keys" title="キーから導出された関数従属性">キーから導出された関数従属性</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-multiple-column-keys" title="複数カラムキーおよび等価から導出された関数従属性">複数カラムキーおよび等価から導出された関数従属性</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-special-cases" title="関数従属性特殊ケース">関数従属性特殊ケース</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-views" title="関数従属性とビュー">関数従属性とビュー</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-combinations" title="関数従属性の組合せ">関数従属性の組合せ</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="functional-dependence-keys"></a>キーから導出された関数従属性</h4></div></div></div><p>
          次のクエリーは、国ごとに話された言語の数を選択します:
        </p><pre class="programlisting">SELECT co.Name, COUNT(*)
FROM countrylanguage cl, country co
WHERE cl.CountryCode = co.Code
GROUP BY co.Code;
</pre><p>
          <code class="literal">co.Code</code> は <code class="literal">co</code> の主キーであるため、次の表記法を使用して表されるように、<code class="literal">co</code> のすべてのカラムは機能的に依存します:
        </p><pre class="programlisting">{co.Code} -&gt; {co.*}
</pre><p>
          したがって、<code class="literal">co.name</code> は機能的に <code class="literal">GROUP BY</code> カラムに依存し、クエリーは有効です。
        </p><p>
          主キーのかわりに <code class="literal">NOT NULL</code> カラムに対する <code class="literal">UNIQUE</code> インデックスを使用でき、同じ機能依存性が適用されます。 (複数の <code class="literal">NULL</code> 値が許可され、その場合は一意性が失われるため、<code class="literal">NULL</code> 値を許可する <code class="literal">UNIQUE</code> インデックスには当てはまりません。) 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="functional-dependence-multiple-column-keys"></a>複数カラムキーおよび等価から導出された関数従属性</h4></div></div></div><p>
          このクエリーでは、国ごとに、すべての話し言葉のリストとそれらを話すユーザーの数を選択します:
        </p><pre class="programlisting">SELECT co.Name, cl.Language,
cl.Percentage * co.Population / 100.0 AS SpokenBy
FROM countrylanguage cl, country co
WHERE cl.CountryCode = co.Code
GROUP BY cl.CountryCode, cl.Language;
</pre><p>
          ペア (<code class="literal">cl.CountryCode</code>、<code class="literal">cl.Language</code>) は <code class="literal">cl</code> の 2 カラム複合主キーであるため、カラムのペアによって <code class="literal">cl</code> のすべてのカラムが一意に決定されます:
        </p><pre class="programlisting">{cl.CountryCode, cl.Language} -&gt; {cl.*}
</pre><p>
          さらに、<code class="literal">WHERE</code> 句の等価性のため、次のようになります:
        </p><pre class="programlisting">{cl.CountryCode} -&gt; {co.Code}
</pre><p>
          また、<code class="literal">co.Code</code> は <code class="literal">co</code> の主キーであるため、次のようになります:
        </p><pre class="programlisting">{co.Code} -&gt; {co.*}
</pre><p>
          <span class="quote">「<span class="quote">「一意に決定」</span>」</span>関係は推移的であるため、次のようになります:
        </p><pre class="programlisting">{cl.CountryCode, cl.Language} -&gt; {cl.*,co.*}
</pre><p>
          その結果、クエリーは有効になります。
        </p><p>
          前の例と同様に、<code class="literal">NOT NULL</code> カラムに対する <code class="literal">UNIQUE</code> キーを主キーのかわりに使用できます。
        </p><p>
          <code class="literal">WHERE</code> のかわりに <code class="literal">INNER JOIN</code> 条件を使用できます。 同じ機能依存性が適用されます: 
        </p><pre class="programlisting">SELECT co.Name, cl.Language,
cl.Percentage * co.Population/100.0 AS SpokenBy
FROM countrylanguage cl INNER JOIN country co
ON cl.CountryCode = co.Code
GROUP BY cl.CountryCode, cl.Language;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="functional-dependence-special-cases"></a>関数従属性特殊ケース</h4></div></div></div><p>
          <code class="literal">WHERE</code> 条件または <code class="literal">INNER JOIN</code> 条件での等価テストは対称ですが、テーブルは異なる役割を果たすため、外部結合条件での等価テストは対称ではありません。
        </p><p>
          参照整合性が誤って破損し、対応する行がない <code class="literal">countrylanguage</code> の行が <code class="literal">country</code> に存在するとします。 前述の例と同じクエリーを考えてみますが、<code class="literal">LEFT JOIN</code> の場合は次のようになります: 
        </p><pre class="programlisting">SELECT co.Name, cl.Language,
cl.Percentage * co.Population/100.0 AS SpokenBy
FROM countrylanguage cl LEFT JOIN country co
ON cl.CountryCode = co.Code
GROUP BY cl.CountryCode, cl.Language;
</pre><p>
          <code class="literal">cl.CountryCode</code> の特定の値について、結合結果の <code class="literal">co.Code</code> の値は、一致する行 (<code class="literal">cl.CountryCode</code> によって決定) で検出されるか、一致がない場合は <code class="literal">NULL</code> で補完されます (<code class="literal">cl.CountryCode</code> によっても決定されます)。 いずれの場合も、この関係が適用されます: 
        </p><pre class="programlisting">{cl.CountryCode} -&gt; {co.Code}
</pre><p>
          <code class="literal">cl.CountryCode</code> 自体は、主キーである {<code class="literal">cl.CountryCode</code>, <code class="literal">cl.Language</code>} に機能的に依存します。
        </p><p>
          結合結果で、<code class="literal">co.Code</code> が <code class="literal">NULL</code> で補完されている場合、<code class="literal">co.Name</code> も同様です。 <code class="literal">co.Code</code> が <code class="literal">NULL</code> で補完されていない場合、<code class="literal">co.Code</code> は主キーであるため、<code class="literal">co.Name</code> が決定されます。 したがって、すべての場合で次のようになります: 
        </p><pre class="programlisting">{co.Code} -&gt; {co.Name}
</pre><p>
          次のものが生成されます:
        </p><pre class="programlisting">{cl.CountryCode, cl.Language} -&gt; {cl.*,co.*}
</pre><p>
          その結果、クエリーは有効になります。
        </p><p>
          ただし、次のクエリーのようにテーブルがスワップされるとします:
        </p><pre class="programlisting">SELECT co.Name, cl.Language,
cl.Percentage * co.Population/100.0 AS SpokenBy
FROM country co LEFT JOIN countrylanguage cl
ON cl.CountryCode = co.Code
GROUP BY cl.CountryCode, cl.Language;
</pre><p>
          現在、この関係は適用されません:
        </p><pre class="programlisting">{cl.CountryCode, cl.Language} -&gt; {cl.*,co.*}
</pre><p>
          実際には、<code class="literal">cl</code> に対して作成された <code class="literal">NULL</code> で補完されたすべての行は単一のグループに配置され (両方の <code class="literal">GROUP BY</code> カラムが <code class="literal">NULL</code> と等しい)、このグループ内で <code class="literal">co.Name</code> の値が異なる可能性があります。 クエリーが無効であり、MySQL によって拒否されます。 
        </p><p>
          したがって、外部結合の関数従属性は、決定要因カラムが <code class="literal">LEFT JOIN</code> の左側に属するか右側に属するかにリンクされます。 ネストされた外部結合がある場合、または結合条件が完全に等価比較で構成されていない場合、関数従属性の決定はより複雑になります。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="functional-dependence-views"></a>関数従属性とビュー</h4></div></div></div><p>
          国のビューでは、コード、名前 (大文字)、および国が持つ異なる公用語の数が生成されるとします:
        </p><pre class="programlisting">CREATE VIEW country2 AS
SELECT co.Code, UPPER(co.Name) AS UpperName,
COUNT(cl.Language) AS OfficialLanguages
FROM country AS co JOIN countrylanguage AS cl
ON cl.CountryCode = co.Code
WHERE cl.isOfficial = 'T'
GROUP BY co.Code;
</pre><p>
          この定義は、次の理由で有効です:
        </p><pre class="programlisting">{co.Code} -&gt; {co.*}
</pre><p>
          ビュー結果では、最初に選択されたカラムは <code class="literal">co.Code</code> であり、これはグループカラムでもあるため、選択された他のすべての式が決定されます:
        </p><pre class="programlisting">{country2.Code} -&gt; {country2.*}
</pre><p>
          次に説明するように、MySQL はこれを理解し、この情報を使用します。
        </p><p>
          このクエリーでは、<code class="literal">city</code> テーブルとビューを結合することで、国、国の公用語の数および市区町村の数が表示されます:
        </p><pre class="programlisting">SELECT co2.Code, co2.UpperName, co2.OfficialLanguages,
COUNT(*) AS Cities
FROM country2 AS co2 JOIN city ci
ON ci.CountryCode = co2.Code
GROUP BY co2.Code;
</pre><p>
          前述のとおり、このクエリーは次の理由で有効です:
        </p><pre class="programlisting">{co2.Code} -&gt; {co2.*}
</pre><p>
          MySQL では、ビューの結果で関数従属性を検出し、それを使用してビューを使用するクエリーを検証できます。 次のように、<code class="literal">country2</code> が導出テーブル (または共通テーブル式) であった場合も同様です: 
        </p><pre class="programlisting">SELECT co2.Code, co2.UpperName, co2.OfficialLanguages,
COUNT(*) AS Cities
FROM
(
 SELECT co.Code, UPPER(co.Name) AS UpperName,
 COUNT(cl.Language) AS OfficialLanguages
 FROM country AS co JOIN countrylanguage AS cl
 ON cl.CountryCode=co.Code
 WHERE cl.isOfficial='T'
 GROUP BY co.Code
) AS co2
JOIN city ci ON ci.CountryCode = co2.Code
GROUP BY co2.Code;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="functional-dependence-combinations"></a>関数従属性の組合せ</h4></div></div></div><p>
          MySQL では、前述のすべてのタイプの関数従属性 (キーベース、等価ベース、ビューベース) を組み合せて、より複雑なクエリーを検証できます。
        </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="window-functions"></a>12.21 ウィンドウ関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#window-function-descriptions">12.21.1 Window 関数の説明</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-usage">12.21.2 Window 関数の概念と構文</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-frames">12.21.3 ウィンドウ機能フレーム仕様</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-named-windows">12.21.4 名前付きウィンドウ</a></span></dt><dt><span class="section"><a href="functions.html#window-function-restrictions">12.21.5 ウィンドウ機能の制限事項</a></span></dt></dl></div><a class="indexterm" name="idm46041613282256"></a><p>
      MySQL では、クエリーの各行について、その行に関連する行を使用して計算を実行するウィンドウ関数がサポートされています。 次の各セクションでは、<code class="literal">OVER</code> 句および <code class="literal">WINDOW</code> 句の説明を含む、ウィンドウ関数の使用方法について説明します。 最初のセクションでは、非集計ウィンドウ関数について説明します。 集計ウィンドウ関数の詳細は、<a class="xref" href="functions.html#aggregate-functions" title="12.20.1 集計関数の説明">セクション12.20.1「集計関数の説明」</a> を参照してください。 
    </p><p>
      最適化およびウィンドウ関数の詳細は、<a class="xref" href="optimization.html#window-function-optimization" title="8.2.1.21 ウィンドウ機能最適化">セクション8.2.1.21「ウィンドウ機能最適化」</a> を参照してください。
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="window-function-descriptions"></a>12.21.1 Window 関数の説明</h3></div></div></div><p>
        このセクションでは、クエリーの各行について、その行に関連する行を使用して計算を実行する非集計ウィンドウ関数について説明します。 ほとんどの集計関数は、ウィンドウ関数としても使用できます。<a class="xref" href="functions.html#aggregate-functions" title="12.20.1 集計関数の説明">セクション12.20.1「集計関数の説明」</a> を参照してください。 
      </p><p>
        ウィンドウ関数の使用方法と例、および <code class="literal">OVER</code> 句、ウィンドウ、パーティション、フレーム、ピアなどの用語の定義については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
      </p><div class="table"><a name="idm46041613271120"></a><p class="title"><b>表 12.26 「ウィンドウ関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「ウィンドウ関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a></td>
<td>
      累積分布値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a></td>
<td>
      パーティション内の現在の行のランク (ギャップなし)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a></td>
<td>
      ウィンドウフレームの最初の行からの引数の値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a></td>
<td>
      パーティション内の現在行より遅れている行の引数の値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a></td>
<td>
      ウィンドウフレームの最後の行からの引数の値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a></td>
<td>
      パーティション内の現在の行の先頭行からの引数の値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a></td>
<td>
      ウィンドウフレームの N 番目の行からの引数の値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_ntile"><code class="literal">NTILE()</code></a></td>
<td>
      パーティション内の現在の行のバケット番号。
    </td>
</tr><tr><td><a class="link" href="functions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a></td>
<td>
      パーセントランク値
    </td>
</tr><tr><td><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a></td>
<td>
      パーティション内の現在の行のランク (ギャップあり)
    </td>
</tr><tr><td><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a></td>
<td>
      パーティション内の現在の行数
    </td>
</tr></tbody></table></div></div><br class="table-break"><p>
        次の関数の説明で、<em class="replaceable"><code>over_clause</code></em> は、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されている <code class="literal">OVER</code> 句を表します。 一部のウィンドウ関数では、結果の計算時に <code class="literal">NULL</code> 値の処理方法を指定する <em class="replaceable"><code>null_treatment</code></em> 句を使用できます。 この句はオプションです。 これは SQL 標準の一部ですが、MySQL 実装では <code class="literal">RESPECT NULLS</code> (デフォルト) のみが許可されます。 これは、結果の計算時に <code class="literal">NULL</code> 値が考慮されることを意味します。 <code class="literal">IGNORE NULLS</code> は解析されますが、エラーが発生します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_cume-dist"></a><p>
            <code class="literal">CUME_DIST()</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613219376"></a><p>
            値のグループ内の値の累積分布、つまり現在の行の値以下のパーティション値の割合を戻します。 これは、ウィンドウパーティションのウィンドウ順序で現在の行の前またはピアの行数をウィンドウパーティションの合計行数で割った数を表します。 戻り値の範囲は 0 から 1 です。 
          </p><p>
            パーティション行を目的の順序にソートするには、<code class="literal">ORDER BY</code> でこの関数を使用する必要があります。 <code class="literal">ORDER BY</code> を使用しない場合、すべての行はピアであり、<em class="replaceable"><code>N</code></em>/<em class="replaceable"><code>N</code></em> = 1,の値を持ちます。ここで、<em class="replaceable"><code>N</code></em> はパーティションサイズです。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p><p>
            次のクエリーでは、<code class="literal">val</code> カラムの値セットについて、各行の <code class="literal">CUME_DIST()</code> 値、および同様の <code class="literal">PERCENT_RANK()</code> 関数によって返されたパーセントランク値が表示されます。 参照のために、クエリーでは <code class="literal">ROW_NUMBER()</code> を使用して行番号も表示されます: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER()   OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>CUME_DIST()    OVER w AS 'cume_dist',</code></strong>
         <strong class="userinput"><code>PERCENT_RANK() OVER w AS 'percent_rank'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+--------------------+--------------+
| val  | row_number | cume_dist          | percent_rank |
+------+------------+--------------------+--------------+
|    1 |          1 | 0.2222222222222222 |            0 |
|    1 |          2 | 0.2222222222222222 |            0 |
|    2 |          3 | 0.3333333333333333 |         0.25 |
|    3 |          4 | 0.6666666666666666 |        0.375 |
|    3 |          5 | 0.6666666666666666 |        0.375 |
|    3 |          6 | 0.6666666666666666 |        0.375 |
|    4 |          7 | 0.8888888888888888 |         0.75 |
|    4 |          8 | 0.8888888888888888 |         0.75 |
|    5 |          9 |                  1 |            1 |
+------+------------+--------------------+--------------+
</pre></li><li class="listitem"><a name="function_dense-rank"></a><p>
            <code class="literal">DENSE_RANK()</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613194304"></a><p>
            パーティション内の現在の行のランクをギャップなしで返します。 同僚は同僚とみなされ、同じランクを受け取ります。 この関数は、ピアグループに連続するランクを割り当てます。その結果、サイズが 1 より大きいグループは、連続しないランク番号を生成しません。 例については、<code class="literal">RANK()</code> 関数の説明を参照してください。 
          </p><p>
            パーティション行を目的の順序にソートするには、<code class="literal">ORDER BY</code> でこの関数を使用する必要があります。 <code class="literal">ORDER BY</code> がない場合、すべての行がピアになります。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li><li class="listitem"><a name="function_first-value"></a><p>
            <code class="literal">FIRST_VALUE(<em class="replaceable"><code>expr</code></em>)</code> [<em class="replaceable"><code>null_treatment</code></em>] <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613181088"></a><p>
            ウィンドウフレームの最初の行から <em class="replaceable"><code>expr</code></em> の値を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。<em class="replaceable"><code>null_treatment</code></em> については、概要のセクションで説明しています。
          </p><p>
            次のクエリーは、<code class="literal">FIRST_VALUE()</code>、<code class="literal">LAST_VALUE()</code> および <code class="literal">NTH_VALUE()</code> の 2 つのインスタンスを示しています:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>FIRST_VALUE(val)  OVER w AS 'first',</code></strong>
         <strong class="userinput"><code>LAST_VALUE(val)   OVER w AS 'last',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 2) OVER w AS 'second',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 4) OVER w AS 'fourth'</code></strong>
       <strong class="userinput"><code>FROM observations</code></strong>
       <strong class="userinput"><code>WINDOW w AS (PARTITION BY subject ORDER BY time</code></strong>
                    <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING);</code></strong>
+----------+---------+------+-------+------+--------+--------+
| time     | subject | val  | first | last | second | fourth |
+----------+---------+------+-------+------+--------+--------+
| 07:00:00 | st113   |   10 |    10 |   10 |   NULL |   NULL |
| 07:15:00 | st113   |    9 |    10 |    9 |      9 |   NULL |
| 07:30:00 | st113   |   25 |    10 |   25 |      9 |   NULL |
| 07:45:00 | st113   |   20 |    10 |   20 |      9 |     20 |
| 07:00:00 | xh458   |    0 |     0 |    0 |   NULL |   NULL |
| 07:15:00 | xh458   |   10 |     0 |   10 |     10 |   NULL |
| 07:30:00 | xh458   |    5 |     0 |    5 |     10 |   NULL |
| 07:45:00 | xh458   |   30 |     0 |   30 |     10 |     30 |
| 08:00:00 | xh458   |   25 |     0 |   25 |     10 |     30 |
+----------+---------+------+-------+------+--------+--------+
</pre><p>
            各関数は、現在のフレーム内の行を使用します。この行は、表示されているウィンドウ定義に従って、最初のパーティション行から現在の行に拡張されます。 <code class="literal">NTH_VALUE()</code> コールの場合、現在のフレームにはリクエストされた行が常に含まれるわけではありません。このような場合、戻り値は <code class="literal">NULL</code> です。 
          </p></li><li class="listitem"><a name="function_lag"></a><p>
            <code class="literal">LAG(<em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>N</code></em>[, <em class="replaceable"><code>default</code></em>]])</code> [<em class="replaceable"><code>null_treatment</code></em>] <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613154368"></a><p>
            パーティション内の <em class="replaceable"><code>N</code></em> 行で現在の行を遅延 (前) する行から <em class="replaceable"><code>expr</code></em> の値を返します。 そのような行がない場合、戻り値は <em class="replaceable"><code>default</code></em> です。 たとえば、<em class="replaceable"><code>N</code></em> が 3 の場合、最初の 2 行の戻り値は <em class="replaceable"><code>default</code></em> です。 <em class="replaceable"><code>N</code></em> または <em class="replaceable"><code>default</code></em> がない場合、デフォルトはそれぞれ 1 および <code class="literal">NULL</code> です。 
          </p><p>
            <em class="replaceable"><code>N</code></em> は、負でないリテラル整数である必要があります。 <em class="replaceable"><code>N</code></em> が 0 の場合、<em class="replaceable"><code>expr</code></em> は現在の行に対して評価されます。 
          </p><p>
            MySQL 8.0.22 以降、<em class="replaceable"><code>N</code></em> を <code class="literal">NULL</code> にすることはできません。 さらに、次のいずれかの形式で、<code class="literal">1</code> から <code class="literal">2<sup>63</sup></code> までの範囲の整数である必要があります: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                符号なし整数定数リテラル
              </p></li><li class="listitem"><p>
                位置パラメータマーカー (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                ユーザー定義変数
              </p></li><li class="listitem"><p>
                ストアドルーチン内のローカル変数
              </p></li></ul></div><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。<em class="replaceable"><code>null_treatment</code></em> については、概要のセクションで説明しています。
          </p><p>
            <code class="literal">LAG()</code> (および同様の <code class="literal">LEAD()</code> 関数) は、多くの場合、行間の差異を計算するために使用されます。 次のクエリーは、時間順の監視のセットと、隣接する行からの <code class="literal">LAG()</code> および <code class="literal">LEAD()</code> の値、および現在の行と隣接する行の違いを示しています: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>t, val,</code></strong>
         <strong class="userinput"><code>LAG(val)        OVER w AS 'lag',</code></strong>
         <strong class="userinput"><code>LEAD(val)       OVER w AS 'lead',</code></strong>
         <strong class="userinput"><code>val - LAG(val)  OVER w AS 'lag diff',</code></strong>
         <strong class="userinput"><code>val - LEAD(val) OVER w AS 'lead diff'</code></strong>
       <strong class="userinput"><code>FROM series</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY t);</code></strong>
+----------+------+------+------+----------+-----------+
| t        | val  | lag  | lead | lag diff | lead diff |
+----------+------+------+------+----------+-----------+
| 12:00:00 |  100 | NULL |  125 |     NULL |       -25 |
| 13:00:00 |  125 |  100 |  132 |       25 |        -7 |
| 14:00:00 |  132 |  125 |  145 |        7 |       -13 |
| 15:00:00 |  145 |  132 |  140 |       13 |         5 |
| 16:00:00 |  140 |  145 |  150 |       -5 |       -10 |
| 17:00:00 |  150 |  140 |  200 |       10 |       -50 |
| 18:00:00 |  200 |  150 | NULL |       50 |      NULL |
+----------+------+------+------+----------+-----------+
</pre><p>
            この例では、<code class="literal">LAG()</code> コールと <code class="literal">LEAD()</code> コールは、それぞれデフォルトの <em class="replaceable"><code>N</code></em> 値と <em class="replaceable"><code>default</code></em> 値の 1 と <code class="literal">NULL</code> を使用します。
          </p><p>
            最初の行は、<code class="literal">LAG()</code> に前の行がない場合の処理を示しています: この関数は、<em class="replaceable"><code>default</code></em> 値 (この場合は <code class="literal">NULL</code>) を戻します。 最後の行には、<code class="literal">LEAD()</code> の次の行がない場合と同じものが表示されます。 
          </p><p>
            <code class="literal">LAG()</code> と <code class="literal">LEAD()</code> は、差異ではなく合計の計算にも役立ちます。 Fibonacci シリーズの最初の数個を含む次のデータセットについて考えてみます: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT n FROM fib ORDER BY n;</code></strong>
+------+
| n    |
+------+
|    1 |
|    1 |
|    2 |
|    3 |
|    5 |
|    8 |
+------+
</pre><p>
            次のクエリーは、現在の行に隣接する行の <code class="literal">LAG()</code> および <code class="literal">LEAD()</code> の値を表示します。 また、これらの関数を使用して、前後の行の値を現在の行の値に追加します。 効果は、Fibonacci シリーズの次の番号と、それ以降の次の番号を生成することです: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>n,</code></strong>
         <strong class="userinput"><code>LAG(n, 1, 0)      OVER w AS 'lag',</code></strong>
         <strong class="userinput"><code>LEAD(n, 1, 0)     OVER w AS 'lead',</code></strong>
         <strong class="userinput"><code>n + LAG(n, 1, 0)  OVER w AS 'next_n',</code></strong>
         <strong class="userinput"><code>n + LEAD(n, 1, 0) OVER w AS 'next_next_n'</code></strong>
       <strong class="userinput"><code>FROM fib</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY n);</code></strong>
+------+------+------+--------+-------------+
| n    | lag  | lead | next_n | next_next_n |
+------+------+------+--------+-------------+
|    1 |    0 |    1 |      1 |           2 |
|    1 |    1 |    2 |      2 |           3 |
|    2 |    1 |    3 |      3 |           5 |
|    3 |    2 |    5 |      5 |           8 |
|    5 |    3 |    8 |      8 |          13 |
|    8 |    5 |    0 |     13 |           8 |
+------+------+------+--------+-------------+
</pre><p>
            Fibonacci 番号の初期セットを生成する方法の 1 つは、再帰的な共通テーブル式を使用することです。 例については、<a class="xref" href="sql-statements.html#common-table-expressions-recursive-fibonacci-series" title="フィボナッチシリーズ世代">フィボナッチシリーズ世代</a>を参照してください。 
          </p><p>
            MySQL 8.0.22 以降、この関数の rows 引数に負の値を使用することはできません。
          </p></li><li class="listitem"><a name="function_last-value"></a><p>
            <code class="literal">LAST_VALUE(<em class="replaceable"><code>expr</code></em>)</code> [<em class="replaceable"><code>null_treatment</code></em>] <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613091904"></a><p>
            ウィンドウフレームの最後の行から <em class="replaceable"><code>expr</code></em> の値を返します。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。<em class="replaceable"><code>null_treatment</code></em> については、概要のセクションで説明しています。
          </p><p>
            例については、<code class="literal">FIRST_VALUE()</code> 関数の説明を参照してください。
          </p></li><li class="listitem"><a name="function_lead"></a><p>
            <code class="literal">LEAD(<em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>N</code></em>[, <em class="replaceable"><code>default</code></em>]])</code> [<em class="replaceable"><code>null_treatment</code></em>] <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613079024"></a><p>
            パーティション内の <em class="replaceable"><code>N</code></em> 行ごとに現在の行を導く (後に続く) 行から、<em class="replaceable"><code>expr</code></em> の値を返します。 そのような行がない場合、戻り値は <em class="replaceable"><code>default</code></em> です。 たとえば、<em class="replaceable"><code>N</code></em> が 3 の場合、戻り値は最後の 2 行の <em class="replaceable"><code>default</code></em> です。 <em class="replaceable"><code>N</code></em> または <em class="replaceable"><code>default</code></em> がない場合、デフォルトはそれぞれ 1 および <code class="literal">NULL</code> です。 
          </p><p>
            <em class="replaceable"><code>N</code></em> は、負でないリテラル整数である必要があります。 <em class="replaceable"><code>N</code></em> が 0 の場合、<em class="replaceable"><code>expr</code></em> は現在の行に対して評価されます。 
          </p><p>
            MySQL 8.0.22 以降、<em class="replaceable"><code>N</code></em> を <code class="literal">NULL</code> にすることはできません。 さらに、次のいずれかの形式で、<code class="literal">1</code> から <code class="literal">2<sup>63</sup></code> までの範囲の整数である必要があります: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                符号なし整数定数リテラル
              </p></li><li class="listitem"><p>
                位置パラメータマーカー (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                ユーザー定義変数
              </p></li><li class="listitem"><p>
                ストアドルーチン内のローカル変数
              </p></li></ul></div><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。<em class="replaceable"><code>null_treatment</code></em> については、概要のセクションで説明しています。
          </p><p>
            例については、<code class="literal">LAG()</code> 関数の説明を参照してください。
          </p><p>
            MySQL 8.0.22 以降では、この関数の rows 引数に負の値を使用することはできません。
          </p></li><li class="listitem"><a name="function_nth-value"></a><p>
            <code class="literal">NTH_VALUE(<em class="replaceable"><code>expr</code></em>, <em class="replaceable"><code>N</code></em>)</code> [<em class="replaceable"><code>from_first_last</code></em>] [<em class="replaceable"><code>null_treatment</code></em>] <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613051648"></a><p>
            ウィンドウフレームの <em class="replaceable"><code>N</code></em> 番目の行から <em class="replaceable"><code>expr</code></em> の値を返します。 そのような行がない場合、戻り値は <code class="literal">NULL</code> です。 
          </p><p>
            <em class="replaceable"><code>N</code></em> はリテラルの正の整数である必要があります。
          </p><p>
            <em class="replaceable"><code>from_first_last</code></em> は SQL 標準の一部ですが、MySQL 実装では <code class="literal">FROM FIRST</code> (デフォルト) のみが許可されます。 つまり、ウィンドウの最初の行から計算が開始されます。 <code class="literal">FROM LAST</code> は解析されますが、エラーが発生します。 <code class="literal">FROM LAST</code> と同じ効果を得るには (ウィンドウの最後の行から計算を開始)、<code class="literal">ORDER BY</code> を使用して逆の順序でソートします。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。<em class="replaceable"><code>null_treatment</code></em> については、概要のセクションで説明しています。
          </p><p>
            例については、<code class="literal">FIRST_VALUE()</code> 関数の説明を参照してください。
          </p><p>
            MySQL 8.0.22 以降では、この関数の行引数に <code class="literal">NULL</code> を使用できません。
          </p></li><li class="listitem"><a name="function_ntile"></a><p>
            <code class="literal">NTILE(<em class="replaceable"><code>N</code></em>)</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041613032144"></a><p>
            パーティションを <em class="replaceable"><code>N</code></em> グループ (バケット) に分割し、パーティション内の各行にバケット番号を割り当て、パーティション内の現在の行のバケット番号を返します。 たとえば、<em class="replaceable"><code>N</code></em> が 4 の場合、<code class="literal">NTILE()</code> は行を 4 つのバケットに分割します。 <em class="replaceable"><code>N</code></em> が 100 の場合、<code class="literal">NTILE()</code> は行を 100 バケットに分割します。 
          </p><p>
            <em class="replaceable"><code>N</code></em> はリテラルの正の整数である必要があります。 バケット番号の戻り値の範囲は 1 から <em class="replaceable"><code>N</code></em> です。 
          </p><p>
            MySQL 8.0.22 以降、<em class="replaceable"><code>N</code></em> を <code class="literal">NULL</code> にすることはできません。 また、次のいずれかの形式で、<code class="literal">1</code> から <code class="literal">2<sup>63</sup></code> までの範囲の整数である必要があります: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                符号なし整数定数リテラル
              </p></li><li class="listitem"><p>
                位置パラメータマーカー (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                ユーザー定義変数
              </p></li><li class="listitem"><p>
                ストアドルーチン内のローカル変数
              </p></li></ul></div><p>
            パーティション行を目的の順序にソートするには、<code class="literal">ORDER BY</code> でこの関数を使用する必要があります。
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p><p>
            次のクエリーは、<code class="literal">val</code> カラムの値セットについて、行を複数または 4 つのグループに分割した結果のパーセンタイル値を示しています。 参照のために、クエリーでは <code class="literal">ROW_NUMBER()</code> を使用して行番号も表示されます: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>NTILE(2)     OVER w AS 'ntile2',</code></strong>
         <strong class="userinput"><code>NTILE(4)     OVER w AS 'ntile4'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+--------+--------+
| val  | row_number | ntile2 | ntile4 |
+------+------------+--------+--------+
|    1 |          1 |      1 |      1 |
|    1 |          2 |      1 |      1 |
|    2 |          3 |      1 |      1 |
|    3 |          4 |      1 |      2 |
|    3 |          5 |      1 |      2 |
|    3 |          6 |      2 |      3 |
|    4 |          7 |      2 |      3 |
|    4 |          8 |      2 |      4 |
|    5 |          9 |      2 |      4 |
+------+------------+--------+--------+
</pre><p>
            MySQL 8.0.22 以降、構成 <code class="literal">NTILE(NULL)</code> は許可されなくなりました。
          </p></li><li class="listitem"><a name="function_percent-rank"></a><p>
            <code class="literal">PERCENT_RANK()</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041612997856"></a><p>
            現在の行の値より小さいパーティション値の割合を戻します (最大値を除く)。 戻り値の範囲は 0 から 1 で、次の式の結果として計算される行相対ランクを表します。ここで、<em class="replaceable"><code>rank</code></em> は行ランク、<em class="replaceable"><code>rows</code></em> はパーティション行数です: 
          </p><pre class="programlisting">(<em class="replaceable"><code>rank</code></em> - 1) / (<em class="replaceable"><code>rows</code></em> - 1)
</pre><p>
            パーティション行を目的の順序にソートするには、<code class="literal">ORDER BY</code> でこの関数を使用する必要があります。 <code class="literal">ORDER BY</code> がない場合、すべての行がピアになります。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p><p>
            例については、<code class="literal">CUME_DIST()</code> 関数の説明を参照してください。
          </p></li><li class="listitem"><a name="function_rank"></a><p>
            <code class="literal">RANK()</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041612982384"></a><p>
            パーティション内の現在の行のランク (ギャップあり) を戻します。 同僚は同僚とみなされ、同じランクを受け取ります。 複数のサイズのグループが存在する場合、この関数はピアグループに連続するランクを割り当てません。結果は連続しないランク番号になります。 
          </p><p>
            パーティション行を目的の順序にソートするには、<code class="literal">ORDER BY</code> でこの関数を使用する必要があります。 <code class="literal">ORDER BY</code> がない場合、すべての行がピアになります。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p><p>
            次のクエリーは、ギャップのあるランクを生成する <code class="literal">RANK()</code> と、ギャップのないランクを生成する <code class="literal">DENSE_RANK()</code> の違いを示しています。 クエリーでは、<code class="literal">val</code> カラムの一連の値の各メンバーのランク値が表示されますが、これには重複が含まれています。 <code class="literal">RANK()</code> はピア (重複) に同じランク値を割り当て、次に大きい値はピア数からランクを引いてランクを高くします。 <code class="literal">DENSE_RANK()</code> ではピアにも同じランク値が割り当てられますが、次に高い値にはランクが 1 つ大きくなります。 参照のために、クエリーでは <code class="literal">ROW_NUMBER()</code> を使用して行番号も表示されます: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>RANK()       OVER w AS 'rank',</code></strong>
         <strong class="userinput"><code>DENSE_RANK() OVER w AS 'dense_rank'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+------+------------+
| val  | row_number | rank | dense_rank |
+------+------------+------+------------+
|    1 |          1 |    1 |          1 |
|    1 |          2 |    1 |          1 |
|    2 |          3 |    3 |          2 |
|    3 |          4 |    4 |          3 |
|    3 |          5 |    4 |          3 |
|    3 |          6 |    4 |          3 |
|    4 |          7 |    7 |          4 |
|    4 |          8 |    7 |          4 |
|    5 |          9 |    9 |          5 |
+------+------------+------+------------+
</pre></li><li class="listitem"><a name="function_row-number"></a><p>
            <code class="literal">ROW_NUMBER()</code> <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm46041612956384"></a><p>
            パーティション内の現在の行の番号を返します。 行番号の範囲は 1 からパーティション行の数です。 
          </p><p>
            <code class="literal">ORDER BY</code> は、行の番号付けの順序に影響します。 <code class="literal">ORDER BY</code> を使用しない場合、行番号付けは非決定的です。 
          </p><p>
            <code class="literal">ROW_NUMBER()</code> は、ピアに異なる行番号を割り当てます。 ピアに同じ値を割り当てるには、<code class="literal">RANK()</code> または <code class="literal">DENSE_RANK()</code> を使用します。 例については、<code class="literal">RANK()</code> 関数の説明を参照してください。 
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> については、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> を参照してください。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="window-functions-usage"></a>12.21.2 Window 関数の概念と構文</h3></div></div></div><a class="indexterm" name="idm46041612943856"></a><p>
        このセクションでは、ウィンドウ関数の使用方法について説明します。 例では、<a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY 修飾子">セクション12.20.2「GROUP BY 修飾子」</a> の <code class="literal">GROUPING()</code> 関数の説明にあるものと同じ販売情報データセットを使用します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM sales ORDER BY country, year, product;</code></strong>
+------+---------+------------+--------+
| year | country | product    | profit |
+------+---------+------------+--------+
| 2000 | Finland | Computer   |   1500 |
| 2000 | Finland | Phone      |    100 |
| 2001 | Finland | Phone      |     10 |
| 2000 | India   | Calculator |     75 |
| 2000 | India   | Calculator |     75 |
| 2000 | India   | Computer   |   1200 |
| 2000 | USA     | Calculator |     75 |
| 2000 | USA     | Computer   |   1500 |
| 2001 | USA     | Calculator |     50 |
| 2001 | USA     | Computer   |   1500 |
| 2001 | USA     | Computer   |   1200 |
| 2001 | USA     | TV         |    150 |
| 2001 | USA     | TV         |    100 |
+------+---------+------------+--------+
</pre><a class="indexterm" name="idm46041612937840"></a><a class="indexterm" name="idm46041612935664"></a><p>
        ウィンドウ関数は、一連のクエリー行に対して集計のような操作を実行します。 ただし、集計操作ではクエリー行が単一の結果行にグループ化されますが、ウィンドウ関数ではクエリー行ごとに結果が生成されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            関数の評価が行われる行は、現在の行と呼ばれます。
          </p></li><li class="listitem"><p>
            関数評価が行われる現在の行に関連するクエリー行は、現在の行のウィンドウで構成されます。
          </p></li></ul></div><p>
        たとえば、売上情報テーブルを使用すると、次の 2 つのクエリーで集計操作が実行され、グループとして取得されたすべての行に対して単一のグローバル合計が生成され、国ごとにグループ化されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUM(profit) AS total_profit</code></strong>
       <strong class="userinput"><code>FROM sales;</code></strong>
+--------------+
| total_profit |
+--------------+
|         7535 |
+--------------+
mysql&gt; <strong class="userinput"><code>SELECT country, SUM(profit) AS country_profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY country</code></strong>
       <strong class="userinput"><code>ORDER BY country;</code></strong>
+---------+----------------+
| country | country_profit |
+---------+----------------+
| Finland |           1610 |
| India   |           1350 |
| USA     |           4575 |
+---------+----------------+
</pre><p>
        対照的に、ウィンドウ操作では、クエリー行のグループは単一の出力行に縮小されません。 かわりに、行ごとに結果が生成されます。 前述のクエリーと同様に、次のクエリーでは <code class="literal">SUM()</code> を使用しますが、今回はウィンドウ関数として使用します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, profit,</code></strong>
         <strong class="userinput"><code>SUM(profit) OVER() AS total_profit,</code></strong>
         <strong class="userinput"><code>SUM(profit) OVER(PARTITION BY country) AS country_profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>ORDER BY country, year, product, profit;</code></strong>
+------+---------+------------+--------+--------------+----------------+
| year | country | product    | profit | total_profit | country_profit |
+------+---------+------------+--------+--------------+----------------+
| 2000 | Finland | Computer   |   1500 |         7535 |           1610 |
| 2000 | Finland | Phone      |    100 |         7535 |           1610 |
| 2001 | Finland | Phone      |     10 |         7535 |           1610 |
| 2000 | India   | Calculator |     75 |         7535 |           1350 |
| 2000 | India   | Calculator |     75 |         7535 |           1350 |
| 2000 | India   | Computer   |   1200 |         7535 |           1350 |
| 2000 | USA     | Calculator |     75 |         7535 |           4575 |
| 2000 | USA     | Computer   |   1500 |         7535 |           4575 |
| 2001 | USA     | Calculator |     50 |         7535 |           4575 |
| 2001 | USA     | Computer   |   1200 |         7535 |           4575 |
| 2001 | USA     | Computer   |   1500 |         7535 |           4575 |
| 2001 | USA     | TV         |    100 |         7535 |           4575 |
| 2001 | USA     | TV         |    150 |         7535 |           4575 |
+------+---------+------------+--------+--------------+----------------+
</pre><a class="indexterm" name="idm46041612915488"></a><p>
        クエリーの各ウィンドウ操作は、ウィンドウ関数で処理するためにクエリー行をグループにパーティション化する方法を指定する <code class="literal">OVER</code> 句を含めることで指定されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            最初の <code class="literal">OVER</code> 句は空で、クエリー行のセット全体が単一のパーティションとして扱われます。 このため、ウィンドウ関数ではグローバル合計が生成されますが、各行に対して生成されます。 
          </p></li><li class="listitem"><p>
            2 番目の <code class="literal">OVER</code> 句では、国ごとに行がパーティション化され、パーティションごとの合計が生成されます (国ごと)。 この関数は、パーティション行ごとにこの合計を生成します。 
          </p></li></ul></div><p>
        ウィンドウ機能は、選択リストおよび <code class="literal">ORDER BY</code> 句でのみ使用できます。 クエリー結果行は、<code class="literal">WHERE</code>、<code class="literal">GROUP BY</code> および <code class="literal">HAVING</code> の処理後に <code class="literal">FROM</code> 句から決定され、<code class="literal">ORDER BY</code>、<code class="literal">LIMIT</code> および <code class="literal">SELECT DISTINCT</code> の前にウィンドウ実行が行われます。 
      </p><p>
        <code class="literal">OVER</code> 句は多くの集計関数で許可されているため、<code class="literal">OVER</code> 句が存在するかどうかに応じて、ウィンドウ関数または非ウィンドウ関数として使用できます:
      </p><pre class="programlisting">AVG()
BIT_AND()
BIT_OR()
BIT_XOR()
COUNT()
JSON_ARRAYAGG()
JSON_OBJECTAGG()
MAX()
MIN()
STDDEV_POP(), STDDEV(), STD()
STDDEV_SAMP()
SUM()
VAR_POP(), VARIANCE()
VAR_SAMP()
</pre><p>
        各集計関数の詳細は、<a class="xref" href="functions.html#aggregate-functions" title="12.20.1 集計関数の説明">セクション12.20.1「集計関数の説明」</a> を参照してください。
      </p><p>
        MySQL では、ウィンドウ関数としてのみ使用される非集計関数もサポートされています。 これらの場合、<code class="literal">OVER</code> 句は必須です: 
      </p><pre class="programlisting">CUME_DIST()
DENSE_RANK()
FIRST_VALUE()
LAG()
LAST_VALUE()
LEAD()
NTH_VALUE()
NTILE()
PERCENT_RANK()
RANK()
ROW_NUMBER()
</pre><p>
        各非集計関数の詳細は、<a class="xref" href="functions.html#window-function-descriptions" title="12.21.1 Window 関数の説明">セクション12.21.1「Window 関数の説明」</a> を参照してください。
      </p><p>
        これらの非集計ウィンドウ関数のいずれかの例として、このクエリーは、パーティション内の各行の行番号を生成する <code class="literal">ROW_NUMBER()</code> を使用します。 この場合、行には国ごとに番号が付けられます。 デフォルトでは、パーティション行は順序付けられず、行番号付けは非決定的です。 パーティション行をソートするには、ウィンドウ定義に <code class="literal">ORDER BY</code> 句を含めます。 このクエリーでは、順序付けされていないパーティション (<code class="literal">row_num1</code> カラムと <code class="literal">row_num2</code> カラム) を使用して、<code class="literal">ORDER BY</code> を省略した場合と含めた場合の違いを示します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, profit,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER(PARTITION BY country) AS row_num1,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER(PARTITION BY country ORDER BY year, product) AS row_num2</code></strong>
       <strong class="userinput"><code>FROM sales;</code></strong>
+------+---------+------------+--------+----------+----------+
| year | country | product    | profit | row_num1 | row_num2 |
+------+---------+------------+--------+----------+----------+
| 2000 | Finland | Computer   |   1500 |        2 |        1 |
| 2000 | Finland | Phone      |    100 |        1 |        2 |
| 2001 | Finland | Phone      |     10 |        3 |        3 |
| 2000 | India   | Calculator |     75 |        2 |        1 |
| 2000 | India   | Calculator |     75 |        3 |        2 |
| 2000 | India   | Computer   |   1200 |        1 |        3 |
| 2000 | USA     | Calculator |     75 |        5 |        1 |
| 2000 | USA     | Computer   |   1500 |        4 |        2 |
| 2001 | USA     | Calculator |     50 |        2 |        3 |
| 2001 | USA     | Computer   |   1500 |        3 |        4 |
| 2001 | USA     | Computer   |   1200 |        7 |        5 |
| 2001 | USA     | TV         |    150 |        1 |        6 |
| 2001 | USA     | TV         |    100 |        6 |        7 |
+------+---------+------------+--------+----------+----------+
</pre><p>
        前述のように、ウィンドウ関数を使用する (または集計関数をウィンドウ関数として処理する) には、関数コールの後に <code class="literal">OVER</code> 句を含めます。 <code class="literal">OVER</code> 句には、次の 2 つの形式があります: 
      </p><pre class="programlisting"><em class="replaceable"><code>over_clause</code></em>:
    {OVER (<em class="replaceable"><code>window_spec</code></em>) | OVER <em class="replaceable"><code>window_name</code></em>}
</pre><p>
        どちらのフォームでも、ウィンドウ関数によるクエリー行の処理方法を定義します。 これらは、ウィンドウが <code class="literal">OVER</code> 句で直接定義されているか、クエリーの他の場所で定義された名前付きウィンドウへの参照によって提供されているかによって異なります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            最初のケースでは、ウィンドウ指定は <code class="literal">OVER</code> 句のカッコの間に直接表示されます。
          </p></li><li class="listitem"><p>
            2 番目の場合、<em class="replaceable"><code>window_name</code></em> は、クエリーの他の場所で <code class="literal">WINDOW</code> 句によって定義されたウィンドウ指定の名前です。 詳細は、<a class="xref" href="functions.html#window-functions-named-windows" title="12.21.4 名前付きウィンドウ">セクション12.21.4「名前付きウィンドウ」</a>を参照してください。 
          </p></li></ul></div><p>
        <code class="literal">OVER (<em class="replaceable"><code>window_spec</code></em>)</code> 構文の場合、ウィンドウ指定にはいくつかの部分があり、すべてオプションです:
      </p><pre class="programlisting"><em class="replaceable"><code>window_spec</code></em>:
    [<em class="replaceable"><code>window_name</code></em>] [<em class="replaceable"><code>partition_clause</code></em>] [<em class="replaceable"><code>order_clause</code></em>] [<em class="replaceable"><code>frame_clause</code></em>]
</pre><p>
        <code class="literal">OVER()</code> が空の場合、ウィンドウはすべてのクエリー行で構成され、ウィンドウ関数はすべての行を使用して結果を計算します。 それ以外の場合は、カッコ内にある句によって、関数結果の計算に使用されるクエリー行と、それらのパーティション化および順序付け方法が決まります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>window_name</code></em>: クエリーの他の場所で <code class="literal">WINDOW</code> 句によって定義されたウィンドウの名前。 <em class="replaceable"><code>window_name</code></em> 自体が <code class="literal">OVER</code> 句内に出現する場合は、ウィンドウを完全に定義します。 パーティション化、順序付けまたはフレーム化句も指定されている場合は、名前付きウィンドウの解釈が変更されます。 詳細は、<a class="xref" href="functions.html#window-functions-named-windows" title="12.21.4 名前付きウィンドウ">セクション12.21.4「名前付きウィンドウ」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>partition_clause</code></em>: <code class="literal">PARTITION BY</code> 句は、クエリー行をグループに分割する方法を指定します。 特定の行のウィンドウ関数の結果は、その行を含むパーティションの行に基づきます。 <code class="literal">PARTITION BY</code> を省略すると、すべてのクエリー行で構成される単一のパーティションが存在します。 
          </p><a class="indexterm" name="idm46041612855968"></a><a class="indexterm" name="idm46041612853856"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              ウィンドウ関数のパーティション化は、テーブルのパーティション化とは異なります。 テーブルのパーティション化の詳細は、<a class="xref" href="partitioning.html" title="第 24 章 パーティション化">第24章「<i>パーティション化</i>」</a> を参照してください。 
            </p></div><p>
            <em class="replaceable"><code>partition_clause</code></em> の構文は次のとおりです:
          </p><pre class="programlisting"><em class="replaceable"><code>partition_clause</code></em>:
    PARTITION BY <em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>expr</code></em>] ...
</pre><p>
            標準 SQL では、<code class="literal">PARTITION BY</code> の後にカラム名のみが続く必要があります。 MySQL 拡張機能では、カラム名のみでなく式を使用できます。 たとえば、テーブルに <code class="literal">ts</code> という名前の <code class="literal">TIMESTAMP</code> カラムが含まれている場合、標準 SQL では <code class="literal">PARTITION BY ts</code> は許可されますが <code class="literal">PARTITION BY HOUR(ts)</code> は許可されませんが、MySQL では両方が許可されます。 
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>order_clause</code></em>: <code class="literal">ORDER BY</code> 句は、各パーティションの行をソートする方法を指定します。 <code class="literal">ORDER BY</code> 句に従って等しいパーティション行はピアとみなされます。 <code class="literal">ORDER BY</code> を省略すると、パーティション行は順序付けられず、処理順序は暗黙的に指定されず、すべてのパーティション行がピアになります。 
          </p><a class="indexterm" name="idm46041612837840"></a><a class="indexterm" name="idm46041612835680"></a><p>
            <em class="replaceable"><code>order_clause</code></em> の構文は次のとおりです:
          </p><pre class="programlisting"><em class="replaceable"><code>order_clause</code></em>:
    ORDER BY <em class="replaceable"><code>expr</code></em> [ASC|DESC] [, <em class="replaceable"><code>expr</code></em> [ASC|DESC]] ...
</pre><p>
            オプションで、各 <code class="literal">ORDER BY</code> 式の後に <code class="literal">ASC</code> または <code class="literal">DESC</code> を指定してソート方向を示すことができます。 方向が指定されていない場合、デフォルトは <code class="literal">ASC</code> です。 <code class="literal">NULL</code> 値は、昇順ソートの場合は最初にソートされ、降順ソートの場合は最後にソートされます。 
          </p><p>
            ウィンドウ定義の <code class="literal">ORDER BY</code> は、個々のパーティション内に適用されます。 結果セット全体をソートするには、クエリーの最上位レベルに <code class="literal">ORDER BY</code> を含めます。 
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>frame_clause</code></em>: フレームは現在のパーティションのサブセットであり、frame 句はサブセットの定義方法を指定します。 frame 句には、独自の副次句が多数あります。 詳細は、<a class="xref" href="functions.html#window-functions-frames" title="12.21.3 ウィンドウ機能フレーム仕様">セクション12.21.3「ウィンドウ機能フレーム仕様」</a>を参照してください。 
          </p><a class="indexterm" name="idm46041612821392"></a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="window-functions-frames"></a>12.21.3 ウィンドウ機能フレーム仕様</h3></div></div></div><a class="indexterm" name="idm46041612818096"></a><p>
        ウィンドウ関数で使用されるウィンドウの定義には、frame 句を含めることができます。 フレームは現在のパーティションのサブセットであり、frame 句はサブセットの定義方法を指定します。 
      </p><p>
        フレームは現在の行に対して決定されます。これにより、現在の行のパーティション内での位置に応じて、フレームをパーティション内で移動できます。 例: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            パーティションの開始行から現在の行までのすべての行になるようにフレームを定義することで、各行の累積合計を計算できます。
          </p></li><li class="listitem"><p>
            現在の行の両側で <em class="replaceable"><code>N</code></em> 行を拡張するようにフレームを定義することで、ローリング平均を計算できます。
          </p></li></ul></div><p>
        次のクエリーは、移動フレームを使用して、時間順序付けされた <code class="literal">level</code> 値の各グループ内の累積合計、および現在の行とその直前と直後の行から計算されたローリング平均を計算する方法を示しています:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>SUM(val) OVER (PARTITION BY subject ORDER BY time</code></strong>
                        <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING)</code></strong>
           <strong class="userinput"><code>AS running_total,</code></strong>
         <strong class="userinput"><code>AVG(val) OVER (PARTITION BY subject ORDER BY time</code></strong>
                        <strong class="userinput"><code>ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)</code></strong>
           <strong class="userinput"><code>AS running_average</code></strong>
       <strong class="userinput"><code>FROM observations;</code></strong>
+----------+---------+------+---------------+-----------------+
| time     | subject | val  | running_total | running_average |
+----------+---------+------+---------------+-----------------+
| 07:00:00 | st113   |   10 |            10 |          9.5000 |
| 07:15:00 | st113   |    9 |            19 |         14.6667 |
| 07:30:00 | st113   |   25 |            44 |         18.0000 |
| 07:45:00 | st113   |   20 |            64 |         22.5000 |
| 07:00:00 | xh458   |    0 |             0 |          5.0000 |
| 07:15:00 | xh458   |   10 |            10 |          5.0000 |
| 07:30:00 | xh458   |    5 |            15 |         15.0000 |
| 07:45:00 | xh458   |   30 |            45 |         20.0000 |
| 08:00:00 | xh458   |   25 |            70 |         27.5000 |
+----------+---------+------+---------------+-----------------+
</pre><p>
        <code class="literal">running_average</code> カラムの場合、最初のカラムの前または最後のカラムの後にフレーム行はありません。 このような場合、<code class="literal">AVG()</code> は使用可能な行の平均を計算します。 
      </p><p>
        ウィンドウ関数として使用される集計関数は、次の非集計ウィンドウ関数と同様に、現在の行フレームの行を操作します:
      </p><pre class="programlisting">FIRST_VALUE()
LAST_VALUE()
NTH_VALUE()
</pre><p>
        標準 SQL は、パーティション全体で動作するウィンドウ関数に frame 句を含めないことを指定します。 MySQL では、このような関数の frame 句は許可されますが、無視されます。 これらの関数は、フレームが指定されている場合でもパーティション全体を使用します: 
      </p><pre class="programlisting">CUME_DIST()
DENSE_RANK()
LAG()
LEAD()
NTILE()
PERCENT_RANK()
RANK()
ROW_NUMBER()
</pre><p>
        frame 句が指定されている場合、構文は次のとおりです:
      </p><pre class="programlisting"><em class="replaceable"><code>frame_clause</code></em>:
    <em class="replaceable"><code>frame_units</code></em> <em class="replaceable"><code>frame_extent</code></em>

<em class="replaceable"><code>frame_units</code></em>:
    {ROWS | RANGE}
</pre><p>
        frame 句がない場合、このセクションの後半で説明するように、デフォルトのフレームは <code class="literal">ORDER BY</code> 句が存在するかどうかによって異なります。
      </p><p>
        <em class="replaceable"><code>frame_units</code></em> 値は、現在の行とフレーム行の関係のタイプを示します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ROWS</code>: フレームは、開始行と終了行の位置によって定義されます。 オフセットは、現在の行番号と行番号の違いです。 
          </p></li><li class="listitem"><p>
            <code class="literal">RANGE</code>: フレームは、値の範囲内の行によって定義されます。 オフセットは、現在の行の値と行の値の違いです。 
          </p></li></ul></div><p>
        <em class="replaceable"><code>frame_extent</code></em> 値は、フレームの開始点と終了点を示します。 フレームの開始のみを指定するか (この場合、現在の行が暗黙的に終了します)、<code class="literal">BETWEEN</code> を使用して両方のフレームエンドポイントを指定できます: 
      </p><pre class="programlisting"><em class="replaceable"><code>frame_extent</code></em>:
    {<em class="replaceable"><code>frame_start</code></em> | <em class="replaceable"><code>frame_between</code></em>}

<em class="replaceable"><code>frame_between</code></em>:
    BETWEEN <em class="replaceable"><code>frame_start</code></em> AND <em class="replaceable"><code>frame_end</code></em>

<em class="replaceable"><code>frame_start</code></em>, <em class="replaceable"><code>frame_end</code></em>: {
    CURRENT ROW
  | UNBOUNDED PRECEDING
  | UNBOUNDED FOLLOWING
  | <em class="replaceable"><code>expr</code></em> PRECEDING
  | <em class="replaceable"><code>expr</code></em> FOLLOWING
}
</pre><p>
        <code class="literal">BETWEEN</code> 構文では、<em class="replaceable"><code>frame_start</code></em> を <em class="replaceable"><code>frame_end</code></em> より後にすることはできません。
      </p><p>
        許可される <em class="replaceable"><code>frame_start</code></em> および <em class="replaceable"><code>frame_end</code></em> の値には、次の意味があります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CURRENT ROW</code>: <code class="literal">ROWS</code> の場合、バインドは現在の行です。 <code class="literal">RANGE</code> の場合、バインドは現在の行のピアです。 
          </p></li><li class="listitem"><p>
            <code class="literal">UNBOUNDED PRECEDING</code>: バインドは最初のパーティション行です。
          </p></li><li class="listitem"><p>
            <code class="literal">UNBOUNDED FOLLOWING</code>: バインドは最後のパーティション行です。
          </p></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> PRECEDING</code>: <code class="literal">ROWS</code> の場合、バインドは現在の行の前の <em class="replaceable"><code>expr</code></em> 行です。 <code class="literal">RANGE</code> の場合、バインドされるのは、現在の行の値から <em class="replaceable"><code>expr</code></em> を引いた値を持つ行です。現在の行の値が <code class="literal">NULL</code> の場合、バインドされるのは行のピアです。 
          </p><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> PRECEDING</code> (および <code class="literal"><em class="replaceable"><code>expr</code></em> FOLLOWING</code>) の場合、<em class="replaceable"><code>expr</code></em> は <code class="literal">?</code> パラメータマーカー (プリペアドステートメントで使用)、負でない数値リテラルまたは <code class="literal">INTERVAL <em class="replaceable"><code>val</code></em> <em class="replaceable"><code>unit</code></em></code> 形式の時間間隔になります。 <code class="literal">INTERVAL</code> 式の場合、<em class="replaceable"><code>val</code></em> は負でない間隔値を指定し、<em class="replaceable"><code>unit</code></em> は値を解釈する単位を示すキーワードです。 (許可されている <em class="replaceable"><code>units</code></em> 指定子の詳細は、<a class="xref" href="functions.html#date-and-time-functions" title="12.7 日付および時間関数">セクション12.7「日付および時間関数」</a> の <code class="literal">DATE_ADD()</code> 関数の説明を参照してください。) 
          </p><p>
            数値または時間的 <em class="replaceable"><code>expr</code></em> 上の <code class="literal">RANGE</code> には、それぞれ数値式または時間的式上の <code class="literal">ORDER BY</code> が必要です。
          </p><p>
            有効な <code class="literal"><em class="replaceable"><code>expr</code></em> PRECEDING</code> および <code class="literal"><em class="replaceable"><code>expr</code></em> FOLLOWING</code> インジケータの例:
          </p><pre class="programlisting">10 PRECEDING
INTERVAL 5 DAY PRECEDING
5 FOLLOWING
INTERVAL '2:30' MINUTE_SECOND FOLLOWING
</pre></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em> FOLLOWING</code>: <code class="literal">ROWS</code> の場合、バインドは現在の行の後の <em class="replaceable"><code>expr</code></em> 行です。 <code class="literal">RANGE</code> の場合、バインドされるのは、現在の行の値に <em class="replaceable"><code>expr</code></em> を加えた値を持つ行です。現在の行の値が <code class="literal">NULL</code> の場合、バインドされるのは行のピアです。 
          </p><p>
            <em class="replaceable"><code>expr</code></em> の許容値については、<code class="literal"> <em class="replaceable"><code>expr</code></em> PRECEDING</code> の説明を参照してください。
          </p></li></ul></div><p>
        次のクエリーは、<code class="literal">FIRST_VALUE()</code>、<code class="literal">LAST_VALUE()</code> および <code class="literal">NTH_VALUE()</code> の 2 つのインスタンスを示しています:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>FIRST_VALUE(val)  OVER w AS 'first',</code></strong>
         <strong class="userinput"><code>LAST_VALUE(val)   OVER w AS 'last',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 2) OVER w AS 'second',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 4) OVER w AS 'fourth'</code></strong>
       <strong class="userinput"><code>FROM observations</code></strong>
       <strong class="userinput"><code>WINDOW w AS (PARTITION BY subject ORDER BY time</code></strong>
                    <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING);</code></strong>
+----------+---------+------+-------+------+--------+--------+
| time     | subject | val  | first | last | second | fourth |
+----------+---------+------+-------+------+--------+--------+
| 07:00:00 | st113   |   10 |    10 |   10 |   NULL |   NULL |
| 07:15:00 | st113   |    9 |    10 |    9 |      9 |   NULL |
| 07:30:00 | st113   |   25 |    10 |   25 |      9 |   NULL |
| 07:45:00 | st113   |   20 |    10 |   20 |      9 |     20 |
| 07:00:00 | xh458   |    0 |     0 |    0 |   NULL |   NULL |
| 07:15:00 | xh458   |   10 |     0 |   10 |     10 |   NULL |
| 07:30:00 | xh458   |    5 |     0 |    5 |     10 |   NULL |
| 07:45:00 | xh458   |   30 |     0 |   30 |     10 |     30 |
| 08:00:00 | xh458   |   25 |     0 |   25 |     10 |     30 |
+----------+---------+------+-------+------+--------+--------+
</pre><p>
        各関数は、現在のフレーム内の行を使用します。この行は、表示されているウィンドウ定義に従って、最初のパーティション行から現在の行に拡張されます。 <code class="literal">NTH_VALUE()</code> コールの場合、現在のフレームにはリクエストされた行が常に含まれるわけではありません。このような場合、戻り値は <code class="literal">NULL</code> です。 
      </p><p>
        frame 句がない場合、デフォルトのフレームは <code class="literal">ORDER BY</code> 句が存在するかどうかによって異なります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ORDER BY</code> を使用: デフォルトのフレームには、現在の行のすべてのピア (<code class="literal">ORDER BY</code> 句に従って現在の行と等しい行) を含む、パーティションの開始行から現在の行までの行が含まれます。 デフォルトは、次のフレーム仕様と同等です: 
          </p><pre class="programlisting">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
</pre></li><li class="listitem"><p>
            <code class="literal">ORDER BY</code> なし: デフォルトのフレームには、すべてのパーティション行が含まれます (<code class="literal">ORDER BY</code> がない場合、すべてのパーティション行はピアであるため)。 デフォルトは、次のフレーム仕様と同等です: 
          </p><pre class="programlisting">RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
</pre></li></ul></div><p>
        デフォルトのフレームは <code class="literal">ORDER BY</code> の有無によって異なるため、<code class="literal">ORDER BY</code> をクエリーに追加して決定的な結果を取得すると、結果が変わる可能性があります。 (たとえば、<code class="literal">SUM()</code> によって生成される値は変更される可能性があります。) 同じ結果を取得するが、<code class="literal">ORDER BY</code> ごとに順序付けするには、<code class="literal">ORDER BY</code> が存在するかどうかに関係なく、使用する明示的なフレーム仕様を指定します。 
      </p><p>
        現在の行の値が <code class="literal">NULL</code> の場合、フレーム指定の意味は明白ではない可能性があります。 その場合、次の例は様々なフレーム仕様がどのように適用されるかを示しています: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 FOLLOWING AND 15 FOLLOWING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> で始まり、<code class="literal">NULL</code> で停止するため、値が <code class="literal">NULL</code> の行のみが含まれます。
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 FOLLOWING AND UNBOUNDED FOLLOWING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> から始まり、パーティションの最後で停止します。 <code class="literal">ASC</code> ソートでは <code class="literal">NULL</code> 値が最初に配置されるため、フレームはパーティション全体になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X DESC RANGE BETWEEN 10 FOLLOWING AND UNBOUNDED FOLLOWING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> から始まり、パーティションの最後で停止します。 <code class="literal">DESC</code> ソートでは <code class="literal">NULL</code> 値が最後に配置されるため、フレームは <code class="literal">NULL</code> 値のみです。 
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND UNBOUNDED FOLLOWING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> から始まり、パーティションの最後で停止します。 <code class="literal">ASC</code> ソートでは <code class="literal">NULL</code> 値が最初に配置されるため、フレームはパーティション全体になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND 10 FOLLOWING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> で始まり、<code class="literal">NULL</code> で停止するため、値が <code class="literal">NULL</code> の行のみが含まれます。
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND 1 PRECEDING</code>
          </p><p>
            フレームは <code class="literal">NULL</code> で始まり、<code class="literal">NULL</code> で停止するため、値が <code class="literal">NULL</code> の行のみが含まれます。
          </p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING</code>
          </p><p>
            フレームはパーティションの先頭から始まり、値が <code class="literal">NULL</code> の行で停止します。 <code class="literal">ASC</code> ソートでは <code class="literal">NULL</code> 値が最初に配置されるため、フレームは <code class="literal">NULL</code> 値のみです。 
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="window-functions-named-windows"></a>12.21.4 名前付きウィンドウ</h3></div></div></div><a class="indexterm" name="idm46041612677376"></a><a class="indexterm" name="idm46041612675184"></a><p>
        Windows を定義し、<code class="literal">OVER</code> 句でそれらを参照するための名前を付けることができます。 これを行うには、<code class="literal">WINDOW</code> 句を使用します。 クエリーに存在する場合、<code class="literal">WINDOW</code> 句は <code class="literal">HAVING</code> 句と <code class="literal">ORDER BY</code> 句の位置の間にあり、構文は次のとおりです: 
      </p><pre class="programlisting">WINDOW <em class="replaceable"><code>window_name</code></em> AS (<em class="replaceable"><code>window_spec</code></em>)
    [, <em class="replaceable"><code>window_name</code></em> AS (<em class="replaceable"><code>window_spec</code></em>)] ...
</pre><p>
        各ウィンドウ定義について、<a class="xref" href="functions.html#window-functions-usage" title="12.21.2 Window 関数の概念と構文">セクション12.21.2「Window 関数の概念と構文」</a> で説明されているように、<em class="replaceable"><code>window_name</code></em> はウィンドウ名で、<em class="replaceable"><code>window_spec</code></em> は <code class="literal">OVER</code> 句のカッコの間に指定されているものと同じタイプのウィンドウ指定です:
      </p><pre class="programlisting"><em class="replaceable"><code>window_spec</code></em>:
    [<em class="replaceable"><code>window_name</code></em>] [<em class="replaceable"><code>partition_clause</code></em>] [<em class="replaceable"><code>order_clause</code></em>] [<em class="replaceable"><code>frame_clause</code></em>]
</pre><p>
        <code class="literal">WINDOW</code> 句は、複数の <code class="literal">OVER</code> 句が同じウィンドウを定義するクエリーに役立ちます。 かわりに、ウィンドウを一度定義して名前を付け、<code class="literal">OVER</code> 句でその名前を参照できます。 同じウィンドウを複数回定義する次のクエリーについて考えてみます: 
      </p><pre class="programlisting">SELECT
  val,
  ROW_NUMBER() OVER (ORDER BY val) AS 'row_number',
  RANK()       OVER (ORDER BY val) AS 'rank',
  DENSE_RANK() OVER (ORDER BY val) AS 'dense_rank'
FROM numbers;
</pre><p>
        <code class="literal">WINDOW</code> を使用してウィンドウを一度定義し、<code class="literal">OVER</code> 句でウィンドウを名前で参照するだけで、クエリーをより簡単に記述できます:
      </p><pre class="programlisting">SELECT
  val,
  ROW_NUMBER() OVER w AS 'row_number',
  RANK()       OVER w AS 'rank',
  DENSE_RANK() OVER w AS 'dense_rank'
FROM numbers
WINDOW w AS (ORDER BY val);
</pre><p>
        名前付きウィンドウを使用すると、クエリー結果への影響を確認するために、ウィンドウ定義を簡単に試すことができます。 複数の <code class="literal">OVER</code> 句定義ではなく、<code class="literal">WINDOW</code> 句のウィンドウ定義のみを変更する必要があります。 
      </p><p>
        <code class="literal">OVER</code> 句で <code class="literal">OVER <em class="replaceable"><code>window_name</code></em></code> ではなく <code class="literal">OVER (<em class="replaceable"><code>window_name</code></em> ...)</code> を使用する場合、他の句を追加して名前付きウィンドウを変更できます。 たとえば、次のクエリーはパーティション化を含むウィンドウを定義し、<code class="literal">OVER</code> 句で <code class="literal">ORDER BY</code> を使用してウィンドウを様々な方法で変更します: 
      </p><pre class="programlisting">SELECT
  DISTINCT year, country,
  FIRST_VALUE(year) OVER (w ORDER BY year ASC) AS first,
  FIRST_VALUE(year) OVER (w ORDER BY year DESC) AS last
FROM sales
WINDOW w AS (PARTITION BY country);
</pre><p>
        <code class="literal">OVER</code> 句は、名前付きウィンドウにのみプロパティを追加でき、変更はできません。 名前付きウィンドウ定義にパーティション化、順序付けまたはフレーミングプロパティが含まれている場合、ウィンドウ名を参照する <code class="literal">OVER</code> 句にも同じ種類のプロパティを含めることはできず、そうしないとエラーが発生します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ウィンドウ定義と参照元の <code class="literal">OVER</code> 句に同じ種類のプロパティが含まれていないため、この構成は許可されます:
          </p><pre class="programlisting">OVER (w ORDER BY country)
... WINDOW w AS (PARTITION BY country)
</pre></li><li class="listitem"><p>
            <code class="literal">OVER</code> 句では、すでに <code class="literal">PARTITION BY</code> を持つ名前付きウィンドウに対して <code class="literal">PARTITION BY</code> が指定されているため、この構成は許可されません:
          </p><pre class="programlisting">OVER (w PARTITION BY year)
... WINDOW w AS (PARTITION BY country)
</pre></li></ul></div><p>
        名前付きウィンドウの定義自体を <em class="replaceable"><code>window_name</code></em> で始めることができます。 このような場合、前方参照と後方参照は許可されますが、循環は許可されません: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            これは許可されます。前方参照と後方参照は含まれますが、循環は含まれません:
          </p><pre class="programlisting">WINDOW w1 AS (w2), w2 AS (), w3 AS (w1)
</pre></li><li class="listitem"><p>
            サイクルが含まれているため、これは許可されません:
          </p><pre class="programlisting">WINDOW w1 AS (w2), w2 AS (w3), w3 AS (w1)
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="window-function-restrictions"></a>12.21.5 ウィンドウ機能の制限事項</h3></div></div></div><a class="indexterm" name="idm46041612626976"></a><a class="indexterm" name="idm46041612624816"></a><p>
        SQL 標準では、<code class="literal">UPDATE</code> ステートメントまたは <code class="literal">DELETE</code> ステートメントで行を更新するために使用できないという制約がウィンドウ関数に課されます。 このような関数は、これらのステートメントのサブクエリーで (行を選択するために) 使用できます。 
      </p><p>
        MySQL では、次のウィンドウ機能はサポートされていません:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            集計ウィンドウ関数の <code class="literal">DISTINCT</code> 構文。
          </p></li><li class="listitem"><p>
            ネストされたウィンドウ関数。
          </p></li><li class="listitem"><p>
            現在の行の値に依存する動的フレームエンドポイント。
          </p></li></ul></div><p>
        パーサーは、サポートされていない次のウィンドウ構成を認識します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">GROUPS</code> フレーム単位指定子は解析されますが、エラーが発生します。 <code class="literal">ROWS</code> および <code class="literal">RANGE</code> のみがサポートされます。 
          </p></li><li class="listitem"><p>
            フレーム指定の <code class="literal">EXCLUDE</code> 句は解析されますが、エラーが発生します。
          </p></li><li class="listitem"><p>
            <code class="literal">IGNORE NULLS</code> は解析されますが、エラーが発生します。 <code class="literal">RESPECT NULLS</code> のみがサポートされています。 
          </p></li><li class="listitem"><p>
            <code class="literal">FROM LAST</code> は解析されますが、エラーが発生します。 <code class="literal">FROM FIRST</code> のみがサポートされています。 
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-functions"></a>12.22 パフォーマンススキーマ関数</h2></div></div></div><a class="indexterm" name="idm46041612603232"></a><a class="indexterm" name="idm46041612601056"></a><p>
      MySQL 8.0.16 の時点では、MySQL には、パフォーマンススキーマデータを書式設定または取得する組込み SQL 関数が含まれており、対応する <code class="literal">sys</code> スキーマストアドファンクションの同等の機能として使用できます。 組込み関数は、<code class="literal">sys.</code> スキーマ修飾子を必要とする <code class="literal">sys</code> 関数や、<code class="literal">sys</code> が現在のスキーマである <code class="literal">sys</code> 関数とは異なり、任意のスキーマで起動でき、修飾子は必要ありません。 
    </p><div class="table"><a name="idm46041612594864"></a><p class="title"><b>表 12.27 「パフォーマンススキーマ関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「パフォーマンススキーマの関数を一覧表示する参照。」"><col style="width: 25%"><col style="width: 62%"><col style="width: 12%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a></th>
<td>
      バイト数を単位付きの値に変換
    </td>
<td>8.0.16</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a></th>
<td>
      時間をピコ秒単位で値に変換
    </td>
<td>8.0.16</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a></th>
<td>
      現在のスレッドのパフォーマンススキーマスレッド ID
    </td>
<td>8.0.16</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a></th>
<td>
      指定されたスレッドのパフォーマンススキーマスレッド ID
    </td>
<td>8.0.16</td>
</tr></tbody></table></div></div><br class="table-break"><p>
      組込み関数は、非推奨の対応する <code class="literal">sys</code> 関数よりも優先されます。将来のバージョンの MySQL で削除される予定です。 <code class="literal">sys</code> 関数を使用するアプリケーションは、かわりに組込み関数を使用するように調整する必要があります。<code class="literal">sys</code> 関数と組込み関数の若干の違いに注意してください。 これらの違いの詳細は、このセクションの関数の説明を参照してください。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_format-bytes"></a><p>
          <code class="literal">FORMAT_BYTES(<em class="replaceable"><code>count</code></em>)</code>
        </p><a class="indexterm" name="idm46041612561456"></a><p>
          数値バイト数を指定すると、人間が読める形式に変換され、値と単位インジケータで構成される文字列が返されます。 文字列には、小数点以下 2 桁に丸められたバイト数と、3 桁以上の有効桁数が含まれます。 1024 バイト未満の数値は整数として表され、丸められません。 
        </p><p>
          単位インジケータは、次のテーブルに示すようにバイトカウント引数のサイズによって異なります。
        </p><div class="informaltable"><table summary="Units indicators used by FORMAT_BYTES() function."><col style="width: 30%"><col style="width: 25%"><col style="width: 45%"><thead><tr>
              <th scope="col">引数値</th>
              <th scope="col">結果単位</th>
              <th scope="col">結果ユニットインジケータ</th>
            </tr></thead><tbody><tr>
              <th scope="row">1023 まで</th>
              <td>バイト</td>
              <td>バイト</td>
            </tr><tr>
              <th scope="row">1024 <sup>2</sup>− 1 まで</th>
              <td>キビバイト</td>
              <td>KiB</td>
            </tr><tr>
              <th scope="row">1024 <sup>3</sup>− 1 まで</th>
              <td>mebibytes</td>
              <td>MiB</td>
            </tr><tr>
              <th scope="row">1024 <sup>4</sup>− 1 まで</th>
              <td>gibibytes</td>
              <td>GiB</td>
            </tr><tr>
              <th scope="row">1024 <sup>5</sup>− 1 まで</th>
              <td>テビバイト</td>
              <td>TiB</td>
            </tr><tr>
              <th scope="row">1024 <sup>6</sup>− 1 まで</th>
              <td>ペビバイト</td>
              <td>PiB</td>
            </tr><tr>
              <th scope="row">1024 以上の <sup>6</sup></th>
              <td>exbibytes</td>
              <td>EiB</td>
            </tr></tbody></table></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FORMAT_BYTES(512), FORMAT_BYTES(18446644073709551615);</code></strong>
+-------------------+------------------------------------+
| FORMAT_BYTES(512) | FORMAT_BYTES(18446644073709551615) |
+-------------------+------------------------------------+
|  512 bytes        | 16.00 EiB                          |
+-------------------+------------------------------------+
</pre><p>
          <code class="literal">FORMAT_BYTES()</code> が MySQL 8.0.16 に追加されました。 <code class="literal">sys</code> スキーマ <code class="literal">format_bytes()</code> 関数のかわりに使用でき、次の違いに注意してください: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">FORMAT_BYTES()</code> では、<code class="literal">EiB</code> ユニットインジケータが使用されます。<code class="literal">sys.format_bytes()</code> ではサポートされません。
            </p></li></ul></div></li><li class="listitem"><a name="function_format-pico-time"></a><p>
          <code class="literal">FORMAT_PICO_TIME(<em class="replaceable"><code>time_val</code></em>)</code>
        </p><a class="indexterm" name="idm46041612509952"></a><p>
          数値のパフォーマンススキーマレイテンシまたは待機時間をピコ秒単位で指定すると、それを人間が読める形式に変換し、値と単位インジケータで構成される文字列を返します。 文字列には、小数点以下 2 桁に丸められた小数点以下の桁数と、3 桁以上の有効桁数が含まれます。 1 ナノ秒未満の時間は整数で表され、丸められません。 
        </p><p>
          単位インジケータは、次のテーブルに示すように、time-value 引数のサイズによって異なります。
        </p><div class="informaltable"><table summary="Units indicators used by FORMAT_PICO_TIME() function."><col style="width: 30%"><col style="width: 25%"><col style="width: 45%"><thead><tr>
              <th scope="col">引数値</th>
              <th scope="col">結果単位</th>
              <th scope="col">結果ユニットインジケータ</th>
            </tr></thead><tbody><tr>
              <th scope="row">最大 10 <sup>3</sup>− 1</th>
              <td>ピコ秒</td>
              <td>ps</td>
            </tr><tr>
              <th scope="row">最大 10 <sup>6</sup>− 1</th>
              <td>ナノ秒</td>
              <td>ns</td>
            </tr><tr>
              <th scope="row">最大 10 <sup>9</sup>− 1</th>
              <td>マイクロ秒</td>
              <td>us</td>
            </tr><tr>
              <th scope="row">最大 10 <sup>12</sup>− 1</th>
              <td>ミリ秒</td>
              <td>ms</td>
            </tr><tr>
              <th scope="row">最大 60× 10 <sup>12</sup>− 1</th>
              <td>秒</td>
              <td>s</td>
            </tr><tr>
              <th scope="row">3.6× 10 <sup>15</sup>− 1 まで</th>
              <td>minutes</td>
              <td>min</td>
            </tr><tr>
              <th scope="row">8.64× 10 <sup>16</sup>− 1 まで</th>
              <td>hours</td>
              <td>h</td>
            </tr><tr>
              <th scope="row">8.64× 10 <sup>16</sup> 以上</th>
              <td>days</td>
              <td>d</td>
            </tr></tbody></table></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FORMAT_PICO_TIME(3501), FORMAT_PICO_TIME(188732396662000);</code></strong>
+------------------------+-----------------------------------+
| FORMAT_PICO_TIME(3501) | FORMAT_PICO_TIME(188732396662000) |
+------------------------+-----------------------------------+
| 3.50 ns                | 3.15 min                          |
+------------------------+-----------------------------------+
</pre><p>
          <code class="literal">FORMAT_PICO_TIME()</code> が MySQL 8.0.16 に追加されました。 <code class="literal">sys</code> スキーマ <code class="literal">format_time()</code> 関数のかわりに使用でき、次の相違点に注意してください: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              分を示すために、<code class="literal">sys.format_time()</code> では <code class="literal">m</code> ユニットインジケータを使用し、<code class="literal">FORMAT_PICO_TIME()</code> では <code class="literal">min</code> を使用します。
            </p></li><li class="listitem"><p>
              <code class="literal">sys.format_time()</code> では、<code class="literal">w</code> (週) 単位インジケータが使用されます。 <code class="literal">FORMAT_PICO_TIME()</code> はそうではありません。 
            </p></li></ul></div></li><li class="listitem"><a name="function_ps-current-thread-id"></a><p>
          <code class="literal">PS_CURRENT_THREAD_ID()</code>
        </p><a class="indexterm" name="idm46041612450448"></a><p>
          現在の接続に割り当てられているパフォーマンススキーマスレッド ID を表す <code class="literal">BIGINT UNSIGNED</code> 値を返します。
        </p><p>
          スレッド ID の戻り値は、「パフォーマンススキーマ」テーブルの <code class="literal">THREAD_ID</code> カラムで指定された型の値です。
        </p><p>
          パフォーマンススキーマの構成は、<code class="literal">PS_THREAD_ID()</code> の場合と同様に <code class="literal">PS_CURRENT_THREAD_ID()</code> に影響します。 詳細は、その関数の説明を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PS_CURRENT_THREAD_ID();</code></strong>
+------------------------+
| PS_CURRENT_THREAD_ID() |
+------------------------+
|                     52 |
+------------------------+
mysql&gt; <strong class="userinput"><code>SELECT PS_THREAD_ID(CONNECTION_ID());</code></strong>
+-------------------------------+
| PS_THREAD_ID(CONNECTION_ID()) |
+-------------------------------+
|                            52 |
+-------------------------------+
</pre><p>
          <code class="literal">PS_CURRENT_THREAD_ID()</code> が MySQL 8.0.16 に追加されました。 これは、<code class="literal">NULL</code> または <code class="literal">CONNECTION_ID()</code> の引数を使用して <code class="literal">sys</code> スキーマ <code class="literal">ps_thread_id()</code> 関数を起動するショートカットとして使用できます。 
        </p></li><li class="listitem"><a name="function_ps-thread-id"></a><p>
          <code class="literal">PS_THREAD_ID(<em class="replaceable"><code>connection_id</code></em>)</code>
        </p><a class="indexterm" name="idm46041612429792"></a><p>
          接続 ID を指定すると、接続 ID に割り当てられたパフォーマンススキーマスレッド ID を表す <code class="literal">BIGINT UNSIGNED</code> 値を返します。接続 ID のスレッド ID が存在しない場合は、<code class="literal">NULL</code> を返します。 後者は、インストゥルメントされていないスレッドで発生する可能性があります。 
        </p><p>
          接続 ID 引数は、パフォーマンススキーマ <code class="literal">threads</code> テーブルの <code class="literal">PROCESSLIST_ID</code> カラムまたは <code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラムで指定されたタイプの値です。
        </p><p>
          スレッド ID の戻り値は、「パフォーマンススキーマ」テーブルの <code class="literal">THREAD_ID</code> カラムで指定された型の値です。
        </p><p>
          パフォーマンススキーマの構成は、次のように <code class="literal">PS_THREAD_ID()</code> の操作に影響します。 (これらの備考は、<code class="literal">PS_CURRENT_THREAD_ID()</code> にも適用されます。) 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">thread_instrumentation</code> コンシューマを無効にすると、スレッドレベルでの統計の収集および集計は無効になりますが、<code class="literal">PS_THREAD_ID()</code> には影響しません。
            </p></li><li class="listitem"><p>
              <code class="literal">performance_schema_max_thread_instances</code> が 0 でない場合、パフォーマンススキーマはスレッド統計用にメモリーを割り当て、インスタンスメモリーが使用可能な各スレッドに内部 ID を割り当てます。 インスタンスメモリーが使用できないスレッドがある場合、<code class="literal">PS_THREAD_ID()</code> は <code class="literal">NULL</code> を返します。この場合、<code class="literal">Performance_schema_thread_instances_lost</code> はゼロ以外です。 
            </p></li><li class="listitem"><p>
              <code class="literal">performance_schema_max_thread_instances</code> が 0 の場合、パフォーマンススキーマはスレッドメモリーを割り当てず、<code class="literal">PS_THREAD_ID()</code> は <code class="literal">NULL</code> を返します。
            </p></li><li class="listitem"><p>
              パフォーマンススキーマ自体が無効になっている場合、<code class="literal">PS_THREAD_ID()</code> はエラーを生成します。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PS_THREAD_ID(6);</code></strong>
+-----------------+
| PS_THREAD_ID(6) |
+-----------------+
|              45 |
+-----------------+
</pre><p>
          <code class="literal">PS_THREAD_ID()</code> が MySQL 8.0.16 に追加されました。 <code class="literal">sys</code> スキーマ <code class="literal">ps_thread_id()</code> 関数のかわりに使用でき、次の違いに注意してください: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">NULL</code> の引数を指定すると、<code class="literal">sys.ps_thread_id()</code> は現在の接続のスレッド ID を返し、<code class="literal">PS_THREAD_ID()</code> は <code class="literal">NULL</code> を返します。 現在の接続スレッド ID を取得するには、かわりに <code class="literal">PS_CURRENT_THREAD_ID()</code> を使用します。 
            </p></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="internal-functions"></a>12.23 内部関数</h2></div></div></div><a class="indexterm" name="idm46041612389824"></a><a class="indexterm" name="idm46041612388368"></a><div class="table"><a name="idm46041612386480"></a><p class="title"><b>表 12.28 「内部関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「サーバーによる内部使用のみを目的とした関数をリストする参照。」"><col style="width: 25%"><col style="width: 62%"><col style="width: 12%"><thead><tr><th>名前</th>
<th>説明</th>
<th>導入</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="functions.html#function_can-access-column"><code class="literal">CAN_ACCESS_COLUMN()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-database"><code class="literal">CAN_ACCESS_DATABASE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-table"><code class="literal">CAN_ACCESS_TABLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-user"><code class="literal">CAN_ACCESS_USER()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.22</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_can-access-view"><code class="literal">CAN_ACCESS_VIEW()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-column-privileges"><code class="literal">GET_DD_COLUMN_PRIVILEGES()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-create-options"><code class="literal">GET_DD_CREATE_OPTIONS()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_get-dd-index-sub-part-length"><code class="literal">GET_DD_INDEX_SUB_PART_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-auto-increment"><code class="literal">INTERNAL_AUTO_INCREMENT()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-avg-row-length"><code class="literal">INTERNAL_AVG_ROW_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-check-time"><code class="literal">INTERNAL_CHECK_TIME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-checksum"><code class="literal">INTERNAL_CHECKSUM()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-data-free"><code class="literal">INTERNAL_DATA_FREE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-data-length"><code class="literal">INTERNAL_DATA_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-dd-char-length"><code class="literal">INTERNAL_DD_CHAR_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-comment-or-error"><code class="literal">INTERNAL_GET_COMMENT_OR_ERROR()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-enabled-role-json"><code class="literal">INTERNAL_GET_ENABLED_ROLE_JSON()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-hostname"><code class="literal">INTERNAL_GET_HOSTNAME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-username"><code class="literal">INTERNAL_GET_USERNAME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-get-view-warning-or-error"><code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-index-column-cardinality"><code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-index-length"><code class="literal">INTERNAL_INDEX_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-is-enabled-role"><code class="literal">INTERNAL_IS_ENABLED_ROLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-is-mandatory-role"><code class="literal">INTERNAL_IS_MANDATORY_ROLE()</code></a></th>
<td>
      内部使用のみ
    </td>
<td>8.0.19</td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-keys-disabled"><code class="literal">INTERNAL_KEYS_DISABLED()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-max-data-length"><code class="literal">INTERNAL_MAX_DATA_LENGTH()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-table-rows"><code class="literal">INTERNAL_TABLE_ROWS()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="functions.html#function_internal-update-time"><code class="literal">INTERNAL_UPDATE_TIME()</code></a></th>
<td>
      内部使用のみ
    </td>
<td></td>
</tr></tbody></table></div></div><br class="table-break"><p>
      このセクションに記載されている関数は、サーバーによる内部使用のみを目的としています。 ユーザーがそれらを呼び出そうとすると、エラーになります。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_can-access-column"></a><p>
          <code class="literal">CAN_ACCESS_COLUMN(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612258688"></a></li><li class="listitem"><a name="function_can-access-database"></a><p>
          <code class="literal">CAN_ACCESS_DATABASE(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612252192"></a></li><li class="listitem"><a name="function_can-access-table"></a><p>
          <code class="literal">CAN_ACCESS_TABLE(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612245696"></a></li><li class="listitem"><a name="function_can-access-user"></a><p>
          <code class="literal">CAN_ACCESS_USER(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612239264"></a></li><li class="listitem"><a name="function_can-access-view"></a><p>
          <code class="literal">CAN_ACCESS_VIEW(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612232768"></a></li><li class="listitem"><a name="function_get-dd-column-privileges"></a><p>
          <code class="literal">GET_DD_COLUMN_PRIVILEGES(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612226336"></a></li><li class="listitem"><a name="function_get-dd-create-options"></a><p>
          <code class="literal">GET_DD_CREATE_OPTIONS(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612219760"></a></li><li class="listitem"><a name="function_get-dd-index-sub-part-length"></a><p>
          <code class="literal">GET_DD_INDEX_SUB_PART_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612213264"></a></li><li class="listitem"><a name="function_internal-auto-increment"></a><p>
          <code class="literal">INTERNAL_AUTO_INCREMENT(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612206768"></a></li><li class="listitem"><a name="function_internal-avg-row-length"></a><p>
          <code class="literal">INTERNAL_AVG_ROW_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612200208"></a></li><li class="listitem"><a name="function_internal-check-time"></a><p>
          <code class="literal">INTERNAL_CHECK_TIME(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612193632"></a></li><li class="listitem"><a name="function_internal-checksum"></a><p>
          <code class="literal">INTERNAL_CHECKSUM(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612187136"></a></li><li class="listitem"><a name="function_internal-data-free"></a><p>
          <code class="literal">INTERNAL_DATA_FREE(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612180704"></a></li><li class="listitem"><a name="function_internal-data-length"></a><p>
          <code class="literal">INTERNAL_DATA_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612174208"></a></li><li class="listitem"><a name="function_internal-dd-char-length"></a><p>
          <code class="literal">INTERNAL_DD_CHAR_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612167728"></a></li><li class="listitem"><a name="function_internal-get-comment-or-error"></a><p>
          <code class="literal">INTERNAL_GET_COMMENT_OR_ERROR(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612161152"></a></li><li class="listitem"><a name="function_internal-get-enabled-role-json"></a><p>
          <code class="literal">INTERNAL_GET_ENABLED_ROLE_JSON(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612154640"></a></li><li class="listitem"><a name="function_internal-get-hostname"></a><p>
          <code class="literal">INTERNAL_GET_HOSTNAME(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612148000"></a></li><li class="listitem"><a name="function_internal-get-username"></a><p>
          <code class="literal">INTERNAL_GET_USERNAME(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612141440"></a></li><li class="listitem"><a name="function_internal-get-view-warning-or-error"></a><p>
          <code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612134784"></a></li><li class="listitem"><a name="function_internal-index-column-cardinality"></a><p>
          <code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612128176"></a></li><li class="listitem"><a name="function_internal-index-length"></a><p>
          <code class="literal">INTERNAL_INDEX_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612121664"></a></li><li class="listitem"><a name="function_internal-is-enabled-role"></a><p>
          <code class="literal">INTERNAL_IS_ENABLED_ROLE(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612115232"></a></li><li class="listitem"><a name="function_internal-is-mandatory-role"></a><p>
          <code class="literal">INTERNAL_IS_MANDATORY_ROLE(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612108624"></a></li><li class="listitem"><a name="function_internal-keys-disabled"></a><p>
          <code class="literal">INTERNAL_KEYS_DISABLED(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612102032"></a></li><li class="listitem"><a name="function_internal-max-data-length"></a><p>
          <code class="literal">INTERNAL_MAX_DATA_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612095456"></a></li><li class="listitem"><a name="function_internal-table-rows"></a><p>
          <code class="literal">INTERNAL_TABLE_ROWS(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612088880"></a></li><li class="listitem"><a name="function_internal-update-time"></a><p>
          <code class="literal">INTERNAL_UPDATE_TIME(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612082384"></a></li><li class="listitem"><a name="function_is-visible-dd-object"></a><p>
          <code class="literal">IS_VISIBLE_DD_OBJECT(<em class="replaceable"><code>ARGS</code></em>)</code>
        </p><a class="indexterm" name="idm46041612075840"></a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="miscellaneous-functions"></a>12.24 その他の関数</h2></div></div></div><a class="indexterm" name="idm46041612072480"></a><a class="indexterm" name="idm46041612071056"></a><div class="table"><a name="idm46041612069024"></a><p class="title"><b>表 12.29 「その他の関数」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「その他の関数をリストする参照。」"><col style="width: 28%"><col style="width: 71%"><thead><tr><th>名前</th>
<th>説明</th>
</tr></thead><tbody><tr><td><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a></td>
<td>
      ONLY_FULL_GROUP_BY 値の拒否を抑止します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a></td>
<td>
      バイナリ UUID を文字列に変換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></td>
<td>
      テーブルカラムのデフォルト値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a></td>
<td>
      ROLLUP 行と通常の行の区別
    </td>
</tr><tr><td><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></td>
<td>
      IP アドレスの数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></td>
<td>
      数値から IP アドレスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></td>
<td>
      IPv6 アドレスの数値を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></td>
<td>
      数値から IPv6 アドレスを返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></td>
<td>
      引数が IPv4 アドレスかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></td>
<td>
      引数が IPv4 互換アドレスかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></td>
<td>
      引数が IPv4 マップアドレスかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></td>
<td>
      引数が IPv6 アドレスかどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a></td>
<td>
      引数が有効な UUID かどうか
    </td>
</tr><tr><td><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></td>
<td>
      レプリカが指定された位置までのすべての更新を読み取り、適用するまでブロック
    </td>
</tr><tr><td><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></td>
<td>
      カラムの名前を指定
    </td>
</tr><tr><td><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></td>
<td>
      ある秒数間スリープ状態にします
    </td>
</tr><tr><td><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></td>
<td>
      ユニバーサル固有識別子 (UUID) を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></td>
<td>
      整数値のユニバーサル識別子を返します
    </td>
</tr><tr><td><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a></td>
<td>
      文字列 UUID をバイナリに変換
    </td>
</tr><tr><td><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></td>
<td>
      INSERT 中に使用する値の定義
    </td>
</tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_any-value"></a><p>
          <code class="literal">ANY_VALUE(<em class="replaceable"><code>arg</code></em>)</code>
        </p><a class="indexterm" name="idm46041611996448"></a><p>
          この関数は、MySQL が特定できない理由で有効であるとわかっているクエリーを MySQL が拒否する場合に、<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが有効な <code class="literal">GROUP BY</code> クエリーに役立ちます。 関数の戻り値および型は、その引数の戻り値および型と同じですが、関数の結果は <code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードではチェックされません。 
        </p><p>
          たとえば、<code class="literal">name</code> がインデックス付けされていないカラムの場合、次のクエリーは <code class="literal">ONLY_FULL_GROUP_BY</code> が有効になっていると失敗します:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT name, address, MAX(age) FROM t GROUP BY name;</code></strong>
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP
BY clause and contains nonaggregated column 'mydb.t.address' which
is not functionally dependent on columns in GROUP BY clause; this
is incompatible with sql_mode=only_full_group_by
</pre><p>
          <code class="literal">address</code> は、<code class="literal">GROUP BY</code> カラム間で名前が付けられておらず、機能的に依存していない非集計カラムであるため、障害が発生します。 その結果、各 <code class="literal">name</code> グループ内の行の <code class="literal">address</code> 値は非決定的になります。 MySQL でクエリーを受け入れるには、複数の方法があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              テーブルを変更して、<code class="literal">name</code> を主キーまたは一意の <code class="literal">NOT NULL</code> カラムにします。 これにより、MySQL は、<code class="literal">address</code> が <code class="literal">name</code> に機能的に依存していること、つまり <code class="literal">address</code> が <code class="literal">name</code> によって一意に決定されていることを判別できます。 (<code class="literal">NULL</code> を有効な <code class="literal">name</code> 値として許可する必要がある場合、この方法は適用できません。) 
            </p></li><li class="listitem"><p>
              <code class="literal">ANY_VALUE()</code> を使用して、<code class="literal">address</code> を参照します:
            </p><pre class="programlisting">SELECT name, ANY_VALUE(address), MAX(age) FROM t GROUP BY name;
</pre><p>
              この場合、MySQL は各 <code class="literal">name</code> グループ内の <code class="literal">address</code> 値の非決定性を無視し、クエリーを受け入れます。 これは、グループごとに選択される非集計カラムの値を気にしない場合に便利です。 <code class="literal">ANY_VALUE()</code> は、<code class="literal">SUM()</code> や <code class="literal">COUNT()</code> などの関数とは異なり、集計関数ではありません。 非決定的なテストを抑制するだけです。 
            </p></li><li class="listitem"><p>
              <code class="literal">ONLY_FULL_GROUP_BY</code> を無効にします。 これは、前の項目で説明したように、<code class="literal">ONLY_FULL_GROUP_BY</code> を有効にして <code class="literal">ANY_VALUE()</code> を使用することと同等です。 
            </p></li></ul></div><p>
          <code class="literal">ANY_VALUE()</code> は、カラム間に関数従属性が存在するが、MySQL がそれを判別できない場合にも役立ちます。 <code class="literal">age</code> は機能的にグループ化カラム <code class="literal">age-1</code> に依存しているため、次のクエリーは有効ですが、MySQL は <code class="literal">ONLY_FULL_GROUP_BY</code> が有効になっているクエリーを通知および拒否できません: 
        </p><pre class="programlisting">SELECT age FROM t GROUP BY age-1;
</pre><p>
          MySQL がクエリーを受け入れるようにするには、<code class="literal">ANY_VALUE()</code> を使用します:
        </p><pre class="programlisting">SELECT ANY_VALUE(age) FROM t GROUP BY age-1;
</pre><p>
          <code class="literal">ANY_VALUE()</code> は、<code class="literal">GROUP BY</code> 句がない場合に集計関数を参照するクエリーに使用できます:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT name, MAX(age) FROM t;</code></strong>
ERROR 1140 (42000): In aggregated query without GROUP BY, expression
#1 of SELECT list contains nonaggregated column 'mydb.t.name'; this
is incompatible with sql_mode=only_full_group_by
</pre><p>
          <code class="literal">GROUP BY</code> がない場合、単一のグループが存在し、どの <code class="literal">name</code> 値をグループに選択するかは非決定的です。 <code class="literal">ANY_VALUE()</code> は、クエリーを受け入れるように MySQL に指示します: 
        </p><pre class="programlisting">SELECT ANY_VALUE(name), MAX(age) FROM t;
</pre><p>
          特定のデータセットの一部のプロパティのために、選択した非集計カラムが <code class="literal">GROUP BY</code> カラムに実質的に依存していることがわかっている場合があります。 たとえば、アプリケーションでは、あるカラムを別のカラムに対して一意にすることができます。 この場合、効果的に機能的に依存するカラムに <code class="literal">ANY_VALUE()</code> を使用すると意味がある可能性があります。 
        </p><p>
          追加の説明については、<a class="xref" href="functions.html#group-by-handling" title="12.20.3 MySQL での GROUP BY の処理">セクション12.20.3「MySQL での GROUP BY の処理」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_bin-to-uuid"></a><p>
          <code class="literal">BIN_TO_UUID(<em class="replaceable"><code>binary_uuid</code></em>)</code>, <code class="literal">BIN_TO_UUID(<em class="replaceable"><code>binary_uuid</code></em>, <em class="replaceable"><code>swap_flag</code></em>)</code>
        </p><a class="indexterm" name="idm46041611935152"></a><p>
          <code class="literal">BIN_TO_UUID()</code> は、<code class="literal">UUID_TO_BIN()</code> の逆です。 バイナリ UUID を文字列 UUID に変換し、結果を返します。 バイナリ値は、<code class="literal">VARBINARY(16)</code> 値として UUID である必要があります。 戻り値は、ダッシュで区切られた 5 つの 16 進数の <code class="literal">utf8</code> 文字列です。 (この形式の詳細は、<code class="literal">UUID()</code> 関数の説明を参照してください。) UUID 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 無効な引数がある場合は、エラーが発生します。 
        </p><p>
          <code class="literal">BIN_TO_UUID()</code> は、次のいずれかまたは 2 つの引数を取ります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              1 つの引数形式はバイナリ UUID 値を取ります。 UUID 値は、その時間の低い部分と時間の高い部分がスワップされていないと想定されます。 文字列の結果は、バイナリ引数と同じ順序になります。 
            </p></li><li class="listitem"><p>
              2 つの引数形式は、バイナリ UUID 値と swap-flag 値を取ります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <em class="replaceable"><code>swap_flag</code></em> が 0 の場合、2 つの引数の形式は 1 つの引数の形式と同等です。 文字列の結果は、バイナリ引数と同じ順序になります。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>swap_flag</code></em> が 1 の場合、UUID 値には時間の低い部分と時間の高い部分がスワップされているとみなされます。 これらのパーツは、結果値の元の位置にスワップバックされます。 
                </p></li></ul></div></li></ul></div><p>
          使用例および時間部分スワッピングの詳細は、<code class="literal">UUID_TO_BIN()</code> 関数の説明を参照してください。
        </p></li><li class="listitem"><a name="function_default"></a><p>
          <code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code>
        </p><a class="indexterm" name="idm46041611911840"></a><p>
          テーブルカラムのデフォルト値を返します。 カラムにデフォルト値がない場合は、エラーが発生します。 
        </p><p>
          名前付きカラムのデフォルト値を指定するための <code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code> の使用は、リテラルのデフォルト値を持つカラムにのみ許可され、式のデフォルト値を持つカラムには許可されません。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE t SET i = DEFAULT(i)+1 WHERE id &lt; 100;</code></strong>
</pre></li><li class="listitem"><p>
          <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
        </p><p>
          数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。 詳細は、<a class="xref" href="functions.html#string-functions" title="12.8 文字列関数および演算子">セクション12.8「文字列関数および演算子」</a>を参照してください。 
        </p></li><li class="listitem"><a name="function_grouping"></a><p>
          <code class="literal">GROUPING(<em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>expr</code></em>] ...)</code>
        </p><a class="indexterm" name="idm46041611892416"></a><p>
          <code class="literal">WITH ROLLUP</code> 修飾子を含む <code class="literal">GROUP BY</code> クエリーの場合、<code class="literal">ROLLUP</code> 操作により、<code class="literal">NULL</code> がすべての値のセットを表す超集計出力行が生成されます。 <code class="literal">GROUPING()</code> 関数を使用すると、スーパー集計行の <code class="literal">NULL</code> 値を、通常のグループ化された行の <code class="literal">NULL</code> 値と区別できます。 
        </p><p>
          <code class="literal">GROUPING()</code> は、SELECT リストまたは <code class="literal">HAVING</code> 句でのみ使用できます。
        </p><p>
          <code class="literal">GROUPING()</code> の各引数は、<code class="literal">GROUP BY</code> 句の式と完全に一致する式である必要があります。 式は位置指定子にできません。 現在の行の式の値がスーパー集計値を表す <code class="literal">NULL</code> である場合、<code class="literal">GROUPING()</code> は式ごとに 1 を生成します。 それ以外の場合、<code class="literal">GROUPING()</code> は、式の値が正規結果行の <code class="literal">NULL</code> であるか、<code class="literal">NULL</code> ではないことを示す 0 を生成します。 
        </p><p>
          テーブル <code class="literal">t1</code> に次の行が含まれ、<code class="literal">NULL</code> が <span class="quote">「<span class="quote">other</span>」</span> や<span class="quote">「<span class="quote">不明</span>」</span>などを示しているとします:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
+------+-------+----------+
| name | size  | quantity |
+------+-------+----------+
| ball | small |       10 |
| ball | large |       20 |
| ball | NULL  |        5 |
| hoop | small |       15 |
| hoop | large |        5 |
| hoop | NULL  |        3 |
+------+-------+----------+
</pre><p>
          <code class="literal">WITH ROLLUP</code> を使用しないテーブルのサマリーは、次のようになります:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size;</code></strong>
+------+-------+----------+
| name | size  | quantity |
+------+-------+----------+
| ball | small |       10 |
| ball | large |       20 |
| ball | NULL  |        5 |
| hoop | small |       15 |
| hoop | large |        5 |
| hoop | NULL  |        3 |
+------+-------+----------+
</pre><p>
          結果には <code class="literal">NULL</code> 値が含まれていますが、クエリーには <code class="literal">WITH ROLLUP</code> が含まれていないため、それらは上位集計行を表していません。
        </p><p>
          <code class="literal">WITH ROLLUP</code> を追加すると、追加の <code class="literal">NULL</code> 値を含む上位集計サマリー行が生成されます。 ただし、この結果を前の結果と比較しないと、どの <code class="literal">NULL</code> 値がスーパー集計行に出現し、どの値が通常のグループ化された行に出現するかを簡単に確認できません: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+------+-------+----------+
| name | size  | quantity |
+------+-------+----------+
| ball | NULL  |        5 |
| ball | large |       20 |
| ball | small |       10 |
| ball | NULL  |       35 |
| hoop | NULL  |        3 |
| hoop | large |        5 |
| hoop | small |       15 |
| hoop | NULL  |       23 |
| NULL | NULL  |       58 |
+------+-------+----------+
</pre><p>
          スーパー集計行の <code class="literal">NULL</code> 値を通常のグループ化行の <code class="literal">NULL</code> 値と区別するには、<code class="literal">GROUPING()</code> を使用します。これは、スーパー集計 <code class="literal">NULL</code> 値に対してのみ 1 を返します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>name, size, SUM(quantity) AS quantity,</code></strong>
         <strong class="userinput"><code>GROUPING(name) AS grp_name,</code></strong>
         <strong class="userinput"><code>GROUPING(size) AS grp_size</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+------+-------+----------+----------+----------+
| name | size  | quantity | grp_name | grp_size |
+------+-------+----------+----------+----------+
| ball | NULL  |        5 |        0 |        0 |
| ball | large |       20 |        0 |        0 |
| ball | small |       10 |        0 |        0 |
| ball | NULL  |       35 |        0 |        1 |
| hoop | NULL  |        3 |        0 |        0 |
| hoop | large |        5 |        0 |        0 |
| hoop | small |       15 |        0 |        0 |
| hoop | NULL  |       23 |        0 |        1 |
| NULL | NULL  |       58 |        1 |        1 |
+------+-------+----------+----------+----------+
</pre><p>
          <code class="literal">GROUPING()</code> の一般的な使用方法:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              スーパー集計の <code class="literal">NULL</code> 値をラベルに置き換えます:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(name) = 1, 'All items', name) AS name,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(size) = 1, 'All sizes', size) AS size,</code></strong>
         <strong class="userinput"><code>SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+-----------+-----------+----------+
| name      | size      | quantity |
+-----------+-----------+----------+
| ball      | NULL      |        5 |
| ball      | large     |       20 |
| ball      | small     |       10 |
| ball      | All sizes |       35 |
| hoop      | NULL      |        3 |
| hoop      | large     |        5 |
| hoop      | small     |       15 |
| hoop      | All sizes |       23 |
| All items | All sizes |       58 |
+-----------+-----------+----------+
</pre></li><li class="listitem"><p>
              通常のグループ化された明細をフィルタで除外して、超集約明細のみを返します:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(name) = 1 OR GROUPING(size) = 1;</code></strong>
+------+------+----------+
| name | size | quantity |
+------+------+----------+
| ball | NULL |       35 |
| hoop | NULL |       23 |
| NULL | NULL |       58 |
+------+------+----------+
</pre></li></ul></div><p>
          <code class="literal">GROUPING()</code> では、複数の式引数が許可されます。 この場合、<code class="literal">GROUPING()</code> の戻り値は、各式の結果から結合されたビットマスクを表します。ここで、最下位ビットは右端の式の結果に対応します。 たとえば、式の引数が 3 つある場合、<code class="literal">GROUPING(<em class="replaceable"><code>expr1</code></em>, <em class="replaceable"><code>expr2</code></em>, <em class="replaceable"><code>expr3</code></em>)</code> は次のように評価されます: 
        </p><pre class="programlisting">  result for GROUPING(<em class="replaceable"><code>expr3</code></em>)
+ result for GROUPING(<em class="replaceable"><code>expr2</code></em>) &lt;&lt; 1
+ result for GROUPING(<em class="replaceable"><code>expr1</code></em>) &lt;&lt; 2
</pre><p>
          次のクエリーは、複数引数コールで単一の引数の <code class="literal">GROUPING()</code> 結果を組み合せてビットマスク値を生成する方法を示しています:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>name, size, SUM(quantity) AS quantity,</code></strong>
         <strong class="userinput"><code>GROUPING(name) AS grp_name,</code></strong>
         <strong class="userinput"><code>GROUPING(size) AS grp_size,</code></strong>
       <strong class="userinput"><code>GROUPING(name, size) AS grp_all</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong>
+------+-------+----------+----------+----------+---------+
| name | size  | quantity | grp_name | grp_size | grp_all |
+------+-------+----------+----------+----------+---------+
| ball | NULL  |        5 |        0 |        0 |       0 |
| ball | large |       20 |        0 |        0 |       0 |
| ball | small |       10 |        0 |        0 |       0 |
| ball | NULL  |       35 |        0 |        1 |       1 |
| hoop | NULL  |        3 |        0 |        0 |       0 |
| hoop | large |        5 |        0 |        0 |       0 |
| hoop | small |       15 |        0 |        0 |       0 |
| hoop | NULL  |       23 |        0 |        1 |       1 |
| NULL | NULL  |       58 |        1 |        1 |       3 |
+------+-------+----------+----------+----------+---------+
</pre><p>
          複数の式引数では、いずれかの式がスーパー集計値を表す場合、<code class="literal">GROUPING()</code> の戻り値はゼロ以外になります。 したがって、複数引数の <code class="literal">GROUPING()</code> 構文では、複数の単一引数コールではなく単一の複数引数 <code class="literal">GROUPING()</code> コールを使用して、上位集計行のみを戻す以前のクエリーを簡単に記述できます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(name, size) &lt;&gt; 0;</code></strong>
+------+------+----------+
| name | size | quantity |
+------+------+----------+
| ball | NULL |       35 |
| hoop | NULL |       23 |
| NULL | NULL |       58 |
+------+------+----------+
</pre><p>
          <code class="literal">GROUPING()</code> の使用には、次の制限事項があります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              照合が失敗する可能性があるため、サブクエリーの <code class="literal">GROUP BY</code> 式を <code class="literal">GROUPING()</code> 引数として使用しないでください。 たとえば、次のクエリーの照合は失敗します: 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT GROUPING((SELECT MAX(name) FROM t1))</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY (SELECT MAX(name) FROM t1) WITH ROLLUP;</code></strong>
ERROR 3580 (HY000): Argument #1 of GROUPING function is not in GROUP BY
</pre></li><li class="listitem"><p>
              <code class="literal">GROUP BY</code> リテラル式は、<code class="literal">HAVING</code> 句内で <code class="literal">GROUPING()</code> 引数として使用しないでください。 オプティマイザが <code class="literal">GROUP BY</code> と <code class="literal">HAVING</code> を評価するタイミングの違いにより、照合は成功する可能性がありますが、<code class="literal">GROUPING()</code> の評価では予期した結果が生成されません。 次のクエリーについて考えてみます: 
            </p><pre class="programlisting">SELECT a AS f1, 'w' AS f2
FROM t
GROUP BY f1, f2 WITH ROLLUP
HAVING GROUPING(f2) = 1;
</pre><p>
              <code class="literal">GROUPING()</code> は、リテラル定数式に対して、<code class="literal">HAVING</code> 句全体より早く評価され、0 を返します。 このようなクエリーが影響を受けるかどうかを確認するには、<code class="literal">EXPLAIN</code> を使用して <code class="literal">Extra</code> カラムで <code class="literal">Impossible having</code> を探します。 
            </p></li></ul></div><p>
          <code class="literal">WITH ROLLUP</code> および <code class="literal">GROUPING()</code> の詳細は、<a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY 修飾子">セクション12.20.2「GROUP BY 修飾子」</a> を参照してください。
        </p></li><li class="listitem"><a name="function_inet-aton"></a><p>
          <code class="literal">INET_ATON(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611781088"></a><p>
          IPv4 ネットワークアドレスのドット区切り表現が文字列として指定された場合、アドレスの数値を表す整数をネットワークバイト順序 (ビッグエンディアン) で返します。 引数が認識されない場合、<code class="literal">INET_ATON()</code> は <code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INET_ATON('10.0.5.9');</code></strong>
        -&gt; 167773449
</pre><p>
          この例では、戻り値は 10×256<sup>3</sup> + 0×256<sup>2</sup> + 5×256 + 9 として計算されます。
        </p><p>
          <code class="literal">INET_ATON()</code> は、短い形式の IP アドレス (<code class="literal">'127.0.0.1'</code> の表現として <code class="literal">'127.1'</code> など) の場合に、非 <code class="literal">NULL</code> を返す場合と返さない場合があります。 このため、このようなアドレスには <code class="literal">INET_ATON()</code> を使用しないでください。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">INET_ATON()</code> で生成された値を格納するには、署名される <code class="literal">INT</code> ではなく、<code class="literal">INT UNSIGNED</code> カラムを使用します。 署名付きのカラムを使用する場合は、第 1 オクテットが 127 よりも大きい IP アドレスに対応する値を正常に格納できません。 <a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.1.7 範囲外およびオーバーフローの処理">セクション11.1.7「範囲外およびオーバーフローの処理」</a>を参照してください。 
          </p></div></li><li class="listitem"><a name="function_inet-ntoa"></a><p>
          <code class="literal">INET_NTOA(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611757552"></a><p>
          ネットワークバイト順に数値の IPv4 ネットワークアドレスを指定すると、接続文字セットの文字列としてアドレスのドット区切りの文字列表現を戻します。 引数が認識されない場合、<code class="literal">INET_NTOA()</code> は <code class="literal">NULL</code> を返します。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INET_NTOA(167773449);</code></strong>
        -&gt; '10.0.5.9'
</pre></li><li class="listitem"><a name="function_inet6-aton"></a><p>
          <code class="literal">INET6_ATON(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611745216"></a><p>
          IPv6 または IPv4 ネットワークアドレスが文字列として指定された場合、アドレスの数値を表すバイナリ文字列をネットワークバイト順序 (ビッグエンディアン) で返します。 数値書式の IPv6 アドレスでは最大の整数型よりも大きいバイトが必要であるため、この関数で返される表現のデータ型は、<code class="literal">VARBINARY</code> (IPv6 アドレスの場合は <code class="literal">VARBINARY(16)</code>、IPv4 アドレスの場合は <code class="literal">VARBINARY(4)</code>) です。 引数が有効なアドレスでない場合、<code class="literal">INET6_ATON()</code> は <code class="literal">NULL</code> を返します。 
        </p><p>
          次の例では、<code class="literal">HEX()</code> を使用して <code class="literal">INET6_ATON()</code> の結果を出力可能な形式で表示します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong>
        -&gt; 'FDFE0000000000005A55CAFFFEFA9089'
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('10.0.5.9'));</code></strong>
        -&gt; '0A000509'
</pre><p>
          <code class="literal">INET6_ATON()</code> は、有効な引数上の複数の制約を監視します。 これらについては、次のリストに例とともに示します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">fe80::3%1</code> や <code class="literal">fe80::3%eth0</code> のような末尾のゾーン ID は許可されません。
            </p></li><li class="listitem"><p>
              <code class="literal">2001:45f:3:ba::/64</code> や <code class="literal">198.51.100.0/24</code> のような末尾のネットワークマスクは許可されません。
            </p></li><li class="listitem"><p>
              IPv4 アドレスを表す値では、クラスレスアドレスのみがサポートされます。 <code class="literal">198.51.1</code> などのクラスフルアドレスは拒否されます。 <code class="literal">198.51.100.2:8080</code> のような末尾のポート番号は許可されません。 <code class="literal">198.0xa0.1.2</code> のようなアドレスコンポーネント内の 16 進数は許可されません。 8 進数はサポートされていません。<code class="literal">198.51.010.1</code> は <code class="literal">198.51.8.1</code> ではなく、<code class="literal">198.51.10.1</code> として処理されます。 このような IPv4 の制約は、IPv4 アドレス部分を持つ IPv6 アドレス (IPv4 互換アドレスや IPv4 マップアドレスなど) にも適用されます。 
            </p></li></ul></div><p>
          <code class="literal">INT</code> 値として数値形式で表現された IPv4 アドレス <em class="replaceable"><code>expr</code></em> を、<code class="literal">VARBINARY</code> 値として数値形式で表現された IPv6 アドレスに変換するには、次の式を使用します。
        </p><pre class="programlisting">INET6_ATON(INET_NTOA(<em class="replaceable"><code>expr</code></em>))
</pre><p>
          例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON(INET_NTOA(167773449)));</code></strong>
        -&gt; '0A000509'
</pre></li><li class="listitem"><a name="function_inet6-ntoa"></a><p>
          <code class="literal">INET6_NTOA(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611706752"></a><p>
          数値形式でバイナリ文字列として表される IPv6 または IPv4 ネットワークアドレスを指定すると、接続文字セットの文字列としてアドレスの文字列表現を返します。 引数が有効なアドレスでない場合、<code class="literal">INET6_NTOA()</code> は <code class="literal">NULL</code> を返します。 
        </p><p>
          <code class="literal">INET6_NTOA()</code> には、次のようなプロパティーがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              変換はオペレーティングシステムの機能を使用して実行されないため、出力文字列はプラットフォームに依存しません。
            </p></li><li class="listitem"><p>
              戻り文字列の最大長は 39 (4 x 8 + 7) です。 次のステートメントが指定された場合、 
            </p><pre class="programlisting">CREATE TABLE t AS SELECT INET6_NTOA(<em class="replaceable"><code>expr</code></em>) AS c1;
</pre><p>
              結果として生成されるテーブルに次の定義が含まれます。
            </p><pre class="programlisting">CREATE TABLE t (c1 VARCHAR(39) CHARACTER SET utf8 DEFAULT NULL);
</pre></li><li class="listitem"><p>
              戻り文字列では、IPv6 アドレスを表す小文字が使用されます。
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong>
        -&gt; 'fdfe::5a55:caff:fefa:9089'
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('10.0.5.9'));</code></strong>
        -&gt; '10.0.5.9'

mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('FDFE0000000000005A55CAFFFEFA9089'));</code></strong>
        -&gt; 'fdfe::5a55:caff:fefa:9089'
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('0A000509'));</code></strong>
        -&gt; '10.0.5.9'
</pre></li><li class="listitem"><a name="function_is-ipv4"></a><p>
          <code class="literal">IS_IPV4(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611683744"></a><p>
          引数が文字列として指定された有効な IPv4 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4('10.0.5.9'), IS_IPV4('10.0.5.256');</code></strong>
        -&gt; 1, 0
</pre><p>
          特定の引数について、<code class="literal">IS_IPV4()</code> が 1 を返した場合、<code class="literal">INET_ATON()</code> (および <code class="literal">INET6_ATON()</code>) は <code class="literal">NULL</code> 以外を返します。 逆のステートメントは該当しません。一部のケースでは、<code class="literal">IS_IPV4()</code> が 0 を返すと、<code class="literal">INET_ATON()</code> は <code class="literal">NULL</code> 以外を返します。 
        </p><p>
          上記の備考で示したように、<code class="literal">IS_IPV4()</code> は、有効な IPv4 アドレスを構成するものに関して、<code class="literal">INET_ATON()</code> よりも厳密であるため、無効な値に対して強固なチェックを実行する必要のあるアプリケーションで役立つことがあります。 または、<code class="literal">INET6_ATON()</code> を使用して、IPv4 アドレスを内部形式に変換し、(無効なアドレスを示す) <code class="literal">NULL</code> の結果をチェックします。 <code class="literal">INET6_ATON()</code> は、IPv4 アドレスのチェックという点では、<code class="literal">IS_IPV4()</code> と同等の強固さです。 
        </p></li><li class="listitem"><a name="function_is-ipv4-compat"></a><p>
          <code class="literal">IS_IPV4_COMPAT(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611659008"></a><p>
          この関数には、<code class="literal">INET6_ATON()</code> で返されるように、バイナリ文字列として数値形式で表現された IPv6 アドレスが指定されます。 引数が有効な IPv4 互換 IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。 IPv4 互換アドレスの形式は、<code class="literal">::<em class="replaceable"><code>ipv4_address</code></em></code> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9'));</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::ffff:10.0.5.9'));</code></strong>
        -&gt; 0
</pre><p>
          IPv4 互換アドレスの IPv4 部分は、16 進表記法を使用して表現することもできます。 たとえば、<code class="literal">198.51.100.1</code> には、次のような生の 16 進値が含まれます。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('198.51.100.1'));</code></strong>
        -&gt; 'C6336401'
</pre><p>
          IPv4 互換形式で表現された <code class="literal">::198.51.100.1</code> は、<code class="literal">::c0a8:0001</code> または (先頭のゼロなしの) <code class="literal">::c0a8:1</code> と同等です。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::198.51.100.1')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:0001')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:1'));</code></strong>
        -&gt; 1, 1, 1
</pre></li><li class="listitem"><a name="function_is-ipv4-mapped"></a><p>
          <code class="literal">IS_IPV4_MAPPED(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611635712"></a><p>
          この関数には、<code class="literal">INET6_ATON()</code> で返されるように、バイナリ文字列として数値形式で表現された IPv6 アドレスが指定されます。 引数が有効な IPv4 マップ IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。 IPv4 マップアドレスの形式は、<code class="literal">::ffff:<em class="replaceable"><code>ipv4_address</code></em></code> です。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::10.0.5.9'));</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::ffff:10.0.5.9'));</code></strong>
        -&gt; 1
</pre><p>
          <code class="literal">IS_IPV4_COMPAT()</code> と同様に、IPv4 マップアドレスの IPv4 部分は、16 進表記法を使用して表現することもできます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:198.51.100.1')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:0001')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:1'));</code></strong>
        -&gt; 1, 1, 1
</pre></li><li class="listitem"><a name="function_is-ipv6"></a><p>
          <code class="literal">IS_IPV6(<em class="replaceable"><code>expr</code></em>)</code>
        </p><a class="indexterm" name="idm46041611616896"></a><p>
          引数が文字列として指定された有効な IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。 この関数では、IPv4 アドレスが有効な IPv6 アドレスとみなされません。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IS_IPV6('10.0.5.9'), IS_IPV6('::1');</code></strong>
        -&gt; 0, 1
</pre><p>
          特定の引数について、<code class="literal">IS_IPV6()</code> が 1 を返した場合、<code class="literal">INET6_ATON()</code> は <code class="literal">NULL</code> 以外を返します。
        </p></li><li class="listitem"><a name="function_is-uuid"></a><p>
          <code class="literal">IS_UUID(<em class="replaceable"><code>string_uuid</code></em>)</code>
        </p><a class="indexterm" name="idm46041611602976"></a><p>
          引数が有効な文字列形式 UUID の場合は 1、引数が有効な UUID でない場合は 0、引数が <code class="literal">NULL</code> の場合は <code class="literal">NULL</code> を返します。
        </p><p>
          <span class="quote">「<span class="quote">「有効」</span>」</span>は、値が解析可能な形式であることを意味します。 つまり、正しい長さで、許可されている文字のみが含まれます (任意の文字の 16 進数の数字と、オプションでダッシュおよび中カッコ)。 この形式は最も一般的です: 
        </p><pre class="programlisting">aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee
</pre><p>
          次の形式も使用できます:
        </p><pre class="programlisting">aaaaaaaabbbbccccddddeeeeeeeeeeee
{aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee}
</pre><p>
          値内のフィールドの意味については、<code class="literal">UUID()</code> 関数の説明を参照してください。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IS_UUID('6ccd780c-baba-1026-9564-5b8c656024db');</code></strong>
+-------------------------------------------------+
| IS_UUID('6ccd780c-baba-1026-9564-5b8c656024db') |
+-------------------------------------------------+
|                                               1 |
+-------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT IS_UUID('6CCD780C-BABA-1026-9564-5B8C656024DB');</code></strong>
+-------------------------------------------------+
| IS_UUID('6CCD780C-BABA-1026-9564-5B8C656024DB') |
+-------------------------------------------------+
|                                               1 |
+-------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT IS_UUID('6ccd780cbaba102695645b8c656024db');</code></strong>
+---------------------------------------------+
| IS_UUID('6ccd780cbaba102695645b8c656024db') |
+---------------------------------------------+
|                                           1 |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT IS_UUID('{6ccd780c-baba-1026-9564-5b8c656024db}');</code></strong>
+---------------------------------------------------+
| IS_UUID('{6ccd780c-baba-1026-9564-5b8c656024db}') |
+---------------------------------------------------+
|                                                 1 |
+---------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT IS_UUID('6ccd780c-baba-1026-9564-5b8c6560');</code></strong>
+---------------------------------------------+
| IS_UUID('6ccd780c-baba-1026-9564-5b8c6560') |
+---------------------------------------------+
|                                           0 |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT IS_UUID(RAND());</code></strong>
+-----------------+
| IS_UUID(RAND()) |
+-----------------+
|               0 |
+-----------------+
</pre></li><li class="listitem"><a name="function_master-pos-wait"></a><p>
          <code class="literal">MASTER_POS_WAIT(<em class="replaceable"><code>log_name</code></em>,<em class="replaceable"><code>log_pos</code></em>[,<em class="replaceable"><code>timeout</code></em>][,<em class="replaceable"><code>channel</code></em>])</code>
        </p><a class="indexterm" name="idm46041611578384"></a><p>
          この関数は、ソース/レプリカの同期化の制御に役立ちます。 レプリカがソースバイナリログ内の指定された位置までのすべての更新を読み取って適用するまでブロックされます。 戻り値は、レプリカが指定された位置に進むまで待機する必要があったログイベントの数です。 レプリケーション SQL スレッドが開始されていない場合、レプリカソース情報が初期化されていない場合、引数が正しくない場合、またはエラーが発生した場合、関数は <code class="literal">NULL</code> を戻します。 タイムアウトを超えた場合は、<code class="literal">-1</code> を返します。 <code class="literal">MASTER_POS_WAIT()</code> の待機中にレプリケーション SQL スレッドが停止した場合、この関数は <code class="literal">NULL</code> を戻します。 レプリカが指定された位置を過ぎた場合、関数はただちに戻ります。 
        </p><p>
          マルチスレッドのレプリカでは、この関数は、レプリカのステータスを更新するためにチェックポイント操作がコールされたときに、<code class="literal">slave_checkpoint_group</code> または <code class="literal">slave_checkpoint_period</code> システム変数によって設定された制限の期限が切れるまで待機します。 したがって、システム変数の設定によっては、この関数は指定された位置に達した後に時間を返す場合があります。 
        </p><p>
          バイナリログのトランザクション圧縮が使用中で、指定された位置のトランザクションペイロードが (<code class="literal">Transaction_payload_event</code> として) 圧縮されている場合、この関数はトランザクション全体が読み取られて適用され、位置が更新されるまで待機します。
        </p><p>
          <em class="replaceable"><code>timeout</code></em> 値が指定されている場合、<code class="literal">MASTER_POS_WAIT()</code> は、<em class="replaceable"><code>timeout</code></em> 秒が経過した時点で待機を停止します。<em class="replaceable"><code>timeout</code></em> は 0 よりも大きい値にする必要があります。<em class="replaceable"><code>timeout</code></em> がゼロまたは負の値である場合は、タイムアウトがないことを意味します。
        </p><p>
          オプションの <em class="replaceable"><code>channel</code></em> 値を使用すると、関数が適用されるレプリケーションチャネルの名前を指定できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_name-const"></a><p>
          <code class="literal">NAME_CONST(<em class="replaceable"><code>name</code></em>,<em class="replaceable"><code>value</code></em>)</code>
        </p><a class="indexterm" name="idm46041611552528"></a><p>
          指定された値を返します。 結果セットのカラムを生成する際に <code class="literal">NAME_CONST()</code> を使用すると、指定された名前がカラムに付けられます。 引数には定数を指定してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME_CONST('myname', 14);</code></strong>
+--------+
| myname |
+--------+
|     14 |
+--------+
</pre><p>
          この関数は、内部でのみ使用されます。 サーバーは、<a class="xref" href="stored-objects.html#stored-programs-logging" title="25.7 ストアドプログラムバイナリロギング">セクション25.7「ストアドプログラムバイナリロギング」</a> で説明されているように、ローカルプログラム変数への参照を含むストアドプログラムからステートメントを記述するときに使用します。 この関数は、<span class="command"><strong>mysqlbinlog</strong></span> からの出力に表示される場合があります。 
        </p><p>
          アプリケーションで次のような単純なエイリアスを使用しても、上記で示した例とまったく同じ結果を取得できます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 14 AS myname;</code></strong>
+--------+
| myname |
+--------+
|     14 |
+--------+
1 row in set (0.00 sec)
</pre><p>
          カラムのエイリアスについての詳細は、<a class="xref" href="sql-statements.html#select" title="13.2.10 SELECT ステートメント">セクション13.2.10「SELECT ステートメント」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_sleep"></a><p>
          <code class="literal">SLEEP(<em class="replaceable"><code>duration</code></em>)</code>
        </p><a class="indexterm" name="idm46041611535280"></a><p>
          <em class="replaceable"><code>duration</code></em> 引数で指定された秒数間スリープ状態に (一時停止) してから、0 を返します。 この期間には、小数部分が含まれている場合もあります。 引数が <code class="literal">NULL</code> または負の場合、<code class="literal">SLEEP()</code> は厳密な SQL モードで警告またはエラーを生成します。 
        </p><p>
          スリープが正常に (中断なしで) 復帰すると、0 が返されます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SLEEP(1000);</code></strong>
+-------------+
| SLEEP(1000) |
+-------------+
|           0 |
+-------------+
</pre><p>
          <code class="literal">SLEEP()</code> が、中断されたクエリーによって起動される唯一のものである場合、1 を返し、クエリー自体はエラーを返しません。 これは、クエリーが強制終了されたかタイムアウトしたかにかかわらず当てはまります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              このステートメントは、別のセッションから <code class="literal">KILL QUERY</code> を使用して中断されます:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SLEEP(1000);</code></strong>
+-------------+
| SLEEP(1000) |
+-------------+
|           1 |
+-------------+
</pre></li><li class="listitem"><p>
              このステートメントは、タイムアウトによって中断されます:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT /*+ MAX_EXECUTION_TIME(1) */ SLEEP(1000);</code></strong>
+-------------+
| SLEEP(1000) |
+-------------+
|           1 |
+-------------+
</pre></li></ul></div><p>
          <code class="literal">SLEEP()</code> が中断されたクエリーの一部である場合、クエリーはエラーを返します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              このステートメントは、別のセッションから <code class="literal">KILL QUERY</code> を使用して中断されます:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 FROM t1 WHERE SLEEP(1000);</code></strong>
ERROR 1317 (70100): Query execution was interrupted
</pre></li><li class="listitem"><p>
              このステートメントは、タイムアウトによって中断されます:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT /*+ MAX_EXECUTION_TIME(1000) */ 1 FROM t1 WHERE SLEEP(1000);</code></strong>
ERROR 3024 (HY000): Query execution was interrupted, maximum statement
execution time exceeded
</pre></li></ul></div><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_uuid"></a><p>
          <code class="literal">UUID()</code>
        </p><a class="indexterm" name="idm46041611502352"></a><p>
          RFC 4122, <span class="quote">「<span class="quote">「汎用一意の IDentifier (UUID) URN ネームスペース」</span>」</span> (<a class="ulink" href="http://www.ietf.org/rfc/rfc4122.txt" target="_top">http://www.ietf.org/rfc/rfc4122.txt</a>) に従って生成された Universal Unique Identifier (UUID) を返します。
        </p><p>
          UUID は、空間と時間においてグローバルに一意の数字として設計されています。 これらのコールが相互に接続されていない 2 つの別々のデバイスで実行された場合でも、<code class="literal">UUID()</code> への 2 つのコールでは 2 つの異なる値が生成されることが予想されます。 
        </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">警告</div><p>
            <code class="literal">UUID()</code> 値の目的は一意性を保つことですが、必ずしも推測不可能または予測不可能であるとはかぎりません。 予測不可能性が必要である場合は、UUID 値を何か別の方法で生成してください。 
          </p></div><p>
          <code class="literal">UUID()</code> は、RFC 4122 で説明されている UUID バージョン 1 に準拠する値を返します。 値は 128 ビットの数値で、<code class="literal">aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</code> 形式の 5 つの 16 進数の <code class="literal">utf8</code> 文字列として表されます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              最初の 3 つの数値は、タイムスタンプの下位、中間および上位の部分から生成されます。 上位には UUID バージョン番号も含まれます。 
            </p></li><li class="listitem"><p>
              4 番目の数字には、(たとえば、サマータイムが原因で) タイムスタンプ値の単調性が失われる場合に備えて、時間の一意性が保持されます。
            </p></li><li class="listitem"><p>
              5 番目の数字は、空間の一意性を提供する IEEE 802 ノード番号です。 ランダムな番号が代入されるのは、後者が使用できない場合です (たとえば、ホストデバイスにイーサネットカードがない場合や、ホストオペレーティングシステムでインタフェースのハードウェアアドレスを検出する方法が不明な場合など)。 この場合、空間の一意性は保証できません。 しかしそれでも、競合が発生する可能性は<span class="emphasis"><em>非常に</em></span>低くなります。 
            </p><p>
              インタフェースの MAC アドレスは、FreeBSD、Linux および Windows でのみ考慮されます。 その他のオペレーティングシステムでは、ランダムに生成された 48 ビットの数字が MySQL で使用されます。 
            </p></li></ul></div><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UUID();</code></strong>
        -&gt; '6ccd780c-baba-1026-9564-5b8c656024db'
</pre><p>
          文字列とバイナリ UUID の値を変換するには、<code class="literal">UUID_TO_BIN()</code> 関数と <code class="literal">BIN_TO_UUID()</code> 関数を使用します。 文字列が有効な UUID 値であるかどうかを確認するには、<code class="literal">IS_UUID()</code> 関数を使用します。 
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。 <code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。 
        </p></li><li class="listitem"><a name="function_uuid-short"></a><p>
          <code class="literal">UUID_SHORT()</code>
        </p><a class="indexterm" name="idm46041611471744"></a><p>
          <span class="quote">「<span class="quote">short</span>」</span> 汎用識別子を 64 ビット符号なし整数として返します。 <code class="literal">UUID_SHORT()</code> によって返される値は、<code class="literal">UUID()</code> 関数によって返される文字列形式 128 ビット識別子とは異なり、一意性プロパティが異なります。 次の条件を満たす場合は、<code class="literal">UUID_SHORT()</code> の値が一意であることが保証されます。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              現在のサーバーの <code class="literal">server_id</code> 値は 0 から 255 の間で、ソースサーバーとレプリカサーバーのセット間で一意です
            </p></li><li class="listitem"><p>
              <span class="command"><strong>mysqld</strong></span> の再起動間にサーバーホストのシステム時間を設定しません
            </p></li><li class="listitem"><p>
              <span class="command"><strong>mysqld</strong></span> の再起動間に、平均 16 百万回/秒未満で <code class="literal">UUID_SHORT()</code> を起動
            </p></li></ul></div><p>
          <code class="literal">UUID_SHORT()</code> の戻り値は、次のように構成されます。
        </p><pre class="programlisting">  (server_id &amp; 255) &lt;&lt; 56
+ (server_startup_time_in_seconds &lt;&lt; 24)
+ incremented_variable++;
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UUID_SHORT();</code></strong>
        -&gt; 92395783831158784
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">UUID_SHORT()</code> は、ステートメントベースのレプリケーションでは正しく動作しません。
          </p></div></li><li class="listitem"><a name="function_uuid-to-bin"></a><p>
          <code class="literal">UUID_TO_BIN(<em class="replaceable"><code>string_uuid</code></em>)</code>, <code class="literal">UUID_TO_BIN(<em class="replaceable"><code>string_uuid</code></em>, <em class="replaceable"><code>swap_flag</code></em>)</code>
        </p><a class="indexterm" name="idm46041611444496"></a><p>
          文字列 UUID をバイナリ UUID に変換し、結果を返します。 (<code class="literal">IS_UUID()</code> 関数の説明には、許可されている文字列 UUID 形式がリストされます。) 戻りバイナリ UUID は <code class="literal">VARBINARY(16)</code> 値です。 UUID 引数が <code class="literal">NULL</code> の場合、戻り値は <code class="literal">NULL</code> です。 無効な引数がある場合は、エラーが発生します。 
        </p><p>
          <code class="literal">UUID_TO_BIN()</code> は、次のいずれかまたは 2 つの引数を取ります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              1 つの引数形式は、文字列 UUID 値を取ります。 バイナリ結果は、文字列引数と同じ順序になります。 
            </p></li><li class="listitem"><p>
              2 つの引数形式は、文字列 UUID 値とフラグ値を取ります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <em class="replaceable"><code>swap_flag</code></em> が 0 の場合、2 つの引数の形式は 1 つの引数の形式と同等です。 バイナリ結果は、文字列引数と同じ順序になります。 
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>swap_flag</code></em> が 1 の場合、戻り値の形式は異なります: time-low 部分と time-high 部分 (それぞれ 16 進数の最初と 3 番目のグループ) がスワップされます。 これにより、より迅速に変化する部分が右側に移動し、結果がインデックス付けされたカラムに格納されている場合はインデックス付けの効率を向上させることができます。 
                </p></li></ul></div></li></ul></div><p>
          タイムパーティススワッピングでは、UUID バージョン 1 の値 (<code class="literal">UUID()</code> 関数によって生成される値など) を使用することを前提としています。 他の方法で生成された UUID 値がバージョン 1 形式に従っていない場合、時間部分スワッピングには利点がありません。 バージョン 1 形式の詳細は、<code class="literal">UUID()</code> 関数の説明を参照してください。 
        </p><p>
          次の文字列 UUID 値があるとします:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @uuid = '6ccd780c-baba-1026-9564-5b8c656024db';</code></strong>
</pre><p>
          時間部分スワップの有無にかかわらず文字列 UUID をバイナリに変換するには、<code class="literal">UUID_TO_BIN()</code> を使用します:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid));</code></strong>
+----------------------------------+
| HEX(UUID_TO_BIN(@uuid))          |
+----------------------------------+
| 6CCD780CBABA102695645B8C656024DB |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid, 0));</code></strong>
+----------------------------------+
| HEX(UUID_TO_BIN(@uuid, 0))       |
+----------------------------------+
| 6CCD780CBABA102695645B8C656024DB |
+----------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid, 1));</code></strong>
+----------------------------------+
| HEX(UUID_TO_BIN(@uuid, 1))       |
+----------------------------------+
| 1026BABA6CCD780C95645B8C656024DB |
+----------------------------------+
</pre><p>
          <code class="literal">UUID_TO_BIN()</code> によって返されたバイナリ UUID を文字列 UUID に変換するには、<code class="literal">BIN_TO_UUID()</code> を使用します。 時間部分を入れ替えるために、第 2 引数 1 を指定して <code class="literal">UUID_TO_BIN()</code> を呼び出してバイナリ UUID を生成する場合は、バイナリ UUID を文字列 UUID に戻すときに時間部分のスワップを解除するために、第 2 引数 1 を <code class="literal">BIN_TO_UUID()</code> に渡すことも必要です: 
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid));</code></strong>
+--------------------------------------+
| BIN_TO_UUID(UUID_TO_BIN(@uuid))      |
+--------------------------------------+
| 6ccd780c-baba-1026-9564-5b8c656024db |
+--------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,0),0);</code></strong>
+--------------------------------------+
| BIN_TO_UUID(UUID_TO_BIN(@uuid,0),0)  |
+--------------------------------------+
| 6ccd780c-baba-1026-9564-5b8c656024db |
+--------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,1),1);</code></strong>
+--------------------------------------+
| BIN_TO_UUID(UUID_TO_BIN(@uuid,1),1)  |
+--------------------------------------+
| 6ccd780c-baba-1026-9564-5b8c656024db |
+--------------------------------------+
</pre><p>
          時間部分スワッピングの使用が両方の方向の変換で同じでない場合、元の UUID は適切にリカバリされません:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,0),1);</code></strong>
+--------------------------------------+
| BIN_TO_UUID(UUID_TO_BIN(@uuid,0),1)  |
+--------------------------------------+
| baba1026-780c-6ccd-9564-5b8c656024db |
+--------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,1),0);</code></strong>
+--------------------------------------+
| BIN_TO_UUID(UUID_TO_BIN(@uuid,1),0)  |
+--------------------------------------+
| 1026baba-6ccd-780c-9564-5b8c656024db |
+--------------------------------------+
</pre></li><li class="listitem"><a name="function_values"></a><p>
          <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code>
        </p><a class="indexterm" name="idm46041611400736"></a><p>
          <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code> ステートメントでは、<code class="literal">UPDATE</code> 句の <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code> 関数を使用すると、ステートメントの <code class="literal">INSERT</code> 部分からカラム値を参照できます。 つまり、<code class="literal">UPDATE</code> 句の <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code> は、挿入される <em class="replaceable"><code>col_name</code></em> 値を参照するため、重複キーの競合が発生しなくなります。 この関数は、複数の行を挿入する際に特に役立ちます。 <code class="literal">VALUES()</code> 関数は、<code class="literal">INSERT</code> ステートメントの <code class="literal">ON DUPLICATE KEY UPDATE</code> 句でのみ有効であり、それ以外の場合は <code class="literal">NULL</code> を返します。 <a class="xref" href="sql-statements.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE ステートメント">セクション13.2.6.2「INSERT ... ON DUPLICATE KEY UPDATE ステートメント」</a>を参照してください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)</code></strong>
    -&gt; <strong class="userinput"><code>ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);</code></strong>
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            この使用方法は MySQL 8.0.20 では非推奨であり、MySQL の将来のリリースで削除される予定です。 かわりに、行のエイリアスまたは行とカラムのエイリアスを使用してください。 詳細および例については、<a class="xref" href="sql-statements.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE ステートメント">セクション13.2.6.2「INSERT ... ON DUPLICATE KEY UPDATE ステートメント」</a>を参照してください。 
          </p></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="precision-math"></a>12.25 高精度計算</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#precision-math-numbers">12.25.1 数値の型</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics">12.25.2 DECIMAL データ型の特性</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions">12.25.3 式の処理</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding">12.25.4 丸め動作</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples">12.25.5 高精度計算の例</a></span></dt></dl></div><a class="indexterm" name="idm46041611379072"></a><a class="indexterm" name="idm46041611377600"></a><a class="indexterm" name="idm46041611376256"></a><a class="indexterm" name="idm46041611374912"></a><a class="indexterm" name="idm46041611373520"></a><a class="indexterm" name="idm46041611372144"></a><a class="indexterm" name="idm46041611370784"></a><a class="indexterm" name="idm46041611368752"></a><a class="indexterm" name="idm46041611366720"></a><a class="indexterm" name="idm46041611365360"></a><a class="indexterm" name="idm46041611364000"></a><a class="indexterm" name="idm46041611362624"></a><p>
    MySQL では、精度計算がサポートされます: 数値の処理によって非常に正確な結果が得られ、無効な値をより詳細に制御できます。 高精度計算は、次の 2 つの機能に基づいています。 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        サーバーが無効なデータの受け入れまたは拒否に関してどの程度厳密かを制御する SQL モード。
      </p></li><li class="listitem"><p>
        固定小数点数演算のための MySQL ライブラリ。
      </p></li></ul></div><p>
    これらの機能は数値操作にいくつかの影響を与えるとともに、標準 SQL への高度の準拠を実現します。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <span class="bold"><strong>正確な計算</strong></span>: 厳密値数値の場合、計算に浮動小数点エラーは導入されません。 代わりに、正確な精度が使用されます。 たとえば、MySQL は <code class="literal">.0001</code> などの数値を近似値ではなく厳密値として処理し、それを 10,000 回合計すると 1 に<span class="quote">「<span class="quote">近い</span>」</span>だけの値ではなく、正確に <code class="literal">1</code> の結果が生成されます。 
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>適切に定義された丸め動作</strong></span>: 厳密値数値の場合、<code class="literal">ROUND()</code> の結果は、ベースとなる C ライブラリの動作方法などの環境要因ではなく、その引数に依存します。
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>プラットフォームからの独立</strong></span>: 厳密値数値に対する操作は、Windows や Unix などの各プラットフォームにわたって同じです。
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>無効な値の処理に対する制御</strong></span>: オーバーフローおよび 0 による除算が検出可能であり、これらはエラーとして処理できます。 たとえば、あるカラムに対して大きすぎる値は、そのカラムのデータ型の範囲内に収まるように値が切り捨てられるようにするのではなく、エラーとして処理できます。 同様に、0 による除算は、<code class="literal">NULL</code> の結果を生成する操作としてではなく、エラーとして処理できます。 どちらのアプローチをとるかの選択は、サーバー SQL モードの設定によって決定されます。 
      </p></li></ul></div><p>
    次の説明では、古いアプリケーションとの非互換性の可能性を含め、高精度計算の動作方法のいくつかの側面について触れています。 最後に、MySQL が数値操作を正確に処理する方法を示すいくつかの例を示します。 SQL モードの制御については、<a class="xref" href="server-administration.html#sql-mode" title="5.1.11 サーバー SQL モード">セクション5.1.11「サーバー SQL モード」</a>を参照してください。 
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-numbers"></a>12.25.1 数値の型</h3></div></div></div><a class="indexterm" name="idm46041611341040"></a><a class="indexterm" name="idm46041611339536"></a><a class="indexterm" name="idm46041611338160"></a><a class="indexterm" name="idm46041611336240"></a><p>
      厳密値の操作に関する高精度計算のスコープには、厳密値データ型 (整数および <code class="literal">DECIMAL</code> 型) と厳密値数値リテラルが含まれます。 近似値データ型および数値リテラルは、浮動小数点数として処理されます。 
    </p><p>
      正確値の数値リテラルには、整数部または小数部、あるいはその両方が含まれています。 これらには符号を付けることができます。 例: <code class="literal">1</code>、<code class="literal">.2</code>、<code class="literal">3.4</code>、<code class="literal">-5</code>、<code class="literal">-6.78</code>、<code class="literal">+9.10</code>。 
    </p><p>
      近似値の数値リテラルは仮数と指数による指数表現で表されます。 一方または両方の部分に符号を付けることができます。 例: <code class="literal">1.2E3</code>、<code class="literal">1.2E-3</code>、<code class="literal">-1.2E3</code>、<code class="literal">-1.2E-3</code>。 
    </p><p>
      2 つの数値が同じように見えても、別々に扱われることがあります。 たとえば、<code class="literal">2.34</code> は (固定小数点の) 正確値ですが、<code class="literal">2.34E0</code> は (浮動小数点の) 近似値です。 
    </p><p>
      <code class="literal">DECIMAL</code> データ型は固定小数点型で、計算は正確です。 MySQL では、<code class="literal">DECIMAL</code> 型には、<code class="literal">NUMERIC</code>、<code class="literal">DEC</code>、<code class="literal">FIXED</code> という複数のシノニムがあります。 整数型も正確値型です。 
    </p><p>
      <code class="literal">FLOAT</code> データ型および <code class="literal">DOUBLE</code> データ型は浮動小数点型で、計算によって近似値が得られます。 MySQL では、<code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code> のシノニムである型は <code class="literal">DOUBLE PRECISION</code> および <code class="literal">REAL</code> です。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-decimal-characteristics"></a>12.25.2 DECIMAL データ型の特性</h3></div></div></div><p>
      このセクションでは、<code class="literal">DECIMAL</code> データ型 (およびそのシノニム) の特性について説明します。内容は次のとおりです:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          最大桁数
        </p></li><li class="listitem"><p>
          ストレージフォーマット
        </p></li><li class="listitem"><p>
          ストレージ要件
        </p></li><li class="listitem"><p>
          <code class="literal">DECIMAL</code> カラムの上限への非標準の MySQL 拡張。
        </p></li></ul></div><p>
      <code class="literal">DECIMAL</code> カラムの宣言構文は、<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> です。 引数の値の範囲は次のとおりです: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>M</code></em> は、最大桁数 (精度) です。 その範囲は 1 から 65 までです。 
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em> は、小数点の右側の桁数 (スケール) です。 その範囲は 0 から 30 までであり、<em class="replaceable"><code>M</code></em> より大きくすることはできません。 
        </p></li></ul></div><p>
      <em class="replaceable"><code>D</code></em> が省略された場合のデフォルトは 0 です。 <em class="replaceable"><code>M</code></em> が省略された場合のデフォルトは 10 です。 
    </p><p>
      <em class="replaceable"><code>M</code></em> が 65 の最大値である場合は、<code class="literal">DECIMAL</code> 値に対する計算が 65 桁まで正確であることを示します。 この 65 桁の精度の制限は厳密値数値リテラルにも適用されるため、このようなリテラルの最大範囲は以前とは異なります。 (<code class="literal">DECIMAL</code> リテラルのテキストの長さには制限もあります。<a class="xref" href="functions.html#precision-math-expressions" title="12.25.3 式の処理">セクション12.25.3「式の処理」</a> を参照してください。) 
    </p><p>
      <code class="literal">DECIMAL</code> カラムの値は、9 桁の小数点を 4 バイトにパックするバイナリ形式を使用して格納されます。 各値の整数部と小数部に対するストレージ要件は個別に決定されます。 9 桁の繰り返しごとに 4 バイトが必要であり、残りの桁がある場合は、4 バイトのうちの一部が必要になります。 残りの桁に必要なストレージは、次の表で指定されます。 
    </p><div class="informaltable"><table summary="The number of bytes required for remaining/leftover digits in DECIMAL values."><col style="width: 25%"><col style="width: 25%"><thead><tr>
          <th>余りの桁</th>
          <th>バイト数</th>
        </tr></thead><tbody><tr>
          <td>0</td>
          <td>0</td>
        </tr><tr>
          <td>1-2</td>
          <td>1</td>
        </tr><tr>
          <td>3-4</td>
          <td>2</td>
        </tr><tr>
          <td>5-6</td>
          <td>3</td>
        </tr><tr>
          <td>7-9</td>
          <td>4</td>
        </tr></tbody></table></div><p>
      たとえば、<code class="literal">DECIMAL(18,9)</code> カラムは小数点の両側に 9 桁あるため、整数部と小数部のそれぞれに 4 バイトが必要です。 <code class="literal">DECIMAL(20,6)</code> カラムは整数部に 14 桁、小数部に 6 桁あります。 整数部の桁は、そのうちの 9 桁に 4 バイト、残りの 5 桁に 3 バイトが必要です。 小数部の 6 桁には 3 バイトが必要です。 
    </p><p>
      <code class="literal">DECIMAL</code> カラムには、先頭の <code class="literal">+</code> 文字、<code class="literal">-</code> 文字または先頭の <code class="literal">0</code> 桁は格納されません。 <code class="literal">DECIMAL(5,1)</code> カラムに <code class="literal">+0003.1</code> を挿入すると、それは <code class="literal">3.1</code> として格納されます。 負の数の場合、リテラルの <code class="literal">-</code> 文字は格納されません。 
    </p><p>
      <code class="literal">DECIMAL</code> カラムでは、カラム定義で暗黙的に指定された範囲を超える値は許可されません。 たとえば、<code class="literal">DECIMAL(3,0)</code> カラムは <code class="literal">-999</code> から <code class="literal">999</code> までの範囲をサポートします。 <code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> カラムでは、<em class="replaceable"><code>M</code></em> まで使用できます - 小数点の左側の <em class="replaceable"><code>D</code></em> 桁。 
    </p><p>
      SQL 標準では、<code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> の精度は<span class="emphasis"><em>正確に</em></span> <em class="replaceable"><code>M</code></em> 桁である必要があります。 <code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> の場合、この標準では少なくとも <em class="replaceable"><code>M</code></em> 桁の精度が必要ですが、それを超える精度が許可されます。 MySQL では、<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> と <code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> は同じであり、どちらも正確に <em class="replaceable"><code>M</code></em> 桁の精度を持っています。 
    </p><p>
      <code class="literal">DECIMAL</code> 値の内部形式の完全な説明については、MySQL ソース配布内のファイル <code class="filename">strings/decimal.c</code> を参照してください。 この形式は、<code class="literal">decimal2bin()</code> 関数で (例を使用して) 説明されています。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-expressions"></a>12.25.3 式の処理</h3></div></div></div><p>
      高精度計算では、可能な場合は常に、厳密値数値は与えられたとおりに使用されます。 たとえば、比較での数値は、値を変更することなく正確に指定されたとおりに使用されます。 厳密な SQL モードでは、厳密値データ型 (<code class="literal">DECIMAL</code> または整数) を持つカラムへの <code class="literal">INSERT</code> の場合、数値の厳密値がそのカラムの範囲内にあれば、その数値が厳密値で挿入されます。 取得されると、その値は、挿入された値と同じになるはずです。 (厳密な SQL モードが有効になっていない場合は、<code class="literal">INSERT</code> での切り捨てが許可されます。) 
    </p><p>
      数値式の処理は、その式にどのような種類の値が含まれているかによって異なります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          近似値が存在する場合、その式は近似値であるため、浮動小数点演算を使用して評価されます。
        </p></li><li class="listitem"><p>
          近似値が存在しない場合、その式には厳密値のみが含まれています。 いずれかの厳密値に小数部 (小数点に続く値) が含まれている場合、その式は <code class="literal">DECIMAL</code> の正確な演算を使用して評価され、精度は 65 桁になります。 <span class="quote">「<span class="quote">正確な</span>」</span>という用語は、バイナリで表すことができる精度の制限に従います。 たとえば、<code class="literal">1.0/3.0</code> は 10 進数表記で <code class="literal">.333...</code> と近似できますが、厳密値数値として記述されないため、<code class="literal">(1.0/3.0)*3.0</code> は正確には <code class="literal">1.0</code> に評価されません。 
        </p></li><li class="listitem"><p>
          それ以外の場合、式には整数値のみが含まれています。 その式は厳密値であり、整数演算を使用して評価され、精度は <code class="literal">BIGINT</code> (64 ビット) と同じになります。 
        </p></li></ul></div><p>
      数値式に文字列が含まれている場合、その文字列は倍精度浮動小数点値に変換され、その式は近似値になります。
    </p><p>
      数値カラムへの挿入は、<code class="literal">sql_mode</code> システム変数によって制御される SQL モードによって影響を受けます。 (<a class="xref" href="server-administration.html#sql-mode" title="5.1.11 サーバー SQL モード">セクション5.1.11「サーバー SQL モード」</a>を参照してください。) 次の説明では、厳密モード (<code class="literal">STRICT_ALL_TABLES</code> または <code class="literal">STRICT_TRANS_TABLES</code> モード値によって選択されます) および <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> について触れています。 すべての制限を有効にするには、単純に、厳密モード値と <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> の両方を含む <code class="literal">TRADITIONAL</code> モードを使用できます。 
    </p><pre class="programlisting">SET sql_mode='TRADITIONAL';
</pre><p>
      数値が正確な型のカラム (<code class="literal">DECIMAL</code> または整数) に挿入された場合、その数値がカラムの範囲および精度内にあれば、正確な値とともに挿入されます。
    </p><p>
      小数部の桁数が多すぎる場合、端数処理が行われ、ノートが生成されます。 丸めは、<a class="xref" href="functions.html#precision-math-rounding" title="12.25.4 丸め動作">セクション12.25.4「丸め動作」</a>で説明されているとおりに実行されます。 小数部の丸めによる切捨ては、厳密モードでもエラーではありません。 
    </p><p>
      整数部の桁数が多すぎる場合、値は大きすぎる (範囲外) ため、次のように処理されます:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密モードが有効になっていない場合は、その値がもっとも近い正当な値に切り捨てられ、警告が生成されます。
        </p></li><li class="listitem"><p>
          厳密モードが有効になっている場合は、オーバーフローエラーが発生します。
        </p></li></ul></div><p>
      <code class="literal">DECIMAL</code> リテラルの場合、65 桁の精度制限に加えて、リテラルのテキストの長さに制限があります。 値が約 80 文字を超えると、予期しない結果が発生する可能性があります。 例: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
       <strong class="userinput"><code>CAST(0000000000000000000000000000000000000000000000000000000000000000000000000000000020.01 AS DECIMAL(15,2)) as val;</code></strong>
+------------------+
| val              |
+------------------+
| 9999999999999.99 |
+------------------+
1 row in set, 2 warnings (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------------+
| Level   | Code | Message                                      |
+---------+------+----------------------------------------------+
| Warning | 1292 | Truncated incorrect DECIMAL value: '20'      |
| Warning | 1264 | Out of range value for column 'val' at row 1 |
+---------+------+----------------------------------------------+
2 rows in set (0.00 sec)
</pre><p>
      アンダーフローは検出されないため、アンダーフローの処理は定義されていません。
    </p><p>
      数値カラムへの文字列の挿入では、その文字列に非数値の内容が含まれている場合、文字列から数値への変換は次のように処理されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数値で始まらない文字列を数値として使用することはできないため、この文字列により厳密モードではエラーが生成され、それ以外の場合は警告が生成されます。 これには、空の文字列が含まれます。 
        </p></li><li class="listitem"><p>
          数値で始まる文字列は変換できますが、後続の非数値の部分は切り捨てられます。 その切り捨てられた部分にスペース以外の文字が含まれている場合、厳密モードではエラーが生成され、それ以外の場合は警告が生成されます。 
        </p></li></ul></div><p>
      デフォルトでは、0 による除算によって <code class="literal">NULL</code> の結果が生成され、警告は生成されません。 SQL モードを適切に設定することにより、0 による除算を制限できます。 
    </p><p>
      <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> SQL モードが有効になっている場合、MySQL は、0 による除算を次の異なった方法で処理します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密モードが有効になっていない場合は、警告が発生します。
        </p></li><li class="listitem"><p>
          厳密モードが有効になっている場合は、0 による除算を含む挿入と更新が禁止され、エラーが発生します。
        </p></li></ul></div><p>
      つまり、0 による除算を実行する式を含む挿入や更新をエラーとして処理できますが、それには、厳密モードに加えて <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> が必要です。
    </p><p>
      次のステートメントがあるとします。
    </p><pre class="programlisting">INSERT INTO t SET i = 1/0;
</pre><p>
      次に、厳密モードと <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> モードの各組み合わせに対する動作を示します。
    </p><div class="informaltable"><table summary="What happens for combinations of strict and ERROR_FOR_DIVISION_BY_ZERO modes."><col style="width: 50%"><col style="width: 50%"><thead><tr>
          <th><code class="literal">sql_mode</code> 値</th>
          <th>結果</th>
        </tr></thead><tbody><tr>
          <td><code class="literal">''</code> (デフォルト)</td>
          <td>警告なし、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td>
        </tr><tr>
          <td>厳密</td>
          <td>警告なし、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td>
        </tr><tr>
          <td><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></td>
          <td>警告あり、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td>
        </tr><tr>
          <td>厳密、<code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></td>
          <td>エラー状態。行は挿入されません。</td>
        </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-rounding"></a>12.25.4 丸め動作</h3></div></div></div><p>
      このセクションでは、<code class="literal">ROUND()</code> 関数、および厳密値型 (<code class="literal">DECIMAL</code> と整数) を持つカラムへの挿入での高精度計算の丸めについて説明します。
    </p><p>
      <code class="literal">ROUND()</code> 関数は、その引数が厳密値または近似値のどちらであるかに応じて、異なった方法で丸めます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          真値の数値の場合、<code class="literal">ROUND()</code> は<span class="quote">「<span class="quote">四捨五入</span>」</span>ルールを使用します。0.5 以上の小数部を持つ値は、正の場合は次の整数に切り上げられ、負の場合は次の整数に切り下げられます。 (つまり、ゼロから遠い方に丸められます。) 0.5 未満の小数部を持つ値は、正の場合は次の整数に切り下げられ、負の場合は次の整数に切り上げられます。 つまり、ゼロに丸められます。) 
        </p></li><li class="listitem"><p>
          近似値の数字の場合、結果は C ライブラリによって異なります。 多くのシステムでは、これは <code class="literal">ROUND()</code> が<span class="quote">「<span class="quote">「最も近い偶数に丸める」</span>」</span>ルールを使用することを意味: 2 つの整数の間に小数部がある値は、最も近い偶数の整数に丸められます。 
        </p></li></ul></div><p>
      次の例では、正確な値の丸めと近似値の丸めの相違点を示します。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong>
+------------+--------------+
| ROUND(2.5) | ROUND(25E-1) |
+------------+--------------+
| 3          |            2 |
+------------+--------------+
</pre><p>
      <code class="literal">DECIMAL</code> または整数カラムへの挿入では、ターゲットが厳密値データ型であるため、挿入される値が厳密値または近似値のどちらであるかには関係なく、丸めでは<span class="quote">「<span class="quote">四捨五入</span>」</span>が使用されます。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t (d DECIMAL(10,0));</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(2.5),(2.5E0);</code></strong>
Query OK, 2 rows affected, 2 warnings (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 2

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+----------------------------------------+
| Level | Code | Message                                |
+-------+------+----------------------------------------+
| Note  | 1265 | Data truncated for column 'd' at row 1 |
| Note  | 1265 | Data truncated for column 'd' at row 2 |
+-------+------+----------------------------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT d FROM t;</code></strong>
+------+
| d    |
+------+
|    3 |
|    3 |
+------+
2 rows in set (0.00 sec)
</pre><p>
      <code class="literal">SHOW WARNINGS</code> ステートメントは、小数部の丸めによって切り捨てられた場合に生成されるノートを表示します。 このような切捨ては、厳密な SQL モードでもエラーになりません (<a class="xref" href="functions.html#precision-math-expressions" title="12.25.3 式の処理">セクション12.25.3「式の処理」</a> を参照)。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-examples"></a>12.25.5 高精度計算の例</h3></div></div></div><p>
      このセクションでは、MySQL での精度の高い数学的クエリー結果を示す例をいくつか示します。 これらの例は、<a class="xref" href="functions.html#precision-math-expressions" title="12.25.3 式の処理">セクション12.25.3「式の処理」</a>および<a class="xref" href="functions.html#precision-math-rounding" title="12.25.4 丸め動作">セクション12.25.4「丸め動作」</a>で説明されている原則を示しています。 
    </p><p>
      <span class="bold"><strong>例 1</strong></span> 数値は、可能であれば、指定されたとおりにその厳密値で使用されます。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT (.1 + .2) = .3;</code></strong>
+----------------+
| (.1 + .2) = .3 |
+----------------+
|              1 |
+----------------+
</pre><p>
      浮動小数点値の場合、結果は不正確です。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT (.1E0 + .2E0) = .3E0;</code></strong>
+----------------------+
| (.1E0 + .2E0) = .3E0 |
+----------------------+
|                    0 |
+----------------------+
</pre><p>
      厳密値と近似値の処理の違いを確認するための別の方法として、合計値に小さい数値を何回も加える方法があります。 ある変数に <code class="literal">.0001</code> を 1,000 回加える次のストアドプロシージャーを考えてみます。 
    </p><pre class="programlisting">CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 0;
  DECLARE d DECIMAL(10,4) DEFAULT 0;
  DECLARE f FLOAT DEFAULT 0;
  WHILE i &lt; 10000 DO
    SET d = d + .0001;
    SET f = f + .0001E0;
    SET i = i + 1;
  END WHILE;
  SELECT d, f;
END;
</pre><p>
      論理的には、<code class="literal">d</code> と <code class="literal">f</code> の両方の合計値が 1 になるはずですが、それは 10 進数の計算にしか当てはまりません。 浮動小数点の計算では、小さなエラーが発生します。 
    </p><pre class="programlisting">+--------+------------------+
| d      | f                |
+--------+------------------+
| 1.0000 | 0.99999999999991 |
+--------+------------------+
</pre><p>
      <span class="bold"><strong>例 2</strong></span> 乗算は、標準 SQL に必要なスケールで実行されます。 つまり、スケール <em class="replaceable"><code>S1</code></em> と <em class="replaceable"><code>S2</code></em> を持つ 2 つの数値 <em class="replaceable"><code>X1</code></em> と <em class="replaceable"><code>X2</code></em> の場合、結果のスケールは <code class="literal"><em class="replaceable"><code>S1</code></em> + <em class="replaceable"><code>S2</code></em></code> になります。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT .01 * .01;</code></strong>
+-----------+
| .01 * .01 |
+-----------+
| 0.0001    |
+-----------+
</pre><p>
      <span class="bold"><strong>例 3</strong></span> 厳密値数値に対する丸め動作は、適切に定義されています。 
    </p><p>
      丸め動作 (たとえば、<code class="literal">ROUND()</code> 関数を使用した動作) は、ベースとなる C ライブラリの実装には依存しません。つまり、その結果は各プラットフォームにわたって一貫性があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密値カラム (<code class="literal">DECIMAL</code> と整数) および厳密値数値に対する丸めでは、<span class="quote">「<span class="quote">四捨五入</span>」</span>ルールが使用されます。 小数部が .5 以上の値は、次に示すようにゼロから最も近い整数に丸められます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(-2.5);</code></strong>
+------------+-------------+
| ROUND(2.5) | ROUND(-2.5) |
+------------+-------------+
| 3          | -3          |
+------------+-------------+
</pre></li><li class="listitem"><p>
          浮動小数点値に対する丸めでは、C ライブラリが使用されます。これは、多くのシステムでは<span class="quote">「<span class="quote">偶数丸め</span>」</span>ルールを使用します。 2 つの整数の間に小数部が完全に半分の値がある場合、最も近い偶数に丸められます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5E0), ROUND(-2.5E0);</code></strong>
+--------------+---------------+
| ROUND(2.5E0) | ROUND(-2.5E0) |
+--------------+---------------+
|            2 |            -2 |
+--------------+---------------+
</pre></li></ul></div><p>
      <span class="bold"><strong>例 4</strong></span> 厳密モードでは、カラムの範囲を外れている値を挿入すると、正当な値への切り捨てではなく、エラーが発生します。 
    </p><p>
      MySQL が厳密モードで実行されていない場合は、正当な値への切り捨てが発生します。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode='';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong>
Query OK, 1 row affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
+------+
| i    |
+------+
|  127 |
+------+
1 row in set (0.00 sec)
</pre><p>
      ただし、厳密モードが有効になっている場合は、エラーが発生します。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong>
ERROR 1264 (22003): Out of range value adjusted for column 'i' at row 1

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
Empty set (0.00 sec)
</pre><p>
      <span class="bold"><strong>例 5</strong></span>: 厳密モードで <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> が設定されている場合は、0 による除算によって <code class="literal">NULL</code> の結果ではなく、エラーが発生します。
    </p><p>
      非厳密モードでは、0 による除算によって <code class="literal">NULL</code> の結果が生成されます。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode='';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
+------+
| i    |
+------+
| NULL |
+------+
1 row in set (0.03 sec)
</pre><p>
      ただし、適切な SQL モードが有効になっている場合、0 による除算はエラーになります。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong>
ERROR 1365 (22012): Division by 0

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
Empty set (0.01 sec)
</pre><p>
      <span class="bold"><strong>例 6</strong></span> 厳密値リテラルは、厳密値として評価されます。 
    </p><p>
      近似値リテラルは浮動小数点を使用して評価されますが、正確な値リテラルは <code class="literal">DECIMAL</code> として処理されます:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t SELECT 2.5 AS a, 25E-1 AS b;</code></strong>
Query OK, 1 row affected (0.01 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>DESCRIBE t;</code></strong>
+-------+-----------------------+------+-----+---------+-------+
| Field | Type                  | Null | Key | Default | Extra |
+-------+-----------------------+------+-----+---------+-------+
| a     | decimal(2,1) unsigned | NO   |     | 0.0     |       |
| b     | double                | NO   |     | 0       |       |
+-------+-----------------------+------+-----+---------+-------+
2 rows in set (0.01 sec)
</pre><p>
      <span class="bold"><strong>例 7</strong></span> 集約関数への引数が厳密値数値型である場合は、その結果も、少なくとも引数と同じスケールを持つ厳密値数値型になります。 
    </p><p>
      これらのステートメントを考慮してください。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i INT, d DECIMAL, f FLOAT);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1,1,1);</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE y SELECT AVG(i), AVG(d), AVG(f) FROM t;</code></strong>
</pre><p>
      結果が倍精度値になるのは浮動小数点引数の場合だけです。 厳密値型引数の場合は、結果も厳密値型になります。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>DESCRIBE y;</code></strong>
+--------+---------------+------+-----+---------+-------+
| Field  | Type          | Null | Key | Default | Extra |
+--------+---------------+------+-----+---------+-------+
| AVG(i) | decimal(14,4) | YES  |     | NULL    |       |
| AVG(d) | decimal(14,4) | YES  |     | NULL    |       |
| AVG(f) | double        | YES  |     | NULL    |       |
+--------+---------------+------+-----+---------+-------+
</pre><p>
      結果が倍精度値になるのは浮動小数点引数の場合だけです。 厳密値型引数の場合は、結果も厳密値型になります。 
    </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="data-types.html">前</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="sql-statements.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第 11 章 データ型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第 13 章 SQL ステートメント</td></tr></table></div><div class="copyright-footer"></div></body></html>
