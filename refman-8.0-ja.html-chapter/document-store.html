<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第 20 章 ドキュメントストアとしての MySQL の使用</title><link rel="stylesheet" type="text/css" href="mvl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="up" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="prev" href="mysql-shell-userguide.html" title="第 19 章 MySQL Shell"><link rel="next" href="mysql-innodb-cluster-introduction.html" title="第 21 章 InnoDB クラスタ"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 20 章 ドキュメントストアとしての MySQL の使用</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mysql-shell-userguide.html">前</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="mysql-innodb-cluster-introduction.html">次へ</a></td></tr></table><hr></div><div class="status-header"><p class="alert">このページは機械翻訳したものです。</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="document-store"></a>第 20 章 ドキュメントストアとしての MySQL の使用</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="document-store.html#document-store-interfaces">20.1 MySQL ドキュメントストアへのインタフェース</a></span></dt><dt><span class="section"><a href="document-store.html#document-store-concepts">20.2 ドキュメントストアの概念</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript">20.3 JavaScript クイックスタートガイド: ドキュメントストア用の MySQL Shell</a></span></dt><dd><dl><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-shell">20.3.1 MySQL Shell</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-download">20.3.2 world_x データベースのダウンロードおよびインポート</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-collections">20.3.3 ドキュメントとコレクション</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-relational-tables">20.3.4 リレーショナルテーブル</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-in-tables">20.3.5 テーブル内のドキュメント</a></span></dt></dl></dd><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python">20.4 Python クイックスタートガイド: ドキュメントストア用の MySQL Shell</a></span></dt><dd><dl><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-shell">20.4.1 MySQL Shell</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-download">20.4.2 world_x データベースのダウンロードおよびインポート</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-collections">20.4.3 ドキュメントとコレクション</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-relational-tables">20.4.4 リレーショナルテーブル</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-in-tables">20.4.5 テーブル内のドキュメント</a></span></dt></dl></dd><dt><span class="section"><a href="document-store.html#x-plugin">20.5 X プラグイン</a></span></dt><dd><dl><dt><span class="section"><a href="document-store.html#x-plugin-checking-installation">20.5.1 X プラグイン のインストールの確認</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-disabling">20.5.2 X プラグイン の無効化</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-encrypted-connections">20.5.3 X プラグイン での暗号化接続の使用</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-sha2-cache-plugin">20.5.4 Caching SHA-2 認証プラグインでの X プラグイン の使用</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-connection-compression">20.5.5 X プラグイン での接続圧縮</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-options-variables">20.5.6 X プラグイン のオプションおよび変数</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-system-monitoring">20.5.7 X プラグイン の監視</a></span></dt></dl></dd></dl></div><a class="indexterm" name="idm45563243557216"></a><a class="indexterm" name="idm45563243555760"></a><a class="indexterm" name="idm45563243553696"></a><p>
    この章では、MySQL をドキュメントストア (<span class="quote">「<span class="quote">「NoSQL の使用」</span>」</span>とも呼ばれる) として使用する別の方法について説明します。 従来の (SQL) 方法で MySQL を使用する場合、この章はおそらく関連がありません。 
  </p><p>
    従来、MySQL などのリレーショナルデータベースでは、通常、ドキュメントを格納する前にスキーマを定義する必要がありました。 このセクションで説明する機能を使用すると、MySQL をドキュメントストアとして使用できます。ドキュメントストアはスキーマレスであるため、ドキュメントのスキーマ対応の記憶域システムです。 たとえば、製品を説明するドキュメントを作成する場合、ドキュメントを格納して操作する前に、製品の使用可能なすべての属性を把握して定義する必要はありません。 これは、製品をデータベースに追加する前にテーブルのすべてのカラムを認識して定義する必要がある場合に、リレーショナルデータベースでの作業およびテーブルへの製品の格納とは異なります。 この章で説明する機能を使用すると、MySQL の構成方法、ドキュメントストアモデルのみを使用する方法、またはドキュメントストアモデルの柔軟性とリレーショナルモデルの機能を組み合せる方法を選択できます。 
  </p><p>
    MySQL をドキュメントストアとして使用するには、次のサーバー機能を使用します:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        X プラグイン を使用すると、MySQL Server は、MySQL をドキュメントストアとして使用するための前提条件である X プロトコル を使用してクライアントと通信できます。X プラグイン は、MySQL 8.0 の時点で MySQL Server でデフォルトで有効になっています。 X プラグインのインストールを検証し、X プラグインを構成およびモニターする手順については、<a class="xref" href="document-store.html#x-plugin" title="20.5 X プラグイン">セクション20.5「X プラグイン」</a> を参照してください。 
      </p></li><li class="listitem"><p>
        X プロトコル では、SASL を介した認証である CRUD 操作と SQL 操作の両方がサポートされており、コマンドのストリーミング (パイプライン) が可能であり、プロトコルおよびメッセージレイヤーで拡張可能です。 X プロトコル と互換性のあるクライアントには、MySQL Shell および MySQL 8.0 コネクタが含まれます。 
      </p></li><li class="listitem"><p>
        X プロトコル を使用して MySQL Server と通信するクライアントは、X DevAPI を使用してアプリケーションを開発できます。X DevAPI は、確立された業界標準概念をサポートするシンプルで強力な設計を備えた最新のプログラミングインタフェースを提供します。 この章では、MySQL Shell で X DevAPI の JavaScript または Python 実装をクライアントとして使用する方法について説明します。 X DevAPI の使用に関する詳細なチュートリアルは、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/" target="_top">X DevAPI User Guide</a> を参照してください。 
      </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="document-store-interfaces"></a>20.1 MySQL ドキュメントストアへのインタフェース</h2></div></div></div><p>
      MySQL をドキュメントストアとして使用するには、専用コンポーネントと、MySQL サーバーとの通信をサポートするクライアントの選択肢を使用して、ドキュメントベースのアプリケーションを開発します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          次の MySQL 製品は X プロトコル をサポートしており、選択した言語で X DevAPI を使用して、ドキュメントストアとして機能する MySQL Server と通信するアプリケーションを開発できます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              MySQL Shell (JavaScript および Python での X DevAPI の実装を提供)
            </p></li><li class="listitem"><p>
              Connector/C++
            </p></li><li class="listitem"><p>
              Connector/J
            </p></li><li class="listitem"><p>
              Connector/Node.js
            </p></li><li class="listitem"><p>
              Connector/NET
            </p></li><li class="listitem"><p>
              Connector/Python
            </p></li></ul></div></li><li class="listitem"><p>
          MySQL Shell は、JavaScript、Python または SQL モードをサポートする MySQL への対話型インタフェースです。 MySQL Shell を使用して、アプリケーションのプロトタイプ作成、クエリーの実行およびデータの更新を行うことができます。<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-install.html" target="_top">MySQL Shell のインストール</a> には、MySQL Shell をダウンロードしてインストールする手順があります。 
        </p></li><li class="listitem"><p>
          この章のクイックスタートガイド (チュートリアル) は、MySQL をドキュメントストアとして MySQL Shell の使用を開始するのに役立ちます。
        </p><p>
          JavaScript のクイックスタートガイドはここにあります: <a class="xref" href="document-store.html#mysql-shell-tutorial-javascript" title="20.3 JavaScript クイックスタートガイド: ドキュメントストア用の MySQL Shell">セクション20.3「JavaScript クイックスタートガイド: ドキュメントストア用の MySQL Shell」</a>。
        </p><p>
          Python のクイックスタートガイドはここにあります: <a class="xref" href="document-store.html#mysql-shell-tutorial-python" title="20.4 Python クイックスタートガイド: ドキュメントストア用の MySQL Shell">セクション20.4「Python クイックスタートガイド: ドキュメントストア用の MySQL Shell」</a>。
        </p></li><li class="listitem"><p>
          MySQL Shell の構成および使用の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/" target="_top">MySQL Shell 8.0</a> の<em class="citetitle">「MySQL Shell ユーザーガイド」</em>を参照してください。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="document-store-concepts"></a>20.2 ドキュメントストアの概念</h2></div></div></div><p>
      このセクションでは、MySQL をドキュメントストアとして使用する際に導入される概念について説明します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="document-store.html#document-store-concepts-json-document" title="JSON ドキュメント">JSON ドキュメント</a></p></li><li class="listitem"><p><a class="xref" href="document-store.html#document-store-concepts-collection" title="コレクション">コレクション</a></p></li><li class="listitem"><p><a class="xref" href="document-store.html#document-store-concepts-crud-operation" title="CRUD 操作">CRUD 操作</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="document-store-concepts-json-document"></a>JSON ドキュメント</h3></div></div></div><p>
        JSON ドキュメントは、キーと値のペアで構成されるデータ構造であり、MySQL をドキュメントストアとして使用するための基本的な構造です。 たとえば、world_x スキーマ (この章の後半でインストール) には次のドキュメントが含まれています: 
      </p><pre class="programlisting">{
    "GNP": .6,
    "IndepYear": 1967,
    "Name": "Sealand",
    "_id": "SEA",
    "demographics": {
        "LifeExpectancy": 79,
        "Population": 27
    },
    "geography": {
        "Continent": "Europe",
        "Region": "British Islands",
        "SurfaceArea": 193
    },
    "government": {
        "GovernmentForm": "Monarchy",
        "HeadOfState": "Michael Bates"
    }
}
</pre><p>
        このドキュメントでは、キーの値は整数や文字列などの単純なデータ型にできますが、他のドキュメント、配列およびドキュメントのリストを含めることもできます。 たとえば、<code class="literal">geography</code> キー値は複数のキーと値のペアで構成されます。 JSON ドキュメントは、<code class="literal">JSON</code> MySQL データ型を介して、MySQL バイナリ JSON オブジェクトを使用して内部的に表されます。 
      </p><p>
        ドキュメントと従来のリレーショナルデータベースから認識されるテーブルの最も重要な違いは、ドキュメントの構造を事前に定義する必要がなく、コレクションに異なる構造を持つ複数のドキュメントを含めることができることです。 一方、リレーショナルテーブルでは構造を定義する必要があり、テーブルのすべての行に同じカラムが含まれている必要があります。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="document-store-concepts-collection"></a>コレクション</h3></div></div></div><p>
        コレクションは、JSON ドキュメントを MySQL データベースに格納するために使用されるコンテナです。 アプリケーションは通常、特定のドキュメントを検索するなど、ドキュメントのコレクションに対して操作を実行します。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="document-store-concepts-crud-operation"></a>CRUD 操作</h3></div></div></div><p>
        コレクションに対して発行できる 4 つの基本操作は、作成、読取り、更新および削除 (CRUD) です。 MySQL の場合、これは次のことを意味します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            新規ドキュメントの作成 (挿入または追加)
          </p></li><li class="listitem"><p>
            1 つまたは複数のドキュメントを読む (クエリー)
          </p></li><li class="listitem"><p>
            1 つまたは複数のドキュメントの更新
          </p></li><li class="listitem"><p>
            1 つまたは複数のドキュメントを削除
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-shell-tutorial-javascript"></a>20.3 JavaScript クイックスタートガイド: ドキュメントストア用の MySQL Shell</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-shell">20.3.1 MySQL Shell</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-download">20.3.2 world_x データベースのダウンロードおよびインポート</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-collections">20.3.3 ドキュメントとコレクション</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-relational-tables">20.3.4 リレーショナルテーブル</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-in-tables">20.3.5 テーブル内のドキュメント</a></span></dt></dl></div><a class="indexterm" name="idm45563243500160"></a><p>
    このクイックスタートガイドでは、MySQL Shell と対話形式でドキュメントストアアプリケーションのプロトタイプ作成を開始する手順について説明します。 このガイドの内容は次のとおりです: 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        MySQL 機能、MySQL Shell および <code class="literal">world_x</code> サンプルスキーマの概要。
      </p></li><li class="listitem"><p>
        コレクションおよびドキュメントを管理する操作。
      </p></li><li class="listitem"><p>
        リレーショナルテーブルを管理する操作。
      </p></li><li class="listitem"><p>
        テーブル内のドキュメントに適用される操作。
      </p></li></ul></div><p>
    このクイックスタートガイドに従うには、X プラグイン がインストールされた MySQL サーバー、8.0 のデフォルト、および MySQL Shell をクライアントとして使用する必要があります。<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/" target="_top">MySQL Shell 8.0</a> は、MySQL Shell に関する詳細情報を提供します。 ドキュメントストアには X DevAPI を使用してアクセスし、MySQL Shell は JavaScript と Python の両方でこの API を提供します。 
  </p><h3><a name="idm45563243490944"></a>関連情報</h3><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/" target="_top">MySQL Shell 8.0</a> は、MySQL Shell に関する詳細情報を提供します。
      </p></li><li class="listitem"><p>
        このクイックスタートガイドで使用されるツールの詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-install.html" target="_top">MySQL Shell のインストール</a> および <a class="xref" href="document-store.html#x-plugin" title="20.5 X プラグイン">セクション20.5「X プラグイン」</a> を参照してください。
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/" target="_top">X DevAPI User Guide</a> には、X DevAPI を使用してドキュメントストアを使用するアプリケーションを開発するその他の例が用意されています。
      </p></li><li class="listitem"><p>
        <a class="link" href="document-store.html#mysql-shell-tutorial-python" title="20.4 Python クイックスタートガイド: ドキュメントストア用の MySQL Shell">Python</a> クイックスタートガイドも使用できます。
      </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-javascript-shell"></a>20.3.1 MySQL Shell</h3></div></div></div><a class="indexterm" name="idm45563243481056"></a><p>
      このクイックスタートガイドでは、MySQL Shell について一定レベルの知識があることを前提としています。 次のセクションは概要です。詳細は、MySQL Shell のドキュメントを参照してください。MySQL Shell は、MySQL Server への統一されたスクリプトインタフェースです。 JavaScript および Python でのスクリプトがサポートされています。 JavaScript はデフォルトの処理モードです。 
    </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-shell-start"></a>MySQL Shell の起動</h4></div></div></div><p>
        MySQL サーバーをインストールして起動したら、MySQL Shell をサーバーインスタンスに接続します。 接続する予定の MySQL サーバーインスタンスのアドレスを知っている必要があります。 インスタンスをドキュメントストアとして使用できるようにするには、サーバーインスタンスに X プラグイン がインストールされている必要があり、X プロトコル を使用してサーバーに接続する必要があります。 たとえば、33060 のデフォルトの X プロトコル ポートでインスタンス <code class="literal">ds1.example.com</code> に接続するには、ネットワーク文字列 <code class="literal"><em class="replaceable"><code>user</code></em>@ds1.example.com:33060</code> を使用します。 
      </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
          <code class="literal">mysqlx_port</code> のかわりに 3306 のデフォルトの <code class="literal">port</code> を使用するなどして、クラシック MySQL プロトコル を使用してインスタンスに接続する場合、このチュートリアルに示すドキュメントストア機能は使用できません。 たとえば、<code class="literal">db</code> グローバルオブジェクトは移入されません。 ドキュメントストアを使用するには、常に X プロトコル を使用して接続します。 
        </p></div><p>
        MySQL Shell がまだ実行されていない場合は、ターミナルウィンドウを開き、次のコマンドを発行します:
      </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh <em class="replaceable"><code>user</code></em>@ds1.example.com:33060/world_x</code></strong>
</pre><p>
        または、MySQL Shell がすでに実行されている場合は、次のコマンドを発行して<code class="literal">\connect</code> コマンドを使用します:
      </p><pre class="programlisting"><strong class="userinput"><code>\connect <em class="replaceable"><code>user</code></em>@ds1.example.com:33060/world_x</code></strong>
</pre><p>
        MySQL Shell を接続する MySQL サーバーインスタンスのアドレスを指定する必要があります。 たとえば、前の例では次のようになります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>user</code></em> は、MySQL アカウントのユーザー名を表します。
          </p></li><li class="listitem"><p>
            <code class="literal">ds1.example.com</code> は、MySQL を実行しているサーバーインスタンスのホスト名です。 これを、ドキュメントストアとして使用している MySQL サーバーインスタンスのホスト名に置き換えます。 
          </p></li><li class="listitem"><p>
            このセッションのデフォルトスキーマは <code class="literal">world_x</code> です。 <code class="literal">world_x</code> スキーマの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-javascript-download" title="20.3.2 world_x データベースのダウンロードおよびインポート">セクション20.3.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。 
          </p></li></ul></div><p>
        詳細は、<a class="xref" href="programs.html#connecting-using-uri-or-key-value-pairs" title="4.2.5 URI 類似文字列またはキーと値のペアを使用したサーバーへの接続">セクション4.2.5「URI 類似文字列またはキーと値のペアを使用したサーバーへの接続」</a>を参照してください。
      </p><p>
        MySQL Shell が開くと、<code class="literal">mysql-js&gt;</code>プロンプトに、このセッションのアクティブな言語が JavaScript であることが示されます。
      </p><pre class="programlisting">mysql-js&gt;
</pre><p>
        MySQL Shell は、次のような入力行編集をサポートしています:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="keycap"><strong>left-arrow</strong></span> および <span class="keycap"><strong>right-arrow</strong></span> キーは、現在の入力行内で水平に移動します。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>up-arrow</strong></span> および <span class="keycap"><strong>down-arrow</strong></span> のキーは、以前に入力した一連の行を上下に移動します。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>「バックスペース」</strong></span>でカーソルの前の文字を削除でき、新しい文字を入力するとカーソルの位置に挿入されます。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>Enter</strong></span> は、現在の入力行をサーバーに送信します。
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-shell-help"></a>MySQL Shell のヘルプの表示</h4></div></div></div><a class="indexterm" name="idm45563243441296"></a><p>
        コマンドラインオプションのリストを表示するには、コマンドインタプリタのプロンプトで <span class="command"><strong>mysqlsh --help</strong></span> と入力します。
      </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh --help</code></strong>
</pre><p>
        使用可能なコマンドとその説明のリストを表示するには、MySQL Shell プロンプトで<code class="literal">\help</code> と入力します。
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\help</code></strong>
</pre><p>
        個々の MySQL Shell コマンドの詳細なヘルプを表示するには、<code class="literal">\help</code> に続けてコマンド名を入力します。 たとえば、<code class="literal">\connect</code> コマンドのヘルプを表示するには、次のコマンドを発行します: 
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\help \connect</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-shell-quit"></a>MySQL Shell の終了</h4></div></div></div><a class="indexterm" name="idm45563243428048"></a><p>
        MySQL Shell を終了するには、次のコマンドを発行します:
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\quit</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563243423872"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL Shell での対話型コード実行の動作については、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-interactive-code-execution.html" target="_top">対話型コードの実行</a> を参照してください。
          </p></li><li class="listitem"><p>
            セッションおよび接続の代替方法の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-getting-started.html" target="_top">MySQL Shell スタートガイド</a> を参照してください。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-javascript-download"></a>20.3.2 world_x データベースのダウンロードおよびインポート</h3></div></div></div><p>
      このクイックスタートガイドの一部として、<code class="literal">world_x</code> スキーマと呼ばれるサンプルスキーマが用意されています。 これらの例の多くは、このスキーマを使用するドキュメントストア機能を示しています。 <code class="literal">world_x</code> スキーマをロードできるように MySQL サーバーを起動し、次のステップに従います: 
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          <a class="ulink" href="http://downloads.mysql.com/docs/world_x-db.zip" target="_top">world_x-db.zip</a> のダウンロード。
        </p></li><li class="listitem"><p>
          <code class="filename">/tmp/</code>などの一時的な場所にインストールアーカイブを抽出します。 アーカイブを解凍すると、<code class="filename">world_x.sql</code> という名前の単一ファイルが作成されます。 
        </p></li><li class="listitem"><p>
          <code class="filename">world_x.sql</code> ファイルをサーバーにインポートします。 次のいずれかを実行できます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL Shell を SQL モードで起動し、次のコマンドを発行してファイルをインポートします:
            </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh -u root --sql --file /tmp/world_x-db/world_x.sql</code></strong>
Enter password: <strong class="userinput"><code>****</code></strong>
</pre></li><li class="listitem"><p>
              実行中に MySQL Shell を SQL モードに設定し、次のコマンドを発行してスキーマファイルをソーシングします:
            </p><pre class="programlisting"><strong class="userinput"><code>\sql</code></strong>
Switching to SQL mode... Commands end with ;
<strong class="userinput"><code>\source /tmp/world_x-db/world_x.sql</code></strong>
</pre></li></ul></div><p>
          <code class="filename">/tmp/</code>をシステム上の <code class="filename">world_x.sql</code> ファイルへのパスに置き換えます。 プロンプトが表示されたら、パスワードを入力します。 root 以外のアカウントは、そのアカウントが新しいスキーマを作成する権限を持っているかぎり使用できます。 
        </p></li></ol></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563243398912"></a>world_x スキーマ</h4></div></div></div><a class="indexterm" name="idm45563243398208"></a><p>
        <code class="literal">world_x</code> サンプルスキーマには、次の JSON コレクションおよびリレーショナルテーブルが含まれています:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            コレクション
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">countryinfo</code>: 世界中の国に関する情報。
              </p></li></ul></div></li><li class="listitem"><p>
            テーブル
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">country</code>: 世界の国に関する最小限の情報。
              </p></li><li class="listitem"><p>
                <code class="literal">city</code>: これらの国の一部の都市に関する情報。
              </p></li><li class="listitem"><p>
                <code class="literal">countrylanguage</code>: 各国で話されている言語。
              </p></li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563243385568"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-sessions.html" target="_top">MySQL Shell セッション</a> では、セッションタイプについて説明します。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-javascript-documents-collections"></a>20.3.3 ドキュメントとコレクション</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-collections-operations">20.3.3.1 コレクションの作成、リストおよびドロップ</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-collections-add">20.3.3.2 コレクションの操作</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-find">20.3.3.3 ドキュメントの検索</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-modify">20.3.3.4 ドキュメントの変更</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-documents-remove">20.3.3.5 ドキュメントの削除</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-indexes-create">20.3.3.6 インデックスの作成および削除</a></span></dt></dl></div><a class="indexterm" name="idm45563243381264"></a><p>
      MySQL をドキュメントストアとして使用している場合、コレクションは、作成、リストおよびドロップできるスキーマ内のコンテナです。 コレクションには、追加、検索、更新および削除できる JSON ドキュメントが含まれます。 
    </p><p>
      このセクションの例では、<code class="literal">world_x</code> スキーマの <code class="literal">countryinfo</code> コレクションを使用します。 <code class="literal">world_x</code> スキーマの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-javascript-download" title="20.3.2 world_x データベースのダウンロードおよびインポート">セクション20.3.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。 
    </p><h4><a name="mysql-shell-tutorial-javascript-documents"></a>Documents</h4><p>
      MySQL では、ドキュメントは JSON オブジェクトとして表されます。 内部的には、高速ルックアップおよび更新を可能にする効率的なバイナリ形式で格納されます。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          JavaScript の単純なドキュメント形式:
        </p><pre class="screen">{field1: "value", field2 : 10, "field 3": null}
</pre></li></ul></div><p>
      ドキュメントの配列は、カンマで区切られた一連のドキュメントで構成され、<code class="literal">[</code>および<code class="literal">]</code>文字で囲まれます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          JavaScript のドキュメントの単純な配列:
        </p><pre class="screen">[{"Name": "Aruba", "Code:": "ABW"}, {"Name": "Angola", "Code:": "AGO"}]
</pre></li></ul></div><p>
      MySQL は、JSON ドキュメントで次の JavaScript 値タイプをサポートしています:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数値 (整数および浮動小数点)
        </p></li><li class="listitem"><p>
          文字列
        </p></li><li class="listitem"><p>
          boolean (False および True)
        </p></li><li class="listitem"><p>
          null
        </p></li><li class="listitem"><p>
          JSON 値の配列
        </p></li><li class="listitem"><p>
          より多くの JSON 値のネストされた (埋込み) オブジェクト
        </p></li></ul></div><h4><a name="mysql-shell-tutorial-javascript-collections"></a>コレクション</h4><p>
      コレクションは、目的を共有し、場合によっては 1 つ以上のインデックスを共有するドキュメントのコンテナです。 各コレクションは一意の名前を持ち、単一のスキーマ内に存在します。 
    </p><p>
      スキーマという用語はデータベースと同等です。つまり、リレーショナルスキーマとは対照的に、データベースオブジェクトのグループであり、データの構造と制約を施行するために使用されます。 スキーマは、コレクション内のドキュメントへの準拠を強制しません。 
    </p><p>
      このクイックスタートガイドの内容は次のとおりです:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          基本オブジェクトには次のものがあります:
        </p><div class="informaltable"><table summary="Objects to use interactively in MySQL Shell"><col style="width: 40%"><col style="width: 60%"><thead><tr>
              <th>オブジェクトフォーム</th>
              <th>説明</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">db</code></td>
              <td><code class="literal">db</code> は、現在アクティブなスキーマに割り当てられたグローバル変数です。 コレクションの取得など、スキーマに対して操作を実行する場合は、<code class="literal">db</code> 変数に使用可能なメソッドを使用します。 </td>
            </tr><tr>
              <td><code class="literal">db.getCollections()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-collections-get" title="コレクションのリスト">db.getCollections()</a> は、スキーマ内のコレクションのリストを返します。 このリストを使用して、コレクションオブジェクトへの参照の取得、コレクションオブジェクトの反復などを行います。 </td>
            </tr></tbody></table></div></li><li class="listitem"><p>
          コレクションによってスコープ指定される基本的な操作は次のとおりです:
        </p><div class="informaltable"><table summary="CRUD operations available in X DevAPI"><col style="width: 40%"><col style="width: 60%"><thead><tr>
              <th>操作フォーム</th>
              <th>説明</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.add()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-collections-add" title="20.3.3.2 コレクションの操作">add()</a> メソッドは、ドキュメントまたはドキュメントのリストを名前付きコレクションに挿入します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.find()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-documents-find" title="20.3.3.3 ドキュメントの検索">find()</a> メソッドは、名前付きコレクション内の一部またはすべてのドキュメントを返します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.modify()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-documents-modify" title="20.3.3.4 ドキュメントの変更">modify()</a> メソッドは、名前付きコレクション内のドキュメントを更新します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.remove()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-documents-remove" title="20.3.3.5 ドキュメントの削除">remove()</a> メソッドは、名前付きコレクションからドキュメントまたはドキュメントのリストを削除します。</td>
            </tr></tbody></table></div></li></ul></div><h4><a name="idm45563243318976"></a>関連情報</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          一般的な概要は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-collections.html" target="_top">Working with Collections</a> を参照してください。
        </p></li><li class="listitem"><p>
          <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/mysql-x-crud-ebnf-definitions.html" target="_top">CRUD EBNF Definitions</a> では、操作の完全なリストが提供されます。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-collections-operations"></a>20.3.3.1 コレクションの作成、リストおよびドロップ</h4></div></div></div><a class="indexterm" name="idm45563243313392"></a><p>
        MySQL Shell では、新しいコレクションを作成し、スキーマ内の既存のコレクションのリストを取得し、スキーマから既存のコレクションを削除できます。 コレクション名は大/小文字が区別され、各コレクション名は一意である必要があります。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243310384"></a>スキーマの確認</h5></div></div></div><a class="indexterm" name="idm45563243309712"></a><p>
          スキーマ変数に割り当てられている値を表示するには、次のコマンドを発行します:
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db</code></strong>
</pre><p>
          スキーマ値が <code class="literal">Schema:world_x</code> でない場合は、次のコマンドを発行して <code class="literal">db</code> 変数を設定します:
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\use world_x</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-collections-create"></a>コレクションの作成</h5></div></div></div><a class="indexterm" name="idm45563243300544"></a><p>
          既存のスキーマに新しいコレクションを作成するには、<code class="literal">db</code> オブジェクトの <code class="literal">createCollection()</code> メソッドを使用します。 次の例では、<code class="literal">world_x</code> スキーマに <code class="literal">flags</code> というコレクションを作成します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.createCollection("flags")</code></strong>
</pre><p>
          このメソッドはコレクションオブジェクトを返します。
        </p><pre class="screen">&lt;Collection:flags&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-collections-get"></a>コレクションのリスト</h5></div></div></div><a class="indexterm" name="idm45563243290688"></a><p>
          <code class="literal">world_x</code> スキーマ内のすべてのコレクションを表示するには、<code class="literal">db</code> オブジェクトの <code class="literal">getCollections()</code> メソッドを使用します。 現在接続しているサーバーによって返されるコレクションは、大カッコ内に表示されます。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.getCollections()</code></strong>
[
    &lt;Collection:countryinfo&gt;,
    &lt;Collection:flags&gt;
]
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-collections-drop"></a>コレクションのドロップ</h5></div></div></div><a class="indexterm" name="idm45563243282672"></a><p>
          スキーマから既存のコレクションを削除するには、<code class="literal">db</code> オブジェクトの <code class="literal">dropCollection()</code> メソッドを使用します。 たとえば、現行のスキーマから <code class="literal">flags</code> コレクションを削除するには、次のコマンドを発行します: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.dropCollection("flags")</code></strong>
</pre><p>
          <code class="literal">dropCollection()</code> メソッドは、スキーマからリレーショナルテーブルを削除するために MySQL Shell でも使用されます。

        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243274624"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              その他の例については、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-objects.html" target="_top">Collection Objects</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-collections-add"></a>20.3.3.2 コレクションの操作</h4></div></div></div><a class="indexterm" name="idm45563243270336"></a><p>
        スキーマ内のコレクションを操作するには、<code class="literal">db</code> グローバルオブジェクトを使用して現在のスキーマにアクセスします。 この例では、以前にインポートした <code class="literal">world_x</code> スキーマと <code class="literal">countryinfo</code> コレクションを使用しています。 したがって、発行する操作の形式は <code class="literal">db.<em class="replaceable"><code>collection_name</code></em>.operation</code> で、<em class="replaceable"><code>collection_name</code></em> は操作の実行対象となるコレクションの名前です。 次の例では、操作は <code class="literal">countryinfo</code> コレクションに対して実行されます。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243262752"></a>ドキュメントの追加</h5></div></div></div><p>
          <code class="literal">add()</code> メソッドを使用して、あるドキュメントまたはドキュメントのリストを既存のコレクションに挿入します。 次のドキュメントを <code class="literal">countryinfo</code> コレクションに挿入します。 これは複数行コンテンツであるため、<span class="keycap"><strong>Enter</strong></span> を 2 回押してドキュメントを挿入します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.add(
 {
    GNP: .6,
    IndepYear: 1967,
    Name: "Sealand",
    Code: "SEA",
    demographics: {
        LifeExpectancy: 79,
        Population: 27
    },
    geography: {
        Continent: "Europe",
        Region: "British Islands",
        SurfaceArea: 193
    },
    government: {
        GovernmentForm: "Monarchy",
        HeadOfState: "Michael Bates"
    }
  }
)</code></strong>
</pre><p>
          このメソッドは、操作のステータスを返します。 ドキュメントを検索して操作を確認できます。 例: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Sealand'")</code></strong>
{
    "GNP": 0.6,
    "_id": "00005e2ff4af00000000000000f4",
    "Name": "Sealand",
    "Code:": "SEA",
    "IndepYear": 1967,
    "geography": {
        "Region": "British Islands",
        "Continent": "Europe",
        "SurfaceArea": 193
    },
    "government": {
        "HeadOfState": "Michael Bates",
        "GovernmentForm": "Monarchy"
    },
    "demographics": {
        "Population": 27,
        "LifeExpectancy": 79
    }
}
</pre><p>
          ドキュメントの追加時に指定されたフィールドに加えて、<code class="literal">_id</code> というフィールドもあります。 各ドキュメントには、<code class="literal">_id</code> と呼ばれる識別子フィールドが必要です。 <code class="literal">_id</code> フィールドの値は、同じコレクション内のすべてのドキュメント間で一意である必要があります。 MySQL 8.0.11 以上では、ドキュメント ID はクライアントではなくサーバーによって生成されるため、MySQL Shell は<code class="literal">_id</code> 値を自動的に設定しません。 8.0.11 以上の MySQL サーバーでは、ドキュメントに<code class="literal">_id</code> フィールドが含まれていない場合、<code class="literal">_id</code> 値が設定されます。 以前の 8.0 リリースまたは 5.7 の MySQL サーバーは、この状況では<code class="literal">_id</code> 値を設定しないため、明示的に指定する必要があります。 そうでない場合、MySQL Shell はエラー 5115 <span class="errortext">「文書に必須フィールドがありません」</span>を返します。 詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/understanding-automatic-document-ids.html" target="_top">Understanding Document IDs</a> を参照してください。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243245584"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionaddfunction" target="_top">CollectionAddFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/understanding-automatic-document-ids.html" target="_top">Understanding Document IDs</a>を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-documents-find"></a>20.3.3.3 ドキュメントの検索</h4></div></div></div><a class="indexterm" name="idm45563243239616"></a><p>
        <code class="literal">find()</code> メソッドを使用して、スキーマ内のコレクションに対してクエリーを実行し、ドキュメントを戻すことができます。MySQL Shell には、返されたドキュメントをフィルタおよびソートするために <code class="literal">find()</code> メソッドとともに使用する追加のメソッドが用意されています。
      </p><p>
        MySQL には、検索条件を指定する次の演算子が用意されています: <code class="literal">OR</code> (<code class="literal">||</code>)、<code class="literal">AND</code> (<code class="literal">&amp;&amp;</code>)、<code class="literal">XOR</code>, <code class="literal">IS</code>, <code class="literal">NOT</code>, <code class="literal">BETWEEN</code>, <code class="literal">IN</code>, <code class="literal">LIKE</code>, <code class="literal">!=</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&amp;</code>, <code class="literal">|</code>, <code class="literal">&lt;&lt;</code>, <code class="literal">&gt;&gt;</code>, <code class="literal">+</code>, <code class="literal">-</code>, <code class="literal">*</code>, <code class="literal">/</code>, <code class="literal">~</code> および <code class="literal">%</code>。
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-documents-find-all"></a>コレクション内のすべてのドキュメントの検索</h5></div></div></div><a class="indexterm" name="idm45563243215808"></a><p>
          コレクション内のすべてのドキュメントを返すには、検索条件を指定せずに <code class="literal">find()</code> メソッドを使用します。 たとえば、次の操作では、<code class="literal">countryinfo</code> コレクション内のすべてのドキュメントが返されます。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find()</code></strong>
[
     {
          "GNP": 828,
          "Code:": "ABW",
          "Name": "Aruba",
          "IndepYear": null,
          "geography": {
              "Continent": "North America",
              "Region": "Caribbean",
              "SurfaceArea": 193
          },
          "government": {
              "GovernmentForm": "Nonmetropolitan Territory of The Netherlands",
              "HeadOfState": "Beatrix"
          }
          "demographics": {
              "LifeExpectancy": 78.4000015258789,
              "Population": 103000
          },
          ...
      }
 ]
240 documents in set (0.00 sec)
</pre><p>
          このメソッドは、コレクション内のすべてのドキュメントに加えて、操作情報を含む結果を生成します。
        </p><p>
          空のセット (一致するドキュメントがない) は、次の情報を返します:
        </p><pre class="screen">Empty set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-documents-find-filter-searches"></a>フィルタ検索</h5></div></div></div><a class="indexterm" name="idm45563243206448"></a><p>
          <code class="literal">find()</code> メソッドに検索条件を含めることができます。 検索条件を形成する式の構文は、従来の MySQL <a class="xref" href="functions.html" title="第 12 章 関数と演算子">第12章「<i>関数と演算子</i>」</a> の構文と同じです。 すべての式は引用符で囲む必要があります。 簡潔にするために、一部の例では出力が表示されません。 
        </p><p>
          単純検索条件は、<code class="literal">Name</code> フィールドとドキュメント内にあることがわかっている値で構成できます。 次の例では、単一のドキュメントを戻します: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Australia'")</code></strong>
[
    {
        "GNP": 351182,
        "Code:": "AUS",
        "Name": "Australia",
        "IndepYear": 1901,
        "geography": {
            "Continent": "Oceania",
            "Region": "Australia and New Zealand",
            "SurfaceArea": 7741220
        },
        "government": {
            "GovernmentForm": "Constitutional Monarchy, Federation",
            "HeadOfState": "Elisabeth II"
        }
        "demographics": {
            "LifeExpectancy": 79.80000305175781,
            "Population": 18886000
        },
    }
]
</pre><p>
          次の例では、GNP が 00 億を超えるすべての国を検索します。 <code class="literal">countryinfo</code> コレクションは GNP を百万単位で測定します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 500000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
10 documents in set (0.00 sec)
</pre><p>
          次のクエリーの「人口」フィールドは、人口統計オブジェクト内に埋め込まれます。 埋込みフィールドにアクセスするには、人口統計と人口間のピリオドを使用して関係を識別します。 ドキュメント名とフィールド名では大文字と小文字が区別されます。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 500000 and demographics.Population &lt; 100000000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
6 documents in set (0.00 sec)
</pre><p>
          次の式の算術演算子は、大文字当たりの GNP が 0000 を超える国をクエリーするために使用されます。 検索条件には、算術演算子およびほとんどの MySQL 関数を含めることができます。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">countryinfo</code> コレクション内の 7 つのドキュメントの母集団値はゼロです。 したがって、出力の最後に警告メッセージが表示されます。 
          </p></div><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("GNP*1000000/demographics.Population &gt; 30000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
9 documents in set, 7 warnings (0.00 sec)
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
</pre><p>
          <code class="literal">bind()</code> メソッドを使用して、値を検索条件から区切ることができます。 たとえば、ハードコードされた国名を条件として指定するかわりに、コロンで構成される名前付きプレースホルダの後に、<span class="emphasis"><em>country</em></span> などの文字で始まる名前を付けます。 次に、<code class="literal">bind(<em class="replaceable"><code>placeholder</code></em>, <em class="replaceable"><code>value</code></em>)</code> メソッドを次のように使用します: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("Name = :country").bind("country", "Italy")</code></strong>
{
    "GNP": 1161755,
    "_id": "00005de917d8000000000000006a",
    "Code": "ITA",
    "Name": "Italy",
    "Airports": [],
    "IndepYear": 1861,
    "geography": {
        "Region": "Southern Europe",
        "Continent": "Europe",
        "SurfaceArea": 301316
    },
    "government": {
        "HeadOfState": "Carlo Azeglio Ciampi",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 57680000,
        "LifeExpectancy": 79
    }
}
1 document in set (0.01 sec)
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
            プログラム内でバインディングを使用すると、式にプレースホルダを指定できます。プレースホルダには、実行前に値が入力され、必要に応じて自動エスケープを利用できます。
          </p><p>
            入力をサニタイズするには、常にバインディングを使用します。 文字列連結を使用してクエリーに値を導入しないでください。無効な入力が生成され、場合によってはセキュリティの問題が発生することがあります。 
          </p></div><p>
          プレースホルダおよび <code class="literal">bind()</code> メソッドを使用して保存済検索を作成し、別の値でコールできます。 たとえば、国の保存済検索を作成するには、次のようにします: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>var myFind = db.countryinfo.find("Name = :country")</code></strong>
mysql-js&gt; <strong class="userinput"><code>myFind.bind('country', 'France')</code></strong>
{
    "GNP": 1424285,
    "_id": "00005de917d80000000000000048",
    "Code": "FRA",
    "Name": "France",
    "IndepYear": 843,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 551500
    },
    "government": {
        "HeadOfState": "Jacques Chirac",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 59225700,
        "LifeExpectancy": 78.80000305175781
    }
}
1 document in set (0.0028 sec)

mysql-js&gt; <strong class="userinput"><code>myFind.bind('country', 'Germany')</code></strong>
{
    "GNP": 2133367,
    "_id": "00005de917d80000000000000038",
    "Code": "DEU",
    "Name": "Germany",
    "IndepYear": 1955,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 357022
    },
    "government": {
        "HeadOfState": "Johannes Rau",
        "GovernmentForm": "Federal Republic"
    },
    "demographics": {
        "Population": 82164700,
        "LifeExpectancy": 77.4000015258789
    }
}

1 document in set (0.0026 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243171536"></a>プロジェクト結果</h5></div></div></div><a class="indexterm" name="idm45563243170848"></a><p>
          すべてのフィールドを返すかわりに、ドキュメントの特定のフィールドを返すことができます。 次の例では、検索条件に一致する <code class="literal">countryinfo</code> コレクション内のすべてのドキュメントの GNP および Name フィールドを返します。 
        </p><p>
          <code class="literal">fields()</code> メソッドを使用して、返すフィールドのリストを渡します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 5000000").fields(["GNP", "Name"])</code></strong>
[
    {
        "GNP": 8510700,
        "Name": "United States"
    }
]
1 document in set (0.00 sec)
 </pre><p>
          また、返されるドキュメントを記述する式を使用して、返されるドキュメント (追加、名前変更、ネストおよび新しいフィールド値の計算) を変更できます。 たとえば、次の式を使用してフィールドの名前を変更すると、2 つのドキュメントのみが返されます。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find().fields(
mysqlx.expr('{"Name": upper(Name), "GNPPerCapita": GNP*1000000/demographics.Population}')).limit(2)</code></strong>
{
    "Name": "ARUBA",
    "GNPPerCapita": 8038.834951456311
}
{
    "Name": "AFGHANISTAN",
    "GNPPerCapita": 263.0281690140845
}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243160976"></a>結果の制限、ソートおよびスキップ</h5></div></div></div><a class="indexterm" name="idm45563243160272"></a><p>
          <code class="literal">limit()</code>、<code class="literal">sort()</code> および <code class="literal">skip()</code> メソッドを適用して、<code class="literal">find()</code> メソッドによって返されるドキュメントの数と順序を管理できます。
        </p><p>
          結果セットに含めるドキュメントの数を指定するには、<code class="literal">limit()</code> メソッドの値を <code class="literal">find()</code> メソッドに追加します。 次のクエリーは、<code class="literal">countryinfo</code> コレクション内の最初の 5 つのドキュメントを返します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find().limit(5)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
5 documents in set (0.00 sec)
</pre><p>
          結果の順序を指定するには、<code class="literal">sort()</code> メソッドを <code class="literal">find()</code> メソッドに追加します。 必要に応じて、降順 (<code class="literal">desc</code>) または昇順 (<code class="literal">asc</code>) 属性でソートするフィールドのリストを <code class="literal">sort()</code> メソッドに渡します。 昇順がデフォルトのオーダータイプです。 
        </p><p>
          たとえば、次のクエリーでは、すべてのドキュメントが IndepYear フィールドでソートされ、最初の 8 つのドキュメントが降順で返されます。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find().sort(["IndepYear desc"]).limit(8)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre><p>
          デフォルトでは、<code class="literal">limit()</code> メソッドはコレクション内の最初のドキュメントから始まります。 <code class="literal">skip()</code> メソッドを使用して、開始ドキュメントを変更できます。 たとえば、最初のドキュメントを無視し、条件に一致する次の 8 つのドキュメントを返すには、<code class="literal">skip()</code> メソッドに値 1 を渡します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find().sort(["IndepYear desc"]).limit(8).skip(1)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243136496"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="functions.html" title="第 12 章 関数と演算子">MySQL Reference Manual</a> には、関数および演算子に関する詳細なドキュメントが用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionfindfunction" target="_top">CollectionFindFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-documents-modify"></a>20.3.3.4 ドキュメントの変更</h4></div></div></div><a class="indexterm" name="idm45563243130384"></a><p>
        <code class="literal">modify()</code> メソッドを使用して、コレクション内の 1 つ以上のドキュメントを更新できます。 X DevAPI には、<code class="literal">modify()</code> メソッドとともに使用して次の操作を行うための追加メソッドが用意されています: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ドキュメント内のフィールドを設定および設定解除します。
          </p></li><li class="listitem"><p>
            配列を追加、挿入および削除します。
          </p></li><li class="listitem"><p>
            変更するドキュメントをバインド、制限およびソートします。
          </p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243122928"></a>ドキュメントフィールドの設定および設定解除</h5></div></div></div><a class="indexterm" name="idm45563243122208"></a><p>
          <code class="literal">modify()</code> メソッドは、コレクションをフィルタ処理して変更するドキュメントのみを含め、指定した操作をそれらのドキュメントに適用することで機能します。
        </p><p>
          次の例では、<code class="literal">modify()</code> メソッドは検索条件を使用して変更するドキュメントを識別し、ネストされたデモグラフィックオブジェクト内の 2 つの値を <code class="literal">set()</code> メソッドで置き換えます。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("Code = 'SEA'").set(
"demographics", {"LifeExpectancy": 78, "Population": 28})</code></strong>
</pre><p>
          ドキュメントを変更した後、<code class="literal">find()</code> メソッドを使用して変更を確認します。
        </p><p>
          ドキュメントからコンテンツを削除するには、<code class="literal">modify()</code> および <code class="literal">unset()</code> メソッドを使用します。 たとえば、次のクエリーは、検索条件に一致するドキュメントから GNP を削除します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'Sealand'").unset("GNP")</code></strong>
</pre><p>
          <code class="literal">find()</code> メソッドを使用して変更を確認します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Sealand'")</code></strong>
{
    "_id": "00005e2ff4af00000000000000f4",
    "Name": "Sealand",
    "Code:": "SEA",
    "IndepYear": 1967,
    "geography": {
        "Region": "British Islands",
        "Continent": "Europe",
        "SurfaceArea": 193
    },
    "government": {
        "HeadOfState": "Michael Bates",
        "GovernmentForm": "Monarchy"
    },
    "demographics": {
        "Population": 27,
        "LifeExpectancy": 79
    }
}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-append-insert-delete"></a>配列の追加、挿入および削除</h5></div></div></div><a class="indexterm" name="idm45563243104656"></a><p>
          配列フィールドに要素を追加したり、配列内の要素を挿入または削除するには、<code class="literal">arrayAppend()</code>、<code class="literal">arrayInsert()</code> または <code class="literal">arrayDelete()</code> メソッドを使用します。 次の例では、国際空港のトラッキングを有効にするように <code class="literal">countryinfo</code> コレクションを変更します。 
        </p><p>
          最初の例では、<code class="literal">modify()</code> および <code class="literal">set()</code> メソッドを使用して、すべてのドキュメントに新しい空港フィールドを作成します。
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにドキュメントを変更する場合は注意してください。変更すると、コレクション内のすべてのドキュメントが変更されます。
          </p></div><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("true").set("Airports", [])</code></strong>
</pre><p>
          空港フィールドが追加された状態で、次の例では、<code class="literal">arrayAppend()</code> メソッドを使用して新しい空港をいずれかのドキュメントに追加します。次の例の <span class="emphasis"><em>$.Airports</em></span> は、現在のドキュメントの空港フィールドを表しています。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").arrayAppend("$.Airports", "ORY")</code></strong>
</pre><p>
          <code class="literal">find()</code> を使用して変更を確認します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'France'")</code></strong>
{
    "GNP": 1424285,
    "_id": "00005de917d80000000000000048",
    "Code": "FRA",
    "Name": "France",
    "Airports": [
        "ORY"
    ],
    "IndepYear": 843,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 551500
    },
    "government": {
        "HeadOfState": "Jacques Chirac",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 59225700,
        "LifeExpectancy": 78.80000305175781
    }
}
</pre><p>
          配列内の別の位置に要素を挿入するには、<code class="literal">arrayInsert()</code> メソッドを使用して、パス式に挿入するインデックスを指定します。 この場合、インデックスは 0、または配列の最初の要素です。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").arrayInsert("$.Airports[0]", "CDG")</code></strong>
</pre><p>
          配列から要素を削除するには、削除する要素のインデックスを <code class="literal">arrayDelete()</code> メソッドに渡す必要があります。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").arrayDelete("$.Airports[1]")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243079712"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="data-types.html#json-paths" title="JSON 値の検索および変更">MySQL Reference Manual</a> には、JSON 値の検索および変更に役立つ手順が用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionmodifyfunction" target="_top">CollectionModifyFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-documents-remove"></a>20.3.3.5 ドキュメントの削除</h4></div></div></div><a class="indexterm" name="idm45563243073552"></a><p>
        <code class="literal">remove()</code> メソッドを使用して、スキーマ内のコレクションから一部またはすべてのドキュメントを削除できます。 X DevAPI には、<code class="literal">remove()</code> メソッドとともに使用して、削除するドキュメントをフィルタおよびソートするための追加メソッドが用意されています。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-remove-documents-by-condition"></a>条件を使用したドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563243067872"></a><p>
          次の例では、検索条件を <code class="literal">remove()</code> メソッドに渡します。 条件に一致するすべてのドキュメントが <code class="literal">countryinfo</code> コレクションから削除されます。 この例では、1 つのドキュメントが条件に一致します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.remove("Code = 'SEA'")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-remove-first-document"></a>最初のドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563243060560"></a><p>
          <code class="literal">countryinfo</code> コレクションの最初のドキュメントを削除するには、値 1 を指定して <code class="literal">limit()</code> メソッドを使用します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.remove("true").limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-remove-last-document"></a>オーダー内の最後の文書の削除</h5></div></div></div><a class="indexterm" name="idm45563243053584"></a><p>
          次の例では、国名で <code class="literal">countryinfo</code> コレクションの最後のドキュメントを削除します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.remove("true").sort(["Name desc"]).limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-remove-all-documents"></a>コレクション内のすべてのドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563243047152"></a><p>
          コレクション内のすべてのドキュメントを削除できます。 これを行うには、検索条件を指定せずに <code class="literal">remove("true")</code> メソッドを使用します。 
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにドキュメントを削除する場合は注意してください。 このアクションは、コレクションからすべてのドキュメントを削除します。 
          </p></div><p>
          または、<code class="literal">db.drop_collection('countryinfo')</code> 操作を使用して <code class="literal">countryinfo</code> コレクションを削除します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563243040416"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionremovefunction" target="_top">CollectionRemoveFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">world_x</code> スキーマを再作成する手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-javascript-download" title="20.3.2 world_x データベースのダウンロードおよびインポート">セクション20.3.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-indexes-create"></a>20.3.3.6 インデックスの作成および削除</h4></div></div></div><a class="indexterm" name="idm45563243033680"></a><p>
        インデックスは、特定のフィールド値を持つドキュメントをすばやく検索するために使用されます。 インデックスがない場合、MySQL は最初のドキュメントで始まり、コレクション全体を読み取って関連するフィールドを検索する必要があります。 コレクションが大きいほど、このコストは高くなります。 コレクションが大きく、特定のフィールドに対するクエリーが一般的な場合は、ドキュメント内の特定のフィールドに対するインデックスの作成を検討してください。 
      </p><p>
        たとえば、移入フィールドのインデックスを使用すると、次のクエリーのパフォーマンスが向上します:
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.find("demographics.Population &lt; 100")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre><p>
        <code class="literal">createIndex()</code> メソッドは、使用するフィールドを指定する JSON ドキュメントで定義できるインデックスを作成します。 このセクションでは、インデックス付けの概要について説明します。 詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html" target="_top">Indexing Collections</a> を参照してください。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-nonunique-index"></a>一意でないインデックスの追加</h5></div></div></div><a class="indexterm" name="idm45563243023392"></a><p>
          一意でないインデックスを作成するには、インデックス名とインデックス情報を <code class="literal">createIndex()</code> メソッドに渡します。 重複するインデックス名は禁止されています。 
        </p><p>
          次の例では、<code class="literal">demographics</code> オブジェクトの <code class="literal">Population</code> フィールドに対して定義され、<code class="literal">Integer</code> 数値としてインデックス付けされた <code class="literal">popul</code> という名前のインデックスを指定します。 最後のパラメータは、フィールドに <code class="literal">NOT NULL</code> 制約が必要かどうかを示します。 値が <code class="literal">false</code> の場合、フィールドには <code class="literal">NULL</code> 値を含めることができます。 インデックス情報は、インデックスに含める 1 つ以上のフィールドの詳細を含む JSON ドキュメントです。 各フィールド定義には、フィールドへの完全なドキュメントパスを含め、フィールドのタイプを指定する必要があります。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.createIndex("popul", {fields:
[{field: '$.demographics.Population', type: 'INTEGER'}]})</code></strong>
</pre><p>
          ここでは、整数の数値を使用してインデックスが作成されます。 GeoJSON データで使用するオプションなど、さらにオプションを使用できます。 デフォルトタイプの <span class="quote">「<span class="quote">index</span>」</span> が適切であるため、ここでは省略されているインデックスのタイプを指定することもできます。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-unique-index"></a>一意インデックスの追加</h5></div></div></div><a class="indexterm" name="idm45563243008560"></a><p>
          一意のインデックスを作成するには、インデックス名、インデックス定義およびインデックスタイプ <span class="quote">「<span class="quote">unique</span>」</span> を <code class="literal">createIndex()</code> メソッドに渡します。 この例は、国名 (<code class="literal">"Name"</code>) に対して作成された一意のインデックスを示しています。これは、インデックス付けする <code class="literal">countryinfo</code> コレクションの別の共通フィールドです。 インデックスフィールドの説明で、<code class="literal">"TEXT(40)"</code>はインデックス付けする文字数を表し、<code class="literal">"required": True</code> はフィールドがドキュメントに存在する必要があることを指定します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.createIndex("name",
{"fields": [{"field": "$.Name", "type": "TEXT(40)", "required": true}], "unique": true})</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-drop-index"></a>インデックスの削除</h5></div></div></div><a class="indexterm" name="idm45563242998048"></a><p>
          インデックスを削除するには、削除するインデックスの名前を <code class="literal">dropIndex()</code> メソッドに渡します。 たとえば、次のように <span class="quote">「<span class="quote">popul</span>」</span> インデックスを削除できます: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.countryinfo.dropIndex("popul")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242992448"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html" target="_top">Indexing Collections</a>をご覧ください。
            </p></li><li class="listitem"><p>
              インデックスを定義する JSON ドキュメントの詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html#collection-index-definitions" target="_top">Defining an Index</a> を参照してください。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-index-management-functions.html" target="_top">Collection Index Management Functions</a> を参照してください。
            </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-javascript-relational-tables"></a>20.3.4 リレーショナルテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-table-insert">20.3.4.1 テーブルへのレコードの挿入</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-table-select">20.3.4.2 テーブルの選択</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-table-update">20.3.4.3 テーブルの更新</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-javascript-table-delete">20.3.4.4 テーブルの削除</a></span></dt></dl></div><a class="indexterm" name="idm45563242984464"></a><p>
      X DevAPI を使用してリレーショナルテーブルを操作することもできます。 MySQL では、各リレーショナルテーブルは特定のストレージエンジンに関連付けられます。 このセクションの例では、<code class="literal">world_x</code> スキーマの <code class="literal">InnoDB</code> テーブルを使用します。 
    </p><h4><a name="idm45563242979808"></a>スキーマの確認</h4><p>
      <code class="literal">db</code> グローバル変数に割り当てられているスキーマを表示するには、<code class="literal">db</code> を発行します。
    </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db</code></strong>
&lt;Schema:world_x&gt;
</pre><p>
      戻り値が <code class="literal">Schema:world_x</code> でない場合は、<code class="literal">db</code> 変数を次のように設定します:
    </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\use world_x</code></strong>
Schema `world_x` accessible through db.
</pre><h4><a name="idm45563242971824"></a>すべてのテーブルの表示</h4><p>
      <code class="literal">world_x</code> スキーマ内のすべてのリレーショナルテーブルを表示するには、<code class="literal">db</code> オブジェクトで <code class="literal">getTables()</code> メソッドを使用します。
    </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.getTables()</code></strong>
{
    "city": &lt;Table:city&gt;,
    "country": &lt;Table:country&gt;,
    "countrylanguage": &lt;Table:countrylanguage&gt;
}
</pre><h4><a name="idm45563242966432"></a>基本的なテーブル操作</h4><p>
      テーブルによってスコープ指定される基本的な操作は次のとおりです:
    </p><div class="informaltable"><table summary="CRUD operations to use interactively on tables within MySQL Shell"><col style="width: 32%"><col style="width: 68%"><thead><tr>
          <th>操作フォーム</th>
          <th>説明</th>
        </tr></thead><tbody><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.insert()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-table-insert" title="20.3.4.1 テーブルへのレコードの挿入">insert()</a> メソッドは、名前付きのテーブルに 1 つ以上のレコードを挿入します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.select()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-table-select" title="20.3.4.2 テーブルの選択">select()</a> メソッドは、指定されたテーブルの一部またはすべてのレコードを返します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.update()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-table-update" title="20.3.4.3 テーブルの更新">update()</a> メソッドは、指定されたテーブルのレコードを更新します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.delete()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-javascript-table-delete" title="20.3.4.4 テーブルの削除">delete()</a> メソッドは、名前付きのテーブルから 1 つ以上のレコードを削除します。</td>
        </tr></tbody></table></div><h4><a name="idm45563242943536"></a>関連情報</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-relational-tables.html" target="_top">Working with Relational Tables</a>をご覧ください。
        </p></li><li class="listitem"><p>
          <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/mysql-x-crud-ebnf-definitions.html" target="_top">CRUD EBNF Definitions</a> では、操作の完全なリストが提供されます。
        </p></li><li class="listitem"><p>
          <code class="literal">world_x</code> スキーマサンプルの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-javascript-download" title="20.3.2 world_x データベースのダウンロードおよびインポート">セクション20.3.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-table-insert"></a>20.3.4.1 テーブルへのレコードの挿入</h4></div></div></div><a class="indexterm" name="idm45563242935680"></a><p>
        <code class="literal">insert()</code> メソッドを <code class="literal">values()</code> メソッドとともに使用して、既存のリレーショナルテーブルにレコードを挿入できます。 <code class="literal">insert()</code> メソッドは、個々のカラムまたはテーブル内のすべてのカラムを受け入れます。 1 つ以上の <code class="literal">values()</code> メソッドを使用して、挿入する値を指定します。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-insert-complete-record"></a>完全なレコードの挿入</h5></div></div></div><a class="indexterm" name="idm45563242928720"></a><p>
          完全なレコードを挿入するには、テーブルのすべてのカラムを <code class="literal">insert()</code> メソッドに渡します。 次に、<code class="literal">values()</code> メソッドに、テーブルの各カラムの値を渡します。 たとえば、<code class="literal">world_x</code> スキーマの市区町村テーブルに新しいレコードを追加するには、次のレコードを挿入して <span class="keycap"><strong>Enter</strong></span> を 2 回押します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.insert("ID", "Name", "CountryCode", "District", "Info").values(
None, "Olympia", "USA", "Washington", '{"Population": 5000}')</code></strong>
</pre><p>
          city テーブルには 5 つのカラムがあります: ID、名前、CountryCode、地区および情報。 各値は、それが表すカラムのデータ型と一致する必要があります。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-insert-partial-record"></a>部分レコードの挿入</h5></div></div></div><a class="indexterm" name="idm45563242918848"></a><p>
          次の例では、city テーブルの ID、Name および CountryCode カラムに値を挿入します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.insert("ID", "Name", "CountryCode").values(
None, "Little Falls", "USA").values(None, "Happy Valley", "USA")</code></strong>
</pre><p>
          <code class="literal">insert()</code> メソッドを使用してカラムを指定する場合、値の数はカラムの数と一致する必要があります。 前の例では、指定した 3 つのカラムに一致するように 3 つの値を指定する必要があります。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242912832"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableinsertfunction" target="_top">TableInsertFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-table-select"></a>20.3.4.2 テーブルの選択</h4></div></div></div><a class="indexterm" name="idm45563242908512"></a><p>
        <code class="literal">select()</code> メソッドを使用して、データベース内のテーブルに対してクエリーを実行し、レコードを戻すことができます。 X DevAPI には、返されたレコードをフィルタおよびソートするために <code class="literal">select()</code> メソッドとともに使用する追加のメソッドが用意されています。 
      </p><p>
        MySQL には、検索条件を指定する次の演算子が用意されています: <code class="literal">OR</code> (<code class="literal">||</code>)、<code class="literal">AND</code> (<code class="literal">&amp;&amp;</code>)、<code class="literal">XOR</code>, <code class="literal">IS</code>, <code class="literal">NOT</code>, <code class="literal">BETWEEN</code>, <code class="literal">IN</code>, <code class="literal">LIKE</code>, <code class="literal">!=</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&amp;</code>, <code class="literal">|</code>, <code class="literal">&lt;&lt;</code>, <code class="literal">&gt;&gt;</code>, <code class="literal">+</code>, <code class="literal">-</code>, <code class="literal">*</code>, <code class="literal">/</code>, <code class="literal">~</code> および <code class="literal">%</code>。
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-select-all-records"></a>すべてのレコードの選択</h5></div></div></div><a class="indexterm" name="idm45563242884784"></a><p>
          既存のテーブルからすべてのレコードを返すクエリーを発行するには、検索条件を指定せずに <code class="literal">select()</code> メソッドを使用します。 次の例では、<code class="literal">world_x</code> データベースの city テーブルからすべてのレコードを選択します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            空の <code class="literal">select()</code> メソッドの使用を対話型のステートメントに制限します。 アプリケーションコードでは、常に明示的なカラム名の選択を使用します。 
          </p></div><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select()</code></strong>
+------+------------+-------------+------------+-------------------------+
| ID   | Name       | CountryCode | District   | Info                    |
+------+------------+-------------+------------+-------------------------+
|    1 | Kabul      | AFG         | Kabol      |{"Population": 1780000}  |
|    2 | Qandahar   | AFG         | Qandahar   |{"Population": 237500}   |
|    3 | Herat      | AFG         | Herat      |{"Population": 186800}   |
...    ...          ...           ...          ...
| 4079 | Rafah      | PSE         | Rafah      |{"Population": 92020}    |
+------+------- ----+-------------+------------+-------------------------+
4082 rows in set (0.01 sec)
</pre><p>
          空のセット (一致するレコードなし) は、次の情報を返します:
        </p><pre class="screen">Empty set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-filter-searches"></a>フィルタ検索</h5></div></div></div><a class="indexterm" name="idm45563242873600"></a><p>
          一連のテーブルのカラムを戻すクエリーを発行するには、<code class="literal">select()</code> メソッドを使用して、角カッコで囲むカラムを指定します。 このクエリーは、city テーブルから Name カラムと CountryCode カラムを返します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"])</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Kabul             | AFG         |
| Qandahar          | AFG         |
| Herat             | AFG         |
| Mazar-e-Sharif    | AFG         |
| Amsterdam         | NLD         |
...                 ...
| Rafah             | PSE         |
| Olympia           | USA         |
| Little Falls      | USA         |
| Happy Valley      | USA         |
+-------------------+-------------+
4082 rows in set (0.00 sec)
</pre><p>
          特定の検索条件に一致する行を返すクエリーを発行するには、<code class="literal">where()</code> メソッドを使用してそれらの条件を含めます。 たとえば、次の例では、文字 Z で始まる都市の名前と国コードを返します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where("Name like 'Z%'")</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Zaanstad          | NLD         |
| Zoetermeer        | NLD         |
| Zwolle            | NLD         |
| Zenica            | BIH         |
| Zagazig           | EGY         |
| Zaragoza          | ESP         |
| Zamboanga         | PHL         |
| Zahedan           | IRN         |
| Zanjan            | IRN         |
| Zabol             | IRN         |
| Zama              | JPN         |
| Zhezqazghan       | KAZ         |
| Zhengzhou         | CHN         |
...                 ...
| Zeleznogorsk      | RUS         |
+-------------------+-------------+
59 rows in set (0.00 sec)
</pre><p>
          <code class="literal">bind()</code> メソッドを使用して、値を検索条件から区切ることができます。 たとえば、条件として「Name =」Z%「」を使用するかわりに、コロンで構成される名前付きプレースホルダの後に、<span class="emphasis"><em>name</em></span> などの文字で始まる名前を付けます。 次に、次のようにプレースホルダと値を <code class="literal">bind()</code> メソッドに含めます: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).
              where("Name like :name").bind("name", "Z%")</code></strong>
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
            プログラム内でバインディングを使用すると、式にプレースホルダを指定できます。プレースホルダには、実行前に値が入力され、必要に応じて自動エスケープを利用できます。
          </p><p>
            入力をサニタイズするには、常にバインディングを使用します。 文字列連結を使用してクエリーに値を導入しないでください。無効な入力が生成され、場合によってはセキュリティの問題が発生することがあります。 
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-project-results"></a>プロジェクト結果</h5></div></div></div><a class="indexterm" name="idm45563242856032"></a><p>
          <code class="literal">AND</code> 演算子を使用してクエリーを発行するには、<code class="literal">where()</code> メソッドの検索条件の間に演算子を追加します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where(
"Name like 'Z%' and CountryCode = 'CHN'")</code></strong>
+----------------+-------------+
| Name           | CountryCode |
+----------------+-------------+
| Zhengzhou      | CHN         |
| Zibo           | CHN         |
| Zhangjiakou    | CHN         |
| Zhuzhou        | CHN         |
| Zhangjiang     | CHN         |
| Zigong         | CHN         |
| Zaozhuang      | CHN         |
...              ...
| Zhangjiagang   | CHN         |
+----------------+-------------+
22 rows in set (0.01 sec)
</pre><p>
          複数の条件演算子を指定するには、検索条件をカッコで囲んで演算子の優先順位を変更します。 次の例は、<code class="literal">AND</code> および <code class="literal">OR</code> 演算子の配置を示しています。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).
where("Name like 'Z%' and (CountryCode = 'CHN' or CountryCode = 'RUS')")</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Zhengzhou         | CHN         |
| Zibo              | CHN         |
| Zhangjiakou       | CHN         |
| Zhuzhou           | CHN         |
...                 ...
| Zeleznogorsk      | RUS         |
+-------------------+-------------+
29 rows in set (0.01 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-limit-order-offset-results"></a>制限、順序およびオフセットの結果</h5></div></div></div><a class="indexterm" name="idm45563242843408"></a><p>
          <code class="literal">limit()</code>、<code class="literal">orderBy()</code> および <code class="literal">offSet()</code> メソッドを適用して、<code class="literal">select()</code> メソッドによって返されるレコードの数と順序を管理できます。
        </p><p>
          結果セットに含まれるレコード数を指定するには、<code class="literal">limit()</code> メソッドに <code class="literal">select()</code> メソッドの値を追加します。 たとえば、次のクエリーでは、国テーブルの最初の 5 つのレコードが返されます。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).limit(5)</code></strong>
+------+-------------+
| Code | Name        |
+------+-------------+
| ABW  | Aruba       |
| AFG  | Afghanistan |
| AGO  | Angola      |
| AIA  | Anguilla    |
| ALB  | Albania     |
+------+-------------+
5 rows in set (0.00 sec)
</pre><p>
          結果の順序を指定するには、<code class="literal">orderBy()</code> メソッドを <code class="literal">select()</code> メソッドに追加します。 必要に応じて、降順 (<code class="literal">desc</code>) または昇順 (<code class="literal">asc</code>) 属性でソートするカラムのリストを <code class="literal">orderBy()</code> メソッドに渡します。 昇順がデフォルトのオーダータイプです。 
        </p><p>
          たとえば、次のクエリーでは、すべてのレコードが名前カラムでソートされ、最初の 3 つのレコードが降順で返されます。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).orderBy(["Name desc"]).limit(3)</code></strong>
+------+------------+
| Code | Name       |
+------+------------+
| ZWE  | Zimbabwe   |
| ZMB  | Zambia     |
| YUG  | Yugoslavia |
+------+------------+
3 rows in set (0.00 sec)
</pre><p>
          デフォルトでは、<code class="literal">limit()</code> メソッドはテーブルの最初のレコードから開始されます。 <code class="literal">offset()</code> メソッドを使用して、開始レコードを変更できます。 たとえば、最初のレコードを無視し、条件に一致する次の 3 つのレコードを返すには、<code class="literal">offset()</code> メソッドに値 1 を渡します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).orderBy(["Name desc"]).limit(3).offset(1)</code></strong>
+------+------------+
| Code | Name       |
+------+------------+
| ZMB  | Zambia     |
| YUG  | Yugoslavia |
| YEM  | Yemen      |
+------+------------+
3 rows in set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242821424"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="functions.html" title="第 12 章 関数と演算子">MySQL Reference Manual</a> には、関数および演算子に関する詳細なドキュメントが用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableselectfunction" target="_top">TableSelectFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-table-update"></a>20.3.4.3 テーブルの更新</h4></div></div></div><a class="indexterm" name="idm45563242815280"></a><p>
        <code class="literal">update()</code> メソッドを使用して、テーブル内のレコードを変更できます。 <code class="literal">update()</code> メソッドは、更新するレコードのみを含めるようにクエリーをフィルタリングし、指定した操作をそれらのレコードに適用することで機能します。 
      </p><p>
        市区町村テーブルの市区町村名を置換するには、<code class="literal">set()</code> メソッドに新しい市区町村名を渡します。 次に、検索および置換する市区町村名を <code class="literal">where()</code> メソッドに渡します。 次の例では、Peking 市を Beijing に置き換えます。 
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.update().set("Name", "Beijing").where("Name = 'Peking'")</code></strong>
</pre><p>
        <code class="literal">select()</code> メソッドを使用して変更を確認します。
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["ID", "Name", "CountryCode", "District", "Info"]).where("Name = 'Beijing'")</code></strong>
+------+-----------+-------------+----------+-----------------------------+
| ID   | Name      | CountryCode | District | Info                        |
+------+-----------+-------------+----------+-----------------------------+
| 1891 | Beijing   | CHN         | Peking   | {"Population": 7472000}     |
+------+-----------+-------------+----------+-----------------------------+
1 row in set (0.00 sec)
</pre><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242803600"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableupdatefunction" target="_top">TableUpdateFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-table-delete"></a>20.3.4.4 テーブルの削除</h4></div></div></div><p>
        <code class="literal">delete()</code> メソッドを使用して、データベース内のテーブルから一部またはすべてのレコードを削除できます。 X DevAPI には、削除するレコードをフィルタおよび順序付けするために <code class="literal">delete()</code> メソッドとともに使用する追加のメソッドが用意されています。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-delete-records-using-conditions"></a>条件を使用したレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242795536"></a><p>
          次の例では、検索条件を <code class="literal">delete()</code> メソッドに渡します。 条件に一致するすべてのレコードが市区町村テーブルから削除されます。 この例では、1 つのレコードが条件に一致します。 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.delete().where("Name = 'Olympia'")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-delete-first-record"></a>最初のレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242788928"></a><p>
          市区町村テーブルの最初のレコードを削除するには、値が 1 の <code class="literal">limit()</code> メソッドを使用します。
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.delete().limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-javascript-delete-all-records"></a>テーブル内のすべてのレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242782640"></a><p>
          テーブル内のすべてのレコードを削除できます。 これを行うには、検索条件を指定せずに <code class="literal">delete()</code> メソッドを使用します。 
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにレコードを削除する場合は注意が必要です。削除すると、テーブルからすべてのレコードが削除されます。
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242777936"></a>テーブルの削除</h5></div></div></div><a class="indexterm" name="idm45563242777264"></a><p>
          <code class="literal">dropCollection()</code> メソッドは、データベースからリレーショナルテーブルを削除するために MySQL Shell でも使用されます。 たとえば、<code class="literal">world_x</code> データベースから <code class="literal">citytest</code> テーブルを削除するには、次のように発行します: 
        </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>session.dropCollection("world_x", "citytest")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242770544"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tabledeletefunction" target="_top">TableDeleteFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">world_x</code> データベースを再作成する手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-javascript-download" title="20.3.2 world_x データベースのダウンロードおよびインポート">セクション20.3.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
            </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-javascript-documents-in-tables"></a>20.3.5 テーブル内のドキュメント</h3></div></div></div><a class="indexterm" name="idm45563242763648"></a><p>
      MySQL では、テーブルに従来のリレーショナルデータまたは JSON 値 (あるいはその両方) が含まれる場合があります。 ネイティブ <code class="literal">JSON</code> データ型を持つカラムにドキュメントを格納することで、従来のデータを JSON ドキュメントと組み合せることができます。 
    </p><p>
      このセクションの例では、<code class="literal">world_x</code> スキーマの city テーブルを使用します。
    </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563242758400"></a>市区町村テーブル摘要</h4></div></div></div><p>
        city テーブルには、5 つのカラム (またはフィールド) があります。
      </p><pre class="screen">+---------------+------------+-------+-------+---------+------------------+
| Field         | Type       | Null  | Key   | Default | Extra            |
+---------------+------------+-------+-------+---------+------------------+
| ID            | int(11)    | NO    | PRI   | null    | auto_increment   |
| Name          | char(35)   | NO    |       |         |                  |
| CountryCode   | char(3)    | NO    |       |         |                  |
| District      | char(20)   | NO    |       |         |                  |
| Info          | json       | YES   |       | null    |                  |
+---------------+------------+-------+-------+---------+------------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-insert-record"></a>レコードの挿入</h4></div></div></div><a class="indexterm" name="idm45563242754336"></a><p>
        テーブルのカラムにドキュメントを挿入するには、正しい順序で整形式の JSON ドキュメントを <code class="literal">values()</code> メソッドに渡します。 次の例では、情報カラムに挿入される最終値としてドキュメントが渡されます。 
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.insert().values(
None, "San Francisco", "USA", "California", '{"Population":830000}')</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-javascript-select-record"></a>レコードの選択</h4></div></div></div><a class="indexterm" name="idm45563242747680"></a><p>
        式のドキュメント値を評価する検索条件を指定してクエリーを発行できます。
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>db.city.select(["ID", "Name", "CountryCode", "District", "Info"]).where(
"CountryCode = :country and Info-&gt;'$.Population' &gt; 1000000").bind(
'country', 'USA')</code></strong>
+------+----------------+-------------+----------------+-----------------------------+
| ID   | Name           | CountryCode | District       | Info                        |
+------+----------------+-------------+----------------+-----------------------------+
| 3793 | New York       | USA         | New York       | {"Population": 8008278}     |
| 3794 | Los Angeles    | USA         | California     | {"Population": 3694820}     |
| 3795 | Chicago        | USA         | Illinois       | {"Population": 2896016}     |
| 3796 | Houston        | USA         | Texas          | {"Population": 1953631}     |
| 3797 | Philadelphia   | USA         | Pennsylvania   | {"Population": 1517550}     |
| 3798 | Phoenix        | USA         | Arizona        | {"Population": 1321045}     |
| 3799 | San Diego      | USA         | California     | {"Population": 1223400}     |
| 3800 | Dallas         | USA         | Texas          | {"Population": 1188580}     |
| 3801 | San Antonio    | USA         | Texas          | {"Population": 1144646}     |
+------+----------------+-------------+----------------+-----------------------------+
9 rows in set (0.01 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563242742064"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-relational-tables-and-documents.html" target="_top">Working with Relational Tables and Documents</a>をご覧ください。
          </p></li><li class="listitem"><p>
            データ型の詳細は、<a class="xref" href="data-types.html#json" title="11.5 JSON データ型">セクション11.5「JSON データ型」</a> を参照してください。
          </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-shell-tutorial-python"></a>20.4 Python クイックスタートガイド: ドキュメントストア用の MySQL Shell</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-shell">20.4.1 MySQL Shell</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-download">20.4.2 world_x データベースのダウンロードおよびインポート</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-collections">20.4.3 ドキュメントとコレクション</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-relational-tables">20.4.4 リレーショナルテーブル</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-in-tables">20.4.5 テーブル内のドキュメント</a></span></dt></dl></div><a class="indexterm" name="idm45563242735952"></a><p>
    このクイックスタートガイドでは、MySQL Shell と対話形式でドキュメントストアアプリケーションのプロトタイプ作成を開始する手順について説明します。 このガイドの内容は次のとおりです: 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        MySQL 機能、MySQL Shell および <code class="literal">world_x</code> サンプルスキーマの概要。
      </p></li><li class="listitem"><p>
        コレクションおよびドキュメントを管理する操作。
      </p></li><li class="listitem"><p>
        リレーショナルテーブルを管理する操作。
      </p></li><li class="listitem"><p>
        テーブル内のドキュメントに適用される操作。
      </p></li></ul></div><p>
    このクイックスタートガイドに従うには、MySQL サーバーに X プラグイン がインストールされている必要があります。8.0 のデフォルトは MySQL Shell で、MySQL Shell は X DevAPI を含み、JavaScript および Python の両方で実装されており、MySQL サーバーインスタンスに X プロトコル を使用して接続し、サーバーをドキュメントストアとして使用できます。
  </p><h3><a name="idm45563242727856"></a>関連情報</h3><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/" target="_top">MySQL Shell 8.0</a> は、MySQL Shell に関する詳細情報を提供します。
      </p></li><li class="listitem"><p>
        このクイックスタートガイドで使用されるツールの詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-install.html" target="_top">MySQL Shell のインストール</a> および <a class="xref" href="document-store.html#x-plugin" title="20.5 X プラグイン">セクション20.5「X プラグイン」</a> を参照してください。
      </p></li><li class="listitem"><p>
        MySQL Shell でサポートされる言語の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-features.html#shell-supported-languages" target="_top">サポートされる言語</a> を参照してください。
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/" target="_top">X DevAPI User Guide</a> には、X DevAPI を使用して、MySQL をドキュメントストアとして使用するアプリケーションを開発するその他の例があります。
      </p></li><li class="listitem"><p>
        <a class="link" href="document-store.html#mysql-shell-tutorial-javascript" title="20.3 JavaScript クイックスタートガイド: ドキュメントストア用の MySQL Shell">JavaScript</a> クイックスタートガイドも使用できます。
      </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-python-shell"></a>20.4.1 MySQL Shell</h3></div></div></div><a class="indexterm" name="idm45563242716160"></a><p>
      このクイックスタートガイドでは、MySQL Shell について一定レベルの知識があることを前提としています。 次のセクションは概要です。詳細は、MySQL Shell のドキュメントを参照してください。MySQL Shell は、MySQL Server への統一されたスクリプトインタフェースです。 JavaScript および Python でのスクリプトがサポートされています。 JavaScript はデフォルトの処理モードです。 
    </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-shell-start"></a>MySQL Shell の起動</h4></div></div></div><p>
        MySQL サーバーをインストールして起動したら、MySQL Shell をサーバーインスタンスに接続します。 接続する予定の MySQL サーバーインスタンスのアドレスを知っている必要があります。 インスタンスをドキュメントストアとして使用できるようにするには、サーバーインスタンスに X プラグイン がインストールされている必要があり、X プロトコル を使用してサーバーに接続する必要があります。 たとえば、33060 のデフォルトの X プロトコル ポートでインスタンス <code class="literal">ds1.example.com</code> に接続するには、ネットワーク文字列 <code class="literal"><em class="replaceable"><code>user</code></em>@ds1.example.com:33060</code> を使用します。 
      </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
          <code class="literal">mysqlx_port</code> のかわりに 3306 のデフォルトの <code class="literal">port</code> を使用するなどして、クラシック MySQL プロトコル を使用してインスタンスに接続する場合、このチュートリアルに示すドキュメントストア機能は使用できません。 たとえば、<code class="literal">db</code> グローバルオブジェクトは移入されません。 ドキュメントストアを使用するには、常に X プロトコル を使用して接続します。 
        </p></div><p>
        MySQL Shell がまだ実行されていない場合は、ターミナルウィンドウを開き、次のコマンドを発行します:
      </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh <em class="replaceable"><code>user</code></em>@ds1.example.com:33060/world_x</code></strong>
</pre><p>
        または、MySQL Shell がすでに実行されている場合は、次のコマンドを発行して<code class="literal">\connect</code> コマンドを使用します:
      </p><pre class="programlisting"><strong class="userinput"><code>\connect <em class="replaceable"><code>user</code></em>@ds1.example.com:33060/world_x</code></strong>
</pre><p>
        MySQL Shell を接続する MySQL サーバーインスタンスのアドレスを指定する必要があります。 たとえば、前の例では次のようになります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>user</code></em> は、MySQL アカウントのユーザー名を表します。
          </p></li><li class="listitem"><p>
            <code class="literal">ds1.example.com</code> は、MySQL を実行しているサーバーインスタンスのホスト名です。 これを、ドキュメントストアとして使用している MySQL サーバーインスタンスのホスト名に置き換えます。 
          </p></li><li class="listitem"><p>
            このセッションのデフォルトスキーマは <code class="literal">world_x</code> です。 <code class="literal">world_x</code> スキーマの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-python-download" title="20.4.2 world_x データベースのダウンロードおよびインポート">セクション20.4.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。 
          </p></li></ul></div><p>
        詳細は、<a class="xref" href="programs.html#connecting-using-uri-or-key-value-pairs" title="4.2.5 URI 類似文字列またはキーと値のペアを使用したサーバーへの接続">セクション4.2.5「URI 類似文字列またはキーと値のペアを使用したサーバーへの接続」</a>を参照してください。
      </p><p>
        MySQL Shell が開くと、<code class="literal">mysql-js&gt;</code> プロンプトに、このセッションのアクティブな言語が JavaScript であることが示されます。 MySQL Shell を Python モードに切り替えるには、<code class="literal">\py</code> コマンドを使用します。 
      </p><pre class="programlisting">mysql-js&gt; <strong class="userinput"><code>\py</code></strong>
Switching to Python mode...
mysql-py&gt;
</pre><p>
        MySQL Shell は、次のような入力行編集をサポートしています:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="keycap"><strong>left-arrow</strong></span> および <span class="keycap"><strong>right-arrow</strong></span> キーは、現在の入力行内で水平に移動します。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>up-arrow</strong></span> および <span class="keycap"><strong>down-arrow</strong></span> のキーは、以前に入力した一連の行を上下に移動します。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>「バックスペース」</strong></span>でカーソルの前の文字を削除でき、新しい文字を入力するとカーソルの位置に挿入されます。
          </p></li><li class="listitem"><p>
            <span class="keycap"><strong>Enter</strong></span> は、現在の入力行をサーバーに送信します。
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-shell-help"></a>MySQL Shell のヘルプの表示</h4></div></div></div><a class="indexterm" name="idm45563242674736"></a><p>
        コマンドラインオプションのリストを表示するには、コマンドインタプリタのプロンプトで <span class="command"><strong>mysqlsh --help</strong></span> と入力します。
      </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh --help</code></strong>
</pre><p>
        使用可能なコマンドとその説明のリストを表示するには、MySQL Shell プロンプトで<code class="literal">\help</code> と入力します。
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\help</code></strong>
</pre><p>
        個々の MySQL Shell コマンドの詳細なヘルプを表示するには、<code class="literal">\help</code> に続けてコマンド名を入力します。 たとえば、<code class="literal">\connect</code> コマンドのヘルプを表示するには、次のコマンドを発行します: 
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\help \connect</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-shell-quit"></a>MySQL Shell の終了</h4></div></div></div><a class="indexterm" name="idm45563242661536"></a><p>
        MySQL Shell を終了するには、次のコマンドを発行します:
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\quit</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563242657312"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL Shell での対話型コード実行の動作については、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-interactive-code-execution.html" target="_top">対話型コードの実行</a> を参照してください。
          </p></li><li class="listitem"><p>
            セッションおよび接続の代替方法の詳細は、<a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-getting-started.html" target="_top">MySQL Shell スタートガイド</a> を参照してください。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-python-download"></a>20.4.2 world_x データベースのダウンロードおよびインポート</h3></div></div></div><p>
      このクイックスタートガイドの一部として、<code class="literal">world_x</code> スキーマと呼ばれるサンプルスキーマが用意されています。 これらの例の多くは、このスキーマを使用するドキュメントストア機能を示しています。 <code class="literal">world_x</code> スキーマをロードできるように MySQL サーバーを起動し、次のステップに従います: 
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          <a class="ulink" href="http://downloads.mysql.com/docs/world_x-db.zip" target="_top">world_x-db.zip</a> のダウンロード。
        </p></li><li class="listitem"><p>
          <code class="filename">/tmp/</code>などの一時的な場所にインストールアーカイブを抽出します。 アーカイブを解凍すると、<code class="filename">world_x.sql</code> という名前の単一ファイルが作成されます。 
        </p></li><li class="listitem"><p>
          <code class="filename">world_x.sql</code> ファイルをサーバーにインポートします。 次のいずれかを実行できます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL Shell を SQL モードで起動し、次のコマンドを発行してファイルをインポートします:
            </p><pre class="programlisting"><strong class="userinput"><code>mysqlsh -u root --sql --file /tmp/world_x-db/world_x.sql</code></strong>
Enter password: <strong class="userinput"><code>****</code></strong>
</pre></li><li class="listitem"><p>
              実行中に MySQL Shell を SQL モードに設定し、次のコマンドを発行してスキーマファイルをソーシングします:
            </p><pre class="programlisting"><strong class="userinput"><code>\sql</code></strong>
Switching to SQL mode... Commands end with ;
<strong class="userinput"><code>\source /tmp/world_x-db/world_x.sql</code></strong>
</pre></li></ul></div><p>
          <code class="filename">/tmp/</code>をシステム上の <code class="filename">world_x.sql</code> ファイルへのパスに置き換えます。 プロンプトが表示されたら、パスワードを入力します。 root 以外のアカウントは、そのアカウントが新しいスキーマを作成する権限を持っているかぎり使用できます。 
        </p></li></ol></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-world-x"></a>world_x スキーマ</h4></div></div></div><a class="indexterm" name="idm45563242631168"></a><p>
        <code class="literal">world_x</code> サンプルスキーマには、次の JSON コレクションおよびリレーショナルテーブルが含まれています:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            コレクション
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">countryinfo</code>: 世界中の国に関する情報。
              </p></li></ul></div></li><li class="listitem"><p>
            テーブル
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">country</code>: 世界の国に関する最小限の情報。
              </p></li><li class="listitem"><p>
                <code class="literal">city</code>: これらの国の一部の都市に関する情報。
              </p></li><li class="listitem"><p>
                <code class="literal">countrylanguage</code>: 各国で話されている言語。
              </p></li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563242618544"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-sessions.html" target="_top">MySQL Shell セッション</a> では、セッションタイプについて説明します。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-python-documents-collections"></a>20.4.3 ドキュメントとコレクション</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-collections-operations">20.4.3.1 コレクションの作成、リストおよびドロップ</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-add">20.4.3.2 コレクションの操作</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-find">20.4.3.3 ドキュメントの検索</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-modify">20.4.3.4 ドキュメントの変更</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-remove">20.4.3.5 ドキュメントの削除</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-documents-index">20.4.3.6 インデックスの作成および削除</a></span></dt></dl></div><a class="indexterm" name="idm45563242614288"></a><p>
      MySQL をドキュメントストアとして使用している場合、コレクションは、作成、リストおよびドロップできるスキーマ内のコンテナです。 コレクションには、追加、検索、更新および削除できる JSON ドキュメントが含まれます。 
    </p><p>
      このセクションの例では、<code class="literal">world_x</code> スキーマの <code class="literal">countryinfo</code> コレクションを使用します。 <code class="literal">world_x</code> スキーマの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-python-download" title="20.4.2 world_x データベースのダウンロードおよびインポート">セクション20.4.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。 
    </p><h4><a name="mysql-shell-tutorial-python-documents"></a>Documents</h4><p>
      MySQL では、ドキュメントは JSON オブジェクトとして表されます。 内部的には、高速ルックアップおよび更新を可能にする効率的なバイナリ形式で格納されます。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Python の単純なドキュメント形式:
        </p><pre class="screen">{"field1": "value", "field2" : 10, "field 3": null}
</pre></li></ul></div><p>
      ドキュメントの配列は、カンマで区切られた一連のドキュメントで構成され、<code class="literal">[</code>および<code class="literal">]</code>文字で囲まれます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Python のドキュメントの単純な配列:
        </p><pre class="screen">[{"Name": "Aruba", "Code:": "ABW"}, {"Name": "Angola", "Code:": "AGO"}]
</pre></li></ul></div><p>
      MySQL は、JSON ドキュメントで次の Python 値タイプをサポートしています:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数値 (整数および浮動小数点)
        </p></li><li class="listitem"><p>
          文字列
        </p></li><li class="listitem"><p>
          boolean (False および True)
        </p></li><li class="listitem"><p>
          なし
        </p></li><li class="listitem"><p>
          JSON 値の配列
        </p></li><li class="listitem"><p>
          より多くの JSON 値のネストされた (埋込み) オブジェクト
        </p></li></ul></div><h4><a name="mysql-shell-tutorial-python-collections"></a>コレクション</h4><p>
      コレクションは、目的を共有し、場合によっては 1 つ以上のインデックスを共有するドキュメントのコンテナです。 各コレクションは一意の名前を持ち、単一のスキーマ内に存在します。 
    </p><p>
      スキーマという用語はデータベースと同等です。つまり、リレーショナルスキーマとは対照的に、データベースオブジェクトのグループであり、データの構造と制約を施行するために使用されます。 スキーマは、コレクション内のドキュメントへの準拠を強制しません。 
    </p><p>
      このクイックスタートガイドの内容は次のとおりです:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          基本オブジェクトには次のものがあります:
        </p><div class="informaltable"><table summary="Objects to use interactively in MySQL Shell"><col style="width: 40%"><col style="width: 60%"><thead><tr>
              <th>オブジェクトフォーム</th>
              <th>説明</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">db</code></td>
              <td><code class="literal">db</code> は、現在アクティブなスキーマに割り当てられたグローバル変数です。 コレクションの取得など、スキーマに対して操作を実行する場合は、<code class="literal">db</code> 変数に使用可能なメソッドを使用します。 </td>
            </tr><tr>
              <td><code class="literal">db.get_collections()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-collections-get" title="コレクションのリスト">db.get_collections()</a> は、スキーマ内のコレクションのリストを返します。 このリストを使用して、コレクションオブジェクトへの参照の取得、コレクションオブジェクトの反復などを行います。 </td>
            </tr></tbody></table></div></li><li class="listitem"><p>
          コレクションによってスコープ指定される基本的な操作は次のとおりです:
        </p><div class="informaltable"><table summary="CRUD operations available in X DevAPI"><col style="width: 40%"><col style="width: 60%"><thead><tr>
              <th>操作フォーム</th>
              <th>説明</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.add()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-documents-add" title="20.4.3.2 コレクションの操作">add()</a> メソッドは、ドキュメントまたはドキュメントのリストを名前付きコレクションに挿入します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.find()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-documents-find" title="20.4.3.3 ドキュメントの検索">find()</a> メソッドは、名前付きコレクション内の一部またはすべてのドキュメントを返します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.modify()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-documents-modify" title="20.4.3.4 ドキュメントの変更">modify()</a> メソッドは、名前付きコレクション内のドキュメントを更新します。</td>
            </tr><tr>
              <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.remove()</code></td>
              <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-documents-remove" title="20.4.3.5 ドキュメントの削除">remove()</a> メソッドは、名前付きコレクションからドキュメントまたはドキュメントのリストを削除します。</td>
            </tr></tbody></table></div></li></ul></div><h4><a name="idm45563242552304"></a>関連情報</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          一般的な概要は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-collections.html" target="_top">Working with Collections</a> を参照してください。
        </p></li><li class="listitem"><p>
          <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/mysql-x-crud-ebnf-definitions.html" target="_top">CRUD EBNF Definitions</a> では、操作の完全なリストが提供されます。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-collections-operations"></a>20.4.3.1 コレクションの作成、リストおよびドロップ</h4></div></div></div><a class="indexterm" name="idm45563242546672"></a><p>
        MySQL Shell では、新しいコレクションを作成し、スキーマ内の既存のコレクションのリストを取得し、スキーマから既存のコレクションを削除できます。 コレクション名は大/小文字が区別され、各コレクション名は一意である必要があります。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242543680"></a>スキーマの確認</h5></div></div></div><a class="indexterm" name="idm45563242543008"></a><p>
          スキーマ変数に割り当てられている値を表示するには、次のコマンドを発行します:
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db</code></strong>
</pre><p>
          スキーマ値が <code class="literal">Schema:world_x</code> でない場合は、次のコマンドを発行して <code class="literal">db</code> 変数を設定します:
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\use world_x</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-collections-create"></a>コレクションの作成</h5></div></div></div><a class="indexterm" name="idm45563242533856"></a><p>
          既存のスキーマに新しいコレクションを作成するには、<code class="literal">db</code> オブジェクトの <code class="literal">createCollection()</code> メソッドを使用します。 次の例では、<code class="literal">world_x</code> スキーマに <code class="literal">flags</code> というコレクションを作成します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.create_collection("flags")</code></strong>
</pre><p>
          このメソッドはコレクションオブジェクトを返します。
        </p><pre class="screen">&lt;Collection:flags&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-collections-get"></a>コレクションのリスト</h5></div></div></div><a class="indexterm" name="idm45563242524016"></a><p>
          <code class="literal">world_x</code> スキーマ内のすべてのコレクションを表示するには、<code class="literal">db</code> オブジェクトの <code class="literal">get_collections()</code> メソッドを使用します。 現在接続しているサーバーによって返されるコレクションは、大カッコ内に表示されます。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.get_collections()</code></strong>
[
    &lt;Collection:countryinfo&gt;,
    &lt;Collection:flags&gt;
]
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-collections-drop"></a>コレクションのドロップ</h5></div></div></div><a class="indexterm" name="idm45563242516048"></a><p>
          スキーマから既存のコレクションを削除するには、<code class="literal">db</code> オブジェクトの <code class="literal">drop_collection()</code> メソッドを使用します。 たとえば、現行のスキーマから <code class="literal">flags</code> コレクションを削除するには、次のコマンドを発行します: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.drop_collection("flags")</code></strong>
</pre><p>
          <code class="literal">drop_collection()</code> メソッドは、スキーマからリレーショナルテーブルを削除するために MySQL Shell でも使用されます。

        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242508016"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              その他の例については、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-objects.html" target="_top">Collection Objects</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-documents-add"></a>20.4.3.2 コレクションの操作</h4></div></div></div><a class="indexterm" name="idm45563242503728"></a><p>
        スキーマ内のコレクションを操作するには、<code class="literal">db</code> グローバルオブジェクトを使用して現在のスキーマにアクセスします。 この例では、以前にインポートした <code class="literal">world_x</code> スキーマと <code class="literal">countryinfo</code> コレクションを使用しています。 したがって、発行する操作の形式は <code class="literal">db.<em class="replaceable"><code>collection_name</code></em>.operation</code> で、<em class="replaceable"><code>collection_name</code></em> は操作の実行対象となるコレクションの名前です。 次の例では、操作は <code class="literal">countryinfo</code> コレクションに対して実行されます。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242496160"></a>ドキュメントの追加</h5></div></div></div><p>
          <code class="literal">add()</code> メソッドを使用して、あるドキュメントまたはドキュメントのリストを既存のコレクションに挿入します。 次のドキュメントを <code class="literal">countryinfo</code> コレクションに挿入します。 これは複数行コンテンツであるため、<span class="keycap"><strong>Enter</strong></span> を 2 回押してドキュメントを挿入します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.add(
 {
    "GNP": .6,
    "IndepYear": 1967,
    "Name": "Sealand",
    "Code:": "SEA",
    "demographics": {
        "LifeExpectancy": 79,
        "Population": 27
    },
    "geography": {
        "Continent": "Europe",
        "Region": "British Islands",
        "SurfaceArea": 193
    },
    "government": {
        "GovernmentForm": "Monarchy",
        "HeadOfState": "Michael Bates"
    }
  }
)</code></strong>
</pre><p>
          このメソッドは、操作のステータスを返します。 ドキュメントを検索して操作を確認できます。 例: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Sealand'")</code></strong>
{
    "GNP": 0.6,
    "_id": "00005e2ff4af00000000000000f4",
    "Name": "Sealand",
    "Code:": "SEA",
    "IndepYear": 1967,
    "geography": {
        "Region": "British Islands",
        "Continent": "Europe",
        "SurfaceArea": 193
    },
    "government": {
        "HeadOfState": "Michael Bates",
        "GovernmentForm": "Monarchy"
    },
    "demographics": {
        "Population": 27,
        "LifeExpectancy": 79
    }
}
</pre><p>
          ドキュメントの追加時に指定されたフィールドに加えて、<code class="literal">_id</code> というフィールドもあります。 各ドキュメントには、<code class="literal">_id</code> と呼ばれる識別子フィールドが必要です。 <code class="literal">_id</code> フィールドの値は、同じコレクション内のすべてのドキュメント間で一意である必要があります。 MySQL 8.0.11 以上では、ドキュメント ID はクライアントではなくサーバーによって生成されるため、MySQL Shell は<code class="literal">_id</code> 値を自動的に設定しません。 8.0.11 以上の MySQL サーバーでは、ドキュメントに<code class="literal">_id</code> フィールドが含まれていない場合、<code class="literal">_id</code> 値が設定されます。 以前の 8.0 リリースまたは 5.7 の MySQL サーバーは、この状況では<code class="literal">_id</code> 値を設定しないため、明示的に指定する必要があります。 そうでない場合、MySQL Shell はエラー 5115 <span class="errortext">「文書に必須フィールドがありません」</span>を返します。 詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/understanding-automatic-document-ids.html" target="_top">Understanding Document IDs</a> を参照してください。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242479008"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionaddfunction" target="_top">CollectionAddFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/understanding-automatic-document-ids.html" target="_top">Understanding Document IDs</a>を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-documents-find"></a>20.4.3.3 ドキュメントの検索</h4></div></div></div><a class="indexterm" name="idm45563242473040"></a><p>
        <code class="literal">find()</code> メソッドを使用して、スキーマ内のコレクションに対してクエリーを実行し、ドキュメントを戻すことができます。MySQL Shell には、返されたドキュメントをフィルタおよびソートするために <code class="literal">find()</code> メソッドとともに使用する追加のメソッドが用意されています。
      </p><p>
        MySQL には、検索条件を指定する次の演算子が用意されています: <code class="literal">OR</code> (<code class="literal">||</code>)、<code class="literal">AND</code> (<code class="literal">&amp;&amp;</code>)、<code class="literal">XOR</code>, <code class="literal">IS</code>, <code class="literal">NOT</code>, <code class="literal">BETWEEN</code>, <code class="literal">IN</code>, <code class="literal">LIKE</code>, <code class="literal">!=</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&amp;</code>, <code class="literal">|</code>, <code class="literal">&lt;&lt;</code>, <code class="literal">&gt;&gt;</code>, <code class="literal">+</code>, <code class="literal">-</code>, <code class="literal">*</code>, <code class="literal">/</code>, <code class="literal">~</code> および <code class="literal">%</code>。
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-documents-find-all"></a>コレクション内のすべてのドキュメントの検索</h5></div></div></div><a class="indexterm" name="idm45563242449248"></a><p>
          コレクション内のすべてのドキュメントを返すには、検索条件を指定せずに <code class="literal">find()</code> メソッドを使用します。 たとえば、次の操作では、<code class="literal">countryinfo</code> コレクション内のすべてのドキュメントが返されます。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find()</code></strong>
[
     {
          "GNP": 828,
          "Code:": "ABW",
          "Name": "Aruba",
          "IndepYear": null,
          "geography": {
              "Continent": "North America",
              "Region": "Caribbean",
              "SurfaceArea": 193
          },
          "government": {
              "GovernmentForm": "Nonmetropolitan Territory of The Netherlands",
              "HeadOfState": "Beatrix"
          }
          "demographics": {
              "LifeExpectancy": 78.4000015258789,
              "Population": 103000
          },
          ...
      }
 ]
240 documents in set (0.00 sec)
</pre><p>
          このメソッドは、コレクション内のすべてのドキュメントに加えて、操作情報を含む結果を生成します。
        </p><p>
          空のセット (一致するドキュメントがない) は、次の情報を返します:
        </p><pre class="screen">Empty set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-documents-find-filter-searches"></a>フィルタ検索</h5></div></div></div><a class="indexterm" name="idm45563242439904"></a><p>
          <code class="literal">find()</code> メソッドに検索条件を含めることができます。 検索条件を形成する式の構文は、従来の MySQL <a class="xref" href="functions.html" title="第 12 章 関数と演算子">第12章「<i>関数と演算子</i>」</a> の構文と同じです。 すべての式は引用符で囲む必要があります。 簡潔にするために、一部の例では出力が表示されません。 
        </p><p>
          単純検索条件は、<code class="literal">Name</code> フィールドとドキュメント内にあることがわかっている値で構成できます。 次の例では、単一のドキュメントを戻します: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Australia'")</code></strong>
[
    {
        "GNP": 351182,
        "Code:": "AUS",
        "Name": "Australia",
        "IndepYear": 1901,
        "geography": {
            "Continent": "Oceania",
            "Region": "Australia and New Zealand",
            "SurfaceArea": 7741220
        },
        "government": {
            "GovernmentForm": "Constitutional Monarchy, Federation",
            "HeadOfState": "Elisabeth II"
        }
        "demographics": {
            "LifeExpectancy": 79.80000305175781,
            "Population": 18886000
        },
    }
]
</pre><p>
          次の例では、GNP が 00 億を超えるすべての国を検索します。 <code class="literal">countryinfo</code> コレクションは GNP を百万単位で測定します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 500000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
10 documents in set (0.00 sec)
</pre><p>
          次のクエリーの「人口」フィールドは、人口統計オブジェクト内に埋め込まれます。 埋込みフィールドにアクセスするには、人口統計と人口間のピリオドを使用して関係を識別します。 ドキュメント名とフィールド名では大文字と小文字が区別されます。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 500000 and demographics.Population &lt; 100000000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
6 documents in set (0.00 sec)
</pre><p>
          次の式の算術演算子は、大文字当たりの GNP が 0000 を超える国をクエリーするために使用されます。 検索条件には、算術演算子およびほとんどの MySQL 関数を含めることができます。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">countryinfo</code> コレクション内の 7 つのドキュメントの母集団値はゼロです。 したがって、出力の最後に警告メッセージが表示されます。 
          </p></div><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("GNP*1000000/demographics.Population &gt; 30000")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
9 documents in set, 7 warnings (0.00 sec)
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
Warning (Code 1365): Division by 0
</pre><p>
          <code class="literal">bind()</code> メソッドを使用して、値を検索条件から区切ることができます。 たとえば、ハードコードされた国名を条件として指定するかわりに、コロンで構成される名前付きプレースホルダの後に、<span class="emphasis"><em>country</em></span> などの文字で始まる名前を付けます。 次に、<code class="literal">bind(<em class="replaceable"><code>placeholder</code></em>, <em class="replaceable"><code>value</code></em>)</code> メソッドを次のように使用します: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("Name = :country").bind("country", "Italy")</code></strong>
{
    "GNP": 1161755,
    "_id": "00005de917d8000000000000006a",
    "Code": "ITA",
    "Name": "Italy",
    "Airports": [],
    "IndepYear": 1861,
    "geography": {
        "Region": "Southern Europe",
        "Continent": "Europe",
        "SurfaceArea": 301316
    },
    "government": {
        "HeadOfState": "Carlo Azeglio Ciampi",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 57680000,
        "LifeExpectancy": 79
    }
}
1 document in set (0.01 sec)
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
            プログラム内でバインディングを使用すると、式にプレースホルダを指定できます。プレースホルダには、実行前に値が入力され、必要に応じて自動エスケープを利用できます。
          </p><p>
            入力をサニタイズするには、常にバインディングを使用します。 文字列連結を使用してクエリーに値を導入しないでください。無効な入力が生成され、場合によってはセキュリティの問題が発生することがあります。 
          </p></div><p>
          プレースホルダおよび <code class="literal">bind()</code> メソッドを使用して保存済検索を作成し、別の値でコールできます。 たとえば、国の保存済検索を作成するには、次のようにします: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>myFind = db.countryinfo.find("Name = :country")</code></strong>
mysql-py&gt; <strong class="userinput"><code>myFind.bind('country', 'France')</code></strong>
{
    "GNP": 1424285,
    "_id": "00005de917d80000000000000048",
    "Code": "FRA",
    "Name": "France",
    "IndepYear": 843,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 551500
    },
    "government": {
        "HeadOfState": "Jacques Chirac",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 59225700,
        "LifeExpectancy": 78.80000305175781
    }
}
1 document in set (0.0028 sec)

mysql-py&gt; <strong class="userinput"><code>myFind.bind('country', 'Germany')</code></strong>
{
    "GNP": 2133367,
    "_id": "00005de917d80000000000000038",
    "Code": "DEU",
    "Name": "Germany",
    "IndepYear": 1955,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 357022
    },
    "government": {
        "HeadOfState": "Johannes Rau",
        "GovernmentForm": "Federal Republic"
    },
    "demographics": {
        "Population": 82164700,
        "LifeExpectancy": 77.4000015258789
    }
}

1 document in set (0.0026 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242405008"></a>プロジェクト結果</h5></div></div></div><a class="indexterm" name="idm45563242404320"></a><p>
          すべてのフィールドを返すかわりに、ドキュメントの特定のフィールドを返すことができます。 次の例では、検索条件に一致する <code class="literal">countryinfo</code> コレクション内のすべてのドキュメントの GNP および Name フィールドを返します。 
        </p><p>
          <code class="literal">fields()</code> メソッドを使用して、返すフィールドのリストを渡します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("GNP &gt; 5000000").fields(["GNP", "Name"])</code></strong>
[
    {
        "GNP": 8510700,
        "Name": "United States"
    }
]
1 document in set (0.00 sec)
 </pre><p>
          また、返されるドキュメントを記述する式を使用して、返されるドキュメント (追加、名前変更、ネストおよび新しいフィールド値の計算) を変更できます。 たとえば、次の式を使用してフィールドの名前を変更すると、2 つのドキュメントのみが返されます。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find().fields(
mysqlx.expr('{"Name": upper(Name), "GNPPerCapita": GNP*1000000/demographics.Population}')).limit(2)</code></strong>
{
    "Name": "ARUBA",
    "GNPPerCapita": 8038.834951456311
}
{
    "Name": "AFGHANISTAN",
    "GNPPerCapita": 263.0281690140845
}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242394464"></a>結果の制限、ソートおよびスキップ</h5></div></div></div><a class="indexterm" name="idm45563242393760"></a><p>
          <code class="literal">limit()</code>、<code class="literal">sort()</code> および <code class="literal">skip()</code> メソッドを適用して、<code class="literal">find()</code> メソッドによって返されるドキュメントの数と順序を管理できます。
        </p><p>
          結果セットに含めるドキュメントの数を指定するには、<code class="literal">limit()</code> メソッドの値を <code class="literal">find()</code> メソッドに追加します。 次のクエリーは、<code class="literal">countryinfo</code> コレクション内の最初の 5 つのドキュメントを返します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find().limit(5)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
5 documents in set (0.00 sec)
</pre><p>
          結果の順序を指定するには、<code class="literal">sort()</code> メソッドを <code class="literal">find()</code> メソッドに追加します。 必要に応じて、降順 (<code class="literal">desc</code>) または昇順 (<code class="literal">asc</code>) 属性でソートするフィールドのリストを <code class="literal">sort()</code> メソッドに渡します。 昇順がデフォルトのオーダータイプです。 
        </p><p>
          たとえば、次のクエリーでは、すべてのドキュメントが IndepYear フィールドでソートされ、最初の 8 つのドキュメントが降順で返されます。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find().sort(["IndepYear desc"]).limit(8)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre><p>
          デフォルトでは、<code class="literal">limit()</code> メソッドはコレクション内の最初のドキュメントから始まります。 <code class="literal">skip()</code> メソッドを使用して、開始ドキュメントを変更できます。 たとえば、最初のドキュメントを無視し、条件に一致する次の 8 つのドキュメントを返すには、<code class="literal">skip()</code> メソッドに値 1 を渡します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find().sort(["IndepYear desc"]).limit(8).skip(1)</code></strong>
... [<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242370048"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="functions.html" title="第 12 章 関数と演算子">MySQL Reference Manual</a> には、関数および演算子に関する詳細なドキュメントが用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionfindfunction" target="_top">CollectionFindFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-documents-modify"></a>20.4.3.4 ドキュメントの変更</h4></div></div></div><a class="indexterm" name="idm45563242363872"></a><p>
        <code class="literal">modify()</code> メソッドを使用して、コレクション内の 1 つ以上のドキュメントを更新できます。 X DevAPI には、<code class="literal">modify()</code> メソッドとともに使用して次の操作を行うための追加メソッドが用意されています: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ドキュメント内のフィールドを設定および設定解除します。
          </p></li><li class="listitem"><p>
            配列を追加、挿入および削除します。
          </p></li><li class="listitem"><p>
            変更するドキュメントをバインド、制限およびソートします。
          </p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242356432"></a>ドキュメントフィールドの設定および設定解除</h5></div></div></div><a class="indexterm" name="idm45563242355712"></a><p>
          <code class="literal">modify()</code> メソッドは、コレクションをフィルタ処理して変更するドキュメントのみを含め、指定した操作をそれらのドキュメントに適用することで機能します。
        </p><p>
          次の例では、<code class="literal">modify()</code> メソッドは検索条件を使用して変更するドキュメントを識別し、ネストされたデモグラフィックオブジェクト内の 2 つの値を <code class="literal">set()</code> メソッドで置き換えます。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("Code = 'SEA'").set(
"demographics", {"LifeExpectancy": 78, "Population": 28})</code></strong>
</pre><p>
          ドキュメントを変更した後、<code class="literal">find()</code> メソッドを使用して変更を確認します。
        </p><p>
          ドキュメントからコンテンツを削除するには、<code class="literal">modify()</code> および <code class="literal">unset()</code> メソッドを使用します。 たとえば、次のクエリーは、検索条件に一致するドキュメントから GNP を削除します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'Sealand'").unset("GNP")</code></strong>
</pre><p>
          <code class="literal">find()</code> メソッドを使用して変更を確認します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'Sealand'")</code></strong>
{
    "_id": "00005e2ff4af00000000000000f4",
    "Name": "Sealand",
    "Code:": "SEA",
    "IndepYear": 1967,
    "geography": {
        "Region": "British Islands",
        "Continent": "Europe",
        "SurfaceArea": 193
    },
    "government": {
        "HeadOfState": "Michael Bates",
        "GovernmentForm": "Monarchy"
    },
    "demographics": {
        "Population": 27,
        "LifeExpectancy": 79
    }
}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-append-insert-delete"></a>配列の追加、挿入および削除</h5></div></div></div><a class="indexterm" name="idm45563242338176"></a><p>
          配列フィールドに要素を追加したり、配列内の要素を挿入または削除するには、<code class="literal">array_append()</code>、<code class="literal">array_insert()</code> または <code class="literal">array_delete()</code> メソッドを使用します。 次の例では、国際空港のトラッキングを有効にするように <code class="literal">countryinfo</code> コレクションを変更します。 
        </p><p>
          最初の例では、<code class="literal">modify()</code> および <code class="literal">set()</code> メソッドを使用して、すべてのドキュメントに新しい空港フィールドを作成します。
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにドキュメントを変更する場合は注意してください。変更すると、コレクション内のすべてのドキュメントが変更されます。
          </p></div><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("true").set("Airports", [])</code></strong>
</pre><p>
          空港フィールドが追加された状態で、次の例では、<code class="literal">array_append()</code> メソッドを使用して新しい空港をいずれかのドキュメントに追加します。次の例の <span class="emphasis"><em>$.Airports</em></span> は、現在のドキュメントの空港フィールドを表しています。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").array_append("$.Airports", "ORY")</code></strong>
</pre><p>
          <code class="literal">find()</code> を使用して変更を確認します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("Name = 'France'")</code></strong>
{
    "GNP": 1424285,
    "_id": "00005de917d80000000000000048",
    "Code": "FRA",
    "Name": "France",
    "Airports": [
        "ORY"
    ],
    "IndepYear": 843,
    "geography": {
        "Region": "Western Europe",
        "Continent": "Europe",
        "SurfaceArea": 551500
    },
    "government": {
        "HeadOfState": "Jacques Chirac",
        "GovernmentForm": "Republic"
    },
    "demographics": {
        "Population": 59225700,
        "LifeExpectancy": 78.80000305175781
    }
}
</pre><p>
          配列内の別の位置に要素を挿入するには、<code class="literal">array_insert()</code> メソッドを使用して、パス式に挿入するインデックスを指定します。 この場合、インデックスは 0、または配列の最初の要素です。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").array_insert("$.Airports[0]", "CDG")</code></strong>
</pre><p>
          配列から要素を削除するには、削除する要素のインデックスを <code class="literal">array_delete()</code> メソッドに渡す必要があります。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.modify("Name = 'France'").array_delete("$.Airports[1]")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242313760"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="data-types.html#json-paths" title="JSON 値の検索および変更">MySQL Reference Manual</a> には、JSON 値の検索および変更に役立つ手順が用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionmodifyfunction" target="_top">CollectionModifyFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-documents-remove"></a>20.4.3.5 ドキュメントの削除</h4></div></div></div><a class="indexterm" name="idm45563242307600"></a><p>
        <code class="literal">remove()</code> メソッドを使用して、スキーマ内のコレクションから一部またはすべてのドキュメントを削除できます。 X DevAPI には、<code class="literal">remove()</code> メソッドとともに使用して、削除するドキュメントをフィルタおよびソートするための追加メソッドが用意されています。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-remove-documents-by-condition"></a>条件を使用したドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563242301984"></a><p>
          次の例では、検索条件を <code class="literal">remove()</code> メソッドに渡します。 条件に一致するすべてのドキュメントが <code class="literal">countryinfo</code> コレクションから削除されます。 この例では、1 つのドキュメントが条件に一致します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.remove("Code = 'SEA'")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-remove-first-document"></a>最初のドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563242294688"></a><p>
          <code class="literal">countryinfo</code> コレクションの最初のドキュメントを削除するには、値 1 を指定して <code class="literal">limit()</code> メソッドを使用します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.remove("true").limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-remove-last-document"></a>オーダー内の最後の文書の削除</h5></div></div></div><a class="indexterm" name="idm45563242287728"></a><p>
          次の例では、国名で <code class="literal">countryinfo</code> コレクションの最後のドキュメントを削除します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.remove("true").sort(["Name desc"]).limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-remove-all-documents"></a>コレクション内のすべてのドキュメントの削除</h5></div></div></div><a class="indexterm" name="idm45563242281312"></a><p>
          コレクション内のすべてのドキュメントを削除できます。 これを行うには、検索条件を指定せずに <code class="literal">remove("true")</code> メソッドを使用します。 
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにドキュメントを削除する場合は注意してください。 このアクションは、コレクションからすべてのドキュメントを削除します。 
          </p></div><p>
          または、<code class="literal">db.drop_collection('countryinfo')</code> 操作を使用して <code class="literal">countryinfo</code> コレクションを削除します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242274592"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-crud-functions.html#crud-ebnf-collectionremovefunction" target="_top">CollectionRemoveFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">world_x</code> スキーマを再作成する手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-python-download" title="20.4.2 world_x データベースのダウンロードおよびインポート">セクション20.4.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-documents-index"></a>20.4.3.6 インデックスの作成および削除</h4></div></div></div><a class="indexterm" name="idm45563242267888"></a><p>
        インデックスは、特定のフィールド値を持つドキュメントをすばやく検索するために使用されます。 インデックスがない場合、MySQL は最初のドキュメントで始まり、コレクション全体を読み取って関連するフィールドを検索する必要があります。 コレクションが大きいほど、このコストは高くなります。 コレクションが大きく、特定のフィールドに対するクエリーが一般的な場合は、ドキュメント内の特定のフィールドに対するインデックスの作成を検討してください。 
      </p><p>
        たとえば、移入フィールドのインデックスを使用すると、次のクエリーのパフォーマンスが向上します:
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.find("demographics.Population &lt; 100")</code></strong>
...[<span class="emphasis"><em>output removed</em></span>]
8 documents in set (0.00 sec)
</pre><p>
        <code class="literal">create_index()</code> メソッドは、使用するフィールドを指定する JSON ドキュメントで定義できるインデックスを作成します。 このセクションでは、インデックス付けの概要について説明します。 詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html" target="_top">Indexing Collections</a> を参照してください。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-nonunique-index"></a>一意でないインデックスの追加</h5></div></div></div><a class="indexterm" name="idm45563242257648"></a><p>
          一意でないインデックスを作成するには、インデックス名とインデックス情報を <code class="literal">create_index()</code> メソッドに渡します。 重複するインデックス名は禁止されています。 
        </p><p>
          次の例では、<code class="literal">demographics</code> オブジェクトの <code class="literal">Population</code> フィールドに対して定義され、<code class="literal">Integer</code> 数値としてインデックス付けされた <code class="literal">popul</code> という名前のインデックスを指定します。 最後のパラメータは、フィールドに <code class="literal">NOT NULL</code> 制約が必要かどうかを示します。 値が <code class="literal">false</code> の場合、フィールドには <code class="literal">NULL</code> 値を含めることができます。 インデックス情報は、インデックスに含める 1 つ以上のフィールドの詳細を含む JSON ドキュメントです。 各フィールド定義には、フィールドへの完全なドキュメントパスを含め、フィールドのタイプを指定する必要があります。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.createIndex("popul", {fields:
[{field: '$.demographics.Population', type: 'INTEGER'}]})</code></strong>
</pre><p>
          ここでは、整数の数値を使用してインデックスが作成されます。 GeoJSON データで使用するオプションなど、さらにオプションを使用できます。 デフォルトタイプの <span class="quote">「<span class="quote">index</span>」</span> が適切であるため、ここでは省略されているインデックスのタイプを指定することもできます。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-unique-index"></a>一意インデックスの追加</h5></div></div></div><a class="indexterm" name="idm45563242242832"></a><p>
          一意のインデックスを作成するには、インデックス名、インデックス定義およびインデックスタイプ <span class="quote">「<span class="quote">unique</span>」</span> を <code class="literal">create_index()</code> メソッドに渡します。 この例は、国名 (<code class="literal">"Name"</code>) に対して作成された一意のインデックスを示しています。これは、インデックス付けする <code class="literal">countryinfo</code> コレクションの別の共通フィールドです。 インデックスフィールドの説明で、<code class="literal">"TEXT(40)"</code>はインデックス付けする文字数を表し、<code class="literal">"required": True</code> はフィールドがドキュメントに存在する必要があることを指定します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.create_index("name",
{"fields": [{"field": "$.Name", "type": "TEXT(40)", "required": True}], "unique": True})</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-drop-index"></a>インデックスの削除</h5></div></div></div><a class="indexterm" name="idm45563242232432"></a><p>
          インデックスを削除するには、削除するインデックスの名前を <code class="literal">drop_index()</code> メソッドに渡します。 たとえば、次のように <span class="quote">「<span class="quote">popul</span>」</span> インデックスを削除できます: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.countryinfo.drop_index("popul")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242226784"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html" target="_top">Indexing Collections</a>をご覧ください。
            </p></li><li class="listitem"><p>
              インデックスを定義する JSON ドキュメントの詳細は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/collection-indexing.html#collection-index-definitions" target="_top">Defining an Index</a> を参照してください。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-collection-index-management-functions.html" target="_top">Collection Index Management Functions</a> を参照してください。
            </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-python-relational-tables"></a>20.4.4 リレーショナルテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-table-insert">20.4.4.1 テーブルへのレコードの挿入</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-table-select">20.4.4.2 テーブルの選択</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-table-update">20.4.4.3 テーブルの更新</a></span></dt><dt><span class="section"><a href="document-store.html#mysql-shell-tutorial-python-table-delete">20.4.4.4 テーブルの削除</a></span></dt></dl></div><a class="indexterm" name="idm45563242218800"></a><p>
      X DevAPI を使用してリレーショナルテーブルを操作することもできます。 MySQL では、各リレーショナルテーブルは特定のストレージエンジンに関連付けられます。 このセクションの例では、<code class="literal">world_x</code> スキーマの <code class="literal">InnoDB</code> テーブルを使用します。 
    </p><h4><a name="idm45563242214160"></a>スキーマの確認</h4><p>
      <code class="literal">db</code> グローバル変数に割り当てられているスキーマを表示するには、<code class="literal">db</code> を発行します。
    </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db</code></strong>
&lt;Schema:world_x&gt;
</pre><p>
      戻り値が <code class="literal">Schema:world_x</code> でない場合は、<code class="literal">db</code> 変数を次のように設定します:
    </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\use world_x</code></strong>
Schema `world_x` accessible through db.
</pre><h4><a name="idm45563242206176"></a>すべてのテーブルの表示</h4><p>
      <code class="literal">world_x</code> スキーマ内のすべてのリレーショナルテーブルを表示するには、<code class="literal">db</code> オブジェクトで <code class="literal">get_tables()</code> メソッドを使用します。
    </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.get_tables()</code></strong>
[
    &lt;Table:city&gt;,
    &lt;Table:country&gt;,
    &lt;Table:countrylanguage&gt;
]
</pre><h4><a name="idm45563242200864"></a>基本的なテーブル操作</h4><p>
      テーブルによってスコープ指定される基本的な操作は次のとおりです:
    </p><div class="informaltable"><table summary="CRUD operations to use interactively on tables within MySQL Shell"><col style="width: 32%"><col style="width: 68%"><thead><tr>
          <th>操作フォーム</th>
          <th>説明</th>
        </tr></thead><tbody><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.insert()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-table-insert" title="20.4.4.1 テーブルへのレコードの挿入">insert()</a> メソッドは、名前付きのテーブルに 1 つ以上のレコードを挿入します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.select()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-table-select" title="20.4.4.2 テーブルの選択">select()</a> メソッドは、指定されたテーブルの一部またはすべてのレコードを返します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.update()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-table-update" title="20.4.4.3 テーブルの更新">update()</a> メソッドは、指定されたテーブルのレコードを更新します。</td>
        </tr><tr>
          <td><code class="literal">db.<em class="replaceable"><code>name</code></em>.delete()</code></td>
          <td><a class="link" href="document-store.html#mysql-shell-tutorial-python-table-delete" title="20.4.4.4 テーブルの削除">delete()</a> メソッドは、名前付きのテーブルから 1 つ以上のレコードを削除します。</td>
        </tr></tbody></table></div><h4><a name="idm45563242177968"></a>関連情報</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-relational-tables.html" target="_top">Working with Relational Tables</a>をご覧ください。
        </p></li><li class="listitem"><p>
          <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/mysql-x-crud-ebnf-definitions.html" target="_top">CRUD EBNF Definitions</a> では、操作の完全なリストが提供されます。
        </p></li><li class="listitem"><p>
          <code class="literal">world_x</code> スキーマサンプルの設定手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-python-download" title="20.4.2 world_x データベースのダウンロードおよびインポート">セクション20.4.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-table-insert"></a>20.4.4.1 テーブルへのレコードの挿入</h4></div></div></div><a class="indexterm" name="idm45563242170208"></a><p>
        <code class="literal">insert()</code> メソッドを <code class="literal">values()</code> メソッドとともに使用して、既存のリレーショナルテーブルにレコードを挿入できます。 <code class="literal">insert()</code> メソッドは、個々のカラムまたはテーブル内のすべてのカラムを受け入れます。 1 つ以上の <code class="literal">values()</code> メソッドを使用して、挿入する値を指定します。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-insert-complete-record"></a>完全なレコードの挿入</h5></div></div></div><a class="indexterm" name="idm45563242163216"></a><p>
          完全なレコードを挿入するには、テーブルのすべてのカラムを <code class="literal">insert()</code> メソッドに渡します。 次に、<code class="literal">values()</code> メソッドに各カラムの値を渡します。 たとえば、<code class="literal">world_x</code> データベースの市区町村テーブルに新しいレコードを追加するには、次のレコードを挿入して <span class="keycap"><strong>Enter</strong></span> を 2 回押します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.insert("ID", "Name", "CountryCode", "District", "Info").values(
None, "Olympia", "USA", "Washington", '{"Population": 5000}')</code></strong>
</pre><p>
          city テーブルには 5 つのカラムがあります: ID、名前、CountryCode、地区および情報。 各値は、それが表すカラムのデータ型と一致する必要があります。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-insert-partial-record"></a>部分レコードの挿入</h5></div></div></div><a class="indexterm" name="idm45563242153376"></a><p>
          次の例では、city テーブルの ID、Name および CountryCode カラムに値を挿入します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.insert("ID", "Name", "CountryCode").values(
None, "Little Falls", "USA").values(None, "Happy Valley", "USA")</code></strong>
</pre><p>
          <code class="literal">insert()</code> メソッドを使用してカラムを指定する場合、値の数はカラムの数と一致する必要があります。 前の例では、指定した 3 つのカラムに一致するように 3 つの値を指定する必要があります。 
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242147376"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableinsertfunction" target="_top">TableInsertFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-table-select"></a>20.4.4.2 テーブルの選択</h4></div></div></div><a class="indexterm" name="idm45563242143056"></a><p>
        <code class="literal">select()</code> メソッドを使用して、データベース内のテーブルに対してクエリーを実行し、レコードを戻すことができます。 X DevAPI には、返されたレコードをフィルタおよびソートするために <code class="literal">select()</code> メソッドとともに使用する追加のメソッドが用意されています。 
      </p><p>
        MySQL には、検索条件を指定する次の演算子が用意されています: <code class="literal">OR</code> (<code class="literal">||</code>)、<code class="literal">AND</code> (<code class="literal">&amp;&amp;</code>)、<code class="literal">XOR</code>, <code class="literal">IS</code>, <code class="literal">NOT</code>, <code class="literal">BETWEEN</code>, <code class="literal">IN</code>, <code class="literal">LIKE</code>, <code class="literal">!=</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&amp;</code>, <code class="literal">|</code>, <code class="literal">&lt;&lt;</code>, <code class="literal">&gt;&gt;</code>, <code class="literal">+</code>, <code class="literal">-</code>, <code class="literal">*</code>, <code class="literal">/</code>, <code class="literal">~</code> および <code class="literal">%</code>。
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-select-all-records"></a>すべてのレコードの選択</h5></div></div></div><a class="indexterm" name="idm45563242119344"></a><p>
          既存のテーブルからすべてのレコードを返すクエリーを発行するには、検索条件を指定せずに <code class="literal">select()</code> メソッドを使用します。 次の例では、<code class="literal">world_x</code> データベースの city テーブルからすべてのレコードを選択します。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            空の <code class="literal">select()</code> メソッドの使用を対話型のステートメントに制限します。 アプリケーションコードでは、常に明示的なカラム名の選択を使用します。 
          </p></div><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select()</code></strong>
+------+------------+-------------+------------+-------------------------+
| ID   | Name       | CountryCode | District   | Info                    |
+------+------------+-------------+------------+-------------------------+
|    1 | Kabul      | AFG         | Kabol      |{"Population": 1780000}  |
|    2 | Qandahar   | AFG         | Qandahar   |{"Population": 237500}   |
|    3 | Herat      | AFG         | Herat      |{"Population": 186800}   |
...    ...          ...           ...          ...
| 4079 | Rafah      | PSE         | Rafah      |{"Population": 92020}    |
+------+------- ----+-------------+------------+-------------------------+
4082 rows in set (0.01 sec)
</pre><p>
          空のセット (一致するレコードなし) は、次の情報を返します:
        </p><pre class="screen">Empty set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-filter-searches"></a>フィルタ検索</h5></div></div></div><a class="indexterm" name="idm45563242108128"></a><p>
          一連のテーブルのカラムを戻すクエリーを発行するには、<code class="literal">select()</code> メソッドを使用して、角カッコで囲むカラムを指定します。 このクエリーは、city テーブルから Name カラムと CountryCode カラムを返します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"])</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Kabul             | AFG         |
| Qandahar          | AFG         |
| Herat             | AFG         |
| Mazar-e-Sharif    | AFG         |
| Amsterdam         | NLD         |
...                 ...
| Rafah             | PSE         |
| Olympia           | USA         |
| Little Falls      | USA         |
| Happy Valley      | USA         |
+-------------------+-------------+
4082 rows in set (0.00 sec)
</pre><p>
          特定の検索条件に一致する行を返すクエリーを発行するには、<code class="literal">where()</code> メソッドを使用してそれらの条件を含めます。 たとえば、次の例では、文字 Z で始まる都市の名前と国コードを返します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where("Name like 'Z%'")</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Zaanstad          | NLD         |
| Zoetermeer        | NLD         |
| Zwolle            | NLD         |
| Zenica            | BIH         |
| Zagazig           | EGY         |
| Zaragoza          | ESP         |
| Zamboanga         | PHL         |
| Zahedan           | IRN         |
| Zanjan            | IRN         |
| Zabol             | IRN         |
| Zama              | JPN         |
| Zhezqazghan       | KAZ         |
| Zhengzhou         | CHN         |
...                 ...
| Zeleznogorsk      | RUS         |
+-------------------+-------------+
59 rows in set (0.00 sec)
</pre><p>
          <code class="literal">bind()</code> メソッドを使用して、値を検索条件から区切ることができます。 たとえば、条件として「Name =」Z%「」を使用するかわりに、コロンで構成される名前付きプレースホルダの後に、<span class="emphasis"><em>name</em></span> などの文字で始まる名前を付けます。 次に、次のようにプレースホルダと値を <code class="literal">bind()</code> メソッドに含めます: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where(
"Name like :name").bind("name", "Z%")</code></strong>
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">ヒント</div><p>
            プログラム内でバインディングを使用すると、式にプレースホルダを指定できます。プレースホルダには、実行前に値が入力され、必要に応じて自動エスケープを利用できます。
          </p><p>
            入力をサニタイズするには、常にバインディングを使用します。 文字列連結を使用してクエリーに値を導入しないでください。無効な入力が生成され、場合によってはセキュリティの問題が発生することがあります。 
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-project-results"></a>プロジェクト結果</h5></div></div></div><a class="indexterm" name="idm45563242089872"></a><p>
          <code class="literal">AND</code> 演算子を使用してクエリーを発行するには、<code class="literal">where()</code> メソッドの検索条件の間に演算子を追加します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where(
"Name like 'Z%' and CountryCode = 'CHN'")</code></strong>
+----------------+-------------+
| Name           | CountryCode |
+----------------+-------------+
| Zhengzhou      | CHN         |
| Zibo           | CHN         |
| Zhangjiakou    | CHN         |
| Zhuzhou        | CHN         |
| Zhangjiang     | CHN         |
| Zigong         | CHN         |
| Zaozhuang      | CHN         |
...              ...
| Zhangjiagang   | CHN         |
+----------------+-------------+
22 rows in set (0.01 sec)
</pre><p>
          複数の条件演算子を指定するには、検索条件をカッコで囲んで演算子の優先順位を変更します。 次の例は、<code class="literal">AND</code> および <code class="literal">OR</code> 演算子の配置を示しています。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["Name", "CountryCode"]).where(
"Name like 'Z%' and (CountryCode = 'CHN' or CountryCode = 'RUS')")</code></strong>
+-------------------+-------------+
| Name              | CountryCode |
+-------------------+-------------+
| Zhengzhou         | CHN         |
| Zibo              | CHN         |
| Zhangjiakou       | CHN         |
| Zhuzhou           | CHN         |
...                 ...
| Zeleznogorsk      | RUS         |
+-------------------+-------------+
29 rows in set (0.01 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-limit-order-offset-results"></a>制限、順序およびオフセットの結果</h5></div></div></div><a class="indexterm" name="idm45563242077376"></a><p>
          <code class="literal">limit()</code>、<code class="literal">order_by()</code> および <code class="literal">offset()</code> メソッドを適用して、<code class="literal">select()</code> メソッドによって返されるレコードの数と順序を管理できます。
        </p><p>
          結果セットに含まれるレコード数を指定するには、<code class="literal">limit()</code> メソッドに <code class="literal">select()</code> メソッドの値を追加します。 たとえば、次のクエリーでは、国テーブルの最初の 5 つのレコードが返されます。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).limit(5)</code></strong>
+------+-------------+
| Code | Name        |
+------+-------------+
| ABW  | Aruba       |
| AFG  | Afghanistan |
| AGO  | Angola      |
| AIA  | Anguilla    |
| ALB  | Albania     |
+------+-------------+
5 rows in set (0.00 sec)
</pre><p>
          結果の順序を指定するには、<code class="literal">order_by()</code> メソッドを <code class="literal">select()</code> メソッドに追加します。 必要に応じて、降順 (<code class="literal">desc</code>) または昇順 (<code class="literal">asc</code>) 属性でソートするカラムのリストを <code class="literal">order_by()</code> メソッドに渡します。 昇順がデフォルトのオーダータイプです。 
        </p><p>
          たとえば、次のクエリーでは、すべてのレコードが名前カラムでソートされ、最初の 3 つのレコードが降順で返されます。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).order_by(["Name desc"]).limit(3)</code></strong>
+------+------------+
| Code | Name       |
+------+------------+
| ZWE  | Zimbabwe   |
| ZMB  | Zambia     |
| YUG  | Yugoslavia |
+------+------------+
3 rows in set (0.00 sec)
</pre><p>
          デフォルトでは、<code class="literal">limit()</code> メソッドはテーブルの最初のレコードから開始されます。 <code class="literal">offset()</code> メソッドを使用して、開始レコードを変更できます。 たとえば、最初のレコードを無視し、条件に一致する次の 3 つのレコードを返すには、<code class="literal">offset()</code> メソッドに値 1 を渡します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.country.select(["Code", "Name"]).order_by(["Name desc"]).limit(3).offset(1)</code></strong>
+------+------------+
| Code | Name       |
+------+------------+
| ZMB  | Zambia     |
| YUG  | Yugoslavia |
| YEM  | Yemen      |
+------+------------+
3 rows in set (0.00 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242055328"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="functions.html" title="第 12 章 関数と演算子">MySQL Reference Manual</a> には、関数および演算子に関する詳細なドキュメントが用意されています。
            </p></li><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableselectfunction" target="_top">TableSelectFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-table-update"></a>20.4.4.3 テーブルの更新</h4></div></div></div><a class="indexterm" name="idm45563242049184"></a><p>
        <code class="literal">update()</code> メソッドを使用して、テーブル内のレコードを変更できます。 <code class="literal">update()</code> メソッドは、更新するレコードのみを含めるようにクエリーをフィルタリングし、指定した操作をそれらのレコードに適用することで機能します。 
      </p><p>
        市区町村テーブルの市区町村名を置換するには、<code class="literal">set()</code> メソッドに新しい市区町村名を渡します。 次に、検索および置換する市区町村名を <code class="literal">where()</code> メソッドに渡します。 次の例では、Peking 市を Beijing に置き換えます。 
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.update().set("Name", "Beijing").where("Name = 'Peking'")</code></strong>
</pre><p>
        <code class="literal">select()</code> メソッドを使用して変更を確認します。
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["ID", "Name", "CountryCode", "District", "Info"]).where("Name = 'Beijing'")</code></strong>
+------+-----------+-------------+----------+-----------------------------+
| ID   | Name      | CountryCode | District | Info                        |
+------+-----------+-------------+----------+-----------------------------+
| 1891 | Beijing   | CHN         | Peking   | {"Population": 7472000}     |
+------+-----------+-------------+----------+-----------------------------+
1 row in set (0.00 sec)
</pre><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242037520"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tableupdatefunction" target="_top">TableUpdateFunction</a> を参照してください。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-table-delete"></a>20.4.4.4 テーブルの削除</h4></div></div></div><p>
        <code class="literal">delete()</code> メソッドを使用して、データベース内のテーブルから一部またはすべてのレコードを削除できます。 X DevAPI には、削除するレコードをフィルタおよび順序付けするために <code class="literal">delete()</code> メソッドとともに使用する追加のメソッドが用意されています。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-delete-records-using-conditions"></a>条件を使用したレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242029456"></a><p>
          次の例では、検索条件を <code class="literal">delete()</code> メソッドに渡します。 条件に一致するすべてのレコードが <code class="literal">city</code> テーブルから削除されます。 この例では、1 つのレコードが条件に一致します。 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.delete().where("Name = 'Olympia'")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-delete-first-record"></a>最初のレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242022176"></a><p>
          市区町村テーブルの最初のレコードを削除するには、値が 1 の <code class="literal">limit()</code> メソッドを使用します。
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.delete().limit(1)</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-delete-all-records"></a>テーブル内のすべてのレコードの削除</h5></div></div></div><a class="indexterm" name="idm45563242015904"></a><p>
          テーブル内のすべてのレコードを削除できます。 これを行うには、検索条件を指定せずに <code class="literal">delete()</code> メソッドを使用します。 
        </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            検索条件を指定せずにレコードを削除する場合は注意が必要です。削除すると、テーブルからすべてのレコードが削除されます。
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="mysql-shell-tutorial-python-drop-table"></a>テーブルの削除</h5></div></div></div><a class="indexterm" name="idm45563242009984"></a><p>
          <code class="literal">drop_collection()</code> メソッドは、データベースからリレーショナルテーブルを削除するために MySQL Shell でも使用されます。 たとえば、<code class="literal">world_x</code> データベースから <code class="literal">citytest</code> テーブルを削除するには、次のように発行します: 
        </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.drop_collection("citytest")</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="idm45563242003344"></a>関連情報</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完全な構文の定義は、<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/crud-ebnf-table-crud-functions.html#crud-ebnf-tabledeletefunction" target="_top">TableDeleteFunction</a> を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">world_x</code> データベースを再作成する手順は、<a class="xref" href="document-store.html#mysql-shell-tutorial-python-download" title="20.4.2 world_x データベースのダウンロードおよびインポート">セクション20.4.2「world_x データベースのダウンロードおよびインポート」</a> を参照してください。
            </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-shell-tutorial-python-documents-in-tables"></a>20.4.5 テーブル内のドキュメント</h3></div></div></div><a class="indexterm" name="idm45563241996480"></a><p>
      MySQL では、テーブルに従来のリレーショナルデータまたは JSON 値 (あるいはその両方) が含まれる場合があります。 ネイティブ <code class="literal">JSON</code> データ型を持つカラムにドキュメントを格納することで、従来のデータを JSON ドキュメントと組み合せることができます。 
    </p><p>
      このセクションの例では、<code class="literal">world_x</code> スキーマの city テーブルを使用します。
    </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563241991248"></a>市区町村テーブル摘要</h4></div></div></div><p>
        city テーブルには、5 つのカラム (またはフィールド) があります。
      </p><pre class="screen">+---------------+------------+-------+-------+---------+------------------+
| Field         | Type       | Null  | Key   | Default | Extra            |
+---------------+------------+-------+-------+---------+------------------+
| ID            | int(11)    | NO    | PRI   | null    | auto_increment   |
| Name          | char(35)   | NO    |       |         |                  |
| CountryCode   | char(3)    | NO    |       |         |                  |
| District      | char(20)   | NO    |       |         |                  |
| Info          | json       | YES   |       | null    |                  |
+---------------+------------+-------+-------+---------+------------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-insert-record"></a>レコードの挿入</h4></div></div></div><a class="indexterm" name="idm45563241987184"></a><p>
        テーブルのカラムにドキュメントを挿入するには、正しい順序で整形式の JSON ドキュメントを <code class="literal">values()</code> メソッドに渡します。 次の例では、情報カラムに挿入される最終値としてドキュメントが渡されます。 
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.insert().values(
None, "San Francisco", "USA", "California", '{"Population":830000}')</code></strong>
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-shell-tutorial-python-select-record"></a>レコードの選択</h4></div></div></div><a class="indexterm" name="idm45563241980608"></a><p>
        式のドキュメント値を評価する検索条件を指定してクエリーを発行できます。
      </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.city.select(["ID", "Name", "CountryCode", "District", "Info"]).where(
"CountryCode = :country and Info-&gt;'$.Population' &gt; 1000000").bind(
'country', 'USA')</code></strong>
+------+----------------+-------------+----------------+-----------------------------+
| ID   | Name           | CountryCode | District       | Info                        |
+------+----------------+-------------+----------------+-----------------------------+
| 3793 | New York       | USA         | New York       | {"Population": 8008278}     |
| 3794 | Los Angeles    | USA         | California     | {"Population": 3694820}     |
| 3795 | Chicago        | USA         | Illinois       | {"Population": 2896016}     |
| 3796 | Houston        | USA         | Texas          | {"Population": 1953631}     |
| 3797 | Philadelphia   | USA         | Pennsylvania   | {"Population": 1517550}     |
| 3798 | Phoenix        | USA         | Arizona        | {"Population": 1321045}     |
| 3799 | San Diego      | USA         | California     | {"Population": 1223400}     |
| 3800 | Dallas         | USA         | Texas          | {"Population": 1188580}     |
| 3801 | San Antonio    | USA         | Texas          | {"Population": 1144646}     |
+------+----------------+-------------+----------------+-----------------------------+
9 rows in set (0.01 sec)
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="idm45563241975008"></a>関連情報</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            詳しくは<a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/devapi-users-working-with-relational-tables-and-documents.html" target="_top">Working with Relational Tables and Documents</a>をご覧ください。
          </p></li><li class="listitem"><p>
            データ型の詳細は、<a class="xref" href="data-types.html#json" title="11.5 JSON データ型">セクション11.5「JSON データ型」</a> を参照してください。
          </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="x-plugin"></a>20.5 X プラグイン</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#x-plugin-checking-installation">20.5.1 X プラグイン のインストールの確認</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-disabling">20.5.2 X プラグイン の無効化</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-encrypted-connections">20.5.3 X プラグイン での暗号化接続の使用</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-sha2-cache-plugin">20.5.4 Caching SHA-2 認証プラグインでの X プラグイン の使用</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-connection-compression">20.5.5 X プラグイン での接続圧縮</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-options-variables">20.5.6 X プラグイン のオプションおよび変数</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-system-monitoring">20.5.7 X プラグイン の監視</a></span></dt></dl></div><a class="indexterm" name="idm45563241969120"></a><p>
    このセクションでは、X プラグイン を使用、構成および監視する方法について説明します。
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-checking-installation"></a>20.5.1 X プラグイン のインストールの確認</h3></div></div></div><p>
      X プラグイン は MySQL 8 ではデフォルトで有効になっているため、MySQL 8 をインストールまたはアップグレードするとプラグインが使用可能になります。 X プラグイン が MySQL サーバーのインスタンスにインストールされていることを確認するには、<code class="literal">SHOW plugins</code> ステートメントを使用してプラグインリストを表示します。 
    </p><p>
      MySQL Shell を使用して X プラグイン がインストールされていることを確認するには、次のコマンドを発行します:
    </p><pre class="programlisting">shell&gt; mysqlsh -u <em class="replaceable"><code>user</code></em> --sqlc -P 3306 -e "SHOW plugins"
</pre><p>
      MySQL Client を使用して X プラグイン がインストールされていることを確認するには、次のコマンドを発行します:
    </p><pre class="programlisting">shell&gt; mysql -u <em class="replaceable"><code>user</code></em> -p -e "SHOW plugins"
</pre><p>
      X プラグイン がインストールされている場合の結果の例を次に示します:
    </p><pre class="programlisting">+----------------------------+----------+--------------------+---------+---------+
| Name                       | Status   | Type               | Library | License |
+----------------------------+----------+--------------------+---------+---------+

...


| mysqlx                     | ACTIVE   | DAEMON             | NULL    | GPL     |

...

+----------------------------+----------+--------------------+---------+---------+
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-disabling"></a>20.5.2 X プラグイン の無効化</h3></div></div></div><p>
      起動時に X プラグイン を無効にするには、MySQL 構成ファイルで <code class="option">mysqlx=0</code> を設定するか、MySQL サーバーの起動時に <code class="option">--mysqlx=0</code> または <code class="option">--skip-mysqlx</code> を渡します。
    </p><p>
      または、<code class="option">-DWITH_MYSQLX=OFF</code> CMake オプションを使用して、X プラグイン なしで MySQL Server をコンパイルします。
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-encrypted-connections"></a>20.5.3 X プラグイン での暗号化接続の使用</h3></div></div></div><p>
      このセクションでは、暗号化された接続を使用するように X プラグイン を構成する方法について説明します。 背景情報の詳細は、<a class="xref" href="security.html#encrypted-connections" title="6.3 暗号化された接続の使用">セクション6.3「暗号化された接続の使用」</a> を参照してください。 
    </p><p>
      暗号化された接続の構成サポートを有効にするために、X プラグイン には、MySQL Server で使用される <code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数とは異なる値を持つことができる <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数があります。 たとえば、X プラグイン には、MySQL Server で使用されるファイルとは異なる SSL キー、証明書および認証局ファイルを含めることができます。 これらの変数については、<a class="xref" href="document-store.html#x-plugin-options-system-variables" title="20.5.6.2 X プラグイン のオプションとシステム変数">セクション20.5.6.2「X プラグイン のオプションとシステム変数」</a> を参照してください。 同様に、X プラグイン には、MySQL Server encrypted-connection <code class="literal">Ssl_<em class="replaceable"><code>xxx</code></em></code> ステータス変数に対応する独自の <code class="literal">Mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> ステータス変数があります。 <a class="xref" href="document-store.html#x-plugin-status-variables" title="20.5.6.3 X プラグイン ステータス変数">セクション20.5.6.3「X プラグイン ステータス変数」</a>を参照してください。 
    </p><p>
      初期化時に、X プラグイン は暗号化された接続の TLS コンテキストを次のように決定します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          すべての <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数にデフォルト値がある場合、X プラグイン は、<code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数の値によって決定される MySQL Server メイン接続インタフェースと同じ TLS コンテキストを使用します。
        </p></li><li class="listitem"><p>
          いずれかの <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> 変数にデフォルト以外の値がある場合、X プラグイン は独自のシステム変数の値で定義された TLS コンテキストを使用します。 (これは、<code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数がデフォルトとは異なる値に設定されている場合です。) 
        </p></li></ul></div><p>
      つまり、X プラグイン が有効になっているサーバーでは、<code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> 変数のみを設定して MySQL プロトコルと X プロトコル 接続で同じ暗号化構成を共有するか、<code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> 変数と <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> 変数を個別に構成して MySQL プロトコルと X プロトコル 接続の暗号化構成を個別に共有するかを選択できます。
    </p><p>
      MySQL プロトコルと X プロトコル 接続で同じ暗号化構成を使用するには、<code class="filename">my.cnf</code> で <code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数のみを設定します:
    </p><pre class="programlisting">[mysqld]
ssl_ca=ca.pem
ssl_cert=server-cert.pem
ssl_key=server-key.pem
</pre><p>
      MySQL プロトコルと X プロトコル 接続の暗号化を個別に構成するには、<code class="filename">my.cnf</code> で <code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> と <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> の両方のシステム変数を設定します:
    </p><pre class="programlisting">[mysqld]
ssl_ca=ca1.pem
ssl_cert=server-cert1.pem
ssl_key=server-key1.pem

mysqlx_ssl_ca=ca2.pem
mysqlx_ssl_cert=server-cert2.pem
mysqlx_ssl_key=server-key2.pem
</pre><p>
      connection-encryption サポートの構成に関する一般情報は、<a class="xref" href="security.html#using-encrypted-connections" title="6.3.1 暗号化接続を使用するための MySQL の構成">セクション6.3.1「暗号化接続を使用するための MySQL の構成」</a> を参照してください。 この説明は MySQL Server 用に記述されていますが、パラメータ名は X プラグイン 用に似ています。 ( X プラグイン <code class="literal">mysqlx_ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数名は、MySQL Server <code class="literal">ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数名に対応します。) 
    </p><p>
      MySQL プロトコル接続に許可される TLS バージョンを決定する <code class="literal">tls_version</code> システム変数は、X プロトコル 接続にも適用されます。 したがって、両方のタイプの接続で許可される TLS バージョンは同じです。 
    </p><p>
      接続ごとの暗号化はオプションですが、特定のユーザーは、ユーザーを作成する <code class="literal">CREATE USER</code> ステートメントに適切な <code class="literal">REQUIRE</code> 句を含めることで、X プロトコル および MySQL プロトコル接続に暗号化を使用する必要があります。 詳細は、<a class="xref" href="sql-statements.html#create-user" title="13.7.1.3 CREATE USER ステートメント">セクション13.7.1.3「CREATE USER ステートメント」</a>を参照してください。 または、すべてのユーザーに X プロトコル および MySQL プロトコル接続の暗号化の使用を要求するには、<code class="literal">require_secure_transport</code> システム変数を有効にします。 追加情報については <a class="xref" href="security.html#mandatory-encrypted-connections" title="暗号化された接続の必須としての構成">暗号化された接続の必須としての構成</a>を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-sha2-cache-plugin"></a>20.5.4 Caching SHA-2 認証プラグインでの X プラグイン の使用</h3></div></div></div><p>
      X プラグイン は、<code class="literal">caching_sha2_password</code> 認証プラグインで作成された MySQL ユーザーアカウントをサポートしています。 このプラグインの詳細は、<a class="xref" href="security.html#caching-sha2-pluggable-authentication" title="6.4.1.2 SHA-2 プラガブル認証のキャッシュ">セクション6.4.1.2「SHA-2 プラガブル認証のキャッシュ」</a> を参照してください。 X プラグイン を使用すると、<code class="literal">SHA256_MEMORY</code> 認証で非 SSL 接続を使用し、<code class="literal">PLAIN</code> 認証で SSL 接続を使用して、このようなアカウントに対して認証できます。 
    </p><p>
      <code class="literal">caching_sha2_password</code> 認証プラグインは認証キャッシュを保持しますが、このキャッシュは X プラグイン と共有されないため、X プラグイン は <code class="literal">SHA256_MEMORY</code> 認証に独自の認証キャッシュを使用します。 X プラグイン 認証キャッシュにはユーザーアカウントパスワードのハッシュが格納され、SQL を使用してアクセスできません。 ユーザーアカウントが変更または削除されると、関連するエントリがキャッシュから削除されます。 X プラグイン 認証キャッシュは、デフォルトで有効になっている <code class="literal">mysqlx_cache_cleaner</code> プラグインによって保持され、関連するシステム変数またはステータス変数はありません。 
    </p><p>
      非 SSL X プロトコル 接続を使用して <code class="literal">caching_sha2_password</code> 認証プラグインを使用するアカウントを認証するには、X プラグイン 認証キャッシュにパスワードを指定するために、そのアカウントが SSL を使用した X プロトコル 接続を介して少なくとも一度認証されている必要があります。 SSL 経由のこの初期認証が成功すると、非 SSL X プロトコル 接続を使用できます。 
    </p><p>
      オプション <code class="literal">--mysqlx_cache_cleaner=0</code> を指定して MySQL サーバーを起動すると、<code class="literal">mysqlx_cache_cleaner</code> プラグインを無効にできます。 これを行うと、X プラグイン 認証キャッシュが無効になるため、<code class="literal">SHA256_MEMORY</code> 認証を使用した認証時には常に SSL を X プロトコル 接続に使用する必要があります。 
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-connection-compression"></a>20.5.5 X プラグイン での接続圧縮</h3></div></div></div><a class="indexterm" name="idm45563241895360"></a><a class="indexterm" name="idm45563241893232"></a><p>
      MySQL 8.0.19 から、X プラグイン は X プロトコル 接続を介して送信されるメッセージの圧縮をサポートします。 サーバーとクライアントが相互にサポートされている圧縮アルゴリズムに同意する場合、接続を圧縮できます。 圧縮を有効にすると、ネットワーク経由で送信されるバイト数が削減されますが、圧縮および解凍操作のための CPU コストがサーバーおよびクライアントに追加されます。 したがって、圧縮の利点は、主にネットワーク帯域幅が低く、ネットワーク転送時間が圧縮および解凍操作のコストを支配し、結果セットが大きい場合に発生します。 
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        MySQL クライアントによって、接続圧縮のサポートが異なる方法で実装されます。詳細は、クライアントのドキュメントを参照してください。 たとえば、クラシック MySQL プロトコル 接続の場合は、<a class="xref" href="programs.html#connection-compression-control" title="4.2.8 接続圧縮制御">セクション4.2.8「接続圧縮制御」</a> を参照してください。 
      </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="document-store.html#x-plugin-connection-compression-configuration" title="X プラグイン の接続圧縮の構成">X プラグイン の接続圧縮の構成</a></p></li><li class="listitem"><p><a class="xref" href="document-store.html#x-plugin-connection-compression-characteristics" title="X プラグイン の圧縮接続特性">X プラグイン の圧縮接続特性</a></p></li><li class="listitem"><p><a class="xref" href="document-store.html#x-plugin-connection-compression-monitoring" title="X プラグイン の接続圧縮の監視">X プラグイン の接続圧縮の監視</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-connection-compression-configuration"></a>X プラグイン の接続圧縮の構成</h4></div></div></div><p>
        デフォルトでは、X プラグイン は zstd、LZ4 および Deflate 圧縮アルゴリズムをサポートしています。 Deflate アルゴリズムを使用した圧縮は zlib ソフトウェアライブラリを使用して実行されるため、X プロトコル 接続の <code class="literal">deflate_stream</code> 圧縮アルゴリズム設定は クラシック MySQL プロトコル 接続の <code class="literal">zlib</code> 設定と同等です。 
      </p><p>
        サーバー側では、<code class="literal">mysqlx_compression_algorithms</code> システム変数に許可された圧縮アルゴリズムのみを含めるように設定することで、圧縮アルゴリズムを禁止できます。 アルゴリズム名 <code class="literal">zstd_stream</code>、<code class="literal">lz4_message</code> および <code class="literal">deflate_stream</code> は任意の組合せで指定でき、順序と大文字と小文字は重要ではありません。 システム変数値が空の文字列の場合、圧縮アルゴリズムは許可されず、接続は圧縮解除されます。 
      </p><p>
        次のテーブルでは、様々な圧縮アルゴリズムの特性を比較し、割り当てられた優先度を示します。 デフォルトでは、サーバーとクライアントで共通に許可されているもっとも優先度の高いアルゴリズムがサーバーによって選択されます。クライアントはあとで説明するように優先順位を変更できます。 アルゴリズムの短い形式のエイリアスは、指定時にクライアントで使用できます。 
      </p><div class="table"><a name="x-plugin-connection-compression-algorithms"></a><p class="title"><b>表 20.1 X プロトコル 圧縮アルゴリズムの特性</b></p><div class="table-contents"><table frame="void"><col style="width: 18%" align="center"><col style="width: 14%" align="center"><col style="width: 18%" align="center"><col style="width: 17%" align="center"><col style="width: 16%" align="center"><col style="width: 16%" align="center"><thead><tr>
            <th scope="col">アルゴリズム</th>
            <th scope="col">エイリアス</th>
            <th scope="col">圧縮率</th>
            <th scope="col">スループット</th>
            <th scope="col">CPU コスト</th>
            <th scope="col">デフォルト優先度</th>
          </tr></thead><tbody><tr>
            <th scope="row"><code class="literal">zsth_stream</code></th>
            <td><code class="literal">zstd</code></td>
            <td>高</td>
            <td>高</td>
            <td>中</td>
            <td>First</td>
          </tr><tr>
            <th scope="row"><code class="literal">lz4_message</code></th>
            <td><code class="literal">lz4</code></td>
            <td>低</td>
            <td>高</td>
            <td>最低</td>
            <td>秒</td>
          </tr><tr>
            <th scope="row"><code class="literal">deflate_stream</code></th>
            <td><code class="literal">deflate</code></td>
            <td>高</td>
            <td>低</td>
            <td>最高</td>
            <td>Third</td>
          </tr></tbody></table></div></div><br class="table-break"><p>
        許可される圧縮アルゴリズムの X プロトコル セット (ユーザー指定かデフォルトかに関係なく) は、<code class="literal">protocol_compression_algorithms</code> サーバーシステム変数で指定される クラシック MySQL プロトコル 接続用に MySQL Server で許可される圧縮アルゴリズムのセットとは無関係です。 <code class="literal">mysqlx_compression_algorithms</code> システム変数を指定しない場合、X プラグイン は クラシック MySQL プロトコル 接続の圧縮設定の使用にフォールバックしません。 かわりに、デフォルトでは、<a class="xref" href="document-store.html#x-plugin-connection-compression-algorithms" title="表 20.1 X プロトコル 圧縮アルゴリズムの特性">表20.1「X プロトコル 圧縮アルゴリズムの特性」</a> に表示されているすべてのアルゴリズムが許可されます。 これは、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> で説明されているように、X プラグイン システム変数が設定されていない場合に MySQL Server 設定が使用される TLS コンテキストの状況とは異なります。 クラシック MySQL プロトコル 接続の圧縮の詳細は、<a class="xref" href="programs.html#connection-compression-control" title="4.2.8 接続圧縮制御">セクション4.2.8「接続圧縮制御」</a> を参照してください。 
      </p><p>
        クライアント側では、X プロトコル 接続リクエストで圧縮制御用に複数のパラメータを指定できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            圧縮モード。
          </p></li><li class="listitem"><p>
            圧縮レベル (MySQL 8.0.20)。
          </p></li><li class="listitem"><p>
            許可されている圧縮アルゴリズムの優先度順のリスト (MySQL 8.0.22)。
          </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          一部のクライアントまたはコネクタでは、特定の圧縮制御機能がサポートされていない場合があります。 たとえば、X プロトコル 接続の圧縮レベルの指定は MySQL Shell でのみサポートされ、他の MySQL クライアントやコネクタではサポートされません。 サポートされる機能およびその使用方法の詳細は、特定の製品のドキュメントを参照してください。 
        </p></div><p>
        接続モードには、次の値があります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">disabled</code>: 接続が圧縮解除されます。
          </p></li><li class="listitem"><p>
            <code class="literal">preferred</code>: サーバーとクライアントは、両方で許可されている圧縮アルゴリズムを見つけるためにネゴシエーションを行います。 使用可能な共通アルゴリズムがない場合、接続は圧縮解除されます。 これは、明示的に指定されていない場合のデフォルトモードです。 
          </p></li><li class="listitem"><p>
            <code class="literal">required</code>: 圧縮アルゴリズムのネゴシエーションは <code class="literal">preferred</code> モードと同様に行われますが、使用可能な共通アルゴリズムがない場合、接続要求はエラーで終了します。
          </p></li></ul></div><p>
        各接続の圧縮アルゴリズムに同意するだけでなく、サーバーとクライアントは、合意されたアルゴリズムに適用される数値範囲の圧縮レベルに同意できます。 アルゴリズムの圧縮レベルが高くなるにつれて、データ圧縮率が高くなり、クライアントへのメッセージの送信に必要なネットワーク帯域幅と転送時間が短縮されます。 ただし、データ圧縮に必要な労力も増加し、サーバー上の時間と CPU およびメモリーリソースが消費されます。 圧縮作業の増加には、圧縮率の増加と線形関係はありません。 
      </p><p>
        MySQL 8.0.19 では、X プラグイン は常にアルゴリズムごとにライブラリのデフォルトの圧縮レベルを使用し (zstd の場合は 3、LZ4 の場合は 0、Deflate の場合は 6)、クライアントはこれをネゴシエートできません。 MySQL 8.0.20 から、クライアントは X プロトコル 接続のためにサーバーとの機能ネゴシエーション中に特定の圧縮レベルをリクエストできます。 
      </p><p>
        MySQL 8.0.20 の X プラグイン で使用されるデフォルトの圧縮レベルは、圧縮時間とネットワーク転送時間の間のトレードオフとしてパフォーマンステストで選択されています。 これらのデフォルトは、各アルゴリズムのライブラリのデフォルトと必ずしも同じではありません。 これらは、クライアントがアルゴリズムの圧縮レベルをリクエストしない場合に適用されます。 デフォルトの圧縮レベルは、zstd の場合は 3、LZ4 の場合は 2、Deflate の場合は 3 に初期設定されます。 これらの設定は、<code class="literal">mysqlx_zstd_default_compression_level</code>、<code class="literal">mysqlx_lz4_default_compression_level</code> および <code class="literal">mysqlx_deflate_default_compression_level</code> システム変数を使用して調整できます。 
      </p><p>
        サーバーでの過剰なリソース消費を防ぐために、X プラグイン では、サーバーがアルゴリズムごとに許可する最大圧縮レベルを設定します。 クライアントがこの設定を超える圧縮レベルをリクエストした場合、サーバーは最大許容圧縮レベルを使用します (クライアントによる圧縮レベルのリクエストは MySQL Shell でのみサポートされます)。 最大圧縮レベルは、zstd の場合は 11、LZ4 の場合は 8、Deflate の場合は 5 に初期設定されます。 これらの設定は、<code class="literal">mysqlx_zstd_max_client_compression_level</code>、<code class="literal">mysqlx_lz4_max_client_compression_level</code> および <code class="literal">mysqlx_deflate_max_client_compression_level</code> システム変数を使用して調整できます。 
      </p><p>
        サーバーとクライアントで共通のアルゴリズムが複数許可されている場合、ネゴシエーション中にアルゴリズムを選択するためのデフォルトの優先順位が <a class="xref" href="document-store.html#x-plugin-connection-compression-algorithms" title="表 20.1 X プロトコル 圧縮アルゴリズムの特性">表20.1「X プロトコル 圧縮アルゴリズムの特性」</a> に表示されます。 MySQL 8.0.22 から、圧縮アルゴリズムの指定をサポートするクライアントの場合、接続リクエストには、アルゴリズム名またはそのエイリアスを使用して指定された、クライアントで許可されるアルゴリズムのリストを含めることができます。 リスト内のこれらのアルゴリズムの順序は、サーバーによる優先順位とみなされます。 この場合に使用されるアルゴリズムは、サーバー側でも許可されているクライアントリストの最初のアルゴリズムです。 ただし、圧縮アルゴリズムのオプションには圧縮モードが適用されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            圧縮モードが <code class="literal">disabled</code> の場合、圧縮アルゴリズムオプションは無視されます。
          </p></li><li class="listitem"><p>
            圧縮モードが <code class="literal">preferred</code> であるが、クライアント側で許可されているアルゴリズムがサーバー側で許可されていない場合、接続は圧縮解除されます。
          </p></li><li class="listitem"><p>
            圧縮モードが <code class="literal">required</code> であるが、クライアント側で許可されているアルゴリズムがサーバー側で許可されていない場合は、エラーが発生します。
          </p></li></ul></div><p>
        メッセージ圧縮の影響を監視するには、<a class="xref" href="document-store.html#x-plugin-connection-compression-monitoring" title="X プラグイン の接続圧縮の監視">X プラグイン の接続圧縮の監視</a> で説明されている X プラグイン ステータス変数を使用します。 これらのステータス変数を使用して、現在の設定でのメッセージ圧縮の利点を計算し、その情報を使用して設定をチューニングできます。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-connection-compression-characteristics"></a>X プラグイン の圧縮接続特性</h4></div></div></div><p>
        X プロトコル 接続圧縮は、次の動作および境界で動作します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            アルゴリズム名の<code class="literal">_stream</code> および<code class="literal">_message</code> 接尾辞は、2 つの異なる操作モードを参照: ストリームモードでは、単一の接続内のすべての X プロトコル メッセージが連続ストリームに圧縮され、圧縮された順序をスキップせずに圧縮解除する必要があります。 メッセージモードでは、各メッセージは個別に圧縮され、圧縮された順序で解凍する必要はありません。 また、メッセージモードでは、圧縮されたすべてのメッセージを解凍する必要はありません。 
          </p></li><li class="listitem"><p>
            圧縮は、認証が成功する前に送信されるメッセージには適用されません。
          </p></li><li class="listitem"><p>
            圧縮は、<code class="literal">Mysqlx.Ok</code>、<code class="literal">Mysqlx.Error</code>、<code class="literal">Mysqlx.Sql.StmtExecuteOk</code> メッセージなどの制御フローメッセージには適用されません。
          </p></li><li class="listitem"><p>
            他のすべての X プロトコル メッセージは、サーバーとクライアントが機能ネゴシエーション中に相互に許可された圧縮アルゴリズムに同意した場合に圧縮できます。 その段階でクライアントが圧縮を要求しない場合、クライアントもサーバーもメッセージに圧縮を適用しません。 
          </p></li><li class="listitem"><p>
            X プロトコル 接続を介して送信されるメッセージが圧縮されても、<code class="literal">mysqlx_max_allowed_packet</code> システム変数で指定された制限が適用されます。 メッセージペイロードが解凍された後、ネットワークパケットはこの制限より小さくする必要があります。 制限を超えると、X プラグイン は解凍エラーを返し、接続を閉じます。 
          </p></li><li class="listitem"><p>
            次の点は、MySQL Shell でのみサポートされているクライアントによる圧縮レベルのリクエストに関連しています:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                圧縮レベルは、クライアントで整数として指定する必要があります。 他のタイプの値が指定された場合、接続はエラーでクローズします。 
              </p></li><li class="listitem"><p>
                クライアントがアルゴリズムを指定し、圧縮レベルを指定しない場合、サーバーはアルゴリズムにデフォルトの圧縮レベルを使用します。
              </p></li><li class="listitem"><p>
                クライアントがサーバーの最大許容レベルを超えるアルゴリズム圧縮レベルをリクエストした場合、サーバーは最大許容レベルを使用します。
              </p></li><li class="listitem"><p>
                クライアントが、サーバーの最小許容レベルより低いアルゴリズム圧縮レベルをリクエストした場合、サーバーは最小許容レベルを使用します。
              </p></li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-connection-compression-monitoring"></a>X プラグイン の接続圧縮の監視</h4></div></div></div><p>
        X プラグイン ステータス変数を使用して、メッセージ圧縮の影響を監視できます。 メッセージ圧縮が使用されている場合、セッション <code class="literal">Mysqlx_compression_algorithm</code> ステータス変数には現在の X プロトコル 接続に使用されている圧縮アルゴリズムが表示され、<code class="literal">Mysqlx_compression_level</code> には選択された圧縮レベルが表示されます。 これらのセッションステータス変数は、MySQL 8.0.20 から使用できます。 
      </p><p>
        MySQL 8.0.19 から、X プラグイン ステータス変数を使用して、選択した圧縮アルゴリズムの効率 (データ圧縮率) およびメッセージ圧縮を使用した全体的な影響を計算できます。 次の計算でステータス変数のセッション値を使用して、既知の圧縮アルゴリズムを使用した特定のセッションに対するメッセージ圧縮の利点を確認します。 または、ステータス変数のグローバル値を使用して、X プロトコル 接続を使用するすべてのセッション (これらのセッションに使用されているすべての圧縮アルゴリズム、およびメッセージ圧縮を使用しなかったすべてのセッションを含む) にわたるサーバーのメッセージ圧縮の全体的な利点を確認します。 その後、<a class="xref" href="document-store.html#x-plugin-connection-compression-configuration" title="X プラグイン の接続圧縮の構成">X プラグイン の接続圧縮の構成</a> で説明されているように、許可されている圧縮アルゴリズム、最大圧縮レベルおよびデフォルトの圧縮レベルを調整して、メッセージ圧縮をチューニングできます。 
      </p><p>
        メッセージ圧縮が使用されている場合、<code class="literal">Mysqlx_bytes_sent</code> ステータス変数には、圧縮後に測定された圧縮メッセージペイロード、圧縮されなかった X プロトコル ヘッダーなどの圧縮メッセージ内のアイテム、および圧縮されていないメッセージを含む、サーバーから送信された合計バイト数が表示されます。 <code class="literal">Mysqlx_bytes_sent_compressed_payload</code> ステータス変数は圧縮されたメッセージペイロードとして送信されたバイトの合計数を示し、<code class="literal">Mysqlx_bytes_sent_uncompressed_frame</code> ステータス変数は圧縮後に測定された同じメッセージペイロードの合計バイト数を示しますが、圧縮前に測定されます。 したがって、圧縮アルゴリズムの効率を示す圧縮率は、次の式を使用して計算できます: 
      </p><pre class="programlisting">mysqlx_bytes_sent_uncompressed_frame / mysqlx_bytes_sent_compressed_payload
</pre><p>
        サーバーから送信される X プロトコル メッセージの圧縮の有効性は、次の式を使用して計算できます:
      </p><pre class="programlisting">(mysqlx_bytes_sent - mysqlx_bytes_sent_compressed_payload + mysqlx_bytes_sent_uncompressed_frame) / mysqlx_bytes_sent
</pre><p>
        サーバーがクライアントから受信したメッセージの場合、<code class="literal">Mysqlx_bytes_received_compressed_payload</code> ステータス変数は圧縮メッセージペイロードとして受信したバイトの合計数を示し、圧縮解除前に測定され、<code class="literal">Mysqlx_bytes_received_uncompressed_frame</code> ステータス変数は同じメッセージペイロードの合計バイト数を示しますが、解凍後に測定されます。 <code class="literal">Mysqlx_bytes_received</code> ステータス変数には、圧縮解除前に測定された圧縮メッセージペイロード、圧縮メッセージ内の圧縮されていないアイテム、および圧縮されていないメッセージが含まれます。 
      </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-options-variables"></a>20.5.6 X プラグイン のオプションおよび変数</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="document-store.html#x-plugin-option-variable-reference">20.5.6.1 X プラグイン オプションおよび変数リファレンス</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-options-system-variables">20.5.6.2 X プラグイン のオプションとシステム変数</a></span></dt><dt><span class="section"><a href="document-store.html#x-plugin-status-variables">20.5.6.3 X プラグイン ステータス変数</a></span></dt></dl></div><p>
      このセクションでは、X プラグイン を構成するコマンドオプションとシステム変数、および監視目的で使用可能なステータス変数について説明します。 起動時に指定された構成値が正しくない場合、X プラグイン は適切に初期化できず、サーバーがロードしません。 この場合、サーバーは他の X プラグイン 設定を認識できないため、エラーメッセージを生成することもできます。 
    </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-option-variable-reference"></a>20.5.6.1 X プラグイン オプションおよび変数リファレンス</h4></div></div></div><p>
        このテーブルは、X プラグイン で提供されるコマンドオプション、システム変数およびステータス変数の概要を示しています。
      </p><div class="table"><a name="idm45563241751312"></a><p class="title"><b>表 20.2 「X プラグイン オプションおよび変数リファレンス」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「X プラグイン のコマンドラインオプション、システム変数およびステータス変数のリファレンス。」"><col style="width: 20%"><col style="width: 15%"><col style="width: 15%"><col style="width: 15%"><col style="width: 15%"><col style="width: 15%"><col style="width: 15%"><thead><tr><th scope="col">名前</th>
<th scope="col">コマンド行</th>
<th scope="col">オプションファイル</th>
<th scope="col">システム変数</th>
<th scope="col">ステータス変数</th>
<th scope="col">変数スコープ</th>
<th scope="col">動的</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="document-store.html#option_mysqld_mysqlx">mysqlx</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_aborted_clients">Mysqlx_aborted_clients</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_address">Mysqlx_address</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_bind_address">mysqlx_bind_address</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_received">Mysqlx_bytes_received</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_received_compressed_payload">Mysqlx_bytes_received_compressed_payload</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_received_uncompressed_frame">Mysqlx_bytes_received_uncompressed_frame</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_sent">Mysqlx_bytes_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_sent_compressed_payload">Mysqlx_bytes_sent_compressed_payload</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_bytes_sent_uncompressed_frame">Mysqlx_bytes_sent_uncompressed_frame</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_compression_algorithm">Mysqlx_compression_algorithm</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>セッション</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_compression_algorithms">mysqlx_compression_algorithms</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_compression_level">Mysqlx_compression_level</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>セッション</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_connect_timeout">mysqlx_connect_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_connection_accept_errors">Mysqlx_connection_accept_errors</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_connection_errors">Mysqlx_connection_errors</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_connections_accepted">Mysqlx_connections_accepted</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_connections_closed">Mysqlx_connections_closed</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_connections_rejected">Mysqlx_connections_rejected</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_create_view">Mysqlx_crud_create_view</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_delete">Mysqlx_crud_delete</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_drop_view">Mysqlx_crud_drop_view</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_find">Mysqlx_crud_find</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_insert">Mysqlx_crud_insert</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_modify_view">Mysqlx_crud_modify_view</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_crud_update">Mysqlx_crud_update</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_deflate_default_compression_level">mysqlx_deflate_default_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_deflate_max_client_compression_level">mysqlx_deflate_max_client_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_document_id_unique_prefix">mysqlx_document_id_unique_prefix</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_enable_hello_notice">mysqlx_enable_hello_notice</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_errors_sent">Mysqlx_errors_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row">Mysqlx_errors_unknown_message_type</th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_expect_close">Mysqlx_expect_close</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_expect_open">Mysqlx_expect_open</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_idle_worker_thread_timeout">mysqlx_idle_worker_thread_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_init_error">Mysqlx_init_error</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_interactive_timeout">mysqlx_interactive_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_lz4_default_compression_level">mysqlx_lz4_default_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_lz4_max_client_compression_level">mysqlx_lz4_max_client_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_max_allowed_packet">mysqlx_max_allowed_packet</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_max_connections">mysqlx_max_connections</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_messages_sent">Mysqlx_messages_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_min_worker_threads">mysqlx_min_worker_threads</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_notice_global_sent">Mysqlx_notice_global_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_notice_other_sent">Mysqlx_notice_other_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_notice_warning_sent">Mysqlx_notice_warning_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_notified_by_group_replication">Mysqlx_notified_by_group_replication</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_port">Mysqlx_port</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_port">mysqlx_port</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_port_open_timeout">mysqlx_port_open_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_read_timeout">mysqlx_read_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>セッション</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_rows_sent">Mysqlx_rows_sent</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions">Mysqlx_sessions</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions_accepted">Mysqlx_sessions_accepted</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions_closed">Mysqlx_sessions_closed</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions_fatal_error">Mysqlx_sessions_fatal_error</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions_killed">Mysqlx_sessions_killed</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_sessions_rejected">Mysqlx_sessions_rejected</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_socket">Mysqlx_socket</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_socket">mysqlx_socket</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_accept_renegotiates">Mysqlx_ssl_accept_renegotiates</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_accepts">Mysqlx_ssl_accepts</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_active">Mysqlx_ssl_active</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_ca">mysqlx_ssl_ca</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_capath">mysqlx_ssl_capath</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_cert">mysqlx_ssl_cert</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_cipher">Mysqlx_ssl_cipher</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_cipher">mysqlx_ssl_cipher</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_cipher_list">Mysqlx_ssl_cipher_list</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_crl">mysqlx_ssl_crl</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_crlpath">mysqlx_ssl_crlpath</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_ctx_verify_depth">Mysqlx_ssl_ctx_verify_depth</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_ctx_verify_mode">Mysqlx_ssl_ctx_verify_mode</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_finished_accepts">Mysqlx_ssl_finished_accepts</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_key">mysqlx_ssl_key</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_server_not_after">Mysqlx_ssl_server_not_after</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_server_not_before">Mysqlx_ssl_server_not_before</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_verify_depth">Mysqlx_ssl_verify_depth</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_verify_mode">Mysqlx_ssl_verify_mode</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_ssl_version">Mysqlx_ssl_version</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_create_collection">Mysqlx_stmt_create_collection</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_create_collection_index">Mysqlx_stmt_create_collection_index</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_disable_notices">Mysqlx_stmt_disable_notices</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_drop_collection">Mysqlx_stmt_drop_collection</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_drop_collection_index">Mysqlx_stmt_drop_collection_index</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_enable_notices">Mysqlx_stmt_enable_notices</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_ensure_collection">Mysqlx_stmt_ensure_collection</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_execute_mysqlx">Mysqlx_stmt_execute_mysqlx</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_execute_sql">Mysqlx_stmt_execute_sql</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_execute_xplugin">Mysqlx_stmt_execute_xplugin</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_get_collection_options">Mysqlx_stmt_get_collection_options</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_kill_client">Mysqlx_stmt_kill_client</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_list_clients">Mysqlx_stmt_list_clients</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_list_notices">Mysqlx_stmt_list_notices</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_list_objects">Mysqlx_stmt_list_objects</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_modify_collection_options">Mysqlx_stmt_modify_collection_options</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_stmt_ping">Mysqlx_stmt_ping</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>両方</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_wait_timeout">mysqlx_wait_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>セッション</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_worker_threads">Mysqlx_worker_threads</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#statvar_Mysqlx_worker_threads_active">Mysqlx_worker_threads_active</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_write_timeout">mysqlx_write_timeout</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>セッション</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_zstd_default_compression_level">mysqlx_zstd_default_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr><tr><th scope="row"><a class="link" href="document-store.html#sysvar_mysqlx_zstd_max_client_compression_level">mysqlx_zstd_max_client_compression_level</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>はい</td>
</tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-options-system-variables"></a>20.5.6.2 X プラグイン のオプションとシステム変数</h4></div></div></div><p>
        X プラグイン のアクティブ化を制御するには、このオプションを使用します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_mysqlx"></a>
            <code class="option">--mysqlx[=value]</code>
          </p><a class="indexterm" name="idm45563241017808"></a><a class="indexterm" name="idm45563241016256"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx[=value]</code></td>
</tr><tr><th>型</th>
<td>列挙</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">ON</code></td>
</tr><tr><th>有効な値</th>
<td><p class="valid-value"><code class="literal">ON</code></p><p class="valid-value"><code class="literal">OFF</code></p><p class="valid-value"><code class="literal">FORCE</code></p><p class="valid-value"><code class="literal">FORCE_PLUS_PERMANENT</code></p></td>
</tr></tbody></table></div><p>
            このオプションは、起動時にサーバーが X プラグイン をロードする方法を制御します。 MySQL 8.0 では、X プラグイン はデフォルトで有効になっていますが、このオプションを使用してアクティブ化状態を制御できます。 
          </p><p>
            <a class="xref" href="server-administration.html#plugin-loading" title="5.6.1 プラグインのインストールおよびアンインストール">セクション5.6.1「プラグインのインストールおよびアンインストール」</a>で説明したように、オプションの値は、プラグインのロードオプションに指定可能な値のいずれかである必要があります。
          </p></li></ul></div><p>
        X プラグイン が有効になっている場合、操作を制御できるいくつかのシステム変数が公開されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="sysvar_mysqlx_bind_address"></a>
            <code class="literal">mysqlx_bind_address</code>
          </p><a class="indexterm" name="idm45563240993120"></a><a class="indexterm" name="idm45563240991568"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_bind_address"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-bind-address=addr</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_bind_address">mysqlx_bind_address</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>文字列</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">*</code></td>
</tr></tbody></table></div><p>
            X プラグイン が TCP/IP 接続をリスニングするネットワークアドレス。 この変数は動的ではなく、起動時にのみ構成できます。 これは <code class="literal">bind_address</code> システム変数と同等の X プラグイン です。詳細は、その変数の説明を参照してください。 
          </p><p>
            デフォルトでは、X プラグイン は、すべてのサーバーホスト IPv4 インタフェースで TCP/IP 接続を受け入れ、サーバーホストが IPv6 をサポートしている場合は、すべての IPv6 インタフェースで TCP/IP 接続を受け入れます。 <code class="literal">mysqlx_bind_address</code> が指定されている場合、その値は次の要件を満たす必要があります: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                MySQL 8.0.21 より前では、<code class="literal">mysqlx_bind_address</code> は、単一の非ワイルドカード IP アドレス (IPv4 または IPv6)、ホスト名、または複数のネットワークインタフェースでのリスニングを許可するワイルドカードアドレス形式 (<code class="literal">*</code>、<code class="literal">0.0.0.0</code> または<code class="literal">::</code>) を受け入れます。
              </p></li><li class="listitem"><p>
                MySQL 8.0.21 では、<code class="literal">mysqlx_bind_address</code> は前述の単一の値またはカンマ区切り値のリストを受け入れます。 変数が複数の値のリストを指定する場合、各値は単一のワイルドカード以外の IP アドレス (IPv4 または IPv6) またはホスト名を指定する必要があります。 ワイルドカードアドレス書式 (<code class="literal">*</code>、<code class="literal">0.0.0.0</code> または<code class="literal">::</code>) は、値リストでは使用できません。 
              </p></li><li class="listitem"><p>
                MySQL 8.0.22 の時点では、値にネットワークネームスペース指定子が含まれる場合があります。
              </p></li></ul></div><p>
            IP アドレスは、IPv4 または IPv6 アドレスとして指定できます。 ホスト名である値の場合、X プラグイン は名前を IP アドレスに解決し、そのアドレスにバインドします。 ホスト名が複数の IP アドレスに解決される場合、X プラグイン は最初の IPv4 アドレス (存在する場合) または最初の IPv6 アドレスを使用します。 
          </p><p>
            X プラグイン では、様々なタイプのアドレスが次のように扱われます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                アドレスが <code class="literal">*</code> の場合、X プラグイン はすべてのサーバーホスト IPv4 インタフェースで TCP/IP 接続を受け入れ、サーバーホストが IPv6 をサポートしている場合は、すべての IPv6 インタフェースで TCP/IP 接続を受け入れます。 このアドレスを使用して、X プラグイン の IPv4 接続と IPv6 接続の両方を許可します。 この値がデフォルトです。 変数で複数の値のリストが指定されている場合、この値は許可されません。 
              </p></li><li class="listitem"><p>
                アドレスが <code class="literal">0.0.0.0</code> の場合、X プラグイン はすべてのサーバーホスト IPv4 インタフェースで TCP/IP 接続を受け入れます。 変数で複数の値のリストが指定されている場合、この値は許可されません。 
              </p></li><li class="listitem"><p>
                アドレスが<code class="literal">::</code>の場合、X プラグイン はすべてのサーバーホスト IPv4 および IPv6 インタフェースで TCP/IP 接続を受け入れます。 変数で複数の値のリストが指定されている場合、この値は許可されません。 
              </p></li><li class="listitem"><p>
                アドレスが IPv4 マップアドレスの場合、X プラグイン はそのアドレスの TCP/IP 接続を IPv4 または IPv6 形式で受け入れます。 たとえば、X プラグイン が<code class="literal">::ffff:127.0.0.1</code> にバインドされている場合、MySQL Shell などのクライアントは <code class="option">--host=127.0.0.1</code> または <code class="option">--host=::ffff:127.0.0.1</code> を使用して接続できます。 
              </p></li><li class="listitem"><p>
                アドレスが <span class="quote">「<span class="quote">regular</span>」</span> IPv4 アドレスまたは IPv6 アドレス (<code class="literal">127.0.0.1</code>、<code class="literal">::1</code> など) の場合、X プラグイン はその IPv4 アドレスまたは IPv6 アドレスに対してのみ TCP/IP 接続を受け入れます。
              </p></li></ul></div><p>
            アドレスのネットワークネームスペースの指定には、次のルールが適用されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                ネットワークネームスペースは、IP アドレスまたはホスト名に指定できます。
              </p></li><li class="listitem"><p>
                ワイルドカード IP アドレスにはネットワークネームスペースを指定できません。
              </p></li><li class="listitem"><p>
                指定されたアドレスでは、ネットワーク名前空間はオプションです。 指定する場合は、アドレスの直後に<code class="literal">/<em class="replaceable"><code>ns</code></em></code> 接尾辞として指定する必要があります。 
              </p></li><li class="listitem"><p>
                <code class="literal">/<em class="replaceable"><code>ns</code></em></code> 接尾辞のないアドレスは、ホストシステムのグローバルネームスペースを使用します。 したがって、グローバルネームスペースがデフォルトです。 
              </p></li><li class="listitem"><p>
                <code class="literal">/<em class="replaceable"><code>ns</code></em></code> 接尾辞の付いたアドレスは、<em class="replaceable"><code>ns</code></em> という名前のネームスペースを使用します。
              </p></li><li class="listitem"><p>
                ホストシステムはネットワークネームスペースをサポートしている必要があり、各名前付きネームスペースは事前に設定されている必要があります。 存在しないネームスペースに名前を付けると、エラーが発生します。 
              </p></li><li class="listitem"><p>
                変数値に複数のアドレスが指定されている場合は、グローバルネームスペース、名前付きネームスペースまたはその組合せにアドレスを含めることができます。
              </p></li></ul></div><p>
            ネットワークネームスペースの詳細は、<a class="xref" href="server-administration.html#network-namespace-support" title="5.1.14 ネットワークネームスペースのサポート">セクション5.1.14「ネットワークネームスペースのサポート」</a> を参照してください。
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
              X プラグイン は必須プラグインではないため、指定されたアドレスまたはアドレスリストにエラーがある場合、サーバーの起動は妨げられません (MySQL Server が <code class="literal">bind_address</code> エラーの場合と同様)。 X プラグイン では、リストされたアドレスのいずれかを解析できない場合、または X プラグイン がアドレスにバインドできない場合、アドレスはスキップされ、エラーメッセージがログに記録され、X プラグイン は残りの各アドレスへのバインドを試行します。X プラグイン <code class="literal">Mysqlx_address</code> ステータス変数には、バインドが成功したアドレスのみがリストに表示されます。 リストされたアドレスのいずれもバインドに成功しなかった場合、または単一の指定されたアドレスで障害が発生した場合、X プラグイン は X プロトコル を使用できないことを示すエラーメッセージ <span class="errorname">ER_XPLUGIN_FAILED_TO_PREPARE_IO_INTERFACES</span> をログに記録します。<code class="literal">mysqlx_bind_address</code> は動的ではないため、問題を修正するには、サーバーを停止し、システム変数値を修正してサーバーを再起動する必要があります。 
            </p></div></li><li class="listitem"><p><a name="sysvar_mysqlx_compression_algorithms"></a>
            <code class="literal">mysqlx_compression_algorithms</code>
          </p><a class="indexterm" name="idm45563240918288"></a><a class="indexterm" name="idm45563240916720"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_compression_algorithms"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-compression-algorithms=value</code></td>
</tr><tr><th>導入</th>
<td>8.0.19</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_compression_algorithms">mysqlx_compression_algorithms</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Set</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">deflate_stream,lz4_message,zstd_stream</code></td>
</tr><tr><th>有効な値</th>
<td><p class="valid-value"><code class="literal">deflate_stream</code></p><p class="valid-value"><code class="literal">lz4_message</code></p><p class="valid-value"><code class="literal">zstd_stream</code></p></td>
</tr></tbody></table></div><p>
            X プロトコル 接続で使用できる圧縮アルゴリズム。 デフォルトでは、Deflate、LZ4 および zstd アルゴリズムはすべて許可されています。 どのアルゴリズムも許可しないようにするには、許可するアルゴリズムのみを含むように <code class="literal">mysqlx_compression_algorithms</code> を設定します。 アルゴリズム名 <code class="literal">deflate_stream</code>、<code class="literal">lz4_message</code> および <code class="literal">zstd_stream</code> は任意の組合せで指定でき、順序と大/小文字は重要ではありません。 システム変数を空の文字列に設定した場合、圧縮アルゴリズムは許可されず、圧縮されていない接続のみが使用されます。 アルゴリズム固有のシステム変数を使用して、許可される各アルゴリズムのデフォルトおよび最大の圧縮レベルを調整します。 X プロトコル の接続圧縮と MySQL Server の同等の設定との関連の詳細は、<a class="xref" href="document-store.html#x-plugin-connection-compression" title="20.5.5 X プラグイン での接続圧縮">セクション20.5.5「X プラグイン での接続圧縮」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_connect_timeout"></a>
            <code class="literal">mysqlx_connect_timeout</code>
          </p><a class="indexterm" name="idm45563240880032"></a><a class="indexterm" name="idm45563240878480"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_connect_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-connect-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_connect_timeout">mysqlx_connect_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">30</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1000000000</code></td>
</tr></tbody></table></div><p>
            新しく接続されたクライアントから最初のパケットが受信されるまで X プラグイン が待機する秒数。 これは <code class="literal">connect_timeout</code> と同等の X プラグイン です。詳細は、その変数の説明を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_deflate_default_compression_level"></a>
            <code class="literal">mysqlx_deflate_default_compression_level</code>
          </p><a class="indexterm" name="idm45563240847504"></a><a class="indexterm" name="idm45563240845904"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_deflate_default_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_deflate_default_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_deflate_default_compression_level">mysqlx_deflate_default_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">3</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">9</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続の Deflate アルゴリズムに使用するデフォルトの圧縮レベル。 レベルは、1 (最小圧縮作業) から 9 (最大作業) の整数で指定します。 このレベルは、クライアントが機能ネゴシエーション中に圧縮レベルをリクエストしない場合に使用されます。 このシステム変数を指定しない場合、サーバーはレベル 3 をデフォルトとして使用します。 詳細は、<a class="xref" href="document-store.html#x-plugin-connection-compression" title="20.5.5 X プラグイン での接続圧縮">セクション20.5.5「X プラグイン での接続圧縮」</a>を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_deflate_max_client_compression_level"></a>
            <code class="literal">mysqlx_deflate_max_client_compression_level</code>
          </p><a class="indexterm" name="idm45563240812992"></a><a class="indexterm" name="idm45563240811376"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_deflate_max_client_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_deflate_max_client_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_deflate_max_client_compression_level">mysqlx_deflate_max_client_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">5</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">9</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続の Deflate アルゴリズムに許可する最大圧縮レベル。 範囲は、このアルゴリズムのデフォルトの圧縮レベルと同じです。 クライアントがこれより高い圧縮レベルをリクエストした場合、サーバーはここで設定したレベルを使用します。 このシステム変数を指定しない場合、サーバーは最大圧縮レベルを 5 に設定します。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_document_id_unique_prefix"></a>
            <code class="literal">mysqlx_document_id_unique_prefix</code>
          </p><a class="indexterm" name="idm45563240779216"></a><a class="indexterm" name="idm45563240777632"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_document_id_unique_prefix"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-document-id-unique-prefix=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_document_id_unique_prefix">mysqlx_document_id_unique_prefix</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">65535</code></td>
</tr></tbody></table></div><p>
            ドキュメントがコレクションに追加されたときにサーバーによって生成されるドキュメント ID の最初の 4 バイトを設定します。 この変数をインスタンスごとに一意の値に設定することで、ドキュメント ID がインスタンス間で一意であることを確認できます。 <a class="ulink" href="https://dev.mysql.com/doc/x-devapi-userguide/en/understanding-automatic-document-ids.html" target="_top">Understanding Document IDs</a>を参照してください。  
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_enable_hello_notice"></a>
            <code class="literal">mysqlx_enable_hello_notice</code>
          </p><a class="indexterm" name="idm45563240745984"></a><a class="indexterm" name="idm45563240744416"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_enable_hello_notice"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-enable-hello-notice[={OFF|ON}]</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_enable_hello_notice">mysqlx_enable_hello_notice</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Boolean</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">ON</code></td>
</tr></tbody></table></div><p>
            X プロトコル を介した接続を試行する クラシック MySQL プロトコル クライアントに送信されるメッセージを制御します。 有効にすると、サーバーの X プロトコル ポートに接続しようとする X プロトコル をサポートしていないクライアントは、間違ったプロトコルを使用していることを説明するエラーを受け取ります。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_idle_worker_thread_timeout"></a>
            <code class="literal">mysqlx_idle_worker_thread_timeout</code>
          </p><a class="indexterm" name="idm45563240719088"></a><a class="indexterm" name="idm45563240717488"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_idle_worker_thread_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-idle-worker-thread-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_idle_worker_thread_timeout">mysqlx_idle_worker_thread_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">60</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">3600</code></td>
</tr></tbody></table></div><p>
            アイドル状態のワーカースレッドが終了するまでの秒数。
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_interactive_timeout"></a>
            <code class="literal">mysqlx_interactive_timeout</code>
          </p><a class="indexterm" name="idm45563240687856"></a><a class="indexterm" name="idm45563240686288"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_interactive_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-interactive-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_interactive_timeout">mysqlx_interactive_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">28800</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">2147483</code></td>
</tr></tbody></table></div><p>
            対話型クライアントの <code class="literal">mysqlx_wait_timeout</code> セッション変数のデフォルト値。 (対話型クライアントがタイムアウトするまで待機する秒数。) 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_lz4_default_compression_level"></a>
            <code class="literal">mysqlx_lz4_default_compression_level</code>
          </p><a class="indexterm" name="idm45563240655344"></a><a class="indexterm" name="idm45563240653744"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_lz4_default_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_lz4_default_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_lz4_default_compression_level">mysqlx_lz4_default_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">2</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">16</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続の LZ4 アルゴリズムに使用するデフォルトの圧縮レベル。 レベルは、0 (最小圧縮作業) から 16 (最大作業) の整数で指定します。 このレベルは、クライアントが機能ネゴシエーション中に圧縮レベルをリクエストしない場合に使用されます。 このシステム変数を指定しない場合、サーバーはレベル 2 をデフォルトとして使用します。 詳細は、<a class="xref" href="document-store.html#x-plugin-connection-compression" title="20.5.5 X プラグイン での接続圧縮">セクション20.5.5「X プラグイン での接続圧縮」</a>を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_lz4_max_client_compression_level"></a>
            <code class="literal">mysqlx_lz4_max_client_compression_level</code>
          </p><a class="indexterm" name="idm45563240620832"></a><a class="indexterm" name="idm45563240619232"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_lz4_max_client_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_lz4_max_client_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_lz4_max_client_compression_level">mysqlx_lz4_max_client_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">8</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">16</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続で LZ4 アルゴリズムに対して許可する最大圧縮レベル。 範囲は、このアルゴリズムのデフォルトの圧縮レベルと同じです。 クライアントがこれより高い圧縮レベルをリクエストした場合、サーバーはここで設定したレベルを使用します。 このシステム変数を指定しない場合、サーバーは最大圧縮レベルを 8 に設定します。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_max_allowed_packet"></a>
            <code class="literal">mysqlx_max_allowed_packet</code>
          </p><a class="indexterm" name="idm45563240587152"></a><a class="indexterm" name="idm45563240585584"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_max_allowed_packet"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-max-allowed-packet=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_max_allowed_packet">mysqlx_max_allowed_packet</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">67108864</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">512</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1073741824</code></td>
</tr></tbody></table></div><p>
            X プラグイン で受信できるネットワークパケットの最大サイズ。 この制限は、接続に圧縮が使用される場合にも適用されるため、メッセージが解凍された後は、ネットワークパケットをこのサイズより小さくする必要があります。 これは <code class="literal">max_allowed_packet</code> と同等の X プラグイン です。詳細は、その変数の説明を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_max_connections"></a>
            <code class="literal">mysqlx_max_connections</code>
          </p><a class="indexterm" name="idm45563240554208"></a><a class="indexterm" name="idm45563240552656"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_max_connections"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-max-connections=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_max_connections">mysqlx_max_connections</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">100</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">65535</code></td>
</tr></tbody></table></div><p>
            X プラグイン が受け入れることができる同時クライアント接続の最大数。 これは <code class="literal">max_connections</code> と同等の X プラグイン です。詳細は、その変数の説明を参照してください。 
          </p><p>
            この変数を変更する場合、新しい値が現在の接続数より小さいと、新しい接続に対してのみ新しい制限が考慮されます。
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_min_worker_threads"></a>
            <code class="literal">mysqlx_min_worker_threads</code>
          </p><a class="indexterm" name="idm45563240521088"></a><a class="indexterm" name="idm45563240519520"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_min_worker_threads"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-min-worker-threads=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_min_worker_threads">mysqlx_min_worker_threads</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">2</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">100</code></td>
</tr></tbody></table></div><p>
            クライアントリクエストを処理するために X プラグイン で使用されるワーカースレッドの最小数。
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_port"></a>
            <code class="literal">mysqlx_port</code>
          </p><a class="indexterm" name="idm45563240489824"></a><a class="indexterm" name="idm45563240488304"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_port"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-port=port_num</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_port">mysqlx_port</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">33060</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">65535</code></td>
</tr></tbody></table></div><p>
            X プラグイン が TCP/IP 接続をリスニングするネットワークポート。 これは <code class="literal">port</code> と同等の X プラグイン です。詳細は、その変数の説明を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_port_open_timeout"></a>
            <code class="literal">mysqlx_port_open_timeout</code>
          </p><a class="indexterm" name="idm45563240457488"></a><a class="indexterm" name="idm45563240455936"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_port_open_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-port-open-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_port_open_timeout">mysqlx_port_open_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">120</code></td>
</tr></tbody></table></div><p>
            X プラグイン が TCP/IP ポートが解放されるまで待機する秒数。
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_read_timeout"></a>
            <code class="literal">mysqlx_read_timeout</code>
          </p><a class="indexterm" name="idm45563240426288"></a><a class="indexterm" name="idm45563240424736"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_read_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-read-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_read_timeout">mysqlx_read_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>セッション</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">28800</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">30</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">2147483</code></td>
</tr></tbody></table></div><p>
            X プラグイン が読取り操作のブロックの完了を待機する秒数。 この時間が経過すると、読取り操作が成功しない場合、X プラグイン は接続をクローズし、エラーコード<span class="errorcode"> ER_IO_READ_ERROR </span>の警告通知をクライアントアプリケーションに返します。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_socket"></a>
            <code class="literal">mysqlx_socket</code>
          </p><a class="indexterm" name="idm45563240394096"></a><a class="indexterm" name="idm45563240392624"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_socket"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-socket=file_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_socket">mysqlx_socket</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>文字列</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">/tmp/mysqlx.sock</code></td>
</tr></tbody></table></div><p>
            X プラグイン が接続に使用する Unix ソケットファイルへのパス。 この設定は、MySQL Server が Unix オペレーティングシステムで実行している場合にのみ使用されます。 クライアントはこのソケットを使用して、X プラグイン を使用して MySQL Server に接続できます。 
          </p><p>
            デフォルトの <code class="literal">mysqlx_socket</code> パスおよびファイル名は、MySQL Server のメインソケットファイルのデフォルトパスおよびファイル名に基づいており、ファイル名に <code class="literal">x</code> が追加されています。 メインソケットファイルのデフォルトのパスとファイル名は<code class="literal">/tmp/mysql.sock</code> であるため、X プラグイン ソケットファイルのデフォルトのパスとファイル名は<code class="literal">/tmp/mysqlx.sock</code> です。 
          </p><p>
            <code class="literal">socket</code> システム変数を使用して、サーバーの起動時にメインソケットファイルの代替パスとファイル名を指定した場合、これは X プラグイン ソケットファイルのデフォルトには影響しません。 この場合、両方のソケットを単一のパスに格納するには、<code class="literal">mysqlx_socket</code> システム変数も設定する必要があります。 たとえば、構成ファイルでは次のようになります: 
          </p><pre class="programlisting">socket=/home/sockets/mysqld/mysql.sock
mysqlx_socket=/home/sockets/xplugin/xplugin.sock
</pre><p>
            コンパイル時に <code class="option">MYSQL_UNIX_ADDR</code> コンパイルオプションを使用してメインソケットファイルのデフォルトパスおよびファイル名を変更すると、<code class="option">MYSQL_UNIX_ADDR</code> ファイル名に <code class="literal">x</code> を追加することによって形成される X プラグイン ソケットファイルのデフォルトに影響します。 コンパイル時に X プラグイン ソケットファイルに別のデフォルトを設定する場合は、<code class="option">MYSQLX_UNIX_ADDR</code> コンパイルオプションを使用します。 
          </p><p>
            <code class="literal">MYSQLX_UNIX_PORT</code> 環境変数を使用して、サーバーの起動時に X プラグイン ソケットファイルのデフォルトを設定することもできます (<a class="xref" href="programs.html#environment-variables" title="4.9 環境変数">セクション4.9「環境変数」</a> を参照)。 この環境変数を設定すると、コンパイルされた <code class="option">MYSQLX_UNIX_ADDR</code> 値はオーバーライドされますが、<code class="literal">mysqlx_socket</code> 値によってオーバーライドされます。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_ca"></a>
            <code class="literal">mysqlx_ssl_ca</code>
          </p><a class="indexterm" name="idm45563240350560"></a><a class="indexterm" name="idm45563240349040"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_ca"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-ca=file_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_ca">mysqlx_ssl_ca</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ファイル名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_ca</code> システム変数は <code class="literal">ssl_ca</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_capath"></a>
            <code class="literal">mysqlx_ssl_capath</code>
          </p><a class="indexterm" name="idm45563240321296"></a><a class="indexterm" name="idm45563240319744"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_capath"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-capath=dir_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_capath">mysqlx_ssl_capath</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ディレクトリ名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_capath</code> システム変数は <code class="literal">ssl_capath</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_cert"></a>
            <code class="literal">mysqlx_ssl_cert</code>
          </p><a class="indexterm" name="idm45563240292048"></a><a class="indexterm" name="idm45563240290512"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_cert"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-cert=file_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_cert">mysqlx_ssl_cert</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ファイル名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_cert</code> システム変数は <code class="literal">ssl_cert</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_cipher"></a>
            <code class="literal">mysqlx_ssl_cipher</code>
          </p><a class="indexterm" name="idm45563240262816"></a><a class="indexterm" name="idm45563240261264"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_cipher"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-cipher=name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_cipher">mysqlx_ssl_cipher</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>文字列</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_cipher</code> システム変数は <code class="literal">ssl_cipher</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_crl"></a>
            <code class="literal">mysqlx_ssl_crl</code>
          </p><a class="indexterm" name="idm45563240233632"></a><a class="indexterm" name="idm45563240232160"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_crl"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-crl=file_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_crl">mysqlx_ssl_crl</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ファイル名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_crl</code> システム変数は <code class="literal">ssl_crl</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_crlpath"></a>
            <code class="literal">mysqlx_ssl_crlpath</code>
          </p><a class="indexterm" name="idm45563240204416"></a><a class="indexterm" name="idm45563240202864"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_crlpath"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-crlpath=dir_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_crlpath">mysqlx_ssl_crlpath</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ディレクトリ名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_crlpath</code> システム変数は <code class="literal">ssl_crlpath</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_ssl_key"></a>
            <code class="literal">mysqlx_ssl_key</code>
          </p><a class="indexterm" name="idm45563240175168"></a><a class="indexterm" name="idm45563240173696"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_ssl_key"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-ssl-key=file_name</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_ssl_key">mysqlx_ssl_key</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>ファイル名</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">NULL</code></td>
</tr></tbody></table></div><p>
            <code class="literal">mysqlx_ssl_key</code> システム変数は <code class="literal">ssl_key</code> と似ていますが、MySQL Server のメイン接続インタフェースではなく X プラグイン に適用される点が異なります。 X プラグイン の暗号化サポートの構成の詳細は、<a class="xref" href="document-store.html#x-plugin-encrypted-connections" title="20.5.3 X プラグイン での暗号化接続の使用">セクション20.5.3「X プラグイン での暗号化接続の使用」</a> を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_wait_timeout"></a>
            <code class="literal">mysqlx_wait_timeout</code>
          </p><a class="indexterm" name="idm45563240145952"></a><a class="indexterm" name="idm45563240144400"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_wait_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-wait-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_wait_timeout">mysqlx_wait_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>セッション</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">28800</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">2147483</code></td>
</tr></tbody></table></div><p>
            X プラグイン が接続のアクティビティを待機する秒数。 この時間が経過すると、読取り操作が成功しない場合、X プラグイン は接続をクローズします。 クライアントが非対話型の場合、セッション変数の初期値はグローバル <code class="literal">mysqlx_wait_timeout</code> 変数からコピーされます。 対話型クライアントの場合、初期値はセッション <code class="literal">mysqlx_interactive_timeout</code> からコピーされます。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_write_timeout"></a>
            <code class="literal">mysqlx_write_timeout</code>
          </p><a class="indexterm" name="idm45563240112128"></a><a class="indexterm" name="idm45563240110576"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_write_timeout"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx-write-timeout=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_write_timeout">mysqlx_write_timeout</a></code></td>
</tr><tr><th>スコープ</th>
<td>セッション</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">60</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">2147483</code></td>
</tr></tbody></table></div><p>
            X プラグイン が書込み操作のブロックの完了を待機する秒数。 この時間が経過すると、書込み操作が成功しない場合、X プラグイン は接続をクローズします。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_zstd_default_compression_level"></a>
            <code class="literal">mysqlx_zstd_default_compression_level</code>
          </p><a class="indexterm" name="idm45563240080656"></a><a class="indexterm" name="idm45563240079056"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_zstd_default_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_zstd_default_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_zstd_default_compression_level">mysqlx_zstd_default_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">3</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">-131072</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">22</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続で zstd アルゴリズムに使用するデフォルトの圧縮レベル。 1.4.0 の zstd ライブラリのバージョンでは、正の値を 1 から 22 (最高の圧縮作業)、またはプログレッシブローエフォートを表す負の値に設定できます。 値 0 は値 1 に変換されます。 zstd ライブラリの以前のバージョンでは、値 3 のみを指定できます。 このレベルは、クライアントが機能ネゴシエーション中に圧縮レベルをリクエストしない場合に使用されます。 このシステム変数を指定しない場合、サーバーはレベル 3 をデフォルトとして使用します。 詳細は、<a class="xref" href="document-store.html#x-plugin-connection-compression" title="20.5.5 X プラグイン での接続圧縮">セクション20.5.5「X プラグイン での接続圧縮」</a>を参照してください。 
          </p></li><li class="listitem"><p><a name="sysvar_mysqlx_zstd_max_client_compression_level"></a>
            <code class="literal">mysqlx_zstd_max_client_compression_level</code>
          </p><a class="indexterm" name="idm45563240045200"></a><a class="indexterm" name="idm45563240043600"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for mysqlx_zstd_max_client_compression_level"><col style="width: 30%"><col style="width: 70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--mysqlx_zstd_max_client_compression_level=#</code></td>
</tr><tr><th>導入</th>
<td>8.0.20</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="document-store.html#sysvar_mysqlx_zstd_max_client_compression_level">mysqlx_zstd_max_client_compression_level</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">11</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">-131072</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">22</code></td>
</tr></tbody></table></div><p>
            サーバーが X プロトコル 接続で zstd アルゴリズムに対して許可する最大圧縮レベル。 範囲は、このアルゴリズムのデフォルトの圧縮レベルと同じです。 クライアントがこれより高い圧縮レベルをリクエストした場合、サーバーはここで設定したレベルを使用します。 このシステム変数を指定しない場合、サーバーは最大圧縮レベルを 11 に設定します。 
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-status-variables"></a>20.5.6.3 X プラグイン ステータス変数</h4></div></div></div><p>
        X プラグイン ステータス変数の意味は次のとおりです。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="statvar_Mysqlx_aborted_clients"></a>
            <code class="literal">Mysqlx_aborted_clients</code>
          </p><p>
            入出力エラーのために切断されたクライアントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_address"></a>
            <code class="literal">Mysqlx_address</code>
          </p><p>
            X プラグイン が TCP/IP 接続を受け入れるネットワークアドレス。 <code class="literal">mysqlx_bind_address</code> システム変数を使用して複数のアドレスが指定された場合、<code class="literal">Mysqlx_address</code> にはバインドが成功したアドレスのみが表示されます。 <code class="literal">mysqlx_bind_address</code> によって指定されたすべてのネットワークアドレスでバインドが失敗した場合、または <code class="literal">skip_networking</code> オプションが使用された場合、<code class="literal">Mysqlx_address</code> の値は <code class="literal">UNDEFINED</code> になります。 X プラグイン の起動がまだ完了していない場合、<code class="literal">Mysqlx_address</code> の値は空です。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_received"></a>
            <code class="literal">Mysqlx_bytes_received</code>
          </p><p>
            ネットワークを介して受信された合計バイト数。 接続に圧縮が使用されている場合、この図は、解凍前に測定された圧縮メッセージペイロード (<code class="literal">Mysqlx_bytes_received_compressed_payload</code>)、圧縮されなかった圧縮メッセージ内のアイテム ( X プロトコル ヘッダーなど)、および圧縮されていないメッセージで構成されます。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_received_compressed_payload"></a>
            <code class="literal">Mysqlx_bytes_received_compressed_payload</code>
          </p><p>
            圧縮メッセージペイロードとして受信したバイト数で、解凍前に測定されます。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_received_uncompressed_frame"></a>
            <code class="literal">Mysqlx_bytes_received_uncompressed_frame</code>
          </p><p>
            圧縮メッセージペイロードとして受信したバイト数で、解凍後に測定されます。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_sent"></a>
            <code class="literal">Mysqlx_bytes_sent</code>
          </p><p>
            ネットワークを介して送信された合計バイト数。 接続に圧縮が使用される場合、この図は、圧縮 (<code class="literal">Mysqlx_bytes_sent_compressed_payload</code>) 後に測定された圧縮メッセージペイロード、圧縮されなかった圧縮メッセージ内のアイテム ( X プロトコル ヘッダーなど)、および圧縮されていないメッセージで構成されます。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_sent_compressed_payload"></a>
            <code class="literal">Mysqlx_bytes_sent_compressed_payload</code>
          </p><p>
            圧縮メッセージペイロードとして送信されたバイト数で、圧縮後に測定されます。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_bytes_sent_uncompressed_frame"></a>
            <code class="literal">Mysqlx_bytes_sent_uncompressed_frame</code>
          </p><p>
            圧縮メッセージペイロードとして送信されたバイト数で、圧縮前に測定されます。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_compression_algorithm"></a>
            <code class="literal">Mysqlx_compression_algorithm</code>
          </p><p>
            (セッションスコープ) このセッションの X プロトコル 接続に使用されている圧縮アルゴリズム。 許可される圧縮アルゴリズムは、<code class="literal">mysqlx_compression_algorithms</code> システム変数によって一覧表示されます。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_compression_level"></a>
            <code class="literal">Mysqlx_compression_level</code>
          </p><p>
            (セッションスコープ) このセッションの X プロトコル 接続に使用される圧縮レベル。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_connection_accept_errors"></a>
            <code class="literal">Mysqlx_connection_accept_errors</code>
          </p><p>
            受け入れエラーの原因となった接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_connection_errors"></a>
            <code class="literal">Mysqlx_connection_errors</code>
          </p><p>
            エラーの原因となった接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_connections_accepted"></a>
            <code class="literal">Mysqlx_connections_accepted</code>
          </p><p>
            受け入れられた接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_connections_closed"></a>
            <code class="literal">Mysqlx_connections_closed</code>
          </p><p>
            クローズされた接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_connections_rejected"></a>
            <code class="literal">Mysqlx_connections_rejected</code>
          </p><p>
            拒否された接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_create_view"></a>
            <code class="literal">Mysqlx_crud_create_view</code>
          </p><p>
            受信したビュー作成リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_delete"></a>
            <code class="literal">Mysqlx_crud_delete</code>
          </p><p>
            受信した削除リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_drop_view"></a>
            <code class="literal">Mysqlx_crud_drop_view</code>
          </p><p>
            受信したドロップビューリクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_find"></a>
            <code class="literal">Mysqlx_crud_find</code>
          </p><p>
            受信した検索リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_insert"></a>
            <code class="literal">Mysqlx_crud_insert</code>
          </p><p>
            受信した挿入リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_modify_view"></a>
            <code class="literal">Mysqlx_crud_modify_view</code>
          </p><p>
            受信した表示変更リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_crud_update"></a>
            <code class="literal">Mysqlx_crud_update</code>
          </p><p>
            受信した更新リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_cursor_close"></a>
            <code class="literal">Mysqlx_cursor_close</code>
          </p><p>
            受信した cursor-close メッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_cursor_fetch"></a>
            <code class="literal">Mysqlx_cursor_fetch</code>
          </p><p>
            受信したカーソルフェッチメッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_cursor_open"></a>
            <code class="literal">Mysqlx_cursor_open</code>
          </p><p>
            受信したカーソルオープンメッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_errors_sent"></a>
            <code class="literal">Mysqlx_errors_sent</code>
          </p><p>
            クライアントに送信されたエラーの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_expect_close"></a>
            <code class="literal">Mysqlx_expect_close</code>
          </p><p>
            クローズされた予想ブロックの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_expect_open"></a>
            <code class="literal">Mysqlx_expect_open</code>
          </p><p>
            オープンされた予想ブロックの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_init_error"></a>
            <code class="literal">Mysqlx_init_error</code>
          </p><p>
            初期化中のエラーの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_messages_sent"></a>
            <code class="literal">Mysqlx_messages_sent</code>
          </p><p>
            クライアントに送信されたすべてのタイプのメッセージの合計数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_notice_global_sent"></a>
            <code class="literal">Mysqlx_notice_global_sent</code>
          </p><p>
            クライアントに送信されたグローバル通知の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_notice_other_sent"></a>
            <code class="literal">Mysqlx_notice_other_sent</code>
          </p><p>
            クライアントに返送されたその他のタイプの通知の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_notice_warning_sent"></a>
            <code class="literal">Mysqlx_notice_warning_sent</code>
          </p><p>
            クライアントに戻された警告通知の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_notified_by_group_replication"></a>
            <code class="literal">Mysqlx_notified_by_group_replication</code>
          </p><p>
            クライアントに送信された Group Replication 通知の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_port"></a>
            <code class="literal">Mysqlx_port</code>
          </p><p>
            X プラグイン がリスニングしている TCP ポート。 ネットワークバインドが失敗した場合、または <code class="literal">skip_networking</code> システム変数が有効になっている場合、値は <code class="literal">UNDEFINED</code> を示します。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_prep_deallocate"></a>
            <code class="literal">Mysqlx_prep_deallocate</code>
          </p><p>
            受信した prepared-statement-deallocate メッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_prep_execute"></a>
            <code class="literal">Mysqlx_prep_execute</code>
          </p><p>
            受信したプリペアドステートメント実行メッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_prep_prepare"></a>
            <code class="literal">Mysqlx_prep_prepare</code>
          </p><p>
            受信したプリペアドステートメントメッセージの数
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_rows_sent"></a>
            <code class="literal">Mysqlx_rows_sent</code>
          </p><p>
            クライアントに返送された行数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions"></a>
            <code class="literal">Mysqlx_sessions</code>
          </p><p>
            オープンされているセッションの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions_accepted"></a>
            <code class="literal">Mysqlx_sessions_accepted</code>
          </p><p>
            受け入れられたセッション試行の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions_closed"></a>
            <code class="literal">Mysqlx_sessions_closed</code>
          </p><p>
            クローズされたセッションの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions_fatal_error"></a>
            <code class="literal">Mysqlx_sessions_fatal_error</code>
          </p><p>
            致命的エラーでクローズされたセッションの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions_killed"></a>
            <code class="literal">Mysqlx_sessions_killed</code>
          </p><p>
            中断されたセッションの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_sessions_rejected"></a>
            <code class="literal">Mysqlx_sessions_rejected</code>
          </p><p>
            拒否されたセッション試行の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_socket"></a>
            <code class="literal">Mysqlx_socket</code>
          </p><p>
            X プラグイン がリスニングしている Unix ソケット。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_accept_renegotiates"></a>
            <code class="literal">Mysqlx_ssl_accept_renegotiates</code>
          </p><p>
            接続の確立に必要なネゴシエーションの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_accepts"></a>
            <code class="literal">Mysqlx_ssl_accepts</code>
          </p><p>
            受け入れられた SSL 接続の数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_active"></a>
            <code class="literal">Mysqlx_ssl_active</code>
          </p><p>
            SSL がアクティブな場合。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_cipher"></a>
            <code class="literal">Mysqlx_ssl_cipher</code>
          </p><p>
            現在の SSL 暗号 (非 SSL 接続の場合は空)。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_cipher_list"></a>
            <code class="literal">Mysqlx_ssl_cipher_list</code>
          </p><p>
            使用可能な SSL 暗号のリスト (非 SSL 接続の場合は空)。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_ctx_verify_depth"></a>
            <code class="literal">Mysqlx_ssl_ctx_verify_depth</code>
          </p><p>
            現在 ctx に設定されている証明書検証の深さ制限。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_ctx_verify_mode"></a>
            <code class="literal">Mysqlx_ssl_ctx_verify_mode</code>
          </p><p>
            ctx で現在設定されている証明書検証モード。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_finished_accepts"></a>
            <code class="literal">Mysqlx_ssl_finished_accepts</code>
          </p><p>
            サーバーへの正常な SSL 接続数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_server_not_after"></a>
            <code class="literal">Mysqlx_ssl_server_not_after</code>
          </p><p>
            SSL 証明書が有効な最終日。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_server_not_before"></a>
            <code class="literal">Mysqlx_ssl_server_not_before</code>
          </p><p>
            SSL 証明書が有効な最初の日。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_verify_depth"></a>
            <code class="literal">Mysqlx_ssl_verify_depth</code>
          </p><p>
            SSL 接続の証明書検証の深さ。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_verify_mode"></a>
            <code class="literal">Mysqlx_ssl_verify_mode</code>
          </p><p>
            SSL 接続の証明書検証モード。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_ssl_version"></a>
            <code class="literal">Mysqlx_ssl_version</code>
          </p><p>
            SSL 接続に使用されるプロトコルの名前。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_create_collection"></a>
            <code class="literal">Mysqlx_stmt_create_collection</code>
          </p><p>
            受信した create collection ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_create_collection_index"></a>
            <code class="literal">Mysqlx_stmt_create_collection_index</code>
          </p><p>
            受信した CREATE COLLECTION INDEX ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_disable_notices"></a>
            <code class="literal">Mysqlx_stmt_disable_notices</code>
          </p><p>
            受信した disable notice ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_drop_collection"></a>
            <code class="literal">Mysqlx_stmt_drop_collection</code>
          </p><p>
            受信した drop collection ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_drop_collection_index"></a>
            <code class="literal">Mysqlx_stmt_drop_collection_index</code>
          </p><p>
            受信した drop collection index ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_enable_notices"></a>
            <code class="literal">Mysqlx_stmt_enable_notices</code>
          </p><p>
            受信した enable notice ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_ensure_collection"></a>
            <code class="literal">Mysqlx_stmt_ensure_collection</code>
          </p><p>
            受信した ensure collection ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_execute_mysqlx"></a>
            <code class="literal">Mysqlx_stmt_execute_mysqlx</code>
          </p><p>
            ネームスペースを <code class="literal">mysqlx</code> に設定して受信した StmtExecute メッセージの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_execute_sql"></a>
            <code class="literal">Mysqlx_stmt_execute_sql</code>
          </p><p>
            SQL ネームスペースに対して受信された StmtExecute リクエストの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_execute_xplugin"></a>
            <code class="literal">Mysqlx_stmt_execute_xplugin</code>
          </p><p>
            <code class="literal">xplugin</code> ネームスペースに対して受信された StmtExecute リクエストの数。 MySQL 8.0.19 から、<code class="literal">xplugin</code> ネームスペースが削除されたため、このステータス変数は使用されなくなりました。 
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_get_collection_options"></a>
            <code class="literal">Mysqlx_stmt_get_collection_options</code>
          </p><p>
            受信した get collection object ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_kill_client"></a>
            <code class="literal">Mysqlx_stmt_kill_client</code>
          </p><p>
            受信した kill クライアントステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_list_clients"></a>
            <code class="literal">Mysqlx_stmt_list_clients</code>
          </p><p>
            受信したリストクライアントステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_list_notices"></a>
            <code class="literal">Mysqlx_stmt_list_notices</code>
          </p><p>
            受信したリスト通知ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_list_objects"></a>
            <code class="literal">Mysqlx_stmt_list_objects</code>
          </p><p>
            受信したリストオブジェクトステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_modify_collection_options"></a>
            <code class="literal">Mysqlx_stmt_modify_collection_options</code>
          </p><p>
            受信した modify collection options ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_stmt_ping"></a>
            <code class="literal">Mysqlx_stmt_ping</code>
          </p><p>
            受信した ping ステートメントの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_worker_threads"></a>
            <code class="literal">Mysqlx_worker_threads</code>
          </p><p>
            使用可能なワーカースレッドの数。
          </p></li><li class="listitem"><p><a name="statvar_Mysqlx_worker_threads_active"></a>
            <code class="literal">Mysqlx_worker_threads_active</code>
          </p><p>
            現在使用中のワーカースレッドの数。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="x-plugin-system-monitoring"></a>20.5.7 X プラグイン の監視</h3></div></div></div><p>
      X プラグイン の一般的な監視には、公開するステータス変数を使用します。 <a class="xref" href="document-store.html#x-plugin-status-variables" title="20.5.6.3 X プラグイン ステータス変数">セクション20.5.6.3「X プラグイン ステータス変数」</a>を参照してください。 メッセージ圧縮の影響の監視の詳細は、<a class="xref" href="document-store.html#x-plugin-connection-compression-monitoring" title="X プラグイン の接続圧縮の監視">X プラグイン の接続圧縮の監視</a> を参照してください。 
    </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="x-plugin-generated-statements"></a>X プラグイン によって生成された SQL の監視</h4></div></div></div><p>
        このセクションでは、X DevAPI 操作の実行時に X プラグイン によって生成される SQL ステートメントを監視する方法について説明します。 CRUD ステートメントを実行すると、SQL に変換され、サーバーに対して実行されます。 生成された SQL を監視できるようにするには、「パフォーマンススキーマ」テーブルを有効にする必要があります。 SQL は、<code class="literal">performance_schema.events_statements_current</code>、<code class="literal">performance_schema.events_statements_history</code> および <code class="literal">performance_schema.events_statements_history_long</code> の各テーブルに登録されます。 次の例では、このセクションのクイックスタートチュートリアルの一部としてインポートされた <code class="literal">world_x</code> スキーマを使用します。 Python モードで MySQL Shell を使用し、SQL モードに変更せずに SQL ステートメントを発行できる<code class="literal">\sql</code> コマンドを使用します。 かわりに SQL モードに切り替えると、X DevAPI 操作ではなくこの操作の結果がプロシージャに表示されるため、これは重要です。 JavaScript モードで MySQL Shell を使用している場合、<code class="literal">\sql</code> コマンドは同じ方法で使用されます。 
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            <code class="literal">events_statements_history</code> コンシューマが有効かどうかを確認します。 次のコマンドを発行します: 
          </p><pre class="programlisting">mysql-py&gt;<strong class="userinput"><code> \sql SELECT enabled FROM performance_schema.setup_consumers WHERE NAME = 'events_statements_history'</code></strong>
+---------+
| enabled |
+---------+
| YES     |
+---------+
</pre></li><li class="listitem"><p>
            すべてのインストゥルメントがコンシューマにデータをレポートするかどうかを確認します。 次のコマンドを発行します: 
          </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\sql SELECT NAME, ENABLED, TIMED FROM performance_schema.setup_instruments WHERE NAME LIKE 'statement/%' AND NOT (ENABLED and TIMED)</code></strong></pre><p>
            このステートメントが少なくとも 1 つの行を報告する場合は、インストゥルメントを有効にする必要があります。 <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            現在の接続のスレッド ID を取得します。 次のコマンドを発行します: 
          </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\sql SELECT thread_id INTO @id FROM performance_schema.threads WHERE processlist_id=connection_id()</code></strong></pre></li><li class="listitem"><p>
            生成された SQL を表示する X DevAPI CRUD 操作を実行します。 たとえば、次のように発行します: 
          </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>db.CountryInfo.find("Name = :country").bind("country", "Italy")</code></strong></pre><p>
            正しい結果を表示するために、次のステップでこれ以上の操作を発行しないでください。
          </p></li><li class="listitem"><p>
            このスレッド ID によって行われた最後の SQL クエリーを表示します。 次のコマンドを発行します: 
          </p><pre class="programlisting">mysql-py&gt; <strong class="userinput"><code>\sql SELECT THREAD_ID, MYSQL_ERRNO,SQL_TEXT FROM performance_schema.events_statements_history WHERE THREAD_ID=@id ORDER BY TIMER_START DESC LIMIT 1;</code></strong>
+-----------+-------------+--------------------------------------------------------------------------------------+
| THREAD_ID | MYSQL_ERRNO | SQL_TEXT                                                                             |
+-----------+-------------+--------------------------------------------------------------------------------------+
|        29 |           0 | SELECT doc FROM `world_x`.`CountryInfo` WHERE (JSON_EXTRACT(doc,'$.Name') = 'Italy') |
+-----------+-------------+--------------------------------------------------------------------------------------+
</pre><p>
            結果には、最新のステートメント (この場合は前のステップの X DevAPI CRUD 操作) に基づいて X プラグイン によって生成された SQL が表示されます。
          </p></li></ol></div></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mysql-shell-userguide.html">前</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="mysql-innodb-cluster-introduction.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第 19 章 MySQL Shell </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第 21 章 InnoDB クラスタ</td></tr></table></div><div class="copyright-footer"></div></body></html>
