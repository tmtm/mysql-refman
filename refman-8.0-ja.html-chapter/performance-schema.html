<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第 27 章 MySQL パフォーマンススキーマ</title><link rel="stylesheet" type="text/css" href="mvl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="up" href="index.html" title="MySQL 8.0 リファレンスマニュアル"><link rel="prev" href="information-schema.html" title="第 26 章 INFORMATION_SCHEMA テーブル"><link rel="next" href="sys-schema.html" title="第 28 章 MySQL sys スキーマ"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 27 章 MySQL パフォーマンススキーマ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="information-schema.html">前</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="sys-schema.html">次へ</a></td></tr></table><hr></div><div class="status-header"><p class="alert">このページは機械翻訳したものです。</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="performance-schema"></a>第 27 章 MySQL パフォーマンススキーマ</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-quick-start">27.1 パフォーマンススキーマクイックスタート</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-build-configuration">27.2 パフォーマンススキーマビルド構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-startup-configuration">27.3 パフォーマンススキーマ起動構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-runtime-configuration">27.4 パフォーマンススキーマ実行時構成</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-timing">27.4.1 パフォーマンススキーマイベントタイミング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering">27.4.2 パフォーマンススキーマイベントフィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-pre-filtering">27.4.3 イベントの事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-filtering">27.4.4 インストゥルメントによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-object-filtering">27.4.5 オブジェクトによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-thread-filtering">27.4.6 スレッドによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-filtering">27.4.7 コンシューマによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-configurations">27.4.8 コンシューマ構成の例</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering-names">27.4.9 フィルタリング操作のインストゥルメントまたはコンシューマの指定</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrumentation-checking">27.4.10 インストゥルメントされているものの特定</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-queries">27.5 パフォーマンススキーマクエリー</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-naming">27.6 パフォーマンススキーマインストゥルメント命名規則</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-monitoring">27.7 パフォーマンススキーマステータスモニタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-atom-molecule-events">27.8 パフォーマンススキーマの原子的および分子的イベント</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-event-tables">27.9 現在および過去のイベントのパフォーマンススキーマテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-digests">27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-characteristics">27.11 パフォーマンススキーマの一般的なテーブル特性</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-descriptions">27.12 パフォーマンススキーマテーブルの説明</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">27.12.1 パフォーマンススキーマテーブルインデックス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">27.12.2 パフォーマンススキーマセットアップテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">27.12.3 パフォーマンススキーマインスタンステーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">27.12.4 パフォーマンススキーマ待機イベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">27.12.5 パフォーマンススキーマステージイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">27.12.6 パフォーマンススキーマステートメントイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-transaction-tables">27.12.7 パフォーマンススキーマのトランザクションテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">27.12.8 パフォーマンススキーマ接続テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">27.12.9 パフォーマンススキーマ接続属性テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-user-variable-tables">27.12.10 パフォーマンススキーマのユーザー定義変数テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-tables">27.12.11 パフォーマンススキーマレプリケーションテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-ndb-cluster-tables">27.12.12 パフォーマンススキーマ NDB Cluster テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-lock-tables">27.12.13 パフォーマンススキーマロックテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-system-variable-tables">27.12.14 パフォーマンススキーマシステム変数テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variable-tables">27.12.15 パフォーマンススキーマのステータス変数のテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-thread-pool-tables">27.12.16 パフォーマンススキーマスレッドプールテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-clone-tables">27.12.17 パフォーマンススキーマクローンテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">27.12.18 パフォーマンススキーマサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">27.12.19 パフォーマンススキーマのその他のテーブル</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-option-variable-reference">27.13 パフォーマンススキーマオプションおよび変数リファレンス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-options">27.14 パフォーマンススキーマコマンドオプション</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-system-variables">27.15 パフォーマンススキーマシステム変数</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variables">27.16 パフォーマンススキーマステータス変数</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-memory-model">27.17 パフォーマンススキーマのメモリー割り当てモデル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-and-plugins">27.18 パフォーマンススキーマとプラグイン</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-examples">27.19 問題を診断するためのパフォーマンススキーマの使用</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-query-profiling">27.19.1 パフォーマンススキーマを使用したクエリープロファイリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-obtaining-parent-events">27.19.2 親イベント情報の取得</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-restrictions">27.20 パフォーマンススキーマの制約</a></span></dt></dl></div><a class="indexterm" name="idm45882613622864"></a><a class="indexterm" name="idm45882613621408"></a><a class="indexterm" name="idm45882613619952"></a><a class="indexterm" name="idm45882613618000"></a><p>
    MySQL パフォーマンススキーマは低レベルで MySQL サーバーの実行をモニタリングするための機能です。 パフォーマンススキーマには、これらの特性があります。 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        パフォーマンススキーマは、実行時にサーバーの内部実行を検査する方法を提供します。 それは、<code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンおよび <code class="literal">performance_schema</code> データベースを使用して実装されます。 パフォーマンススキーマは、主にパフォーマンスデータに焦点を合わせています。 これは、メタデータの検査に使用される <code class="literal">INFORMATION_SCHEMA</code> と異なります。 
      </p></li><li class="listitem"><p>
        パフォーマンススキーマはサーバーイベントをモニターします。 <span class="quote">「<span class="quote">イベント</span>」</span>は、時間がかかり、タイミング情報を収集できるようにインストゥルメントされた、サーバーが実行するすべてのことです。 一般に、イベントは、関数呼び出し、オペレーティングシステムの待機、解析やソートなどの SQL ステートメント実行のステージ、またはステートメント全体やステートメントのグループなどになります。 イベント収集を使用すると、サーバーやいくつかのストレージエンジンの同期呼び出し (相互排他ロックなど) ファイルやテーブルの I/O,テーブルロックに関する情報にアクセスできます。 
      </p></li><li class="listitem"><p>
        パフォーマンススキーマイベントは、サーバーのバイナリログに書き込まれるイベント (これはデータの変更を説明する) やイベントスケジューラのイベント (これはストアドプログラムの一種である) とは区別されます。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマイベントは MySQL サーバーの特定のインスタンスに固有です。 「パフォーマンススキーマ」テーブルはサーバーに対してローカルであるとみなされ、それらに対する変更はバイナリログにレプリケートまたは書き込まれません。 
      </p></li><li class="listitem"><p>
        現在のイベントに加えて、イベントの履歴とサマリーを取得できます。 これにより、インストゥルメントされたアクティビティーが何回実行され、それらにどのくらいの時間がかかったかを判断できます。 イベント情報を取得して、特定のスレッドのアクティビティー、または相互排他ロックやファイルなどの特定のオブジェクトに関連付けられているアクティビティーを表示できます。 
      </p></li><li class="listitem"><p>
        <code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンは、サーバーソースコードで<span class="quote">「<span class="quote">インストゥルメンテーションポイント</span>」</span>を使用して、イベントデータを収集します。
      </p></li><li class="listitem"><p>
        収集されたイベントは、<code class="literal">performance_schema</code> データベース内のテーブルに格納されます。 これらのテーブルは、ほかのテーブルと同様に <code class="literal">SELECT</code> ステートメントを使用してクエリーできます。 
      </p></li><li class="listitem"><p>
        パフォーマンススキーマの構成は、SQL ステートメントから <code class="literal">performance_schema</code> データベース内のテーブルを更新することによって、動的に変更できます。 構成の変更はデータコレクションにすぐに影響しません。 
      </p></li><li class="listitem"><p>
        パフォーマンススキーマ内のテーブルは、永続的なディスク上のストレージを使用しないインメモリーテーブルです。 コンテンツは、サーバーの起動時から再移入され、サーバーの停止時に破棄されます。 
      </p></li><li class="listitem"><p>
        モニタリングは MySQL でサポートされているすべてのプラットフォームで使用できます。
      </p><p>
        いくつかの制限が適用されることがあります。タイマーの種類はプラットフォームごとに異なることがあります。 ストレージエンジンに適用されるインストゥルメントは、すべてのストレージエンジンに実装されていないことがあります。 各サードパーティーエンジンのインストゥルメンテーションはエンジン管理者の責任です。 <a class="xref" href="performance-schema.html#performance-schema-restrictions" title="27.20 パフォーマンススキーマの制約">セクション27.20「パフォーマンススキーマの制約」</a>も参照してください。 
      </p></li><li class="listitem"><p>
        データコレクションは、サーバーソースコードを変更し、インストゥルメンテーションを追加することによって実装されます。 レプリケーションやイベントスケジューラなどのほかの機能と異なり、パフォーマンススキーマに関連付けられた個別のスレッドはありません。 
      </p></li></ul></div><p>
    パフォーマンススキーマは、サーバーパフォーマンスに与える影響を最小にしながら、サーバー実行に関する有益な情報へのアクセスを提供することを目的としています。 実装はこれらの設計目標に従います。 
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        パフォーマンススキーマのアクティブ化によって、サーバーの動作は変更されません。 たとえば、それによってスレッドスケジューリングが変更されず、クエリー実行計画 (<code class="literal">EXPLAIN</code> によって表示される) が変更されません。 
      </p></li><li class="listitem"><p>
        サーバーのモニタリングはごくわずかなオーバーヘッドで、継続的かつ目立たずに行われます。 パフォーマンススキーマのアクティブ化によって、サーバーが使用不能になりません。 
      </p></li><li class="listitem"><p>
        パーサーは変更されません。 新しいキーワードやステートメントはありません。 
      </p></li><li class="listitem"><p>
        パフォーマンススキーマが内部で失敗しても、サーバーコードの実行は正常に続行されます。
      </p></li><li class="listitem"><p>
        初期のイベントの収集時に処理を実行するか、あとのイベント取得時に処理を実行するかのどちらかを選択する場合、収集が速くなるほうが優先されます。 これは、取得がオンデマンドで、まったく行われないこともあるのに対し、収集は進行中であるためです。 
      </p></li><li class="listitem"><p>
        「最もパフォーマンスの高いスキーマ」テーブルには、全テーブルスキャン以外の実行計画へのアクセス権をオプティマイザに付与するインデックスがあります。 詳細は、<a class="xref" href="optimization.html#performance-schema-optimization" title="8.2.4 パフォーマンススキーマクエリーの最適化">セクション8.2.4「パフォーマンススキーマクエリーの最適化」</a>を参照してください。 
      </p></li><li class="listitem"><p>
        新しいインストゥルメンテーションポイントを追加することは簡単です。
      </p></li><li class="listitem"><p>
        インストゥルメンテーションはバージョン管理されます。 インストゥルメンテーションの実装が変更されても、以前にインストゥルメントされたコードは引き続き機能します。 これは、最新のパフォーマンススキーマの変更と同期させておくために、各プラグインをアップグレードする必要がないため、サードパーティープラグインの開発者にメリットがあります。 
      </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
      <a class="indexterm" name="idm45882613577888"></a> MySQL <code class="literal">sys</code> スキーマは、パフォーマンススキーマによって収集されたデータへの便利なアクセスを提供する一連のオブジェクトです。 <code class="literal">sys</code> スキーマはデフォルトでインストールされます。 使用手順については、<a class="xref" href="sys-schema.html" title="第 28 章 MySQL sys スキーマ">第28章「<i>MySQL sys スキーマ</i>」</a> を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-quick-start"></a>27.1 パフォーマンススキーマクイックスタート</h2></div></div></div><p>
      このセクションでは、その使用方法を示す例によって、パフォーマンススキーマについて簡単に紹介します。 追加の例については、<a class="xref" href="performance-schema.html#performance-schema-examples" title="27.19 問題を診断するためのパフォーマンススキーマの使用">セクション27.19「問題を診断するためのパフォーマンススキーマの使用」</a>を参照してください。 
    </p><p>
      パフォーマンススキーマはデフォルトで有効になっています。 それを明示的に有効または無効にするには、<code class="literal">performance_schema</code> 変数を適切な値に設定して、サーバーを起動します。 たとえば、サーバー <code class="filename">my.cnf</code> ファイルで次の行を使用します: 
    </p><pre class="programlisting">[mysqld]
performance_schema=ON
</pre><p>
      サーバーは起動すると、<code class="literal">performance_schema</code> を確認し、パフォーマンススキーマの初期化を試みます。 初期化の成功を確認するには、このステートメントを使用します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'performance_schema';</code></strong>
+--------------------+-------+
| Variable_name      | Value |
+--------------------+-------+
| performance_schema | ON    |
+--------------------+-------+
</pre><p>
      <code class="literal">ON</code> の値はパフォーマンススキーマが正常に初期化され、使用する準備ができていることを意味します。 <code class="literal">OFF</code> の値は何らかのエラーが発生していることを意味します。 何に異常が発生したかに関する情報については、サーバーエラーログをチェックしてください。 
    </p><p>
      パフォーマンススキーマはストレージエンジンとして実装されるため、<code class="literal">INFORMATION_SCHEMA.ENGINES</code> テーブルまたは <code class="literal">SHOW ENGINES</code> ステートメントからの出力に一覧表示されます:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM INFORMATION_SCHEMA.ENGINES</code></strong>
       <strong class="userinput"><code>WHERE ENGINE='PERFORMANCE_SCHEMA'\G</code></strong>
*************************** 1. row ***************************
      ENGINE: PERFORMANCE_SCHEMA
     SUPPORT: YES
     COMMENT: Performance Schema
TRANSACTIONS: NO
          XA: NO
  SAVEPOINTS: NO

mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
...
</pre><p>
      <code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンは、<code class="literal">performance_schema</code> データベース内のテーブルを操作します。 そのテーブルへの参照をデータベース名で修飾する必要がないように、<code class="literal">performance_schema</code> をデフォルトのデータベースにすることができます。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE performance_schema;</code></strong>
</pre><p>
      パフォーマンススキーマテーブルは <code class="literal">performance_schema</code> データベースに格納されます。 このデータベースとそのテーブルの構造に関する情報を取得するには、ほかのすべてのデータベースのように、<code class="literal">INFORMATION_SCHEMA</code> データベースから選択するか、<code class="literal">SHOW</code> ステートメントを使用します。 たとえば、どのパフォーマンススキーマテーブルが存在するか確認するには、これらのいずれかのステートメントを使用します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
       <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema';</code></strong>
+------------------------------------------------------+
| TABLE_NAME                                           |
+------------------------------------------------------+
| accounts                                             |
| cond_instances                                       |
...
| events_stages_current                                |
| events_stages_history                                |
| events_stages_history_long                           |
| events_stages_summary_by_account_by_event_name       |
| events_stages_summary_by_host_by_event_name          |
| events_stages_summary_by_thread_by_event_name        |
| events_stages_summary_by_user_by_event_name          |
| events_stages_summary_global_by_event_name           |
| events_statements_current                            |
| events_statements_history                            |
| events_statements_history_long                       |
...
| file_instances                                       |
| file_summary_by_event_name                           |
| file_summary_by_instance                             |
| host_cache                                           |
| hosts                                                |
| memory_summary_by_account_by_event_name              |
| memory_summary_by_host_by_event_name                 |
| memory_summary_by_thread_by_event_name               |
| memory_summary_by_user_by_event_name                 |
| memory_summary_global_by_event_name                  |
| metadata_locks                                       |
| mutex_instances                                      |
| objects_summary_global_by_type                       |
| performance_timers                                   |
| replication_connection_configuration                 |
| replication_connection_status                        |
| replication_applier_configuration                    |
| replication_applier_status                           |
| replication_applier_status_by_coordinator            |
| replication_applier_status_by_worker                 |
| rwlock_instances                                     |
| session_account_connect_attrs                        |
| session_connect_attrs                                |
| setup_actors                                         |
| setup_consumers                                      |
| setup_instruments                                    |
| setup_objects                                        |
| socket_instances                                     |
| socket_summary_by_event_name                         |
| socket_summary_by_instance                           |
| table_handles                                        |
| table_io_waits_summary_by_index_usage                |
| table_io_waits_summary_by_table                      |
| table_lock_waits_summary_by_table                    |
| threads                                              |
| users                                                |
+------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SHOW TABLES FROM performance_schema;</code></strong>
+------------------------------------------------------+
| Tables_in_performance_schema                         |
+------------------------------------------------------+
| accounts                                             |
| cond_instances                                       |
| events_stages_current                                |
| events_stages_history                                |
| events_stages_history_long                           |
...
</pre><p>
      「パフォーマンススキーマ」テーブルの数は、追加のインストゥルメンテーションの実装が進行するにつれて時間の経過とともに増加します。
    </p><p>
      <code class="literal">performance_schema</code> データベースの名前は小文字で、その中のテーブルの名前も同様です。 クエリーでは名前を小文字で指定してください。 
    </p><p>
      個々のテーブルの構造を表示するには、<code class="literal">SHOW CREATE TABLE</code> を使用します。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE performance_schema.setup_consumers\G</code></strong>
*************************** 1. row ***************************
       Table: setup_consumers
Create Table: CREATE TABLE `setup_consumers` (
  `NAME` varchar(64) NOT NULL,
  `ENABLED` enum('YES','NO') NOT NULL,
  PRIMARY KEY (`NAME`)
) ENGINE=PERFORMANCE_SCHEMA DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
</pre><p>
      テーブル構造は、<code class="literal">INFORMATION_SCHEMA.COLUMNS</code> などのテーブルから選択するか、<code class="literal">SHOW COLUMNS</code> などのステートメントを使用して取得することもできます。
    </p><p>
      <code class="literal">performance_schema</code> データベース内のテーブルはそれらの中の情報の種類 (現在のイベント、イベント履歴およびサマリー、オブジェクトインスタンス、およびセットアップ (構成) 情報) に従ってグループ化できます。 次の例に、これらのテーブルのいくつかの使用方法を示します。 各グループのテーブルに関する詳細については、<a class="xref" href="performance-schema.html#performance-schema-table-descriptions" title="27.12 パフォーマンススキーマテーブルの説明">セクション27.12「パフォーマンススキーマテーブルの説明」</a>を参照してください。 
    </p><p>
      最初に、すべてのインストゥルメントとコンシューマが有効にされていないため、パフォーマンススキーマはすべてのイベントを収集しません。 これらのすべてをオンにし、イベントタイミングを有効にするには、2 つのステートメントを実行します (行のカウントは MySQL バージョンによって異なることがあります)。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES', TIMED = 'YES';</code></strong>
Query OK, 560 rows affected (0.04 sec)
mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES';</code></strong>
Query OK, 10 rows affected (0.00 sec)
</pre><p>
      現在サーバーが何を行なっているかを確認するには、<code class="literal">events_waits_current</code> テーブルを調査します。 それには、スレッドごとに、各スレッドの最新のモニターされたイベントを示す 1 行が含まれます。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_current\G</code></strong>
*************************** 1. row ***************************
            THREAD_ID: 0
             EVENT_ID: 5523
         END_EVENT_ID: 5523
           EVENT_NAME: wait/synch/mutex/mysys/THR_LOCK::mutex
               SOURCE: thr_lock.c:525
          TIMER_START: 201660494489586
            TIMER_END: 201660494576112
           TIMER_WAIT: 86526
                SPINS: NULL
        OBJECT_SCHEMA: NULL
          OBJECT_NAME: NULL
           INDEX_NAME: NULL
          OBJECT_TYPE: NULL
OBJECT_INSTANCE_BEGIN: 142270668
     NESTING_EVENT_ID: NULL
   NESTING_EVENT_TYPE: NULL
            OPERATION: lock
      NUMBER_OF_BYTES: NULL
                FLAGS: 0
...
</pre><p>
      このイベントは、スレッド 0 が <code class="literal">THR_LOCK::mutex</code> のロック、<code class="literal">mysys</code> サブシステム内の相互排他ロックを獲得するために、86,526 ピコ秒待機していたことを示しています。 最初のいくつかのカラムは次の情報を提供します。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          ID カラムはイベントの発生元のスレッドとイベント番号を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">EVENT_NAME</code> はインストゥルメントされたものを示し、<code class="literal">SOURCE</code> は、インストゥルメントされたコードを含むソースファイルを示します。
        </p></li><li class="listitem"><p>
          タイマーカラムはイベントが開始および停止したタイミングとそれにかかった時間を示します。 イベントがまだ進行中の場合は、<code class="literal">TIMER_END</code> と <code class="literal">TIMER_WAIT</code> の値が <code class="literal">NULL</code> になります。 タイマー値は概算で、ピコ秒で表されます。 タイマーおよびイベント時間コレクションについては、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。 
        </p></li></ul></div><p>
      履歴テーブルには、現在のイベントテーブルと同じ種類の行が含まれますが、ほかの行もあり、サーバーが<span class="quote">「<span class="quote">現在</span>」</span>ではなく、<span class="quote">「<span class="quote">最近</span>」</span>何を実行していたかが示されます。 <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルにはスレッドごとに最新の 10 イベントと最新の 10,000 イベントがそれぞれ含まれます。 たとえば、スレッド 13 によって生成された最新イベントの情報を表示するには、次を実行します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EVENT_ID, EVENT_NAME, TIMER_WAIT</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_history</code></strong>
       <strong class="userinput"><code>WHERE THREAD_ID = 13</code></strong>
       <strong class="userinput"><code>ORDER BY EVENT_ID;</code></strong>
+----------+-----------------------------------------+------------+
| EVENT_ID | EVENT_NAME                              | TIMER_WAIT |
+----------+-----------------------------------------+------------+
|       86 | wait/synch/mutex/mysys/THR_LOCK::mutex  |     686322 |
|       87 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     320535 |
|       88 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     339390 |
|       89 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     377100 |
|       90 | wait/synch/mutex/sql/LOCK_plugin        |     614673 |
|       91 | wait/synch/mutex/sql/LOCK_open          |     659925 |
|       92 | wait/synch/mutex/sql/THD::LOCK_thd_data |     494001 |
|       93 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     222489 |
|       94 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     214947 |
|       95 | wait/synch/mutex/mysys/LOCK_alarm       |     312993 |
+----------+-----------------------------------------+------------+
</pre><p>
      履歴テーブルに新しいイベントが追加されると、テーブルがいっぱいである場合、古いイベントが破棄されます。
    </p><p>
      サマリーテーブルは、時間をかけてすべてのイベントについて集計された情報を提供します。 このグループのテーブルには、さまざまな方法で、イベントデータが要約されます。 もっとも多くの回数実行されたか、またはもっとも待機時間がかかったインストゥルメントを確認するには、<code class="literal">COUNT_STAR</code> または <code class="literal">SUM_TIMER_WAIT</code> カラムで <code class="literal">events_waits_summary_global_by_event_name</code> テーブルをソートします。これらのカラムはすべてのイベント全体で計算された、<code class="literal">COUNT(*)</code> または <code class="literal">SUM(TIMER_WAIT)</code> 値にそれぞれ対応します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, COUNT_STAR</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_summary_global_by_event_name</code></strong>
       <strong class="userinput"><code>ORDER BY COUNT_STAR DESC LIMIT 10;</code></strong>
+---------------------------------------------------+------------+
| EVENT_NAME                                        | COUNT_STAR |
+---------------------------------------------------+------------+
| wait/synch/mutex/mysys/THR_LOCK_malloc            |       6419 |
| wait/io/file/sql/FRM                              |        452 |
| wait/synch/mutex/sql/LOCK_plugin                  |        337 |
| wait/synch/mutex/mysys/THR_LOCK_open              |        187 |
| wait/synch/mutex/mysys/LOCK_alarm                 |        147 |
| wait/synch/mutex/sql/THD::LOCK_thd_data           |        115 |
| wait/io/file/myisam/kfile                         |        102 |
| wait/synch/mutex/sql/LOCK_global_system_variables |         89 |
| wait/synch/mutex/mysys/THR_LOCK::mutex            |         89 |
| wait/synch/mutex/sql/LOCK_open                    |         88 |
+---------------------------------------------------+------------+

mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, SUM_TIMER_WAIT</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_summary_global_by_event_name</code></strong>
       <strong class="userinput"><code>ORDER BY SUM_TIMER_WAIT DESC LIMIT 10;</code></strong>
+----------------------------------------+----------------+
| EVENT_NAME                             | SUM_TIMER_WAIT |
+----------------------------------------+----------------+
| wait/io/file/sql/MYSQL_LOG             |     1599816582 |
| wait/synch/mutex/mysys/THR_LOCK_malloc |     1530083250 |
| wait/io/file/sql/binlog_index          |     1385291934 |
| wait/io/file/sql/FRM                   |     1292823243 |
| wait/io/file/myisam/kfile              |      411193611 |
| wait/io/file/myisam/dfile              |      322401645 |
| wait/synch/mutex/mysys/LOCK_alarm      |      145126935 |
| wait/io/file/sql/casetest              |      104324715 |
| wait/synch/mutex/sql/LOCK_plugin       |       86027823 |
| wait/io/file/sql/pid                   |       72591750 |
+----------------------------------------+----------------+
</pre><p>
      これらの結果には、<code class="literal">THR_LOCK_malloc</code> 相互排他ロックが、その使用される頻度とスレッドがそれを獲得しようとして待機する時間の量の両方に関して、<span class="quote">「<span class="quote">ホット</span>」</span>であることが示されます。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        <code class="literal">THR_LOCK_malloc</code> 相互排他ロックはデバッグビルドでのみ使用されます。 本番ビルドでは、それが存在しないため、ホットではありません。 
      </p></div><p>
      インスタンステーブルは、インストゥルメントされたオブジェクトの種類を記述します。 インストゥルメントされたオブジェクトは、サーバーによって使われると、イベントを生成します。 これらのテーブルは、イベント名と説明のメモまたはステータス情報を提供します。 たとえば、<code class="literal">file_instances</code> テーブルは、ファイル I/O 操作のインストゥルメントのインスタンスとそれらに関連付けられたファイルを一覧表示します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.file_instances\G</code></strong>
*************************** 1. row ***************************
 FILE_NAME: /opt/mysql-log/60500/binlog.000007
EVENT_NAME: wait/io/file/sql/binlog
OPEN_COUNT: 0
*************************** 2. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/tables_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
*************************** 3. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/columns_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
...
</pre><p>
      セットアップテーブルは、モニタリング特性の構成と表示に使われます。 たとえば、<code class="literal">setup_instruments</code> では、イベントを収集できるインストゥルメントのセットがリストされ、有効になっているインストゥルメントが表示されます: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments;</code></strong>
+---------------------------------------------------+---------+-------+
| NAME                                              | ENABLED | TIMED |
+---------------------------------------------------+---------+-------+
...
| stage/sql/end                                     | NO      | NO    |
| stage/sql/executing                               | NO      | NO    |
| stage/sql/init                                    | NO      | NO    |
| stage/sql/insert                                  | NO      | NO    |
...
| statement/sql/load                                | YES     | YES   |
| statement/sql/grant                               | YES     | YES   |
| statement/sql/check                               | YES     | YES   |
| statement/sql/flush                               | YES     | YES   |
...
| wait/synch/mutex/sql/LOCK_global_read_lock        | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                 | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                  | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger         | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect       | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave         | YES     | YES   |
...
| wait/io/file/sql/binlog                           | YES     | YES   |
| wait/io/file/sql/binlog_index                     | YES     | YES   |
| wait/io/file/sql/casetest                         | YES     | YES   |
| wait/io/file/sql/dbopt                            | YES     | YES   |
...
</pre><p>
      インストゥルメント名の解釈方法を理解するには、<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>を参照してください。
    </p><p>
      インストゥルメントのイベントを収集するかどうかを制御するには、その <code class="literal">ENABLED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。 例: 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'NO'</code></strong>
       <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/sql/LOCK_mysql_create_db';</code></strong>
</pre><p>
      パフォーマンススキーマは収集されたイベントを使用して、イベント情報の<span class="quote">「<span class="quote">コンシューマ</span>」</span>として機能する <code class="literal">performance_schema</code> データベース内のテーブルを更新します。 <code class="literal">setup_consumers</code> テーブルは、使用可能なコンシューマとどれが有効にされているかを示します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| events_stages_current            | NO      |
| events_stages_history            | NO      |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
| events_waits_current             | NO      |
| events_waits_history             | NO      |
| events_waits_history_long        | NO      |
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| statements_digest                | YES     |
+----------------------------------+---------+
</pre><p>
      パフォーマンススキーマがコンシューマをイベント情報の宛先として保守するかどうかを制御するには、その <code class="literal">ENABLED</code> 値を設定します。
    </p><p>
      セットアップテーブルについてとそれらを使用して、イベント収集を制御する詳細については、<a class="xref" href="performance-schema.html#performance-schema-filtering" title="27.4.2 パフォーマンススキーマイベントフィルタリング">セクション27.4.2「パフォーマンススキーマイベントフィルタリング」</a>を参照してください。
    </p><p>
      先述のグループのいずれにも分類されないその他のテーブルがいくつかあります。 たとえば、<code class="literal">performance_timers</code> は、使用可能なイベントタイマーとそれらの特性を一覧表示します。 タイマーの詳細については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-build-configuration"></a>27.2 パフォーマンススキーマビルド構成</h2></div></div></div><p>
      パフォーマンススキーマは必須であり、常にでコンパイルされます。 パフォーマンススキーマインストゥルメンテーションの特定の部分を除外できます。 たとえば、ステージインストゥルメンテーションとステートメントインストゥルメンテーションを除外するには、次のようにします: 
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cmake . \</code></strong>
        <strong class="userinput"><code>-DDISABLE_PSI_STAGE=1 \</code></strong>
        <strong class="userinput"><code>-DDISABLE_PSI_STATEMENT=1</code></strong>
</pre><p>
      詳細は、<a class="xref" href="installing.html#source-configuration-options" title="2.9.7 MySQL ソース構成オプション">セクション2.9.7「MySQL ソース構成オプション」</a> の <code class="literal">DISABLE_PSI_<em class="replaceable"><code>XXX</code></em></code> <span class="command"><strong>CMake</strong></span> オプションの説明を参照してください。
    </p><p>
      パフォーマンススキーマを使用せずに構成された以前のインストール (またはテーブルが欠落しているか古い古いバージョンのパフォーマンススキーマを使用して) に MySQL をインストールする場合。 この問題は、エラーログに次のようなメッセージが存在することを示します: 
    </p><pre class="programlisting">[ERROR] Native table 'performance_schema'.'events_waits_history'
has the wrong structure
[ERROR] Native table 'performance_schema'.'events_waits_history_long'
has the wrong structure
...
</pre><p>
      この問題を修正するには、MySQL のアップグレード手順を実行します。 <a class="xref" href="installing.html#upgrading" title="2.11 MySQL のアップグレード">セクション2.11「MySQL のアップグレード」</a>を参照してください。 
    </p><p>
      パフォーマンススキーマは構築時にサーバーに構成されるため、<code class="literal">SHOW ENGINES</code> からの出力に <code class="literal">PERFORMANCE_SCHEMA</code> の行が表示されます。 これは、パフォーマンススキーマが有効ではなく、使用可能であることを意味します。 それを有効にするには、次のセクションで説明するように、サーバーの起動時にそうする必要があります。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-startup-configuration"></a>27.3 パフォーマンススキーマ起動構成</h2></div></div></div><p>
      MySQL パフォーマンススキーマを使用するには、イベント収集を有効にするために、サーバーの起動時に有効にする必要があります。
    </p><p>
      パフォーマンススキーマはデフォルトで有効になっています。 それを明示的に有効または無効にするには、<code class="literal">performance_schema</code> 変数を適切な値に設定して、サーバーを起動します。 たとえば、サーバー <code class="filename">my.cnf</code> ファイルで次の行を使用します: 
    </p><pre class="programlisting">[mysqld]
performance_schema=ON
</pre><p>
      パフォーマンススキーマの初期化時に、サーバーが内部バッファーを割り当てることができない場合、パフォーマンススキーマは自動的に無効になり、<code class="literal">performance_schema</code> を <code class="literal">OFF</code> に設定して、サーバーがインストゥルメンテーションなしで実行します。
    </p><p>
      パフォーマンススキーマでは、サーバーの起動時にインストゥルメントおよびコンシューマ構成も許可されます。
    </p><p>
      サーバー起動時のインストゥルメントを制御するには、この形式のオプションを使用します。
    </p><pre class="programlisting">--performance-schema-instrument='<em class="replaceable"><code>instrument_name</code></em>=<em class="replaceable"><code>value</code></em>'
</pre><p>
      ここで <em class="replaceable"><code>instrument_name</code></em> は <code class="literal">wait/synch/mutex/sql/LOCK_open</code> などのインストゥルメント名で、<em class="replaceable"><code>value</code></em> はこれらのいずれかの値です。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">OFF</code>、<code class="literal">FALSE</code> または <code class="literal">0</code>: インストゥルメントの無効化
        </p></li><li class="listitem"><p>
          <code class="literal">ON</code>、<code class="literal">TRUE</code> または <code class="literal">1</code>: インストゥルメントの有効化および時間
        </p></li><li class="listitem"><p>
          <code class="literal">COUNTED</code>: インストゥルメントを有効にして (時間ではなく) カウント
        </p></li></ul></div><p>
      各 <code class="option">--performance-schema-instrument</code> オプションではインストゥルメント名を 1 つしか指定できませんが、オプションの複数のインスタンスを指定して、複数のインストゥルメントを構成できます。 さらに、インストゥルメント名にパターンを使用でき、パターンに一致するインストゥルメントを構成します。 すべての条件同期インストゥルメントを有効で、カウント対象として構成するには、次のオプションを使用します。 
    </p><pre class="programlisting">--performance-schema-instrument='wait/synch/cond/%=COUNTED'
</pre><p>
      すべてのインストゥルメントを無効にするには、次のオプションを使用します。
    </p><pre class="programlisting">--performance-schema-instrument='%=OFF'
</pre><p>
      例外: <code class="literal">memory/performance_schema/%</code> インストゥルメントは組み込まれており、起動時に無効にすることはできません。
    </p><p>
      長いインストゥルメント名文字列は、順序に関係なく、短いパターン名より優先されます。 インストゥルメントを選択するためのパターンの指定については、<a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="27.4.9 フィルタリング操作のインストゥルメントまたはコンシューマの指定">セクション27.4.9「フィルタリング操作のインストゥルメントまたはコンシューマの指定」</a>を参照してください。 
    </p><p>
      認識されないインストゥルメント名は無視されます。 あとでインストールされたプラグインによってインストゥルメントを作成することは可能で、そのときに名前が認識され、構成されます。 
    </p><p>
      サーバー起動時のコンシューマを制御するには、この形式のオプションを使用します。
    </p><pre class="programlisting">--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<em class="replaceable"><code>value</code></em>
</pre><p>
      ここで、<em class="replaceable"><code>consumer_name</code></em> は <code class="literal">events_waits_history</code> などのコンシューマ名で、<em class="replaceable"><code>value</code></em> はこれらのいずれかです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">OFF</code>、<code class="literal">FALSE</code> または <code class="literal">0</code>: コンシューマのイベントを収集しない
        </p></li><li class="listitem"><p>
          <code class="literal">ON</code>、<code class="literal">TRUE</code> または <code class="literal">1</code>: コンシューマのイベントの収集
        </p></li></ul></div><p>
      たとえば、<code class="literal">events_waits_history</code> コンシューマを有効にするには、次のオプションを使用します。
    </p><pre class="programlisting">--performance-schema-consumer-events-waits-history=ON
</pre><p>
      許可されるコンシューマ名は、<code class="literal">setup_consumers</code> テーブルを調べるとわかります。 パターンは許可されません。 <code class="literal">setup_consumers</code> テーブル内のコンシューマ名は下線が使われますが、起動時に設定されたコンシューマでは、名前の中のダッシュと下線は同等です。 
    </p><p>
      パフォーマンススキーマには、構成情報を提供するいくつかのシステム変数が含まれます。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+--------------------------------------------------------+---------+
| Variable_name                                          | Value   |
+--------------------------------------------------------+---------+
| performance_schema                                     | ON      |
| performance_schema_accounts_size                       | 100     |
| performance_schema_digests_size                        | 200     |
| performance_schema_events_stages_history_long_size     | 10000   |
| performance_schema_events_stages_history_size          | 10      |
| performance_schema_events_statements_history_long_size | 10000   |
| performance_schema_events_statements_history_size      | 10      |
| performance_schema_events_waits_history_long_size      | 10000   |
| performance_schema_events_waits_history_size           | 10      |
| performance_schema_hosts_size                          | 100     |
| performance_schema_max_cond_classes                    | 80      |
| performance_schema_max_cond_instances                  | 1000    |
...
</pre><p>
      <code class="literal">performance_schema</code> 変数は <code class="literal">ON</code> または <code class="literal">OFF</code> で、パフォーマンススキーマが有効か無効かを示します。 ほかの変数はテーブルサイズ (行数) やメモリー割り当て値を示します。 
    </p><a class="indexterm" name="idm45882613380704"></a><a class="indexterm" name="idm45882613378512"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        パフォーマンススキーマが有効にされている場合、パフォーマンススキーマインスタンスの数は、おそらく大きくサーバーメモリーフットプリントに影響します。 パフォーマンススキーマは、必要なだけメモリーを使用するように多くのパラメータを自動スケーリングします。<a class="xref" href="performance-schema.html#performance-schema-memory-model" title="27.17 パフォーマンススキーマのメモリー割り当てモデル">セクション27.17「パフォーマンススキーマのメモリー割り当てモデル」</a> を参照してください。 
      </p></div><p>
      パフォーマンススキーマシステム変数の値を変更するには、それらをサーバー起動時に設定します。 たとえば、待機イベントの履歴テーブルのサイズを変更するには、<code class="filename">my.cnf</code> ファイルに次の行を挿入します: 
    </p><pre class="programlisting">[mysqld]
performance_schema
performance_schema_events_waits_history_size=20
performance_schema_events_waits_history_long_size=15000
</pre><p>
      パフォーマンススキーマは、明示的に設定されていない場合、サーバーの起動時にいくつかのパラメータの値のサイズを自動的に設定します。 たとえば、それはイベント待機テーブルのサイズを制御するパラメータをこのようにサイズ設定します。 パフォーマンススキーマは、サーバーの起動時に必要なすべてのメモリーを割り当てるのではなく、メモリー使用量を実際のサーバー負荷に合わせて増分的に割り当てます。 したがって、多くのサイズ設定パラメータを設定する必要はありません。 自動サイズ設定または自動スケール設定されているパラメータを確認するには、<span class="command"><strong>mysqld --verbose --help</strong></span> を使用してオプションの説明を調べるか、<a class="xref" href="performance-schema.html#performance-schema-system-variables" title="27.15 パフォーマンススキーマシステム変数">セクション27.15「パフォーマンススキーマシステム変数」</a> を参照してください。 
    </p><p>
      サーバーの起動時に設定されない自動サイズ設定されたパラメータごとに、パフォーマンススキーマは次のシステム値の値に基づいてその値を設定する方法を決定します。これらの値は、MySQL サーバーの構成方法について<span class="quote">「<span class="quote">「ヒント」</span>」</span>とみなされます:
    </p><pre class="programlisting">max_connections
open_files_limit
table_definition_cache
table_open_cache
</pre><p>
      特定のパラメータの自動サイズ設定または自動スケーリングをオーバーライドするには、起動時に−1 以外の値に設定します。 この場合、パフォーマンススキーマはそれに指定された値を割り当てます。 
    </p><p>
      実行時に、<code class="literal">SHOW VARIABLES</code> では、自動サイズ設定されたパラメータに設定されていた実際の値が表示されます。 自動スケールされたパラメータは−1 の値で表示されます。 
    </p><p>
      パフォーマンススキーマが無効になっている場合、その自動サイズ変更されたパラメータと自動スケール変更されたパラメータは−1 のままで、<code class="literal">SHOW VARIABLES</code> には−1 と表示されます。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-runtime-configuration"></a>27.4 パフォーマンススキーマ実行時構成</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-timing">27.4.1 パフォーマンススキーマイベントタイミング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering">27.4.2 パフォーマンススキーマイベントフィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-pre-filtering">27.4.3 イベントの事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-filtering">27.4.4 インストゥルメントによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-object-filtering">27.4.5 オブジェクトによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-thread-filtering">27.4.6 スレッドによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-filtering">27.4.7 コンシューマによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-configurations">27.4.8 コンシューマ構成の例</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering-names">27.4.9 フィルタリング操作のインストゥルメントまたはコンシューマの指定</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrumentation-checking">27.4.10 インストゥルメントされているものの特定</a></span></dt></dl></div><p>
      実行時に特定のパフォーマンススキーマ機能を有効にして、発生するイベント収集のタイプを制御できます。
    </p><p>
      パフォーマンススキーマセットアップテーブルには、モニタリング構成に関する情報が含まれます。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
       <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema'</code></strong>
       <strong class="userinput"><code>AND TABLE_NAME LIKE 'setup%';</code></strong>
+-------------------+
| TABLE_NAME        |
+-------------------+
| setup_actors      |
| setup_consumers   |
| setup_instruments |
| setup_objects     |
| setup_threads     |
+-------------------+
</pre><p>
      これらのテーブルの内容を調査して、パフォーマンススキーマのモニタリング特性に関する情報を取得できます。 <code class="literal">UPDATE</code> 権限を持っている場合は、セットアップテーブルを変更して、モニタリングが行われる方法に影響するパフォーマンススキーマ操作を変更できます。 これらのテーブルの追加の詳細については、<a class="xref" href="performance-schema.html#performance-schema-setup-tables" title="27.12.2 パフォーマンススキーマセットアップテーブル">セクション27.12.2「パフォーマンススキーマセットアップテーブル」</a>を参照してください。 
    </p><p>
      <code class="literal">setup_instruments</code> および <code class="literal">setup_consumers</code> テーブルは、イベントを収集できるインストゥルメントと、イベント情報が実際に収集されるコンシューマの種類をそれぞれ一覧表示します。 その他のセットアップテーブルにより、モニタリング構成をさらに変更できます。<a class="xref" href="performance-schema.html#performance-schema-filtering" title="27.4.2 パフォーマンススキーマイベントフィルタリング">セクション27.4.2「パフォーマンススキーマイベントフィルタリング」</a>では、イベントコレクションに影響するように、これらのテーブルをどのように変更できるかについて説明しています。 
    </p><p>
      実行時に SQL ステートメントを使用して行う必要があるパフォーマンススキーマ構成の変更があり、サーバーが起動するたびにこれらの変更を有効にする場合は、ステートメントをファイルに配置し、ファイルに名前を付けるように設定された <code class="literal">init_file</code> システム変数を使用してサーバーを起動します。 この戦略は、簡易サーバーヘルスモニタリング、インシデント調査、アプリケーション動作のトラブルシューティングなど、さまざまな種類のモニタリングを生成するようにそれぞれカスタマイズされている複数のモニタリング構成がある場合にも役に立つ可能性があります。 各監視構成のステートメントを独自のファイルに配置し、サーバーの起動時に <code class="literal">init_file</code> 値として適切なファイルを指定します。 
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-timing"></a>27.4.1 パフォーマンススキーマイベントタイミング</h3></div></div></div><p>
        イベントは、サーバーソースコードに追加されたインストゥルメンテーションを使用して収集されます。 インストゥルメントはイベントの時間を測定しますが、これはパフォーマンススキーマがイベントにどれくらいの時間がかかるかを知らせる方法です。 タイミング情報を収集しないようにインストゥルメントを構成することもできます。 このセクションでは、使用可能なタイマーとそれらの特性、およびイベント内のタイミング値を表す方法について説明します。 
      </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-timers"></a>パフォーマンススキーマタイマー</h4></div></div></div><p>
          パフォーマンススキーマタイマーは、精度とオーバーヘッドの量が異なります。 使用可能なタイマーとそれらの特性を確認するには、<code class="literal">performance_timers</code> テーブルをチェックしてください。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |      1000000000 |                1 |            112 |
| MICROSECOND |         1000000 |                1 |            136 |
| MILLISECOND |            1036 |                1 |            168 |
+-------------+-----------------+------------------+----------------+
</pre><p>
          特定のタイマーに関連付けられた値が <code class="literal">NULL</code> の場合、そのタイマーはプラットフォームでサポートされていません。
        </p><p>
          カラムの意味は次のとおりです:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code> カラムには使用可能なタイマーの名前が表示されます。 <code class="literal">CYCLE</code> は CPU (プロセッサ) サイクルカウンタに基づいたタイマーを表します。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_FREQUENCY</code> は、1 秒あたりのタイマー単位数を示します。 サイクルタイマーの場合、頻度は一般に CPU 速度に関連します。 示された値は、2.4GHz プロセッサを搭載するシステムで取得されました。 ほかのタイマーは固定の数秒に基づきます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_RESOLUTION</code> は、タイマー値が一度に増加するタイマー単位数を示します。 タイマーの分解能が 10 の場合、その値は毎回 10 ずつ増加します。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_OVERHEAD</code> は特定のタイマーで 1 つのタイミングを取得するためのオーバーヘッドの最小サイクル数です。 タイマーはイベントの開始と終了で呼び出されるため、イベントあたりのオーバーヘッドは表示される値の 2 倍になります。 
            </p></li></ul></div><p>
          パフォーマンススキーマは、次のようにタイマーを割り当てます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              待機タイマーは <code class="literal">CYCLE</code> を使用します。
            </p></li><li class="listitem"><p>
              アイドルタイマー、ステージタイマー、ステートメントタイマーおよびトランザクションタイマーは、<code class="literal">NANOSECOND</code> タイマーが使用可能なプラットフォームでは <code class="literal">NANOSECOND</code> を使用し、それ以外の場合は <code class="literal">MICROSECOND</code> を使用します。
            </p></li></ul></div><p>
          サーバーの起動時に、パフォーマンススキーマは構築時にタイマーの割り当てに関する仮定が正しいことを検証し、タイマーが使用できない場合は警告を表示します。
        </p><p>
          待機イベントを時間するには、タイマーの精度を犠牲にしてオーバーヘッドを削減することが最も重要な基準であるため、<code class="literal">CYCLE</code> タイマーを使用することをお薦めします。
        </p><p>
          ステートメント (またはステージ) の実行にかかる時間は、一般に単一の待機の実行にかかる時間より桁違いに大きくなります。 ステートメントの時間を測定するために、もっとも重要な基準は、プロセッサの周波数の変更に影響を受けない正確な測定基準を設定することであるため、サイクルに基づいていないタイマーを使用することがもっとも適切です。 ステートメントのデフォルトのタイマーは <code class="literal">NANOSECOND</code> です。 <code class="literal">CYCLE</code> タイマーと比較すると、余分な<span class="quote">「<span class="quote">「オーバーヘッド」</span>」</span>は重要ではありません。これは、タイマーのコールによって発生するオーバーヘッド (ステートメントの開始時に一度、終了時に一度) が、ステートメント自体の実行に使用される CPU 時間と比較して大幅に低いためです。 <code class="literal">CYCLE</code> タイマーを使用することにはメリットがなく、欠点だけです。 
        </p><p>
          サイクルカウンタによって提供される精度はプロセッサ速度によって異なります。 プロセッサが 1 GHz (10 億サイクル/秒) 以上で実行する場合、サイクルカウンタはナノ秒未満の精度を実現します。 サイクルカウンタを使用することは、実際の時間を取得するより、はるかに負荷が小さくなります。 たとえば、標準 <code class="literal">gettimeofday()</code> 関数は数百サイクルかかる可能性があり、これは 1 秒あたり数千または数百万回発生する可能性のあるデータ収集では、許容できないオーバーヘッドです。 
        </p><p>
          サイクルカウンタには欠点もあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              エンドユーザーは、何分の 1 秒などの時計の単位でタイミングを知ることを期待します。 サイクルから秒に変換することは大きな負荷がかかる可能性があります。 このため、変換はすばやいかなり概算的な乗算演算です。 
            </p></li><li class="listitem"><p>
              ラップトップが節電モードになったときや熱の生成を抑えるために、CPU の速度が低下したときなどに、プロセッササイクルレートが変わることがあります。 プロセッサのサイクルレートが変動した場合、サイクルから実時間単位への変換でエラーが発生することがあります。 
            </p></li><li class="listitem"><p>
              サイクルカウンタは、プロセッサやオペレーティングシステムによって、信頼できない場合や使用できない場合があります。 たとえば、Pentium では、命令は <code class="literal">RDTSC</code> (C 命令ではなくアセンブリ言語) であり、理論上オペレーティングシステムはユーザーモードプログラムのその使用を妨げることができます。 
            </p></li><li class="listitem"><p>
              異常実行またはマルチプロセッサ同期に関する一部のプロセッサの詳細により、カウンタが最大 1000 サイクルごとに高速になったり、低速になったりするように見えることがあります。
            </p></li></ul></div><p>
          MySQL は、x386 (Windows、macOS、Linux、Solaris、その他の UNIX フレーバ)、PowerPC、IA-64 のサイクルカウンタで動作します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-timing-in-events"></a>イベントでのパフォーマンススキーマのタイマー表現</h4></div></div></div><p>
          現在のイベントおよび履歴イベントを格納する「パフォーマンススキーマ」テーブルの行には、タイミング情報をテーブルす 3 つのカラムがあります: <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> はイベントがいつ開始および終了したかを示し、<code class="literal">TIMER_WAIT</code> はイベント期間を示します。
        </p><p>
          <code class="literal">setup_instruments</code> テーブルにはイベントを収集するインストゥルメントを示す <code class="literal">ENABLED</code> カラムがあります。 このテーブルには、時間が測定されるインストゥルメントを示す <code class="literal">TIMED</code> カラムもあります。 インストゥルメントが有効にされていない場合、イベントを生成しません。 有効にされているインストゥルメントの時間が測定されない場合、インストゥルメントによって生成されたイベントの <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> タイマー値が <code class="literal">NULL</code> になります。 これにより、サマリーテーブルの集計時間値 (合計、最小、最大および平均) の計算時にこれらの値が無視されます。 
        </p><p>
          内部的には、イベント内の時間は、イベントタイミングの開始時に有効なタイマーで指定された単位で格納されます。 イベントが「パフォーマンススキーマ」テーブルから取得されたときに表示されるように、時間はピコ秒 (1 秒に 1 兆) で表示され、選択されているタイマーに関係なく標準単位に正規化されます。 
        </p><p>
          サーバー起動時のパフォーマンススキーマの初期化で、タイマーベースライン (<span class="quote">「<span class="quote">時間ゼロ</span>」</span>) が発生します。 イベント内の <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値はベースライン以降のピコ秒を表します。 <code class="literal">TIMER_WAIT</code> 値はピコ秒での期間です。 
        </p><p>
          イベント内のピコ秒値は概算です。 それらの精度は、ある単位から別の単位への変換に伴う通常の誤差の形式に左右されます。 <code class="literal">CYCLE</code> タイマーが使われ、プロセッサのレートがさまざまに異なる場合、ドリフトが発生することがあります。 このため、サーバーの起動から経過した時間の正確な測定基準として、イベントの <code class="literal">TIMER_START</code> 値を見ることは妥当ではありません。 一方、開始時間や期間によって、イベントを順序付けるために、<code class="literal">ORDER BY</code> 句に <code class="literal">TIMER_START</code> 値または <code class="literal">TIMER_WAIT</code> 値を使用することは適切です。 
        </p><p>
          イベントでマイクロ秒などの値ではなく、ピコ秒を選択したことには、パフォーマンス上の根拠があります。 1 つの実装目標は、タイマーに関係なく、統一された時間単位で結果を表示することでした。 理想の世界では、この時間単位は時計の単位のように見え、適度に正確である、つまりマイクロ秒です。 ただし、サイクルまたはナノ秒をマイクロ秒に変換するには、すべてのインストゥルメンテーションで除算を実行する必要がある場合があります。 除算は多くのプラットフォームで高い負荷がかかります。 乗算は負荷が高くないため、それを使用しています。 そのため、時間単位は、大きな精度の損失がないように十分に大きな乗数を使用した、可能なかぎり最大の <code class="literal">TIMER_FREQUENCY</code> 値の整数の倍数です。 その結果、時間単位が<span class="quote">「<span class="quote">ピコ秒</span>」</span>になります。 この精度は疑似ですが、この決定によりオーバーヘッドを最小にすることができます。 
        </p><p>
          wait、stage、statement、または transaction イベントの実行中、各 current-event テーブルには現在のイベントのタイミング情報が表示されます:
        </p><pre class="programlisting">events_waits_current
events_stages_current
events_statements_current
events_transactions_current
</pre><p>
          完了していないイベントが実行されている期間を判別できるように、タイマーカラムは次のように設定されます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TIMER_START</code> が移入されます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_END</code> には、現在のタイマー値が移入されます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_WAIT</code> には、これまでの経過時間 (<code class="literal">TIMER_END</code> − <code class="literal">TIMER_START</code>) が移入されます。
            </p></li></ul></div><p>
          まだ完了していないイベントの <code class="literal">END_EVENT_ID</code> 値は <code class="literal">NULL</code> です。 イベントについてこれまでに経過した時間を評価するには、<code class="literal">TIMER_WAIT</code> カラムを使用します。 したがって、まだ完了しておらず、これまでに <em class="replaceable"><code>N</code></em> ピコ秒より長くかかったイベントを識別するために、モニタリングアプリケーションはクエリーで次の式を使用できます: 
        </p><pre class="programlisting">WHERE END_EVENT_ID IS NULL AND TIMER_WAIT &gt; <em class="replaceable"><code>N</code></em>
</pre><p>
          前述のイベント識別では、対応するインストゥルメントの <code class="literal">ENABLED</code> および <code class="literal">TIMED</code> が <code class="literal">YES</code> に設定されており、関連するコンシューマが有効になっていることを前提としています。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-filtering"></a>27.4.2 パフォーマンススキーマイベントフィルタリング</h3></div></div></div><a class="indexterm" name="idm45882613257616"></a><a class="indexterm" name="idm45882613255456"></a><a class="indexterm" name="idm45882613253360"></a><p>
        イベントはプロデューサ/コンシューマ方式で処理されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            インストゥルメントされたコードは、イベントのソースで、収集されるイベントを生成します。 <code class="literal">setup_instruments</code> テーブルは、イベントを収集できるインストゥルメント、それらが有効にされているかどうか、および (有効にされているインストゥルメントの場合) タイミング情報を収集するかどうかを一覧表示します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments;</code></strong>
+---------------------------------------------------+---------+-------+
| NAME                                              | ENABLED | TIMED |
+---------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock        | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                 | YES     | YES   |
...
</pre><p>
            <code class="literal">setup_instruments</code> テーブルはイベント生成のもっとも基本的な制御の形式を提供します。 モニターされるオブジェクトやスレッドの種類に基づいて、イベント生成をさらに絞り込むには、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>に説明するように、ほかのテーブルを使用できます。 
          </p></li><li class="listitem"><p>
            パフォーマンススキーマテーブルは、イベントの宛先で、イベントを消費します。 <code class="literal">setup_consumers</code> テーブルは、イベント情報を送信できるコンシューマの種類とそれらが有効にされているかどうかを一覧表示します。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| events_stages_current            | NO      |
| events_stages_history            | NO      |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
| events_waits_current             | NO      |
| events_waits_history             | NO      |
| events_waits_history_long        | NO      |
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| statements_digest                | YES     |
+----------------------------------+---------+
</pre></li></ul></div><p>
        フィルタリングはパフォーマンスモニタリングのさまざまなステージで実行できます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b>事前フィルタリング. </b>
              これは、プロデューサから特定の種類のイベントのみが収集され、収集されたイベントが特定のコンシューマのみを更新するように、パフォーマンススキーマ構成を変更することによって行われます。 これを実行するには、インストゥルメントまたはコンシューマを有効または無効にします。 事前フィルタリングは、パフォーマンススキーマによって行われ、すべてのユーザーに適用されるグローバルな効果を持ちます。 
            </p><p>
            事前フィルタリングを使用する理由:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                オーバーヘッドを削減するため。 パフォーマンススキーマのオーバーヘッドは、すべてのインストゥルメントを有効にしていても最小であるはずですが、さらに縮小したいと考える可能性があります。 または、タイミングイベントに関心がなく、タイミングオーバーヘッドを解消するために、タイミングコードを無効にしたいと考えます。 
              </p></li><li class="listitem"><p>
                関心のないイベントの現在のイベントまたは履歴テーブルへの入力を妨げるため。 事前フィルタリングにより、これらのテーブル内に、有効なインストゥルメントの種類の行のインスタンス用に多くの<span class="quote">「<span class="quote">空き</span>」</span>を残します。 事前フィルタリングでファイルインストゥルメントのみを有効にしている場合、非ファイルインストゥルメントの行は収集されません。 事後フィルタリングで、非ファイルイベントが収集され、ファイルイベントの少ない行が残されます。 
              </p></li><li class="listitem"><p>
                特定の種類のイベントテーブルの保守を回避するため。 コンシューマを無効にすると、サーバーはそのコンシューマの宛先の保守に時間を費やさなくなります。 たとえば、イベント履歴に関心がない場合、履歴テーブルコンシューマを無効にして、パフォーマンスを向上できます。 
              </p></li></ul></div></li><li class="listitem"><p><b>事後フィルタリング. </b>
              これには、クエリー内で、パフォーマンススキーマテーブルから情報を選択する <code class="literal">WHERE</code> 句を使用して、使用可能なイベントのうち表示したいものを指定することが含まれます。 事後フィルタリングは、各ユーザーが使用可能なイベントのうち関心のあるものを選択するため、ユーザー単位で実行されます。 
            </p><p>
            事後フィルタリングを使用する理由:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                関心のあるイベント情報に関して、個々のユーザーの決断を避けるため。
              </p></li><li class="listitem"><p>
                事前フィルタリングの使用に課せられる制限が前もってわからない場合に、パフォーマンススキーマを使用して、パフォーマンスの問題を調査するため。
              </p></li></ul></div></li></ul></div><p>
        次のセクションでは、事前フィルタリングの詳細を説明し、フィルタリング操作でインストゥルメントやコンシューマを指定するためのガイドラインを提供します。 情報を取得するためのクエリーの書き方 (事後フィルタリング) については、<a class="xref" href="performance-schema.html#performance-schema-queries" title="27.5 パフォーマンススキーマクエリー">セクション27.5「パフォーマンススキーマクエリー」</a>を参照してください。 
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-pre-filtering"></a>27.4.3 イベントの事前フィルタリング</h3></div></div></div><p>
        事前フィルタリングは、パフォーマンススキーマによって行われ、すべてのユーザーに適用されるグローバルな効果を持ちます。 事前フィルタリングは、イベント処理のプロデューサまたはコンシューマステージに適用できます。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            プロデューサステージで事前フィルタリングを構成するには、いくつかのテーブルを使用できます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">setup_instruments</code> は使用可能なインストゥルメントを示します。 このテーブルで無効にされているインストゥルメントは、ほかの生成関連セットアップテーブルの内容に関係なく、イベントを生成しません。 このテーブルで有効にされているインストゥルメントは、イベントの生成が許可され、ほかのテーブルの内容に依存します。 
              </p></li><li class="listitem"><p>
                <code class="literal">setup_objects</code> は、パフォーマンススキーマが特定のテーブルおよびストアドプログラムオブジェクトをモニターするかどうかを制御します。
              </p></li><li class="listitem"><p>
                <code class="literal">threads</code> スレッドは各サーバースレッドでモニタリングが有効にされているかどうかを示します。
              </p></li><li class="listitem"><p>
                <code class="literal">setup_actors</code> は、新しいフォアグラウンドスレッドの初期モニタリング状態を決定します。
              </p></li></ul></div></li><li class="listitem"><p>
            コンシューマステージで事前フィルタリングを構成するには、<code class="literal">setup_consumers</code> テーブルを変更します。 これによって、イベントの送信先が決まります。<code class="literal">setup_consumers</code> はイベント生成にも暗黙的に影響します。 指定されたイベントがどの宛先にも送信されない (つまり、消費されない) 場合、パフォーマンススキーマはそれを生成しません。 
          </p></li></ul></div><p>
        これらのテーブルのいずれかを変更すると、すぐに監視に影響しますが、<code class="literal">setup_actors</code> テーブルを変更すると、変更後に作成されたフォアグラウンドスレッドにのみ影響し、既存のスレッドには影響しません。
      </p><p>
        モニタリング構成を変更すると、パフォーマンススキーマは履歴テーブルをフラッシュしません。 すでに収集されたイベントは、新しいイベントによって置き換えられるまで、現在のイベントと履歴テーブルに残ります。 インストゥルメントを無効にする場合、それらのイベントが関心のある新しいイベントによって置き換えられるまで、しばらく待つ必要がある場合があります。 または、<code class="literal">TRUNCATE TABLE</code> を使用して、履歴テーブルを空にします。 
      </p><p>
        インストゥルメンテーションの変更後、サマリーテーブルを切り捨てることが必要になる場合があります。 一般に、サマリーカラムは行を削除するのではなく、0 または <code class="literal">NULL</code> にリセットされます。 これにより、収集された値をクリアし、アグリゲーションを再開できます。 それは、実行時構成の変更を行なったあとなどに便利な場合があります。 この切捨て動作の例外は、個々のサマリーテーブルのセクションに記載されています。 
      </p><p>
        次のセクションでは、特定のテーブルを使用して、パフォーマンススキーマの事前フィルタリングを制御する方法について説明します。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-instrument-filtering"></a>27.4.4 インストゥルメントによる事前フィルタリング</h3></div></div></div><p>
        <code class="literal">setup_instruments</code> テーブルは使用可能なインストゥルメントを一覧表示します。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments;</code></strong>
+---------------------------------------------------+---------+-------+
| NAME                                              | ENABLED | TIMED |
+---------------------------------------------------+---------+-------+
...
| stage/sql/end                                     | NO      | NO    |
| stage/sql/executing                               | NO      | NO    |
| stage/sql/init                                    | NO      | NO    |
| stage/sql/insert                                  | NO      | NO    |
...
| statement/sql/load                                | YES     | YES   |
| statement/sql/grant                               | YES     | YES   |
| statement/sql/check                               | YES     | YES   |
| statement/sql/flush                               | YES     | YES   |
...
| wait/synch/mutex/sql/LOCK_global_read_lock        | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                 | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                  | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger         | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect       | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave         | YES     | YES   |
...
| wait/io/file/sql/binlog                           | YES     | YES   |
| wait/io/file/sql/binlog_index                     | YES     | YES   |
| wait/io/file/sql/casetest                         | YES     | YES   |
| wait/io/file/sql/dbopt                            | YES     | YES   |
...
</pre><p>
        インストゥルメントを有効にするかどうかを制御するには、その <code class="literal">ENABLED</code> カラムを <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。 有効にされたインストゥルメントのタイミング情報を収集するかどうかを構成するには、その <code class="literal">TIMED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。 <code class="literal">TIMED</code> カラムを設定すると、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>に説明するように、パフォーマンススキーマテーブルの内容に影響します。 
      </p><p>
        ほとんどの <code class="literal">setup_instruments</code> 行を変更すると、すぐに監視に影響します。 一部のインストゥルメントでは、変更はサーバーの起動時にのみ有効です。実行時に変更しても効果はありません。 これは主にサーバー内の mutex、条件、および rwlocks に影響しますが、これが当てはまるほかのインストゥルメントが存在する可能性があります。 
      </p><p>
        <code class="literal">setup_instruments</code> テーブルはイベント生成のもっとも基本的な制御の形式を提供します。 モニターされるオブジェクトやスレッドの種類に基づいて、イベント生成をさらに絞り込むには、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>に説明するように、ほかのテーブルを使用できます。 
      </p><p>
        次の例に、<code class="literal">setup_instruments</code> テーブルへの可能な操作を示します。 ほかの事前フィルタリング操作と同様に、これらの変更はすべてのユーザーに影響します。 これらの一部のクエリーでは、<code class="literal">LIKE</code> 演算子とパターンマッチインストゥルメント名を使用しています。 インストゥルメントを選択するためのパターンの指定に関する追加情報については、<a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="27.4.9 フィルタリング操作のインストゥルメントまたはコンシューマの指定">セクション27.4.9「フィルタリング操作のインストゥルメントまたはコンシューマの指定」</a>を参照してください。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            すべてのインストゥルメントを無効にします。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO';
</pre><p>
            これで、イベントは収集されません。
          </p></li><li class="listitem"><p>
            すべてのインストゥルメントを無効にし、それらを現在の無効にされているインストゥルメントのセットに追加します。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO'
WHERE NAME LIKE 'wait/io/file/%';
</pre></li><li class="listitem"><p>
            ファイルインストゥルメントのみを無効にし、ほかのすべてのインストゥルメントを有効にします。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = IF(NAME LIKE 'wait/io/file/%', 'NO', 'YES');
</pre></li><li class="listitem"><p>
            <code class="literal">mysys</code> ライブラリ内のインストゥルメントを除くすべてのインストゥルメントを有効にします。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = CASE WHEN NAME LIKE '%/mysys/%' THEN 'YES' ELSE 'NO' END;
</pre></li><li class="listitem"><p>
            特定のインストゥルメントを無効にします。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO'
WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';
</pre></li><li class="listitem"><p>
            インストゥルメントの状態を切り替えるには、その <code class="literal">ENABLED</code> 値を<span class="quote">「<span class="quote">反転</span>」</span>します。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = IF(ENABLED = 'YES', 'NO', 'YES')
WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';
</pre></li><li class="listitem"><p>
            すべてのイベントのタイミングを無効にします。
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET TIMED = 'NO';
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-object-filtering"></a>27.4.5 オブジェクトによる事前フィルタリング</h3></div></div></div><p>
        <code class="literal">setup_objects</code> テーブルは、パフォーマンススキーマが特定のテーブルおよびストアドプログラムオブジェクトをモニターするかどうかを制御します。 初期 <code class="literal">setup_objects</code> の内容は次のように見えます。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| EVENT       | mysql              | %           | NO      | NO    |
| EVENT       | performance_schema | %           | NO      | NO    |
| EVENT       | information_schema | %           | NO      | NO    |
| EVENT       | %                  | %           | YES     | YES   |
| FUNCTION    | mysql              | %           | NO      | NO    |
| FUNCTION    | performance_schema | %           | NO      | NO    |
| FUNCTION    | information_schema | %           | NO      | NO    |
| FUNCTION    | %                  | %           | YES     | YES   |
| PROCEDURE   | mysql              | %           | NO      | NO    |
| PROCEDURE   | performance_schema | %           | NO      | NO    |
| PROCEDURE   | information_schema | %           | NO      | NO    |
| PROCEDURE   | %                  | %           | YES     | YES   |
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
| TRIGGER     | mysql              | %           | NO      | NO    |
| TRIGGER     | performance_schema | %           | NO      | NO    |
| TRIGGER     | information_schema | %           | NO      | NO    |
| TRIGGER     | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
        <code class="literal">setup_objects</code> テーブルへの変更はただちにオブジェクトモニタリングに影響します。
      </p><p>
        <code class="literal">OBJECT_TYPE</code> カラムは行が適用されるオブジェクトの種類を示します。 <code class="literal">TABLE</code> フィルタリングはテーブル I/O イベント (<code class="literal">wait/io/table/sql/handler</code> インストゥルメント) およびテーブルロックイベント (<code class="literal">wait/lock/table/sql/handler</code> インストゥルメント) に影響します。 
      </p><p>
        <code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code> カラムには、リテラルスキーマまたはオブジェクト名、あるいは任意の名前に一致する<code class="literal">'%'</code>が含まれている必要があります。
      </p><p>
        <code class="literal">ENABLED</code> カラムは一致するオブジェクトがモニターされているかどうかを示し、<code class="literal">TIMED</code> はタイミング情報を収集するかどうかを示します。 <code class="literal">TIMED</code> カラムを設定すると、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>に説明するように、パフォーマンススキーマテーブルの内容に影響します。 
      </p><p>
        デフォルトのオブジェクト構成の効果は、<code class="literal">mysql</code>、<code class="literal">INFORMATION_SCHEMA</code> および <code class="literal">performance_schema</code> データベースのオブジェクトを除くすべてのオブジェクトをインスツルメント処理することです。 (<code class="literal">INFORMATION_SCHEMA</code> データベース内のテーブルは、<code class="literal">setup_objects</code> の内容に関係なくインストゥルメントされず、<code class="literal">information_schema.%</code> の行は単にこのデフォルトを明示します。) 
      </p><p>
        パフォーマンススキーマは、<code class="literal">setup_objects</code> の一致をチェックする場合、まずより詳細な一致を見つけようとします。 特定の <code class="literal">OBJECT_TYPE</code> に一致する行の場合、パフォーマンススキーマは次の順序で行をチェックします: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">OBJECT_SCHEMA='<em class="replaceable"><code>literal</code></em>'</code>および <code class="literal">OBJECT_NAME='<em class="replaceable"><code>literal</code></em>'</code>を含む行。
          </p></li><li class="listitem"><p>
            <code class="literal">OBJECT_SCHEMA='<em class="replaceable"><code>literal</code></em>'</code>および <code class="literal">OBJECT_NAME='%'</code>を含む行。
          </p></li><li class="listitem"><p>
            <code class="literal">OBJECT_SCHEMA='%'</code>および <code class="literal">OBJECT_NAME='%'</code>を含む行。
          </p></li></ul></div><p>
        たとえば、テーブル <code class="literal">db1.t1</code> の場合、パフォーマンススキーマは <code class="literal">TABLE</code> の行で<code class="literal">'db1'</code>と<code class="literal">'t1'</code>の一致を検索し、次に<code class="literal">'db1'</code>と<code class="literal">'%'</code>の一致を検索し、次に<code class="literal">'%'</code>と<code class="literal">'%'</code>の一致を検索します。 さまざまな一致する <code class="literal">setup_objects</code> 行はさまざまな <code class="literal">ENABLED</code> 値と <code class="literal">TIMED</code> 値を持つ可能性があるため、一致が発生する順序が重要です。 
      </p><p>
        テーブル関連イベントの場合、パフォーマンススキーマは <code class="literal">setup_objects</code> の内容と <code class="literal">setup_instruments</code> を組み合わせて、インストゥルメントを有効にするかどうか、および有効にされているインストゥルメントの時間を測定するかどうかを判断します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_objects</code> 内の行に一致するテーブルでは、テーブルインストゥルメントは、<code class="literal">setup_instruments</code> と <code class="literal">setup_objects</code> の両方で、<code class="literal">ENABLED</code> が <code class="literal">YES</code> である場合にのみイベントを生成します。
          </p></li><li class="listitem"><p>
            両方の値が <code class="literal">YES</code> の場合にのみ、タイミング情報が収集されるように、2 つのテーブル内の <code class="literal">TIMED</code> 値が組み合わされます。
          </p></li></ul></div><p>
        ストアドプログラムオブジェクトの場合、パフォーマンススキーマは <code class="literal">ENABLED</code> および <code class="literal">TIMED</code> カラムを <code class="literal">setup_objects</code> 行から直接取得します。 <code class="literal">setup_instruments</code> との値の組合せはありません。 
      </p><p>
        <code class="literal">setup_objects</code> に、<code class="literal">db1</code>、<code class="literal">db2</code> および <code class="literal">db3</code> に適用される次の <code class="literal">TABLE</code> 行が含まれているとします:
      </p><pre class="programlisting">+-------------+---------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA | OBJECT_NAME | ENABLED | TIMED |
+-------------+---------------+-------------+---------+-------+
| TABLE       | db1           | t1          | YES     | YES   |
| TABLE       | db1           | t2          | NO      | NO    |
| TABLE       | db2           | %           | YES     | YES   |
| TABLE       | db3           | %           | NO      | NO    |
| TABLE       | %             | %           | YES     | YES   |
+-------------+---------------+-------------+---------+-------+
</pre><p>
        <code class="literal">setup_instruments</code> のオブジェクト関連インストゥルメントの <code class="literal">ENABLED</code> 値が <code class="literal">NO</code> の場合、オブジェクトのイベントは監視されません。 <code class="literal">ENABLED</code> 値が <code class="literal">YES</code> の場合、イベントモニタリングは、関連 <code class="literal">setup_objects</code> 行内の <code class="literal">ENABLED</code> 値に従って行われます。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">db1.t1</code> イベントはモニターされます
          </p></li><li class="listitem"><p>
            <code class="literal">db1.t2</code> イベントはモニターされません
          </p></li><li class="listitem"><p>
            <code class="literal">db2.t3</code> イベントはモニターされます
          </p></li><li class="listitem"><p>
            <code class="literal">db3.t4</code> イベントはモニターされません
          </p></li><li class="listitem"><p>
            <code class="literal">db4.t5</code> イベントはモニターされます
          </p></li></ul></div><p>
        <code class="literal">setup_instruments</code> および <code class="literal">setup_objects</code> テーブルの <code class="literal">TIMED</code> カラムを組み合わせて、イベントタイミング情報を収集するかどうかを判断する場合も同様のロジックが当てはまります。
      </p><p>
        永続的テーブルと一時テーブルが同じ名前を持つ場合、<code class="literal">setup_objects</code> 行に対する照合が両方に対して同様に行われます。 一方のテーブルのモニタリングを有効にして、他方を有効にしないことはできません。 ただし、各テーブルは個別にインストゥルメントされます。 
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-thread-filtering"></a>27.4.6 スレッドによる事前フィルタリング</h3></div></div></div><p>
        <code class="literal">threads</code> テーブルは各サーバースレッドの行を格納します。 各行は、スレッドに関する情報を格納し、それに対するモニタリングが有効にされているかどうかを示します。 スレッドをモニターするパフォーマンススキーマの場合、これらのことが当てはまる必要があります。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブル内の <code class="literal">thread_instrumentation</code> コンシューマは <code class="literal">YES</code> である必要があります。
          </p></li><li class="listitem"><p>
            <code class="literal">threads.INSTRUMENTED</code> カラムは <code class="literal">YES</code> である必要があります。
          </p></li><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブル内で有効にされているインストゥルメントから生成されたスレッドイベントに対してのみ、モニタリングが行われます。
          </p></li></ul></div><p>
        <code class="literal">threads</code> テーブルには、履歴イベントロギングを実行するかどうかもサーバースレッドごとに示されます。 これには待機イベント、ステージイベント、ステートメントイベントおよびトランザクションイベントが含まれ、次のテーブルへのロギングに影響します: 
      </p><pre class="programlisting">events_waits_history
events_waits_history_long
events_stages_history
events_stages_history_long
events_statements_history
events_statements_history_long
events_transactions_history
events_transactions_history_long
</pre><p>
        履歴イベントロギングを実行するには、次のことが当てはまる必要があります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブルの適切な履歴関連コンシューマを有効にする必要があります。 たとえば、<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルの待機イベントロギングでは、対応する <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> コンシューマが <code class="literal">YES</code> である必要があります。 
          </p></li><li class="listitem"><p>
            <code class="literal">threads.HISTORY</code> カラムは <code class="literal">YES</code> である必要があります。
          </p></li><li class="listitem"><p>
            ロギングは、<code class="literal">setup_instruments</code> テーブルで有効になっているインストゥルメントから生成されたスレッドイベントに対してのみ行われます。
          </p></li></ul></div><p>
        フォアグラウンドスレッド (クライアント接続の結果) の場合、<code class="literal">threads</code> テーブルの行の <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> カラムの初期値は、スレッドに関連付けられたユーザーアカウントが <code class="literal">setup_actors</code> テーブルのいずれかの行と一致するかどうかによって決まります。 値は、一致する <code class="literal">setup_actors</code> テーブルの行の <code class="literal">ENABLED</code> カラムおよび <code class="literal">HISTORY</code> カラムから取得されます。 
      </p><p>
        バックグラウンドスレッドの場合、関連付けられたユーザーはありません。 <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> はデフォルトで <code class="literal">YES</code> であり、<code class="literal">setup_actors</code> は参照されません。 
      </p><p>
        初期 <code class="literal">setup_actors</code> の内容は次のように見えます。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_actors;</code></strong>
+------+------+------+---------+---------+
| HOST | USER | ROLE | ENABLED | HISTORY |
+------+------+------+---------+---------+
| %    | %    | %    | YES     | YES     |
+------+------+------+---------+---------+
</pre><p>
        <code class="literal">HOST</code> および <code class="literal">USER</code> カラムにはリテラルのホストまたはユーザー名、または任意の名前に一致する <code class="literal">'%'</code> が格納されているべきです。
      </p><p>
        <code class="literal">ENABLED</code> および <code class="literal">HISTORY</code> のカラムは、前述の他の条件に従って、一致するスレッドのインストゥルメンテーションおよび履歴イベントロギングを有効にするかどうかを示します。
      </p><p>
        パフォーマンススキーマは、<code class="literal">setup_actors</code> の新しいフォアグラウンドスレッドごとに一致をチェックするときに、<code class="literal">USER</code> および <code class="literal">HOST</code> カラムを使用して、より具体的な一致を最初に見つけようとします (<code class="literal">ROLE</code> は使用されません):
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">USER='<em class="replaceable"><code>literal</code></em>'</code>および <code class="literal">HOST='<em class="replaceable"><code>literal</code></em>'</code>を含む行。
          </p></li><li class="listitem"><p>
            <code class="literal">USER='<em class="replaceable"><code>literal</code></em>'</code>および <code class="literal">HOST='%'</code>を含む行。
          </p></li><li class="listitem"><p>
            <code class="literal">USER='%'</code>および <code class="literal">HOST='<em class="replaceable"><code>literal</code></em>'</code>を含む行。
          </p></li><li class="listitem"><p>
            <code class="literal">USER='%'</code>および <code class="literal">HOST='%'</code>を含む行。
          </p></li></ul></div><p>
        一致する <code class="literal">setup_actors</code> 行が異なると <code class="literal">USER</code> 値と <code class="literal">HOST</code> 値が異なる可能性があるため、一致が発生する順序は重要です。 これにより、<code class="literal">ENABLED</code> および <code class="literal">HISTORY</code> のカラム値に基づいて、インスツルメント処理および履歴イベントロギングをホスト、ユーザーまたはアカウント (ユーザーとホストの組合せ) ごとに選択的に適用できます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            最適な一致が <code class="literal">ENABLED=YES</code> の行である場合、スレッドの <code class="literal">INSTRUMENTED</code> 値は <code class="literal">YES</code> になります。 最適な一致が <code class="literal">HISTORY=YES</code> の行である場合、スレッドの <code class="literal">HISTORY</code> 値は <code class="literal">YES</code> になります。 
          </p></li><li class="listitem"><p>
            最適な一致が <code class="literal">ENABLED=NO</code> の行である場合、スレッドの <code class="literal">INSTRUMENTED</code> 値は <code class="literal">NO</code> になります。 最適な一致が <code class="literal">HISTORY=NO</code> の行である場合、スレッドの <code class="literal">HISTORY</code> 値は <code class="literal">NO</code> になります。 
          </p></li><li class="listitem"><p>
            一致するものが見つからない場合、スレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の値は <code class="literal">NO</code> になります。
          </p></li></ul></div><p>
        <code class="literal">setup_actors</code> 行の <code class="literal">ENABLED</code> カラムと <code class="literal">HISTORY</code> カラムは、互いに独立して <code class="literal">YES</code> または <code class="literal">NO</code> に設定できます。 つまり、履歴イベントを収集するかどうかとは別にインストゥルメンテーションを有効にできます。 
      </p><p>
        デフォルトでは、監視および履歴イベント収集はすべての新しいフォアグラウンドスレッドに対して有効になっています。これは、<code class="literal">setup_actors</code> テーブルには、<code class="literal">HOST</code> と <code class="literal">USER</code> の両方の<code class="literal">'%'</code>を含む行が最初に含まれているためです。 一部のフォアグラウンドスレッドに対してのみ監視を有効にするなど、より限定的な照合を実行するには、この行が任意の接続に一致するため、この行を変更し、より具体的な <code class="literal">HOST</code>/<code class="literal">USER</code> の組合せに対して行を追加する必要があります。 
      </p><p>
        次のように <code class="literal">setup_actors</code> を変更するとします。
      </p><pre class="programlisting">UPDATE performance_schema.setup_actors
SET ENABLED = 'NO', HISTORY = 'NO'
WHERE HOST = '%' AND USER = '%';
INSERT INTO performance_schema.setup_actors
(HOST,USER,ROLE,ENABLED,HISTORY)
VALUES('localhost','joe','%','YES','YES');
INSERT INTO performance_schema.setup_actors
(HOST,USER,ROLE,ENABLED,HISTORY)
VALUES('hosta.example.com','joe','%','YES','NO');
INSERT INTO performance_schema.setup_actors
(HOST,USER,ROLE,ENABLED,HISTORY)
VALUES('%','sam','%','NO','YES');
</pre><p>
        <code class="literal">UPDATE</code> ステートメントは、インストゥルメンテーションおよび履歴イベント収集を無効にするようにデフォルトの一致を変更します。 <code class="literal">INSERT</code> ステートメントは、より具体的な一致のために行を追加します。 
      </p><p>
        パフォーマンススキーマは、新しい接続スレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の値を次のように設定する方法を決定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">joe</code> がローカルホストから接続する場合、接続は最初に挿入された行に一致します。 スレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の値は <code class="literal">YES</code> になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">joe</code> が <code class="literal">hosta.example.com</code> から接続する場合、接続は挿入された 2 番目の行と一致します。 スレッドの <code class="literal">INSTRUMENTED</code> 値は <code class="literal">YES</code> になり、<code class="literal">HISTORY</code> 値は <code class="literal">NO</code> になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">joe</code> がほかのすべてのホストから接続する場合、一致はありません。 スレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の値は <code class="literal">NO</code> になります。 
          </p></li><li class="listitem"><p>
            <code class="literal">sam</code> がいずれかのホストから接続する場合、接続は 3 番目に挿入された行と一致します。 スレッドの <code class="literal">INSTRUMENTED</code> 値は <code class="literal">NO</code> になり、<code class="literal">HISTORY</code> 値は <code class="literal">YES</code> になります。 
          </p></li><li class="listitem"><p>
            その他の接続では、<code class="literal">HOST</code> および <code class="literal">USER</code> が<code class="literal">'%'</code>に設定されている行が一致します。 この行の <code class="literal">ENABLED</code> および <code class="literal">HISTORY</code> は <code class="literal">NO</code> に設定されているため、スレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の値は <code class="literal">NO</code> になります。 
          </p></li></ul></div><p>
        <code class="literal">setup_actors</code> テーブルの変更は、変更後に作成されたフォアグラウンドスレッドにのみ影響し、既存のスレッドには影響しません。 既存のスレッドに影響を与えるには、<code class="literal">threads</code> テーブルの行の <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> カラムを変更します。 
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-consumer-filtering"></a>27.4.7 コンシューマによる事前フィルタリング</h3></div></div></div><p>
        <code class="literal">setup_consumers</code> テーブルは使用可能なコンシューマの種類とどれが有効にされているかを一覧表示します。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| events_stages_current            | NO      |
| events_stages_history            | NO      |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
| events_waits_current             | NO      |
| events_waits_history             | NO      |
| events_waits_history_long        | NO      |
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| statements_digest                | YES     |
+----------------------------------+---------+
</pre><p>
        コンシューマステージで、事前フィルタリングに影響するように、<code class="literal">setup_consumers</code> テーブルを変更し、イベントの送信先を決定します。 コンシューマを有効または無効にするには、その <code class="literal">ENABLED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。 
      </p><p>
        <code class="literal">setup_consumers</code> テーブルへの変更はただちにモニタリングに影響します。
      </p><p>
        コンシューマを無効にすると、サーバーはそのコンシューマの宛先の保守に時間を費やさなくなります。 たとえば、履歴イベント情報に関心がない場合、履歴コンシューマを無効にします。 
      </p><pre class="programlisting">UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE '%history%';
</pre><p>
        <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。 次の原則が当てはまります。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            パフォーマンススキーマがコンシューマをチェックし、コンシューマが有効にされていないかぎり、コンシューマに関連付けられている宛先はイベントを受信しません。
          </p></li><li class="listitem"><p>
            コンシューマは、それが依存するすべてのコンシューマ (ある場合) が有効にされている場合にのみチェックされます。
          </p></li><li class="listitem"><p>
            コンシューマがチェックされていない場合、またはチェックされているが無効にされている場合、それに依存するほかのコンシューマはチェックされません。
          </p></li><li class="listitem"><p>
            依存コンシューマには独自の依存コンシューマがあることがあります。
          </p></li><li class="listitem"><p>
            イベントがどの宛先にも送信されない場合、パフォーマンススキーマはそれを生成しません。
          </p></li></ul></div><p>
        次のリストに、使用可能なコンシューマ値を説明します。 いくつかの代表的なコンシューマ構成とそれらのインストゥルメンテーションへの効果については、<a class="xref" href="performance-schema.html#performance-schema-consumer-configurations" title="27.4.8 コンシューマ構成の例">セクション27.4.8「コンシューマ構成の例」</a>を参照してください。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-global-thread" title="グローバルおよびスレッドコンシューマ">グローバルおよびスレッドコンシューマ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-wait-event" title="待機イベントコンシューマ">待機イベントコンシューマ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-stage-event" title="ステージイベントコンシューマ">ステージイベントコンシューマ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-statement-event" title="ステートメントイベントコンシューマ">ステートメントイベントコンシューマ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-transaction-event" title="トランザクションイベントコンシューマ">トランザクションイベントコンシューマ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-statement-digest" title="ステートメントダイジェストコンシューマ">ステートメントダイジェストコンシューマ</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-global-thread"></a>グローバルおよびスレッドコンシューマ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">global_instrumentation</code> は最高レベルのコンシューマです。 <code class="literal">global_instrumentation</code> が <code class="literal">NO</code> の場合、それはグローバルインストゥルメンテーションを無効にします。 ほかのすべての設定は低いレベルで、チェックされず、何が設定されているかは重要でありません。 グローバルまたはスレッドごとに情報が保守されず、個々のイベントが現在のイベントまたはイベント履歴テーブルに収集されません。 <code class="literal">global_instrumentation</code> が <code class="literal">YES</code> の場合、パフォーマンススキーマはグローバル状態の情報を保守し、<code class="literal">thread_instrumentation</code> コンシューマもチェックします。 
            </p></li><li class="listitem"><p>
              <code class="literal">thread_instrumentation</code> は <code class="literal">global_instrumentation</code> が <code class="literal">YES</code> の場合のみチェックされます。 そうでなければ、<code class="literal">thread_instrumentation</code> が <code class="literal">NO</code> の場合、スレッド固有のインストゥルメンテーションが無効になり、すべての低レベル設定が無視されます。 スレッドごとに情報が保守されず、個々のイベントが現在のイベントまたはイベント履歴テーブルに収集されません。 <code class="literal">thread_instrumentation</code> が <code class="literal">YES</code> の場合、パフォーマンススキーマはスレッド固有の情報を保守し、<code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code> コンシューマもチェックします。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-wait-event"></a>待機イベントコンシューマ</h4></div></div></div><p>
          これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。 チェックされた場合、それらは次のように動作します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_current</code>は <code class="literal">NO</code> の場合、<code class="literal">events_waits_current</code> テーブル内の個々の待機イベントの収集を無効にします。 <code class="literal">YES</code> の場合、待機イベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> コンシューマをチェックします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_history</code> は <code class="literal">event_waits_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_waits_history</code> 値は、<code class="literal">events_waits_history</code> テーブルへの待機イベントの収集を無効または有効にします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_history_long</code> は <code class="literal">event_waits_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_waits_history_long</code> 値は、<code class="literal">events_waits_history_long</code> テーブルへの待機イベントの収集を無効または有効にします。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-stage-event"></a>ステージイベントコンシューマ</h4></div></div></div><p>
          これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。 チェックされた場合、それらは次のように動作します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_stages_current</code>は、<code class="literal">NO</code> の場合に、<code class="literal">events_stages_current</code> テーブルへの個々のステージイベントの収集を無効にします。 <code class="literal">YES</code> の場合、ステージイベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_stages_history</code> および <code class="literal">events_stages_history_long</code> コンシューマをチェックします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_history</code> は <code class="literal">event_stages_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_stages_history</code> 値は、<code class="literal">events_stages_history</code> テーブルへのステージイベントの収集を無効または有効にします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_history_long</code> は <code class="literal">event_stages_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_stages_history_long</code> 値は、<code class="literal">events_stages_history_long</code> テーブルへのステージイベントの収集を無効または有効にします。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-statement-event"></a>ステートメントイベントコンシューマ</h4></div></div></div><p>
          これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。 チェックされた場合、それらは次のように動作します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_current</code>は <code class="literal">NO</code> の場合、<code class="literal">events_statements_current</code> テーブルへの個々のステートメントイベントの収集を無効にします。 <code class="literal">YES</code> の場合、ステートメントイベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code> コンシューマをチェックします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_history</code> は <code class="literal">events_statements_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_statements_history</code> 値は、<code class="literal">events_statements_history</code> テーブルへのステートメントイベントの収集を無効または有効にします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_history_long</code> は <code class="literal">events_statements_current</code> が <code class="literal">NO</code> の場合にチェックされません。 そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_statements_history_long</code> 値は、<code class="literal">events_statements_history_long</code> テーブルへのステートメントイベントの収集を無効または有効にします。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-transaction-event"></a>トランザクションイベントコンシューマ</h4></div></div></div><p>
          これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。 チェックされた場合、それらは次のように動作します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_transactions_current</code> は、<code class="literal">NO</code> の場合、<code class="literal">events_transactions_current</code> テーブル内の個々のトランザクションイベントの収集を無効にします。 <code class="literal">YES</code> の場合は、トランザクションイベント収集が有効になり、パフォーマンススキーマによって <code class="literal">events_transactions_history</code> および <code class="literal">events_transactions_history_long</code> コンシューマがチェックされます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_current</code> が <code class="literal">NO</code> の場合、<code class="literal">events_transactions_history</code> はチェックされません。 それ以外の場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_transactions_history</code> 値は、<code class="literal">events_transactions_history</code> テーブルでのトランザクションイベントの収集を無効または有効にします。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_current</code> が <code class="literal">NO</code> の場合、<code class="literal">events_transactions_history_long</code> はチェックされません。 それ以外の場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_transactions_history_long</code> 値は、<code class="literal">events_transactions_history_long</code> テーブルでのトランザクションイベントの収集を無効または有効にします。 
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-filtering-statement-digest"></a>ステートメントダイジェストコンシューマ</h4></div></div></div><p>
          <code class="literal">statements_digest</code> コンシューマでは、<code class="literal">global_instrumentation</code> が <code class="literal">YES</code> である必要があります。そうでない場合は、チェックされません。 ステートメントイベントコンシューマへの依存関係がないため、<code class="literal">events_statements_current</code> に統計を収集する必要なく、ダイジェストごとに統計を取得することができ、これはオーバーヘッドの点で有利です。 逆に、ダイジェストなしで <code class="literal">events_statements_current</code> の詳細なステートメントを取得できます (この場合、<code class="literal">DIGEST</code> および <code class="literal">DIGEST_TEXT</code> のカラムは <code class="literal">NULL</code> です)。 
        </p><p>
          ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-consumer-configurations"></a>27.4.8 コンシューマ構成の例</h3></div></div></div><p>
        <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。 次の説明では、コンシューマのしくみを説明し、コンシューマ設定が高から低に段階に有効にされたときの特定の構成とそれらの効果を示します。 示されているコンシューマ値は代表的なものです。 ここで説明する一般原則は、使用可能なほかのコンシューマ値に当てはまります。 
      </p><p>
        構成の説明は、機能とオーバーヘッドが増加する順番で示しています。 下位レベルの設定を有効にすることで提供される情報が必要ない場合は、パフォーマンススキーマが実行するコードが少なくなり、サイフトスルーする情報が少なくなるように無効にします。 
      </p><p>
        <code class="literal">setup_consumers</code> テーブルには次の値の階層が格納されます。
      </p><pre class="programlisting">global_instrumentation
 thread_instrumentation
   events_waits_current
     events_waits_history
     events_waits_history_long
   events_stages_current
     events_stages_history
     events_stages_history_long
   events_statements_current
     events_statements_history
     events_statements_history_long
   events_transactions_current
     events_transactions_history
     events_transactions_history_long
 statements_digest
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          コンシューマ階層では、待機、ステージ、ステートメントおよびトランザクションのコンシューマはすべて同じレベルにあります。 これは、待機イベントがステージイベント内にネストするイベントネスト階層とは異なります。ステージイベントはステートメントイベント内にネストされ、ステートメントイベントはトランザクションイベント内にネストされます。 
        </p></div><p>
        特定のコンシューマ設定が <code class="literal">NO</code> の場合、パフォーマンススキーマはコンシューマに関連付けられたインストゥルメンテーションを無効にし、すべての低レベルの設定を無視します。 特定の設定が <code class="literal">YES</code> の場合、パフォーマンススキーマはそれに関連付けられたインストゥルメンテーションを有効にし、次の最低レベルの設定をチェックします。 各コンシューマのルールの説明については、<a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="27.4.7 コンシューマによる事前フィルタリング">セクション27.4.7「コンシューマによる事前フィルタリング」</a>を参照してください。 
      </p><p>
        たとえば、<code class="literal">global_instrumentation</code> が有効にされている場合、<code class="literal">thread_instrumentation</code> がチェックされます。 <code class="literal">thread_instrumentation</code> が有効にされている場合、<code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code> コンシューマがチェックされます。 これらのうち <code class="literal">events_waits_current</code> が有効にされている場合、<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> がチェックされます。 
      </p><p>
        次の構成の各説明は、パフォーマンススキーマがチェックするセットアップ要素と、それが保守する出力テーブル (つまり、それが情報を収集するテーブル) を示します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-configurations-no-instrumentation" title="インストゥルメンテーションなし">インストゥルメンテーションなし</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-configurations-global-instrumentation-only" title="グローバルインストゥルメンテーションのみ">グローバルインストゥルメンテーションのみ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-configurations-global-and-thread-instrumentation-only" title="グローバルおよびスレッドインストゥルメンテーションのみ">グローバルおよびスレッドインストゥルメンテーションのみ</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-configurations-global-thread-and-current-event-instrumentation" title="グローバル、スレッド、および現在のイベントインストゥルメンテーション">グローバル、スレッド、および現在のイベントインストゥルメンテーション</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-consumer-configurations-global-thread-current-event-and-event-history-instrumentation" title="グローバル、スレッド、現在のイベント、およびイベント履歴インストゥルメンテーション">グローバル、スレッド、現在のイベント、およびイベント履歴インストゥルメンテーション</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-configurations-no-instrumentation"></a>インストゥルメンテーションなし</h4></div></div></div><p>
          サーバー構成の状態:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
          この構成では、何もインストゥルメントされません。
        </p><p>
          チェックされるセットアップ要素:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              テーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">global_instrumentation</code>
            </p></li></ul></div><p>
          保守される出力テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-configurations-global-instrumentation-only"></a>グローバルインストゥルメンテーションのみ</h4></div></div></div><p>
          サーバー構成の状態:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | YES     |
| thread_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
          この構成では、インストゥルメンテーションがグローバル状態に対してのみ保守されます。 スレッドごとのインストゥルメンテーションは無効にされます。 
        </p><p>
          先述の構成に関連して、チェックされる追加のセットアップ要素:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              テーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">thread_instrumentation</code>
            </p></li><li class="listitem"><p>
              テーブル <code class="literal">setup_instruments</code>
            </p></li><li class="listitem"><p>
              テーブル <code class="literal">setup_objects</code>
            </p></li></ul></div><p>
          先述の構成に関連して保守される追加の出力テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mutex_instances</code>
            </p></li><li class="listitem"><p>
              <code class="literal">rwlock_instances</code>
            </p></li><li class="listitem"><p>
              <code class="literal">cond_instances</code>
            </p></li><li class="listitem"><p>
              <code class="literal">file_instances</code>
            </p></li><li class="listitem"><p>
              <code class="literal">users</code>
            </p></li><li class="listitem"><p>
              <code class="literal">hosts</code>
            </p></li><li class="listitem"><p>
              <code class="literal">accounts</code>
            </p></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">file_summary_by_instance</code>
            </p></li><li class="listitem"><p>
              <code class="literal">file_summary_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">objects_summary_global_by_type</code>
            </p></li><li class="listitem"><p>
              <code class="literal">memory_summary_global_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">table_lock_waits_summary_by_table</code>
            </p></li><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_index_usage</code>
            </p></li><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_table</code>
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_instance</code>
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_global_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_global_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_global_by_event_name</code>
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_global_by_event_name</code>
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-configurations-global-and-thread-instrumentation-only"></a>グローバルおよびスレッドインストゥルメンテーションのみ</h4></div></div></div><p>
          サーバー構成の状態:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| events_waits_current             | NO      |
...
| events_stages_current            | NO      |
...
| events_statements_current        | NO      |
...
| events_transactions_current      | NO      |
...
+----------------------------------+---------+
</pre><p>
          この構成では、インストゥルメンテーションがグローバルおよびスレッドごとに保守されます。 現在のイベントまたはイベント履歴テーブルで、個々のイベントは収集されません。 
        </p><p>
          先述の構成に関連して、チェックされる追加のセットアップ要素:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <em class="replaceable"><code>xxx</code></em> が <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code> であるテーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>
            </p></li><li class="listitem"><p>
              テーブル <code class="literal">setup_actors</code>
            </p></li><li class="listitem"><p>
              カラム <code class="literal">threads.instrumented</code>
            </p></li></ul></div><p>
          先述の構成に関連して保守される追加の出力テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_by_<em class="replaceable"><code>yyy</code></em>_by_event_name</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>、<em class="replaceable"><code>yyy</code></em> は <code class="literal">thread</code>, <code class="literal">user</code>, <code class="literal">host</code>, <code class="literal">account</code>)
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-configurations-global-thread-and-current-event-instrumentation"></a>グローバル、スレッド、および現在のイベントインストゥルメンテーション</h4></div></div></div><p>
          サーバー構成の状態:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| events_waits_current             | YES     |
| events_waits_history             | NO      |
| events_waits_history_long        | NO      |
| events_stages_current            | YES     |
| events_stages_history            | NO      |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | NO      |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | NO      |
| events_transactions_history_long | NO      |
...
+----------------------------------+---------+
</pre><p>
          この構成では、インストゥルメンテーションがグローバルおよびスレッドごとに保守されます。 個々のイベントが現在のイベントテーブルに収集されますが、イベント履歴テーブルには収集されません。 
        </p><p>
          先述の構成に関連して、チェックされる追加のセットアップ要素:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>(<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li><li class="listitem"><p>
              コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>(<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li></ul></div><p>
          先述の構成に関連して保守される追加の出力テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-consumer-configurations-global-thread-current-event-and-event-history-instrumentation"></a>グローバル、スレッド、現在のイベント、およびイベント履歴インストゥルメンテーション</h4></div></div></div><p>
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code> および <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code> コンシューマは無効にされているため、先述の構成はイベント履歴を収集しません。 それらのコンシューマは個別またはまとめて有効にして、スレッドごと、グローバルに、またはその両方でイベント履歴を収集できます。 
        </p><p>
          この構成はスレッドごとにイベントを収集しますが、グローバルには収集しません。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| events_waits_current             | YES     |
| events_waits_history             | YES     |
| events_waits_history_long        | NO      |
| events_stages_current            | YES     |
| events_stages_history            | YES     |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
...
+----------------------------------+---------+
</pre><p>
          この構成で保守されるイベント履歴テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li></ul></div><p>
          この構成はグローバルにイベント履歴を収集しますが、スレッドごとには収集しません。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| events_waits_current             | YES     |
| events_waits_history             | NO      |
| events_waits_history_long        | YES     |
| events_stages_current            | YES     |
| events_stages_history            | NO      |
| events_stages_history_long       | YES     |
| events_statements_current        | YES     |
| events_statements_history        | NO      |
| events_statements_history_long   | YES     |
| events_transactions_current      | YES     |
| events_transactions_history      | NO      |
| events_transactions_history_long | YES     |
...
+----------------------------------+---------+
</pre><p>
          この構成で保守されるイベント履歴テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li></ul></div><p>
          この構成はスレッドごとおよびグローバルにイベントを収集します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| events_waits_current             | YES     |
| events_waits_history             | YES     |
| events_waits_history_long        | YES     |
| events_stages_current            | YES     |
| events_stages_history            | YES     |
| events_stages_history_long       | YES     |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | YES     |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | YES     |
...
+----------------------------------+---------+
</pre><p>
          この構成で保守されるイベント履歴テーブル:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li><li class="listitem"><p>
              <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code> (<em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>)
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-filtering-names"></a>27.4.9 フィルタリング操作のインストゥルメントまたはコンシューマの指定</h3></div></div></div><p>
        フィルタリング操作に指定する名前は、必要に応じて具体的なものでも一般的なものでも指定できます。 単一のインストゥルメントまたはコンシューマを示すには、その名前を省略せずに指定します。 
      </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO'
WHERE NAME = 'wait/synch/mutex/myisammrg/MYRG_INFO::mutex';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME = 'events_waits_current';
</pre><p>
        インストゥルメントまたはコンシューマのグループを指定するには、グループメンバーに一致するパターンを使用します。
      </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO'
WHERE NAME LIKE 'wait/synch/mutex/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE '%history%';
</pre><p>
        パターンを使用する場合、それは関心のあるすべての項目に一致し、ほかの項目に一致しないように、選択してください。 たとえば、すべてのファイル I/O インストゥルメントを選択するには、インストゥルメント名プリフィクス全体を含むパターンを使用することをお勧めします。 
      </p><pre class="programlisting">... WHERE NAME LIKE 'wait/io/file/%';
</pre><p>
        <code class="literal">'%/file/%'</code>のパターンは、名前に<code class="literal">'/file/'</code>の要素が含まれる他のインストゥルメントと一致します。 パターン<code class="literal">'%file%'</code>は、名前のどこか (<code class="literal">wait/synch/mutex/innodb/file_open_mutex</code> など) の<code class="literal">'file'</code>とインストゥルメントが一致するため、あまり適切ではありません。 
      </p><p>
        パターンに一致するインストゥルメントまたはコンシューマ名をチェックするには、簡単なテストを実行します。
      </p><pre class="programlisting">SELECT NAME FROM performance_schema.setup_instruments
WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';

SELECT NAME FROM performance_schema.setup_consumers
WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';
</pre><p>
        サポートされる名前の種類については、<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>を参照してください。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-instrumentation-checking"></a>27.4.10 インストゥルメントされているものの特定</h3></div></div></div><p>
        パフォーマンススキーマにどのインストゥルメントが含まれているかを特定するには、常に <code class="literal">setup_instruments</code> テーブルをチェックすることで可能です。 たとえば、<code class="literal">InnoDB</code> ストレージエンジンに、どのファイル関連イベントがインストゥルメントされているかを確認するには、次のクエリーを使用します。 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/file/innodb/%';</code></strong>
+-------------------------------------------------+---------+-------+
| NAME                                            | ENABLED | TIMED |
+-------------------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_tablespace_open_file | YES     | YES   |
| wait/io/file/innodb/innodb_data_file            | YES     | YES   |
| wait/io/file/innodb/innodb_log_file             | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file            | YES     | YES   |
| wait/io/file/innodb/innodb_arch_file            | YES     | YES   |
| wait/io/file/innodb/innodb_clone_file           | YES     | YES   |
+-------------------------------------------------+---------+-------+
</pre><p>
        このドキュメントでは、いくつかの理由で、正確に何がインストゥルメントされるかについて詳細に説明していません。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            何がインストゥルメントされるかは、サーバーコードです。 このコードへの変更は頻繁に行われ、インストゥルメントのセットにも影響します。 
          </p></li><li class="listitem"><p>
            すべてのインストゥルメントは数百もあるため、それらを挙げることは現実的ではありません。
          </p></li><li class="listitem"><p>
            先述のように、<code class="literal">setup_instruments</code> テーブルをクエリーすることによって見つけることができます。 この情報は使用している MySQL のバージョンに常に最新であり、コアサーバーに含まれておらず、自動化されたツールで使用可能な、インストールしている可能性があるインストゥルメント済みのプラグインのインストゥルメンテーションも含みます。 
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-queries"></a>27.5 パフォーマンススキーマクエリー</h2></div></div></div><p>
      事前フィルタリングは収集されるイベント情報を制限し、特定のユーザーと関係ありません。 対照的に、事後フィルタリングは、各ユーザーが、事前フィルタリングの適用後に使用可能なイベントから選択するイベント情報を制限する、適切な <code class="literal">WHERE</code> 句でクエリーを使用することによって実行されます。 
    </p><p>
      <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>で、ファイルインストゥルメントの事前フィルタリング方法の例を示しました。 イベントテーブルにファイルと非ファイルの両方の情報が格納されている場合、事後フィルタリングはファイルイベントのみの情報を表示するもう 1 つの方法です。 イベント選択を適切に制限するには、クエリーに <code class="literal">WHERE</code> 句を追加します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT THREAD_ID, NUMBER_OF_BYTES</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_history</code></strong>
       <strong class="userinput"><code>WHERE EVENT_NAME LIKE 'wait/io/file/%'</code></strong>
       <strong class="userinput"><code>AND NUMBER_OF_BYTES IS NOT NULL;</code></strong>
+-----------+-----------------+
| THREAD_ID | NUMBER_OF_BYTES |
+-----------+-----------------+
|        11 |              66 |
|        11 |              47 |
|        11 |             139 |
|         5 |              24 |
|         5 |             834 |
+-----------+-----------------+
</pre><p>
      「最もパフォーマンスの高いスキーマ」テーブルには、全テーブルスキャン以外の実行計画へのアクセス権をオプティマイザに付与するインデックスがあります。 これらのインデックスは、それらのテーブルを使用する <code class="literal">sys</code> スキーマビューなど、関連するオブジェクトのパフォーマンスも向上します。 詳細は、<a class="xref" href="optimization.html#performance-schema-optimization" title="8.2.4 パフォーマンススキーマクエリーの最適化">セクション8.2.4「パフォーマンススキーマクエリーの最適化」</a>を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-instrument-naming"></a>27.6 パフォーマンススキーマインストゥルメント命名規則</h2></div></div></div><p>
      インストゥルメント名は、<code class="literal">'/'</code>文字で区切られた一連の要素で構成されます。 名前の例: 
    </p><pre class="programlisting">wait/io/file/myisam/log
wait/io/file/mysys/charset
wait/lock/table/sql/handler
wait/synch/cond/mysys/COND_alarm
wait/synch/cond/sql/BINLOG::update_cond
wait/synch/mutex/mysys/BITMAP_mutex
wait/synch/mutex/sql/LOCK_delete
wait/synch/rwlock/sql/Query_cache_query::lock
stage/sql/closing tables
stage/sql/Sorting result
statement/com/Execute
statement/com/Query
statement/sql/create_table
statement/sql/lock_tables
errors
</pre><p>
      インストゥルメントの名前空間はツリー状の構造を持ちます。 インストゥルメント名の要素は左から右に、より一般的なものからより具体的なものへと進行します。 名前が持つ要素の数は、インストゥルメントのタイプによって異なります。 
    </p><p>
      名前内の特定の要素の解釈は、その左側の要素によって異なります。 たとえば、<code class="literal">myisam</code> は次の名前の両方に見られますが、最初の名前の <code class="literal">myisam</code> はファイル I/O に関連し、2 番目のそれは同期インストゥルメントに関連しています。 
    </p><pre class="programlisting">wait/io/file/myisam/log
wait/synch/cond/myisam/MI_SORT_INFO::cond
</pre><p>
      インストゥルメント名は、パフォーマンススキーマ実装によって定義された構造を持つプリフィクスと、インストゥルメントコードを実装する開発者によって定義されるサフィクスから構成されます。 インストゥルメント接頭辞の最上位要素はインストゥルメントのタイプを示します。 この要素は、<code class="literal">performance_timers</code> テーブルのどのイベントタイマーがインストゥルメントに適用されるかも決定します。 インストゥルメントのプリフィクス部分のトップレベルはインストゥルメントの種類を示します。 
    </p><p>
      インストゥルメント名のサフィクス部分は、インストゥルメント自体のコードから生成されます。 サフィクスには次のようなレベルが含まれることがあります。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          メジャー要素 (<code class="literal">myisam</code>, <code class="literal">innodb</code>, <code class="literal">mysys</code> や <code class="literal">sql</code> などのサーバーモジュール) の名前またはプラグイン名。
        </p></li><li class="listitem"><p>
          形式 <em class="replaceable"><code>XXX</code></em> (グローバル変数) または <code class="literal"><em class="replaceable"><code>CCC</code></em>::<em class="replaceable"><code>MMM</code></em></code> (クラス <em class="replaceable"><code>CCC</code></em> のメンバー <em class="replaceable"><code>MMM</code></em>) でのコード内の変数の名前。 例: <code class="literal">COND_thread_cache</code>、<code class="literal">THR_LOCK_myisam</code>、<code class="literal">BINLOG::LOCK_index</code>。 
        </p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-top-level-instrument-elements" title="最上位インストゥルメント要素">最上位インストゥルメント要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-idle-instrument-elements" title="アイドルインストゥルメント要素">アイドルインストゥルメント要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-error-instrument-elements" title="エラーインストゥルメント要素">エラーインストゥルメント要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-memory-instrument-elements" title="メモリーインストゥルメント要素">メモリーインストゥルメント要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-stage-instrument-elements" title="ステージ証書要素">ステージ証書要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-statement-instrument-elements" title="ステートメント手段要素">ステートメント手段要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-thread-instrument-elements" title="スレッドインストゥルメント要素">スレッドインストゥルメント要素</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-wait-instrument-elements" title="待機インストゥルメントの要素">待機インストゥルメントの要素</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-top-level-instrument-elements"></a>最上位インストゥルメント要素</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">idle</code>: インストゥルメントされたアイドルイベント。 このインストゥルメントにはこれ以上要素はありません。 
          </p></li><li class="listitem"><p>
            <code class="literal">error</code>: インストゥルメントされたエラーイベント。 このインストゥルメントにはこれ以上要素はありません。 
          </p></li><li class="listitem"><p>
            <code class="literal">memory</code>: インストゥルメントされたメモリーイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">stage</code>: インストゥルメントされたステージイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">statement</code>: インストゥルメントされたステートメントイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">transaction</code>: インストゥルメントされたトランザクションイベント。 このインストゥルメントにはこれ以上要素はありません。 
          </p></li><li class="listitem"><p>
            <code class="literal">wait</code>: インストゥルメントされた待機イベント。
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-idle-instrument-elements"></a>アイドルインストゥルメント要素</h3></div></div></div><p>
        <code class="literal">idle</code> インストゥルメントはアイドルイベントに使用されます。このイベントは、<a class="xref" href="performance-schema.html#performance-schema-socket-instances-table" title="27.12.3.5 socket_instances テーブル">セクション27.12.3.5「socket_instances テーブル」</a> の <code class="literal">socket_instances.STATE</code> カラムの説明に従ってパフォーマンススキーマによって生成されます。
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-error-instrument-elements"></a>エラーインストゥルメント要素</h3></div></div></div><p>
        <code class="literal">error</code> インストゥルメントは、サーバーのエラーおよび警告に関する情報を収集するかどうかを示します。 このインストゥルメントはデフォルトで有効になっています。 タイミング情報が収集されないため、<code class="literal">setup_instruments</code> テーブルの <code class="literal">error</code> 行の <code class="literal">TIMED</code> カラムは適用できません。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-memory-instrument-elements"></a>メモリーインストゥルメント要素</h3></div></div></div><p>
        メモリーインストゥルメンテーションはデフォルトで有効になっています。 メモリーインツルメンテーションは、起動時に有効化または無効化できます。また、<code class="literal">setup_instruments</code> テーブル内の関連するインストゥルメントの <code class="literal">ENABLED</code> カラムを更新することで、実行時に動的に有効化または無効化できます。 メモリーインストゥルメントの名前の形式は <code class="literal">memory/<em class="replaceable"><code>code_area</code></em>/<em class="replaceable"><code>instrument_name</code></em></code> で、ここで、<em class="replaceable"><code>code_area</code></em> は <code class="literal">sql</code> や <code class="literal">myisam</code> などの値で、<em class="replaceable"><code>instrument_name</code></em> はインストゥルメントの詳細です。 
      </p><p>
        接頭辞 <code class="literal">memory/performance_schema/</code>が付いたインストゥルメントは、パフォーマンススキーマ内の内部バッファーに割り当てられているメモリー量を公開します。 <code class="literal">memory/performance_schema/</code>インストゥルメントは組込みであり、常に有効になっており、起動時または実行時に無効にすることはできません。 組込みメモリーインストルメントは、<code class="literal">memory_summary_global_by_event_name</code> テーブルにのみ表示されます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-memory-model" title="27.17 パフォーマンススキーマのメモリー割り当てモデル">セクション27.17「パフォーマンススキーマのメモリー割り当てモデル」</a>を参照してください。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-stage-instrument-elements"></a>ステージ証書要素</h3></div></div></div><p>
        ステージインストゥルメントは、形式 <code class="literal">stage/<em class="replaceable"><code>code_area</code></em>/<em class="replaceable"><code>stage_name</code></em></code> の名前を持ちます。ここで <em class="replaceable"><code>code_area</code></em> は <code class="literal">sql</code> や <code class="literal">myisam</code> などの名前で、<em class="replaceable"><code>stage_name</code></em> は、<code class="literal">Sorting result</code> や <code class="literal">Sending data</code> などのステートメント処理のステージを示します。 ステージは <code class="literal">SHOW PROCESSLIST</code> によって表示されるか、または <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルに表示されるスレッドの状態に対応します。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-statement-instrument-elements"></a>ステートメント手段要素</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">statement/abstract/*</code>: ステートメント操作の抽象インストゥルメント。 抽象インストゥルメントは、正確なステートメントの種類が分かる前のステートメント分類の初期段階時に使用され、その後種類がわかったときに、より具体的なステートメントインストゥルメントに変更されます。 このプロセスの説明については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            <code class="literal">statement/com</code>: インストゥルメントされたコマンド操作。 これらは <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code> 操作に対応する名前を持ちます (<code class="filename">mysql_com.h</code> ヘッダーファイルおよび <code class="filename">sql/sql_parse.cc</code> を参照してください。 たとえば、<code class="literal">statement/com/Connect</code> および <code class="literal">statement/com/Init DB</code> インストゥルメントは <code class="literal">COM_CONNECT</code> および <code class="literal">COM_INIT_DB</code> コマンドに対応します。 
          </p></li><li class="listitem"><p>
            <code class="literal">statement/scheduler/event</code>: イベントスケジューラによって実行されたすべてのイベントを追跡する単一のインストゥルメント。 このインストゥルメントは、スケジュールされたイベントの実行が開始されると再生されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">statement/sp</code>: ストアドプログラムによって実行されるインストゥルメントされた内部命令。 たとえば、<code class="literal">statement/sp/cfetch</code> および <code class="literal">statement/sp/freturn</code> インストゥルメントは、カーソルフェッチおよび関数の戻り命令に使用されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">statement/sql</code>: インストゥルメントされた SQL ステートメント操作。 たとえば、<code class="literal">statement/sql/create_db</code> および <code class="literal">statement/sql/select</code> インストゥルメントは <code class="literal">CREATE DATABASE</code> および <code class="literal">SELECT</code> ステートメントに使用されます。 
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-thread-instrument-elements"></a>スレッドインストゥルメント要素</h3></div></div></div><p>
        インストゥルメントされたスレッドは、スレッドクラス名と属性を公開する <code class="literal">setup_threads</code> テーブルに表示されます。
      </p><p>
        スレッドインストゥルメントは、<code class="literal">thread</code> (<code class="literal">thread/sql/parser_service</code> や <code class="literal">thread/performance_schema/setup</code> など) で始まります。
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-wait-instrument-elements"></a>待機インストゥルメントの要素</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">wait/io</code>
          </p><p>
            インストゥルメントされた I/O 操作。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">wait/io/file</code>
              </p><p>
                インストゥルメントされたファイル I/O 操作。 ファイルの場合、待機はファイル操作の完了 (たとえば、<code class="literal">fwrite()</code> の呼び出し) を待機する時間です。 キャッシュのため、この呼び出し内で、ディスクへの物理的なファイル I/O は行われない可能性があります。 
              </p></li><li class="listitem"><p>
                <code class="literal">wait/io/socket</code>
              </p><p>
                インストゥルメントされたソケット操作。 ソケットインストゥルメントは形式 <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code>　の名前を持ちます。 サーバーには、それがサポートする各ネットワークプロトコルの待機ソケットがあります。 TCP/IP または Unix ソケットファイル接続の待機ソケットに関連付けられているインストゥルメントは、それぞれ <code class="literal">server_tcpip_socket</code> または <code class="literal">server_unix_socket</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。 待機ソケットが接続を検出すると、サーバーは接続を、個別のスレッドによって管理される新しいソケットに転送します。 新しい接続スレッドのインストゥルメントは、<code class="literal">client_connection</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。 
              </p></li><li class="listitem"><p>
                <code class="literal">wait/io/table</code>
              </p><p>
                インストゥルメントされたテーブル I/O 操作。 これらには、永続的ベーステーブルまたは一時テーブルへの行レベルアクセスが含まれます。 行に影響する操作は、フェッチ、挿入、更新、および削除です。 ビューの場合、待機はビューによって参照されるベーステーブルに関連付けられます。 
              </p><p>
                ほとんどの待機と同様、テーブル I/O の待機にはほかの待機も含まれることがあります。 たとえば、テーブル I/O にはファイル I/O またはメモリー操作が含まれることがあります。 そのため、テーブル I/O 待機の <code class="literal">events_waits_current</code> には通常 2 行あります。 詳細については、<a class="xref" href="performance-schema.html#performance-schema-atom-molecule-events" title="27.8 パフォーマンススキーマの原子的および分子的イベント">セクション27.8「パフォーマンススキーマの原子的および分子的イベント」</a>を参照してください。 
              </p><p>
                一部の行操作では、複数のテーブル I/O 待機が発生することがあります。 たとえば、挿入は更新を発生させるトリガーをアクティブにすることがあります。 
              </p></li></ul></div></li><li class="listitem"><p>
            <code class="literal">wait/lock</code>
          </p><p>
            インストゥルメントされたロック操作。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">wait/lock/table</code>
              </p><p>
                インストゥルメントされたテーブルロック操作。
              </p></li><li class="listitem"><p>
                <code class="literal">wait/lock/metadata/sql/mdl</code>
              </p><p>
                インストゥルメントされたメタデータロック操作。
              </p></li></ul></div></li><li class="listitem"><p>
            <code class="literal">wait/synch</code>
          </p><p>
            インストゥルメントされた同期オブジェクト。 同期オブジェクトでは、<code class="literal">TIMER_WAIT</code> 時間には、オブジェクトへのロックがある場合に、その獲得を試みている間のブロックされる時間の量が含まれます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">wait/synch/cond</code>
              </p><p>
                条件は、1 つのスレッドによって、ほかのスレッドに、それらが待機している何かが発生したことを伝えるために使用されます。 単一のスレッドが条件を待機していた場合、それはウェイクアップし、その実行を再開できます。 複数のスレッドが待機していた場合、それらすべてがウェイクアップし、それらが待機していたリソースを奪い合うことがあります。 
              </p></li><li class="listitem"><p>
                <code class="literal">wait/synch/mutex</code>
              </p><p>
                ほかのスレッドのリソースへのアクセスを妨げながら、リソース (実行可能コードのセクションなど) へのアクセスを許可するために使用される相互排他オブジェクト。
              </p></li><li class="listitem"><p>
                <code class="literal">wait/synch/prlock</code>
              </p><p>
                優先度 <a class="link" href="glossary.html#glos_rw_lock" title="rw ロック (読み書きロック)">rwlock</a> ロックオブジェクト。
              </p></li><li class="listitem"><p>
                <code class="literal">wait/synch/rwlock</code>
              </p><p>
                他のスレッドによる使用を防止しながら、特定の変数をアクセス用にロックするために使用されるプレーン <a class="link" href="glossary.html#glos_rw_lock" title="rw ロック (読み書きロック)">read/write lock</a> オブジェクト。 共有読み取りロックは複数のスレッドによって同時に獲得できます。 排他的書き込みロックは、一度に 1 つのスレッドだけが獲得できます。 
              </p></li><li class="listitem"><p>
                <code class="literal">wait/synch/sxlock</code>
              </p><p>
                共有排他 (SX) ロックは、他のスレッドによる一貫性のない読取りを許可しながら、共通リソースへの書込みアクセスを提供する <a class="link" href="glossary.html#glos_rw_lock" title="rw ロック (読み書きロック)">rwlock</a> ロックオブジェクトのタイプです。<code class="literal">sxlocks</code> は、同時実行性を最適化し、読取り/書込みワークロードのスケーラビリティを向上させます。
              </p></li></ul></div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-status-monitoring"></a>27.7 パフォーマンススキーマステータスモニタリング</h2></div></div></div><p>
      パフォーマンススキーマに関連付けられたいくつかのステータス変数があります。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-----------------------------------------------+-------+
| Variable_name                                 | Value |
+-----------------------------------------------+-------+
| Performance_schema_accounts_lost              | 0     |
| Performance_schema_cond_classes_lost          | 0     |
| Performance_schema_cond_instances_lost        | 0     |
| Performance_schema_digest_lost                | 0     |
| Performance_schema_file_classes_lost          | 0     |
| Performance_schema_file_handles_lost          | 0     |
| Performance_schema_file_instances_lost        | 0     |
| Performance_schema_hosts_lost                 | 0     |
| Performance_schema_locker_lost                | 0     |
| Performance_schema_memory_classes_lost        | 0     |
| Performance_schema_metadata_lock_lost         | 0     |
| Performance_schema_mutex_classes_lost         | 0     |
| Performance_schema_mutex_instances_lost       | 0     |
| Performance_schema_nested_statement_lost      | 0     |
| Performance_schema_program_lost               | 0     |
| Performance_schema_rwlock_classes_lost        | 0     |
| Performance_schema_rwlock_instances_lost      | 0     |
| Performance_schema_session_connect_attrs_lost | 0     |
| Performance_schema_socket_classes_lost        | 0     |
| Performance_schema_socket_instances_lost      | 0     |
| Performance_schema_stage_classes_lost         | 0     |
| Performance_schema_statement_classes_lost     | 0     |
| Performance_schema_table_handles_lost         | 0     |
| Performance_schema_table_instances_lost       | 0     |
| Performance_schema_thread_classes_lost        | 0     |
| Performance_schema_thread_instances_lost      | 0     |
| Performance_schema_users_lost                 | 0     |
+-----------------------------------------------+-------+
</pre><p>
      パフォーマンススキーマステータス変数は、メモリー制約のためロードまたは作成できなかったインストゥルメンテーションに関する情報を提供します。 これらの変数の名前にはいくつかの形式があります。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_classes_lost</code> は、種類 <em class="replaceable"><code>xxx</code></em> のロードできなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_instances_lost</code> は、オブジェクトの種類 <em class="replaceable"><code>xxx</code></em> の作成できなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_handles_lost</code> は、オブジェクトの種類 <em class="replaceable"><code>xxx</code></em> のオープンできなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_locker_lost</code> は、<span class="quote">「<span class="quote">失われた</span>」</span>か、または記録されなかったイベント数を示します。
        </p></li></ul></div><p>
      たとえば、相互排他ロックがサーバーソースにインストゥルメントされているが、サーバーが実行時にインストゥルメンテーション用のメモリーを割り当てることができない場合、それは <code class="literal">Performance_schema_mutex_classes_lost</code> を増分します。 mutex は同期オブジェクトとして機能しますが (つまり、サーバーは通常どおり機能します)、そのパフォーマンスデータは収集されません。 インストゥルメントを割り当てることができる場合、それはインストゥルメントされた相互排他ロックインスタンスの初期化に使用できます。 グローバル mutex などのシングルトン mutex の場合、インスタンスは 1 つのみです。 その他の相互排他ロックは、接続あたり、または各種キャッシュおよびデータバッファー内のページあたりに 1 つのインスタンスを持つため、インスタンスの数は時間の経過とともに変わります。 最大接続数または一部のバッファの最大サイズを増やすと、一度に割り当てられるインスタンスの最大数が増えます。 サーバーが特定のインストゥルメントされた相互排他ロックインスタンスを作成できない場合、それは <code class="literal">Performance_schema_mutex_instances_lost</code> を増分します。 
    </p><p>
      次の条件が維持されているとします。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          サーバーは <code class="option">--performance_schema_max_mutex_classes=200</code> オプションを使用して起動されているため、200 相互排他ロックインストゥルメントのための空きがあります。
        </p></li><li class="listitem"><p>
          150 相互排他ロックインストゥルメントはすでにロードされています。
        </p></li><li class="listitem"><p>
          <code class="literal">plugin_a</code> という名前のプラグインには 40 相互排他ロックインストゥルメントが含まれます。
        </p></li><li class="listitem"><p>
          <code class="literal">plugin_b</code> という名前のプラグインには 20 相互排他ロックインストゥルメントが含まれます。
        </p></li></ul></div><p>
      サーバーは、次の一連のステートメントに示すように、プラグインに、それらが必要とする数と使用可能な数に応じて、相互排他ロックインストゥルメントを割り当てます。
    </p><pre class="programlisting">INSTALL PLUGIN plugin_a
</pre><p>
      現在サーバーには 150+40 = 190 相互排他ロックインストゥルメントがあります。
    </p><pre class="programlisting">UNINSTALL PLUGIN plugin_a;
</pre><p>
      サーバーにはまだ 190 インストゥルメントがあります。 プラグインコードによって生成されたすべての履歴データはまだ使用できますが、インストゥルメントの新しいイベントは収集されません。 
    </p><pre class="programlisting">INSTALL PLUGIN plugin_a;
</pre><p>
      サーバーは 40 インストゥルメントがすでに定義されていることを検出したため、新しいインストゥルメントが作成されず、以前に割り当てられた内部メモリーバッファーが再利用されます。 サーバーにはまだ 190 インストゥルメントがあります。 
    </p><pre class="programlisting">INSTALL PLUGIN plugin_b;
</pre><p>
      サーバーは 200-190 = 10 インストゥルメント (この例では、相互排他ロッククラス) の空きがあり、プラグインに 20 個の新しいインストゥルメントが含まれていることを認識します。10 個のインストゥルメントがロードされ、10 個は破棄されるか<span class="quote">「<span class="quote">失われます。</span>」</span> <code class="literal">Performance_schema_mutex_classes_lost</code> は失われたインストゥルメント (相互排他ロッククラス) の数を示します。 
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE "perf%mutex_classes_lost";</code></strong>
+---------------------------------------+-------+
| Variable_name                         | Value |
+---------------------------------------+-------+
| Performance_schema_mutex_classes_lost | 10    |
+---------------------------------------+-------+
1 row in set (0.10 sec)
</pre><p>
      インストゥルメンテーションはまだ機能し、<code class="literal">plugin_b</code> の (部分) データを収集します。
    </p><p>
      サーバーが相互排他ロックインストゥルメントを作成できないと、次の結果が発生します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          インストゥルメントの行が <code class="literal">setup_instruments</code> テーブルに挿入されません。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_mutex_classes_lost</code> が 1 増加します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_mutex_instances_lost</code> は変更されません。 (相互排他ロックインストゥルメントが作成されない場合、あとでインストゥルメントされた相互排他ロックインスタンスの作成にそれを使用できません。) 
        </p></li></ul></div><p>
      先述のパターンは相互排他ロックだけでなく、すべての種類のインストゥルメントに当てはまります。
    </p><p>
      0 より大きい <code class="literal">Performance_schema_mutex_classes_lost</code> の値は 2 つのケースで発生する可能性があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数バイトのメモリーを節約するには、サーバーを <code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code> で起動します。ここで <em class="replaceable"><code>N</code></em> はデフォルト値未満です。 デフォルト値を選択すれば、MySQL 配布で提供されるすべてのプラグインをロードするために十分ですが、一部のプラグインをロードしない場合にこれを減らすことができます。 たとえば、配布内の一部のストレージエンジンをロードしないように選択できます。 
        </p></li><li class="listitem"><p>
          パフォーマンススキーマ用にインストゥルメントされたサードパーティープラグインをロードしますが、サーバーの起動時に、プラグインのインストゥルメンテーションメモリー要件を考慮しません。 それはサードパーティー製であるため、このエンジンのインストゥルメントメモリー消費は <code class="literal">performance_schema_max_mutex_classes</code> で選択されたデフォルト値で考慮されていません。 
        </p><p>
          サーバーにプラグインのインストゥルメント用の十分なリソースがなく、ユーザーが <code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code> を使用して、明示的に多く割り当てていない場合、このプラグインをロードすると、インストゥルメントが不足します。
        </p></li></ul></div><p>
      <code class="literal">performance_schema_max_mutex_classes</code> に選択されている値が小さすぎる場合、エラーログにエラーが報告されず、実行時に障害が発生しません。 ただし、<code class="literal">performance_schema</code> データベース内のテーブルの内容にイベントがありません。 <code class="literal">Performance_schema_mutex_classes_lost</code> ステータス変数は、インストゥルメントの作成の失敗のために、一部のイベントが内部で削除されたことを示す唯一の目に見えるしるしです。 
    </p><p>
      インストゥルメントが失われていない場合、それはパフォーマンススキーマに認識され、インスタンスのインストゥルメント時に使用されます。 たとえば、<code class="literal">wait/synch/mutex/sql/LOCK_delete</code> は <code class="literal">setup_instruments</code> テーブル内の相互排他ロックインストゥルメントの名前です。 サーバーの実行時に相互排他ロックの多くのインスタンスが必要であっても、コード内 (<code class="literal">THD::LOCK_delete</code> 内) で相互排他ロックの作成時に、この単一のインストゥルメントが使用されます。 この場合、<code class="literal">LOCK_delete</code> は接続 (<code class="literal">THD</code>) ごとの相互排他ロックであるため、サーバーに 1000 接続がある場合、1000 スレッドと 1000 個のインストゥルメントされた <code class="literal">LOCK_delete</code> 相互排他ロックインスタンス (<code class="literal">THD::LOCK_delete</code>) が存在します。 
    </p><p>
      サーバーにこれらの 1000 個のインストゥルメントされた相互排他ロック (インスタンス) すべてのための空きがない場合、一部の相互排他ロックはインストゥルメンテーション付きで作成され、一部はインストゥルメンテーションなしで作成されます。 サーバーが 800 インスタンスしか作成できない場合、200 インスタンスが失われます。 サーバーは実行し続けますが、<code class="literal">Performance_schema_mutex_instances_lost</code> を 200 増分し、インスタンスを作成できなかったことを示します。 
    </p><p>
      0 より大きい <code class="literal">Performance_schema_mutex_instances_lost</code> は、<code class="option">--performance_schema_max_mutex_instances=<em class="replaceable"><code>N</code></em></code> で割り当てられたものより多くの相互排他ロックを、コードで実行時に初期化した場合に発生する可能性があります。
    </p><p>
      結論として、<code class="literal">SHOW STATUS LIKE 'perf%'</code> に何も失われていないことが示されている (すべての値がゼロ) 場合に、パフォーマンススキーマデータは正確で信頼できます。 何かが失われた場合、データは不完全であり、使用するように与えられたメモリーの量が不十分であったとすると、パフォーマンススキーマはすべてを記録できていません。 この場合、特定の <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_lost</code> 変数に問題の領域が示されます。 
    </p><p>
      場合によって、意図的にインストゥルメントの不足を発生させることが適切なことがあります。 たとえば、ファイル I/O のパフォーマンスデータに関心がない場合は、ファイル I/O に関連するすべてのパフォーマンススキーマのパラメータを 0 に設定して、サーバーを起動できます。 ファイル関連のクラス、インスタンスまたはハンドルにメモリーは割り当てられず、すべてのファイルイベントが失われます。 
    </p><p>
      <code class="literal">SHOW ENGINE PERFORMANCE_SCHEMA STATUS</code> を使用して、パフォーマンススキーマコードの内部操作を検査します。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW ENGINE PERFORMANCE_SCHEMA STATUS\G</code></strong>
...
*************************** 3. row ***************************
  Type: performance_schema
  Name: events_waits_history.size
Status: 76
*************************** 4. row ***************************
  Type: performance_schema
  Name: events_waits_history.count
Status: 10000
*************************** 5. row ***************************
  Type: performance_schema
  Name: events_waits_history.memory
Status: 760000
...
*************************** 57. row ***************************
  Type: performance_schema
  Name: performance_schema.memory
Status: 26459600
...
</pre><p>
      このステートメントは、さまざまなパフォーマンススキーマオプションがメモリー要件に与える効果について、DBA が理解できるようにすることを目的としています。 フィールドの意味の説明については、<a class="xref" href="sql-statements.html#show-engine" title="13.7.7.15 SHOW ENGINE ステートメント">セクション13.7.7.15「SHOW ENGINE ステートメント」</a>を参照してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-atom-molecule-events"></a>27.8 パフォーマンススキーマの原子的および分子的イベント</h2></div></div></div><p>
      テーブル I/O イベントの場合、<code class="literal">events_waits_current</code> には通常 1 行ではなく、2 行あります。 たとえば、行フェッチにより、次のような行になる可能性があります。 
    </p><pre class="programlisting">Row# EVENT_NAME                 TIMER_START TIMER_END
---- ----------                 ----------- ---------
   1 wait/io/file/myisam/dfile        10001 10002
   2 wait/io/table/sql/handler        10000 NULL
</pre><p>
      行フェッチによりファイルが読み取られます。 例では、テーブル I/O フェッチイベントがファイル I/O イベントの前に起動していますが、終了していません (その <code class="literal">TIMER_END</code> 値が <code class="literal">NULL</code> です)。 ファイル I/O イベントはテーブル I/O イベント内に<span class="quote">「<span class="quote">ネスト</span>」</span>されます。 
    </p><p>
      これは、相互排他ロックやファイル I/O などのほかの<span class="quote">「<span class="quote">原子的</span>」</span>待機イベントと異なり、テーブル I/O イベントは<span class="quote">「<span class="quote">分子的</span>」</span>で、ほかのイベントを含んで (重複して) います。 <code class="literal">events_waits_current</code> で、テーブル I/O イベントには通常 2 つの行があります。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          最新のテーブル I/O 待機イベントについての 1 行
        </p></li><li class="listitem"><p>
          任意の種類の最新の待機イベントについての 1 行
        </p></li></ul></div><p>
      通常、ただし常にではありませんが、<span class="quote">「<span class="quote">どの種類の</span>」</span>待機イベントもテーブル I/O イベントと異なります。 各従属イベントが完了すると、それは <code class="literal">events_waits_current</code> から消去されます。 この時点で、および次の従属イベントが開始されるまで、テーブル I/O 待機は、あらゆる種類の最新の待機でもあります。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-event-tables"></a>27.9 現在および過去のイベントのパフォーマンススキーマテーブル</h2></div></div></div><p>
      wait、stage、statement、および transaction イベントの場合、パフォーマンススキーマは現在のイベントをモニターおよび格納できます。 また、イベントが終了すると、パフォーマンススキーマはそれらを履歴テーブルに格納できます。 イベントタイプごとに、パフォーマンススキーマは現在のイベントと履歴イベントの格納に 3 つのテーブルを使用します。 テーブルには次の形式の名前があります。ここで、<em class="replaceable"><code>xxx</code></em> はイベントタイプ (<code class="literal">waits</code>, <code class="literal">stages</code>, <code class="literal">statements</code>, <code class="literal">transactions</code>) を示します: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>: <span class="quote">「<span class="quote">現在のイベント</span>」</span>テーブルには、各スレッド (スレッドごとに 1 行) の現在の監視対象イベントが格納されます。
        </p></li><li class="listitem"><p>
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>: <span class="quote">「<span class="quote">最近の履歴</span>」</span>テーブルには、スレッドごとに終了した最新のイベントが格納されます (スレッド当たりの最大行数まで)。
        </p></li><li class="listitem"><p>
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>: <span class="quote">「<span class="quote">長い履歴</span>」</span>テーブルには、グローバルに終了した最新のイベントが格納されます (すべてのスレッドで、テーブル当たりの最大行数まで)。
        </p></li></ul></div><p>
      各イベントタイプの<code class="literal">_current</code> テーブルにはスレッドごとに 1 つの行が含まれるため、その最大サイズを構成するためのシステム変数はありません。 パフォーマンススキーマは、個々の履歴テーブルを説明するセクションに示されているように、テーブル固有のシステム変数を使用して、サーバーの起動時に履歴テーブルのサイズを自動設定するか、サイズを明示的に構成できます。 一般的な自動サイズ設定された値は、<code class="literal">_history</code> テーブルではスレッドごとに 10 行、<code class="literal">_history_long</code> テーブルでは合計 10,000 行です。 
    </p><p>
      イベントタイプごとに、<code class="literal">_current</code>、<code class="literal">_history</code> および<code class="literal">_history_long</code> の各テーブルに同じカラムがあります。 <code class="literal">_current</code> テーブルと<code class="literal">_history</code> テーブルのインデックス付けは同じです。 <code class="literal">_history_long</code> テーブルにインデックス付けがありません。 
    </p><p>
      <code class="literal">_current</code> テーブルには、サーバー内で現在何が起こっているかが表示されます。 現在のイベントが終了すると、その<code class="literal">_current</code> テーブルから削除されます。 
    </p><p>
      <code class="literal">_history</code> および<code class="literal">_history_long</code> のテーブルには、最近行われたことが表示されます。 履歴テーブルがいっぱいになると、新しいイベントが追加されると古いイベントは破棄されます。 テーブルの目的が異なるため、<code class="literal">_history</code> テーブルと<code class="literal">_history_long</code> テーブルの行は様々な方法で期限切れになります: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">_history</code> は、グローバルサーバーの負荷に関係なく、個々のスレッドを調査することを目的としています。
        </p></li><li class="listitem"><p>
          <code class="literal">_history_long</code> は、各スレッドではなくグローバルにサーバーを調査することを目的としています。
        </p></li></ul></div><p>
      2 つのタイプの履歴テーブルの違いは、データ保存ポリシーに関連します。 イベントが最初に表示されたときに、両方のテーブルに同じデータが含まれています。 ただし、各テーブル内のデータは時間の経過とともに異なる期限が切れるため、各テーブルでデータが長期間または短時間保持される可能性があります: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">_history</code> では、テーブルに特定のスレッドの最大行数が含まれている場合、そのスレッドの新しい行が追加されると、最も古いスレッド行は破棄されます。
        </p></li><li class="listitem"><p>
          <code class="literal">_history_long</code> では、テーブルがいっぱいになると、いずれかの行を生成したスレッドに関係なく、新しい行が追加されたときに最も古い行が破棄されます。
        </p></li></ul></div><p>
      スレッドが終了すると、そのすべての行は<code class="literal">_history</code> テーブルから破棄されますが、<code class="literal">_history_long</code> テーブルからは破棄されません。
    </p><p>
      次の例は、2 つのタイプの履歴テーブルに対してイベントを追加および破棄する方法の違いを示しています。 原則はすべてのイベントタイプに均等に適用されます。 この例は、次の前提に基づいています: 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          パフォーマンススキーマは、スレッドあたり 10 行を<code class="literal">_history</code> テーブルに保持し、合計 10,000 行を<code class="literal">_history_long</code> テーブルに保持するように構成されています。
        </p></li><li class="listitem"><p>
          スレッド A は 1 秒当たり 1 つのイベントを生成します。
        </p><p>
          スレッド B は 100 イベント/秒を生成します。
        </p></li><li class="listitem"><p>
          他のスレッドは実行されていません。
        </p></li></ul></div><p>
      5 秒後:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A および B は、それぞれ 5 および 500 のイベントを生成しました。
        </p></li><li class="listitem"><p>
          <code class="literal">_history</code> には、A に 5 行、B に 10 行が含まれています。 スレッド当たりの記憶域は 10 行に制限されているため、A の行は破棄されていませんが、B の 490 行は破棄されています。 
        </p></li><li class="listitem"><p>
          <code class="literal">_history_long</code> には、A は 5 行、B は 500 行が含まれています。 テーブルの最大サイズは 10,000 行であるため、いずれのスレッドでも破棄された行はありません。 
        </p></li></ul></div><p>
      実行の 5 分 (300 秒) 後:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A および B は、それぞれ 300 および 30,000 個のイベントを生成しました。
        </p></li><li class="listitem"><p>
          <code class="literal">_history</code> には、A に 10 行、B に 10 行が含まれています。 スレッド当たりの記憶域は 10 行に制限されているため、A の 290 行は破棄されましたが、B の 29,990 行は破棄されました。 A の行には最大 10 秒経過したデータが含まれ、B の行には最大 .1 秒経過したデータのみが含まれます。 
        </p></li><li class="listitem"><p>
          <code class="literal">_history_long</code> には 10,000 行が含まれます。 A と B はともに 101 イベント/秒を生成するため、テーブルには A ではなく B から約 100 から 1 の行が混在した、約 10,000/101 = 99 秒前までのデータが含まれます。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-statement-digests"></a>27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング</h2></div></div></div><p>
      MySQL サーバーは、ステートメントダイジェスト情報を保守できます。 ダイジェストプロセスは、各 SQL ステートメントを正規化された形式 (ステートメントダイジェスト) に変換し、正規化された結果から SHA-256 ハッシュ値 (ダイジェストハッシュ値) を計算します。 正規化により、類似のステートメントがグループ化され、要約されて、サーバーが実行しているステートメントの種類とそれらが発生する頻度に関する情報が公開されます。 ダイジェストごとに、ダイジェストを生成する代表的なステートメントがサンプルとして格納されます。 このセクションでは、ステートメントのダイジェストとサンプリングがどのように行われるか、およびそれらがどのように役立つかについて説明します。 
    </p><p>
      MySQL Enterprise Firewall やクエリーリライトプラグインなどの他の機能がステートメントダイジェストにアクセスできるように、パフォーマンススキーマが使用可能かどうかに関係なくパーサーでダイジェストが実行されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#statement-digests-general" title="ステートメントダイジェストの一般概念">ステートメントダイジェストの一般概念</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#statement-digests-performance-schema" title="パフォーマンススキーマ内のステートメントダイジェスト">パフォーマンススキーマ内のステートメントダイジェスト</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#statement-digests-memory-use" title="ステートメントダイジェストメモリー使用">ステートメントダイジェストメモリー使用</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#statement-digests-sampling" title="ステートメントサンプリング">ステートメントサンプリング</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="statement-digests-general"></a>ステートメントダイジェストの一般概念</h3></div></div></div><p>
        パーサーは、SQL ステートメントを受信すると、そのダイジェストが必要な場合にステートメントダイジェストを計算します。これは、次のいずれかの条件に該当する場合に当てはまります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            パフォーマンススキーマダイジェストインストゥルメンテーションは有効です
          </p></li><li class="listitem"><p>
            MySQL Enterprise Firewall は有効です
          </p></li><li class="listitem"><p>
            クエリーリライトプラグインは有効です
          </p></li></ul></div><p>
        パーサーは、アプリケーションが SQL ステートメントから正規化されたステートメントダイジェストおよびダイジェストハッシュ値を計算するために呼び出すことができる <code class="literal">STATEMENT_DIGEST_TEXT()</code> および <code class="literal">STATEMENT_DIGEST()</code> 関数でも使用されます。
      </p><p>
        <code class="literal">max_digest_length</code> システム変数値は、正規化されたステートメントダイジェストの計算に使用できるセッション当たりの最大バイト数を決定します。 ダイジェスト計算中にその量の領域が使用されると、切捨てが発生: 解析されたステートメントからのそれ以上のトークンは収集されず、ダイジェスト値になりません。 解析されたトークンのバイト数が同じ正規化されたステートメントダイジェストを生成し、比較された場合、またはダイジェスト統計のために集計された場合にのみ、ステートメントが同じであるとみなされます。 
      </p><p>
        正規化されたステートメントが計算されると、そこから SHA-256 ハッシュ値が計算されます。 さらに、次のようになります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL Enterprise Firewall が有効な場合は呼び出され、計算されたダイジェストが使用可能になります。
          </p></li><li class="listitem"><p>
            クエリーリライトプラグインが有効になっている場合は、そのプラグインがコールされ、ステートメントダイジェストおよびダイジェスト値が使用可能になります。
          </p></li><li class="listitem"><p>
            パフォーマンススキーマでダイジェスト計測が有効になっている場合は、正規化されたステートメントダイジェストのコピーが作成され、最大 <code class="literal">performance_schema_max_digest_length</code> バイトが割り当てられます。 したがって、<code class="literal">performance_schema_max_digest_length</code> が <code class="literal">max_digest_length</code> より小さい場合、コピーは元のコピーと相対的に切り捨てられます。 正規化されたステートメントダイジェストのコピーは、元の正規化されたステートメントから計算された SHA-256 ハッシュ値とともに、適切な「パフォーマンススキーマ」テーブルに格納されます。 (パフォーマンススキーマが元のステートメントダイジェストと相対的に正規化されたステートメントダイジェストのコピーを切り捨てる場合、SHA-256 ハッシュ値は再計算されません。) 
          </p></li></ul></div><p>
        ステートメントの正規化では、ステートメントのテキストがより標準化されたダイジェスト文字列表現に変換され、一般的なステートメントの構造は保持されますが、構造に不可欠でない情報は削除されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            データベースまたはテーブル名などのオブジェクト識別子は保持されます。
          </p></li><li class="listitem"><p>
            リテラル値はパラメータマーカーに変換されます。 正規化されたステートメントは、名前、パスワード、日付などの情報を保持しません。 
          </p></li><li class="listitem"><p>
            コメントが削除され、空白が調整されます。
          </p></li></ul></div><p>
        これらのステートメントを考慮してください。
      </p><pre class="programlisting">SELECT * FROM orders WHERE customer_id=10 AND quantity&gt;20
SELECT * FROM orders WHERE customer_id = 20 AND quantity &gt; 100
</pre><p>
        これらのステートメントを正規化するために、パーサーは <code class="literal">?</code> によってデータ値を置換し、空白を調整します。 どちらのステートメントも同じ正規化形式になるため、<span class="quote">「<span class="quote">同じ</span>」</span>とみなされます。 
      </p><pre class="programlisting">SELECT * FROM orders WHERE customer_id = ? AND quantity &gt; ?
</pre><p>
        正規化されたステートメントは、格納される情報は少ないですが、引き続き元のステートメントを代表しています。 異なるデータ値を持つ他の同様のステートメントは、同じ正規化形式になります。 
      </p><p>
        ここで、これらのステートメントを考慮してください。
      </p><pre class="programlisting">SELECT * FROM customers WHERE customer_id = 1000
SELECT * FROM orders WHERE customer_id = 1000
</pre><p>
        この場合、オブジェクト識別子が異なるため、正規化されたステートメントは異なります:
      </p><pre class="programlisting">SELECT * FROM customers WHERE customer_id = ?
SELECT * FROM orders WHERE customer_id = ?
</pre><p>
        正規化によってダイジェストバッファで使用可能な領域を超えるステートメント (<code class="literal">max_digest_length</code> によって決定) が生成された場合、切捨てが発生し、テキストは <span class="quote">「<span class="quote">...</span>」</span> で終了します。 <span class="quote">「<span class="quote">...</span>」</span> に続く部分のみが異なる長い正規化されたステートメントは、同じとみなされます。 これらのステートメントを考慮してください。 
      </p><pre class="programlisting">SELECT * FROM mytable WHERE cola = 10 AND colb = 20
SELECT * FROM mytable WHERE cola = 10 AND colc = 20
</pre><p>
        <code class="literal">AND</code> の直後にカットオフが発生した場合、両方のステートメントの形式は次のように正規化されます:
      </p><pre class="programlisting">SELECT * FROM mytable WHERE cola = ? AND ...
</pre><p>
        この場合、2 つ目のカラム名の違いが失われ、両方のステートメントが同じとみなされます。
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="statement-digests-performance-schema"></a>パフォーマンススキーマ内のステートメントダイジェスト</h3></div></div></div><p>
        パフォーマンススキーマでは、ステートメントダイジェストには次の要素が含まれます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブル内の <code class="literal">statements_digest</code> コンシューマは、パフォーマンススキーマがダイジェスト情報を保持するかどうかを制御します。 <a class="xref" href="performance-schema.html#performance-schema-consumer-filtering-statement-digest" title="ステートメントダイジェストコンシューマ">ステートメントダイジェストコンシューマ</a>を参照してください。 
          </p></li><li class="listitem"><p>
            ステートメントイベントテーブル (<code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code>) には、正規化されたステートメントダイジェストおよび対応するダイジェスト SHA-256 ハッシュ値を格納するためのカラムがあります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">DIGEST_TEXT</code> は、正規化されたステートメントダイジェストのテキストです。 これは、最大 <code class="literal">max_digest_length</code> バイトに計算され、必要に応じてさらに <code class="literal">performance_schema_max_digest_length</code> バイトに切り捨てられた元の正規化されたステートメントのコピーです。 
              </p></li><li class="listitem"><p>
                <code class="literal">DIGEST</code> は、元の正規化されたステートメントから計算されたダイジェスト SHA-256 ハッシュ値です。
              </p></li></ul></div><p>
            <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルには、集計されたステートメントダイジェスト情報が表示されます。 このテーブルは、<code class="literal">SCHEMA_NAME</code> と <code class="literal">DIGEST</code> の組合せごとにステートメントの情報を集計します。 パフォーマンススキーマは、SHA-256 ハッシュ値を集約に使用します。これらは、計算が高速で、衝突を最小限に抑える有利な統計分布を持つためです。 <a class="xref" href="performance-schema.html#performance-schema-statement-summary-tables" title="27.12.18.3 ステートメントサマリーテーブル">セクション27.12.18.3「ステートメントサマリーテーブル」</a>を参照してください。 
          </p></li></ul></div><p>
        一部のパフォーマンステーブルには、ダイジェストの計算元となる元の SQL ステートメントを格納するカラムがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code> ステートメントイベントテーブルの <code class="literal">SQL_TEXT</code> カラム。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルの <code class="literal">QUERY_SAMPLE_TEXT</code> カラム。
          </p></li></ul></div><p>
        ステートメントの表示に使用できる最大領域は、デフォルトで 1024 バイトです。 この値を変更するには、サーバーの起動時に <code class="literal">performance_schema_max_sql_text_length</code> システム変数を設定します。 変更は、指定したすべてのカラムに必要な記憶域に影響します。 
      </p><p>
        <code class="literal">performance_schema_max_digest_length</code> システム変数は、パフォーマンススキーマ内のダイジェスト値の格納に使用できるステートメントあたりの最大バイト数を決定します。 ただし、ステートメントのダイジェストの表示長は、キーワードやリテラル値などのステートメント要素の内部エンコーディングのため、使用可能なバッファサイズより長くなる場合があります。 したがって、ステートメントイベントテーブルの <code class="literal">DIGEST_TEXT</code> カラムから選択された値は、<code class="literal">performance_schema_max_digest_length</code> 値を超えるように見える場合があります。 
      </p><p>
        <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルには、サーバーによって実行されるステートメントのプロファイルが表示されます。 それは、アプリケーションが実行しているステートメントの種類とその頻度を示します。 アプリケーション開発者はこの情報をテーブル内のほかの情報と組み合わせて使用し、アプリケーションのパフォーマンス特性を査定できます。 たとえば、待機時間、ロック時間、またはインデックスの使用を示すテーブルカラムは不十分なクエリーの種類を強調表示することができます。 これにより、開発者が注意が必要なアプリケーションの部分を把握できます。 
      </p><p>
        <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルのサイズは固定です。 デフォルトでは、パフォーマンススキーマは起動時に使用するサイズを見積もります。 テーブルサイズを明示的に指定するには、サーバーの起動時に <code class="literal">performance_schema_digests_size</code> システム変数を設定します。 テーブルがいっぱいになると、パフォーマンススキーマは、<code class="literal">SCHEMA_NAME</code> と <code class="literal">DIGEST</code> の値がテーブル内の既存の値と一致しないステートメントを、<code class="literal">SCHEMA_NAME</code> と <code class="literal">DIGEST</code> が <code class="literal">NULL</code> に設定された特殊な行にグループ化します。 これにより、すべてのステートメントがカウントされます。 ただし、特殊な行が実行されたステートメントのかなりの割合を占める場合は、<code class="literal">performance_schema_digests_size</code> を増やすことによってサマリーテーブルのサイズを増やすことをお勧めします。 
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="statement-digests-memory-use"></a>ステートメントダイジェストメモリー使用</h3></div></div></div><p>
        末尾のみが異なる非常に長いステートメントを生成するアプリケーションの場合、<code class="literal">max_digest_length</code> を増やすと、同じダイジェストに集約されるステートメントを区別するダイジェストの計算が可能になります。 逆に、<code class="literal">max_digest_length</code> を減らすと、サーバーはダイジェスト記憶域専用のメモリーが少なくなりますが、同じダイジェストに集計する長いステートメントの可能性が高くなります。 管理者は、特に多数の同時セッションを含むワークロード (サーバーがセッションごとに <code class="literal">max_digest_length</code> バイトを割り当てる) では、値を大きくすると、対応するメモリー要件が増加することに注意してください。 
      </p><p>
        前述のように、パーサーによって計算される正規化されたステートメントダイジェストは最大 <code class="literal">max_digest_length</code> バイトに制約されますが、パフォーマンススキーマに格納される正規化されたステートメントダイジェストは <code class="literal">performance_schema_max_digest_length</code> バイトを使用します。 <code class="literal">max_digest_length</code> および <code class="literal">performance_schema_max_digest_length</code> の相対値に関して、次のメモリー使用上の考慮事項が適用されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">max_digest_length</code> が <code class="literal">performance_schema_max_digest_length</code> より小さい場合:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                パフォーマンススキーマ以外のサーバー機能は、最大 <code class="literal">max_digest_length</code> バイトを占める正規化されたステートメントダイジェストを使用します。
              </p></li><li class="listitem"><p>
                パフォーマンススキーマは、格納されている正規化されたステートメントダイジェストをさらに切り捨てることはありませんが、ダイジェストあたりの <code class="literal">max_digest_length</code> バイト数よりも多くのメモリーを割り当てます。これは不要です。
              </p></li></ul></div></li><li class="listitem"><p>
            <code class="literal">max_digest_length</code> が <code class="literal">performance_schema_max_digest_length</code> と等しい場合:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                パフォーマンススキーマ以外のサーバー機能は、最大 <code class="literal">max_digest_length</code> バイトを占める正規化されたステートメントダイジェストを使用します。
              </p></li><li class="listitem"><p>
                パフォーマンススキーマは、格納されている正規化されたステートメントダイジェストをさらに切り捨てず、ダイジェストあたりの <code class="literal">max_digest_length</code> バイト数と同じ量のメモリーを割り当てます。
              </p></li></ul></div></li><li class="listitem"><p>
            <code class="literal">max_digest_length</code> が <code class="literal">performance_schema_max_digest_length</code> より大きい場合:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                パフォーマンススキーマ以外のサーバー機能は、最大 <code class="literal">max_digest_length</code> バイトを占める正規化されたステートメントダイジェストを使用します。
              </p></li><li class="listitem"><p>
                パフォーマンススキーマは、格納されている正規化されたステートメントダイジェストをさらに切り捨て、ダイジェストあたりの <code class="literal">max_digest_length</code> バイト数より少ないメモリーを割り当てます。
              </p></li></ul></div></li></ul></div><p>
        パフォーマンススキーマのステートメントイベントテーブルには多くのダイジェストが格納される可能性があるため、<code class="literal">max_digest_length</code> より小さい <code class="literal">performance_schema_max_digest_length</code> を設定すると、管理者は次の要素のバランスを取ることができます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            パフォーマンススキーマ外のサーバー機能で使用可能な長い正規化されたステートメントダイジェストが必要です
          </p></li><li class="listitem"><p>
            多くの同時セッション。それぞれがダイジェスト計算メモリーを割り当てます
          </p></li><li class="listitem"><p>
            多数のステートメントダイジェストを格納するときに、パフォーマンススキーマステートメントイベントテーブルによるメモリー消費を制限する必要がある
          </p></li></ul></div><p>
        <code class="literal">performance_schema_max_digest_length</code> 設定はセッションごとではなく、ステートメントごとであり、セッションは <code class="literal">events_statements_history</code> テーブルに複数のステートメントを格納できます。 このテーブルの典型的なステートメントの数はセッションごとに 10 であるため、各セッションは、このテーブルのみに対して <code class="literal">performance_schema_max_digest_length</code> 値で示されるメモリーの 10 倍を消費します。 
      </p><p>
        また、多くのステートメント (およびダイジェスト) がグローバルに収集されており、特に <code class="literal">events_statements_history_long</code> テーブルにあります。 ここでも、格納された <em class="replaceable"><code>N</code></em> ステートメントは、<code class="literal">performance_schema_max_digest_length</code> 値で示されたメモリーの <em class="replaceable"><code>N</code></em> 倍を消費します。 
      </p><p>
        SQL ステートメントの格納およびダイジェスト計算に使用されるメモリー量を評価するには、<code class="literal">SHOW ENGINE PERFORMANCE_SCHEMA STATUS</code> ステートメントを使用するか、次のインスツルメントを監視します:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%.sqltext';</code></strong>
+------------------------------------------------------------------+
| NAME                                                             |
+------------------------------------------------------------------+
| memory/performance_schema/events_statements_history.sqltext      |
| memory/performance_schema/events_statements_current.sqltext      |
| memory/performance_schema/events_statements_history_long.sqltext |
+------------------------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SELECT NAME</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'memory/performance_schema/%.tokens';</code></strong>
+----------------------------------------------------------------------+
| NAME                                                                 |
+----------------------------------------------------------------------+
| memory/performance_schema/events_statements_history.tokens           |
| memory/performance_schema/events_statements_current.tokens           |
| memory/performance_schema/events_statements_summary_by_digest.tokens |
| memory/performance_schema/events_statements_history_long.tokens      |
+----------------------------------------------------------------------+
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="statement-digests-sampling"></a>ステートメントサンプリング</h3></div></div></div><p>
        パフォーマンススキーマは、ステートメントサンプリングを使用して、<code class="literal">events_statements_summary_by_digest</code> テーブル内の各ダイジェスト値を生成する代表的なステートメントを収集します。 これらのカラムには、サンプルステートメントの情報が格納されます: <code class="literal">QUERY_SAMPLE_TEXT</code> (ステートメントのテキスト)、<code class="literal">QUERY_SAMPLE_SEEN</code> (ステートメントが表示されたとき) および <code class="literal">QUERY_SAMPLE_TIMER_WAIT</code> (ステートメントの待機時間または実行時間)。 パフォーマンススキーマは、サンプルステートメントを選択するたびに 3 つのカラムすべてを更新します。 
      </p><p>
        新しいテーブル行が挿入されると、行ダイジェスト値を生成したステートメントは、ダイジェストに関連付けられた現在のサンプルステートメントとして格納されます。 その後、同じダイジェスト値を持つほかのステートメントがサーバーに表示されるときに、新しいステートメントを使用して現在のサンプルステートメントを置き換えるかどうか (つまり、再サンプリングするかどうか) を決定します。 リサンプリングポリシーは、現在のサンプルステートメントと新しいステートメントの比較待機時間、およびオプションで現在のサンプルステートメントの経過時間に基づきます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            待機時間に基づくリサンプリング: 新しいステートメントの待機時間が現在のサンプルステートメントの待機時間よりも長い場合は、現在のサンプルステートメントになります。
          </p></li><li class="listitem"><p>
            年齢に基づくリサンプリング: <code class="literal">performance_schema_max_digest_sample_age</code> システム変数の値がゼロより大きく、現在のサンプルステートメントが何秒以上経過している場合、現在のステートメントは<span class="quote">「<span class="quote">「古すぎます」</span>」</span>とみなされ、新しいステートメントで置き換えられます。 これは、新しいステートメントの待機時間が現在のサンプルステートメントの待機時間より短い場合でも発生します。 
          </p></li></ul></div><p>
        デフォルトでは、<code class="literal">performance_schema_max_digest_sample_age</code> は 60 秒 (1 分) です。 経過時間による <span class="quote">「<span class="quote">expire</span>」</span> ステートメントのサンプリング速度を変更するには、値を増減します。 リサンプリングポリシーのエージベース部分を無効にするには、<code class="literal">performance_schema_max_digest_sample_age</code> を 0 に設定します。 
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-table-characteristics"></a>27.11 パフォーマンススキーマの一般的なテーブル特性</h2></div></div></div><p>
      <code class="literal">performance_schema</code> データベースの名前は小文字で、その中のテーブルの名前も同様です。 クエリーでは名前を小文字で指定してください。 
    </p><a class="indexterm" name="idm45882612102160"></a><a class="indexterm" name="idm45882612100048"></a><p>
      <code class="literal">performance_schema</code> データベースの多くのテーブルは読取り専用で、変更できません:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>TRUNCATE TABLE performance_schema.setup_instruments;</code></strong>
ERROR 1683 (HY000): Invalid performance_schema usage.
</pre><p>
      セットアップテーブルの一部には、パフォーマンススキーマ操作に影響するように変更できるカラムがあります。さらに行の挿入や削除を許可するものもあります。 収集されたイベントをクリアするために切り捨てが許可されるため、<code class="literal">events_waits_</code> のプリフィクスのある名前のテーブルなど、それらの種類の情報を格納するテーブルで、<code class="literal">TRUNCATE TABLE</code> を使用できます。 
    </p><p>
      サマリーテーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。 一般に、サマリーカラムは行を削除するのではなく、0 または <code class="literal">NULL</code> にリセットされます。 これにより、収集された値をクリアし、アグリゲーションを再開できます。 それは、実行時構成の変更を行なったあとなどに便利な場合があります。 この切捨て動作の例外は、個々のサマリーテーブルのセクションに記載されています。 
    </p><p>
      ほかのデータベースやテーブルに対する権限は次のようになります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">performance_schema</code> テーブルから取得するには、<code class="literal">SELECT</code> 権限が必要です。
        </p></li><li class="listitem"><p>
          変更可能なそれらのカラムを変更するには、<code class="literal">UPDATE</code> 権限が必要です。
        </p></li><li class="listitem"><p>
          切り捨て可能なテーブルを切り捨てるには、<code class="literal">DROP</code> 権限が必要です。
        </p></li></ul></div><p>
      「パフォーマンススキーマ」テーブルに適用される権限のセットは限られているため、データベースまたはテーブルのアーカイブで権限を付与するための短縮形として <code class="literal">GRANT ALL</code> を使用しようとすると、次のエラーで失敗します:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>GRANT ALL ON performance_schema.*</code></strong>
       <strong class="userinput"><code>TO 'u1'@'localhost';</code></strong>
ERROR 1044 (42000): Access denied for user 'root'@'localhost'
to database 'performance_schema'
mysql&gt; <strong class="userinput"><code>GRANT ALL ON performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>TO 'u2'@'localhost';</code></strong>
ERROR 1044 (42000): Access denied for user 'root'@'localhost'
to database 'performance_schema'
</pre><p>
      かわりに、必要な権限を正確に付与します:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>GRANT SELECT ON performance_schema.*</code></strong>
       <strong class="userinput"><code>TO 'u1'@'localhost';</code></strong>
Query OK, 0 rows affected (0.03 sec)

mysql&gt; <strong class="userinput"><code>GRANT SELECT, UPDATE ON performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>TO 'u2'@'localhost';</code></strong>
Query OK, 0 rows affected (0.02 sec)
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-table-descriptions"></a>27.12 パフォーマンススキーマテーブルの説明</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">27.12.1 パフォーマンススキーマテーブルインデックス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">27.12.2 パフォーマンススキーマセットアップテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">27.12.3 パフォーマンススキーマインスタンステーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">27.12.4 パフォーマンススキーマ待機イベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">27.12.5 パフォーマンススキーマステージイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">27.12.6 パフォーマンススキーマステートメントイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-transaction-tables">27.12.7 パフォーマンススキーマのトランザクションテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">27.12.8 パフォーマンススキーマ接続テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">27.12.9 パフォーマンススキーマ接続属性テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-user-variable-tables">27.12.10 パフォーマンススキーマのユーザー定義変数テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-tables">27.12.11 パフォーマンススキーマレプリケーションテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-ndb-cluster-tables">27.12.12 パフォーマンススキーマ NDB Cluster テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-lock-tables">27.12.13 パフォーマンススキーマロックテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-system-variable-tables">27.12.14 パフォーマンススキーマシステム変数テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variable-tables">27.12.15 パフォーマンススキーマのステータス変数のテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-thread-pool-tables">27.12.16 パフォーマンススキーマスレッドプールテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-clone-tables">27.12.17 パフォーマンススキーマクローンテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">27.12.18 パフォーマンススキーマサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">27.12.19 パフォーマンススキーマのその他のテーブル</a></span></dt></dl></div><p>
      <code class="literal">performance_schema</code> データベース内のテーブルは次のようにグループ化できます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          セットアップテーブル。 これらのテーブルは、モニタリング特性の構成と表示に使われます。 
        </p></li><li class="listitem"><p>
          現在のイベントテーブル。 <code class="literal">events_waits_current</code> テーブルには各スレッドの最新のイベントが格納されます。 その他の類似テーブルには、イベント階層の様々なレベルの現在のイベントが含まれています: ステージイベントの場合は <code class="literal">events_stages_current</code>、ステートメントイベントの場合は <code class="literal">events_statements_current</code>、トランザクションイベントの場合は <code class="literal">events_transactions_current</code>。 
        </p></li><li class="listitem"><p>
          履歴テーブル。 これらのテーブルは現在のイベントテーブルと同じ構造を持ちますが、多くの行を格納します。 たとえば、待機イベントの場合、<code class="literal">events_waits_history</code> テーブルにはスレッドあたり最新の 10 イベントが格納されます。<code class="literal">events_waits_history_long</code> には最新の 10,000 イベントが格納されます。 ステージ、ステートメントおよびトランザクション履歴にも同様のテーブルがあります。 
        </p><p>
          履歴テーブルのサイズを変更するには、サーバー起動時に、該当するシステム変数を設定します。 たとえば、待機イベント履歴テーブルのサイズを設定するには、<code class="literal">performance_schema_events_waits_history_size</code> および <code class="literal">performance_schema_events_waits_history_long_size</code> を設定します。 
        </p></li><li class="listitem"><p>
          サマリーテーブル。 これらのテーブルには、履歴テーブルから破棄されたものを含むイベントのグループ全体で集計された情報が格納されます。 
        </p></li><li class="listitem"><p>
          インスタンステーブル。 これらのテーブルは、インストゥルメントされたオブジェクトの種類を記述します。 インストゥルメントされたオブジェクトは、サーバーによって使われると、イベントを生成します。 これらのテーブルは、イベント名と説明のメモまたはステータス情報を提供します。 
        </p></li><li class="listitem"><p>
          その他のテーブル。 これらはほかのどのテーブルグループにも分類されません。 
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-table-index"></a>27.12.1 パフォーマンススキーマテーブルインデックス</h3></div></div></div><p>
        次の表に、各パフォーマンススキーマテーブルを一覧表示し、それぞれの簡単な説明を提供します。
      </p><div class="table"><a name="performance-schema-tables-table"></a><p class="title"><b>表 27.1 パフォーマンススキーマテーブル</b></p><div class="table-contents"><table summary="Performance Schema tables and what information they contain."><col width="55%"><col width="45%"><thead><tr>
            <th>テーブル名</th>
            <th>説明</th>
          </tr></thead><tbody><tr>
            <td><code class="literal">accounts</code></td>
            <td>クライアントアカウントごとの接続統計</td>
          </tr><tr>
            <td><code class="literal">binary_log_transaction_compression_stats</code></td>
            <td>バイナリログトランザクション圧縮</td>
          </tr><tr>
            <td><code class="literal">clone_progress</code></td>
            <td>クローン操作の進行状況</td>
          </tr><tr>
            <td><code class="literal">clone_status</code></td>
            <td>クローン操作ステータス</td>
          </tr><tr>
            <td><code class="literal">cond_instances</code></td>
            <td>同期オブジェクトインスタンス</td>
          </tr><tr>
            <td><code class="literal">data_lock_waits</code></td>
            <td>データロック待機関係</td>
          </tr><tr>
            <td><code class="literal">data_locks</code></td>
            <td>保持およびリクエストされたデータロック</td>
          </tr><tr>
            <td><code class="literal">error_log</code></td>
            <td>サーバーエラーログの最近のエントリ</td>
          </tr><tr>
            <td><code class="literal">events_errors_summary_by_account_by_error</code></td>
            <td>エラーコードおよびアカウントごとのエラー</td>
          </tr><tr>
            <td><code class="literal">events_errors_summary_by_host_by_error</code></td>
            <td>エラーコードおよびホストごとのエラー</td>
          </tr><tr>
            <td><code class="literal">events_errors_summary_by_thread_by_error</code></td>
            <td>エラーコードおよびホストごとのエラー</td>
          </tr><tr>
            <td><code class="literal">events_errors_summary_by_user_by_error</code></td>
            <td>エラーコードおよびホストごとのエラー</td>
          </tr><tr>
            <td><code class="literal">events_errors_summary_global_by_error</code></td>
            <td>エラーコードごとのエラー</td>
          </tr><tr>
            <td><code class="literal">events_stages_current</code></td>
            <td>現在のステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_history</code></td>
            <td>スレッド当たりの最新のステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_history_long</code></td>
            <td>全体の最新ステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_summary_by_account_by_event_name</code></td>
            <td>アカウントおよびイベント名ごとのステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_summary_by_host_by_event_name</code></td>
            <td>ホスト名およびイベント名ごとのステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_summary_by_thread_by_event_name</code></td>
            <td>スレッドおよびイベント名ごとのステージ待機</td>
          </tr><tr>
            <td><code class="literal">events_stages_summary_by_user_by_event_name</code></td>
            <td>ユーザー名およびイベント名ごとのステージイベント</td>
          </tr><tr>
            <td><code class="literal">events_stages_summary_global_by_event_name</code></td>
            <td>イベント名ごとのステージ待機</td>
          </tr><tr>
            <td><code class="literal">events_statements_current</code></td>
            <td>現在のステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_histogram_by_digest</code></td>
            <td>スキーマおよびダイジェスト値ごとのステートメントヒストグラム</td>
          </tr><tr>
            <td><code class="literal">events_statements_histogram_global</code></td>
            <td>グローバルに要約されたステートメントヒストグラム</td>
          </tr><tr>
            <td><code class="literal">events_statements_history</code></td>
            <td>スレッド当たりの最新のステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_history_long</code></td>
            <td>全体の最新ステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_account_by_event_name</code></td>
            <td>アカウントおよびイベント名ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_digest</code></td>
            <td>スキーマおよびダイジェスト値ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_host_by_event_name</code></td>
            <td>ホスト名およびイベント名ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_program</code></td>
            <td>ストアドプログラムごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_thread_by_event_name</code></td>
            <td>スレッドおよびイベント名ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_by_user_by_event_name</code></td>
            <td>ユーザー名およびイベント名ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_statements_summary_global_by_event_name</code></td>
            <td>イベント名ごとのステートメントイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_current</code></td>
            <td>現在のトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_history</code></td>
            <td>スレッド当たりの最新のトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_history_long</code></td>
            <td>全体の最新のトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_summary_by_account_by_event_name</code></td>
            <td>アカウントおよびイベント名ごとのトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_summary_by_host_by_event_name</code></td>
            <td>ホスト名およびイベント名ごとのトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_summary_by_thread_by_event_name</code></td>
            <td>スレッドおよびイベント名ごとのトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_summary_by_user_by_event_name</code></td>
            <td>ユーザー名およびイベント名ごとのトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_transactions_summary_global_by_event_name</code></td>
            <td>イベント名ごとのトランザクションイベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_current</code></td>
            <td>現在の待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_history</code></td>
            <td>スレッド当たりの最新の待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_history_long</code></td>
            <td>全体の最新待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_by_account_by_event_name</code></td>
            <td>アカウントおよびイベント名ごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_by_host_by_event_name</code></td>
            <td>ホスト名およびイベント名ごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_by_instance</code></td>
            <td>インスタンスごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_by_thread_by_event_name</code></td>
            <td>スレッドおよびイベント名ごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_by_user_by_event_name</code></td>
            <td>ユーザー名およびイベント名ごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">events_waits_summary_global_by_event_name</code></td>
            <td>イベント名ごとの待機イベント</td>
          </tr><tr>
            <td><code class="literal">file_instances</code></td>
            <td>ファイルインスタンス</td>
          </tr><tr>
            <td><code class="literal">file_summary_by_event_name</code></td>
            <td>イベント名ごとのファイルイベント</td>
          </tr><tr>
            <td><code class="literal">file_summary_by_instance</code></td>
            <td>ファイルインスタンスごとのファイルイベント</td>
          </tr><tr>
            <td><code class="literal">firewall_groups</code></td>
            <td>キャッシュされた MySQL Enterprise Firewall グループプロファイルに表示</td>
          </tr><tr>
            <td><code class="literal">firewall_group_allowlist</code></td>
            <td>キャッシュされた MySQL Enterprise Firewall グループプロファイル許可リストへの表示</td>
          </tr><tr>
            <td><code class="literal">firewall_membership</code></td>
            <td>キャッシュされた MySQL Enterprise Firewall グループプロファイルメンバーへの表示</td>
          </tr><tr>
            <td><code class="literal">global_status</code></td>
            <td>グローバルステータス変数</td>
          </tr><tr>
            <td><code class="literal">global_variables</code></td>
            <td>グローバルシステム変数</td>
          </tr><tr>
            <td><code class="literal">host_cache</code></td>
            <td>内部ホストキャッシュからの情報</td>
          </tr><tr>
            <td><code class="literal">hosts</code></td>
            <td>クライアントホスト名ごとの接続統計</td>
          </tr><tr>
            <td><code class="literal">keyring_keys</code></td>
            <td>キーリングキーのメタデータ</td>
          </tr><tr>
            <td><code class="literal">log_status</code></td>
            <td>バックアップのためのサーバーログに関する情報</td>
          </tr><tr>
            <td><code class="literal">memory_summary_by_account_by_event_name</code></td>
            <td>アカウントおよびイベント名ごとのメモリー操作</td>
          </tr><tr>
            <td><code class="literal">memory_summary_by_host_by_event_name</code></td>
            <td>ホストおよびイベント名ごとのメモリー操作</td>
          </tr><tr>
            <td><code class="literal">memory_summary_by_thread_by_event_name</code></td>
            <td>スレッドおよびイベント名ごとのメモリー操作</td>
          </tr><tr>
            <td><code class="literal">memory_summary_by_user_by_event_name</code></td>
            <td>ユーザーおよびイベント名ごとのメモリー操作</td>
          </tr><tr>
            <td><code class="literal">memory_summary_global_by_event_name</code></td>
            <td>イベント名ごとのグローバルなメモリー操作</td>
          </tr><tr>
            <td><code class="literal">metadata_locks</code></td>
            <td>メタデータロックおよびロックリクエスト</td>
          </tr><tr>
            <td><code class="literal">mutex_instances</code></td>
            <td>相互排他ロック同期オブジェクトインスタンス</td>
          </tr><tr>
            <td><code class="literal">objects_summary_global_by_type</code></td>
            <td>オブジェクトサマリー</td>
          </tr><tr>
            <td><code class="literal">performance_timers</code></td>
            <td>使用可能なイベントタイマー</td>
          </tr><tr>
            <td><code class="literal">persisted_variables</code></td>
            <td><code class="filename">mysqld-auto.cnf</code> ファイルの内容</td>
          </tr><tr>
            <td><code class="literal">prepared_statements_instances</code></td>
            <td>プリペアドステートメントのインスタンスおよび統計</td>
          </tr><tr>
            <td><code class="literal">processlist</code></td>
            <td>プロセスリスト情報</td>
          </tr><tr>
            <td><code class="literal">replication_applier_configuration</code></td>
            <td>レプリカ上のレプリケーションアプライアンスの構成パラメータ</td>
          </tr><tr>
            <td><code class="literal">replication_applier_status</code></td>
            <td>レプリカ上のレプリケーションアプライアンスの現在のステータス</td>
          </tr><tr>
            <td><code class="literal">replication_applier_status_by_coordinator</code></td>
            <td>SQL またはコーディネータのスレッドアプライヤステータス</td>
          </tr><tr>
            <td><code class="literal">replication_applier_status_by_worker</code></td>
            <td>ワーカースレッドアプライヤステータス (レプリカがマルチスレッドでない場合は空)</td>
          </tr><tr>
            <td><code class="literal">replication_asynchronous_connection_failover</code></td>
            <td>非同期接続フェイルオーバーメカニズムのソースリスト</td>
          </tr><tr>
            <td><code class="literal">replication_connection_configuration</code></td>
            <td>ソースに接続するための構成パラメータ</td>
          </tr><tr>
            <td><code class="literal">replication_connection_status</code></td>
            <td>ソースへの接続の現在のステータス</td>
          </tr><tr>
            <td><code class="literal">rwlock_instances</code></td>
            <td>ロック同期オブジェクトインスタンス</td>
          </tr><tr>
            <td><code class="literal">session_account_connect_attrs</code></td>
            <td>現在のセッションごとの接続属性</td>
          </tr><tr>
            <td><code class="literal">session_connect_attrs</code></td>
            <td>すべてのセッションの接続属性</td>
          </tr><tr>
            <td><code class="literal">session_status</code></td>
            <td>現在のセッションのステータス変数</td>
          </tr><tr>
            <td><code class="literal">session_variables</code></td>
            <td>現在のセッションのシステム変数</td>
          </tr><tr>
            <td><code class="literal">setup_actors</code></td>
            <td>新しいフォアグラウンドスレッドのモニタリングの初期化方法</td>
          </tr><tr>
            <td><code class="literal">setup_consumers</code></td>
            <td>イベント情報を格納できるコンシューマ</td>
          </tr><tr>
            <td><code class="literal">setup_instruments</code></td>
            <td>イベントを収集できるインストゥルメントされたオブジェクトのクラス</td>
          </tr><tr>
            <td><code class="literal">setup_objects</code></td>
            <td>モニターすべきオブジェクト</td>
          </tr><tr>
            <td><code class="literal">setup_threads</code></td>
            <td>インストゥルメントされたスレッド名と属性</td>
          </tr><tr>
            <td><code class="literal">socket_instances</code></td>
            <td>アクティブな接続インスタンス</td>
          </tr><tr>
            <td><code class="literal">socket_summary_by_event_name</code></td>
            <td>イベント名ごとのソケット待機と I/O</td>
          </tr><tr>
            <td><code class="literal">socket_summary_by_instance</code></td>
            <td>インスタンスごとのソケット待機と I/O</td>
          </tr><tr>
            <td><code class="literal">status_by_account</code></td>
            <td>アカウントごとのセッションステータス変数</td>
          </tr><tr>
            <td><code class="literal">status_by_host</code></td>
            <td>ホスト名ごとのセッションステータス変数</td>
          </tr><tr>
            <td><code class="literal">status_by_thread</code></td>
            <td>セッションごとのセッションステータス変数</td>
          </tr><tr>
            <td><code class="literal">status_by_user</code></td>
            <td>ユーザー名ごとのセッションステータス変数</td>
          </tr><tr>
            <td><code class="literal">table_handles</code></td>
            <td>テーブルロックおよびロックリクエスト</td>
          </tr><tr>
            <td><code class="literal">table_io_waits_summary_by_index_usage</code></td>
            <td>インデックスごとのテーブル I/O 待機</td>
          </tr><tr>
            <td><code class="literal">table_io_waits_summary_by_table</code></td>
            <td>テーブルごとのテーブル I/O 待機</td>
          </tr><tr>
            <td><code class="literal">table_lock_waits_summary_by_table</code></td>
            <td>テーブルごとのテーブルロック待機</td>
          </tr><tr>
            <td><code class="literal">threads</code></td>
            <td>サーバースレッドに関する情報</td>
          </tr><tr>
            <td><code class="literal">tls_channel_status</code></td>
            <td>各接続インタフェースの TLS ステータス</td>
          </tr><tr>
            <td><code class="literal">tp_thread_group_state</code></td>
            <td>スレッドプールのスレッドグループの状態に関する情報</td>
          </tr><tr>
            <td><code class="literal">tp_thread_group_stats</code></td>
            <td>スレッドグループ統計</td>
          </tr><tr>
            <td><code class="literal">tp_thread_state</code></td>
            <td>スレッドプールスレッドの状態に関する情報</td>
          </tr><tr>
            <td><code class="literal">user_defined_functions</code></td>
            <td>登録済ユーザー定義関数</td>
          </tr><tr>
            <td><code class="literal">user_variables_by_thread</code></td>
            <td>スレッド当たりのユーザー定義変数</td>
          </tr><tr>
            <td><code class="literal">users</code></td>
            <td>クライアントユーザー名ごとの接続統計</td>
          </tr><tr>
            <td><code class="literal">variables_by_thread</code></td>
            <td>セッションごとのセッションシステム変数</td>
          </tr><tr>
            <td><code class="literal">variables_info</code></td>
            <td>システム変数が最近どのように設定されたか</td>
          </tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-setup-tables"></a>27.12.2 パフォーマンススキーマセットアップテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-actors-table">27.12.2.1 setup_actors テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-consumers-table">27.12.2.2 setup_consumers テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-instruments-table">27.12.2.3 setup_instruments テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-objects-table">27.12.2.4 setup_objects テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-threads-table">27.12.2.5 setup_threads テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-timers-table">27.12.2.6 setup_timers テーブル</a></span></dt></dl></div><p>
        セットアップテーブルは現在のインストゥルメンテーションに関する情報を提供し、モニタリング構成の変更を可能にします。 このため、<code class="literal">UPDATE</code> 権限を持つ場合、これらのテーブルの一部のカラムを変更できます。 
      </p><p>
        セットアップ情報に個々の変数ではなく、テーブルを使用することで、パフォーマンススキーマ構成の変更の高度な柔軟性を提供します。 たとえば、標準 SQL 構文の単一のステートメントを使用して、複数の同時の構成変更ができます。 
      </p><p>
        これらのセットアップテーブルを使用できます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_actors</code>: 新しいフォアグラウンドスレッドのモニタリングの初期化方法
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code>: イベント情報を送信および格納できる宛先
          </p></li><li class="listitem"><p>
            <code class="literal">setup_instruments</code>: イベントを収集できるインストゥルメントされたオブジェクトのクラス
          </p></li><li class="listitem"><p>
            <code class="literal">setup_objects</code>: モニターすべきオブジェクト
          </p></li><li class="listitem"><p>
            <code class="literal">setup_threads</code>: インストゥルメントされたスレッド名と属性
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-actors-table"></a>27.12.2.1 setup_actors テーブル</h4></div></div></div><a class="indexterm" name="idm45882611705776"></a><a class="indexterm" name="idm45882611703632"></a><p>
          <code class="literal">setup_actors</code> テーブルには、新しいフォアグラウンドサーバースレッド (クライアント接続に関連付けられたスレッド) の監視および履歴イベントロギングを有効にするかどうかを決定する情報が含まれます。 このテーブルはデフォルトで 100 行の最大サイズになります。 テーブルサイズを変更するには、サーバー起動時に <code class="literal">performance_schema_setup_actors_size</code> システム変数を変更します。 
        </p><p>
          新しいフォアグラウンドスレッドごとに、パフォーマンススキーマはスレッドのユーザーとホストを、<code class="literal">setup_actors</code> テーブルの行に対して照合します。 そのテーブルの行が一致する場合、その <code class="literal">ENABLED</code> カラムと <code class="literal">HISTORY</code> カラムの値を使用して、スレッドの <code class="literal">threads</code> テーブルの行の <code class="literal">INSTRUMENTED</code> カラムと <code class="literal">HISTORY</code> カラムがそれぞれ設定されます。 これにより、インストゥルメントおよび履歴イベントロギングをホスト、ユーザーまたはアカウント (ユーザーとホストの組合せ) ごとに選択的に適用できます。 一致するものがない場合、スレッドの <code class="literal">INSTRUMENTED</code> カラムと <code class="literal">HISTORY</code> カラムは <code class="literal">NO</code> に設定されます。 
        </p><p>
          バックグラウンドスレッドの場合、関連付けられたユーザーはありません。 <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> はデフォルトで <code class="literal">YES</code> であり、<code class="literal">setup_actors</code> は参照されません。 
        </p><p>
          <code class="literal">setup_actors</code> テーブルの初期コンテンツは任意のユーザーとホストの組合せに一致するため、監視および履歴イベント収集はすべてのフォアグラウンドスレッドに対してデフォルトで有効になっています:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_actors;</code></strong>
+------+------+------+---------+---------+
| HOST | USER | ROLE | ENABLED | HISTORY |
+------+------+------+---------+---------+
| %    | %    | %    | YES     | YES     |
+------+------+------+---------+---------+
</pre><p>
          <code class="literal">setup_actors</code> テーブルを使用してイベント監視に影響を与える方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-thread-filtering" title="27.4.6 スレッドによる事前フィルタリング">セクション27.4.6「スレッドによる事前フィルタリング」</a> を参照してください。
        </p><p>
          <code class="literal">setup_actors</code> テーブルの変更は、変更後に作成されたフォアグラウンドスレッドにのみ影響し、既存のスレッドには影響しません。 既存のスレッドに影響を与えるには、<code class="literal">threads</code> テーブルの行の <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> カラムを変更します。 
        </p><p>
          <code class="literal">setup_actors</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              ホスト名。 これらはリテラル名または<span class="quote">「<span class="quote">任意のホスト</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。 
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              ユーザー名。 これはリテラル名または<span class="quote">「<span class="quote">任意のユーザー</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。 
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              使用されません。
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              行に一致するフォアグラウンドスレッドのインストゥルメンテーションを有効にするかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">HISTORY</code>
            </p><p>
              行に一致するフォアグラウンドスレッドの履歴イベントをログに記録するかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 
            </p></li></ul></div><p>
          <code class="literal">setup_actors</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">HOST</code>, <code class="literal">USER</code>, <code class="literal">ROLE</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">setup_actors</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-consumers-table"></a>27.12.2.2 setup_consumers テーブル</h4></div></div></div><a class="indexterm" name="idm45882611649824"></a><a class="indexterm" name="idm45882611647616"></a><p>
          <code class="literal">setup_consumers</code> テーブルは、イベント情報を格納でき、有効にされているコンシューマの種類を一覧表示します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_consumers;</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| events_stages_current            | NO      |
| events_stages_history            | NO      |
| events_stages_history_long       | NO      |
| events_statements_current        | YES     |
| events_statements_history        | YES     |
| events_statements_history_long   | NO      |
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
| events_waits_current             | NO      |
| events_waits_history             | NO      |
| events_waits_history_long        | NO      |
| global_instrumentation           | YES     |
| thread_instrumentation           | YES     |
| statements_digest                | YES     |
+----------------------------------+---------+
</pre><p>
          <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。 さまざまなコンシューマを有効にすることの効果の詳細については、<a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="27.4.7 コンシューマによる事前フィルタリング">セクション27.4.7「コンシューマによる事前フィルタリング」</a>を参照してください。 
        </p><p>
          <code class="literal">setup_consumers</code> テーブルへの変更はただちにモニタリングに影響します。
        </p><p>
          <code class="literal">setup_consumers</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              コンシューマ名。
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              コンシューマが有効にされているかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 このカラムは変更できます。 コンシューマを無効にすると、サーバーはそれにイベント情報を追加する時間を費やさなくなります。 
            </p></li></ul></div><p>
          <code class="literal">setup_consumers</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">setup_consumers</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-instruments-table"></a>27.12.2.3 setup_instruments テーブル</h4></div></div></div><a class="indexterm" name="idm45882611622688"></a><a class="indexterm" name="idm45882611620480"></a><p>
          <code class="literal">setup_instruments</code> テーブルは、イベントを収集できるインストゥルメントされたオブジェクトのクラスを一覧表示します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_instruments\G</code></strong>
*************************** 1. row ***************************
         NAME: wait/synch/mutex/pfs/LOCK_pfs_share_list
      ENABLED: NO
        TIMED: NO
   PROPERTIES: singleton
   VOLATILITY: 1
DOCUMENTATION: Components can provide their own performance_schema tables.
               This lock protects the list of such tables definitions.
...
*************************** 369. row ***************************
         NAME: stage/sql/executing
      ENABLED: NO
        TIMED: NO
   PROPERTIES:
   VOLATILITY: 0
DOCUMENTATION: NULL
...
*************************** 687. row ***************************
         NAME: statement/abstract/Query
      ENABLED: YES
        TIMED: YES
   PROPERTIES: mutable
   VOLATILITY: 0
DOCUMENTATION: SQL query just received from the network. At this point,
               the real statement type is unknown, the type will be
               refined after SQL parsing.
...
*************************** 696. row ***************************
         NAME: memory/performance_schema/metadata_locks
      ENABLED: YES
        TIMED: NULL
   PROPERTIES: global_statistics
   VOLATILITY: 1
DOCUMENTATION: Memory used for table performance_schema.metadata_locks
...
</pre><p>
          ソースコードに追加された各インストゥルメントは、インストゥルメントコードが実行されない場合でも、<code class="literal">setup_instruments</code> テーブルの行を提供します。 インストゥルメントが有効化されて実行されると、インストゥルメントされたインスタンスが作成され、<code class="literal">file_instances</code> や <code class="literal">rwlock_instances</code> などの <code class="literal"><em class="replaceable"><code>xxx</code></em>_instances</code> テーブルに表示されます。 
        </p><p>
          ほとんどの <code class="literal">setup_instruments</code> 行を変更すると、すぐに監視に影響します。 一部のインストゥルメントでは、変更はサーバーの起動時にのみ有効です。実行時に変更しても効果はありません。 これは主にサーバー内の mutex、条件、および rwlocks に影響しますが、これが当てはまるほかのインストゥルメントが存在する可能性があります。 
        </p><p>
          イベントフィルタリングにおける <code class="literal">setup_instruments</code> テーブルの役割の詳細については、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_instruments</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              インストゥルメント名。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 インストゥルメントの実行から生成されるイベントには、インストゥルメント <code class="literal">NAME</code> 値から取得される <code class="literal">EVENT_NAME</code> 値があります。 (イベントには実際には<span class="quote">「<span class="quote">名前</span>」</span>がありませんが、これによって、イベントをインストゥルメントに関連付ける方法を提供します。) 
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              インストゥルメントが有効にされているかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 無効にされたインストゥルメントはイベントを生成しません。 このカラムは変更できますが、<code class="literal">ENABLED</code> の設定は、すでに作成されているインストゥルメントには影響しません。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              インストゥルメントの時間が測定されるかどうか。 値は、<code class="literal">YES</code>、<code class="literal">NO</code> または <code class="literal">NULL</code> です。 このカラムは変更できますが、<code class="literal">TIMED</code> の設定は、すでに作成されているインストゥルメントには影響しません。 
            </p><p>
              <code class="literal">TIMED</code> 値 <code class="literal">NULL</code> は、インストゥルメントがタイミングをサポートしていないことを示します。 たとえば、メモリー操作は時間指定されていないため、その <code class="literal">TIMED</code> カラムは <code class="literal">NULL</code> です。 
            </p><p>
              タイミングをサポートするインストゥルメントに対して <code class="literal">TIMED</code> を <code class="literal">NULL</code> に設定しても、タイミングをサポートしないインストゥルメントに対して <code class="literal">TIMED</code> を <code class="literal">NULL</code> 以外に設定しても効果はありません。
            </p><p>
              有効にされたインストゥルメントの時間が測定されない場合、インストゥルメントコードは有効ですが、タイマーは有効ではありません。 インストゥルメントによって生成されたイベントの <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> タイマー値が <code class="literal">NULL</code> になります。 これによって、サマリーテーブルの合計、最小、最大、および平均の時間値の計算時に、それらの値が無視されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROPERTIES</code>
            </p><p>
              インストゥルメントプロパティ。 このカラムは <code class="literal">SET</code> データ型を使用するため、インストゥルメントごとに次のリストの複数のフラグを設定できます: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">global_statistics</code>: インストゥルメントはグローバルサマリーのみを生成します。 スレッドごと、アカウントごと、ユーザーごと、ホストごとなど、より詳細なレベルのサマリーは使用できません。 たとえば、ほとんどのメモリーインストゥルメントではグローバルサマリーのみが生成されます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">mutable</code>: インストゥルメントは、より具体的なものに <span class="quote">「<span class="quote">mutate</span>」</span> できます。 このプロパティは、ステートメントインストゥルメントにのみ適用されます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">progress</code>: インストゥルメントは進捗データをレポートできます。 このプロパティはステージインストゥルメントにのみ適用されます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">singleton</code>: インストゥルメントには単一のインスタンスがあります。 たとえば、サーバー内のほとんどのグローバル mutex ロックはシングルトンであるため、対応するインストゥルメントも同様です。 
                </p></li><li class="listitem"><p>
                  <code class="literal">user</code>: インストゥルメントは、(システムワークロードではなく) ユーザーワークロードに直接関連しています。 そのようなインストゥルメントには、<code class="literal">wait/io/socket/sql/client_connection</code> があります。 
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">VOLATILITY</code>
            </p><p>
              インストゥルメントのボラティリティ。 ボラティリティ値の範囲は、低から高です。 値は、<code class="filename">mysql/psi/psi_base.h</code> ヘッダーファイルで定義されている <code class="literal">PSI_VOLATILITY_<em class="replaceable"><code>xxx</code></em></code> 定数に対応します: 
            </p><pre class="programlisting">#define PSI_VOLATILITY_UNKNOWN 0
#define PSI_VOLATILITY_PERMANENT 1
#define PSI_VOLATILITY_PROVISIONING 2
#define PSI_VOLATILITY_DDL 3
#define PSI_VOLATILITY_CACHE 4
#define PSI_VOLATILITY_SESSION 5
#define PSI_VOLATILITY_TRANSACTION 6
#define PSI_VOLATILITY_QUERY 7
#define PSI_VOLATILITY_INTRA_QUERY 8
</pre><p>
              <code class="literal">VOLATILITY</code> カラムは、ユーザー (およびパフォーマンススキーマコード) にインストゥルメントの実行時動作に関するヒントを提供するための単なる情報です。
            </p><p>
              低揮発性インデックス (PERMANENT = 1) を持つインストゥルメントは、サーバーの起動時に一度作成され、通常のサーバー操作中に破棄または再作成されることはありません。 これらは、サーバーの停止中にのみ破棄されます。 
            </p><p>
              たとえば、<code class="literal">wait/synch/mutex/pfs/LOCK_pfs_share_list</code> mutex は揮発性 1 で定義されており、これは一度作成されることを意味します。 インストゥルメンテーション自体から発生する可能性のあるオーバーヘッド (相互排他ロック初期化) は、このインストゥルメントには影響しません。 実行時オーバーヘッドは、mutex をロックまたはロック解除する場合にのみ発生します。 
            </p><p>
              ボラティリティインデックスが高いインストゥルメント (SESSION = 5 など) は、ユーザーセッションごとに作成および破棄されます。 たとえば、<code class="literal">wait/synch/mutex/sql/THD::LOCK_query_plan</code> mutex は、セッションが接続されるたびに作成され、セッションが切断されると破棄されます。 
            </p><p>
              この mutex は、パフォーマンススキーマのオーバーヘッドにより機密性が高くなります。これは、オーバーヘッドがロックおよびロック解除インストゥルメンテーションだけでなく、より頻繁に実行される相互排他ロック作成および破棄インストゥルメンテーションからも発生するためです。
            </p><p>
              ボラティリティの別の側面は、<code class="literal">ENABLED</code> カラムの更新が実際になんらかの影響を与えるかどうかと、そのタイミングに関するものです:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">ENABLED</code> の更新は、後で作成されるインストゥルメントされたオブジェクトに影響しますが、すでに作成されているインストゥルメントには影響しません。
                </p></li><li class="listitem"><p>
                  より多くの <span class="quote">「<span class="quote">volatile</span>」</span> のインストゥルメントでは、<code class="literal">setup_instruments</code> テーブルの新しい設定がより早く使用されます。
                </p></li></ul></div><p>
              たとえば、次のステートメントは既存のセッションの <code class="literal">LOCK_query_plan</code> mutex には影響しませんが、更新後に作成された新しいセッションには影響します:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED=<em class="replaceable"><code>value</code></em>
WHERE NAME = 'wait/synch/mutex/sql/THD::LOCK_query_plan';
</pre><p>
              このステートメントは、実際には何の効果もありません:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED=<em class="replaceable"><code>value</code></em>
WHERE NAME = 'wait/synch/mutex/pfs/LOCK_pfs_share_list';
</pre><p>
              この mutex は永続的であり、更新の実行前にすでに作成されています。 mutex が再度作成されることはないため、<code class="literal">setup_instruments</code> の <code class="literal">ENABLED</code> 値は使用されません。 この mutex を有効または無効にするには、かわりに <code class="literal">mutex_instances</code> テーブルを使用します。 
            </p></li><li class="listitem"><p>
              <code class="literal">DOCUMENTATION</code>
            </p><p>
              インストゥルメントの目的を説明する文字列。 説明がない場合、値は <code class="literal">NULL</code> です。 
            </p></li></ul></div><p>
          <code class="literal">setup_instruments</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">setup_instruments</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-objects-table"></a>27.12.2.4 setup_objects テーブル</h4></div></div></div><a class="indexterm" name="idm45882611524480"></a><a class="indexterm" name="idm45882611522336"></a><p>
          <code class="literal">setup_objects</code> テーブルは、パフォーマンススキーマが特定のオブジェクトをモニターするかどうかを制御します。 このテーブルはデフォルトで 100 行の最大サイズになります。 テーブルサイズを変更するには、サーバー起動時に <code class="literal">performance_schema_setup_objects_size</code> システム変数を変更します。 
        </p><p>
          初期 <code class="literal">setup_objects</code> の内容は次のように見えます。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| EVENT       | mysql              | %           | NO      | NO    |
| EVENT       | performance_schema | %           | NO      | NO    |
| EVENT       | information_schema | %           | NO      | NO    |
| EVENT       | %                  | %           | YES     | YES   |
| FUNCTION    | mysql              | %           | NO      | NO    |
| FUNCTION    | performance_schema | %           | NO      | NO    |
| FUNCTION    | information_schema | %           | NO      | NO    |
| FUNCTION    | %                  | %           | YES     | YES   |
| PROCEDURE   | mysql              | %           | NO      | NO    |
| PROCEDURE   | performance_schema | %           | NO      | NO    |
| PROCEDURE   | information_schema | %           | NO      | NO    |
| PROCEDURE   | %                  | %           | YES     | YES   |
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
| TRIGGER     | mysql              | %           | NO      | NO    |
| TRIGGER     | performance_schema | %           | NO      | NO    |
| TRIGGER     | information_schema | %           | NO      | NO    |
| TRIGGER     | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
          <code class="literal">setup_objects</code> テーブルへの変更はただちにオブジェクトモニタリングに影響します。
        </p><p>
          <code class="literal">setup_objects</code> に示されているオブジェクトの種類では、パフォーマンススキーマはそれらのモニター方法にテーブルを使用します。 オブジェクトの一致は <code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code> カラムに基づきます。 一致のないオブジェクトはモニターされません。 
        </p><p>
          デフォルトのオブジェクト構成の効果は、<code class="literal">mysql</code>、<code class="literal">INFORMATION_SCHEMA</code>、および <code class="literal">performance_schema</code> データベースのテーブルを除くすべてのテーブルをインストゥルメントすることです。 (<code class="literal">INFORMATION_SCHEMA</code> データベース内のテーブルは、<code class="literal">setup_objects</code> の内容に関係なくインストゥルメントされず、<code class="literal">information_schema.%</code> の行は単にこのデフォルトを明示します。) 
        </p><p>
          パフォーマンススキーマは、<code class="literal">setup_objects</code> の一致をチェックする場合、まずより詳細な一致を見つけようとします。 たとえば、テーブル <code class="literal">db1.t1</code> では、<code class="literal">'db1'</code> と <code class="literal">'t1'</code>、次に <code class="literal">'db1'</code> と <code class="literal">'%'</code>、次に <code class="literal">'%'</code> と <code class="literal">'%'</code> の一致を検索します。 さまざまな一致する <code class="literal">setup_objects</code> 行はさまざまな <code class="literal">ENABLED</code> 値と <code class="literal">TIMED</code> 値を持つ可能性があるため、一致が発生する順序が重要です。 
        </p><p>
          テーブルへの <code class="literal">INSERT</code> または <code class="literal">DELETE</code> 権限を持つユーザーが、<code class="literal">setup_objects</code> に行を挿入したり、削除したりできます。 既存の行では、テーブルへの <code class="literal">UPDATE</code> 権限を持つユーザーによって、<code class="literal">ENABLED</code> および <code class="literal">TIMED</code> カラムのみを変更できます。 
        </p><p>
          イベントフィルタリングにおける <code class="literal">setup_objects</code> テーブルの役割の詳細については、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_objects</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              インストゥルメントするオブジェクトの種類。 値は、<code class="literal">'EVENT'</code> (イベントスケジューライベント)、<code class="literal">'FUNCTION'</code> (ストアドファンクション)、<code class="literal">'PROCEDURE'</code> (ストアドプロシージャ)、<code class="literal">'TABLE'</code> (実テーブル) または<code class="literal">'TRIGGER'</code> (トリガー) のいずれかです。 
            </p><p>
              <code class="literal">TABLE</code> フィルタリングはテーブル I/O イベント (<code class="literal">wait/io/table/sql/handler</code> インストゥルメント) およびテーブルロックイベント (<code class="literal">wait/lock/table/sql/handler</code> インストゥルメント) に影響します。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              オブジェクトを格納するスキーマ。 これはリテラル名、または<span class="quote">「<span class="quote">任意のスキーマ</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              インストゥルメントされたオブジェクトの名前。 これはリテラル名、または<span class="quote">「<span class="quote">任意のオブジェクト</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。 
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              オブジェクトのイベントがインストゥルメントされるかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 このカラムは変更できます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              オブジェクトのイベントの時間が測定されるかどうか。 このカラムは変更できます。 
            </p></li></ul></div><p>
          <code class="literal">setup_objects</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">setup_objects</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-threads-table"></a>27.12.2.5 setup_threads テーブル</h4></div></div></div><a class="indexterm" name="idm45882611451776"></a><a class="indexterm" name="idm45882611449632"></a><p>
          <code class="literal">setup_threads</code> テーブルには、インストゥルメントスレッドクラスがリストされます。 スレッドクラス名と属性を公開します: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_threads\G</code></strong>
*************************** 1. row ***************************
         NAME: thread/performance_schema/setup
      ENABLED: YES
      HISTORY: YES
   PROPERTIES: singleton
   VOLATILITY: 0
DOCUMENTATION: NULL
...
*************************** 4. row ***************************
         NAME: thread/sql/main
      ENABLED: YES
      HISTORY: YES
   PROPERTIES: singleton
   VOLATILITY: 0
DOCUMENTATION: NULL
*************************** 5. row ***************************
         NAME: thread/sql/one_connection
      ENABLED: YES
      HISTORY: YES
   PROPERTIES: user
   VOLATILITY: 0
DOCUMENTATION: NULL
...
*************************** 10. row ***************************
         NAME: thread/sql/event_scheduler
      ENABLED: YES
      HISTORY: YES
   PROPERTIES: singleton
   VOLATILITY: 0
DOCUMENTATION: NULL
</pre><p>
          <code class="literal">setup_threads</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              インストゥルメント名。 スレッドインストゥルメントは、<code class="literal">thread</code> (<code class="literal">thread/sql/parser_service</code> や <code class="literal">thread/performance_schema/setup</code> など) で始まります。 
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              インストゥルメントが有効にされているかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 このカラムは変更できますが、<code class="literal">ENABLED</code> を設定しても、すでに実行中のスレッドには影響しません。 
            </p><p>
              バックグラウンドスレッドの場合、<code class="literal">ENABLED</code> 値を設定すると、このインストゥルメント用に後で作成され、<code class="literal">threads</code> テーブルにリストされるスレッドに対して、<code class="literal">INSTRUMENTED</code> が <code class="literal">YES</code> または <code class="literal">NO</code> に設定されるかどうかが制御されます。 フォアグラウンドスレッドの場合、このカラムは効果がなく、<code class="literal">setup_actors</code> テーブルが優先されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">HISTORY</code>
            </p><p>
              インストゥルメントの履歴イベントをログに記録するかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 このカラムは変更できますが、<code class="literal">HISTORY</code> を設定しても、すでに実行中のスレッドには影響しません。 
            </p><p>
              バックグラウンドスレッドの場合、<code class="literal">HISTORY</code> 値を設定すると、このインストゥルメント用に後で作成され、<code class="literal">threads</code> テーブルにリストされるスレッドに対して、<code class="literal">HISTORY</code> が <code class="literal">YES</code> または <code class="literal">NO</code> に設定されるかどうかが制御されます。 フォアグラウンドスレッドの場合、このカラムは効果がなく、<code class="literal">setup_actors</code> テーブルが優先されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROPERTIES</code>
            </p><p>
              インストゥルメントプロパティ。 このカラムは <code class="literal">SET</code> データ型を使用するため、インストゥルメントごとに次のリストの複数のフラグを設定できます: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">singleton</code>: インストゥルメントには単一のインスタンスがあります。 たとえば、<code class="literal">thread/sql/main</code> インストゥルメントのスレッドは 1 つのみです。 
                </p></li><li class="listitem"><p>
                  <code class="literal">user</code>: インストゥルメントは、(システムワークロードではなく) ユーザーワークロードに直接関連しています。 たとえば、ユーザーセッションを実行する <code class="literal">thread/sql/one_connection</code> などのスレッドには、システムスレッドと区別するための <code class="literal">user</code> プロパティがあります。 
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">VOLATILITY</code>
            </p><p>
              インストゥルメントのボラティリティ。 このカラムは、<code class="literal">setup_instruments</code> テーブルと同じ意味を持ちます。 <a class="xref" href="performance-schema.html#performance-schema-setup-instruments-table" title="27.12.2.3 setup_instruments テーブル">セクション27.12.2.3「setup_instruments テーブル」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">DOCUMENTATION</code>
            </p><p>
              インストゥルメントの目的を説明する文字列。 説明がない場合、値は <code class="literal">NULL</code> です。 
            </p></li></ul></div><p>
          <code class="literal">setup_threads</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">setup_threads</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-setup-timers-table"></a>27.12.2.6 setup_timers テーブル</h4></div></div></div><p>
          このテーブルは、MySQL 8.0.4 で削除されました。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-instance-tables"></a>27.12.3 パフォーマンススキーマインスタンステーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-cond-instances-table">27.12.3.1 cond_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-file-instances-table">27.12.3.2 file_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-mutex-instances-table">27.12.3.3 mutex_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-rwlock-instances-table">27.12.3.4 rwlock_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-socket-instances-table">27.12.3.5 socket_instances テーブル</a></span></dt></dl></div><p>
        インスタンステーブルは、インストゥルメントされたオブジェクトの種類を記述します。 それらは、イベント名と説明のメモまたはステータス情報を提供します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">cond_instances</code>: 条件同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">file_instances</code>: ファイルインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">mutex_instances</code>: 相互排他ロック同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">rwlock_instances</code>: ロック同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">socket_instances</code>: アクティブな接続インスタンス
          </p></li></ul></div><p>
        これらのテーブルはインストゥルメントされた同期オブジェクト、ファイル、および接続を一覧表示します。 3 種類の同期オブジェクト <code class="literal">cond</code>、<code class="literal">mutex</code>、および <code class="literal">rwlock</code> があります。 各インスタンステーブルには、各行に関連付けられているインストゥルメントを示す <code class="literal">EVENT_NAME</code> または <code class="literal">NAME</code> カラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
      </p><p>
        <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> および <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code> カラムは、パフォーマンスボトルネックまたはデッドロックの調査にきわめて重要です。 この目的でそれらを使用する方法の例については、<a class="xref" href="performance-schema.html#performance-schema-examples" title="27.19 問題を診断するためのパフォーマンススキーマの使用">セクション27.19「問題を診断するためのパフォーマンススキーマの使用」</a>を参照してください 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-cond-instances-table"></a>27.12.3.1 cond_instances テーブル</h4></div></div></div><a class="indexterm" name="idm45882611371808"></a><a class="indexterm" name="idm45882611369664"></a><p>
          <code class="literal">cond_instances</code> テーブルは、サーバーの実行中にパフォーマンススキーマによって確認されるすべての条件を一覧表示します。 条件は、この条件を待機しているスレッドが作業を再開できるように、特定のイベントが発生したことを伝えるために、コードで使用される同期メカニズムです。 
        </p><p>
          スレッドが何かの発生を待機している場合、条件名はスレッドが何を待機しているかを示しますが、ほかのどのスレッド (スレッド) が原因であるかをすぐに通知する方法はありません。
        </p><p>
          <code class="literal">cond_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              条件に関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされた条件のメモリー内のアドレス。
            </p></li></ul></div><p>
          <code class="literal">cond_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">NAME</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">cond_instances</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-file-instances-table"></a>27.12.3.2 file_instances テーブル</h4></div></div></div><a class="indexterm" name="idm45882611350096"></a><a class="indexterm" name="idm45882611347952"></a><p>
          <code class="literal">file_instances</code> テーブルは、ファイル I/O インストゥルメンテーションの実行中にパフォーマンススキーマによって確認されるすべてのファイルを一覧表示します。 ディスク上のファイルが開かれていない場合、<code class="literal">file_instances</code> には表示されません。 ファイルがディスクから削除されると、<code class="literal">file_instances</code> テーブルからも削除されます。 
        </p><p>
          <code class="literal">file_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FILE_NAME</code>
            </p><p>
              ファイル名。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              ファイルに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OPEN_COUNT</code>
            </p><p>
              ファイルへのオープンハンドルのカウント。 ファイルを開いてから閉じた場合、そのファイルは 1 回開かれていますが、<code class="literal">OPEN_COUNT</code> は 0 です。 サーバーによって現在開かれているすべてのファイルを一覧表示するには、<code class="literal">WHERE OPEN_COUNT &gt; 0</code> を使用します。 
            </p></li></ul></div><p>
          <code class="literal">file_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">FILE_NAME</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">EVENT_NAME</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">file_instances</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-mutex-instances-table"></a>27.12.3.3 mutex_instances テーブル</h4></div></div></div><a class="indexterm" name="idm45882611323248"></a><a class="indexterm" name="idm45882611321040"></a><p>
          <code class="literal">mutex_instances</code> テーブルは、サーバーの実行中にパフォーマンススキーマによって確認されるすべての相互排他ロックを一覧表示します。 相互排他ロックは、特定の時間に 1 つだけのスレッドが特定の共通リソースにアクセスできるようにする、コードで使用される同期メカニズムです。 リソースは相互排他ロックによって<span class="quote">「<span class="quote">保護されている</span>」</span>と呼ばれます。 
        </p><p>
          サーバーで実行されている 2 つのスレッド (たとえば、クエリーを同時に実行する 2 つのユーザーセッション) が同じリソース (ファイル、バッファまたは一部のデータ) にアクセスする必要がある場合、これらの 2 つのスレッドは互いに競合するため、mutex でロックを取得する最初のクエリーによって、最初のクエリーが完了するまで待機し、mutex のロックを解除します。
        </p><p>
          相互排他ロックの保持中に実行される作業は<span class="quote">「<span class="quote">クリティカルセクション</span>」</span>にあると呼ばれ、複数のクエリーがこのクリティカルセクションを連続して (一度に 1 つずつ) 実行するため、これは潜在的なボトルネックになります。
        </p><p>
          <code class="literal">mutex_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              相互排他ロックに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされた相互排他ロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCKED_BY_THREAD_ID</code>
            </p><p>
              スレッドが現在相互排他ロックされている場合、<code class="literal">LOCKED_BY_THREAD_ID</code> はロックしているスレッドの <code class="literal">THREAD_ID</code> になり、そうでない場合、それは <code class="literal">NULL</code> になります。
            </p></li></ul></div><p>
          <code class="literal">mutex_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">LOCKED_BY_THREAD_ID</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">mutex_instances</code> テーブルに対して許可されていません。
        </p><p>
          コードにインストゥルメントされた各相互排他ロックについて、パフォーマンススキーマは次の情報を提供します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">setup_instruments</code> テーブルは、プリフィクス <code class="literal">wait/synch/mutex/</code> を付けて、インストゥルメンテーションポイントの名前を一覧表示します。
            </p></li><li class="listitem"><p>
              一部のコードで相互排他ロックが作成されると、行が <code class="literal">mutex_instances</code> テーブルに追加されます。 <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムは相互排他ロックを一意に識別するプロパティーです。 
            </p></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックを試みた場合、<code class="literal">events_waits_current</code> テーブルにそのスレッドの行が表示され、それが相互排他ロックを待機していることが示され (<code class="literal">EVENT_NAME</code> カラム内)、待機されている相互排他ロックが示されます (<code class="literal">OBJECT_INSTANCE_BEGIN</code> カラム内)。
            </p></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックに成功した場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">events_waits_current</code> は相互排他ロックへの待機が完了したことを示します (<code class="literal">TIMER_END</code> および <code class="literal">TIMER_WAIT</code> カラム内)
                </p></li><li class="listitem"><p>
                  完了した待機イベントは <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルに追加されます。
                </p></li><li class="listitem"><p>
                  <code class="literal">mutex_instances</code> は相互排他ロックがスレッドによって所有されるようになったことを示します (<code class="literal">THREAD_ID</code> カラム内)。
                </p></li></ul></div></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックを解除すると、<code class="literal">mutex_instances</code> は相互排他ロックに所有者がいなくなったことを示します (<code class="literal">THREAD_ID</code> カラムが <code class="literal">NULL</code> になります)。
            </p></li><li class="listitem"><p>
              相互排他ロックオブジェクトが破棄されると、対応する行が <code class="literal">mutex_instances</code> から削除されます。
            </p></li></ul></div><p>
          次の両方のテーブルに対してクエリーを実行することによって、モニタリングアプリケーションまたは DBA は相互排他ロックを伴うスレッド間のボトルネックやデッドロックを検出できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_current</code>、スレッドが待機している相互排他ロックを確認する場合
            </p></li><li class="listitem"><p>
              <code class="literal">mutex_instances</code>、相互排他ロックを現在所有しているほかのスレッドを確認する場合
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-rwlock-instances-table"></a>27.12.3.4 rwlock_instances テーブル</h4></div></div></div><a class="indexterm" name="idm45882611262272"></a><a class="indexterm" name="idm45882611260064"></a><p>
          <code class="literal">rwlock_instances</code> テーブルには、サーバーの実行中にパフォーマンススキーマによって認識されるすべての <a class="link" href="glossary.html#glos_rw_lock" title="rw ロック (読み書きロック)">rwlock</a> (読み取り/書き込みロック) インスタンスが一覧表示されます。 <code class="literal">rwlock</code> は、特定の時間にそのスレッドが、次の特定のルールに従って、一部の共通リソースにアクセスできるようにするために、コードで使用される同期メカニズムです。 リソースは <code class="literal">rwlock</code> によって<span class="quote">「<span class="quote">保護されている</span>」</span>と呼ばれます。 アクセスは、共有 (多くのスレッドが同時に読取りロックを持つことができます)、排他 (特定の時間に書込みロックを持つことができるのは 1 つのスレッドのみ) または共有排他 (スレッドは他のスレッドによる一貫性のない読取りを許可しながら書込みロックを持つことができます) のいずれかです。 共有排他アクセスは、<code class="literal">sxlock</code> とも呼ばれ、同時実行性を最適化し、読取り/書込みワークロードのスケーラビリティを向上させます。 
        </p><p>
          ロックをリクエストしているスレッドの数およびリクエストされたロックの性質に応じて、他のスレッドが最初に終了するまで待機して、共有モード、排他モードまたは共有排他モードでアクセス権を付与することも、まったく付与しないこともできます。
        </p><p>
          <code class="literal">rwlock_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              ロックに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされたロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">WRITE_LOCKED_BY_THREAD_ID</code>
            </p><p>
              スレッドが現在排他 (書き込み) モードでロックされた <code class="literal">rwlock</code> を持つ場合、<code class="literal">WRITE_LOCKED_BY_THREAD_ID</code> はロックしているスレッドの <code class="literal">THREAD_ID</code> になり、そうでない場合、それは <code class="literal">NULL</code> になります。
            </p></li><li class="listitem"><p>
              <code class="literal">READ_LOCKED_BY_COUNT</code>
            </p><p>
              スレッドが現在共有 (読み取り) モードでロックされた <code class="literal">rwlock</code> を持つ場合、<code class="literal">READ_LOCKED_BY_COUNT</code> が 1 増分されます。 これはカウンタのみであるため、読み取りロックを保持するスレッドを見つけるためにそれを直接使用することはできませんが、<code class="literal">rwlock</code> に対して読み取りの競合があるかどうかを確認し、現在アクティブなリーダー数を確認するために使用することができます。 
            </p></li></ul></div><p>
          <code class="literal">rwlock_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">WRITE_LOCKED_BY_THREAD_ID</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">rwlock_instances</code> テーブルに対して許可されていません。
        </p><p>
          次の両方のテーブルに対してクエリーを実行することによって、モニタリングアプリケーションまたは DBA はロックを伴うスレッド間の何らかのボトルネックやデッドロックを検出できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_current</code>、スレッドが待機している <code class="literal">rwlock</code> を確認する場合
            </p></li><li class="listitem"><p>
              <code class="literal">rwlock_instances</code>、<code class="literal">rwlock</code> を現在所有しているほかのスレッドを確認する場合
            </p></li></ul></div><p>
          制限があります。<code class="literal">rwlock_instances</code> は、書き込みロックを保持しているスレッドの識別にのみ使用できますが、読み取りロックを保持しているスレッドの識別には使用できません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-socket-instances-table"></a>27.12.3.5 socket_instances テーブル</h4></div></div></div><a class="indexterm" name="idm45882611215488"></a><a class="indexterm" name="idm45882611213280"></a><a class="indexterm" name="idm45882611211296"></a><a class="indexterm" name="idm45882611209952"></a><p>
          <code class="literal">socket_instances</code> テーブルは MySQL サーバーへのアクティブな接続のリアルタイムスナップショットを提供します。 テーブルには、TCP/IP または Unix ソケットファイル接続ごとに 1 行含まれます。 このテーブルで使用可能な情報は、サーバーへのアクティブな接続のリアルタイムスナップショットを提供します。 (ソケット操作や送受信されたバイト数などのネットワークアクティビティーを含む、追加の情報はソケットサマリーテーブルで入手できます。<a class="xref" href="performance-schema.html#performance-schema-socket-summary-tables" title="27.12.18.9 ソケットサマリーテーブル">セクション27.12.18.9「ソケットサマリーテーブル」</a>を参照してください)。 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.socket_instances\G</code></strong>
*************************** 1. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_unix_socket
OBJECT_INSTANCE_BEGIN: 4316619408
            THREAD_ID: 1
            SOCKET_ID: 16
                   IP:
                 PORT: 0
                STATE: ACTIVE
*************************** 2. row ***************************
           EVENT_NAME: wait/io/socket/sql/client_connection
OBJECT_INSTANCE_BEGIN: 4316644608
            THREAD_ID: 21
            SOCKET_ID: 39
                   IP: 127.0.0.1
                 PORT: 55233
                STATE: ACTIVE
*************************** 3. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_tcpip_socket
OBJECT_INSTANCE_BEGIN: 4316699040
            THREAD_ID: 1
            SOCKET_ID: 14
                   IP: 0.0.0.0
                 PORT: 50603
                STATE: ACTIVE
</pre><p>
          ソケットインストゥルメントは形式 <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code> の名前を持ち、次のように使用されます。
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              サーバーには、それがサポートする各ネットワークプロトコルの待機ソケットがあります。 TCP/IP または Unix ソケットファイル接続の待機ソケットに関連付けられているインストゥルメントは、それぞれ <code class="literal">server_tcpip_socket</code> または <code class="literal">server_unix_socket</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。 
            </p></li><li class="listitem"><p>
              待機ソケットが接続を検出すると、サーバーは接続を、個別のスレッドによって管理される新しいソケットに転送します。 新しい接続スレッドのインストゥルメントは、<code class="literal">client_connection</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。 
            </p></li><li class="listitem"><p>
              接続が終了すると、<code class="literal">socket_instances</code> 内のそれに対応する行が削除されます。
            </p></li></ol></div><p>
          <code class="literal">socket_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成した <code class="literal">wait/io/socket/*</code> インストゥルメントの名前。 これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              このカラムは一意にソケットを識別します。 この値はメモリー内のオブジェクトのアドレスです。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              サーバーによって割り当てられた内部スレッド識別子。 各ソケットは単一のスレッドによって管理されるため、各ソケットはスレッドにマップでき、スレッドはサーバープロセスにマップできます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOCKET_ID</code>
            </p><p>
              ソケットに割り当てられている内部ファイルハンドル。
            </p></li><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              クライアントの IP アドレス。 この値は IPv4 または IPv6 アドレスのいずれか、または Unix ソケットファイル接続を示すブランクになります。 
            </p></li><li class="listitem"><p>
              <code class="literal">PORT</code>
            </p><p>
              0 から 65535 の範囲の TCP/IP ポート番号。
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              <code class="literal">IDLE</code> または <code class="literal">ACTIVE</code> のいずれかのソケットステータス。 アクティブなソケットの待機時間は、対応するソケットインストゥルメントを使用して追跡されます。 アイドルソケットの待機時間は、<code class="literal">idle</code> インストゥルメントを使用して追跡されます。 
            </p><p>
              ソケットはクライアントからのリクエストを待機している場合、アイドルになります。 ソケットがアイドルになると、ソケットを追跡している <code class="literal">socket_instances</code> 内のイベント行が <code class="literal">ACTIVE</code> のステータスから <code class="literal">IDLE</code> に切り替わります。 <code class="literal">EVENT_NAME</code> 値は <code class="literal">wait/io/socket/*</code> のままになりますが、インストゥルメントのタイミングは一時停止されます。 代わりに、<code class="literal">idle</code> の <code class="literal">EVENT_NAME</code> 値で <code class="literal">events_waits_current</code> テーブルにイベントが生成されます。 
            </p><p>
              次のリクエストを受信すると、<code class="literal">idle</code> イベントが終了し、ソケットインスタンスが <code class="literal">IDLE</code> から <code class="literal">ACTIVE</code> に切り替わり、ソケットインストゥルメントのタイミングが再開します。
            </p></li></ul></div><p>
          <code class="literal">socket_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">SOCKET_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">IP</code>、<code class="literal">PORT</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">socket_instances</code> テーブルに対して許可されていません。
        </p><p>
          <code class="literal">IP:PORT</code> カラムの組み合わせの値は接続を識別します。 この組み合わせの値は、ソケットイベントの発生元の接続を識別するために、<code class="literal">events_waits_<em class="replaceable"><code>xxx</code></em></code> テーブルの <code class="literal">OBJECT_NAME</code> カラムで使用されます。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Unix ドメインリスナーソケット (<code class="literal">server_unix_socket</code>) の場合、ポートは 0 で IP は <code class="literal">''</code> です。
            </p></li><li class="listitem"><p>
              Unix ドメインリスナー経由のクライアント接続 (<code class="literal">client_connection</code>) の場合、ポートは 0 で IP は <code class="literal">''</code> です。
            </p></li><li class="listitem"><p>
              TCP/IP サーバーリスナーソケット (<code class="literal">server_tcpip_socket</code>) の場合、ポートは常にマスターポート (たとえば 3306) で、IP は常に <code class="literal">0.0.0.0</code> です。
            </p></li><li class="listitem"><p>
              TCP/IP リスナー経由のクライアント接続 (<code class="literal">client_connection</code>) の場合、ポートはサーバーが割り当てたものになりますが、0 にはなりません。 IP は発信元ホストの IP (ローカルホストの場合 <code class="literal">127.0.0.1</code> または <code class="literal">::1</code>) です 
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-wait-tables"></a>27.12.4 パフォーマンススキーマ待機イベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-events-waits-current-table">27.12.4.1 events_waits_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-waits-history-table">27.12.4.2 events_waits_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-waits-history-long-table">27.12.4.3 events_waits_history_long テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマインストゥルメントは待機します。これは時間がかかるイベントです。 イベント階層内では、待機イベントはステージイベント内にネストされ、ステージイベントはステートメントイベント内にネストされ、ステートメントイベントはトランザクションイベント内にネストされます。 
      </p><p>
        これらのテーブルは待機イベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_current</code>: 各スレッドの現在の待機イベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_history</code>: スレッドごとに終了した最新の待機イベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_history_long</code>: グローバルに (すべてのスレッドで) 終了した最新の待機イベント。
          </p></li></ul></div><p>
        次の各セクションでは、待機イベントテーブルについて説明します。 待機イベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a>を参照してください。 
      </p><p>
        3 つの待機イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
      </p><h4><a name="wait-event-configuration"></a>待機イベント収集の構成</h4><p>
        待機イベントを収集するかどうかを制御するには、関連するインストゥルメントおよびコンシューマの状態を設定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブルには、<code class="literal">wait</code> で始まる名前を持つインストゥルメントが格納されます。 これらのインストゥルメントを使用して、個々の待機イベントクラスの収集を有効または無効にします。 
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブルには、現在の待機イベントテーブル名と履歴待機イベントテーブル名に対応する名前のコンシューマ値が含まれます。 これらのコンシューマを使用して、待機イベントのコレクションをフィルタします。 
          </p></li></ul></div><p>
        待機インストゥルメントの中には、デフォルトで有効になっているものと無効になっているものがあります。 例: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/file/innodb%';</code></strong>
+-------------------------------------------------+---------+-------+
| NAME                                            | ENABLED | TIMED |
+-------------------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_tablespace_open_file | YES     | YES   |
| wait/io/file/innodb/innodb_data_file            | YES     | YES   |
| wait/io/file/innodb/innodb_log_file             | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file            | YES     | YES   |
| wait/io/file/innodb/innodb_arch_file            | YES     | YES   |
| wait/io/file/innodb/innodb_clone_file           | YES     | YES   |
+-------------------------------------------------+---------+-------+
mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/socket/%';</code></strong>
+----------------------------------------+---------+-------+
| NAME                                   | ENABLED | TIMED |
+----------------------------------------+---------+-------+
| wait/io/socket/sql/server_tcpip_socket | NO      | NO    |
| wait/io/socket/sql/server_unix_socket  | NO      | NO    |
| wait/io/socket/sql/client_connection   | NO      | NO    |
+----------------------------------------+---------+-------+
</pre><p>
        待機コンシューマはデフォルトで無効にされています。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'events_waits%';</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| events_waits_current      | NO      |
| events_waits_history      | NO      |
| events_waits_history_long | NO      |
+---------------------------+---------+
</pre><p>
        サーバー起動時の待機イベント収集を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/%=ON'
performance-schema-consumer-events-waits-current=ON
performance-schema-consumer-events-waits-history=ON
performance-schema-consumer-events-waits-history-long=ON
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/%=OFF'
performance-schema-consumer-events-waits-current=OFF
performance-schema-consumer-events-waits-history=OFF
performance-schema-consumer-events-waits-history-long=OFF
</pre></li></ul></div><p>
        実行時の待機イベント収集を制御するには、<code class="literal">setup_instruments</code> テーブルと <code class="literal">setup_consumers</code> テーブルを更新します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME LIKE 'wait/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'YES'
WHERE NAME LIKE 'events_waits%';
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME LIKE 'wait/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE 'events_waits%';
</pre></li></ul></div><p>
        特定の待機イベントのみを収集するには、対応する待機インストゥルメントのみを有効にします。 特定の待機イベントテーブルについてのみ待機イベントを収集するには、待機インストゥルメントを有効にし、目的のテーブルに対応する待機コンシューマのみを有効にします。 
      </p><p>
        イベント収集の構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a> および <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a> を参照してください。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-waits-current-table"></a>27.12.4.1 events_waits_current テーブル</h4></div></div></div><a class="indexterm" name="idm45882611085696"></a><a class="indexterm" name="idm45882611083488"></a><p>
          <code class="literal">events_waits_current</code> テーブルには、現在の待機イベントが含まれます。 テーブルには、スレッドごとに最新の監視対象待機イベントの現在のステータスを示す 1 行が格納されるため、テーブルサイズを構成するためのシステム変数はありません。 
        </p><p>
          待機イベント行を格納するテーブルのうち、<code class="literal">events_waits_current</code> はもっとも基本的です。 待機イベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。 たとえば、<code class="literal">events_waits_history</code> テーブルと <code class="literal">events_waits_history_long</code> テーブルは、終了した最新の待機イベントのコレクションで、スレッド当たりの最大行数まで、およびすべてのスレッドにわたってグローバルに終了します。 
        </p><p>
          3 つの待機イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          待機イベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="27.12.4 パフォーマンススキーマ待機イベントテーブル">セクション27.12.4「パフォーマンススキーマ待機イベントテーブル」</a> を参照してください。
        </p><p>
          <code class="literal">events_waits_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。 ともに取得される <code class="literal">THREAD_ID</code> と <code class="literal">EVENT_ID</code> の値によって、行が一意に識別されます。 同じ値のペアを持つ行は 2 つありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成したインストゥルメントの名前。 これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。 これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。 たとえば、相互排他ロックまたはロックがブロックされた場合、これが発生するコンテキストをチェックできます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。 これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。 <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。 <code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。 
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> は現在のタイマー値で、<code class="literal">TIMER_WAIT</code> はこれまでに経過した時間です (<code class="literal">TIMER_END</code> - <code class="literal">TIMER_START</code>)。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">SPINS</code>
            </p><p>
              相互排他ロックの場合、スピンラウンドの数。 値が <code class="literal">NULL</code> の場合、コードはスピンラウンドを使用しないか、スピニングがインストゥルメントされません。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              これらのカラムは<span class="quote">「<span class="quote">作用している</span>」</span>オブジェクトを識別します。 その意味は、オブジェクトの種類によって異なります。 
            </p><p>
              同期オブジェクト (<code class="literal">cond</code>、<code class="literal">mutex</code>、および <code class="literal">rwlock</code>) の場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、および <code class="literal">OBJECT_TYPE</code> は <code class="literal">NULL</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内の同期オブジェクトのアドレスです。
                </p></li></ul></div><p>
              ファイル I/O オブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> は <code class="literal">NULL</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はファイル名です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> は <code class="literal">FILE</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              ソケットオブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はソケットの <code class="literal">IP:PORT</code> 値です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              テーブル I/O オブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> はテーブルを格納するスキーマの名前です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はテーブル名です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> は永続的ベーステーブルの <code class="literal">TABLE</code> または一時テーブルの <code class="literal">TEMPORARY TABLE</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> 値自体には、さまざまな値がさまざまなオブジェクトを示すことを除いて、意味がありません。 <code class="literal">OBJECT_INSTANCE_BEGIN</code> はデバッグに使用できます。 たとえば、それを <code class="literal">GROUP BY OBJECT_INSTANCE_BEGIN</code> で使用して、1,000 相互排他ロック (つまり、データの 1,000 ページまたはブロックを保護する) の負荷が均等に広がっているか、または少数のボトルネックだけに関わっているかを確認できます。 これにより、ログファイルやほかのデバッグまたはパフォーマンスツールで同じオブジェクトアドレスが見られた場合に、情報のほかのソースと関連付けることができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">INDEX_NAME</code>
            </p><p>
              使用されるインデックスの名前。 <code class="literal">PRIMARY</code> はテーブルプライマリインデックスを示します。 <code class="literal">NULL</code> はインデックスが使用されなかったことを意味します。 
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              このイベントが中にネストされているイベントの <code class="literal">EVENT_ID</code> 値。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              ネストしているイベントの種類。 値は <code class="literal">TRANSACTION</code>, <code class="literal">STATEMENT</code>, <code class="literal">STAGE</code> または <code class="literal">WAIT</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">OPERATION</code>
            </p><p>
              <code class="literal">lock</code>、<code class="literal">read</code>、または <code class="literal">write</code> などの実行される操作の種類。
            </p></li><li class="listitem"><p>
              <code class="literal">NUMBER_OF_BYTES</code>
            </p><p>
              操作によって読み取りまたは書き込まれるバイト数。 テーブル I/O 待機 (<code class="literal">wait/io/table/sql/handler</code> インストゥルメントのイベント) の場合、<code class="literal">NUMBER_OF_BYTES</code> は行数を示します。 値が 1 より大きい場合、イベントはバッチ I/O 操作用です。 次の説明では、単一行レポートとバッチ I/O を反映するレポートの違いについて説明します。 
            </p><p>
              MySQL は、ネステッドループ実装を使用して結合を実行します。 パフォーマンススキーマインストゥルメンテーションのジョブは、結合内のテーブルごとに行数と累積実行時間を提供することです。 <code class="literal">t1</code>, <code class="literal">t2</code>, <code class="literal">t3</code> のテーブル結合順序を使用して実行される次の形式の結合クエリーを想定します: 
            </p><pre class="programlisting">SELECT ... FROM t1 JOIN t2 ON ... JOIN t3 ON ...
</pre><p>
              テーブル<span class="quote">「<span class="quote">「ファンアウト」</span>」</span>は、結合処理中にテーブルを追加する行数の増減です。 テーブル <code class="literal">t3</code> のファンアウトが 1 より大きい場合、行フェッチ操作の大部分はそのテーブルに対するものです。 結合が <code class="literal">t1</code> から 10 行、<code class="literal">t1</code> から <code class="literal">t2</code> から 20 行、テーブル <code class="literal">t2</code> の行ごとに <code class="literal">t3</code> から 30 行にアクセスするとします。 単一行レポートでは、インストゥルメントされた操作の合計数は次のとおりです: 
            </p><pre class="programlisting">10 + (10 * 20) + (10 * 20 * 30) = 6210
</pre><p>
              インスツルメント処理される操作の数は、スキャンごと (つまり、<code class="literal">t1</code> と <code class="literal">t2</code> の行の一意の組合せごと) に集計することで大幅に削減できます。 バッチ I/O レポートでは、パフォーマンススキーマは各行ではなくもっとも内側のテーブル <code class="literal">t3</code> のスキャンごとにイベントを生成し、計測される行操作の数は次のように減少します: 
            </p><pre class="programlisting">10 + (10 * 20) + (10 * 20) = 410
</pre><p>
              これは 93% の削減であり、レポートコールの数を減らすことで、バッチレポート戦略によってテーブル I/O のパフォーマンススキーマのオーバーヘッドが大幅に削減される方法を示しています。 トレードオフは、イベントタイミングの精度が低くなります。 バッチ I/O のタイミングには、行ごとのレポートのように個々の行操作の時間ではなく、結合バッファリング、集計、クライアントへの行の戻しなどの操作に費やされる時間が含まれます。 
            </p><p>
              バッチ I/O レポートを実行するには、次の条件が満たされている必要があります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  クエリー実行は、クエリーブロックの最も内側のテーブルにアクセスします (単一テーブルクエリーの場合、そのテーブルは最も内側としてカウントされます)
                </p></li><li class="listitem"><p>
                  クエリーの実行では、テーブルの単一行は要求されません (たとえば、<code class="literal">eq_ref</code> アクセスではバッチレポートを使用できません)
                </p></li><li class="listitem"><p>
                  クエリーの実行では、テーブルに対するテーブルアクセスを含むサブクエリーは評価されません
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">FLAGS</code>
            </p><p>
              将来使用するために予約されています。
            </p></li></ul></div><p>
          <code class="literal">events_waits_current</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_waits_current</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-waits-history-table"></a>27.12.4.2 events_waits_history テーブル</h4></div></div></div><a class="indexterm" name="idm45882610947760"></a><a class="indexterm" name="idm45882610945552"></a><p>
          <code class="literal">events_waits_history</code> テーブルには、スレッドごとに終了した <em class="replaceable"><code>N</code></em> の最新の待機イベントが含まれます。 待機イベントはそれらが終了するまでテーブルに追加されません。 テーブルに特定のスレッドの最大行数が含まれている場合、そのスレッドの新しい行が追加されると、最も古いスレッド行は破棄されます。 スレッドが終了すると、そのすべての行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 スレッドごとの行数を明示的に設定するには、サーバーの起動時に <code class="literal">performance_schema_events_waits_history_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_waits_history</code> テーブルには、<code class="literal">events_waits_current</code> と同じカラムおよびインデックス付けがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-waits-current-table" title="27.12.4.1 events_waits_current テーブル">セクション27.12.4.1「events_waits_current テーブル」</a>を参照してください。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_waits_history</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つの待機イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          待機イベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="27.12.4 パフォーマンススキーマ待機イベントテーブル">セクション27.12.4「パフォーマンススキーマ待機イベントテーブル」</a> を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-waits-history-long-table"></a>27.12.4.3 events_waits_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm45882610928928"></a><a class="indexterm" name="idm45882610926704"></a><p>
          <code class="literal">events_waits_history_long</code> テーブルには、すべてのスレッドでグローバルに終了した最新の待機イベントが <em class="replaceable"><code>N</code></em> に含まれます。 待機イベントはそれらが終了するまでテーブルに追加されません。 テーブルがいっぱいになると、どちらのスレッドがどちらの行を生成したかに関係なく、新しい行が追加されたときにもっとも古い行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_waits_history_long_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_waits_history_long</code> テーブルには、<code class="literal">events_waits_current</code> と同じカラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-waits-current-table" title="27.12.4.1 events_waits_current テーブル">セクション27.12.4.1「events_waits_current テーブル」</a>を参照してください。 <code class="literal">events_waits_current</code> とは異なり、<code class="literal">events_waits_history_long</code> にはインデックス付けはありません。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_waits_history_long</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つの待機イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          待機イベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="27.12.4 パフォーマンススキーマ待機イベントテーブル">セクション27.12.4「パフォーマンススキーマ待機イベントテーブル」</a> を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-stage-tables"></a>27.12.5 パフォーマンススキーマステージイベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-events-stages-current-table">27.12.5.1 events_stages_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-stages-history-table">27.12.5.2 events_stages_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-stages-history-long-table">27.12.5.3 events_stages_history_long テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマは、ステートメントの解析、テーブルのオープン、<code class="literal">filesort</code> 操作の実行など、ステートメント実行プロセス中のステップであるステージを計測します。 ステージは <code class="literal">SHOW PROCESSLIST</code> によって表示されるか、または <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルに表示されるスレッドの状態に対応します。 ステージは、状態値が変化したときに開始および終了します。 
      </p><p>
        イベント階層内では、待機イベントはステージイベント内にネストされ、ステージイベントはステートメントイベント内にネストされ、ステートメントイベントはトランザクションイベント内にネストされます。
      </p><p>
        これらのテーブルはステージイベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_stages_current</code>: 各スレッドの現在のステージイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_history</code>: スレッドごとに終了した最新のステージイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_history_long</code>: グローバルに (すべてのスレッドで) 終了した最新のステージイベント。
          </p></li></ul></div><p>
        次の各セクションでは、ステージイベントテーブルについて説明します。 ステージイベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#performance-schema-stage-summary-tables" title="27.12.18.2 ステージサマリーテーブル">セクション27.12.18.2「ステージサマリーテーブル」</a>を参照してください。 
      </p><p>
        3 つのステージイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#stage-event-configuration" title="ステージイベント収集の構成">ステージイベント収集の構成</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#stage-event-progress" title="ステージイベント進捗情報">ステージイベント進捗情報</a></p></li></ul></div><h4><a name="stage-event-configuration"></a>ステージイベント収集の構成</h4><p>
        ステージイベントを収集するかどうかを制御するには、関連するインストゥルメントおよびコンシューマの状態を設定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブルには、<code class="literal">stage</code> で始まる名前を持つインストゥルメントが格納されます。 これらのインストゥルメントを使用して、個々のステージイベントクラスの収集を有効または無効にします。 
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブルには、現在のステージイベントテーブル名と履歴ステージイベントテーブル名に対応する名前のコンシューマ値が含まれます。 これらのコンシューマを使用して、ステージイベントのコレクションをフィルタします。 
          </p></li></ul></div><p>
        ステージインストゥルメントは、ステートメントの進捗情報を提供するインストゥルメント以外、デフォルトでは無効になっています。 例: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME RLIKE 'stage/sql/[a-c]';</code></strong>
+----------------------------------------------------+---------+-------+
| NAME                                               | ENABLED | TIMED |
+----------------------------------------------------+---------+-------+
| stage/sql/After create                             | NO      | NO    |
| stage/sql/allocating local table                   | NO      | NO    |
| stage/sql/altering table                           | NO      | NO    |
| stage/sql/committing alter table to storage engine | NO      | NO    |
| stage/sql/Changing master                          | NO      | NO    |
| stage/sql/Checking master version                  | NO      | NO    |
| stage/sql/checking permissions                     | NO      | NO    |
| stage/sql/cleaning up                              | NO      | NO    |
| stage/sql/closing tables                           | NO      | NO    |
| stage/sql/Connecting to master                     | NO      | NO    |
| stage/sql/converting HEAP to MyISAM                | NO      | NO    |
| stage/sql/Copying to group table                   | NO      | NO    |
| stage/sql/Copying to tmp table                     | NO      | NO    |
| stage/sql/copy to tmp table                        | NO      | NO    |
| stage/sql/Creating sort index                      | NO      | NO    |
| stage/sql/creating table                           | NO      | NO    |
| stage/sql/Creating tmp table                       | NO      | NO    |
+----------------------------------------------------+---------+-------+
</pre><p>
        ステートメントの進捗情報を提供するステージイベントインストゥルメントは、デフォルトで有効化され、時間設定されます:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE ENABLED='YES' AND NAME LIKE "stage/%";</code></strong>
+------------------------------------------------------+---------+-------+
| NAME                                                 | ENABLED | TIMED |
+------------------------------------------------------+---------+-------+
| stage/sql/copy to tmp table                          | YES     | YES   |
| stage/sql/Applying batch of row changes (write)      | YES     | YES   |
| stage/sql/Applying batch of row changes (update)     | YES     | YES   |
| stage/sql/Applying batch of row changes (delete)     | YES     | YES   |
| stage/innodb/alter table (end)                       | YES     | YES   |
| stage/innodb/alter table (flush)                     | YES     | YES   |
| stage/innodb/alter table (insert)                    | YES     | YES   |
| stage/innodb/alter table (log apply index)           | YES     | YES   |
| stage/innodb/alter table (log apply table)           | YES     | YES   |
| stage/innodb/alter table (merge sort)                | YES     | YES   |
| stage/innodb/alter table (read PK and internal sort) | YES     | YES   |
| stage/innodb/buffer pool load                        | YES     | YES   |
| stage/innodb/clone (file copy)                       | YES     | YES   |
| stage/innodb/clone (redo copy)                       | YES     | YES   |
| stage/innodb/clone (page copy)                       | YES     | YES   |
+------------------------------------------------------+---------+-------+
</pre><p>
        ステージコンシューマはデフォルトで無効にされています。
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'events_stages%';</code></strong>
+----------------------------+---------+
| NAME                       | ENABLED |
+----------------------------+---------+
| events_stages_current      | NO      |
| events_stages_history      | NO      |
| events_stages_history_long | NO      |
+----------------------------+---------+
</pre><p>
        サーバー起動時のステージイベント収集を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='stage/%=ON'
performance-schema-consumer-events-stages-current=ON
performance-schema-consumer-events-stages-history=ON
performance-schema-consumer-events-stages-history-long=ON
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='stage/%=OFF'
performance-schema-consumer-events-stages-current=OFF
performance-schema-consumer-events-stages-history=OFF
performance-schema-consumer-events-stages-history-long=OFF
</pre></li></ul></div><p>
        実行時にステージイベント収集を制御するには、<code class="literal">setup_instruments</code> テーブルと <code class="literal">setup_consumers</code> テーブルを更新します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME LIKE 'stage/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'YES'
WHERE NAME LIKE 'events_stages%';
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME LIKE 'stage/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE 'events_stages%';
</pre></li></ul></div><p>
        特定のステージイベントのみを収集するには、対応するステージインストゥルメントのみを有効にします。 特定のステージイベントテーブルに対してのみステージイベントを収集するには、ステージインストゥルメントを有効にしますが、目的のテーブルに対応するステージコンシューマのみを有効にします。 
      </p><p>
        イベント収集の構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a> および <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a> を参照してください。
      </p><h4><a name="stage-event-progress"></a>ステージイベント進捗情報</h4><p>
        パフォーマンススキーマのステージイベントテーブルには、ともに各行にステージ進捗インジケータを提供する 2 つのカラムが含まれています:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">WORK_COMPLETED</code>: ステージで完了した作業ユニットの数
          </p></li><li class="listitem"><p>
            <code class="literal">WORK_ESTIMATED</code>: ステージに必要な作業ユニット数
          </p></li></ul></div><p>
        インストゥルメントの進捗情報が指定されていない場合、各カラムは <code class="literal">NULL</code> です。 情報が使用可能な場合、その解釈はインストゥルメントの実装によって完全に異なります。 「パフォーマンススキーマ」テーブルは、進捗データを格納するコンテナを提供しますが、メトリック自体のセマンティクスについては想定しません: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="quote">「<span class="quote">「作業単位」</span>」</span>は、処理されるバイト数、行数、ファイル数、テーブル数など、実行中に時間の経過とともに増加する整数メトリックです。 特定のインストゥルメントの<span class="quote">「<span class="quote">「作業単位」</span>」</span>の定義は、データを提供するインストゥルメンテーションコードに残されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">WORK_COMPLETED</code> 値は、インストゥルメントされたコードに応じて、一度に 1 つ以上の単位を増やすことができます。
          </p></li><li class="listitem"><p>
            <code class="literal">WORK_ESTIMATED</code> 値は、インストゥルメントコードに応じてステージ中に変更できます。
          </p></li></ul></div><p>
        ステージイベント進捗インジケータのインストゥルメンテーションでは、次のいずれかの動作を実装できます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            進捗インスツルメンテーションなし
          </p><p>
            これは最も一般的なケースで、進捗データは提供されません。 <code class="literal">WORK_COMPLETED</code> カラムと <code class="literal">WORK_ESTIMATED</code> カラムはどちらも <code class="literal">NULL</code> です。 
          </p></li><li class="listitem"><p>
            無制限進捗インストゥルメンテーション
          </p><p>
            <code class="literal">WORK_COMPLETED</code> カラムのみが意味を持ちます。 <code class="literal">WORK_ESTIMATED</code> カラムにはデータが提供されず、0 が表示されます。 
          </p><p>
            監視対象セッションの <code class="literal">events_stages_current</code> テーブルをクエリーすることで、監視アプリケーションはこれまでに実行された作業量をレポートできますが、ステージが完了間近であるかどうかはレポートできません。 現在、このようなステージはインストゥルメントされていません。 
          </p></li><li class="listitem"><p>
            有限進捗インスツルメンテーション
          </p><p>
            <code class="literal">WORK_COMPLETED</code> カラムと <code class="literal">WORK_ESTIMATED</code> カラムの両方が意味を持ちます。
          </p><p>
            このタイプの進捗インジケータは、あとで説明するテーブルコピーインストゥルメントなど、完了基準が定義された操作に適しています。 監視対象セッションの <code class="literal">events_stages_current</code> テーブルをクエリーすることで、監視アプリケーションはこれまでに実行された作業量をレポートし、<code class="literal">WORK_COMPLETED</code> / <code class="literal">WORK_ESTIMATED</code> 比率を計算してステージの全体的な完了率をレポートできます。 
          </p></li></ul></div><p>
        <code class="literal">stage/sql/copy to tmp table</code> インストゥルメントは、進捗インジケータがどのように機能するかを示します。 <code class="literal">ALTER TABLE</code> ステートメントの実行中に <code class="literal">stage/sql/copy to tmp table</code> ステージが使用され、コピーするデータのサイズによっては、このステージが長時間実行される可能性があります。 
      </p><p>
        テーブルコピータスクには終了 (すべての行がコピーされます) が定義されており、<code class="literal">stage/sql/copy to tmp table</code> ステージは指定されたバインド済進捗情報にインスツルメント処理されます: 使用される作業ユニットはコピーされた行数で、<code class="literal">WORK_COMPLETED</code> と <code class="literal">WORK_ESTIMATED</code> はどちらも意味があり、その比率はタスク完了率を示します。
      </p><p>
        インストゥルメントおよび関連するコンシューマを有効にするには、次のステートメントを実行します:
      </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED='YES'
WHERE NAME='stage/sql/copy to tmp table';

UPDATE performance_schema.setup_consumers
SET ENABLED='YES'
WHERE NAME LIKE 'events_stages_%';
</pre><p>
        進行中の <code class="literal">ALTER TABLE</code> ステートメントの進行状況を確認するには、<code class="literal">events_stages_current</code> テーブルから選択します。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-stages-current-table"></a>27.12.5.1 events_stages_current テーブル</h4></div></div></div><a class="indexterm" name="idm45882610809568"></a><a class="indexterm" name="idm45882610807360"></a><p>
          <code class="literal">events_stages_current</code> テーブルには、現在のステージイベントが含まれます。 テーブルには、スレッドごとに最新のモニター対象ステージイベントの現在のステータスを示す 1 行が格納されるため、テーブルサイズを構成するためのシステム変数はありません。 
        </p><p>
          ステージイベント行を格納するテーブルのうち、<code class="literal">events_stages_current</code> はもっとも基本的です。 ステージイベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。 たとえば、<code class="literal">events_stages_history</code> テーブルと <code class="literal">events_stages_history_long</code> テーブルは、終了した最新のステージイベントのコレクションで、スレッド当たりの最大行数まで、およびすべてのスレッドにわたってグローバルに終了します。 
        </p><p>
          3 つのステージイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステージイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="27.12.5 パフォーマンススキーマステージイベントテーブル">セクション27.12.5「パフォーマンススキーマステージイベントテーブル」</a> を参照してください。
        </p><p>
          <code class="literal">events_stages_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。 ともに取得される <code class="literal">THREAD_ID</code> と <code class="literal">EVENT_ID</code> の値によって、行が一意に識別されます。 同じ値のペアを持つ行は 2 つありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成したインストゥルメントの名前。 これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。 これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。 これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。 <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。 <code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。 
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> は現在のタイマー値で、<code class="literal">TIMER_WAIT</code> はこれまでに経過した時間です (<code class="literal">TIMER_END</code> - <code class="literal">TIMER_START</code>)。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">WORK_COMPLETED</code>, <code class="literal">WORK_ESTIMATED</code>
            </p><p>
              これらのカラムには、このような情報を生成するために実装されたインストゥルメントのステージ進捗情報が表示されます。 <code class="literal">WORK_COMPLETED</code> はステージで完了した作業単位の数を示し、<code class="literal">WORK_ESTIMATED</code> はステージで予想される作業単位の数を示します。 詳細は、<a class="xref" href="performance-schema.html#stage-event-progress" title="ステージイベント進捗情報">ステージイベント進捗情報</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              このイベントが中にネストされているイベントの <code class="literal">EVENT_ID</code> 値。 ステージイベントのネストしているイベントは通常ステートメントイベントです。 
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              ネストしているイベントの種類。 値は <code class="literal">TRANSACTION</code>, <code class="literal">STATEMENT</code>, <code class="literal">STAGE</code> または <code class="literal">WAIT</code> です。 
            </p></li></ul></div><p>
          <code class="literal">events_stages_current</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_stages_current</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-stages-history-table"></a>27.12.5.2 events_stages_history テーブル</h4></div></div></div><a class="indexterm" name="idm45882610743616"></a><a class="indexterm" name="idm45882610741408"></a><p>
          <code class="literal">events_stages_history</code> テーブルには、スレッドごとに終了した <em class="replaceable"><code>N</code></em> の最新のステージイベントが含まれます。 ステージイベントは終了するまでテーブルに追加されません。 テーブルに特定のスレッドの最大行数が含まれている場合、そのスレッドの新しい行が追加されると、最も古いスレッド行は破棄されます。 スレッドが終了すると、そのすべての行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 スレッドごとの行数を明示的に設定するには、サーバーの起動時に <code class="literal">performance_schema_events_stages_history_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_stages_history</code> テーブルには、<code class="literal">events_stages_current</code> と同じカラムおよびインデックス付けがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-stages-current-table" title="27.12.5.1 events_stages_current テーブル">セクション27.12.5.1「events_stages_current テーブル」</a>を参照してください。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_stages_history</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つのステージイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステージイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="27.12.5 パフォーマンススキーマステージイベントテーブル">セクション27.12.5「パフォーマンススキーマステージイベントテーブル」</a> を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-stages-history-long-table"></a>27.12.5.3 events_stages_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm45882610724768"></a><a class="indexterm" name="idm45882610722544"></a><p>
          <code class="literal">events_stages_history_long</code> テーブルには、すべてのスレッドでグローバルに終了した <em class="replaceable"><code>N</code></em> の最新のステージイベントが含まれます。 ステージイベントは終了するまでテーブルに追加されません。 テーブルがいっぱいになると、どちらのスレッドがどちらの行を生成したかに関係なく、新しい行が追加されたときにもっとも古い行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_stages_history_long_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_stages_history_long</code> テーブルには、<code class="literal">events_stages_current</code> と同じカラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-stages-current-table" title="27.12.5.1 events_stages_current テーブル">セクション27.12.5.1「events_stages_current テーブル」</a>を参照してください。 <code class="literal">events_stages_current</code> とは異なり、<code class="literal">events_stages_history_long</code> にはインデックス付けはありません。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_stages_history_long</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つのステージイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステージイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="27.12.5 パフォーマンススキーマステージイベントテーブル">セクション27.12.5「パフォーマンススキーマステージイベントテーブル」</a> を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-statement-tables"></a>27.12.6 パフォーマンススキーマステートメントイベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-events-statements-current-table">27.12.6.1 events_statements_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-statements-history-table">27.12.6.2 events_statements_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-statements-history-long-table">27.12.6.3 events_statements_history_long テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-prepared-statements-instances-table">27.12.6.4 prepared_statements_instances テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマインストゥルメントはステートメントの実行を計測します。 ステートメントイベントは、イベント階層の上位レベルで発生します。 イベント階層内では、待機イベントはステージイベント内にネストされ、ステージイベントはステートメントイベント内にネストされ、ステートメントイベントはトランザクションイベント内にネストされます。 
      </p><p>
        これらのテーブルはステートメントイベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_statements_current</code>: 各スレッドの現在のステートメントイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_history</code>: スレッドごとに終了した最新のステートメントイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_history_long</code>: グローバルに (すべてのスレッドで) 終了した最新のステートメントイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">prepared_statements_instances</code>: プリペアドステートメントのインスタンスおよび統計
          </p></li></ul></div><p>
        次の各セクションでは、ステートメントイベントテーブルについて説明します。 ステートメントイベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#performance-schema-statement-summary-tables" title="27.12.18.3 ステートメントサマリーテーブル">セクション27.12.18.3「ステートメントサマリーテーブル」</a>を参照してください。 
      </p><p>
        3 つの <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-statement-tables-configuration" title="ステートメントイベント収集の構成">ステートメントイベント収集の構成</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-statement-tables-monitoring" title="ステートメントモニタリング">ステートメントモニタリング</a></p></li></ul></div><h4><a name="performance-schema-statement-tables-configuration"></a>ステートメントイベント収集の構成</h4><p>
        ステートメントイベントを収集するかどうかを制御するには、関連するインストゥルメントおよびコンシューマの状態を設定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブルには、<code class="literal">statement</code> で始まる名前を持つインストゥルメントが格納されます。 これらのインストゥルメントを使用して、個々のステートメントイベントクラスの収集を有効または無効にします。 
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブルには、現在および過去のステートメントイベントテーブル名に対応する名前を持つコンシューマ値と、ステートメントダイジェストコンシューマが含まれます。 これらのコンシューマを使用して、ステートメントイベントおよびステートメントダイジェストのコレクションをフィルタします。 
          </p></li></ul></div><p>
        ステートメントインストゥルメントはデフォルトで有効になっており、<code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code> および <code class="literal">statements_digest</code> ステートメントコンシューマはデフォルトで有効になっています:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'statement/%';</code></strong>
+---------------------------------------------+---------+-------+
| NAME                                        | ENABLED | TIMED |
+---------------------------------------------+---------+-------+
| statement/sql/select                        | YES     | YES   |
| statement/sql/create_table                  | YES     | YES   |
| statement/sql/create_index                  | YES     | YES   |
...
| statement/sp/stmt                           | YES     | YES   |
| statement/sp/set                            | YES     | YES   |
| statement/sp/set_trigger_field              | YES     | YES   |
| statement/scheduler/event                   | YES     | YES   |
| statement/com/Sleep                         | YES     | YES   |
| statement/com/Quit                          | YES     | YES   |
| statement/com/Init DB                       | YES     | YES   |
...
| statement/abstract/Query                    | YES     | YES   |
| statement/abstract/new_packet               | YES     | YES   |
| statement/abstract/relay_log                | YES     | YES   |
+---------------------------------------------+---------+-------+
</pre><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%statements%';</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_statements_current      | YES     |
| events_statements_history      | YES     |
| events_statements_history_long | NO      |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
        サーバー起動時のステートメントイベント収集を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='statement/%=ON'
performance-schema-consumer-events-statements-current=ON
performance-schema-consumer-events-statements-history=ON
performance-schema-consumer-events-statements-history-long=ON
performance-schema-consumer-statements-digest=ON
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='statement/%=OFF'
performance-schema-consumer-events-statements-current=OFF
performance-schema-consumer-events-statements-history=OFF
performance-schema-consumer-events-statements-history-long=OFF
performance-schema-consumer-statements-digest=OFF
</pre></li></ul></div><p>
        実行時にステートメントイベント収集を制御するには、<code class="literal">setup_instruments</code> テーブルおよび <code class="literal">setup_consumers</code> テーブルを更新します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME LIKE 'statement/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'YES'
WHERE NAME LIKE '%statements%';
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME LIKE 'statement/%';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE '%statements%';
</pre></li></ul></div><p>
        特定のステートメントイベントのみを収集するには、対応するステートメントインストゥルメントのみを有効にします。 特定のステートメントイベントテーブルについてのみステートメントイベントを収集するには、ステートメントインストゥルメントを有効にしますが、目的のテーブルに対応するステートメントコンシューマのみを有効にします。 
      </p><p>
        イベント収集の構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a> および <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a> を参照してください。
      </p><h4><a name="performance-schema-statement-tables-monitoring"></a>ステートメントモニタリング</h4><p>
        ステートメントのモニタリングは、サーバーがスレッドに対してアクティビティーがリクエストされていることを確認した時点から、すべてのアクティビティーが終了した時点までに開始されます。 一般に、これはサーバーがクライアントから最初のパケットを受け取ったときから、サーバーが応答の送信を終了したときまでを意味します。 ストアドプログラム内のステートメントは、ほかのステートメントと同様にモニターされます。 
      </p><p>
        パフォーマンススキーマがリクエスト (サーバーコマンドまたは SQL ステートメント) をインストゥルメントする場合、最終的なインストゥルメント名に到達するまで、より一般的 (または<span class="quote">「<span class="quote">抽象的</span>」</span>) から、より具体的へと段階を追って進むインストゥルメント名を使用します。
      </p><p>
        最終インストゥルメント名はサーバーコマンドと SQL ステートメントに対応します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            サーバーコマンドは <code class="filename">mysql_com.h</code> ヘッダーファイルに定義され、<code class="filename">sql/sql_parse.cc</code> で処理される <code class="literal">COM_<em class="replaceable"><code>xxx</code></em> codes</code> に対応します。 例は <code class="literal">COM_PING</code> と <code class="literal">COM_QUIT</code> です。 コマンドのインストゥルメントは、<code class="literal">statement/com/Ping</code> や <code class="literal">statement/com/Quit</code> などの <code class="literal">statement/com</code> から始まる名前を持ちます。 
          </p></li><li class="listitem"><p>
            SQL ステートメントは <code class="literal">DELETE FROM t1</code> または <code class="literal">SELECT * FROM t2</code> などのテキストとして表されます。 SQL ステートメントのインストゥルメントは、<code class="literal">statement/sql/delete</code> や <code class="literal">statement/sql/select</code> などの <code class="literal">statement/sql</code> から始まる名前を持ちます。 
          </p></li></ul></div><p>
        いくつかの最終インストゥルメント名はエラー処理に固有です。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">statement/com/Error</code> は帯域外のサーバーによって受信されたメッセージから構成されます。 これはサーバーが理解しないクライアントによって送信されたコマンドを検出するために使用できます。 これは、構成が誤っているか、サーバーよりも新しい MySQL のバージョンを使用しているクライアントや、サーバーへの攻撃を試みているクライアントの識別などの目的で役に立つことがあります。 
          </p></li><li class="listitem"><p>
            <code class="literal">statement/sql/error</code> は解析に失敗した SQL ステートメントから構成されます。 これはクライアントによって送信された不正な形式のクエリーを検出するために使用できます。 解析に失敗するクエリーは、解析するが、実行中のエラーのために失敗するクエリーと異なります。 たとえば、<code class="literal">SELECT * FROM</code> は不正な形式で、<code class="literal">statement/sql/error</code> インストゥルメントが使用されます。 対照的に <code class="literal">SELECT *</code> は解析しますが、<code class="literal">「表が指定されていません」</code>エラーを伴って失敗します。 この場合、<code class="literal">statement/sql/select</code> が使用され、ステートメントイベントにはエラーの性質を示す情報が含まれます。 
          </p></li></ul></div><p>
        リクエストはこれらの任意のソースから取得できます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            リクエストをパケットとして送信するクライアントからのコマンドまたはステートメントリクエストとして
          </p></li><li class="listitem"><p>
            レプリカのリレーログから読み取られたステートメント文字列として
          </p></li><li class="listitem"><p>
            イベントスケジューラのイベントとして
          </p></li></ul></div><p>
        リクエストの詳細は最初は不明で、パフォーマンススキーマはリクエストのソースに依存する順序で、抽象から特定のインストゥルメント名に進みます。
      </p><p>
        クライアントから受信したリクエストの場合:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            サーバーがソケットレベルで新しいパケットを検出すると、新しいステートメントが <code class="literal">statement/abstract/new_packet</code> の抽象インストゥルメント名で開始されます。
          </p></li><li class="listitem"><p>
            サーバーはパケット番号を読み取ると、受信したリクエストの種類について詳しく知り、パフォーマンススキーマがインストゥルメント名を絞り込みます。 たとえば、リクエストが <code class="literal">COM_PING</code> パケットの場合、インストゥルメント名は <code class="literal">statement/com/Ping</code> になり、それが最終名になります。 リクエストが <code class="literal">COM_QUERY</code> パケットの場合、特定のタイプのステートメントではなく SQL ステートメントに対応することがわかっています。 この場合、インストゥルメントはある抽象名から、やや具体的だが、まだ抽象名である <code class="literal">statement/abstract/Query</code> に変更され、リクエストはさらに分類する必要があります。 
          </p></li><li class="listitem"><p>
            リクエストがステートメントである場合、ステートメントテキストが読み取られ、パーサーに提供されます。 解析後、正確なステートメントの種類が認識されます。 リクエストがたとえば <code class="literal">INSERT</code> ステートメントの場合、パフォーマンススキーマはインストゥルメント名を <code class="literal">statement/abstract/Query</code> から最終名である <code class="literal">statement/sql/insert</code> に絞り込みます。 
          </p></li></ol></div><p>
        レプリカのリレーログからステートメントとして読み取られたリクエストの場合:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            リレーログ内のステートメントはテキストとして保存され、そのように読み取られます。 ネットワークプロトコルはないため、<code class="literal">statement/abstract/new_packet</code> インストゥルメントは使用されません。 代わりに、初期インストゥルメントは <code class="literal">statement/abstract/relay_log</code> になります。 
          </p></li><li class="listitem"><p>
            ステートメントが解析されると、正確なステートメントの種類が認識されます。 リクエストがたとえば <code class="literal">INSERT</code> ステートメントの場合、パフォーマンススキーマはインストゥルメント名を <code class="literal">statement/abstract/Query</code> から最終名である <code class="literal">statement/sql/insert</code> に絞り込みます。 
          </p></li></ol></div><p>
        先述の説明はステートメントベースのレプリケーションにのみ適用されます。 行ベースレプリケーションの場合、行の変更を処理するレプリカで実行されるテーブル I/O は計測できますが、リレーログ内の行イベントは個別のステートメントとして表示されません。 
      </p><p>
        イベントスケジューラから受信したリクエストの場合:
      </p><p>
        イベント実行は、<code class="literal">statement/scheduler/event</code> という名前を使用してインストゥルメントされます。 これは最終名です。 
      </p><p>
        イベント本体内で実行されるステートメントは、前の抽象インストゥルメントを使用せずに、<code class="literal">statement/sql/*</code> 名を使用してインストゥルメントされます。 イベントはストアドプログラムであり、ストアドプログラムは実行前にメモリー内でプリコンパイルされます。 したがって、実行時に解析は行われず、各ステートメントのタイプは実行時に認識されます。 
      </p><p>
        イベント本体内で実行されるステートメントは子ステートメントです。 たとえば、イベントが <code class="literal">INSERT</code> ステートメントを実行する場合、イベント自体の実行は親で、<code class="literal">statement/scheduler/event</code> を使用してインスツルメント処理され、<code class="literal">INSERT</code> は <code class="literal">statement/sql/insert</code> を使用してインスツルメント処理された子です。 親子関係には、<span class="emphasis"><em>between</em></span> の個別のインストゥルメントされた操作が保持されます。 これは、<span class="emphasis"><em>範囲内</em></span>で単一のインストゥルメント操作が発生する絞込みのシーケンスとは異なり、抽象インストゥルメント名から最終インストゥルメント名まで異なります。 
      </p><p>
        ステートメントに対して収集される統計の場合、各ステートメントの種類に使用される最終 <code class="literal">statement/sql/*</code> インストゥルメントを有効にするだけでは十分ではありません。 抽象 <code class="literal">statement/abstract/*</code> インストゥルメントも有効にする必要があります。 すべてのステートメントインストゥルメントがデフォルトで有効にされるため、これは通常問題にならないはずです。 ただし、ステートメントインストゥルメントを選択して有効または無効にするアプリケーションは、抽象インストゥルメントを無効にすると、個々のステートメントインストゥルメントの統計収集も無効になることを考慮する必要があります。 たとえば、<code class="literal">INSERT</code> ステートメントの統計を収集するには、<code class="literal">statement/sql/insert</code> を有効にする必要がありますが、<code class="literal">statement/abstract/new_packet</code> と <code class="literal">statement/abstract/Query</code> も有効にする必要があります。 同様に、レプリケートされたステートメントをインストゥルメントするには、<code class="literal">statement/abstract/relay_log</code> が有効にされている必要があります。 
      </p><p>
        ステートメントが最終ステートメント名として抽象インストゥルメントに分類されることはないため、<code class="literal">statement/abstract/Query</code> などの抽象インストゥルメントに対して統計は集計されません。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-statements-current-table"></a>27.12.6.1 events_statements_current テーブル</h4></div></div></div><a class="indexterm" name="idm45882610579536"></a><a class="indexterm" name="idm45882610577312"></a><p>
          <code class="literal">events_statements_current</code> テーブルには、現在のステートメントイベントが含まれます。 テーブルには、スレッドごとに最新のモニター対象ステートメントイベントの現在のステータスを示す 1 行が格納されるため、テーブルサイズを構成するためのシステム変数はありません。 
        </p><p>
          ステートメントイベント行を格納するテーブルのうち、<code class="literal">events_statements_current</code> はもっとも基本的です。 ステートメントイベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。 たとえば、<code class="literal">events_statements_history</code> テーブルと <code class="literal">events_statements_history_long</code> テーブルは、終了した最新のステートメントイベントのコレクションで、スレッド当たりの最大行数まで、およびすべてのスレッドにわたってグローバルに終了します。 
        </p><p>
          3 つの <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステートメントイベントを収集するかどうかの構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a> を参照してください。
        </p><p>
          <code class="literal">events_statements_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。 ともに取得される <code class="literal">THREAD_ID</code> と <code class="literal">EVENT_ID</code> の値によって、行が一意に識別されます。 同じ値のペアを持つ行は 2 つありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントが収集されたインストゥルメントの名前。 これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
            </p><p>
              SQL ステートメントの場合、ステートメントが解析されるまで、<code class="literal">EVENT_NAME</code> 値は最初 <code class="literal">statement/com/Query</code> であり、その後<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a>に説明するように、より適切な値に変更されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。 これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。 これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。 <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。 <code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。 
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> は現在のタイマー値で、<code class="literal">TIMER_WAIT</code> はこれまでに経過した時間です (<code class="literal">TIMER_END</code> - <code class="literal">TIMER_START</code>)。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_TIME</code>
            </p><p>
              テーブルロックの待機に費やされた時間。 この値はマイクロ秒で計算されますが、ほかのパフォーマンススキーマタイマーとの比較を容易にするため、ピコ秒に正規化されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SQL_TEXT</code>
            </p><p>
              SQL ステートメントのテキスト。 SQL ステートメントに関連付けられていないコマンドの場合、値は <code class="literal">NULL</code> です。 
            </p><p>
              ステートメントの表示に使用できる最大領域は、デフォルトで 1024 バイトです。 この値を変更するには、サーバーの起動時に <code class="literal">performance_schema_max_sql_text_length</code> システム変数を設定します。 (この値を変更すると、他の「パフォーマンススキーマ」テーブルのカラムにも影響します。 <a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。) 
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST</code>
            </p><p>
              ステートメントは、64 16 進数文字の文字列、または <code class="literal">statements_digest</code> コンシューマが <code class="literal">no</code> の場合は <code class="literal">NULL</code> として SHA-256 値をダイジェストします。 ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST_TEXT</code>
            </p><p>
              正規化されたステートメントダイジェストテキスト (<code class="literal">statements_digest</code> コンシューマが <code class="literal">no</code> の場合は <code class="literal">NULL</code>)。 ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。 
            </p><p>
              <code class="literal">performance_schema_max_digest_length</code> システム変数は、ダイジェスト値の格納に使用できるセッション当たりの最大バイト数を決定します。 ただし、ダイジェストバッファ内のキーワードやリテラル値などのステートメント要素のエンコーディングにより、ステートメントダイジェストの表示長が使用可能なバッファサイズより長くなる場合があります。 したがって、ステートメントイベントテーブルの <code class="literal">DIGEST_TEXT</code> カラムから選択された値は、<code class="literal">performance_schema_max_digest_length</code> 値を超えるように見える場合があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_SCHEMA</code>
            </p><p>
              ステートメントのデフォルトのデータベース、何もない場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、<code class="literal">OBJECT_TYPE</code>
            </p><p>
              ネストしたステートメント (ストアドプログラム) の場合、これらのカラムには親ステートメントに関する情報が含まれます。 それ以外の場合は、<code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              このカラムはステートメントを識別します。 この値はメモリー内のオブジェクトのアドレスです。 
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code>
            </p><p>
              ステートメント診断領域からのステートメントエラー番号。
            </p></li><li class="listitem"><p>
              <code class="literal">RETURNED_SQLSTATE</code>
            </p><p>
              ステートメント診断領域からのステートメント SQLSTATE 値。
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code>
            </p><p>
              ステートメント診断領域からのステートメントエラーメッセージ。
            </p></li><li class="listitem"><p>
              <code class="literal">ERRORS</code>
            </p><p>
              ステートメントにエラーが発生したかどうか。 SQLSTATE 値が <code class="literal">00</code> (完了) または <code class="literal">01</code> (警告) から始まる場合、値は 0 です。 SQLSTATE 値がほかの値の場合、値は 1 です。 
            </p></li><li class="listitem"><p>
              <code class="literal">WARNINGS</code>
            </p><p>
              ステートメント診断領域からの警告数。
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_AFFECTED</code>
            </p><p>
              ステートメントに影響を受けた行数。 <span class="quote">「<span class="quote">影響を受けた</span>」</span>の意味については、<a class="ulink" href="https://dev.mysql.com/doc/c-api/8.0/en/mysql-affected-rows.html" target="_top">mysql_affected_rows()</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_SENT</code>
            </p><p>
              ステートメントから返された行数。
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_EXAMINED</code>
            </p><p>
              サーバーレイヤーによって検査された行数 (ストレージエンジン内部の処理はカウントされません)。
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_DISK_TABLES</code>
            </p><p>
              <code class="literal">Created_tmp_disk_tables</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_TABLES</code>
            </p><p>
              <code class="literal">Created_tmp_tables</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_JOIN</code>
            </p><p>
              <code class="literal">Select_full_join</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_RANGE_JOIN</code>
            </p><p>
              <code class="literal">Select_full_range_join</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE</code>
            </p><p>
              <code class="literal">Select_range</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE_CHECK</code>
            </p><p>
              <code class="literal">Select_range_check</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_SCAN</code>
            </p><p>
              <code class="literal">Select_scan</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_MERGE_PASSES</code>
            </p><p>
              <code class="literal">Sort_merge_passes</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_RANGE</code>
            </p><p>
              <code class="literal">Sort_range</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_ROWS</code>
            </p><p>
              <code class="literal">Sort_rows</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_SCAN</code>
            </p><p>
              <code class="literal">Sort_scan</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">NO_INDEX_USED</code>
            </p><p>
              ステートメントがインデックスを使用せずにテーブルスキャンを実行した場合は 1、そうでない場合は 0。
            </p></li><li class="listitem"><p>
              <code class="literal">NO_GOOD_INDEX_USED</code>
            </p><p>
              サーバーがステートメントに使用する適切なインデックスを見つけられなかった場合は 1、そうでない場合は 0。 追加の情報については、<a class="xref" href="optimization.html#explain-output" title="8.8.2 EXPLAIN 出力フォーマット">セクション8.8.2「EXPLAIN 出力フォーマット」</a>で、<code class="literal">EXPLAIN</code> 出力の <code class="literal">Extra</code> カラムの <code class="literal">Range checked for each record</code> 値の説明を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>, <code class="literal">NESTING_EVENT_TYPE</code>, <code class="literal">NESTING_EVENT_LEVEL</code>
            </p><p>
              これらの 3 つのカラムは、最上位 (ネストされていない) ステートメントおよびネストされたステートメント (ストアドプログラム内で実行される) に関する次のような情報を提供するために、他のカラムとともに使用されます。
            </p><p>
              トップレベルのステートメントの場合:
            </p><pre class="programlisting">OBJECT_TYPE = NULL
OBJECT_SCHEMA = NULL
OBJECT_NAME = NULL
NESTING_EVENT_ID = NULL
NESTING_EVENT_TYPE = NULL
NESTING_LEVEL = 0
</pre><p>
              ネストしたステートメントの場合:
            </p><pre class="programlisting">OBJECT_TYPE = the parent statement object type
OBJECT_SCHEMA = the parent statement object schema
OBJECT_NAME = the parent statement object name
NESTING_EVENT_ID = the parent statement EVENT_ID
NESTING_EVENT_TYPE = 'STATEMENT'
NESTING_LEVEL = the parent statement NESTING_LEVEL plus one
</pre></li><li class="listitem"><p>
              <code class="literal">STATEMENT_ID</code>
            </p><p>
              SQL レベルでサーバーによって保持されるクエリー ID。 これらの ID はアトミックに増分されるグローバルカウンタを使用して生成されるため、この値はサーバーインスタンスに対して一意です。 このカラムは、MySQL 8.0.14 で追加されました。 
            </p></li></ul></div><p>
          <code class="literal">events_statements_current</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_statements_current</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-statements-history-table"></a>27.12.6.2 events_statements_history テーブル</h4></div></div></div><a class="indexterm" name="idm45882610421376"></a><a class="indexterm" name="idm45882610419152"></a><p>
          <code class="literal">events_statements_history</code> テーブルには、スレッドごとに終了した <em class="replaceable"><code>N</code></em> の最新のステートメントイベントが含まれます。 ステートメントイベントは終了するまでテーブルに追加されません。 テーブルに特定のスレッドの最大行数が含まれている場合、そのスレッドの新しい行が追加されると、最も古いスレッド行は破棄されます。 スレッドが終了すると、そのすべての行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 スレッドごとの行数を明示的に設定するには、サーバーの起動時に <code class="literal">performance_schema_events_statements_history_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_statements_history</code> テーブルには、<code class="literal">events_statements_current</code> と同じカラムおよびインデックス付けがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-statements-current-table" title="27.12.6.1 events_statements_current テーブル">セクション27.12.6.1「events_statements_current テーブル」</a>を参照してください。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_statements_history</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つの <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステートメントイベントを収集するかどうかの構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a> を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-statements-history-long-table"></a>27.12.6.3 events_statements_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm45882610401456"></a><a class="indexterm" name="idm45882610399280"></a><p>
          <code class="literal">events_statements_history_long</code> テーブルには、すべてのスレッドでグローバルに終了した <em class="replaceable"><code>N</code></em> の最新のステートメントイベントが含まれます。 ステートメントイベントは終了するまでテーブルに追加されません。 テーブルがいっぱいになると、どちらのスレッドがどちらの行を生成したかに関係なく、新しい行が追加されたときにもっとも古い行が破棄されます。 
        </p><p>
          <em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_statements_history_long_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_statements_history_long</code> テーブルには、<code class="literal">events_statements_current</code> と同じカラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-statements-current-table" title="27.12.6.1 events_statements_current テーブル">セクション27.12.6.1「events_statements_current テーブル」</a>を参照してください。 <code class="literal">events_statements_current</code> とは異なり、<code class="literal">events_statements_history_long</code> にはインデックス付けはありません。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_statements_history_long</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つの <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> イベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          ステートメントイベントを収集するかどうかの構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a> を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-prepared-statements-instances-table"></a>27.12.6.4 prepared_statements_instances テーブル</h4></div></div></div><p>
          パフォーマンススキーマはプリペアドステートメントのインストゥルメンテーションを提供しますが、次の 2 つのプロトコルがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              バイナリプロトコル。 これには MySQL C API を介してアクセスし、次のテーブルに示すように基礎となるサーバーコマンドにマップします。 
            </p><div class="informaltable"><table summary="How the binary protocol accessed through the MySQL C API maps onto underlying server commands."><col width="50%"><col width="50%"><thead><tr>
                  <th>C API 関数</th>
                  <th>対応するサーバーコマンド</th>
                </tr></thead><tbody><tr>
                  <td><code class="literal">mysql_stmt_prepare()</code></td>
                  <td><code class="literal">COM_STMT_PREPARE</code></td>
                </tr><tr>
                  <td><code class="literal">mysql_stmt_execute()</code></td>
                  <td><code class="literal">COM_STMT_EXECUTE</code></td>
                </tr><tr>
                  <td><code class="literal">mysql_stmt_close()</code></td>
                  <td><code class="literal">COM_STMT_CLOSE</code></td>
                </tr></tbody></table></div></li><li class="listitem"><p>
              テキストプロトコル。 これには SQL ステートメントを使用してアクセスし、次のテーブルに示すように基礎となるサーバーコマンドにマップします。 
            </p><div class="informaltable"><table summary="How the text protocol accessed using SQL statements maps onto underlying server commands."><col width="50%"><col width="50%"><thead><tr>
                  <th>SQL ステートメント</th>
                  <th>対応するサーバーコマンド</th>
                </tr></thead><tbody><tr>
                  <td><code class="literal">PREPARE</code></td>
                  <td><code class="literal">SQLCOM_PREPARE</code></td>
                </tr><tr>
                  <td><code class="literal">EXECUTE</code></td>
                  <td><code class="literal">SQLCOM_EXECUTE</code></td>
                </tr><tr>
                  <td><code class="literal">DEALLOCATE PREPARE</code>, <code class="literal">DROP PREPARE</code></td>
                  <td><code class="literal">SQLCOM_DEALLOCATE PREPARE</code></td>
                </tr></tbody></table></div></li></ul></div><p>
          パフォーマンススキーマプリペアドステートメントインストゥルメンテーションは、両方のプロトコルに対応しています。 次の説明では、C API 関数または SQL ステートメントではなくサーバーコマンドについて説明します。 
        </p><p>
          プリペアドステートメントに関する情報は、<code class="literal">prepared_statements_instances</code> テーブルにあります。 このテーブルは、サーバーで使用されるプリペアドステートメントの検査を有効にし、それらに関する集計された統計を提供します。 このテーブルのサイズを制御するには、サーバーの起動時に <code class="literal">performance_schema_max_prepared_statements_instances</code> システム変数を設定します。 
        </p><p>
          プリペアドステートメント情報の収集は、次のテーブルに示すステートメントインストゥルメントによって異なります。 これらのインストゥルメントはデフォルトで有効になっています。 これらを変更するには、<code class="literal">setup_instruments</code> テーブルを更新します。 
        </p><div class="informaltable"><table summary="Collection of prepared statement information depends on the statement instruments shown in this table."><col width="50%"><col width="50%"><thead><tr>
              <th>金融商品</th>
              <th>サーバーコマンド</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">statement/com/Prepare</code></td>
              <td><code class="literal">COM_STMT_PREPARE</code></td>
            </tr><tr>
              <td><code class="literal">statement/com/Execute</code></td>
              <td><code class="literal">COM_STMT_EXECUTE</code></td>
            </tr><tr>
              <td><code class="literal">statement/sql/prepare_sql</code></td>
              <td><code class="literal">SQLCOM_PREPARE</code></td>
            </tr><tr>
              <td><code class="literal">statement/sql/execute_sql</code></td>
              <td><code class="literal">SQLCOM_EXECUTE</code></td>
            </tr></tbody></table></div><p>
          パフォーマンススキーマは、<code class="literal">prepared_statements_instances</code> テーブルの内容を次のように管理します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              ステートメントの準備
            </p><p>
              <code class="literal">COM_STMT_PREPARE</code> または <code class="literal">SQLCOM_PREPARE</code> コマンドは、サーバーにプリペアドステートメントを作成します。 ステートメントが正常にインスツルメント処理されると、新しい行が <code class="literal">prepared_statements_instances</code> テーブルに追加されます。 ステートメントを計測できない場合は、<code class="literal">Performance_schema_prepared_statements_lost</code> ステータス変数が増分されます。 
            </p></li><li class="listitem"><p>
              プリペアドステートメントの実行
            </p><p>
              インスツルメント処理されたプリペアドステートメントインスタンスに対して <code class="literal">COM_STMT_EXECUTE</code> または <code class="literal">SQLCOM_PREPARE</code> コマンドを実行すると、対応する <code class="literal">prepared_statements_instances</code> テーブルの行が更新されます。
            </p></li><li class="listitem"><p>
              プリペアドステートメントの割当て解除
            </p><p>
              インスツルメント処理されたプリペアドステートメントインスタンスに対して <code class="literal">COM_STMT_CLOSE</code> または <code class="literal">SQLCOM_DEALLOCATE_PREPARE</code> コマンドを実行すると、対応する <code class="literal">prepared_statements_instances</code> テーブルの行が削除されます。 リソースリークを回避するために、前述のプリペアドステートメントインストゥルメントが無効になっていても、削除が行われます。 
            </p></li></ul></div><p>
          <code class="literal">prepared_statements_instances</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされたプリペアドステートメントのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">STATEMENT_ID</code>
            </p><p>
              サーバーによって割り当てられた内部ステートメント ID。 テキストプロトコルとバイナリプロトコルはどちらもステートメント ID を使用します。 
            </p></li><li class="listitem"><p>
              <code class="literal">STATEMENT_NAME</code>
            </p><p>
              バイナリプロトコルの場合、このカラムは <code class="literal">NULL</code> です。 テキストプロトコルの場合、このカラムはユーザーによって割り当てられた外部ステートメントの名前です。 たとえば、次の SQL ステートメントの場合、プリペアドステートメントの名前は <code class="literal">stmt</code> です: 
            </p><pre class="programlisting">PREPARE stmt FROM 'SELECT 1';
</pre></li><li class="listitem"><p>
              <code class="literal">SQL_TEXT</code>
            </p><p>
              <code class="literal">?</code> プレースホルダマーカーを使用したプリペアドステートメントのテキスト。
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_THREAD_ID</code>, <code class="literal">OWNER_EVENT_ID</code>
            </p><p>
              これらのカラムは、プリペアドステートメントを作成したイベントを示します。
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_OBJECT_TYPE</code>, <code class="literal">OWNER_OBJECT_SCHEMA</code>, <code class="literal">OWNER_OBJECT_NAME</code>
            </p><p>
              クライアントセッションによって作成されたプリペアドステートメントの場合、これらのカラムは <code class="literal">NULL</code> です。 ストアドプログラムによって作成されたプリペアドステートメントの場合、これらのカラムはストアドプログラムを指します。 一般的なユーザーエラーは、プリペアドステートメントの割当て解除を忘れたことです。 これらのカラムを使用すると、プリペアドステートメントをリークするストアドプログラムを見つけることができます: 
            </p><pre class="programlisting">SELECT
  OWNER_OBJECT_TYPE, OWNER_OBJECT_SCHEMA, OWNER_OBJECT_NAME,
  STATEMENT_NAME, SQL_TEXT
FROM performance_schema.prepared_statements_instances
WHERE OWNER_OBJECT_TYPE IS NOT NULL;
</pre></li><li class="listitem"><p>
              <code class="literal">TIMER_PREPARE</code>
            </p><p>
              ステートメントの準備自体の実行に要した時間。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_REPREPARE</code>
            </p><p>
              ステートメントが内部的に再準備された回数 (<a class="xref" href="optimization.html#statement-caching" title="8.10.3 プリペアドステートメントおよびストアドプログラムのキャッシュ">セクション8.10.3「プリペアドステートメントおよびストアドプログラムのキャッシュ」</a> を参照)。 再準備のタイミング統計は、個別の操作としてではなくステートメントの実行の一部としてカウントされるため、使用できません。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_EXECUTE</code>, <code class="literal">SUM_TIMER_EXECUTE</code>, <code class="literal">MIN_TIMER_EXECUTE</code>, <code class="literal">AVG_TIMER_EXECUTE</code>, <code class="literal">MAX_TIMER_EXECUTE</code>
            </p><p>
              プリペアドステートメントの実行の集計統計。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code>
            </p><p>
              残りの <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code> カラムは、ステートメントサマリーテーブルと同じです (<a class="xref" href="performance-schema.html#performance-schema-statement-summary-tables" title="27.12.18.3 ステートメントサマリーテーブル">セクション27.12.18.3「ステートメントサマリーテーブル」</a> を参照)。
            </p></li></ul></div><p>
          <code class="literal">prepared_statements_instances</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">STATEMENT_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">STATEMENT_NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">OWNER_THREAD_ID</code>、<code class="literal">OWNER_EVENT_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">OWNER_OBJECT_TYPE</code>, <code class="literal">OWNER_OBJECT_SCHEMA</code>, <code class="literal">OWNER_OBJECT_NAME</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> により、<code class="literal">prepared_statements_instances</code> テーブルの統計カラムがリセットされます。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-transaction-tables"></a>27.12.7 パフォーマンススキーマのトランザクションテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-events-transactions-current-table">27.12.7.1 events_transactions_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-transactions-history-table">27.12.7.2 events_transactions_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-events-transactions-history-long-table">27.12.7.3 events_transactions_history_long テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマはトランザクションを計測します。 イベント階層内では、待機イベントはステージイベント内にネストされ、ステージイベントはステートメントイベント内にネストされ、ステートメントイベントはトランザクションイベント内にネストされます。 
      </p><p>
        次のテーブルには、トランザクションイベントが格納されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_transactions_current</code>: 各スレッドの現在のトランザクションイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_history</code>: スレッドごとに終了した最新のトランザクションイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_history_long</code>: グローバルに (すべてのスレッドで) 終了した最新のトランザクションイベント。
          </p></li></ul></div><p>
        次の各セクションでは、トランザクションイベントテーブルについて説明します。 トランザクションイベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#performance-schema-transaction-summary-tables" title="27.12.18.5 トランザクション要約テーブル">セクション27.12.18.5「トランザクション要約テーブル」</a> を参照してください。 
      </p><p>
        3 つのトランザクションイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-configuration" title="トランザクションイベント収集の構成">トランザクションイベント収集の構成</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-transaction-boundaries" title="トランザクション境界">トランザクション境界</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-instrumentation" title="トランザクション手段">トランザクション手段</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-nested-events" title="トランザクションおよびネストされたイベント">トランザクションおよびネストされたイベント</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-stored-programs" title="トランザクションとストアドプログラム">トランザクションとストアドプログラム</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-savepoints" title="トランザクションとセーブポイント">トランザクションとセーブポイント</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-transaction-tables-errors" title="トランザクションおよびエラー">トランザクションおよびエラー</a></p></li></ul></div><h4><a name="performance-schema-transaction-tables-configuration"></a>トランザクションイベント収集の構成</h4><p>
        トランザクションイベントを収集するかどうかを制御するには、関連するインストゥルメントおよびコンシューマの状態を設定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブルには、<code class="literal">transaction</code> という名前のインストゥルメントが含まれています。 このインストゥルメントを使用して、個々のトランザクションイベントクラスの収集を有効または無効にします。 
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code> テーブルには、現在のトランザクションイベントテーブル名と履歴トランザクションイベントテーブル名に対応する名前のコンシューマ値が含まれます。 これらのコンシューマを使用して、トランザクションイベントのコレクションをフィルタします。 
          </p></li></ul></div><p>
        <code class="literal">transaction</code> インストゥルメント、<code class="literal">events_transactions_current</code> および <code class="literal">events_transactions_history</code> トランザクションコンシューマは、デフォルトで有効になっています:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME = 'transaction';</code></strong>
+-------------+---------+-------+
| NAME        | ENABLED | TIMED |
+-------------+---------+-------+
| transaction | YES     | YES   |
+-------------+---------+-------+
mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'events_transactions%';</code></strong>
+----------------------------------+---------+
| NAME                             | ENABLED |
+----------------------------------+---------+
| events_transactions_current      | YES     |
| events_transactions_history      | YES     |
| events_transactions_history_long | NO      |
+----------------------------------+---------+
</pre><p>
        サーバー起動時のトランザクションイベント収集を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='transaction=ON'
performance-schema-consumer-events-transactions-current=ON
performance-schema-consumer-events-transactions-history=ON
performance-schema-consumer-events-transactions-history-long=ON
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">[mysqld]
performance-schema-instrument='transaction=OFF'
performance-schema-consumer-events-transactions-current=OFF
performance-schema-consumer-events-transactions-history=OFF
performance-schema-consumer-events-transactions-history-long=OFF
</pre></li></ul></div><p>
        実行時にトランザクションイベント収集を制御するには、<code class="literal">setup_instruments</code> テーブルと <code class="literal">setup_consumers</code> テーブルを更新します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            有効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME = 'transaction';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'YES'
WHERE NAME LIKE 'events_transactions%';
</pre></li><li class="listitem"><p>
            無効化:
          </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME = 'transaction';

UPDATE performance_schema.setup_consumers
SET ENABLED = 'NO'
WHERE NAME LIKE 'events_transactions%';
</pre></li></ul></div><p>
        特定のトランザクションイベントテーブルに対してのみトランザクションイベントを収集するには、<code class="literal">transaction</code> インストゥルメントを有効にしますが、目的のテーブルに対応するトランザクションコンシューマのみを有効にします。
      </p><p>
        イベント収集の構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a> および <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a> を参照してください。
      </p><h4><a name="performance-schema-transaction-tables-transaction-boundaries"></a>トランザクション境界</h4><p>
        MySQL Server では、トランザクションは次のステートメントで明示的に開始されます:
      </p><pre class="programlisting">START TRANSACTION | BEGIN | XA START | XA BEGIN
</pre><p>
        トランザクションも暗黙的に開始されます。 たとえば、<code class="literal">autocommit</code> システム変数が有効になっている場合、各ステートメントの開始によって新しいトランザクションが開始されます。 
      </p><p>
        <code class="literal">autocommit</code> が無効になっている場合、コミットされたトランザクションに続く最初のステートメントによって、新しいトランザクションの開始がマークされます。 後続のステートメントは、コミットされるまでトランザクションの一部です。 
      </p><p>
        トランザクションは、次のステートメントで明示的に終了します:
      </p><pre class="programlisting">COMMIT | ROLLBACK | XA COMMIT | XA ROLLBACK
</pre><p>
        トランザクションは、DDL ステートメント、ロックステートメントおよびサーバー管理ステートメントの実行によっても暗黙的に終了します。
      </p><p>
        次の説明では、<code class="literal">START TRANSACTION</code> への参照は <code class="literal">BEGIN</code>、<code class="literal">XA START</code> および <code class="literal">XA BEGIN</code> にも適用されます。 同様に、<code class="literal">COMMIT</code> および <code class="literal">ROLLBACK</code> への参照は、それぞれ <code class="literal">XA COMMIT</code> および <code class="literal">XA ROLLBACK</code> に適用されます。 
      </p><p>
        パフォーマンススキーマは、サーバーと同様のトランザクション境界を定義します。 トランザクションイベントの開始と終了は、サーバー内の対応する状態遷移と密接に一致します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            明示的に開始されたトランザクションの場合、トランザクションイベントは <code class="literal">START TRANSACTION</code> ステートメントの処理中に開始されます。
          </p></li><li class="listitem"><p>
            暗黙的に開始されたトランザクションの場合、トランザクションイベントは、前のトランザクションの終了後にトランザクションエンジンを使用する最初のステートメントで開始されます。
          </p></li><li class="listitem"><p>
            トランザクションについては、明示的に終了したか暗黙的に終了したかにかかわらず、<code class="literal">COMMIT</code> または <code class="literal">ROLLBACK</code> の処理中にサーバーがアクティブなトランザクション状態から遷移すると、トランザクションイベントが終了します。
          </p></li></ul></div><p>
        このアプローチには微妙な影響があります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            パフォーマンススキーマ内のトランザクションイベントには、対応する <code class="literal">START TRANSACTION</code>、<code class="literal">COMMIT</code>、または <code class="literal">ROLLBACK</code> ステートメントに関連付けられたステートメントイベントが完全には含まれていません。 トランザクションイベントとこれらのステートメントの間には、わずかなタイミングの重複があります。 
          </p></li><li class="listitem"><p>
            非トランザクションエンジンで動作するステートメントは、接続のトランザクション状態には影響しません。 暗黙的トランザクションの場合、トランザクションイベントはトランザクションエンジンを使用する最初のステートメントから始まります。 つまり、非トランザクションテーブルで排他的に動作するステートメントは、<code class="literal">START TRANSACTION</code> に続く場合でも無視されます。 
          </p></li></ul></div><p>
        説明するために、次のシナリオを考えてみます:
      </p><pre class="programlisting">1. SET autocommit = OFF;
2. CREATE TABLE t1 (a INT) ENGINE = InnoDB;
3. START TRANSACTION;                       -- Transaction 1 START
4. INSERT INTO t1 VALUES (1), (2), (3);
5. CREATE TABLE t2 (a INT) ENGINE = MyISAM; -- Transaction 1 COMMIT
                                            -- (implicit; DDL forces commit)
6. INSERT INTO t2 VALUES (1), (2), (3);     -- Update nontransactional table
7. UPDATE t2 SET a = a + 1;                 -- ... and again
8. INSERT INTO t1 VALUES (4), (5), (6);     -- Write to transactional table
                                            -- Transaction 2 START (implicit)
9. COMMIT;                                  -- Transaction 2 COMMIT
</pre><p>
        サーバーの観点からは、トランザクション 1 はテーブル <code class="literal">t2</code> が作成されると終了します。 トランザクション 2 は、非トランザクションテーブルへの更新が介在しているにもかかわらず、トランザクションテーブルにアクセスするまで開始されません。 
      </p><p>
        パフォーマンススキーマの観点からは、サーバーがアクティブなトランザクション状態に遷移すると、トランザクション 2 が開始されます。 ステートメント 6 および 7 はトランザクション 2 の境界内に含まれません。これは、サーバーがバイナリログにトランザクションを書き込む方法と一致します。 
      </p><h4><a name="performance-schema-transaction-tables-instrumentation"></a>トランザクション手段</h4><p>
        トランザクションは、次の 3 つの属性で定義されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            アクセスモード (読取り専用、読取り/書込み)
          </p></li><li class="listitem"><p>
            分離レベル (<code class="literal">SERIALIZABLE</code>、<code class="literal">REPEATABLE READ</code> など)
          </p></li><li class="listitem"><p>
            暗黙 (<code class="literal">autocommit</code> が有効) または明示 (<code class="literal">autocommit</code> が無効)
          </p></li></ul></div><p>
        トランザクションインストゥルメンテーションの複雑さを軽減し、収集されたトランザクションデータが完全で意味のある結果を提供するようにするために、すべてのトランザクションはアクセスモード、分離レベルまたは自動コミットモードとは無関係にインストゥルメントされます。
      </p><p>
        トランザクション履歴を選択的に調べるには、トランザクションイベントテーブルの属性カラムを使用: <code class="literal">ACCESS_MODE</code>、<code class="literal">ISOLATION_LEVEL</code> および <code class="literal">AUTOCOMMIT</code>。
      </p><p>
        トランザクションインストゥルメンテーションのコストは、ユーザー、アカウント、ホストまたはスレッド (クライアント接続) に応じたトランザクションインストゥルメンテーションの有効化または無効化など、様々な方法で削減できます。
      </p><h4><a name="performance-schema-transaction-tables-nested-events"></a>トランザクションおよびネストされたイベント</h4><p>
        トランザクションイベントの親は、トランザクションを開始したイベントです。 明示的に開始されたトランザクションの場合、これには <code class="literal">START TRANSACTION</code> および <code class="literal">COMMIT AND CHAIN</code> ステートメントが含まれます。 暗黙的に開始されたトランザクションの場合は、前のトランザクションの終了後にトランザクションエンジンを使用する最初のステートメントです。 
      </p><p>
        一般に、トランザクションは、<code class="literal">COMMIT</code> や <code class="literal">ROLLBACK</code> などのトランザクションを明示的に終了するステートメントを含め、トランザクション中に開始されるすべてのイベントの最上位レベルの親です。 例外は、DDL ステートメントなど、トランザクションを暗黙的に終了するステートメントです。この場合、新しいステートメントを実行する前に現在のトランザクションをコミットする必要があります。 
      </p><h4><a name="performance-schema-transaction-tables-stored-programs"></a>トランザクションとストアドプログラム</h4><p>
        トランザクションおよびストアドプログラムイベントは、次のように関連付けられます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ストアドプロシージャ
          </p><p>
            ストアドプロシージャは、トランザクションとは無関係に動作します。 ストアドプロシージャはトランザクション内で開始でき、トランザクションはストアドプロシージャ内から開始または終了できます。 ストアドプロシージャは、トランザクション内からコールされた場合、親トランザクションのコミットを強制するステートメントを実行し、新しいトランザクションを開始できます。 
          </p><p>
            ストアドプロシージャがトランザクション内で開始された場合、そのトランザクションはストアドプロシージャイベントの親になります。
          </p><p>
            ストアドプロシージャによってトランザクションが開始された場合、ストアドプロシージャはトランザクションイベントの親です。
          </p></li><li class="listitem"><p>
            ストアドファンクション
          </p><p>
            ストアドファンクションは、明示的または暗黙的なコミットまたはロールバックの原因に制限されています。 ストアドファンクションイベントは、親トランザクションイベント内に存在できます。 
          </p></li><li class="listitem"><p>
            トリガー
          </p><p>
            トリガーは、関連付けられているテーブルにアクセスするステートメントの一部としてアクティブ化されるため、トリガーイベントの親は常に、トリガーイベントをアクティブ化するステートメントです。
          </p><p>
            トリガーは、トランザクションを明示的または暗黙的にコミットまたはロールバックするステートメントを発行できません。
          </p></li><li class="listitem"><p>
            予定イベント
          </p><p>
            スケジュール済みイベントの本文でのステートメントの実行は、新しい接続で行われます。 親トランザクション内でのスケジュール済イベントのネストは適用できません。 
          </p></li></ul></div><h4><a name="performance-schema-transaction-tables-savepoints"></a>トランザクションとセーブポイント</h4><p>
        セーブポイントステートメントは、個別のステートメントイベントとして記録されます。 トランザクションイベントには、トランザクション中に発行された <code class="literal">SAVEPOINT</code>、<code class="literal">ROLLBACK TO SAVEPOINT</code> および <code class="literal">RELEASE SAVEPOINT</code> ステートメントの個別のカウンタが含まれます。 
      </p><h4><a name="performance-schema-transaction-tables-errors"></a>トランザクションおよびエラー</h4><p>
        トランザクション内で発生したエラーおよび警告は、ステートメントイベントに記録されますが、対応するトランザクションイベントには記録されません。 これには、非トランザクションテーブルでのロールバックや GTID 整合性エラーなど、トランザクション固有のエラーおよび警告が含まれます。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-transactions-current-table"></a>27.12.7.1 events_transactions_current テーブル</h4></div></div></div><a class="indexterm" name="idm45882610115392"></a><a class="indexterm" name="idm45882610113216"></a><p>
          <code class="literal">events_transactions_current</code> テーブルには、現在のトランザクションイベントが含まれます。 テーブルには、スレッドごとに最新の監視対象トランザクションイベントの現在のステータスを示す 1 行が格納されるため、テーブルサイズを構成するためのシステム変数はありません。 例: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_transactions_current LIMIT 1\G</code></strong>
*************************** 1. row ***************************
                      THREAD_ID: 26
                       EVENT_ID: 7
                   END_EVENT_ID: NULL
                     EVENT_NAME: transaction
                          STATE: ACTIVE
                         TRX_ID: NULL
                           GTID: 3E11FA47-71CA-11E1-9E33-C80AA9429562:56
                            XID: NULL
                       XA_STATE: NULL
                         SOURCE: transaction.cc:150
                    TIMER_START: 420833537900000
                      TIMER_END: NULL
                     TIMER_WAIT: NULL
                    ACCESS_MODE: READ WRITE
                ISOLATION_LEVEL: REPEATABLE READ
                     AUTOCOMMIT: NO
           NUMBER_OF_SAVEPOINTS: 0
NUMBER_OF_ROLLBACK_TO_SAVEPOINT: 0
    NUMBER_OF_RELEASE_SAVEPOINT: 0
          OBJECT_INSTANCE_BEGIN: NULL
               NESTING_EVENT_ID: 6
             NESTING_EVENT_TYPE: STATEMENT
</pre><p>
          トランザクションイベント行を含むテーブルの中で、最も基本的なのは <code class="literal">events_transactions_current</code> です。 トランザクションイベント行を含む他のテーブルは、現在のイベントから論理的に導出されます。 たとえば、<code class="literal">events_transactions_history</code> テーブルと <code class="literal">events_transactions_history_long</code> テーブルは、終了した最新のトランザクションイベントのコレクションで、スレッド当たりの最大行数まで、およびすべてのスレッドにわたってグローバルに終了します。 
        </p><p>
          3 つのトランザクションイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          トランザクションイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-transaction-tables" title="27.12.7 パフォーマンススキーマのトランザクションテーブル">セクション27.12.7「パフォーマンススキーマのトランザクションテーブル」</a> を参照してください。
        </p><p>
          <code class="literal">events_transactions_current</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。 ともに取得される <code class="literal">THREAD_ID</code> と <code class="literal">EVENT_ID</code> の値によって、行が一意に識別されます。 同じ値のペアを持つ行は 2 つありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントが収集されたインストゥルメントの名前。 これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。 <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="27.6 パフォーマンススキーマインストゥルメント命名規則">セクション27.6「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。 
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              現在のトランザクションの状態。 値は、<code class="literal">ACTIVE</code> (<code class="literal">START TRANSACTION</code> または <code class="literal">BEGIN</code> の後)、<code class="literal">COMMITTED</code> (<code class="literal">COMMIT</code> の後) または <code class="literal">ROLLED BACK</code> (<code class="literal">ROLLBACK</code> の後) です。 
            </p></li><li class="listitem"><p>
              <code class="literal">TRX_ID</code>
            </p><p>
              使用されません。
            </p></li><li class="listitem"><p>
              <code class="literal">GTID</code>
            </p><p>
              GTID カラムには <code class="literal">gtid_next</code> の値が含まれ、<code class="literal">ANONYMOUS</code>、<code class="literal">AUTOMATIC</code> または GTID のいずれかを <code class="literal">UUID:NUMBER</code> の形式で指定できます。 <code class="literal">gtid_next=AUTOMATIC</code>(すべての通常のクライアントトランザクション) を使用するトランザクションの場合、GTID カラムは、トランザクションがコミットされ、実際の GTID が割り当てられると変更されます。 <code class="literal">gtid_mode</code> が <code class="literal">ON</code> または <code class="literal">ON_PERMISSIVE</code> の場合、GTID カラムはトランザクション GTID に変更されます。 <code class="literal">gtid_mode</code> が <code class="literal">OFF</code> または <code class="literal">OFF_PERMISSIVE</code> の場合、GTID カラムは <code class="literal">ANONYMOUS</code> に変更されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">XID_FORMAT_ID</code>、<code class="literal">XID_GTRID</code> および <code class="literal">XID_BQUAL</code>
            </p><p>
              XA トランザクション識別子の要素。 これらの形式は、<a class="xref" href="sql-statements.html#xa-statements" title="13.3.8.1 XA トランザクション SQL ステートメント">セクション13.3.8.1「XA トランザクション SQL ステートメント」</a> で説明されている形式です。 
            </p></li><li class="listitem"><p>
              <code class="literal">XA_STATE</code>
            </p><p>
              XA トランザクションの状態。 値は、<code class="literal">ACTIVE</code> (<code class="literal">XA START</code> の後)、<code class="literal">IDLE</code> (<code class="literal">XA END</code> の後)、<code class="literal">PREPARED</code> (<code class="literal">XA PREPARE</code> の後)、<code class="literal">ROLLED BACK</code> (<code class="literal">XA ROLLBACK</code> の後) または <code class="literal">COMMITTED</code> (<code class="literal">XA COMMIT</code> の後) です。 
            </p><p>
              レプリカでは、<code class="literal">events_transactions_current</code> テーブルに同じ XA トランザクションが表示され、スレッドごとに状態が異なる場合があります。 これは、XA トランザクションが準備された直後にレプリカアプライヤスレッドからデタッチされ、レプリカ上の任意のスレッドによってコミットまたはロールバックできるためです。 <code class="literal">events_transactions_current</code> テーブルには、スレッド上の最新の監視対象トランザクションイベントの現在のステータスが表示され、スレッドがアイドル状態の場合、このステータスは更新されません。 そのため、XA トランザクションは、別のスレッドによって処理された後も、元のアプライヤスレッドの <code class="literal">PREPARED</code> 状態で表示できます。 <code class="literal">PREPARED</code> 状態のままでリカバリが必要な XA トランザクションを肯定的に識別するには、パフォーマンススキーマトランザクションテーブルではなく、<code class="literal">XA RECOVER</code> ステートメントを使用します。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。 これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。 これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。 <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。 <code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。 
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> は現在のタイマー値で、<code class="literal">TIMER_WAIT</code> はこれまでに経過した時間です (<code class="literal">TIMER_END</code> - <code class="literal">TIMER_START</code>)。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">ACCESS_MODE</code>
            </p><p>
              トランザクションアクセスモード。 値は <code class="literal">READ WRITE</code> または <code class="literal">READ ONLY</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">ISOLATION_LEVEL</code>
            </p><p>
              トランザクション分離レベル。 値は <code class="literal">REPEATABLE READ</code>, <code class="literal">READ COMMITTED</code>, <code class="literal">READ UNCOMMITTED</code> または <code class="literal">SERIALIZABLE</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">AUTOCOMMIT</code>
            </p><p>
              トランザクションの開始時に autcommit モードが有効化されたかどうか。
            </p></li><li class="listitem"><p>
              <code class="literal">NUMBER_OF_SAVEPOINTS</code>, <code class="literal">NUMBER_OF_ROLLBACK_TO_SAVEPOINT</code>, <code class="literal">NUMBER_OF_RELEASE_SAVEPOINT</code>
            </p><p>
              トランザクション中に発行された <code class="literal">SAVEPOINT</code>、<code class="literal">ROLLBACK TO SAVEPOINT</code> および <code class="literal">RELEASE SAVEPOINT</code> ステートメントの数。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              使用されません。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              このイベントが中にネストされているイベントの <code class="literal">EVENT_ID</code> 値。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              ネストしているイベントの種類。 値は <code class="literal">TRANSACTION</code>, <code class="literal">STATEMENT</code>, <code class="literal">STAGE</code> または <code class="literal">WAIT</code> です。 (トランザクションはネストできないため、<code class="literal">TRANSACTION</code> は表示されません。) 
            </p></li></ul></div><p>
          <code class="literal">events_transactions_current</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_transactions_current</code> テーブルに対して許可されています。 行が削除されます。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-transactions-history-table"></a>27.12.7.2 events_transactions_history テーブル</h4></div></div></div><a class="indexterm" name="idm45882609984000"></a><a class="indexterm" name="idm45882609981824"></a><p>
          <code class="literal">events_transactions_history</code> テーブルには、スレッドごとに終了した <em class="replaceable"><code>N</code></em> の最新のトランザクションイベントが含まれます。 トランザクションイベントは、終了するまでテーブルに追加されません。 テーブルに特定のスレッドの最大行数が含まれている場合、そのスレッドの新しい行が追加されると、最も古いスレッド行は破棄されます。 スレッドが終了すると、そのすべての行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、サーバーの起動時に <em class="replaceable"><code>N</code></em> の値を自動サイズ調整します。 スレッドごとの行数を明示的に設定するには、サーバーの起動時に <code class="literal">performance_schema_events_transactions_history_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_transactions_history</code> テーブルには、<code class="literal">events_transactions_current</code> と同じカラムおよびインデックス付けがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-transactions-current-table" title="27.12.7.1 events_transactions_current テーブル">セクション27.12.7.1「events_transactions_current テーブル」</a>を参照してください。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_transactions_history</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つのトランザクションイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          トランザクションイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-transaction-tables" title="27.12.7 パフォーマンススキーマのトランザクションテーブル">セクション27.12.7「パフォーマンススキーマのトランザクションテーブル」</a> を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-events-transactions-history-long-table"></a>27.12.7.3 events_transactions_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm45882609964912"></a><a class="indexterm" name="idm45882609962656"></a><p>
          <code class="literal">events_transactions_history_long</code> テーブルには、すべてのスレッドでグローバルに終了した <em class="replaceable"><code>N</code></em> の最新のトランザクションイベントが含まれます。 トランザクションイベントは、終了するまでテーブルに追加されません。 テーブルがいっぱいになると、どちらのスレッドがどちらの行を生成したかに関係なく、新しい行が追加されたときにもっとも古い行が破棄されます。 
        </p><p>
          パフォーマンススキーマは、<em class="replaceable"><code>N</code></em> の値をサーバーの起動時に自動サイズ調整します。 テーブルサイズを明示的に設定するには、サーバーの起動時に <code class="literal">performance_schema_events_transactions_history_long_size</code> システム変数を設定します。 
        </p><p>
          <code class="literal">events_transactions_history_long</code> テーブルには、<code class="literal">events_transactions_current</code> と同じカラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-events-transactions-current-table" title="27.12.7.1 events_transactions_current テーブル">セクション27.12.7.1「events_transactions_current テーブル」</a>を参照してください。 <code class="literal">events_transactions_current</code> とは異なり、<code class="literal">events_transactions_history_long</code> にはインデックス付けはありません。 
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">events_transactions_history_long</code> テーブルに対して許可されています。 行が削除されます。 
        </p><p>
          3 つのトランザクションイベントテーブル間の関係の詳細は、<a class="xref" href="performance-schema.html#performance-schema-event-tables" title="27.9 現在および過去のイベントのパフォーマンススキーマテーブル">セクション27.9「現在および過去のイベントのパフォーマンススキーマテーブル」</a> を参照してください。
        </p><p>
          トランザクションイベントを収集するかどうかの構成の詳細は、<a class="xref" href="performance-schema.html#performance-schema-transaction-tables" title="27.12.7 パフォーマンススキーマのトランザクションテーブル">セクション27.12.7「パフォーマンススキーマのトランザクションテーブル」</a> を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-connection-tables"></a>27.12.8 パフォーマンススキーマ接続テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-accounts-table">27.12.8.1 accounts テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-hosts-table">27.12.8.2 hosts テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-users-table">27.12.8.3 users テーブル</a></span></dt></dl></div><p>
        クライアントは、MySQL サーバーに接続すると、特定のユーザー名で特定のホストから接続します。 パフォーマンススキーマは、次のテーブルを使用して、これらの接続に関する統計情報を提供し、アカウント (ユーザーとホストの組み合わせ) ごとに追跡したり、ユーザー名とホスト名ごとに個別に追跡したりします: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">accounts</code>: クライアントアカウントごとの接続統計
          </p></li><li class="listitem"><p>
            <code class="literal">hosts</code>: クライアントホスト名ごとの接続統計
          </p></li><li class="listitem"><p>
            <code class="literal">users</code>: クライアントユーザー名ごとの接続統計
          </p></li></ul></div><p>
        接続テーブルの <span class="quote">「<span class="quote">account</span>」</span> の意味は、<code class="literal">mysql</code> システムデータベースの MySQL 付与テーブルでの意味と似ていますが、この用語はユーザーとホストの値の組合せを意味します。 権限付与テーブルの場合、アカウントのホスト部分はパターンにできますが、「パフォーマンススキーマ」テーブルの場合、ホスト値は常に特定のパターン以外のホスト名になります。 
      </p><p>
        各接続テーブルには、統計の基になる<span class="quote">「<span class="quote">「トラッキング値」</span>」</span>当たりの現在の接続数および合計接続数を追跡するための <code class="literal">CURRENT_CONNECTIONS</code> カラムと <code class="literal">TOTAL_CONNECTIONS</code> カラムがあります。 テーブルは、それらが追跡値に使用するものに違いがあります。 <code class="literal">accounts</code> テーブルには、ユーザーとホストの組合せごとに接続を追跡するための <code class="literal">USER</code> カラムと <code class="literal">HOST</code> カラムがあります。 <code class="literal">users</code> テーブルと <code class="literal">hosts</code> テーブルには、ユーザー名とホスト名ごとに接続を追跡するための <code class="literal">USER</code> カラムと <code class="literal">HOST</code> カラムがそれぞれあります。 
      </p><p>
        パフォーマンススキーマは、<code class="literal">NULL</code> の <code class="literal">USER</code> および <code class="literal">HOST</code> カラム値を持つ行を使用して、認証に失敗したユーザーセッションの内部スレッドとスレッドもカウントします。
      </p><p>
        <code class="literal">user1</code> と <code class="literal">user2</code> というクライアントがそれぞれ <code class="literal">hosta</code> と <code class="literal">hostb</code> から一度に接続するとします。 パフォーマンススキーマは次のように接続を追跡します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">accounts</code> テーブルには、<code class="literal">user1</code>/<code class="literal">hosta</code>、<code class="literal">user1</code>/<code class="literal">hostb</code>、<code class="literal">user2</code>/<code class="literal">hosta</code> および <code class="literal">user2</code>/<code class="literal">hostb</code> アカウント値について、各行でアカウントごとに 1 つの接続がカウントされる 4 つの行があります。
          </p></li><li class="listitem"><p>
            <code class="literal">hosts</code> テーブルには 2 つの行があり、<code class="literal">hosta</code> および <code class="literal">hostb</code> の場合、各行はホスト名ごとに 2 つの接続をカウントします。
          </p></li><li class="listitem"><p>
            <code class="literal">users</code> テーブルには 2 つの行があり、<code class="literal">user1</code> および <code class="literal">user2</code> の場合、各行はユーザー名ごとに 2 つの接続をカウントします。
          </p></li></ul></div><p>
        クライアントが接続すると、パフォーマンススキーマは、各テーブルに適した追跡値を使用して、各接続テーブルのどの行が適用されるかを決定します。 そのような行がない場合、追加されます。 次に、パフォーマンススキーマはその行の <code class="literal">CURRENT_CONNECTIONS</code> および <code class="literal">TOTAL_CONNECTIONS</code> カラムを 1 つ増分します。 
      </p><p>
        クライアントが切断すると、パフォーマンススキーマはその行の <code class="literal">CURRENT_CONNECTIONS</code> カラムを 1 つ減分し、<code class="literal">TOTAL_CONNECTIONS</code> カラムは変更しないままにします。
      </p><p>
        <code class="literal">TRUNCATE TABLE</code> は接続テーブルに対して許可されます。 これには次の効果があります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            現在の接続を持たないアカウント、ホストまたはユーザー (<code class="literal">CURRENT_CONNECTIONS = 0</code> の行) の行は削除されます。
          </p></li><li class="listitem"><p>
            削除されていない行はリセットされ、現在の接続のみがカウントされます: <code class="literal">CURRENT_CONNECTIONS &gt; 0</code> の行の場合、<code class="literal">TOTAL_CONNECTIONS</code> は <code class="literal">CURRENT_CONNECTIONS</code> にリセットされます。
          </p></li><li class="listitem"><p>
            このセクションの後半で説明するように、接続テーブルに依存するサマリーテーブルは暗黙的に切り捨てられます。
          </p></li></ul></div><p>
        パフォーマンススキーマは、アカウント、ホスト、またはユーザーごとにさまざまなイベントタイプの接続統計を集約するサマリーテーブルを保持します。 これらのテーブルの名前には、<code class="literal">_summary_by_account</code>、<code class="literal">_summary_by_host</code> または<code class="literal">_summary_by_user</code> が含まれます。 識別するには、次のクエリーを使用します: 
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
       <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema'</code></strong>
       <strong class="userinput"><code>AND TABLE_NAME REGEXP '_summary_by_(account|host|user)'</code></strong>
       <strong class="userinput"><code>ORDER BY TABLE_NAME;</code></strong>
+------------------------------------------------------+
| TABLE_NAME                                           |
+------------------------------------------------------+
| events_errors_summary_by_account_by_error            |
| events_errors_summary_by_host_by_error               |
| events_errors_summary_by_user_by_error               |
| events_stages_summary_by_account_by_event_name       |
| events_stages_summary_by_host_by_event_name          |
| events_stages_summary_by_user_by_event_name          |
| events_statements_summary_by_account_by_event_name   |
| events_statements_summary_by_host_by_event_name      |
| events_statements_summary_by_user_by_event_name      |
| events_transactions_summary_by_account_by_event_name |
| events_transactions_summary_by_host_by_event_name    |
| events_transactions_summary_by_user_by_event_name    |
| events_waits_summary_by_account_by_event_name        |
| events_waits_summary_by_host_by_event_name           |
| events_waits_summary_by_user_by_event_name           |
| memory_summary_by_account_by_event_name              |
| memory_summary_by_host_by_event_name                 |
| memory_summary_by_user_by_event_name                 |
+------------------------------------------------------+
</pre><p>
        個々の接続サマリーテーブルの詳細は、サマリーが作成されたイベントタイプのテーブルについて説明しているセクションを参照してください:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            待機イベントのサマリー: <a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a>
          </p></li><li class="listitem"><p>
            ステージイベントサマリー: <a class="xref" href="performance-schema.html#performance-schema-stage-summary-tables" title="27.12.18.2 ステージサマリーテーブル">セクション27.12.18.2「ステージサマリーテーブル」</a>
          </p></li><li class="listitem"><p>
            ステートメントイベントサマリー: <a class="xref" href="performance-schema.html#performance-schema-statement-summary-tables" title="27.12.18.3 ステートメントサマリーテーブル">セクション27.12.18.3「ステートメントサマリーテーブル」</a>
          </p></li><li class="listitem"><p>
            トランザクションイベントサマリー: <a class="xref" href="performance-schema.html#performance-schema-transaction-summary-tables" title="27.12.18.5 トランザクション要約テーブル">セクション27.12.18.5「トランザクション要約テーブル」</a>
          </p></li><li class="listitem"><p>
            メモリーイベントサマリー: <a class="xref" href="performance-schema.html#performance-schema-memory-summary-tables" title="27.12.18.10 メモリーサマリーテーブル">セクション27.12.18.10「メモリーサマリーテーブル」</a>
          </p></li><li class="listitem"><p>
            エラーイベントサマリー: <a class="xref" href="performance-schema.html#performance-schema-error-summary-tables" title="27.12.18.11 エラー要約テーブル">セクション27.12.18.11「エラー要約テーブル」</a>
          </p></li></ul></div><p>
        <code class="literal">TRUNCATE TABLE</code> は接続サマリーテーブルに使用できます。 接続のないアカウント、ホストまたはユーザーの行を削除し、残りの行のサマリーカラムをゼロにリセットします。 また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各サマリーテーブルは、依存する接続テーブルの切捨てによって暗黙的に切り捨てられます。 次のテーブルに、接続テーブルの切捨てと暗黙的に切り捨てられたテーブルの関係を示します。 
      </p><div class="table"><a name="idm45882609870320"></a><p class="title"><b>表 27.2 接続テーブルの切捨ての暗黙的な影響</b></p><div class="table-contents"><table summary="Which Performance Schema summary tables are implicity truncated by connection table truncation."><col width="40%"><col width="60%"><thead><tr>
            <th>切り捨てられた接続テーブル</th>
            <th>暗黙的に切り捨てられたサマリーテーブル</th>
          </tr></thead><tbody><tr>
            <td><code class="literal">accounts</code></td>
            <td><code class="literal">_summary_by_account</code>、<code class="literal">_summary_by_thread</code> を含む名前を持つテーブル</td>
          </tr><tr>
            <td><code class="literal">hosts</code></td>
            <td><code class="literal">_summary_by_account</code>, <code class="literal">_summary_by_host</code>, <code class="literal">_summary_by_thread</code> を含む名前を持つテーブル</td>
          </tr><tr>
            <td><code class="literal">users</code></td>
            <td><code class="literal">_summary_by_account</code>, <code class="literal">_summary_by_user</code>, <code class="literal">_summary_by_thread</code> を含む名前を持つテーブル</td>
          </tr></tbody></table></div></div><br class="table-break"><p>
        <code class="literal">_summary_global</code> サマリーテーブルを切り捨てると、対応する接続およびスレッドサマリーテーブルも暗黙的に切り捨てられます。 たとえば、<code class="literal">events_waits_summary_global_by_event_name</code> を切り捨てると、アカウント、ホスト、ユーザーまたはスレッドごとに集計された待機イベントサマリーテーブルが暗黙的に切り捨てられます。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-accounts-table"></a>27.12.8.1 accounts テーブル</h4></div></div></div><a class="indexterm" name="idm45882609847616"></a><a class="indexterm" name="idm45882609845440"></a><p>
          <code class="literal">accounts</code> テーブルは、MySQL サーバーに接続した各アカウントの行を格納します。 各アカウントについて、テーブルは現在と合計の接続数をカウントします。 テーブルサイズはサーバー起動時に自動サイズ設定されます。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_accounts_size</code> システム変数を設定します。 アカウント統計を無効にするには、この変数を 0 に設定します。 
        </p><p>
          <code class="literal">accounts</code> テーブルには次のカラムがあります。 <code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              接続のクライアントユーザー名。 これは、内部スレッドまたは認証に失敗したユーザーセッションの <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              クライアントの接続元のホスト。 これは、内部スレッドまたは認証に失敗したユーザーセッションの <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              アカウントの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              アカウントの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">accounts</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">USER</code>、<code class="literal">HOST</code>)
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-hosts-table"></a>27.12.8.2 hosts テーブル</h4></div></div></div><a class="indexterm" name="idm45882609821136"></a><a class="indexterm" name="idm45882609818976"></a><p>
          <code class="literal">hosts</code> テーブルは、クライアントが MySQL サーバーに接続している各ホストの行を格納します。 各ホスト名について、テーブルは現在と合計の接続数をカウントします。 テーブルサイズはサーバー起動時に自動サイズ設定されます。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_hosts_size</code> システム変数を設定します。 ホスト統計を無効にするには、この変数を 0 に設定します。 
        </p><p>
          <code class="literal">hosts</code> テーブルには次のカラムがあります。 <code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              クライアントの接続元のホスト。 これは、内部スレッドまたは認証に失敗したユーザーセッションの <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              ホストの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              ホストの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">hosts</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">HOST</code>)
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-users-table"></a>27.12.8.3 users テーブル</h4></div></div></div><a class="indexterm" name="idm45882609798496"></a><a class="indexterm" name="idm45882609796336"></a><p>
          <code class="literal">users</code> テーブルは、MySQL サーバーに接続している各ユーザーの行を格納します。 各ユーザー名について、テーブルは現在と合計の接続数をカウントします。 テーブルサイズはサーバー起動時に自動サイズ設定されます。 テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_users_size</code> システム変数を設定します。 ユーザー統計を無効にするには、この変数を 0 に設定します。 
        </p><p>
          <code class="literal">users</code> テーブルには次のカラムがあります。 <code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              接続のクライアントユーザー名。 これは、内部スレッドまたは認証に失敗したユーザーセッションの <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              ユーザーの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              ユーザーの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">users</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">USER</code>)
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-connection-attribute-tables"></a>27.12.9 パフォーマンススキーマ接続属性テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-session-account-connect-attrs-table">27.12.9.1 session_account_connect_attrs テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-session-connect-attrs-table">27.12.9.2 session_connect_attrs テーブル</a></span></dt></dl></div><p>
        接続属性は、アプリケーションプログラムが接続時にサーバーに渡すことができるキーと値のペアです。 <code class="literal">libmysqlclient</code> クライアントライブラリによって実装される C API に基づくアプリケーションの場合、<code class="literal">mysql_options()</code> および <code class="literal">mysql_options4()</code> 関数によって接続属性セットが定義されます。 他の MySQL コネクタは、独自の属性定義メソッドを提供する場合があります。 
      </p><p>
        「これらのパフォーマンススキーマ」テーブルでは、属性情報が公開されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">session_account_connect_attrs</code>: 現在のセッションおよびセッションアカウントに関連付けられている他のセッションの接続属性
          </p></li><li class="listitem"><p>
            <code class="literal">session_connect_attrs</code>: すべてのセッションの接続属性。
          </p></li></ul></div><p>
        また、監査ログに書き込まれる接続イベントには、接続属性が含まれる場合があります。 <a class="xref" href="security.html#audit-log-file-formats" title="6.4.5.4 監査ログファイル形式">セクション6.4.5.4「監査ログファイル形式」</a>を参照してください。 
      </p><p>
        アンダースコア (<code class="literal">_</code>) で始まる属性名は内部使用のために予約されているため、アプリケーションプログラムで作成しないでください。 この規則により、アプリケーション属性と競合せずに MySQL で新しい属性を導入でき、内部属性と競合しない独自の属性をアプリケーションプログラムで定義できます。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-connection-attributes-available" title="使用可能な接続属性">使用可能な接続属性</a></p></li><li class="listitem"><p><a class="xref" href="performance-schema.html#performance-schema-connection-attribute-limits" title="接続属性制限">接続属性制限</a></p></li></ul></div><h4><a name="performance-schema-connection-attributes-available"></a>使用可能な接続属性</h4><p>
        特定の接続内に表示される接続属性のセットは、プラットフォーム、接続の確立に使用される MySQL Connector、クライアントプログラムなどの要因によって異なります。
      </p><p>
        <code class="literal">libmysqlclient</code> クライアントライブラリは、次の属性を設定します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">_client_name</code>: クライアント名 (クライアントライブラリの <code class="literal">libmysql</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">_client_version</code>: クライアントライブラリのバージョン。
          </p></li><li class="listitem"><p>
            <code class="literal">_os</code>: オペレーティングシステム (<code class="literal">Linux</code>、<code class="literal">Win64</code> など)。
          </p></li><li class="listitem"><p>
            <code class="literal">_pid</code>: クライアントプロセス ID。
          </p></li><li class="listitem"><p>
            <code class="literal">_platform</code>: マシンプラットフォーム (例: <code class="literal">x86_64</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">_thread</code>: クライアントスレッド ID (Windows のみ)。
          </p></li></ul></div><p>
        他の MySQL コネクタでは、独自の接続属性を定義できます。
      </p><p>
        MySQL Connector/C++ 8.0.16 以上では、X DevAPI または X DevAPI for C を使用するアプリケーションに対して次の属性が定義されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">_client_license</code>: コネクタライセンス (<code class="literal">GPL-2.0</code> など)。
          </p></li><li class="listitem"><p>
            <code class="literal">_client_name</code>: コネクタ名 (<code class="literal">mysql-connector-cpp</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">_client_version</code>: コネクタバージョン。
          </p></li><li class="listitem"><p>
            <code class="literal">_os</code>: オペレーティングシステム (<code class="literal">Linux</code>、<code class="literal">Win64</code> など)。
          </p></li><li class="listitem"><p>
            <code class="literal">_pid</code>: クライアントプロセス ID。
          </p></li><li class="listitem"><p>
            <code class="literal">_platform</code>: マシンプラットフォーム (例: <code class="literal">x86_64</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">_source_host</code>: クライアントが実行されているマシンのホスト名。
          </p></li><li class="listitem"><p>
            <code class="literal">_thread</code>: クライアントスレッド ID (Windows のみ)。
          </p></li></ul></div><p><a name="performance-schema-connection-attributes-cj"></a>
        MySQL Connector/J では、次の属性が定義されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">_client_name</code>: クライアント名
          </p></li><li class="listitem"><p>
            <code class="literal">_client_version</code>: クライアントライブラリバージョン
          </p></li><li class="listitem"><p>
            <code class="literal">_os</code>: オペレーティングシステム (<code class="literal">Linux</code>、<code class="literal">Win64</code> など)
          </p></li><li class="listitem"><p>
            <code class="literal">_client_license</code>: コネクタライセンスタイプ
          </p></li><li class="listitem"><p>
            <code class="literal">_platform</code>: マシンプラットフォーム (<code class="literal">x86_64</code> など)
          </p></li><li class="listitem"><p>
            <code class="literal">_runtime_vendor</code>: Java ランタイム環境 (JRE) ベンダー
          </p></li><li class="listitem"><p>
            <code class="literal">_runtime_version</code>: Java ランタイム環境 (JRE) のバージョン
          </p></li></ul></div><p>
        MySQL Connector/NET では、次の属性が定義されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">_client_version</code>: クライアントライブラリのバージョン。
          </p></li><li class="listitem"><p>
            <code class="literal">_os</code>: オペレーティングシステム (<code class="literal">Linux</code>、<code class="literal">Win64</code> など)。
          </p></li><li class="listitem"><p>
            <code class="literal">_pid</code>: クライアントプロセス ID。
          </p></li><li class="listitem"><p>
            <code class="literal">_platform</code>: マシンプラットフォーム (例: <code class="literal">x86_64</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">_program_name</code>: クライアント名。
          </p></li><li class="listitem"><p>
            <code class="literal">_thread</code>: クライアントスレッド ID (Windows のみ)。
          </p></li></ul></div><p>
        PHP は、コンパイル方法に依存する属性を定義します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">libmysqlclient</code> を使用してコンパイル: 前に説明した標準の <code class="literal">libmysqlclient</code> 属性。
          </p></li><li class="listitem"><p>
            <code class="literal">mysqlnd</code> を使用してコンパイル: <code class="literal">mysqlnd</code> の値を持つ<code class="literal">_client_name</code> 属性のみ。
          </p></li></ul></div><p>
        多くの MySQL クライアントプログラムは、クライアント名と等しい値を持つ <code class="literal">program_name</code> 属性を設定します。 たとえば、<span class="command"><strong>mysqladmin</strong></span> および <span class="command"><strong>mysqldump</strong></span> は、<code class="literal">program_name</code> を <code class="literal">mysqladmin</code> および <code class="literal">mysqldump</code> にそれぞれ設定します。MySQL Shell は、<code class="literal">program_name</code> を <code class="literal">mysqlsh</code> に設定します。 
      </p><p>
        一部の MySQL クライアントプログラムでは、追加の属性が定義されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="command"><strong>mysql</strong></span> (MySQL 8.0.17 の時点):
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">os_user</code>: プログラムを実行しているオペレーティングシステムユーザーの名前。 Unix および Unix に似たシステムおよび Windows で使用できます。 
              </p></li><li class="listitem"><p>
                <code class="literal">os_sudouser</code>: <code class="literal">SUDO_USER</code> 環境変数の値。 Unix および Unix に似たシステムで使用できます。 
              </p><a class="indexterm" name="idm45882609680352"></a><a class="indexterm" name="idm45882609678848"></a></li></ul></div><p>
            値が空の <span class="command"><strong>mysql</strong></span> 接続属性は送信されません。
          </p></li><li class="listitem"><p>
            <span class="command"><strong>mysqlbinlog</strong></span>:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">_client_role</code>: <code class="literal">binary_log_listener</code>
              </p></li></ul></div></li><li class="listitem"><p>
            レプリカ接続:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">program_name</code>: <code class="literal">mysqld</code>
              </p></li><li class="listitem"><p>
                <code class="literal">_client_role</code>: <code class="literal">binary_log_listener</code>
              </p></li><li class="listitem"><p>
                <code class="literal">_client_replication_channel_name</code>: チャネル名。
              </p></li></ul></div></li><li class="listitem"><p>
            <code class="literal">FEDERATED</code> ストレージエンジン接続:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">program_name</code>: <code class="literal">mysqld</code>
              </p></li><li class="listitem"><p>
                <code class="literal">_client_role</code>: <code class="literal">federated_storage</code>
              </p></li></ul></div></li></ul></div><h4><a name="performance-schema-connection-attribute-limits"></a>接続属性制限</h4><p>
        クライアントからサーバーに送信される接続属性データの量には制限があります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            接続時間の前にクライアントによって課される固定制限。
          </p></li><li class="listitem"><p>
            接続時にサーバーによって課される固定制限。
          </p></li><li class="listitem"><p>
            接続時にパフォーマンススキーマによって課される構成可能な制限。
          </p></li></ul></div><p>
        C API を使用して開始された接続の場合、<code class="literal">libmysqlclient</code> ライブラリでは、クライアント側の接続属性データの集計サイズに 64KB の制限が課されます: この制限を超える <code class="literal">mysql_options()</code> をコールすると、<code class="literal">CR_INVALID_PARAMETER_NO</code> エラーが発生します。 他の MySQL コネクタでは、サーバーに送信できる接続属性データの量に独自のクライアント側制限が課される場合があります。 
      </p><p>
        サーバー側では、接続属性データに対する次のサイズチェックが行われます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            サーバーは、受け入れる接続属性データの集計サイズに 64KB の制限を課します。 クライアントが 64KB を超える属性データを送信しようとすると、サーバーは接続を拒否します。 それ以外の場合、サーバーは属性バッファが有効であるとみなし、<code class="literal">Performance_schema_session_connect_attrs_longest_seen</code> ステータス変数で最も長いバッファのサイズを追跡します。 
          </p></li><li class="listitem"><p>
            受け入れられる接続の場合、パフォーマンススキーマは <code class="literal">performance_schema_session_connect_attrs_size</code> システム変数の値に対して集約属性サイズをチェックします。 属性サイズがこの値を超えると、次のアクションが実行されます: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                パフォーマンススキーマは属性データを切り捨て、<code class="literal">Performance_schema_session_connect_attrs_lost</code> ステータス変数を増分します。これは、属性の切り捨てが発生した接続の数を示します。
              </p></li><li class="listitem"><p>
                <code class="literal">log_error_verbosity</code> システム変数が 1 より大きい場合、パフォーマンススキーマはエラーメッセージをエラーログに書き込みます:
              </p><pre class="programlisting">Connection attributes of length <em class="replaceable"><code>N</code></em> were truncated
(<em class="replaceable"><code>N</code></em> bytes lost)
for connection <em class="replaceable"><code>N</code></em>, user <em class="replaceable"><code>user_name</code></em>@<em class="replaceable"><code>host_name</code></em>
(as <em class="replaceable"><code>user_name</code></em>), auth: {yes|no}
</pre><p>
                警告メッセージの情報は、DBA が属性の切捨てが発生したクライアントを識別するのに役立ちます。
              </p></li><li class="listitem"><p>
                属性バッファに十分な領域がある場合は、失われたバイト数を示す値とともに<code class="literal">_truncated</code> 属性がセッション属性に追加されます。 これにより、パフォーマンススキーマは接続属性テーブルで接続ごとの切り捨て情報を公開できます。 この情報は、エラーログを確認せずに調べることができます。 
              </p></li></ul></div></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-session-account-connect-attrs-table"></a>27.12.9.1 session_account_connect_attrs テーブル</h4></div></div></div><a class="indexterm" name="idm45882609629920"></a><a class="indexterm" name="idm45882609627744"></a><p>
          アプリケーションプログラムは、接続時にサーバーに渡されるキーと値の接続属性を提供できます。 共通属性の詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="27.12.9 パフォーマンススキーマ接続属性テーブル">セクション27.12.9「パフォーマンススキーマ接続属性テーブル」</a> を参照してください。 
        </p><p>
          <code class="literal">session_account_connect_attrs</code> テーブルには、現在のセッションおよびセッションアカウントに関連付けられている他のセッションの接続属性のみが含まれます。 すべてのセッションの接続属性を表示するには、<code class="literal">session_connect_attrs</code> テーブルを使用します。 
        </p><p>
          <code class="literal">session_account_connect_attrs</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              セッションの接続識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              属性名。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              属性値。
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              属性が一連の接続属性に追加された順序。
            </p></li></ul></div><p>
          <code class="literal">session_account_connect_attrs</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">PROCESSLIST_ID</code>、<code class="literal">ATTR_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">session_account_connect_attrs</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-session-connect-attrs-table"></a>27.12.9.2 session_connect_attrs テーブル</h4></div></div></div><a class="indexterm" name="idm45882609603552"></a><a class="indexterm" name="idm45882609601344"></a><p>
          アプリケーションプログラムは、接続時にサーバーに渡されるキーと値の接続属性を提供できます。 共通属性の詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="27.12.9 パフォーマンススキーマ接続属性テーブル">セクション27.12.9「パフォーマンススキーマ接続属性テーブル」</a> を参照してください。 
        </p><p>
          <code class="literal">session_connect_attrs</code> テーブルはすべてのセッションの接続属性を格納します。 現在のセッションおよびセッションアカウントに関連付けられている他のセッションの接続属性のみを表示するには、<code class="literal">session_account_connect_attrs</code> テーブルを使用します。 
        </p><p>
          <code class="literal">session_connect_attrs</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              セッションの接続識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              属性名。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              属性値。
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              属性が一連の接続属性に追加された順序。
            </p></li></ul></div><p>
          <code class="literal">session_connect_attrs</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">PROCESSLIST_ID</code>、<code class="literal">ATTR_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">session_connect_attrs</code> テーブルに対して許可されていません。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-user-variable-tables"></a>27.12.10 パフォーマンススキーマのユーザー定義変数テーブル</h3></div></div></div><a class="indexterm" name="idm45882609577200"></a><a class="indexterm" name="idm45882609575024"></a><p>
        パフォーマンススキーマは、ユーザー定義変数を公開する <code class="literal">user_variables_by_thread</code> テーブルを提供します。 これらは特定のセッション内で定義される変数で、名前の前に<code class="literal">@</code>文字が含まれます。<a class="xref" href="language-structure.html#user-variables" title="9.4 ユーザー定義変数">セクション9.4「ユーザー定義変数」</a> を参照してください。 
      </p><p>
        <code class="literal">user_variables_by_thread</code> テーブルには、次のカラムがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">THREAD_ID</code>
          </p><p>
            変数が定義されているセッションのスレッド識別子。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_NAME</code>
          </p><p>
            <code class="literal">@</code>の先頭文字を含まない変数名。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_VALUE</code>
          </p><p>
            変数値。
          </p></li></ul></div><p>
        <code class="literal">user_variables_by_thread</code> テーブルには次のインデックスがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            主キー (<code class="literal">THREAD_ID</code>、<code class="literal">VARIABLE_NAME</code>)
          </p></li></ul></div><p>
        <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">user_variables_by_thread</code> テーブルに対して許可されていません。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-replication-tables"></a>27.12.11 パフォーマンススキーマレプリケーションテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-connection-configuration-table">27.12.11.1 replication_connection_configuration テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-connection-status-table">27.12.11.2 replication_connection_status テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-asynchronous-connection-failover-table">27.12.11.3 replication_asynchronous_connection_failover テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-configuration-table">27.12.11.4 replication_applier_configuration テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-status-table">27.12.11.5 replication_applier_status テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-status-by-coordinator-table">27.12.11.6 replication_applier_status_by_coordinator テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-status-by-worker-table">27.12.11.7 replication_applier_status_by_worker テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-global-filters-table">27.12.11.8 replication_applier_global_filters テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-applier-filters-table">27.12.11.9 replication_applier_filters テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-group-members-table">27.12.11.10 replication_group_members テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-replication-group-member-stats-table">27.12.11.11 replication_group_member_stats テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-binary-log-transaction-compression-stats-table">27.12.11.12 binary_log_transaction_compression_stats テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマは、レプリケーション情報を公開するテーブルを提供します。 これは、<code class="literal">SHOW REPLICA | SLAVE STATUS</code> ステートメントから入手できる情報に似ていますが、テーブル形式での表現はアクセスしやすく、ユーザビリティ上の利点があります: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">SHOW REPLICA | SLAVE STATUS</code> 出力は、視覚的な検査に役立ちますが、プログラムでの使用にはあまり役立ちません。 対照的に、「パフォーマンススキーマ」テーブルを使用すると、複雑な <code class="literal">WHERE</code> 条件、結合など、一般的な <code class="literal">SELECT</code> クエリーを使用してレプリカステータスに関する情報を検索できます。 
          </p></li><li class="listitem"><p>
            クエリー結果は、さらに分析するためにテーブルに保存することも、変数に割り当ててストアドプロシージャで使用することもできます。
          </p></li><li class="listitem"><p>
            レプリケーションテーブルは、より適切な診断情報を提供します。 マルチスレッドレプリカ操作の場合、<code class="literal">SHOW REPLICA | SLAVE STATUS</code> は <code class="literal">Last_SQL_Errno</code> および <code class="literal">Last_SQL_Error</code> フィールドを使用してすべてのコーディネータおよびワーカースレッドエラーをレポートするため、最新のエラーのみが表示され、情報が失われる可能性があります。 レプリケーションテーブルには、情報を失わずにスレッドごとにエラーが格納されます。 
          </p></li><li class="listitem"><p>
            最後に表示されたトランザクションは、ワーカーごとにレプリケーションテーブルに表示されます。 これは、<code class="literal">SHOW REPLICA | SLAVE STATUS</code> からは入手できない情報です。 
          </p></li><li class="listitem"><p>
            パフォーマンススキーマインタフェースに精通している開発者は、テーブルに行を追加することによって、レプリケーションテーブルを拡張して追加情報を提供できます。
          </p></li></ul></div><h4><a name="idm45882609536928"></a>レプリケーションテーブルの説明</h4><p>
        パフォーマンススキーマは、次のレプリケーション関連テーブルを提供します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            ソースへのレプリカの接続に関する情報を含むテーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">replication_connection_configuration</code>: ソースに接続するための構成パラメータ
              </p></li><li class="listitem"><p>
                <code class="literal">replication_connection_status</code>: ソースへの接続の現在のステータス
              </p></li><li class="listitem"><p>
                <code class="literal">replication_asynchronous_connection_failover</code>: 非同期接続フェイルオーバーメカニズムのソースリスト
              </p></li></ul></div></li><li class="listitem"><p>
            トランザクションアプライアンスに関する一般的な (スレッド固有ではない) 情報を含むテーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">replication_applier_configuration</code>: レプリカ上のトランザクションアプライアンスの構成パラメータ。
              </p></li><li class="listitem"><p>
                <code class="literal">replication_applier_status</code>: レプリカ上のトランザクションアプライアンスの現在のステータス。
              </p></li></ul></div></li><li class="listitem"><p>
            ソースから受信したトランザクションの適用を担当する特定のスレッドに関する情報を含むテーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">replication_applier_status_by_coordinator</code>: コーディネータスレッドのステータス (レプリカがマルチスレッドでないかぎり空)。
              </p></li><li class="listitem"><p>
                <code class="literal">replication_applier_status_by_worker</code>: レプリカがマルチスレッドの場合のアプライヤスレッドまたはワーカースレッドのステータス。
              </p></li></ul></div></li><li class="listitem"><p>
            チャネルベースのレプリケーションフィルタに関する情報を含むテーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">replication_applier_filters</code>: 特定のレプリケーションチャネルに構成されているレプリケーションフィルタに関する情報を提供します。
              </p></li><li class="listitem"><p>
                <code class="literal">replication_applier_global_filters</code>: すべてのレプリケーションチャネルに適用されるグローバルレプリケーションフィルタに関する情報を提供します。
              </p></li></ul></div></li><li class="listitem"><p>
            グループレプリケーションメンバーに関する情報を含むテーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">replication_group_members</code>: グループメンバーのネットワークおよびステータス情報を提供します。
              </p></li><li class="listitem"><p>
                <code class="literal">replication_group_member_stats</code>: 参加しているグループメンバーおよびトランザクションに関する統計情報を提供します。
              </p></li></ul></div><p>
            詳細は、<a class="xref" href="group-replication.html#group-replication-monitoring" title="18.3 グループレプリケーションの監視">セクション18.3「グループレプリケーションの監視」</a> を参照してください。
          </p></li></ul></div><p>
        パフォーマンススキーマが無効になっている場合、次のパフォーマンススキーマレプリケーションテーブルは引き続き移入されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">replication_connection_configuration</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_connection_status</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_asynchronous_connection_failover</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_applier_configuration</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_applier_status</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_applier_status_by_coordinator</code>
          </p></li><li class="listitem"><p>
            <code class="literal">replication_applier_status_by_worker</code>
          </p></li></ul></div><p>
        例外は、レプリケーションテーブル <code class="literal">replication_connection_status</code>、<code class="literal">replication_applier_status_by_coordinator</code> および <code class="literal">replication_applier_status_by_worker</code> のローカルタイミング情報 (トランザクションの開始タイムスタンプと終了タイムスタンプ) です。 パフォーマンススキーマが無効になっている場合、この情報は収集されません。 
      </p><p>
        次の各セクションでは、<code class="literal">SHOW REPLICA | SLAVE STATUS</code> によって生成されるカラムと、同じ情報が表示されるレプリケーションテーブルのカラムとの対応など、各レプリケーションテーブルについて詳しく説明します。
      </p><p>
        このレプリケーションテーブルの残りの部分では、パフォーマンススキーマがそれらをどのように移入するか、および <code class="literal">SHOW REPLICA | SLAVE STATUS</code> のどのフィールドがテーブルに表示されないかについて説明します。
      </p><h4><a name="idm45882609483616"></a>レプリケーションテーブルのライフサイクル</h4><p>
        パフォーマンススキーマは、次のようにレプリケーションテーブルに移入します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CHANGE REPLICATION SOURCE TO</code> | <code class="literal">CHANGE MASTER TO</code> を実行する前は、テーブルは空です。
          </p></li><li class="listitem"><p>
            <code class="literal">CHANGE REPLICATION SOURCE TO</code> | <code class="literal">CHANGE MASTER TO</code> の後、構成パラメータはテーブルに表示されます。 現時点では、アクティブなレプリケーションスレッドはないため、<code class="literal">THREAD_ID</code> カラムは <code class="literal">NULL</code> で、<code class="literal">SERVICE_STATE</code> カラムの値は <code class="literal">OFF</code> です。 
          </p></li><li class="listitem"><p>
            <code class="literal">START REPLICA | SLAVE</code> の後、<code class="literal">NULL</code> 以外の <code class="literal">THREAD_ID</code> 値が表示されます。 アイドル状態またはアクティブなスレッドの <code class="literal">SERVICE_STATE</code> 値は <code class="literal">ON</code> です。 ソースに接続するスレッドは、接続の確立中は <code class="literal">CONNECTING</code> の値を持ち、接続が継続しているかぎり <code class="literal">ON</code> の値を持ちます。 
          </p></li><li class="listitem"><p>
            <code class="literal">STOP REPLICA | SLAVE</code> の後、<code class="literal">THREAD_ID</code> カラムは <code class="literal">NULL</code> になり、存在しなくなったスレッドの <code class="literal">SERVICE_STATE</code> カラムの値は <code class="literal">OFF</code> になります。
          </p></li><li class="listitem"><p>
            テーブルは、<code class="literal">STOP REPLICA | SLAVE</code> またはスレッドがエラーのために停止した後も保持されます。
          </p></li><li class="listitem"><p>
            <code class="literal">replication_applier_status_by_worker</code> テーブルは、レプリカがマルチスレッドモードで動作している場合にのみ空ではありません。 つまり、<code class="literal">slave_parallel_workers</code> システム変数が 0 より大きい場合、このテーブルは <code class="literal">START REPLICA | SLAVE</code> の実行時に移入され、行数にワーカー数が表示されます。 
          </p></li></ul></div><h4><a name="idm45882609454320"></a>レプリケーションテーブルにないレプリカステータス情報</h4><p>
        パフォーマンススキーマレプリケーションテーブル内の情報は、<code class="literal">SHOW REPLICA | SLAVE STATUS</code> から使用可能な情報とは多少異なります。テーブルは、ファイル名や位置ではなくグローバルトランザクション識別子 (GTID) の使用に向けており、サーバー ID 値ではなくサーバー UUID 値を表しているためです。 これらの違いのため、いくつかの <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムはパフォーマンススキーマレプリケーションテーブルに保持されないか、別の方法で表されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            次のフィールドはファイル名と位置を参照し、保持されません:
          </p><pre class="programlisting">Master_Log_File
Read_Master_Log_Pos
Relay_Log_File
Relay_Log_Pos
Relay_Master_Log_File
Exec_Master_Log_Pos
Until_Condition
Until_Log_File
Until_Log_Pos
</pre></li><li class="listitem"><p>
            <code class="literal">Master_Info_File</code> フィールドは保持されません。 これは、レプリカソースメタデータリポジトリに使用される <code class="filename">master.info</code> ファイルを参照します。これは、リポジトリにクラッシュセーフテーブルを使用することで置き換えられています。 
          </p></li><li class="listitem"><p>
            次のフィールドは、<code class="literal">server_uuid</code> ではなく <code class="literal">server_id</code> に基づいており、保持されません:
          </p><pre class="programlisting">Master_Server_Id
Replicate_Ignore_Server_Ids
</pre></li><li class="listitem"><p>
            <code class="literal">Skip_Counter</code> フィールドは GTID ではなくイベント数に基づいており、保持されません。
          </p></li><li class="listitem"><p>
            これらのエラーフィールドは <code class="literal">Last_SQL_Errno</code> および <code class="literal">Last_SQL_Error</code> のエイリアスであるため、保持されません:
          </p><pre class="programlisting">Last_Errno
Last_Error
</pre><p>
            パフォーマンススキーマでは、このエラー情報は <code class="literal">replication_applier_status_by_worker</code> テーブル (およびレプリカがマルチスレッドの場合は <code class="literal">replication_applier_status_by_coordinator</code>) の <code class="literal">LAST_ERROR_NUMBER</code> および <code class="literal">LAST_ERROR_MESSAGE</code> カラムで使用できます。 これらのテーブルは、<code class="literal">Last_Errno</code> および <code class="literal">Last_Error</code> から入手できるよりも具体的なスレッドエラーごとの情報を提供します。 
          </p></li><li class="listitem"><p>
            コマンド行フィルタリングオプションに関する情報を提供するフィールドは保持されません:
          </p><pre class="programlisting">Replicate_Do_DB
Replicate_Ignore_DB
Replicate_Do_Table
Replicate_Ignore_Table
Replicate_Wild_Do_Table
Replicate_Wild_Ignore_Table
</pre></li><li class="listitem"><p>
            <code class="literal">Replica_IO_State</code> および <code class="literal">Replica_SQL_Running_State</code> のフィールドは保持されません。 必要に応じて、適切なレプリケーションテーブルの <code class="literal">THREAD_ID</code> カラムを使用し、<code class="literal">INFORMATION_SCHEMA</code> <code class="literal">PROCESSLIST</code> テーブルの <code class="literal">ID</code> カラムと結合して、プロセスリストからこれらの値を取得し、後者のテーブルの <code class="literal">STATE</code> カラムを選択できます。 
          </p></li><li class="listitem"><p>
            <code class="literal">Executed_Gtid_Set</code> フィールドには、大量のテキストを含む大きなセットを表示できます。 代わりに、「パフォーマンススキーマ」テーブルには、レプリカによって現在適用されているトランザクションの GTID が表示されます。 または、実行された GTID のセットを <code class="literal">gtid_executed</code> システム変数の値から取得できます。 
          </p></li><li class="listitem"><p>
            <code class="literal">Seconds_Behind_Master</code> および <code class="literal">Relay_Log_Space</code> フィールドは指定予定のステータスであり、保持されません。
          </p></li></ul></div><h4><a name="idm45882609414288"></a>レプリケーションチャネル</h4><p>
        レプリケーション「パフォーマンススキーマ」テーブルの最初のカラムは <code class="literal">CHANNEL_NAME</code> です。 これにより、レプリケーションチャネルごとにテーブルを表示できます。 非マルチソースレプリケーション設定には、単一のデフォルトレプリケーションチャネルがあります。 レプリカで複数のレプリケーションチャネルを使用している場合は、レプリケーションチャネルごとにテーブルをフィルタして、特定のレプリケーションチャネルを監視できます。 詳細は、<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a> および <a class="xref" href="replication.html#replication-multi-source-monitoring" title="17.1.5.8 マルチソースレプリケーションの監視">セクション17.1.5.8「マルチソースレプリケーションの監視」</a> を参照してください。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-connection-configuration-table"></a>27.12.11.1 replication_connection_configuration テーブル</h4></div></div></div><a class="indexterm" name="idm45882609408832"></a><a class="indexterm" name="idm45882609406816"></a><p>
          このテーブルは、レプリカがソースに接続するために使用する構成パラメータを示しています。 テーブルに格納されているパラメータは、実行時に <code class="literal">CHANGE REPLICATION SOURCE TO</code> ステートメント (MySQL 8.0.23) または <code class="literal">CHANGE MASTER TO</code> ステートメント (MySQL 8.0.23 より前) を使用して変更できます。 
        </p><p>
          <code class="literal">replication_connection_status</code> テーブルと比較すると、<code class="literal">replication_connection_configuration</code> の変更頻度は低くなります。 これには、レプリカがソースに接続する方法を定義し、接続中に一定のままになる値が含まれますが、<code class="literal">replication_connection_status</code> には、接続中に変更される値が含まれます。 
        </p><p>
          <code class="literal">replication_connection_configuration</code> テーブルには次のカラムがあります。 カラムの説明には、カラム値の取得元となる対応する <code class="literal">CHANGE REPLICATION SOURCE TO</code> | <code class="literal">CHANGE MASTER TO</code> オプションが示され、このセクションで後述するテーブルには、<code class="literal">replication_connection_configuration</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応関係が示されています。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">FOR CHANNEL</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">FOR CHANNEL</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              レプリカの接続先のソースのホスト名。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_HOST</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_HOST</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">PORT</code>
            </p><p>
              ソースへの接続に使用されるポート。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_PORT</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_PORT</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              ソースへの接続に使用されるレプリケーションユーザーアカウントのユーザー名。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_USER</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_USER</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">NETWORK_INTERFACE</code>
            </p><p>
              レプリカがバインドされているネットワークインタフェース (ある場合)。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_BIND</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_BIND</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">AUTO_POSITION</code>
            </p><p>
              GTID 自動配置が使用されている場合は 1、それ以外の場合は 0。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_AUTO_POSITION</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_AUTO_POSITION</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">SSL_ALLOWED</code>, <code class="literal">SSL_CA_FILE</code>, <code class="literal">SSL_CA_PATH</code>, <code class="literal">SSL_CERTIFICATE</code>, <code class="literal">SSL_CIPHER</code>, <code class="literal">SSL_KEY</code>, <code class="literal">SSL_VERIFY_SERVER_CERTIFICATE</code>, <code class="literal">SSL_CRL_FILE</code>, <code class="literal">SSL_CRL_PATH</code>
            </p><p>
              これらのカラムには、レプリカがソースに接続するために使用する SSL パラメータが表示されます (存在する場合)。
            </p><p>
              <code class="literal">SSL_ALLOWED</code> には次の値があります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">Yes</code>(ソースへの SSL 接続が許可されている場合)
                </p></li><li class="listitem"><p>
                  ソースへの SSL 接続が許可されていない場合は <code class="literal">No</code>
                </p></li><li class="listitem"><p>
                  SSL 接続が許可されているが、レプリカで SSL サポートが有効になっていない場合は <code class="literal">Ignored</code>
                </p></li></ul></div><p>
              (他の SSL カラムの <code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_SSL_CA</code>, <code class="literal">SOURCE_SSL_CAPATH</code>, <code class="literal">SOURCE_SSL_CERT</code>, <code class="literal">SOURCE_SSL_CIPHER</code>, <code class="literal">SOURCE_SSL_CRL</code>, <code class="literal">SOURCE_SSL_CRLPATH</code>, <code class="literal">SOURCE_SSL_KEY</code>, <code class="literal">SOURCE_SSL_VERIFY_SERVER_CERT</code>。
            </p><p>
              その他の SSL カラムの <code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_SSL_CA</code>, <code class="literal">MASTER_SSL_CAPATH</code>, <code class="literal">MASTER_SSL_CERT</code>, <code class="literal">MASTER_SSL_CIPHER</code>, <code class="literal">MASTER_SSL_CRL</code>, <code class="literal">MASTER_SSL_CRLPATH</code>, <code class="literal">MASTER_SSL_KEY</code>, <code class="literal">MASTER_SSL_VERIFY_SERVER_CERT</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTION_RETRY_INTERVAL</code>
            </p><p>
              接続再試行間の秒数。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_CONNECT_RETRY</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_CONNECT_RETRY</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTION_RETRY_COUNT</code>
            </p><p>
              接続が失われた場合にレプリカがソースへの再接続を試行できる回数。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_RETRY_COUNT</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_RETRY_COUNT</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">HEARTBEAT_INTERVAL</code>
            </p><p>
              レプリカのレプリケーションハートビート間隔 (秒単位)。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_HEARTBEAT_PERIOD</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_HEARTBEAT_PERIOD</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">TLS_VERSION</code>
            </p><p>
              レプリケーション接続のレプリカによって許可される TLS プロトコルバージョンのリスト。 TLS バージョン情報については、<a class="xref" href="security.html#encrypted-connection-protocols-ciphers" title="6.3.2 暗号化された接続 TLS プロトコルおよび暗号">セクション6.3.2「暗号化された接続 TLS プロトコルおよび暗号」</a> を参照してください。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_TLS_VERSION</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_TLS_VERSION</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">TLS_CIPHERSUITES</code>
            </p><p>
              レプリケーション接続のレプリカによって許可される暗号スイートのリスト。 TLS 暗号スイートの詳細は、<a class="xref" href="security.html#encrypted-connection-protocols-ciphers" title="6.3.2 暗号化された接続 TLS プロトコルおよび暗号">セクション6.3.2「暗号化された接続 TLS プロトコルおよび暗号」</a> を参照してください。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_TLS_CIPHERSUITES</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_TLS_CIPHERSUITES</code> ) 
            </p></li><li class="listitem"><p>
              <code class="literal">PUBLIC_KEY_PATH</code>
            </p><p>
              RSA キーペアベースのパスワード交換のソースに必要な公開キーのレプリカ側コピーを含むファイルへのパス名。 ファイルは PEM 形式である必要があります。 このカラムは、<code class="literal">sha256_password</code> または <code class="literal">caching_sha2_password</code> 認証プラグインで認証されるレプリカに適用されます。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_PUBLIC_KEY_PATH</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_PUBLIC_KEY_PATH</code> ) 
            </p><p>
              <code class="literal">PUBLIC_KEY_PATH</code> が指定され、有効な公開キーファイルが指定されている場合は、<code class="literal">GET_PUBLIC_KEY</code> よりも優先されます。
            </p></li><li class="listitem"><p>
              <code class="literal">GET_PUBLIC_KEY</code>
            </p><p>
              RSA キーペアベースのパスワード交換に必要な公開キーをソースからリクエストするかどうか。 このカラムは、<code class="literal">caching_sha2_password</code> 認証プラグインで認証されるレプリカに適用されます。 そのプラグインの場合、ソースは要求されないかぎり公開鍵を送信しません。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_GET_PUBLIC_KEY</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_GET_PUBLIC_KEY</code> ) 
            </p><p>
              <code class="literal">PUBLIC_KEY_PATH</code> が指定され、有効な公開キーファイルが指定されている場合は、<code class="literal">GET_PUBLIC_KEY</code> よりも優先されます。
            </p></li><li class="listitem"><p>
              <code class="literal">NETWORK_NAMESPACE</code>
            </p><p>
              ネットワークネームスペース名。接続でデフォルト (グローバル) ネームスペースを使用する場合は空です。 ネットワークネームスペースの詳細は、<a class="xref" href="server-administration.html#network-namespace-support" title="5.1.14 ネットワークネームスペースのサポート">セクション5.1.14「ネットワークネームスペースのサポート」</a> を参照してください。 このカラムは、MySQL 8.0.22 で追加されました。 
            </p></li><li class="listitem"><p>
              <code class="literal">COMPRESSION_ALGORITHMS</code>
            </p><p>
              ソースへの接続に許可される圧縮アルゴリズム。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_COMPRESSION_ALGORITHMS</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_COMPRESSION_ALGORITHMS</code> ) 
            </p><p>
              詳細は、<a class="xref" href="programs.html#connection-compression-control" title="4.2.8 接続圧縮制御">セクション4.2.8「接続圧縮制御」</a>を参照してください。
            </p><p>
              このカラムは、MySQL 8.0.18 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">ZSTD_COMPRESSION_LEVEL</code>
            </p><p>
              <code class="literal">zstd</code> 圧縮アルゴリズムを使用するソースへの接続に使用する圧縮レベル。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_ZSTD_COMPRESSION_LEVEL</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_ZSTD_COMPRESSION_LEVEL</code> ) 
            </p><p>
              詳細は、<a class="xref" href="programs.html#connection-compression-control" title="4.2.8 接続圧縮制御">セクション4.2.8「接続圧縮制御」</a>を参照してください。
            </p><p>
              このカラムは、MySQL 8.0.18 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE_CONNECTION_AUTO_FAILOVER</code>
            </p><p>
              このレプリケーションチャネルに対して非同期接続フェイルオーバーメカニズムがアクティブ化されているかどうか。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_CONNECTION_AUTO_FAILOVER</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">SOURCE_CONNECTION_AUTO_FAILOVER</code> ) 
            </p><p>

            </p><p>
              このカラムは、MySQL 8.0.22 で追加されました。
            </p></li></ul></div><p>
          <code class="literal">replication_connection_configuration</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_connection_configuration</code> テーブルに対して許可されていません。
        </p><p>
          次のテーブルに、<code class="literal">replication_connection_configuration</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_connection_configuration columns and SHOW REPLICA | SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_connection_configuration</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">CHANNEL_NAME</code></td>
              <td><code class="literal">Channel_name</code></td>
            </tr><tr>
              <td><code class="literal">HOST</code></td>
              <td><code class="literal">Source_Host</code></td>
            </tr><tr>
              <td><code class="literal">PORT</code></td>
              <td><code class="literal">Source_Port</code></td>
            </tr><tr>
              <td><code class="literal">USER</code></td>
              <td><code class="literal">Source_User</code></td>
            </tr><tr>
              <td><code class="literal">NETWORK_INTERFACE</code></td>
              <td><code class="literal">Source_Bind</code></td>
            </tr><tr>
              <td><code class="literal">AUTO_POSITION</code></td>
              <td><code class="literal">Auto_Position</code></td>
            </tr><tr>
              <td><code class="literal">SSL_ALLOWED</code></td>
              <td><code class="literal">Source_SSL_Allowed</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CA_FILE</code></td>
              <td><code class="literal">Source_SSL_CA_File</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CA_PATH</code></td>
              <td><code class="literal">Source_SSL_CA_Path</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CERTIFICATE</code></td>
              <td><code class="literal">Source_SSL_Cert</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CIPHER</code></td>
              <td><code class="literal">Source_SSL_Cipher</code></td>
            </tr><tr>
              <td><code class="literal">SSL_KEY</code></td>
              <td><code class="literal">Source_SSL_Key</code></td>
            </tr><tr>
              <td><code class="literal">SSL_VERIFY_SERVER_CERTIFICATE</code></td>
              <td><code class="literal">Source_SSL_Verify_Server_Cert</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CRL_FILE</code></td>
              <td><code class="literal">Source_SSL_Crl</code></td>
            </tr><tr>
              <td><code class="literal">SSL_CRL_PATH</code></td>
              <td><code class="literal">Source_SSL_Crlpath</code></td>
            </tr><tr>
              <td><code class="literal">CONNECTION_RETRY_INTERVAL</code></td>
              <td><code class="literal">Source_Connect_Retry</code></td>
            </tr><tr>
              <td><code class="literal">CONNECTION_RETRY_COUNT</code></td>
              <td><code class="literal">Source_Retry_Count</code></td>
            </tr><tr>
              <td><code class="literal">HEARTBEAT_INTERVAL</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">TLS_VERSION</code></td>
              <td><code class="literal">Source_TLS_Version</code></td>
            </tr><tr>
              <td><code class="literal">PUBLIC_KEY_PATH</code></td>
              <td><code class="literal">Source_public_key_path</code></td>
            </tr><tr>
              <td><code class="literal">GET_PUBLIC_KEY</code></td>
              <td><code class="literal">Get_source_public_key</code></td>
            </tr><tr>
              <td><code class="literal">NETWORK_NAMESPACE</code></td>
              <td><code class="literal">Network_Namespace</code></td>
            </tr><tr>
              <td><code class="literal">COMPRESSION_ALGORITHMS</code></td>
              <td>[None]</td>
            </tr><tr>
              <td><code class="literal">ZSTD_COMPRESSION_LEVEL</code></td>
              <td>[None]</td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-connection-status-table"></a>27.12.11.2 replication_connection_status テーブル</h4></div></div></div><a class="indexterm" name="idm45882609178864"></a><a class="indexterm" name="idm45882609176800"></a><p>
          このテーブルには、ソースへのレプリカ接続を処理する I/O スレッドの現在のステータス、リレーログにキューされている最後のトランザクションに関する情報、および現在リレーログにキューされているトランザクションに関する情報が表示されます。
        </p><p>
          <code class="literal">replication_connection_configuration</code> テーブルと比較すると、<code class="literal">replication_connection_status</code> はより頻繁に変更されます。 これには、接続中に変更される値が含まれますが、<code class="literal">replication_connection_configuration</code> には、レプリカがソースに接続する方法を定義し、接続中に一定のままになる値が含まれます。 
        </p><p>
          <code class="literal">replication_connection_status</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">GROUP_NAME</code>
            </p><p>
              このサーバーがグループのメンバーである場合、サーバーが属するグループの名前が表示されます。
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE_UUID</code>
            </p><p>
              ソースからの <code class="literal">server_uuid</code> 値。
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              I/O スレッド ID。
            </p></li><li class="listitem"><p>
              <code class="literal">SERVICE_STATE</code>
            </p><p>
              <code class="literal">ON</code> (スレッドは存在し、アクティブまたはアイドル状態)、<code class="literal">OFF</code> (スレッドはすでに存在しません) または <code class="literal">CONNECTING</code> (スレッドは存在し、ソースに接続しています)。
            </p></li><li class="listitem"><p>
              <code class="literal">RECEIVED_TRANSACTION_SET</code>
            </p><p>
              このレプリカによって受信されたすべてのトランザクションに対応するグローバルトランザクション ID (GTID) のセット。 GTID が使用されていない場合は空です。 詳しくは<a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID セット">GTID セット</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_NUMBER</code>, <code class="literal">LAST_ERROR_MESSAGE</code>
            </p><p>
              I/O スレッドを停止させた最新のエラーのエラー番号とエラーメッセージ。 0 のエラー番号および空の文字列のメッセージは、<span class="quote">「<span class="quote">エラーなし</span>」</span>を示します。 <code class="literal">LAST_ERROR_MESSAGE</code> 値が空でない場合、エラー値はレプリカエラーログにも表示されます。 
            </p><p>
              <code class="literal">RESET MASTER</code> または <code class="literal">RESET REPLICA | SLAVE</code> を発行すると、これらのカラムに表示される値がリセットされます。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_TIMESTAMP</code>
            </p><p>
              最新の I/O エラーがいつ発生したかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_HEARTBEAT_TIMESTAMP</code>
            </p><p>
              レプリカが最新のハートビートシグナルをいつ受信したかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_RECEIVED_HEARTBEATS</code>
            </p><p>
              レプリカが最後に再起動またはリセットされてから、あるいは <code class="literal">CHANGE REPLICATION SOURCE TO</code> | <code class="literal">CHANGE MASTER TO</code> ステートメントが発行されてから受信したハートビートシグナルの合計数。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_QUEUED_TRANSACTION</code>
            </p><p>
              リレーログにキューに入れられた最後のトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_QUEUED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              リレーログにキューされた最後のトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_QUEUED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              リレーログにキューされた最後のトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_QUEUED_TRANSACTION_START_QUEUE_TIMESTAMP</code>
            </p><p>
              この I/O スレッドによって最後のトランザクションがリレーログキューに置かれた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_QUEUED_TRANSACTION_END_QUEUE_TIMESTAMP</code>
            </p><p>
              最後のトランザクションがリレーログファイルにキューに入れられた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUEING_TRANSACTION</code>
            </p><p>
              リレーログ内の現在キューイングしているトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUEING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              現在キューイングしているトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUEING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              現在キューイングしているトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUEING_TRANSACTION_START_QUEUE_TIMESTAMP</code>
            </p><p>
              現在キューイングしているトランザクションの最初のイベントがこの I/O スレッドによってリレーログに書き込まれた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li></ul></div><p>
          パフォーマンススキーマが無効になっている場合、ローカルタイミング情報は収集されないため、キューに入れられたトランザクションの開始タイムスタンプと終了タイムスタンプを示すフィールドはゼロになります。
        </p><p>
          <code class="literal">replication_connection_status</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>) のインデックス
            </p></li></ul></div><p>
          次のテーブルに、<code class="literal">replication_connection_status</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_connection_status columns and SHOW REPLICA | SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_connection_status</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">SOURCE_UUID</code></td>
              <td><code class="literal">Master_UUID</code></td>
            </tr><tr>
              <td><code class="literal">THREAD_ID</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">SERVICE_STATE</code></td>
              <td><code class="literal">Replica_IO_Running</code></td>
            </tr><tr>
              <td><code class="literal">RECEIVED_TRANSACTION_SET</code></td>
              <td><code class="literal">Retrieved_Gtid_Set</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_NUMBER</code></td>
              <td><code class="literal">Last_IO_Errno</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_MESSAGE</code></td>
              <td><code class="literal">Last_IO_Error</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_TIMESTAMP</code></td>
              <td><code class="literal">Last_IO_Error_Timestamp</code></td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-asynchronous-connection-failover-table"></a>27.12.11.3 replication_asynchronous_connection_failover テーブル</h4></div></div></div><a class="indexterm" name="idm45882609064752"></a><a class="indexterm" name="idm45882609062656"></a><p>
          このテーブルには、非同期接続フェイルオーバーメカニズムの各レプリケーションチャネルのレプリカソースリストが含まれます。 非同期接続フェイルオーバーメカニズムは、レプリカからソースへの既存の接続が失敗した後、適切なリストから新しいソースへの非同期 (ソースからレプリカへの) レプリケーション接続を自動的に確立します。 <code class="literal">asynchronous_connection_failover_add_source</code> および <code class="literal">asynchronous_connection_failover_delete_source</code> UDF を使用してソースリストを設定および管理し、レプリケーションチャネルのソースリストに対してレプリケーションソースサーバーを追加および削除します。 サーバーの管理対象グループを追加および削除するには、かわりに <code class="literal">asynchronous_connection_failover_add_managed</code> および <code class="literal">asynchronous_connection_failover_delete_managed</code> UDF を使用します。 詳細は、<a class="xref" href="replication.html#replication-asynchronous-connection-failover" title="17.4.9 非同期接続フェイルオーバーによるソースの切替え">セクション17.4.9「非同期接続フェイルオーバーによるソースの切替え」</a>を参照してください。 
        </p><p>
          <code class="literal">replication_asynchronous_connection_failover</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              このレプリケーションソースサーバーがソースリストの一部であるレプリケーションチャネル。 このチャネルから現在のソースへの接続に失敗した場合、このレプリケーションソースサーバーは潜在的な新しいソースの 1 つです。 
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              このレプリケーションソースサーバーのホスト名。
            </p></li><li class="listitem"><p>
              <code class="literal">PORT</code>
            </p><p>
              このレプリケーションソースサーバーのポート番号。
            </p></li><li class="listitem"><p>
              <code class="literal">NETWORK_NAMESPACE</code>
            </p><p>
              このレプリケーションソースサーバーのネットワークネームスペース。 この値が空の場合、接続ではデフォルト (グローバル) のネームスペースが使用されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">WEIGHT</code>
            </p><p>
              レプリケーションチャネルソースリスト内のこのレプリケーションソースサーバーの優先度。 重みは 1 から 100 で、100 が最も高く、50 がデフォルトです。 非同期接続フェイルオーバーメカニズムがアクティブ化されると、チャネルのソースリストにリストされている代替ソースの中で重みが最も高いソースが最初の接続試行に対して選択されます。 この試行が機能しない場合、レプリカは、リストされているすべてのソースを重みの降順で試行してから、最も高い重みのソースから再開します。 複数のソースの重みが同じ場合、レプリカはそれらをランダムに順序付けします。 
            </p></li><li class="listitem"><p>
              <code class="literal">MANAGED_NAME</code>
            </p><p>
              サーバーが属する管理対象グループの識別子。 <code class="literal">GroupReplication</code> 管理サービスの場合、identifier は <code class="literal">group_replication_group_name</code> システム変数の値です。 
            </p></li></ul></div><p>
          <code class="literal">replication_asynchronous_connection_failover</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME, HOST, PORT, NETWORK_NAMESPACE, MANAGED_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_asynchronous_connection_failover</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-configuration-table"></a>27.12.11.4 replication_applier_configuration テーブル</h4></div></div></div><a class="indexterm" name="idm45882609028416"></a><a class="indexterm" name="idm45882609026352"></a><p>
          このテーブルは、レプリカによって適用されるトランザクションに影響する構成パラメータを示しています。 テーブルに格納されているパラメータは、実行時に <code class="literal">CHANGE REPLICATION SOURCE TO</code> ステートメント (MySQL 8.0.23) または <code class="literal">CHANGE MASTER TO</code> ステートメント (MySQL 8.0.23 より前) を使用して変更できます。 
        </p><p>
          <code class="literal">replication_applier_configuration</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">DESIRED_DELAY</code>
            </p><p>
              レプリカがソースを遅らせる必要がある秒数。 (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">SOURCE_DELAY</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">MASTER_DELAY</code>) 詳細は、<a class="xref" href="replication.html#replication-delayed" title="17.4.11 遅延レプリケーション">セクション17.4.11「遅延レプリケーション」</a> を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">PRIVILEGE_CHECKS_USER</code>
            </p><p>
              チャネルのセキュリティコンテキストを提供するユーザーアカウント (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション): <code class="literal">PRIVILEGE_CHECKS_USER</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">PRIVILEGE_CHECKS_USER</code> ). これはエスケープされるため、SQL ステートメントにコピーして個々のトランザクションを実行できます。 詳しくは<a class="xref" href="replication.html#replication-privilege-checks" title="17.3.3 レプリケーション権限チェック">セクション17.3.3「レプリケーション権限チェック」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">REQUIRE_ROW_FORMAT</code>
            </p><p>
              チャネルが行ベースのイベントのみを受け入れるかどうか (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション): <code class="literal">REQUIRE_ROW_FORMAT</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">REQUIRE_ROW_FORMAT</code> ). 詳しくは<a class="xref" href="replication.html#replication-privilege-checks" title="17.3.3 レプリケーション権限チェック">セクション17.3.3「レプリケーション権限チェック」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">REQUIRE_TABLE_PRIMARY_KEY_CHECK</code>
            </p><p>
              チャネルで主キーが常に必要かどうか、またはソース設定に応じて必要かどうか (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション): <code class="literal">REQUIRE_TABLE_PRIMARY_KEY_CHECK</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">REQUIRE_TABLE_PRIMARY_KEY_CHECK</code> ). 詳しくは<a class="xref" href="replication.html#replication-privilege-checks" title="17.3.3 レプリケーション権限チェック">セクション17.3.3「レプリケーション権限チェック」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS_TYPE</code>
            </p><p>
              GTID がまだないレプリケートされたトランザクションにチャネルが GTID を割り当てるかどうか (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション: <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS</code> ). <code class="literal">OFF</code> は GTID が割り当てられていないことを示します。 <code class="literal">LOCAL</code> は、レプリカ独自の UUID (<code class="literal">server_uuid</code> 設定) を含む GTID が割り当てられていることを意味します。 <code class="literal">MANUAL</code> は、手動で設定された UUID を含む GTID が割り当てられることを意味します。 詳しくは<a class="xref" href="replication.html#replication-gtids-assign-anon" title="17.1.3.6 GTID のないソースから GTID のあるレプリカへのレプリケーション">セクション17.1.3.6「GTID のないソースから GTID のあるレプリカへのレプリケーション」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS_VALUE</code>
            </p><p>
              匿名トランザクションに割り当てられた GTID の一部として使用される UUID (<code class="literal">CHANGE REPLICATION SOURCE TO</code> オプション): <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS</code>、<code class="literal">CHANGE MASTER TO</code> オプション: <code class="literal">ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS</code> ). 詳しくは<a class="xref" href="replication.html#replication-gtids-assign-anon" title="17.1.3.6 GTID のないソースから GTID のあるレプリカへのレプリケーション">セクション17.1.3.6「GTID のないソースから GTID のあるレプリカへのレプリケーション」</a>をご覧ください。 
            </p></li></ul></div><p>
          <code class="literal">replication_applier_configuration</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_applier_configuration</code> テーブルに対して許可されていません。
        </p><p>
          次のテーブルに、<code class="literal">replication_applier_configuration </code>カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_applier_configuration columns and SHOW REPLICA | SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_applier_configuration</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">DESIRED_DELAY</code></td>
              <td><code class="literal">SQL_Delay</code></td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-status-table"></a>27.12.11.5 replication_applier_status テーブル</h4></div></div></div><a class="indexterm" name="idm45882608958288"></a><a class="indexterm" name="idm45882608956224"></a><p>
          このテーブルには、レプリカの現在の一般的なトランザクション実行ステータスが表示されます。 このテーブルは、関連するスレッドに固有ではないトランザクションアプライヤステータスの一般的な側面に関する情報を示しています。 スレッド固有のステータス情報は、<code class="literal">replication_applier_status_by_coordinator</code> テーブル (およびレプリカがマルチスレッドの場合は <code class="literal">replication_applier_status_by_worker</code>) で使用できます。 
        </p><p>
          <code class="literal">replication_applier_status</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">SERVICE_STATE</code>
            </p><p>
              レプリケーションチャネルアプライヤスレッドがアクティブまたはアイドルの場合に <code class="literal">ON</code> を表示します。<code class="literal">OFF</code> は、アプライヤスレッドがアクティブでないことを意味します。
            </p></li><li class="listitem"><p>
              <code class="literal">REMAINING_DELAY</code>
            </p><p>
              ソースがトランザクションを適用してから <code class="literal">DESIRED_DELAY</code> 秒が経過するまでレプリカが待機している場合、このフィールドには残りの遅延秒数が表示されます。 ほかのときは、このフィールドは <code class="literal">NULL</code> です。 (<code class="literal">DESIRED_DELAY</code> 値は <code class="literal">replication_applier_configuration</code> テーブルに格納されます。) 詳しくは<a class="xref" href="replication.html#replication-delayed" title="17.4.11 遅延レプリケーション">セクション17.4.11「遅延レプリケーション」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_RETRIES</code>
            </p><p>
              レプリケーション SQL スレッドがトランザクションの適用に失敗したために行われた再試行の回数を示します。 特定のトランザクションの最大再試行回数は、<code class="literal">slave_transaction_retries</code> システム変数によって設定されます。 <code class="literal">replication_applier_status_by_worker</code> テーブルには、シングルスレッドまたはマルチスレッドレプリカのトランザクション再試行に関する詳細情報が表示されます。 
            </p></li></ul></div><p>
          <code class="literal">replication_applier_status</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_applier_status</code> テーブルに対して許可されていません。
        </p><p>
          次のテーブルに、<code class="literal">replication_applier_status</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_applier_status columns and SHOW REPLICA | SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_applier_status</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">SERVICE_STATE</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">REMAINING_DELAY</code></td>
              <td><code class="literal">SQL_Remaining_Delay</code></td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-status-by-coordinator-table"></a>27.12.11.6 replication_applier_status_by_coordinator テーブル</h4></div></div></div><a class="indexterm" name="idm45882608909376"></a><a class="indexterm" name="idm45882608907280"></a><p>
          マルチスレッドのレプリカの場合、レプリカは複数のワーカースレッドとコーディネータスレッドを使用してそれらを管理し、このテーブルにはコーディネータスレッドのステータスが表示されます。 シングルスレッドレプリカの場合、このテーブルは空です。 マルチスレッドのレプリカの場合、<code class="literal">replication_applier_status_by_worker</code> テーブルにワーカースレッドのステータスが表示されます。 このテーブルには、コーディネータスレッドによってワーカーのキューにバッファリングされた最後のトランザクションと、現在バッファリングしているトランザクションに関する情報が表示されます。 開始タイムスタンプは、このスレッドがトランザクションの最初のイベントをリレーログから読み取ってワーカーのキューにバッファするタイミングを表し、終了タイムスタンプは最後のイベントがワーカーのキューへのバッファリングを終了したタイミングを表します。 
        </p><p>
          <code class="literal">replication_applier_status_by_coordinator</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              SQL/コーディネータスレッド ID。
            </p></li><li class="listitem"><p>
              <code class="literal">SERVICE_STATE</code>
            </p><p>
              <code class="literal">ON</code> (スレッドが存在し、アクティブまたはアイドル状態) または <code class="literal">OFF</code> (スレッドは存在しません)。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_NUMBER</code>, <code class="literal">LAST_ERROR_MESSAGE</code>
            </p><p>
              SQL/コーディネータスレッドの停止の原因となった最新のエラーのエラー番号およびエラーメッセージ。 エラー番号 0 および空の文字列であるメッセージは、<span class="quote">「<span class="quote">「エラーなし」</span>」</span>を意味します。 <code class="literal">LAST_ERROR_MESSAGE</code> 値が空でない場合、エラー値はレプリカエラーログにも表示されます。 
            </p><p>
              <code class="literal">RESET MASTER</code> または <code class="literal">RESET REPLICA | SLAVE</code> を発行すると、これらのカラムに表示される値がリセットされます。
            </p><p>
              <code class="literal">LAST_ERROR_NUMBER</code> カラムおよび <code class="literal">LAST_ERROR_MESSAGE</code> カラムに表示されるすべてのエラーコードおよびメッセージは、<a class="ulink" href="https://dev.mysql.com/doc/mysql-errors/8.0/en/server-error-reference.html" target="_top">Server Error Message Reference</a> にリストされているエラー値に対応します。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_TIMESTAMP</code>
            </p><p>
              最新の SQL/コーディネータエラーがいつ発生したかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_PROCESSED_TRANSACTION</code>
            </p><p>
              このコーディネータによって最後に処理されたトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_PROCESSED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              このコーディネータによって処理された最後のトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_PROCESSED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              このコーディネータによって処理された最後のトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_PROCESSED_TRANSACTION_START_BUFFER_TIMESTAMP</code>
            </p><p>
              このコーディネータスレッドがワーカースレッドのバッファへの最後のトランザクションの書込みを開始した時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_PROCESSED_TRANSACTION_END_BUFFER_TIMESTAMP</code>
            </p><p>
              このコーディネータスレッドによってワーカースレッドのバッファに最後のトランザクションが書き込まれた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSING_TRANSACTION</code>
            </p><p>
              このコーディネータスレッドが現在処理しているトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              現在処理中のトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              現在処理中のトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSING_TRANSACTION_START_BUFFER_TIMESTAMP</code>
            </p><p>
              このコーディネータスレッドが現在処理中のトランザクションのワーカースレッドのバッファへの書込みを開始した時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li></ul></div><p>
          パフォーマンススキーマが無効になっている場合、ローカルタイミング情報は収集されないため、バッファートランザクションの開始タイムスタンプと終了タイムスタンプを示すフィールドはゼロになります。
        </p><p>
          <code class="literal">replication_applier_status_by_coordinator</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>) のインデックス
            </p></li></ul></div><p>
          次のテーブルに、<code class="literal">replication_applier_status_by_coordinator</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_applier_status_by_coordinator columns and SHOW SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_applier_status_by_coordinator</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">THREAD_ID</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">SERVICE_STATE</code></td>
              <td><code class="literal">Replica_SQL_Running</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_NUMBER</code></td>
              <td><code class="literal">Last_SQL_Errno</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_MESSAGE</code></td>
              <td><code class="literal">Last_SQL_Error</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_TIMESTAMP</code></td>
              <td><code class="literal">Last_SQL_Error_Timestamp</code></td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-status-by-worker-table"></a>27.12.11.7 replication_applier_status_by_worker テーブル</h4></div></div></div><a class="indexterm" name="idm45882608815904"></a><a class="indexterm" name="idm45882608813840"></a><p>
          このテーブルには、レプリカまたはグループレプリケーショングループメンバーの適用者スレッドによって処理されるトランザクションの詳細が示されます。 シングルスレッドのレプリカの場合、レプリカの単一アプライヤスレッドのデータが表示されます。 マルチスレッドのレプリカの場合、データはアプライヤスレッドごとに個別に表示されます。 マルチスレッドレプリカ上のアプライヤスレッドは、ワーカーと呼ばれることもあります。 レプリカまたはグループレプリケーショングループメンバー上のアプライヤスレッドの数は、シングルスレッドレプリカの場合はゼロに設定される <code class="literal">slave_parallel_workers</code> システム変数によって設定されます。 マルチスレッドレプリカには、アプライヤスレッドを管理するためのコーディネータスレッドもあり、このスレッドのステータスは <code class="literal">replication_applier_status_by_coordinator</code> テーブルに表示されます。 
        </p><p>
          エラーに関連するカラムに表示されるすべてのエラーコードおよびメッセージは、<a class="ulink" href="https://dev.mysql.com/doc/mysql-errors/8.0/en/server-error-reference.html" target="_top">Server Error Message Reference</a> にリストされているエラー値に対応します。
        </p><p>
          パフォーマンススキーマが無効になっている場合、ローカルのタイミング情報は収集されないため、適用されるトランザクションの開始タイムスタンプと終了タイムスタンプを示すフィールドはゼロになります。 このテーブルの開始タイムスタンプは、ワーカーが最初のイベントの適用を開始した時間を示し、終了タイムスタンプは、トランザクションの最後のイベントが適用された時間を示します。 
        </p><p>
          <code class="literal">START REPLICA | SLAVE</code> ステートメントによってレプリカが再起動されると、<code class="literal">APPLYING_TRANSACTION</code> で始まるカラムがリセットされます。 MySQL 8.0.13 より前は、これらのカラムはシングルスレッドモードで動作していたレプリカではリセットされず、マルチスレッドレプリカでのみリセットされていました。 
        </p><p>
          <code class="literal">replication_applier_status_by_worker</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              この行が表示しているレプリケーションチャネル。 常にデフォルトのレプリケーションチャネルがあり、さらにレプリケーションチャネルを追加できます。 詳しくは<a class="xref" href="replication.html#replication-channels" title="17.2.2 レプリケーションチャネル">セクション17.2.2「レプリケーションチャネル」</a>をご覧ください。 
            </p></li><li class="listitem"><p>
              <code class="literal">WORKER_ID</code>
            </p><p>
              ワーカー識別子 (<code class="literal">mysql.slave_worker_info</code> テーブルの <code class="literal">id</code> カラムと同じ値)。 <code class="literal">STOP REPLICA | SLAVE</code> の後、<code class="literal">THREAD_ID</code> カラムは <code class="literal">NULL</code> になりますが、<code class="literal">WORKER_ID</code> 値は保持されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              ワーカースレッド ID。
            </p></li><li class="listitem"><p>
              <code class="literal">SERVICE_STATE</code>
            </p><p>
              <code class="literal">ON</code> (スレッドが存在し、アクティブまたはアイドル状態) または <code class="literal">OFF</code> (スレッドは存在しません)。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_NUMBER</code>, <code class="literal">LAST_ERROR_MESSAGE</code>
            </p><p>
              ワーカースレッドの停止の原因となった最新のエラーのエラー番号およびエラーメッセージ。 0 のエラー番号および空の文字列のメッセージは、<span class="quote">「<span class="quote">エラーなし</span>」</span>を示します <code class="literal">LAST_ERROR_MESSAGE</code> 値が空でない場合、エラー値はレプリカエラーログにも表示されます。 
            </p><p>
              <code class="literal">RESET MASTER</code> または <code class="literal">RESET REPLICA | SLAVE</code> を発行すると、これらのカラムに表示される値がリセットされます。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_TIMESTAMP</code>
            </p><p>
              最新のワーカーエラーがいつ発生したかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION</code>
            </p><p>
              このワーカーによって適用された最後のトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              このワーカーによって適用された最後のトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              このワーカーによって適用された最後のトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_START_APPLY_TIMESTAMP</code>
            </p><p>
              このワーカーが最後に適用されたトランザクションの適用をいつ開始したかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_END_APPLY_TIMESTAMP</code>
            </p><p>
              このワーカーが最後に適用されたトランザクションの適用を終了した時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION</code>
            </p><p>
              このワーカーが現在適用しているトランザクションのグローバルトランザクション ID (GTID)。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
            </p><p>
              このワーカーが現在適用しているトランザクションが元のソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
            </p><p>
              このワーカーが現在適用しているトランザクションが即時ソースでコミットされた時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_START_APPLY_TIMESTAMP</code>
            </p><p>
              このワーカーが現在適用されているトランザクションを最初に適用しようとした時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。 MySQL 8.0.13 より前は、このタイムスタンプは一時エラーのためにトランザクションが再試行されたときにリフレッシュされたため、トランザクションを適用しようとした最新のタイムスタンプが表示されていました。 
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_RETRIES_COUNT</code>
            </p><p>
              最初の試行後に最後に適用されたトランザクションがワーカーによって再試行された回数。 最初の試行でトランザクションが適用された場合、この数値はゼロです。 
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_LAST_TRANSIENT_ERROR_NUMBER</code>
            </p><p>
              トランザクションが再試行される原因となった最後の一時エラーのエラー番号。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_LAST_TRANSIENT_ERROR_MESSAGE</code>
            </p><p>
              トランザクションが再試行される原因となった最後の一時エラーのメッセージテキスト。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_APPLIED_TRANSACTION_LAST_TRANSIENT_ERROR_TIMESTAMP</code>
            </p><p>
              トランザクションが再試行される原因となった最後の一時エラーの<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_RETRIES_COUNT</code>
            </p><p>
              現在適用されているトランザクションがこの時点までに再試行された回数。 最初の試行でトランザクションが適用された場合、この数値はゼロです。 
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_LAST_TRANSIENT_ERROR_NUMBER</code>
            </p><p>
              現在のトランザクションが再試行される原因となった最後の一時エラーのエラー番号。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_LAST_TRANSIENT_ERROR_MESSAGE</code>
            </p><p>
              現在のトランザクションが再試行される原因となった最後の一時エラーのメッセージテキスト。
            </p></li><li class="listitem"><p>
              <code class="literal">APPLYING_TRANSACTION_LAST_TRANSIENT_ERROR_TIMESTAMP</code>
            </p><p>
              現在のトランザクションが再試行される原因となった最後の一時エラーの<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li></ul></div><p>
          <code class="literal">replication_applier_status_by_worker</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">CHANNEL_NAME</code>、<code class="literal">WORKER_ID</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>) のインデックス
            </p></li></ul></div><p>
          次のテーブルに、<code class="literal">replication_applier_status_by_worker</code> カラムと <code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラムの対応を示します。
        </p><div class="informaltable"><table summary="Correspondence between replication_applier_status_by_worker columns and SHOW REPLICA | SLAVE STATUS columns"><col width="60%"><col width="40%"><thead><tr>
              <th><code class="literal">replication_applier_status_by_worker</code> カラム</th>
              <th><code class="literal">SHOW REPLICA | SLAVE STATUS</code> カラム</th>
            </tr></thead><tbody><tr>
              <td><code class="literal">WORKER_ID</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">THREAD_ID</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">SERVICE_STATE</code></td>
              <td>なし</td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_NUMBER</code></td>
              <td><code class="literal">Last_SQL_Errno</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_MESSAGE</code></td>
              <td><code class="literal">Last_SQL_Error</code></td>
            </tr><tr>
              <td><code class="literal">LAST_ERROR_TIMESTAMP</code></td>
              <td><code class="literal">Last_SQL_Error_Timestamp</code></td>
            </tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-global-filters-table"></a>27.12.11.8 replication_applier_global_filters テーブル</h4></div></div></div><p>
          このテーブルには、このレプリカに構成されているグローバルレプリケーションフィルタが表示されます。 <code class="literal">replication_applier_global_filters</code> テーブルには、次のカラムがあります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FILTER_NAME</code>
            </p><p>
              構成されているレプリケーションフィルタのタイプ。
            </p></li><li class="listitem"><p>
              <code class="literal">FILTER_RULE</code>
            </p><p>
              <code class="option">--replicate-*</code> コマンドオプションまたは <code class="literal">CHANGE REPLICATION FILTER</code> を使用してレプリケーションフィルタタイプに構成されたルール。
            </p></li><li class="listitem"><p>
              <code class="literal">CONFIGURED_BY</code>
            </p><p>
              レプリケーションフィルタの構成に使用される方法は、次のいずれかです:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">CHANGE REPLICATION FILTER</code> ステートメントを使用してグローバルレプリケーションフィルタによって構成された <code class="literal">CHANGE_REPLICATION_FILTER</code>。
                </p></li><li class="listitem"><p>
                  <code class="option">--replicate-*</code> オプションを使用してグローバルレプリケーションフィルタによって構成された <code class="literal">STARTUP_OPTIONS</code>。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">ACTIVE_SINCE</code>
            </p><p>
              レプリケーションフィルタが構成された時点のタイムスタンプ。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-applier-filters-table"></a>27.12.11.9 replication_applier_filters テーブル</h4></div></div></div><p>
          このテーブルには、このレプリカに構成されているレプリケーションチャネル固有のフィルタが表示されます。 各行には、レプリケーションチャネルで構成されたフィルタのタイプに関する情報が表示されます。 <code class="literal">replication_applier_filters</code> テーブルには、次のカラムがあります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              レプリケーションフィルタが構成されているレプリケーションチャネルの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">FILTER_NAME</code>
            </p><p>
              このレプリケーションチャネルに構成されているレプリケーションフィルタのタイプ。
            </p></li><li class="listitem"><p>
              <code class="literal">FILTER_RULE</code>
            </p><p>
              <code class="option">--replicate-*</code> コマンドオプションまたは <code class="literal">CHANGE REPLICATION FILTER</code> を使用してレプリケーションフィルタタイプに構成されたルール。
            </p></li><li class="listitem"><p>
              <code class="literal">CONFIGURED_BY</code>
            </p><p>
              レプリケーションフィルタの構成に使用される方法は、次のいずれかです:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">CHANGE REPLICATION FILTER</code> ステートメントを使用してグローバルレプリケーションフィルタによって構成された <code class="literal">CHANGE_REPLICATION_FILTER</code>。
                </p></li><li class="listitem"><p>
                  <code class="option">--replicate-*</code> オプションを使用してグローバルレプリケーションフィルタによって構成された <code class="literal">STARTUP_OPTIONS</code>。
                </p></li><li class="listitem"><p>
                  <code class="literal">CHANGE REPLICATION FILTER FOR CHANNEL</code> ステートメントを使用してチャネル固有のレプリケーションフィルタによって構成された <code class="literal">CHANGE_REPLICATION_FILTER_FOR_CHANNEL</code>。
                </p></li><li class="listitem"><p>
                  <code class="option">--replicate-*</code> オプションを使用してチャネル固有のレプリケーションフィルタによって構成された <code class="literal">STARTUP_OPTIONS_FOR_CHANNEL</code>。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">ACTIVE_SINCE</code>
            </p><p>
              レプリケーションフィルタが構成された時点のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNTER</code>
            </p><p>
              レプリケーションフィルタが構成されてから使用された回数。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-group-members-table"></a>27.12.11.10 replication_group_members テーブル</h4></div></div></div><p>
          このテーブルは、レプリケーショングループメンバーのネットワークおよびステータス情報を示しています。 表示されるネットワークアドレスは、クライアントをグループに接続するために使用されるアドレスであり、<code class="literal">group_replication_local_address</code> で指定されたメンバー内部グループ通信アドレスと混同しないでください。 
        </p><p>
          <code class="literal">replication_group_members</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              グループレプリケーションチャネルの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_ID</code>
            </p><p>
              メンバーサーバー UUID。 これは、グループ内のメンバーごとに異なる値を持ちます。 これは、各メンバーに一意であるため、キーとしても機能します。 
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_HOST</code>
            </p><p>
              このメンバーのネットワークアドレス (ホスト名または IP アドレス)。 メンバー <code class="literal">hostname</code> 変数から取得されます。 これは、内部グループ通信に使用される group_replication_local_address とは異なり、クライアントが接続するアドレスです。 
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_PORT</code>
            </p><p>
              サーバーがリスニングしているポート。 メンバー <code class="literal">port</code> 変数から取得されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_STATE</code>
            </p><p>
              このメンバーの現在の状態。次のいずれかになります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">ONLINE</code>: メンバーは完全に機能している状態です。
                </p></li><li class="listitem"><p>
                  <code class="literal">RECOVERING</code>: サーバーは、データの取得元のグループに参加しました。
                </p></li><li class="listitem"><p>
                  <code class="literal">OFFLINE</code>: グループレプリケーションプラグインがインストールされていますが、起動されていません。
                </p></li><li class="listitem"><p>
                  <code class="literal">ERROR</code>: トランザクションの適用中またはリカバリフェーズ中にメンバーでエラーが発生し、グループトランザクションに参加していません。
                </p></li><li class="listitem"><p>
                  <code class="literal">UNREACHABLE</code>: 障害検出プロセスでは、グループメッセージがタイムアウトしたため、このメンバーに接続できないと疑われます。
                </p></li></ul></div><p>
              <a class="xref" href="group-replication.html#group-replication-server-states" title="18.3.1 グループレプリケーションサーバーの状態">セクション18.3.1「グループレプリケーションサーバーの状態」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_ROLE</code>
            </p><p>
              グループ内のメンバーのロール (<code class="literal">PRIMARY</code> または <code class="literal">SECONDARY</code>)。
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_VERSION</code>
            </p><p>
              メンバーの MySQL バージョン。
            </p></li></ul></div><p>
          <code class="literal">replication_group_members</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_group_members</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-replication-group-member-stats-table"></a>27.12.11.11 replication_group_member_stats テーブル</h4></div></div></div><p>
          このテーブルは、レプリケーショングループメンバーの統計情報を示しています。 これは、Group Replication が実行されている場合にのみ移入されます。 
        </p><p>
          <code class="literal">replication_group_member_stats</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL_NAME</code>
            </p><p>
              グループレプリケーションチャネルの名前
            </p></li><li class="listitem"><p>
              <code class="literal">VIEW_ID</code>
            </p><p>
              このグループの現在のビュー識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_ID</code>
            </p><p>
              メンバーサーバー UUID。 これは、グループ内のメンバーごとに異なる値を持ちます。 これは、各メンバーに一意であるため、キーとしても機能します。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_IN_QUEUE</code>
            </p><p>
              キュー内の保留中の競合検出チェックのトランザクション数。 トランザクションの競合がチェックされた後、チェックに合格すると、トランザクションも適用されるようにキューに入れられます。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_CHECKED</code>
            </p><p>
              競合がチェックされたトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_CONFLICTS_DETECTED</code>
            </p><p>
              競合検出チェックに合格していないトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_ROWS_VALIDATING</code>
            </p><p>
              動作保証に使用できるがガベージコレクションされていないトランザクション行の数。 各トランザクションが動作保証されている競合検出データベースの現在のサイズと考えることができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">TRANSACTIONS_COMMITTED_ALL_MEMBERS</code>
            </p><p>
              レプリケーショングループのすべてのメンバーで正常にコミットされたトランザクション (<a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID セット">GTID セット</a> として表示)。 これは固定時間間隔で更新されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_CONFLICT_FREE_TRANSACTION</code>
            </p><p>
              チェックされた最後の競合解消トランザクションのトランザクション識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_REMOTE_IN_APPLIER_QUEUE</code>
            </p><p>
              このメンバーがレプリケーショングループから受信し、適用を待機しているトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_REMOTE_APPLIED</code>
            </p><p>
              このメンバーがグループから受信して適用したトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_LOCAL_PROPOSED</code>
            </p><p>
              このメンバーで発生し、グループに送信されたトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_TRANSACTIONS_LOCAL_ROLLBACK</code>
            </p><p>
              このメンバーで発生し、グループによってロールバックされたトランザクションの数。
            </p></li></ul></div><p>
          <code class="literal">replication_group_member_stats</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">replication_group_member_stats</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-binary-log-transaction-compression-stats-table"></a>27.12.11.12 binary_log_transaction_compression_stats テーブル</h4></div></div></div><p>
          このテーブルは、バイナリログおよびリレーログに書き込まれたトランザクションペイロードの統計情報を示しており、バイナリログトランザクション圧縮を有効にした場合の影響を計算するために使用できます。 バイナリログトランザクションの圧縮については、<a class="xref" href="server-administration.html#binary-log-transaction-compression" title="5.4.4.5 バイナリログトランザクション圧縮">セクション5.4.4.5「バイナリログトランザクション圧縮」</a> を参照してください。 
        </p><p>
          <code class="literal">binary_log_transaction_compression_stats</code> テーブルは、サーバーインスタンスにバイナリログがあり、システム変数 <code class="literal">binlog_transaction_compression</code> が <code class="literal">ON</code> に設定されている場合にのみ移入されます。 統計には、サーバーの起動時またはテーブルの切り捨て時からバイナリログおよびリレーログに書き込まれたすべてのトランザクションが含まれます。 圧縮されたトランザクションは使用される圧縮アルゴリズムによってグループ化され、圧縮されていないトランザクションは <code class="literal">NONE</code> として示された圧縮アルゴリズムとともにグループ化されるため、圧縮率を計算できます。 
        </p><p>
          <code class="literal">binary_log_transaction_compression_stats</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">LOG_TYPE</code>
            </p><p>
              これらのトランザクションがバイナリログに書き込まれたかリレーログに書き込まれたか。
            </p></li><li class="listitem"><p>
              <code class="literal">COMPRESSION_TYPE</code>
            </p><p>
              トランザクションペイロードの圧縮に使用される圧縮アルゴリズム。 <code class="literal">NONE</code> は、これらのトランザクションのペイロードが圧縮されなかったことを意味します。これは、多くの状況で適切です (<a class="xref" href="server-administration.html#binary-log-transaction-compression" title="5.4.4.5 バイナリログトランザクション圧縮">セクション5.4.4.5「バイナリログトランザクション圧縮」</a> を参照)。 
            </p></li><li class="listitem"><p>
              <code class="literal">TRANSACTION_COUNTER</code>
            </p><p>
              この圧縮タイプでこのログタイプに書き込まれたトランザクションの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COMPRESSED_BYTES</code>
            </p><p>
              圧縮され、圧縮後にこの圧縮タイプでこのログタイプに書き込まれた合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">UNCOMPRESSED_BYTES</code>
            </p><p>
              このログタイプおよびこの圧縮タイプの圧縮前の合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">COMPRESSION_PERCENTAGE</code>
            </p><p>
              このログタイプおよびこの圧縮タイプの圧縮率で、パーセンテージで表されます。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_TRANSACTION_ID</code>
            </p><p>
              この圧縮タイプでこのログタイプに書き込まれた最初のトランザクションの ID。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_TRANSACTION_COMPRESSED_BYTES</code>
            </p><p>
              圧縮後に最初のトランザクションで圧縮されてログに書き込まれた合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_TRANSACTION_UNCOMPRESSED_BYTES</code>
            </p><p>
              最初のトランザクションの圧縮前の合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_TRANSACTION_TIMESTAMP</code>
            </p><p>
              最初のトランザクションがログに書き込まれたときのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_TRANSACTION_ID</code>
            </p><p>
              この圧縮タイプでこのログタイプに書き込まれた最新のトランザクションの ID。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_TRANSACTION_COMPRESSED_BYTES</code>
            </p><p>
              圧縮後にカウントされた、圧縮されて最新のトランザクションのログに書き込まれた合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_TRANSACTION_UNCOMPRESSED_BYTES</code>
            </p><p>
              最新のトランザクションの圧縮前の合計バイト数。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_TRANSACTION_TIMESTAMP</code>
            </p><p>
              最新のトランザクションがログに書き込まれたときのタイムスタンプ。
            </p></li></ul></div><p>
          <code class="literal">binary_log_transaction_compression_stats</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">binary_log_transaction_compression_stats</code> テーブルに対して許可されています。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-ndb-cluster-tables"></a>27.12.12 パフォーマンススキーマ NDB Cluster テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-ndb-sync-pending-objects-table">27.12.12.1 ndb_sync_pending_objects テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-ndb-sync-excluded-objects-table">27.12.12.2 ndb_sync_excluded_objects テーブル</a></span></dt></dl></div><p>
        NDB 8.0.16 以降、<code class="literal">NDB</code> の自動同期は NDB Cluster 内部ディクショナリと MySQL Server データディクショナリの間のメタデータのすべての不一致を自動的に検出して同期しようとします。 これは、<code class="literal">ndb_metadata_check</code> を使用して無効にしたり、<code class="literal">ndb_metadata_sync</code> を設定してオーバーライドしたりしないかぎり、デフォルトで <code class="literal">ndb_metadata_check_interval</code> システム変数によって決定される一定の間隔でバックグラウンドで実行されます。 NDB 8.0.21 より前は、このプロセスに関してユーザーがすぐにアクセスできる情報は、ステータス変数 <code class="literal">Ndb_metadata_detected_count</code>、<code class="literal">Ndb_metadata_synced_count</code>、および <code class="literal">Ndb_metadata_excluded_count</code> (NDB 8.0.22 より前) として使用可能なロギングメッセージとオブジェクト数の形式のみで利用可能でした (NDB 8.0.18 から)、(ステータス変数 <code class="literal">Ndb_metadata_detected_count</code>、<code class="literal">Ndb_metadata_synced_count</code>、および <code class="literal">Ndb_metadata_excluded_count</code>) (NDB 8.0.22 以前、この変数は <code class="literal">Ndb_metadata_blacklist_size</code> という名前でした)。 NDB 8.0.21 以降、自動同期の現在の状態に関するより詳細な情報は、NDB クラスタ内で次の 2 つの「パフォーマンススキーマ」テーブルで SQL ノードとして機能する MySQL サーバーによって公開されます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ndb_sync_pending_objects</code>: <code class="literal">NDB</code> ディクショナリと MySQL データディクショナリの間で不一致が検出された <code class="literal">NDB</code> データベースオブジェクトに関する情報を表示します。 このようなオブジェクトを同期しようとすると、<code class="literal">NDB</code> は同期を待機しているキューおよびこのテーブルからオブジェクトを削除し、不一致の調整を試みます。 一時エラーのためにオブジェクトの同期が失敗した場合、次回 <code class="literal">NDB</code> が不一致検出を実行したときに、オブジェクトが取得されてキュー (およびこのテーブル) に追加されます。永続エラーのために試行が失敗した場合、オブジェクトは <code class="literal">ndb_sync_excluded_objects</code> テーブルに追加されます。 
          </p></li><li class="listitem"><p>
            <code class="literal">ndb_sync_excluded_objects</code>: 不一致による永続的エラーのために自動同期が失敗した <code class="literal">NDB</code> データベースオブジェクトに関する情報を表示します。これらのオブジェクトは手動操作なしではリコンサイルできません。これらのオブジェクトはブロックされ、これが完了するまで不一致検出のために再度考慮されません。
          </p></li></ul></div><p>
        <code class="literal">ndb_sync_pending_objects</code> および <code class="literal">ndb_sync_excluded_objects</code> テーブルは、MySQL で <code class="literal">NDBCLUSTER</code> ストレージエンジンのサポートが有効になっている場合にのみ存在します。
      </p><p>
        これらのテーブルについては、次の 2 つのセクションで詳しく説明します。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-ndb-sync-pending-objects-table"></a>27.12.12.1 ndb_sync_pending_objects テーブル</h4></div></div></div><p>
          このテーブルは、不一致が検出され、<code class="literal">NDB</code> ディクショナリと MySQL データディクショナリ間の同期を待機している <code class="literal">NDB</code> データベースオブジェクトに関する情報を示します。
        </p><p>
          同期を待機している <code class="literal">NDB</code> データベースオブジェクトに関する情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.ndb_sync_pending_objects;</code></strong>
+-------------+------+----------------+
| SCHEMA_NAME | NAME |  TYPE          |
+-------------+------+----------------+
| NULL        | lg1  |  LOGFILE GROUP |
| NULL        | ts1  |  TABLESPACE    |
| db1         | NULL |  SCHEMA        |
| test        | t1   |  TABLE         |
| test        | t2   |  TABLE         |
| test        | t3   |  TABLE         |
+-------------+------+----------------+
</pre><p>
          <code class="literal">ndb_sync_pending_objects</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SCHEMA_NAME</code>: 同期を待機しているオブジェクトが存在するスキーマ (データベース) の名前。これは、テーブルスペースおよびログファイルグループの <code class="literal">NULL</code> です
            </p></li><li class="listitem"><p>
              <code class="literal">NAME</code>: 同期を待機しているオブジェクトの名前。オブジェクトがスキーマの場合は <code class="literal">NULL</code> です
            </p></li><li class="listitem"><p>
              <code class="literal">TYPE</code>: 同期を待機しているオブジェクトのタイプ (<code class="literal">LOGFILE GROUP</code>, <code class="literal">TABLESPACE</code>, <code class="literal">SCHEMA</code> または <code class="literal">TABLE</code> のいずれか)
            </p></li></ul></div><p>
          NDB 8.0.21 に <code class="literal">ndb_sync_pending_objects</code> テーブルが追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-ndb-sync-excluded-objects-table"></a>27.12.12.2 ndb_sync_excluded_objects テーブル</h4></div></div></div><p>
          このテーブルは、NDB Cluster ディクショナリと MySQL データディクショナリの間で自動的に同期できない <code class="literal">NDB</code> データベースオブジェクトに関する情報を提供します。
        </p><p>
          MySQL データディクショナリと同期できない <code class="literal">NDB</code> データベースオブジェクトに関する情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.ndb_sync_excluded_objects\G</code></strong>
*************************** 1. row ***************************
SCHEMA_NAME: NULL
       NAME: lg1
       TYPE: LOGFILE GROUP
     REASON: Injected failure
*************************** 2. row ***************************
SCHEMA_NAME: NULL
       NAME: ts1
       TYPE: TABLESPACE
     REASON: Injected failure
*************************** 3. row ***************************
SCHEMA_NAME: db1
       NAME: NULL
       TYPE: SCHEMA
     REASON: Injected failure
*************************** 4. row ***************************
SCHEMA_NAME: test
       NAME: t1
       TYPE: TABLE
     REASON: Injected failure
*************************** 5. row ***************************
SCHEMA_NAME: test
       NAME: t2
       TYPE: TABLE
     REASON: Injected failure
*************************** 6. row ***************************
SCHEMA_NAME: test
       NAME: t3
       TYPE: TABLE
     REASON: Injected failure
</pre><p>
          <code class="literal">ndb_sync_excluded_objects</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SCHEMA_NAME</code>: 同期に失敗したオブジェクトが存在するスキーマ (データベース) の名前。これは、テーブルスペースおよびログファイルグループの <code class="literal">NULL</code> です
            </p></li><li class="listitem"><p>
              <code class="literal">NAME</code>: 同期に失敗したオブジェクトの名前。オブジェクトがスキーマの場合は <code class="literal">NULL</code> です
            </p></li><li class="listitem"><p>
              <code class="literal">TYPE</code>: オブジェクトのタイプが同期に失敗しました。これは <code class="literal">LOGFILE GROUP</code>, <code class="literal">TABLESPACE</code>, <code class="literal">SCHEMA</code> または <code class="literal">TABLE</code> のいずれかです
            </p></li><li class="listitem"><p>
              <code class="literal">REASON</code>: オブジェクトの除外 (ブロックリスト) の理由、つまり、このオブジェクトの同期化に失敗した理由
            </p><p>
              考えられる原因は次のとおりです:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">Injected failure</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to determine if object existed in NDB</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to determine if object existed in DD</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to drop object in DD</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to get undofiles assigned to logfile group</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to get object id and version</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to install object in DD</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to get datafiles assigned to tablespace</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to create schema</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to determine if object was a local table</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to invalidate table references</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to set database name of NDB object</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to get extra metadata of table</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to migrate table with extra metadata version 1</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to get object from DD</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Definition of table has changed in NDB Dictionary</code>
                </p></li><li class="listitem"><p>
                  <code class="literal">Failed to setup binlogging for table</code>
                </p></li></ul></div><p>
              このリストは必ずしも完全ではなく、将来の <code class="literal">NDB</code> リリースで変更される可能性があります。
            </p></li></ul></div><p>
          NDB 8.0.21 に <code class="literal">ndb_sync_excluded_objects</code> テーブルが追加されました。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-lock-tables"></a>27.12.13 パフォーマンススキーマロックテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-data-locks-table">27.12.13.1 data_locks テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-data-lock-waits-table">27.12.13.2 data_lock_waits テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-metadata-locks-table">27.12.13.3 metadata_locks テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-handles-table">27.12.13.4 table_handles テーブル</a></span></dt></dl></div><p>
        パフォーマンススキーマは、次のテーブルを介してロック情報を公開します:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">data_locks</code>: 保持およびリクエストされたデータロック
          </p></li><li class="listitem"><p>
            <code class="literal">data_lock_waits</code>: データロック所有者とその所有者によってブロックされたデータロックリクエスタの関係
          </p></li><li class="listitem"><p>
            <code class="literal">metadata_locks</code>: メタデータロックの保持およびリクエスト
          </p></li><li class="listitem"><p>
            <code class="literal">table_handles</code>: 保持およびリクエストされたテーブルロック
          </p></li></ul></div><p>
        次の各セクションでは、これらのテーブルについて詳しく説明します。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-data-locks-table"></a>27.12.13.1 data_locks テーブル</h4></div></div></div><a class="indexterm" name="idm45882608407776"></a><a class="indexterm" name="idm45882608405600"></a><p>
          <code class="literal">data_locks</code> テーブルには、保持およびリクエストされたデータロックが表示されます。 どのロック要求がどの保持ロックによってブロックされるかについては、<a class="xref" href="performance-schema.html#performance-schema-data-lock-waits-table" title="27.12.13.2 data_lock_waits テーブル">セクション27.12.13.2「data_lock_waits テーブル」</a> を参照してください。 
        </p><p>
          データロック情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.data_locks\G</code></strong>
*************************** 1. row ***************************
               ENGINE: INNODB
       ENGINE_LOCK_ID: 139664434886512:1059:139664350547912
ENGINE_TRANSACTION_ID: 2569
            THREAD_ID: 46
             EVENT_ID: 12
        OBJECT_SCHEMA: test
          OBJECT_NAME: t1
       PARTITION_NAME: NULL
    SUBPARTITION_NAME: NULL
           INDEX_NAME: NULL
OBJECT_INSTANCE_BEGIN: 139664350547912
            LOCK_TYPE: TABLE
            LOCK_MODE: IX
          LOCK_STATUS: GRANTED
            LOCK_DATA: NULL
*************************** 2. row ***************************
               ENGINE: INNODB
       ENGINE_LOCK_ID: 139664434886512:2:4:1:139664350544872
ENGINE_TRANSACTION_ID: 2569
            THREAD_ID: 46
             EVENT_ID: 12
        OBJECT_SCHEMA: test
          OBJECT_NAME: t1
       PARTITION_NAME: NULL
    SUBPARTITION_NAME: NULL
           INDEX_NAME: GEN_CLUST_INDEX
OBJECT_INSTANCE_BEGIN: 139664350544872
            LOCK_TYPE: RECORD
            LOCK_MODE: X
          LOCK_STATUS: GRANTED
            LOCK_DATA: supremum pseudo-record
</pre><p>
          ほとんどのパフォーマンススキーマデータ収集とは異なり、データロック情報を収集するか、データロックテーブルのサイズを制御するためのシステム変数を制御するためのインストゥルメントはありません。 パフォーマンススキーマは、サーバーですでに使用可能な情報を収集するため、この情報を生成したり、その収集を制御するパラメータを必要とするメモリーまたは CPU のオーバーヘッドはありません。 
        </p><p>
          <code class="literal">data_locks</code> テーブルを使用すると、負荷が高いときに発生するパフォーマンスの問題の診断に役立ちます。 <code class="literal">InnoDB</code> については、<a class="xref" href="innodb-storage-engine.html#innodb-information-schema-transactions" title="15.15.2 InnoDB INFORMATION_SCHEMA トランザクションおよびロック情報">セクション15.15.2「InnoDB INFORMATION_SCHEMA トランザクションおよびロック情報」</a> でこのトピックの説明を参照してください。 
        </p><p>
          <code class="literal">data_locks</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ENGINE</code>
            </p><p>
              ロックを保持または要求したストレージエンジン。
            </p></li><li class="listitem"><p>
              <code class="literal">ENGINE_LOCK_ID</code>
            </p><p>
              ストレージエンジンによって保持または要求されたロックの ID。 (<code class="literal">ENGINE_LOCK_ID</code>、<code class="literal">ENGINE</code>) 値のタプルは一意です。 
            </p><p>
              「ロック ID」形式は内部形式であり、いつでも変更される可能性があります。 アプリケーションは、特定の形式のロック ID に依存しないでください。 
            </p></li><li class="listitem"><p>
              <code class="literal">ENGINE_TRANSACTION_ID</code>
            </p><p>
              ロックを要求したトランザクションのストレージエンジン内部 ID。 これはロックの所有者とみなすことができますが、ロックはまだ保留中であり、実際にはまだ付与されていない可能性があります (<code class="literal">LOCK_STATUS='WAITING'</code>)。 
            </p><p>
              トランザクションがまだ書込み操作を実行していない場合 (読取り専用とみなされます)、カラムにはユーザーが解釈しようとしない内部データが含まれます。 それ以外の場合、カラムはトランザクション ID です。 
            </p><p>
              <code class="literal">InnoDB</code> の場合、トランザクションの詳細を取得するには、このカラムを <code class="literal">INFORMATION_SCHEMA</code> <code class="literal">INNODB_TRX</code> テーブルの <code class="literal">TRX_ID</code> カラムと結合します。
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              ロックを作成したセッションのスレッド ID。 スレッドの詳細を取得するには、このカラムをパフォーマンススキーマ <code class="literal">threads</code> テーブルの <code class="literal">THREAD_ID</code> カラムと結合します。 
            </p><p>
              <code class="literal">THREAD_ID</code> を <code class="literal">EVENT_ID</code> とともに使用して、メモリー内にロックデータ構造が作成されたイベントを判別できます。 (このイベントは、データ構造を使用して複数のロックが格納されている場合、この特定のロックリクエストが発生する前に発生した可能性があります。) 
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_ID</code>
            </p><p>
              ロックの原因となったパフォーマンススキーマイベント。 (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>) 値のタプルは、他の「パフォーマンススキーマ」テーブルの親イベントを暗黙的に識別します: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">events_waits_<em class="replaceable"><code>xxx</code></em></code> テーブルの親待機イベント
                </p></li><li class="listitem"><p>
                  <code class="literal">events_stages_<em class="replaceable"><code>xxx</code></em></code> テーブルの親ステージイベント
                </p></li><li class="listitem"><p>
                  <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> テーブルの親ステートメントイベント
                </p></li><li class="listitem"><p>
                  <code class="literal">events_transactions_current</code> テーブルの親トランザクションイベント
                </p></li></ul></div><p>
              親イベントの詳細を取得するには、<code class="literal">THREAD_ID</code> カラムと <code class="literal">EVENT_ID</code> カラムを適切な親イベントテーブルの同名のカラムと結合します。 <a class="xref" href="performance-schema.html#performance-schema-obtaining-parent-events" title="27.19.2 親イベント情報の取得">セクション27.19.2「親イベント情報の取得」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              ロックされたテーブルを含むスキーマ。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              ロックされたテーブルの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">PARTITION_NAME</code>
            </p><p>
              ロックされたパーティションの名前 (存在する場合)。それ以外の場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">SUBPARTITION_NAME</code>
            </p><p>
              ロックされたサブパーティションの名前 (存在する場合)。それ以外の場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">INDEX_NAME</code>
            </p><p>
              ロックされたインデックスの名前 (存在する場合)。それ以外の場合は <code class="literal">NULL</code>。
            </p><p>
              実際には、<code class="literal">InnoDB</code> は常にインデックス (<code class="literal">GEN_CLUST_INDEX</code>) を作成するため、<code class="literal">INDEX_NAME</code> は <code class="literal">InnoDB</code> テーブルに対して <code class="literal">NULL</code> 以外です。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              ロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_TYPE</code>
            </p><p>
              ロックのタイプ。
            </p><p>
              この値はストレージエンジンに依存します。 <code class="literal">InnoDB</code> の場合、許可される値は、行レベルロックの場合は <code class="literal">RECORD</code>、テーブルレベルロックの場合は <code class="literal">TABLE</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_MODE</code>
            </p><p>
              ロックのリクエスト方法。
            </p><p>
              この値はストレージエンジンに依存します。 <code class="literal">InnoDB</code> の場合、許可される値は <code class="literal">S[,GAP]</code>, <code class="literal">X[,GAP]</code>, <code class="literal">IS[,GAP]</code>, <code class="literal">IX[,GAP]</code>, <code class="literal">AUTO_INC</code> および <code class="literal">UNKNOWN</code> です。 <code class="literal">AUTO_INC</code> および <code class="literal">UNKNOWN</code> 以外のロックモードは、ギャップロック (存在する場合) を示します。 <code class="literal">S</code>, <code class="literal">X</code>, <code class="literal">IS</code>, <code class="literal">IX</code> およびギャップロックの詳細は、<a class="xref" href="innodb-storage-engine.html#innodb-locking" title="15.7.1 InnoDB ロック">セクション15.7.1「InnoDB ロック」</a> を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_STATUS</code>
            </p><p>
              ロックリクエストのステータス。
            </p><p>
              この値はストレージエンジンに依存します。 <code class="literal">InnoDB</code> の場合、許可される値は、<code class="literal">GRANTED</code> (ロックが保持されている) および <code class="literal">WAITING</code> (ロックが待機されている) です。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_DATA</code>
            </p><p>
              ロックに関連付けられているデータ (ある場合)。 この値はストレージエンジンに依存します。 <code class="literal">InnoDB</code> の場合、<code class="literal">LOCK_TYPE</code> が <code class="literal">RECORD</code> の場合は値が表示され、それ以外の場合は <code class="literal">NULL</code> 値が表示されます。 ロックされたレコードの主キー値は、主キーインデックスに設定されたロックに対して表示されます。 ロックされたレコードのセカンダリインデックス値が表示され、セカンダリインデックスに配置されたロックに主キー値が追加されます。 主キーがない場合、<code class="literal">LOCK_DATA</code> では、<code class="literal">InnoDB</code> クラスタインデックスの使用を制御するルールに従って、選択した一意インデックスのキー値または一意の <code class="literal">InnoDB</code> 内部行 ID 番号のいずれかが表示されます (<a class="xref" href="innodb-storage-engine.html#innodb-index-types" title="15.6.2.1 クラスタインデックスとセカンダリインデックス">セクション15.6.2.1「クラスタインデックスとセカンダリインデックス」</a> を参照)。 <code class="literal">LOCK_DATA</code> は、supremum 擬似レコードで取得されたロックについて<span class="quote">「<span class="quote">「supremum 擬似レコード」</span>」</span>を報告します。 ロックされたレコードを含むページが、ロックの保持中にディスクに書き込まれたためにバッファプールにない場合、<code class="literal">InnoDB</code> はディスクからページをフェッチしません。 かわりに、<code class="literal">LOCK_DATA</code> は <code class="literal">NULL</code> をレポートします。 
            </p></li></ul></div><p>
          <code class="literal">data_locks</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">ENGINE_LOCK_ID</code>、<code class="literal">ENGINE</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">ENGINE_TRANSACTION_ID</code>、<code class="literal">ENGINE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>, <code class="literal">PARTITION_NAME</code>, <code class="literal">SUBPARTITION_NAME</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">data_locks</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-data-lock-waits-table"></a>27.12.13.2 data_lock_waits テーブル</h4></div></div></div><a class="indexterm" name="idm45882608286288"></a><a class="indexterm" name="idm45882608284080"></a><p>
          <code class="literal">data_lock_waits</code> テーブルには、<code class="literal">data_locks</code> テーブルのどのデータロックリクエストが <code class="literal">data_locks</code> テーブルのどのデータロックによってブロックされているかを示す多対多関係が実装されています。 <code class="literal">data_locks</code> で保持されているロックは、ロックリクエストがブロックされている場合にのみ <code class="literal">data_lock_waits</code> に表示されます。 
        </p><p>
          この情報を使用すると、セッション間のデータロックの依存性を理解できます。 テーブルには、セッションまたはトランザクションが待機しているロックだけでなく、そのロックを現在保持しているセッションまたはトランザクションが表示されます。 
        </p><p>
          データロック待機情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.data_lock_waits\G</code></strong>
*************************** 1. row ***************************
                          ENGINE: INNODB
       REQUESTING_ENGINE_LOCK_ID: 140211201964816:2:4:2:140211086465800
REQUESTING_ENGINE_TRANSACTION_ID: 1555
            REQUESTING_THREAD_ID: 47
             REQUESTING_EVENT_ID: 5
REQUESTING_OBJECT_INSTANCE_BEGIN: 140211086465800
         BLOCKING_ENGINE_LOCK_ID: 140211201963888:2:4:2:140211086459880
  BLOCKING_ENGINE_TRANSACTION_ID: 1554
              BLOCKING_THREAD_ID: 46
               BLOCKING_EVENT_ID: 12
  BLOCKING_OBJECT_INSTANCE_BEGIN: 140211086459880
</pre><p>
          ほとんどのパフォーマンススキーマデータ収集とは異なり、データロック情報を収集するか、データロックテーブルのサイズを制御するためのシステム変数を制御するためのインストゥルメントはありません。 パフォーマンススキーマは、サーバーですでに使用可能な情報を収集するため、この情報を生成したり、その収集を制御するパラメータを必要とするメモリーまたは CPU のオーバーヘッドはありません。 
        </p><p>
          <code class="literal">data_lock_waits</code> テーブルを使用すると、負荷が高いときに発生するパフォーマンスの問題の診断に役立ちます。 <code class="literal">InnoDB</code> については、<a class="xref" href="innodb-storage-engine.html#innodb-information-schema-transactions" title="15.15.2 InnoDB INFORMATION_SCHEMA トランザクションおよびロック情報">セクション15.15.2「InnoDB INFORMATION_SCHEMA トランザクションおよびロック情報」</a> でこのトピックの説明を参照してください。 
        </p><p>
          <code class="literal">data_lock_waits</code> テーブルのカラムは <code class="literal">data_locks</code> テーブルのカラムと似ているため、ここでのカラムの説明は省略されています。 カラムの詳細は、<a class="xref" href="performance-schema.html#performance-schema-data-locks-table" title="27.12.13.1 data_locks テーブル">セクション27.12.13.1「data_locks テーブル」</a> を参照してください。 
        </p><p>
          <code class="literal">data_lock_waits</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ENGINE</code>
            </p><p>
              ロックを要求したストレージエンジン。
            </p></li><li class="listitem"><p>
              <code class="literal">REQUESTING_ENGINE_LOCK_ID</code>
            </p><p>
              ストレージエンジンによって要求されたロックの ID。 ロックの詳細を取得するには、このカラムを <code class="literal">data_locks</code> テーブルの <code class="literal">ENGINE_LOCK_ID</code> カラムと結合します。 
            </p></li><li class="listitem"><p>
              <code class="literal">REQUESTING_ENGINE_TRANSACTION_ID</code>
            </p><p>
              ロックを要求したトランザクションのストレージエンジン内部 ID。
            </p></li><li class="listitem"><p>
              <code class="literal">REQUESTING_THREAD_ID</code>
            </p><p>
              ロックをリクエストしたセッションのスレッド ID。
            </p></li><li class="listitem"><p>
              <code class="literal">REQUESTING_EVENT_ID</code>
            </p><p>
              ロックを要求したセッションでロック要求を引き起こしたパフォーマンススキーマイベント。
            </p></li><li class="listitem"><p>
              <code class="literal">REQUESTING_OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              要求されたロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">BLOCKING_ENGINE_LOCK_ID</code>
            </p><p>
              ブロッキングロックの ID。 ロックの詳細を取得するには、このカラムを <code class="literal">data_locks</code> テーブルの <code class="literal">ENGINE_LOCK_ID</code> カラムと結合します。 
            </p></li><li class="listitem"><p>
              <code class="literal">BLOCKING_ENGINE_TRANSACTION_ID</code>
            </p><p>
              ブロッキングロックを保持するトランザクションのストレージエンジン内部 ID。
            </p></li><li class="listitem"><p>
              <code class="literal">BLOCKING_THREAD_ID</code>
            </p><p>
              ブロッキングロックを保持するセッションのスレッド ID。
            </p></li><li class="listitem"><p>
              <code class="literal">BLOCKING_EVENT_ID</code>
            </p><p>
              パフォーマンススキーマを保持しているセッションでブロッキングロックの原因となったパフォーマンススキーマイベント。
            </p></li><li class="listitem"><p>
              <code class="literal">BLOCKING_OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              ブロッキングロックのメモリー内のアドレス。
            </p></li></ul></div><p>
          <code class="literal">data_lock_waits</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              (<code class="literal">REQUESTING_ENGINE_LOCK_ID</code>、<code class="literal">ENGINE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">BLOCKING_ENGINE_LOCK_ID</code>、<code class="literal">ENGINE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">REQUESTING_ENGINE_TRANSACTION_ID</code>、<code class="literal">ENGINE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">BLOCKING_ENGINE_TRANSACTION_ID</code>、<code class="literal">ENGINE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">REQUESTING_THREAD_ID</code>、<code class="literal">REQUESTING_EVENT_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">BLOCKING_THREAD_ID</code>、<code class="literal">BLOCKING_EVENT_ID</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">data_lock_waits</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-metadata-locks-table"></a>27.12.13.3 metadata_locks テーブル</h4></div></div></div><a class="indexterm" name="idm45882608217008"></a><a class="indexterm" name="idm45882608214864"></a><a class="indexterm" name="idm45882608212896"></a><p>
          MySQL では、メタデータロックを使用して、データベースオブジェクトへの同時アクセスを管理し、データの一貫性を確保します。<a class="xref" href="optimization.html#metadata-locking" title="8.11.4 メタデータのロック">セクション8.11.4「メタデータのロック」</a> を参照してください。 メタデータのロックは、テーブルのみでなく、スキーマ、ストアドプログラム (プロシージャ、ファンクション、トリガー、スケジュール済イベント)、テーブルスペース、<code class="literal">GET_LOCK()</code> 関数で取得されたユーザーロック (<a class="xref" href="functions.html#locking-functions" title="12.15 ロック関数">セクション12.15「ロック関数」</a> を参照)、および <a class="xref" href="server-administration.html#locking-service" title="5.6.8.1 ロックサービス">セクション5.6.8.1「ロックサービス」</a> で説明されているロックサービスで取得されたロックにも適用されます。 
        </p><p>
          パフォーマンススキーマは、<code class="literal">metadata_locks</code> テーブルを介してメタデータロック情報を公開します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              付与されているロック (現在どのセッションがどのメタデータロックを所有しているかが表示されます)。
            </p></li><li class="listitem"><p>
              リクエストされたがまだ付与されていないロック (どのセッションがどのメタデータロックを待機しているかを示します)。
            </p></li><li class="listitem"><p>
              デッドロック検出機能によって強制終了されたロックリクエスト。
            </p></li><li class="listitem"><p>
              タイムアウトし、リクエストしているセッションロックリクエストが破棄されるのを待機しているロックリクエスト。
            </p></li></ul></div><p>
          この情報を使用すると、セッション間のメタデータロックの依存性を理解できます。 セッションが待機しているロックだけでなく、そのロックを現在保持しているセッションも表示できます。 
        </p><p>
          <code class="literal">metadata_locks</code> テーブルは読取り専用であり、更新できません。 デフォルトでは自動サイズ設定されています。テーブルサイズを構成するには、サーバーの起動時に <code class="literal">performance_schema_max_metadata_locks</code> システム変数を設定します。 
        </p><p>
          メタデータロックインストゥルメンテーションでは、デフォルトで有効になっている <code class="literal">wait/lock/metadata/sql/mdl</code> インストゥルメントが使用されます。
        </p><p>
          サーバー起動時のメタデータロックインストゥルメンテーションの状態を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              有効化:
            </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/lock/metadata/sql/mdl=ON'
</pre></li><li class="listitem"><p>
              無効化:
            </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/lock/metadata/sql/mdl=OFF'
</pre></li></ul></div><p>
          実行時にメタデータロックインストゥルメンテーションの状態を制御するには、<code class="literal">setup_instruments</code> テーブルを更新します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              有効化:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME = 'wait/lock/metadata/sql/mdl';
</pre></li><li class="listitem"><p>
              無効化:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME = 'wait/lock/metadata/sql/mdl';
</pre></li></ul></div><p>
          パフォーマンススキーマは、<code class="literal">LOCK_STATUS</code> カラムを使用して各ロックのステータスを示す <code class="literal">metadata_locks</code> テーブルの内容を次のように保守します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              メタデータロックがリクエストされてすぐに取得されると、ステータスが <code class="literal">GRANTED</code> の行が挿入されます。
            </p></li><li class="listitem"><p>
              メタデータロックがリクエストされ、すぐに取得されない場合、ステータスが <code class="literal">PENDING</code> の行が挿入されます。
            </p></li><li class="listitem"><p>
              以前にリクエストされたメタデータロックが付与されると、その行ステータスは <code class="literal">GRANTED</code> に更新されます。
            </p></li><li class="listitem"><p>
              メタデータロックが解放されると、その行は削除されます。
            </p></li><li class="listitem"><p>
              デッドロック検出でデッドロック (<code class="literal">ER_LOCK_DEADLOCK</code>) を解除するために保留中のロックリクエストが取り消されると、その行ステータスが <code class="literal">PENDING</code> から <code class="literal">VICTIM</code> に更新されます。
            </p></li><li class="listitem"><p>
              保留中のロックリクエスト (<code class="literal">ER_LOCK_WAIT_TIMEOUT</code>) がタイムアウトすると、その行ステータスが <code class="literal">PENDING</code> から <code class="literal">TIMEOUT</code> に更新されます。
            </p></li><li class="listitem"><p>
              ロックまたは保留中のロックリクエストが強制終了されると、その行ステータスが <code class="literal">GRANTED</code> または <code class="literal">PENDING</code> から <code class="literal">KILLED</code> に更新されます。
            </p></li><li class="listitem"><p>
              <code class="literal">VICTIM</code>、<code class="literal">TIMEOUT</code> および <code class="literal">KILLED</code> のステータス値は簡潔で、ロック行が削除されようとしていることを示します。
            </p></li><li class="listitem"><p>
              <code class="literal">PRE_ACQUIRE_NOTIFY</code> および <code class="literal">POST_RELEASE_NOTIFY</code> のステータス値は簡潔であり、ロック取得操作の開始中またはロック解放操作の終了中に、メタデータロックサブシステムが関連するストレージエンジンに通知していることを示します。
            </p></li></ul></div><p>
          <code class="literal">metadata_locks</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              メタデータロックサブシステムで使用されるロックのタイプ。 値は、<code class="literal">GLOBAL</code>, <code class="literal">SCHEMA</code>, <code class="literal">TABLE</code>, <code class="literal">FUNCTION</code>, <code class="literal">PROCEDURE</code>, <code class="literal">TRIGGER</code> (現在未使用)、<code class="literal">EVENT</code>, <code class="literal">COMMIT</code>, <code class="literal">USER LEVEL LOCK</code>, <code class="literal">TABLESPACE</code> または <code class="literal">LOCKING SERVICE</code> のいずれかです。 
            </p><p>
              <code class="literal">USER LEVEL LOCK</code> の値は、<code class="literal">GET_LOCK()</code> で取得されたロックを示します。 <code class="literal">LOCKING SERVICE</code> の値は、<a class="xref" href="server-administration.html#locking-service" title="5.6.8.1 ロックサービス">セクション5.6.8.1「ロックサービス」</a> で説明されているロックサービスで取得されたロックを示します。 
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              オブジェクトを格納するスキーマ。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              インストゥルメントされたオブジェクトの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされたオブジェクトのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_TYPE</code>
            </p><p>
              メタデータロックサブシステムからのロックタイプ。 値は、<code class="literal">INTENTION_EXCLUSIVE</code>, <code class="literal">SHARED</code>, <code class="literal">SHARED_HIGH_PRIO</code>, <code class="literal">SHARED_READ</code>, <code class="literal">SHARED_WRITE</code>, <code class="literal">SHARED_UPGRADABLE</code>, <code class="literal">SHARED_NO_WRITE</code>, <code class="literal">SHARED_NO_READ_WRITE</code> または <code class="literal">EXCLUSIVE</code> のいずれかです。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_DURATION</code>
            </p><p>
              メタデータロックサブシステムからのロック期間。 値は、<code class="literal">STATEMENT</code>、<code class="literal">TRANSACTION</code> または <code class="literal">EXPLICIT</code> のいずれかです。 <code class="literal">STATEMENT</code> および <code class="literal">TRANSACTION</code> の値は、それぞれステートメントまたはトランザクションの終了時に暗黙的に解放されるロックを示します。 <code class="literal">EXPLICIT</code> の値は、残りのステートメントまたはトランザクションが終了し、<code class="literal">FLUSH TABLES WITH READ LOCK</code> で取得されたグローバルロックなどの明示的なアクションによって解放されるロックを示します。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_STATUS</code>
            </p><p>
              メタデータロックサブシステムからのロックステータス。 値は、<code class="literal">PENDING</code>, <code class="literal">GRANTED</code>, <code class="literal">VICTIM</code>, <code class="literal">TIMEOUT</code>, <code class="literal">KILLED</code>, <code class="literal">PRE_ACQUIRE_NOTIFY</code> または <code class="literal">POST_RELEASE_NOTIFY</code> のいずれかです。 パフォーマンススキーマは、前述のようにこれらの値を割り当てます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。 これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。 
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_THREAD_ID</code>
            </p><p>
              メタデータロックをリクエストしているスレッド。
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_EVENT_ID</code>
            </p><p>
              メタデータロックをリクエストしているイベント。
            </p></li></ul></div><p>
          <code class="literal">metadata_locks</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">OWNER_THREAD_ID</code>、<code class="literal">OWNER_EVENT_ID</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">metadata_locks</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-table-handles-table"></a>27.12.13.4 table_handles テーブル</h4></div></div></div><a class="indexterm" name="idm45882608093856"></a><a class="indexterm" name="idm45882608091712"></a><p>
          パフォーマンススキーマは、<code class="literal">table_handles</code> テーブルを介してテーブルロック情報を公開し、開いているテーブルハンドルごとに現在有効なテーブルロックを表示します。<code class="literal">table_handles</code> では、テーブルロックインストゥルメンテーションによって記録される内容がレポートされます。 この情報には、サーバーが開いているテーブルハンドル、ロック方法、およびセッションが表示されます。 
        </p><p>
          <code class="literal">table_handles</code> テーブルは読取り専用であり、更新できません。 デフォルトでは自動サイズ設定されています。テーブルサイズを構成するには、サーバーの起動時に <code class="literal">performance_schema_max_table_handles</code> システム変数を設定します。 
        </p><p>
          テーブルロックのインストゥルメンテーションでは、デフォルトで有効になっている <code class="literal">wait/lock/table/sql/handler</code> インストゥルメントが使用されます。
        </p><p>
          サーバー起動時のテーブルロックのインストゥルメンテーション状態を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              有効化:
            </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/lock/table/sql/handler=ON'
</pre></li><li class="listitem"><p>
              無効化:
            </p><pre class="programlisting">[mysqld]
performance-schema-instrument='wait/lock/table/sql/handler=OFF'
</pre></li></ul></div><p>
          実行時にテーブルロックのインストゥルメンテーション状態を制御するには、<code class="literal">setup_instruments</code> テーブルを更新します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              有効化:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES', TIMED = 'YES'
WHERE NAME = 'wait/lock/table/sql/handler';
</pre></li><li class="listitem"><p>
              無効化:
            </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO', TIMED = 'NO'
WHERE NAME = 'wait/lock/table/sql/handler';
</pre></li></ul></div><p>
          <code class="literal">table_handles</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              テーブルハンドルによってオープンされたテーブル。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              オブジェクトを格納するスキーマ。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              インストゥルメントされたオブジェクトの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              メモリー内のテーブルハンドルアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_THREAD_ID</code>
            </p><p>
              テーブルハンドルを所有するスレッド。
            </p></li><li class="listitem"><p>
              <code class="literal">OWNER_EVENT_ID</code>
            </p><p>
              テーブルハンドルがオープンされる原因となったイベント。
            </p></li><li class="listitem"><p>
              <code class="literal">INTERNAL_LOCK</code>
            </p><p>
              SQL レベルで使用されるテーブルロック。 値は、<code class="literal">READ</code>, <code class="literal">READ WITH SHARED LOCKS</code>, <code class="literal">READ HIGH PRIORITY</code>, <code class="literal">READ NO INSERT</code>, <code class="literal">WRITE ALLOW WRITE</code>, <code class="literal">WRITE CONCURRENT INSERT</code>, <code class="literal">WRITE LOW PRIORITY</code> または <code class="literal">WRITE</code> のいずれかです。 これらのロックタイプについては、<code class="filename">include/thr_lock.h</code> ソースファイルを参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">EXTERNAL_LOCK</code>
            </p><p>
              ストレージエンジンレベルで使用されるテーブルロック。 値は、<code class="literal">READ EXTERNAL</code> または <code class="literal">WRITE EXTERNAL</code> のいずれかです。 
            </p></li></ul></div><p>
          <code class="literal">table_handles</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">OWNER_THREAD_ID</code>、<code class="literal">OWNER_EVENT_ID</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">table_handles</code> テーブルに対して許可されていません。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-system-variable-tables"></a>27.12.14 パフォーマンススキーマシステム変数テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-persisted-variables-table">27.12.14.1 パフォーマンススキーマ persisted_variables テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-variables-info-table">27.12.14.2 パフォーマンススキーマ variables_info テーブル</a></span></dt></dl></div><p>
        MySQL サーバーは、構成方法を示す多くのシステム変数を保持します (<a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a> を参照)。 システム変数情報は、次の「パフォーマンススキーマ」テーブルで使用できます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">global_variables</code>: グローバルシステム変数。 グローバル値のみが必要なアプリケーションでは、このテーブルを使用する必要があります。 
          </p></li><li class="listitem"><p>
            <code class="literal">session_variables</code>: 現在のセッションのシステム変数。 独自のセッションのすべてのシステム変数値を必要とするアプリケーションでは、このテーブルを使用する必要があります。 これには、セッションのセッション変数と、対応するセッションがないグローバル変数の値が含まれます。 
          </p></li><li class="listitem"><p>
            <code class="literal">variables_by_thread</code>: 各アクティブセッションのセッションシステム変数。 特定のセッションのセッション変数値を知るアプリケーションでは、このテーブルを使用する必要があります。 これには、スレッド ID で識別されるセッション変数のみが含まれます。 
          </p></li><li class="listitem"><p>
            <code class="literal">persisted_variables</code>: 永続化されたグローバルシステム変数設定を格納する <code class="filename">mysqld-auto.cnf</code> ファイルへの SQL インタフェースを提供します。 <a class="xref" href="performance-schema.html#performance-schema-persisted-variables-table" title="27.12.14.1 パフォーマンススキーマ persisted_variables テーブル">セクション27.12.14.1「パフォーマンススキーマ persisted_variables テーブル」</a>を参照してください。 
          </p></li><li class="listitem"><p>
            <code class="literal">variables_info</code>: システム変数ごとに、最後に設定されたソースとその値の範囲を示します。 <a class="xref" href="performance-schema.html#performance-schema-variables-info-table" title="27.12.14.2 パフォーマンススキーマ variables_info テーブル">セクション27.12.14.2「パフォーマンススキーマ variables_info テーブル」</a>を参照してください。 
          </p></li></ul></div><p>
        セッション変数テーブル (<code class="literal">session_variables</code>、<code class="literal">variables_by_thread</code>) には、アクティブセッションの情報のみが含まれ、終了したセッションは含まれません。
      </p><p>
        <code class="literal">global_variables</code> テーブルと <code class="literal">session_variables</code> テーブルには、次のカラムがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">VARIABLE_NAME</code>
          </p><p>
            システム変数名。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_VALUE</code>
          </p><p>
            システム変数の値。 <code class="literal">global_variables</code> の場合、このカラムにはグローバル値が含まれます。 <code class="literal">session_variables</code> の場合、このカラムには現在のセッションで有効な変数値が含まれます。 
          </p></li></ul></div><p>
        <code class="literal">global_variables</code> テーブルと <code class="literal">session_variables</code> テーブルには、次のインデックスがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            主キー (<code class="literal">VARIABLE_NAME</code>)
          </p></li></ul></div><p>
        <code class="literal">variables_by_thread</code> テーブルには、次のカラムがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">THREAD_ID</code>
          </p><p>
            システム変数が定義されているセッションのスレッド識別子。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_NAME</code>
          </p><p>
            システム変数名。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_VALUE</code>
          </p><p>
            <code class="literal">THREAD_ID</code> カラムで指定されたセッションのセッション変数値。
          </p></li></ul></div><p>
        <code class="literal">variables_by_thread</code> テーブルには次のインデックスがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            主キー (<code class="literal">THREAD_ID</code>、<code class="literal">VARIABLE_NAME</code>)
          </p></li></ul></div><p>
        <code class="literal">variables_by_thread</code> テーブルには、フォアグラウンドスレッドに関するシステム変数情報のみが含まれます。 すべてのスレッドがパフォーマンススキーマによって計測されるわけではない場合、このテーブルにはいくつかの行がありません。 この場合、<code class="literal">Performance_schema_thread_instances_lost</code> ステータス変数はゼロより大きくなります。 
      </p><p>
        <code class="literal">TRUNCATE TABLE</code> は、パフォーマンススキーマシステム変数テーブルではサポートされていません。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-persisted-variables-table"></a>27.12.14.1 パフォーマンススキーマ persisted_variables テーブル</h4></div></div></div><a class="indexterm" name="idm45882607982528"></a><a class="indexterm" name="idm45882607981040"></a><p>
          <code class="literal">persisted_variables</code> テーブルは、永続化されたグローバルシステム変数設定を格納する <code class="filename">mysqld-auto.cnf</code> ファイルへの SQL インタフェースを提供し、実行時に <code class="literal">SELECT</code> ステートメントを使用してファイルの内容を検査できるようにします。 変数は、<code class="literal">SET PERSIST</code> または <code class="literal">PERSIST_ONLY</code> ステートメントを使用して永続化されます。<a class="xref" href="sql-statements.html#set-variable" title="13.7.6.1 変数代入の SET 構文">セクション13.7.6.1「変数代入の SET 構文」</a> を参照してください。 このテーブルには、ファイル内の各永続システム変数の行が含まれています。 永続化されていない変数はテーブルに表示されません。 
        </p><p>
          永続システム変数の詳細は、<a class="xref" href="sql-statements.html#set-variable" title="13.7.6.1 変数代入の SET 構文">セクション13.7.6.1「変数代入の SET 構文」</a> を参照してください。
        </p><p>
          <code class="filename">mysqld-auto.cnf</code> は次のようになります (少し再フォーマットされています):
        </p><pre class="programlisting">{
  "Version": 1,
  "mysql_server": {
    "max_connections": {
      "Value": "1000",
      "Metadata": {
        "Timestamp": 1.519921706e+15,
        "User": "root",
        "Host": "localhost"
      }
    },
    "autocommit": {
      "Value": "ON",
      "Metadata": {
        "Timestamp": 1.519921707e+15,
        "User": "root",
        "Host": "localhost"
      }
    }
  }
}
</pre><p>
          その後、<code class="literal">persisted_variables</code> には次の内容が含まれます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.persisted_variables;</code></strong>
+-----------------+----------------+
| VARIABLE_NAME   | VARIABLE_VALUE |
+-----------------+----------------+
| autocommit      | ON             |
| max_connections | 1000           |
+-----------------+----------------+
</pre><p>
          <code class="literal">persisted_variables</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">VARIABLE_NAME</code>
            </p><p>
              <code class="filename">mysqld-auto.cnf</code> にリストされている変数名。
            </p></li><li class="listitem"><p>
              <code class="literal">VARIABLE_VALUE</code>
            </p><p>
              <code class="filename">mysqld-auto.cnf</code> の変数にリストされている値。
            </p></li></ul></div><p>
          <code class="literal">persisted_variables</code> には、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">VARIABLE_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">persisted_variables</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-variables-info-table"></a>27.12.14.2 パフォーマンススキーマ variables_info テーブル</h4></div></div></div><p>
          <code class="literal">variables_info</code> テーブルには、システム変数ごとに、最後に設定されたソースとその値の範囲が表示されます。
        </p><p>
          <code class="literal">variables_info</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">VARIABLE_NAME</code>
            </p><p>
              変数名。
            </p></li><li class="listitem"><p>
              <code class="literal">VARIABLE_SOURCE</code>
            </p><p>
              変数が最後に設定されたソース:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">COMMAND_LINE</code>
                </p><p>
                  コマンドラインで変数が設定されました。
                </p></li><li class="listitem"><p>
                  <code class="literal">COMPILED</code>
                </p><p>
                  変数には、コンパイルされたデフォルト値があります。 <code class="literal">COMPILED</code> は、他の方法で設定されない変数に使用される値です。 
                </p></li><li class="listitem"><p>
                  <code class="literal">DYNAMIC</code>
                </p><p>
                  変数は実行時に設定されました。 これには、<code class="literal">init_file</code> システム変数を使用して指定されたファイル内に設定された変数が含まれます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">EXPLICIT</code>
                </p><p>
                  変数は、<code class="option">--defaults-file</code> オプションで指定されたオプションファイルから設定されました。
                </p></li><li class="listitem"><p>
                  <code class="literal">EXTRA</code>
                </p><p>
                  変数は、<code class="option">--defaults-extra-file</code> オプションで指定されたオプションファイルから設定されました。
                </p></li><li class="listitem"><p>
                  <code class="literal">GLOBAL</code>
                </p><p>
                  変数がグローバルオプションファイルから設定されました。 これには、<code class="literal">EXPLICIT</code>, <code class="literal">EXTRA</code>, <code class="literal">LOGIN</code>, <code class="literal">PERSISTED</code>, <code class="literal">SERVER</code> または <code class="literal">USER</code> でカバーされないオプションファイルが含まれます。 
                </p></li><li class="listitem"><p>
                  <code class="literal">LOGIN</code>
                </p><p>
                  変数は、ユーザー固有のログインパスファイル (<code class="filename">~/.mylogin.cnf</code>) から設定されました。
                </p></li><li class="listitem"><p>
                  <code class="literal">PERSISTED</code>
                </p><p>
                  変数がサーバー固有の <code class="filename">mysqld-auto.cnf</code> オプションファイルから設定されました。 <code class="literal">persisted_globals_load</code> を無効にしてサーバーを起動した場合、この値は行に含まれません。 
                </p></li><li class="listitem"><p>
                  <code class="literal">SERVER</code>
                </p><p>
                  変数がサーバー固有の <code class="filename"><code class="literal">$MYSQL_HOME</code>/my.cnf</code> オプションファイルから設定されました。 <code class="literal">MYSQL_HOME</code> の設定方法の詳細は、<a class="xref" href="programs.html#option-files" title="4.2.2.2 オプションファイルの使用">セクション4.2.2.2「オプションファイルの使用」</a> を参照してください。 
                </p></li><li class="listitem"><p>
                  <code class="literal">USER</code>
                </p><p>
                  変数がユーザー固有の <code class="filename">~/.my.cnf</code> オプションファイルから設定されました。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">VARIABLE_PATH</code>
            </p><p>
              変数がオプションファイルから設定された場合、<code class="literal">VARIABLE_PATH</code> はそのファイルのパス名です。 それ以外の場合、値は空の文字列です。 
            </p></li><li class="listitem"><p>
              <code class="literal">MIN_VALUE</code>, <code class="literal">MAX_VALUE</code>
            </p><p>
              変数に許可される最小値と最大値。 両方とも、そのような値を持たない変数 (つまり、数値ではない変数) の場合は 0 です。 
            </p></li><li class="listitem"><p>
              <code class="literal">SET_TIME</code>
            </p><p>
              変数が最後に設定された時刻。 デフォルトは、起動時にサーバーがグローバルシステム変数を初期化した時刻です。 
            </p></li><li class="listitem"><p>
              <code class="literal">SET_USER</code>, <code class="literal">SET_HOST</code>
            </p><p>
              変数を最後に設定したクライアントユーザーのユーザー名とホスト名。 クライアントが<code class="literal">'user17'@'%.example.com</code> アカウントを使用してホスト <code class="literal">host34.example.com</code> から <code class="literal">user17</code> として接続する場合、<code class="literal">SET_USER</code> および <code class="literal">SET_HOST</code> はそれぞれ <code class="literal">user17</code> および <code class="literal">host34.example.com</code> です。 プロキシユーザー接続の場合、これらの値は権限チェックが実行されるプロキシユーザーではなく、外部 (プロキシ) ユーザーに対応します。 各カラムのデフォルトは空の文字列で、サーバーの起動後に変数が設定されていないことを示します。 
            </p></li></ul></div><p>
          <code class="literal">variables_info</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">variables_info</code> テーブルに対して許可されていません。
        </p><p>
          <code class="literal">DYNAMIC</code> 以外の <code class="literal">VARIABLE_SOURCE</code> 値を持つ変数が実行時に設定された場合、<code class="literal">VARIABLE_SOURCE</code> は <code class="literal">DYNAMIC</code> になり、<code class="literal">VARIABLE_PATH</code> は空の文字列になります。
        </p><p>
          セッション値のみを持つシステム変数 (<code class="literal">debug_sync</code> など) は、起動時または永続化時に設定できません。 セッション専用システム変数の場合、<code class="literal">VARIABLE_SOURCE</code> には <code class="literal">COMPILED</code> または <code class="literal">DYNAMIC</code> のみを指定できます。 
        </p><p>
          システム変数に予期しない <code class="literal">VARIABLE_SOURCE</code> 値が含まれている場合は、サーバーの起動方法を検討してください。 たとえば、<span class="command"><strong>mysqld_safe</strong></span> はオプションファイルを読み取り、<span class="command"><strong>mysqld</strong></span> の起動に使用するコマンドラインの一部として検出された特定のオプションを渡します。 したがって、オプションファイルに設定した一部のシステム変数は、予想されるとおりに <code class="literal">GLOBAL</code> または <code class="literal">SERVER</code> としてではなく、<code class="literal">COMMAND_LINE</code> として <code class="literal">variables_info</code> に表示される場合があります。 
        </p><p>
          <code class="literal">variables_info</code> テーブルを使用するいくつかのサンプルクエリーでは、次のように出力されます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              コマンドラインで設定された変数を表示します:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT VARIABLE_NAME</code></strong>
       <strong class="userinput"><code>FROM performance_schema.variables_info</code></strong>
       <strong class="userinput"><code>WHERE VARIABLE_SOURCE = 'COMMAND_LINE'</code></strong>
       <strong class="userinput"><code>ORDER BY VARIABLE_NAME;</code></strong>
+---------------+
| VARIABLE_NAME |
+---------------+
| basedir       |
| datadir       |
| log_error     |
| pid_file      |
| plugin_dir    |
| port          |
+---------------+
</pre></li><li class="listitem"><p>
              永続ストレージから設定された変数を表示します:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT VARIABLE_NAME</code></strong>
       <strong class="userinput"><code>FROM performance_schema.variables_info</code></strong>
       <strong class="userinput"><code>WHERE VARIABLE_SOURCE = 'PERSISTED'</code></strong>
       <strong class="userinput"><code>ORDER BY VARIABLE_NAME;</code></strong>
+--------------------------+
| VARIABLE_NAME            |
+--------------------------+
| event_scheduler          |
| max_connections          |
| validate_password.policy |
+--------------------------+
</pre></li><li class="listitem"><p>
              <code class="literal">variables_info</code> を <code class="literal">global_variables</code> テーブルと結合して、永続変数の現在の値とその値の範囲を表示します:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>VI.VARIABLE_NAME, GV.VARIABLE_VALUE,</code></strong>
         <strong class="userinput"><code>VI.MIN_VALUE,VI.MAX_VALUE</code></strong>
       <strong class="userinput"><code>FROM performance_schema.variables_info AS VI</code></strong>
         <strong class="userinput"><code>INNER JOIN performance_schema.global_variables AS GV</code></strong>
         <strong class="userinput"><code>USING(VARIABLE_NAME)</code></strong>
       <strong class="userinput"><code>WHERE VI.VARIABLE_SOURCE = 'PERSISTED'</code></strong>
       <strong class="userinput"><code>ORDER BY VARIABLE_NAME;</code></strong>
+--------------------------+----------------+-----------+-----------+
| VARIABLE_NAME            | VARIABLE_VALUE | MIN_VALUE | MAX_VALUE |
+--------------------------+----------------+-----------+-----------+
| event_scheduler          | ON             | 0         | 0         |
| max_connections          | 200            | 1         | 100000    |
| validate_password.policy | STRONG         | 0         | 0         |
+--------------------------+----------------+-----------+-----------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-status-variable-tables"></a>27.12.15 パフォーマンススキーマのステータス変数のテーブル</h3></div></div></div><p>
        MySQL サーバーは、その操作に関する情報を提供する多くのステータス変数を保持します (<a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 サーバーステータス変数">セクション5.1.10「サーバーステータス変数」</a> を参照)。 ステータス変数情報は、次の「パフォーマンススキーマ」テーブルで使用できます: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">global_status</code>: グローバルステータス変数。 グローバル値のみが必要なアプリケーションでは、このテーブルを使用する必要があります。 
          </p></li><li class="listitem"><p>
            <code class="literal">session_status</code>: 現在のセッションのステータス変数。 独自のセッションのすべてのステータス変数値を必要とするアプリケーションでは、このテーブルを使用する必要があります。 これには、セッションのセッション変数と、対応するセッションがないグローバル変数の値が含まれます。 
          </p></li><li class="listitem"><p>
            <code class="literal">status_by_thread</code>: 各アクティブセッションのセッションステータス変数。 特定のセッションのセッション変数値を知るアプリケーションでは、このテーブルを使用する必要があります。 これには、スレッド ID で識別されるセッション変数のみが含まれます。 
          </p></li></ul></div><p>
        アカウント、ホスト名およびユーザー名ごとに集計されたステータス変数情報を提供するサマリーテーブルもあります。 <a class="xref" href="performance-schema.html#performance-schema-status-variable-summary-tables" title="27.12.18.12 ステータス変数サマリーテーブル">セクション27.12.18.12「ステータス変数サマリーテーブル」</a>を参照してください。 
      </p><p>
        セッション変数テーブル (<code class="literal">session_status</code>、<code class="literal">status_by_thread</code>) には、アクティブセッションの情報のみが含まれ、終了したセッションは含まれません。
      </p><p>
        パフォーマンススキーマは、<code class="literal">threads</code> テーブル内の <code class="literal">INSTRUMENTED</code> 値が <code class="literal">YES</code> であるスレッドについてのみ、グローバルステータス変数の統計を収集します。 セッションステータス変数の統計は、<code class="literal">INSTRUMENTED</code> の値に関係なく常に収集されます。 
      </p><p>
        パフォーマンススキーマは、ステータス変数テーブル内の <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> ステータス変数の統計情報を収集しません。 グローバルステートメントの実行数およびセッションごとのステートメントの実行数を取得するには、それぞれ <code class="literal">events_statements_summary_global_by_event_name</code> テーブルおよび <code class="literal">events_statements_summary_by_thread_by_event_name</code> テーブルを使用します。 例: 
      </p><pre class="programlisting">SELECT EVENT_NAME, COUNT_STAR
FROM performance_schema.events_statements_summary_global_by_event_name
WHERE EVENT_NAME LIKE 'statement/sql/%';
</pre><p>
        <code class="literal">global_status</code> テーブルと <code class="literal">session_status</code> テーブルには、次のカラムがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">VARIABLE_NAME</code>
          </p><p>
            ステータス変数名。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_VALUE</code>
          </p><p>
            ステータス変数の値。 <code class="literal">global_status</code> の場合、このカラムにはグローバル値が含まれます。 <code class="literal">session_status</code> の場合、このカラムには現在のセッションの変数値が含まれます。 
          </p></li></ul></div><p>
        <code class="literal">global_status</code> テーブルと <code class="literal">session_status</code> テーブルには、次のインデックスがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            主キー (<code class="literal">VARIABLE_NAME</code>)
          </p></li></ul></div><p>
        <code class="literal">status_by_thread</code> テーブルには、各アクティブスレッドのステータスが含まれます。 これには次のカラムがあります。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">THREAD_ID</code>
          </p><p>
            ステータス変数が定義されているセッションのスレッド識別子。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_NAME</code>
          </p><p>
            ステータス変数名。
          </p></li><li class="listitem"><p>
            <code class="literal">VARIABLE_VALUE</code>
          </p><p>
            <code class="literal">THREAD_ID</code> カラムで指定されたセッションのセッション変数値。
          </p></li></ul></div><p>
        <code class="literal">status_by_thread</code> テーブルには次のインデックスがあります:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            主キー (<code class="literal">THREAD_ID</code>、<code class="literal">VARIABLE_NAME</code>)
          </p></li></ul></div><p>
        <code class="literal">status_by_thread</code> テーブルには、フォアグラウンドスレッドに関するステータス変数情報のみが含まれます。 <code class="literal">performance_schema_max_thread_instances</code> システム変数が自動スケーリングされず (値−1 で示される)、インストゥルメントされるスレッドオブジェクトの最大許容数がバックグラウンドスレッドの数を超えていない場合、テーブルは空になります。 
      </p><p>
        パフォーマンススキーマは、次のようなステータス変数テーブルの <code class="literal">TRUNCATE TABLE</code> をサポートします:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">global_status</code>: スレッド、アカウント、ホストおよびユーザーのステータスをリセットします。 サーバーがリセットしないグローバルステータス変数をリセットします。 
          </p></li><li class="listitem"><p>
            <code class="literal">session_status</code>: サポートされません。
          </p></li><li class="listitem"><p>
            <code class="literal">status_by_thread</code>: すべてのスレッドのステータスをグローバルステータスおよびアカウントステータスに集計し、スレッドステータスをリセットします。 アカウント統計が収集されない場合、ホストおよびユーザーのステータスが収集されると、セッションステータスがホストおよびユーザーのステータスに追加されます。 
          </p><p>
            <code class="literal">performance_schema_accounts_size</code>、<code class="literal">performance_schema_hosts_size</code> および <code class="literal">performance_schema_users_size</code> システム変数がそれぞれ 0 に設定されている場合、アカウント、ホストおよびユーザーの統計は収集されません。
          </p></li></ul></div><p>
        <code class="literal">FLUSH STATUS</code> は、すべてのアクティブセッションのセッションステータスをグローバルステータス変数に追加し、すべてのアクティブセッションのステータスをリセットし、切断されたセッションから集計されたアカウント、ホストおよびユーザーステータス値をリセットします。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-thread-pool-tables"></a>27.12.16 パフォーマンススキーマスレッドプールテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-tp-thread-group-state-table">27.12.16.1 tp_thread_group_state テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-tp-thread-group-stats-table">27.12.16.2 tp_thread_group_stats テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-tp-thread-state-table">27.12.16.3 tp_thread_state テーブル</a></span></dt></dl></div><a class="indexterm" name="idm45882607781568"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.14 の時点で使用可能です。 MySQL 8.0.14 より前は、かわりに対応する <code class="literal">INFORMATION_SCHEMA</code> テーブルを使用してください。<a class="xref" href="information-schema.html#thread-pool-information-schema-tables" title="26.52 INFORMATION_SCHEMA スレッドプールテーブル">セクション26.52「INFORMATION_SCHEMA スレッドプールテーブル」</a> を参照してください。 
        </p></div><p>
        次のセクションでは、スレッドプールプラグインに関連付けられた「パフォーマンススキーマ」テーブルについて説明します (<a class="xref" href="server-administration.html#thread-pool" title="5.6.3 MySQL Enterprise Thread Pool">セクション5.6.3「MySQL Enterprise Thread Pool」</a> を参照)。 スレッドプール操作に関する情報を示します。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">tp_thread_group_state</code>: スレッドプールのスレッドグループの状態に関する情報
          </p></li><li class="listitem"><p>
            <code class="literal">tp_thread_group_stats</code>: スレッドグループ統計
          </p></li><li class="listitem"><p>
            <code class="literal">tp_thread_state</code>: スレッドプールスレッドの状態に関する情報
          </p></li></ul></div><p>
        これらのテーブル内の行は、特定時点のスナップショットを表します。 <code class="literal">tp_thread_state</code> の場合、スレッドグループのすべての行は時間内のスナップショットを構成します。 そのため、MySQL Server では、スナップショットの生成中にスレッドグループの相互排他ロックを保持します。 ただし、<code class="literal">tp_thread_state</code> に対するステートメントが MySQL サーバー全体をブロックしないように、すべてのスレッドグループの mutex を同時に保持するわけではありません。 
      </p><p>
        パフォーマンススキーマスレッドプールテーブルはスレッドプールプラグインによって実装され、そのプラグインがロードおよびアンロードされるときにロードおよびアンロードされます (<a class="xref" href="server-administration.html#thread-pool-installation" title="5.6.3.2 スレッドプールのインストール">セクション5.6.3.2「スレッドプールのインストール」</a> を参照)。 テーブルの特別な構成ステップは必要ありません。 ただし、これらのテーブルは、有効にするスレッドプールプラグインによって異なります。 スレッドプールプラグインがロードされているが無効になっている場合、テーブルは作成されません。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-tp-thread-group-state-table"></a>27.12.16.1 tp_thread_group_state テーブル</h4></div></div></div><a class="indexterm" name="idm45882607762608"></a><a class="indexterm" name="idm45882607760448"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.14 の時点で使用可能です。 MySQL 8.0.14 より前は、かわりに対応する <code class="literal">INFORMATION_SCHEMA</code> テーブルを使用してください。<a class="xref" href="information-schema.html#information-schema-tp-thread-group-state-table" title="26.52.1 INFORMATION_SCHEMA TP_THREAD_GROUP_STATE テーブル">セクション26.52.1「INFORMATION_SCHEMA TP_THREAD_GROUP_STATE テーブル」</a> を参照してください。 
          </p></div><p>
          <code class="literal">tp_thread_group_state</code> テーブルには、スレッドプール内のスレッドグループごとに 1 つの行があります。 それぞれの行には、グループの現在の状態に関する情報が表示されます。 
        </p><p>
          <code class="literal">tp_thread_group_state</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TP_GROUP_ID</code>
            </p><p>
              スレッドグループ ID です。 これはテーブル内の一意のキーです。 
            </p></li><li class="listitem"><p>
              <code class="literal">CONSUMER THREADS</code>
            </p><p>
              コンシューマスレッドの数です。 アクティブなスレッドが停止またはブロックされると、実行開始可能なスレッドが最大 1 つ存在します。 
            </p></li><li class="listitem"><p>
              <code class="literal">RESERVE_THREADS</code>
            </p><p>
              予約状態のスレッドの数です。 つまり、新しいスレッドをスリープ解除する必要があり、コンシューマスレッドが存在しなくなるまで、それらは起動されません。 これは、通常の操作で必要になる数よりも多くのスレッドをスレッドグループが作成したときに、ほとんどのスレッドが最終的に達する状態です。 多くの場合、スレッドグループは短い間追加スレッドを必要とし、その後しばらくの間はふたたび必要とすることはありません。 この場合には予約状態になり、ふたたび必要とされるまでその状態のままです。 ある程度のメモリーリソースをべつに使用しますが、追加のコンピューティングリソースは必要ありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECT_THREAD_COUNT</code>
            </p><p>
              接続の初期化および認証の処理を処理中または待機中のスレッドの数。 スレッドグループごとに最大 4 つの接続スレッドを使用できます。これらのスレッドは、非アクティブな期間が経過すると期限切れになります。 
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTION_COUNT</code>
            </p><p>
              このスレッドグループを使用した接続の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUED_QUERIES</code>
            </p><p>
              優先度の高いキューで待機しているステートメントの数です。
            </p></li><li class="listitem"><p>
              <code class="literal">QUEUED_TRANSACTIONS</code>
            </p><p>
              優先度の低いキューで待機しているステートメントの数です。 これらは、開始されていないトランザクションの初期ステートメントなので、キューに入れられたトランザクションも表します。 
            </p></li><li class="listitem"><p>
              <code class="literal">STALL_LIMIT</code>
            </p><p>
              スレッドグループの <code class="literal">thread_pool_stall_limit</code> システム変数の値。 これはすべてのスレッドグループで同じ値です。 
            </p></li><li class="listitem"><p>
              <code class="literal">PRIO_KICKUP_TIMER</code>
            </p><p>
              スレッドグループの <code class="literal">thread_pool_prio_kickup_timer</code> システム変数の値。 これはすべてのスレッドグループで同じ値です。 
            </p></li><li class="listitem"><p>
              <code class="literal">ALGORITHM</code>
            </p><p>
              スレッドグループの <code class="literal">thread_pool_algorithm</code> システム変数の値。 これはすべてのスレッドグループで同じ値です。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_COUNT</code>
            </p><p>
              このスレッドグループの一部としてスレッドプール内で開始されたスレッドの数です。
            </p></li><li class="listitem"><p>
              <code class="literal">ACTIVE_THREAD_COUNT</code>
            </p><p>
              ステートメントの実行中にアクティブなスレッドの数。
            </p></li><li class="listitem"><p>
              <code class="literal">STALLED_THREAD_COUNT</code>
            </p><p>
              停止したスレッドグループ内のステートメントの数です。 停止したステートメントが実行している可能性はありますが、スレッドプールから見ると停止して、進行していません。 長時間実行しているステートメントはすぐにこのカテゴリで終了します。 
            </p></li><li class="listitem"><p>
              <code class="literal">WAITING_THREAD_NUMBER</code>
            </p><p>
              スレッドグループ内のステートメントのポーリングを処理するスレッドがある場合、これにより、このスレッドグループ内のスレッド番号が指定されます。 このスレッドがステートメントを実行している可能性があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">OLDEST_QUEUED</code>
            </p><p>
              もっとも古いキューに入れられたステートメントが実行待機した時間です (ミリ秒単位)。
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_THREAD_IDS_IN_GROUP</code>
            </p><p>
              グループ内のスレッドの最大スレッド ID です。 これは、<code class="literal">tp_thread_state</code> テーブルから選択した場合のスレッドの <code class="literal">MAX(TP_THREAD_NUMBER)</code> と同じです。 つまり、次の 2 つのクエリーは同等です。 
            </p><pre class="programlisting">SELECT TP_GROUP_ID, MAX_THREAD_IDS_IN_GROUP
FROM tp_thread_group_state;

SELECT TP_GROUP_ID, MAX(TP_THREAD_NUMBER)
FROM tp_thread_state GROUP BY TP_GROUP_ID;
</pre></li></ul></div><p>
          <code class="literal">tp_thread_group_state</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              (<code class="literal">TP_GROUP_ID</code>) の一意インデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">tp_thread_group_state</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-tp-thread-group-stats-table"></a>27.12.16.2 tp_thread_group_stats テーブル</h4></div></div></div><a class="indexterm" name="idm45882607701616"></a><a class="indexterm" name="idm45882607699408"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.14 の時点で使用可能です。 MySQL 8.0.14 より前は、かわりに対応する <code class="literal">INFORMATION_SCHEMA</code> テーブルを使用してください。<a class="xref" href="information-schema.html#information-schema-tp-thread-group-stats-table" title="26.52.2 INFORMATION_SCHEMA TP_THREAD_GROUP_STATS テーブル">セクション26.52.2「INFORMATION_SCHEMA TP_THREAD_GROUP_STATS テーブル」</a> を参照してください。 
          </p></div><p>
          <code class="literal">tp_thread_group_stats</code> テーブルには、スレッドグループごとの統計がレポートされます。 グループごとに 1 行があります。 
        </p><p>
          <code class="literal">tp_thread_group_stats</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TP_GROUP_ID</code>
            </p><p>
              スレッドグループ ID です。 これはテーブル内の一意のキーです。 
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTIONS_STARTED</code>
            </p><p>
              開始した接続の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTIONS_CLOSED</code>
            </p><p>
              終了した接続の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">QUERIES_EXECUTED</code>
            </p><p>
              実行したステートメントの数です。 この数は、ステートメントが実行を終了したときではなく、開始したときに増えます。 
            </p></li><li class="listitem"><p>
              <code class="literal">QUERIES_QUEUED</code>
            </p><p>
              実行を待ってキューに入れられた、受け取ったステートメントの数です。 これは、スレッドグループがキューに入れることなく即座に実行を開始できたステートメントはカウントされません。即座に実行を開始できるのは、<a class="xref" href="server-administration.html#thread-pool-operation" title="5.6.3.3 スレッドプール操作">セクション5.6.3.3「スレッドプール操作」</a>に記した条件に該当する場合です。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREADS_STARTED</code>
            </p><p>
              開始したスレッドの数です。
            </p></li><li class="listitem"><p>
              <code class="literal">PRIO_KICKUPS</code>
            </p><p>
              <code class="literal">thread_pool_prio_kickup_timer</code> システム変数の値に基づいて、優先度の低いキューから優先度の高いキューに移動したステートメントの数です。 この数が急速に増えた場合、変数の値を増やしてください。 急速に増えるカウンタは、トランザクションが非常に早くから開始しないようにする優先度システムが機能していないことを意味します。 <code class="literal">InnoDB</code> の場合、これは、同時トランザクションが非常に多いためにパフォーマンスが低下している可能性が高くなっています。 
            </p></li><li class="listitem"><p>
              <code class="literal">STALLED_QUERIES_EXECUTED</code>
            </p><p>
              <code class="literal">thread_pool_stall_limit</code> システム変数の値より長く実行されたために停止として定義されたステートメントの数。
            </p></li><li class="listitem"><p>
              <code class="literal">BECOME_CONSUMER_THREAD</code>
            </p><p>
              コンシューマスレッドロールがスレッドに割り当てられた回数です。
            </p></li><li class="listitem"><p>
              <code class="literal">BECOME_RESERVE_THREAD</code>
            </p><p>
              予約スレッドロールがスレッドに割り当てられた回数です。
            </p></li><li class="listitem"><p>
              <code class="literal">BECOME_WAITING_THREAD</code>
            </p><p>
              待機スレッドロールがスレッドに割り当てられた回数です。 ステートメントがキューに入れられると、これは、通常の操作であっても、非常に頻繁に起こります。したがって、ステートメントがキューに入れられたシステムの負荷が高い場合には、この値が急速に増加しても正常です。 
            </p></li><li class="listitem"><p>
              <code class="literal">WAKE_THREAD_STALL_CHECKER</code>
            </p><p>
              複数のステートメントをできるだけ処理したり、待機スレッドロールに対処したりするために、スレッドのウェイクアップまたは作成を、停止チェックスレッドで決定した回数です。
            </p></li><li class="listitem"><p>
              <code class="literal">SLEEP_WAITS</code>
            </p><p>
              <code class="literal">THD_WAIT_SLEEP</code> 待機の数です。 これらは、スレッドがスリープ状態になるとき (たとえば、<code class="literal">SLEEP()</code> 関数を呼び出すことによって) に発生します。 
            </p></li><li class="listitem"><p>
              <code class="literal">DISK_IO_WAITS</code>
            </p><p>
              <code class="literal">THD_WAIT_DISKIO</code> 待機の数です。 ファイルシステムキャッシュにヒットしない可能性のあるディスク I/O をスレッドが実行すると発生します。 ファイルに対する通常の読み取りおよび書き込みの場合ではなく、バッファープールがディスクに対してデータを読み取りおよび書き込むときに、このような待機が起こります。 
            </p></li><li class="listitem"><p>
              <code class="literal">ROW_LOCK_WAITS</code>
            </p><p>
              別のトランザクションによる行ロックの解放を待っている <code class="literal">THD_WAIT_ROW_LOCK</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">GLOBAL_LOCK_WAITS</code>
            </p><p>
              グローバルロックの解放を待っている <code class="literal">THD_WAIT_GLOBAL_LOCK</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">META_DATA_LOCK_WAITS</code>
            </p><p>
              メタデータロックの解放を待っている <code class="literal">THD_WAIT_META_DATA_LOCK</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">TABLE_LOCK_WAITS</code>
            </p><p>
              ステートメントがアクセスする必要のあるテーブルのロック解除を待っている <code class="literal">THD_WAIT_TABLE_LOCK</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">USER_LOCK_WAITS</code>
            </p><p>
              ユーザースレッドで構築された固有のロックを待っている <code class="literal">THD_WAIT_USER_LOCK</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">BINLOG_WAITS</code>
            </p><p>
              バイナリログの解放を待っている <code class="literal">THD_WAIT_BINLOG_WAITS</code> 待機の数です。
            </p></li><li class="listitem"><p>
              <code class="literal">GROUP_COMMIT_WAITS</code>
            </p><p>
              <code class="literal">THD_WAIT_GROUP_COMMIT</code> 待機の数です。 その他のパーティーがトランザクションの担当分を完了するまで、グループコミットが待機する必要があるときに発生します。 
            </p></li><li class="listitem"><p>
              <code class="literal">FSYNC_WAITS</code>
            </p><p>
              ファイル同期操作を待っている <code class="literal">THD_WAIT_SYNC</code> 待機の数です。
            </p></li></ul></div><p>
          <code class="literal">tp_thread_group_stats</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              (<code class="literal">TP_GROUP_ID</code>) の一意インデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">tp_thread_group_stats</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-tp-thread-state-table"></a>27.12.16.3 tp_thread_state テーブル</h4></div></div></div><a class="indexterm" name="idm45882607623936"></a><a class="indexterm" name="idm45882607621728"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.14 の時点で使用可能です。 MySQL 8.0.14 より前は、かわりに対応する <code class="literal">INFORMATION_SCHEMA</code> テーブルを使用してください。<a class="xref" href="information-schema.html#information-schema-tp-thread-state-table" title="26.52.3 INFORMATION_SCHEMA TP_THREAD_STATE テーブル">セクション26.52.3「INFORMATION_SCHEMA TP_THREAD_STATE テーブル」</a> を参照してください。 
          </p></div><p>
          <code class="literal">tp_thread_state</code> テーブルには、接続を処理するためにスレッドプールによって作成されたスレッドごとに 1 つの行があります。
        </p><p>
          <code class="literal">tp_thread_state</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TP_GROUP_ID</code>
            </p><p>
              スレッドグループ ID です。
            </p></li><li class="listitem"><p>
              <code class="literal">TP_THREAD_NUMBER</code>
            </p><p>
              スレッドグループ内のスレッドの ID です。 <code class="literal">TP_GROUP_ID</code> と <code class="literal">TP_THREAD_NUMBER</code> の組み合わせが、テーブル内での一意のキーになります。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESS_COUNT</code>
            </p><p>
              このスレッドを使用しているステートメントが現在実行している 10 ミリ秒間隔です。0 は実行しているステートメントがないことを示し、1 はステートメントが最初の 10 ミリ秒に存在していることを示す、というようになります。
            </p></li><li class="listitem"><p>
              <code class="literal">WAIT_TYPE</code>
            </p><p>
              スレッドの待機のタイプです。 <code class="literal">NULL</code> はスレッドがブロックされていることを示します。 それ以外の場合、スレッドは <code class="literal">thd_wait_begin()</code> の呼び出しによってブロックされ、値は待機のタイプを指定します。 <code class="literal">tp_thread_group_stats</code> テーブルの <code class="literal"><em class="replaceable"><code>xxx</code></em>_WAIT</code> カラムには、待機タイプごとにカウントが累積されます。 
            </p><p>
              <code class="literal">WAIT_TYPE</code> 値は、次の表に示すように、待機のタイプを記述した文字列です。
            </p><div class="table"><a name="idm45882607598336"></a><p class="title"><b>表 27.3 tp_thread_state テーブルの WAIT_TYPE 値</b></p><div class="table-contents"><table summary="tp_thread_state table WAIT_TYPE values. The first column is the wait type. The second column describes the wait type."><col width="35%"><col width="65%"><thead><tr>
                  <th>待機タイプ</th>
                  <th>意味</th>
                </tr></thead><tbody><tr>
                  <td><code class="literal">THD_WAIT_SLEEP</code></td>
                  <td>スリープの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_DISKIO</code></td>
                  <td>ディスク IO の待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_ROW_LOCK</code></td>
                  <td>行ロックの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_GLOBAL_LOCK</code></td>
                  <td>グローバルロックの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_META_DATA_LOCK</code></td>
                  <td>メタデータロックの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_TABLE_LOCK</code></td>
                  <td>テーブルロックの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_USER_LOCK</code></td>
                  <td>ユーザーロックの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_BINLOG</code></td>
                  <td>binlog の待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_GROUP_COMMIT</code></td>
                  <td>グループコミットの待機</td>
                </tr><tr>
                  <td><code class="literal">THD_WAIT_SYNC</code></td>
                  <td>fsync の待機</td>
                </tr></tbody></table></div></div><br class="table-break"></li></ul></div><p>
          <code class="literal">tp_thread_state</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              (<code class="literal">TP_GROUP_ID</code>、<code class="literal">TP_THREAD_NUMBER</code>) の一意インデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">tp_thread_state</code> テーブルに対して許可されていません。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-clone-tables"></a>27.12.17 パフォーマンススキーマクローンテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-clone-status-table">27.12.17.1 clone_status テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-clone-progress-table">27.12.17.2 clone_progress テーブル</a></span></dt></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.17 の時点で使用可能です。
        </p></div><p>
        次の各セクションでは、クローンプラグインに関連付けられた「パフォーマンススキーマ」テーブルについて説明します (<a class="xref" href="server-administration.html#clone-plugin" title="5.6.7 クローンプラグイン">セクション5.6.7「クローンプラグイン」</a> を参照)。 これらのテーブルは、クローニング操作に関する情報を示しています。 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">clone_status</code>: 現在または最後に実行されたクローニング操作に関するステータス情報。
          </p></li><li class="listitem"><p>
            <code class="literal">clone_progress</code>: 現在または最後に実行されたクローニング操作に関する進捗情報。
          </p></li></ul></div><p>
        パフォーマンススキーマクローンテーブルはクローンプラグインによって実装され、そのプラグインがロードおよびアンロードされるときにロードおよびアンロードされます (<a class="xref" href="server-administration.html#clone-plugin-installation" title="5.6.7.1 クローンプラグインのインストール">セクション5.6.7.1「クローンプラグインのインストール」</a> を参照)。 テーブルの特別な構成ステップは必要ありません。 ただし、これらのテーブルは、有効にするクローンプラグインによって異なります。 クローンプラグインがロードされているが無効になっている場合、テーブルは作成されません。 
      </p><p>
        パフォーマンススキーマクローンプラグインのテーブルは、受信者の MySQL サーバーインスタンスでのみ使用されます。 データは、サーバーの停止および再起動後も保持されます。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-clone-status-table"></a>27.12.17.1 clone_status テーブル</h4></div></div></div><a class="indexterm" name="idm45882607547824"></a><a class="indexterm" name="idm45882607545680"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.17 の時点で使用可能です。
          </p></div><p>
          <code class="literal">clone_status</code> テーブルには、現在または最後に実行されたクローニング操作のステータスのみが表示されます。 テーブルには、1 行のデータのみが含まれているか、空です。 
        </p><p>
          <code class="literal">clone_status</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ID</code>
            </p><p>
              現在の MySQL サーバーインスタンス内の一意のクローニング操作識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">PID</code>
            </p><p>
              クローニング操作を実行しているセッションのプロセスリスト ID。
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              クローニング操作の現在の状態。 値には、<code class="literal">Not Started</code>, <code class="literal">In Progress</code>, <code class="literal">Completed</code> および <code class="literal">Failed</code> が含まれます。 
            </p></li><li class="listitem"><p>
              <code class="literal">BEGIN_TIME</code>
            </p><p>
              クローニング操作がいつ開始されたかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">END_TIME</code>
            </p><p>
              クローニング操作が終了した時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。 操作が終了していない場合は NULL を報告します。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              '<code class="literal">HOST:PORT</code>'形式のドナー MySQL サーバーアドレス。 このカラムには、ローカルクローニング操作の'<code class="literal">LOCAL INSTANCE</code>'が表示されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">DESTINATION</code>
            </p><p>
              クローニング先のディレクトリ。
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR_NO</code>
            </p><p>
              失敗したクローニング操作について報告されたエラー番号。
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR_MESSAGE</code>
            </p><p>
              失敗したクローニング操作のエラーメッセージ文字列。
            </p></li><li class="listitem"><p>
              <code class="literal">BINLOG_FILE</code>
            </p><p>
              データがクローニングされるバイナリログファイルの名前。
            </p></li><li class="listitem"><p>
              <code class="literal">BINLOG_POSITION</code>
            </p><p>
              データのクローン先のバイナリログファイルのオフセット。
            </p></li><li class="listitem"><p>
              <code class="literal">GTID_EXECUTED</code>
            </p><p>
              最後にクローニングされたトランザクションの GTID 値。
            </p></li></ul></div><p>
          <code class="literal">clone_status</code> テーブルは読取り専用です。 <code class="literal">TRUNCATE TABLE</code> を含む DDL は許可されていません。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-clone-progress-table"></a>27.12.17.2 clone_progress テーブル</h4></div></div></div><a class="indexterm" name="idm45882607503792"></a><a class="indexterm" name="idm45882607501648"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで説明する「パフォーマンススキーマ」テーブルは、MySQL 8.0.17 の時点で使用可能です。
          </p></div><p>
          <code class="literal">clone_progress</code> テーブルには、現在または最後に実行されたクローニング操作の進捗情報のみが表示されます。
        </p><p>
          クローニング操作のステージには、<code class="literal">DROP DATA</code>, <code class="literal">FILE COPY</code>, <code class="literal">PAGE_COPY</code>, <code class="literal">REDO_COPY</code>, <code class="literal">FILE_SYNC</code>, <code class="literal">RESTART</code> および <code class="literal">RECOVERY</code> が含まれます。 クローニング操作では、各ステージのレコードが生成されます。 したがって、テーブルには 7 行のデータのみが含まれているか、空です。 
        </p><p>
          <code class="literal">clone_progress</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ID</code>
            </p><p>
              現在の MySQL サーバーインスタンス内の一意のクローニング操作識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">STAGE</code>
            </p><p>
              現在のクローニングステージの名前。 ステージには、<code class="literal">DROP DATA</code>, <code class="literal">FILE COPY</code>, <code class="literal">PAGE_COPY</code>, <code class="literal">REDO_COPY</code>, <code class="literal">FILE_SYNC</code>, <code class="literal">RESTART</code> および <code class="literal">RECOVERY</code> が含まれます。 
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              クローニングステージの現在の状態。 状態には、<code class="literal">Not Started</code>、<code class="literal">In Progress</code> および <code class="literal">Completed</code> が含まれます。 
            </p></li><li class="listitem"><p>
              <code class="literal">BEGIN_TIME</code>
            </p><p>
              クローニングステージがいつ開始されたかを示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。 ステージが開始されていない場合は NULL を報告します。 
            </p></li><li class="listitem"><p>
              <code class="literal">END_TIME</code>
            </p><p>
              クローニングステージが終了した時間を示す<code class="literal">'<em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em>[.<em class="replaceable"><code>fraction</code></em>]'</code>形式のタイムスタンプ。 ステージが終了していない場合は NULL を報告します。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREADS</code>
            </p><p>
              ステージで使用されるコンカレントスレッドの数。
            </p></li><li class="listitem"><p>
              <code class="literal">ESTIMATE</code>
            </p><p>
              現在のステージの推定データ量 (バイト単位)。
            </p></li><li class="listitem"><p>
              <code class="literal">DATA</code>
            </p><p>
              現在の状態で転送されたデータ量 (バイト単位)。
            </p></li><li class="listitem"><p>
              <code class="literal">NETWORK</code>
            </p><p>
              現在の状態で転送されたネットワークデータの量 (バイト単位)。
            </p></li><li class="listitem"><p>
              <code class="literal">DATA_SPEED</code>
            </p><p>
              データ転送の現在の実際の速度 (バイト/秒)。 この値は、<code class="literal">clone_max_data_bandwidth</code> で定義されているリクエストされた最大データ転送レートとは異なる場合があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">NETWORK_SPEED</code>
            </p><p>
              ネットワーク転送の現在の速度 (バイト/秒)。
            </p></li></ul></div><p>
          <code class="literal">clone_progress</code> テーブルは読取り専用です。 <code class="literal">TRUNCATE TABLE</code> を含む DDL は許可されていません。 
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-summary-tables"></a>27.12.18 パフォーマンススキーマサマリーテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-summary-tables">27.12.18.1 待機イベント要約テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-summary-tables">27.12.18.2 ステージサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-summary-tables">27.12.18.3 ステートメントサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-histogram-summary-tables">27.12.18.4 ステートメントヒストグラム要約テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-transaction-summary-tables">27.12.18.5 トランザクション要約テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-objects-summary-global-by-type-table">27.12.18.6 オブジェクト待機サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-file-summary-tables">27.12.18.7 ファイル I/O サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#table-wait-summary-tables">27.12.18.8 テーブル I/O およびロック待機サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-socket-summary-tables">27.12.18.9 ソケットサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-memory-summary-tables">27.12.18.10 メモリーサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-error-summary-tables">27.12.18.11 エラー要約テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variable-summary-tables">27.12.18.12 ステータス変数サマリーテーブル</a></span></dt></dl></div><p>
        サマリーテーブルは、時間の経過とともに強制終了されたイベントについて集計された情報を提供します。 このグループのテーブルには、さまざまな方法で、イベントデータが要約されます。 
      </p><h4><a name="idm45882607450864"></a>待機イベントサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとの待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとの待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_instance</code>: インスタンス当たりの待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとの待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとの待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_global_by_event_name</code>: イベント名ごとの待機イベント
          </p></li></ul></div><h4><a name="idm45882607438480"></a>ステージサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとのステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとのイベントのステージング
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとのステージ待機
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとのステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_global_by_event_name</code>: イベント名ごとのステージ待機
          </p></li></ul></div><h4><a name="idm45882607427856"></a>ステートメントサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_statements_histogram_by_digest</code>: スキーマおよびダイジェスト値ごとのステートメントヒストグラム。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_histogram_global</code>: グローバルに要約されたステートメントヒストグラム。
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_digest</code>: スキーマおよびダイジェスト値ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_program</code>: ストアドプログラムごとのステートメントイベント (ストアドプロシージャーとストアドファンクション、トリガー、およびイベント)
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_global_by_event_name</code>: イベント名ごとのステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">prepared_statements_instances</code>: プリペアドステートメントのインスタンスおよび統計
          </p></li></ul></div><h4><a name="idm45882607407376"></a>トランザクション要約</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_transactions_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとのトランザクションイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとのトランザクションイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとのトランザクションイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとのトランザクションイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_summary_global_by_event_name</code>: イベント名ごとのトランザクションイベント
          </p></li></ul></div><h4><a name="idm45882607396640"></a>オブジェクト待機サマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">objects_summary_global_by_type</code>: オブジェクトサマリー
          </p></li></ul></div><h4><a name="idm45882607393728"></a>ファイル I/O サマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">file_summary_by_event_name</code>: イベント名ごとのファイルイベント
          </p></li><li class="listitem"><p>
            <code class="literal">file_summary_by_instance</code>: ファイルインスタンスごとのファイルイベント
          </p></li></ul></div><h4><a name="idm45882607388880"></a>テーブル I/O およびロック待機サマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code>: インデックスごとのテーブル I/O 待機
          </p></li><li class="listitem"><p>
            <code class="literal">table_io_waits_summary_by_table</code>: テーブルごとのテーブル I/O 待機
          </p></li><li class="listitem"><p>
            <code class="literal">table_lock_waits_summary_by_table</code>: テーブルごとのテーブルロック待機
          </p></li></ul></div><h4><a name="idm45882607382192"></a>ソケットサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">socket_summary_by_instance</code>: インスタンス当たりのソケット待機および I/O
          </p></li><li class="listitem"><p>
            <code class="literal">socket_summary_by_event_name</code>: イベント名ごとのソケット待機および I/O
          </p></li></ul></div><h4><a name="idm45882607377344"></a>メモリーサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">memory_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとのメモリー操作
          </p></li><li class="listitem"><p>
            <code class="literal">memory_summary_by_host_by_event_name</code>: ホストおよびイベント名ごとのメモリー操作
          </p></li><li class="listitem"><p>
            <code class="literal">memory_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとのメモリー操作
          </p></li><li class="listitem"><p>
            <code class="literal">memory_summary_by_user_by_event_name</code>: ユーザーおよびイベント名ごとのメモリー操作
          </p></li><li class="listitem"><p>
            <code class="literal">memory_summary_global_by_event_name</code>: イベント名ごとのグローバルなメモリー操作
          </p></li></ul></div><h4><a name="idm45882607366832"></a>エラーサマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_errors_summary_by_account_by_error</code>: エラーコードおよびアカウントごとのエラー
          </p></li><li class="listitem"><p>
            <code class="literal">events_errors_summary_by_host_by_error</code>: エラーコードおよびホストごとのエラー
          </p></li><li class="listitem"><p>
            <code class="literal">events_errors_summary_by_thread_by_error</code>: エラーコードおよびスレッドごとのエラー
          </p></li><li class="listitem"><p>
            <code class="literal">events_errors_summary_by_user_by_error</code>: エラーコードおよびユーザーごとのエラー
          </p></li><li class="listitem"><p>
            <code class="literal">events_errors_summary_global_by_error</code>: エラーコードごとのエラー
          </p></li></ul></div><h4><a name="idm45882607356432"></a>ステータス変数サマリー</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">status_by_account</code>: アカウントごとのステータス変数
          </p></li><li class="listitem"><p>
            <code class="literal">status_by_host</code>: ホスト名ごとのステータス変数
          </p></li><li class="listitem"><p>
            <code class="literal">status_by_user</code>: ユーザー名ごとのステータス変数
          </p></li></ul></div><p>
        各サマリーテーブルには、集計するデータのグループ化の方法を決定するグループ化カラムと、集計値を格納するサマリーカラムがあります。 同様の方法でイベントを要約するテーブルには、多くの場合に類似の一連のサマリーカラムがあり、イベントの集計方法を決定するために使用されるグループ化カラムのみ異なります。 
      </p><p>
        サマリーテーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。 一般に、サマリーカラムは行を削除するのではなく、0 または <code class="literal">NULL</code> にリセットされます。 これにより、収集された値をクリアし、アグリゲーションを再開できます。 それは、実行時構成の変更を行なったあとなどに便利な場合があります。 この切捨て動作の例外は、個々のサマリーテーブルのセクションに記載されています。 
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-wait-summary-tables"></a>27.12.18.1 待機イベント要約テーブル</h4></div></div></div><a class="indexterm" name="idm45882607344832"></a><a class="indexterm" name="idm45882607342544"></a><a class="indexterm" name="idm45882607340480"></a><a class="indexterm" name="idm45882607338208"></a><a class="indexterm" name="idm45882607336160"></a><a class="indexterm" name="idm45882607333904"></a><a class="indexterm" name="idm45882607331872"></a><a class="indexterm" name="idm45882607329584"></a><a class="indexterm" name="idm45882607327520"></a><a class="indexterm" name="idm45882607325248"></a><a class="indexterm" name="idm45882607323200"></a><a class="indexterm" name="idm45882607320928"></a><p>
          パフォーマンススキーマは現在および最近の待機イベントを収集するためのテーブルを保守し、その情報をサマリーテーブルに集計します。<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="27.12.4 パフォーマンススキーマ待機イベントテーブル">セクション27.12.4「パフォーマンススキーマ待機イベントテーブル」</a>に待機サマリーが基づいているイベントについて説明しています。 待機イベントの内容、現在および最近の待機イベントテーブル、およびデフォルトで無効になっている待機イベント収集の制御方法については、その説明を参照してください。 
        </p><p>
          待機イベントサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_waits_summary_global_by_event_name\G</code></strong>
...
*************************** 6. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/BINARY_LOG::LOCK_index
    COUNT_STAR: 8
SUM_TIMER_WAIT: 2119302
MIN_TIMER_WAIT: 196092
AVG_TIMER_WAIT: 264912
MAX_TIMER_WAIT: 569421
...
*************************** 9. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/hash_filo::lock
    COUNT_STAR: 69
SUM_TIMER_WAIT: 16848828
MIN_TIMER_WAIT: 0
AVG_TIMER_WAIT: 244185
MAX_TIMER_WAIT: 735345
...
</pre><p>
          各待機イベントサマリーテーブルには、テーブルでのイベントの集計方法を示す 1 つ以上のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_account_by_event_name</code> には、<code class="literal">EVENT_NAME</code>、<code class="literal">USER</code> および <code class="literal">HOST</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_host_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">HOST</code> カラムがあります。 各行には、特定のホストおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_instance</code> には <code class="literal">EVENT_NAME</code> および <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。 各行は特定のイベント名とオブジェクトのイベントを要約します。 インストゥルメントを使用して複数のインスタンスを作成する場合、各インスタンスは一意の <code class="literal">OBJECT_INSTANCE_BEGIN</code> 値を持ち、このテーブルに個別にまとめられます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のスレッドおよびイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_user_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">USER</code> カラムがあります。 各行には、特定のユーザーおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 インストゥルメントを使用して、インストゥルメントされるオブジェクトの複数のインスタンスを作成できます。 たとえば、接続ごとに作成される相互排他ロックのインストゥルメントがある場合、接続と同じ数のインスタンスがあります。 インストゥルメントのサマリー行は、これらのすべてのインスタンス全体を要約します。 
            </p></li></ul></div><p>
          各待機イベントサマリーテーブルには、集計値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>
            </p><p>
              要約されたイベントの数。 この値には、時間付きか時間なしかに関係なく、すべてのイベントが含まれます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの合計待機時間。 時間なしイベントは <code class="literal">NULL</code> の待機時間を持つため、この値は時間付きイベントに対してのみ計算されます。 同じことがほかの <code class="literal"><em class="replaceable"><code>xxx</code></em>_TIMER_WAIT</code> 値にも当てはまります。 
            </p></li><li class="listitem"><p>
              <code class="literal">MIN_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの最小待機時間。
            </p></li><li class="listitem"><p>
              <code class="literal">AVG_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの平均待機時間。
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの最大待機時間。
            </p></li></ul></div><p>
          待機イベントのサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_account_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_host_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_instance</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
                </p></li><li class="listitem"><p>
                  (<code class="literal">EVENT_NAME</code>) のインデックス
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_thread_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_user_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_global_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は待機サマリーテーブルに使用できます。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              アカウント、ホストまたはユーザーごとに集計されないサマリーテーブルの場合、切捨てによって、行が削除されるのではなくサマリーカラムがゼロにリセットされます。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザー別に集計されたサマリーテーブルの場合、切捨てによって、接続のないアカウント、ホストまたはユーザーの行が削除され、残りの行のサマリーカラムがゼロにリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各待機サマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">events_waits_summary_global_by_event_name</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-stage-summary-tables"></a>27.12.18.2 ステージサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882607238320"></a><a class="indexterm" name="idm45882607236032"></a><a class="indexterm" name="idm45882607233968"></a><a class="indexterm" name="idm45882607231680"></a><a class="indexterm" name="idm45882607229616"></a><a class="indexterm" name="idm45882607227328"></a><a class="indexterm" name="idm45882607225264"></a><a class="indexterm" name="idm45882607222976"></a><a class="indexterm" name="idm45882607220912"></a><a class="indexterm" name="idm45882607218640"></a><p>
          パフォーマンススキーマは、現在および最近のステージイベントを収集するためのテーブルを保持し、その情報をサマリーテーブルに集約します。<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="27.12.5 パフォーマンススキーマステージイベントテーブル">セクション27.12.5「パフォーマンススキーマステージイベントテーブル」</a> では、ステージサマリーの基になるイベントが記述されます。 ステージイベントの内容、現在および過去のステージイベントテーブル、およびデフォルトで無効になっているステージイベント収集の制御方法の詳細は、その説明を参照してください。 
        </p><p>
          ステージイベントサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_stages_summary_global_by_event_name\G</code></strong>
...
*************************** 5. row ***************************
    EVENT_NAME: stage/sql/checking permissions
    COUNT_STAR: 57
SUM_TIMER_WAIT: 26501888880
MIN_TIMER_WAIT: 7317456
AVG_TIMER_WAIT: 464945295
MAX_TIMER_WAIT: 12858936792
...
*************************** 9. row ***************************
    EVENT_NAME: stage/sql/closing tables
    COUNT_STAR: 37
SUM_TIMER_WAIT: 662606568
MIN_TIMER_WAIT: 1593864
AVG_TIMER_WAIT: 17907891
MAX_TIMER_WAIT: 437977248
...
</pre><p>
          各ステージサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_account_by_event_name</code> には、<code class="literal">EVENT_NAME</code>、<code class="literal">USER</code> および <code class="literal">HOST</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_host_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">HOST</code> カラムがあります。 各行には、特定のホストおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のスレッドおよびイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_user_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">USER</code> カラムがあります。 各行には、特定のユーザーおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li></ul></div><p>
          各ステージ要約テーブルには、集計値を含む次の要約カラムがあります: <code class="literal">COUNT_STAR</code>, <code class="literal">SUM_TIMER_WAIT</code>, <code class="literal">MIN_TIMER_WAIT</code>, <code class="literal">AVG_TIMER_WAIT</code> および <code class="literal">MAX_TIMER_WAIT</code>。 これらのカラムは、待機イベントサマリーテーブル (<a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a> を参照) の同じ名前のカラムに似ていますが、ステージサマリーテーブルでは、<code class="literal">events_waits_current</code> ではなく <code class="literal">events_stages_current</code> のイベントが集計される点が異なります。 
        </p><p>
          ステージサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_account_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_host_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_thread_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_user_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_global_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はステージサマリーテーブルに使用できます。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              アカウント、ホストまたはユーザーごとに集計されないサマリーテーブルの場合、切捨てによって、行が削除されるのではなくサマリーカラムがゼロにリセットされます。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザー別に集計されたサマリーテーブルの場合、切捨てによって、接続のないアカウント、ホストまたはユーザーの行が削除され、残りの行のサマリーカラムがゼロにリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各ステージサマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">events_stages_summary_global_by_event_name</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-statement-summary-tables"></a>27.12.18.3 ステートメントサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882607152448"></a><a class="indexterm" name="idm45882607150144"></a><a class="indexterm" name="idm45882607148064"></a><a class="indexterm" name="idm45882607145808"></a><a class="indexterm" name="idm45882607143776"></a><a class="indexterm" name="idm45882607141472"></a><a class="indexterm" name="idm45882607139392"></a><a class="indexterm" name="idm45882607137136"></a><a class="indexterm" name="idm45882607135104"></a><a class="indexterm" name="idm45882607132800"></a><a class="indexterm" name="idm45882607130720"></a><a class="indexterm" name="idm45882607128416"></a><a class="indexterm" name="idm45882607126336"></a><a class="indexterm" name="idm45882607124048"></a><a class="indexterm" name="idm45882607121984"></a><a class="indexterm" name="idm45882607119744"></a><p>
          パフォーマンススキーマは、現在および最近のステートメントイベントを収集するためのテーブルを保持し、その情報をサマリーテーブルに集約します。<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a> は、ステートメントのサマリーの基になるイベントを記述します。 ステートメントイベントの内容、現在および過去のステートメントイベントテーブル、およびステートメントイベント収集の制御方法 (デフォルトでは部分的に無効になっています) については、その説明を参照してください。 
        </p><p>
          ステートメントイベントサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_statements_summary_global_by_event_name\G</code></strong>
*************************** 1. row ***************************
                 EVENT_NAME: statement/sql/select
                 COUNT_STAR: 25
             SUM_TIMER_WAIT: 1535983999000
             MIN_TIMER_WAIT: 209823000
             AVG_TIMER_WAIT: 61439359000
             MAX_TIMER_WAIT: 1363397650000
              SUM_LOCK_TIME: 20186000000
                 SUM_ERRORS: 0
               SUM_WARNINGS: 0
          SUM_ROWS_AFFECTED: 0
              SUM_ROWS_SENT: 388
          SUM_ROWS_EXAMINED: 370
SUM_CREATED_TMP_DISK_TABLES: 0
     SUM_CREATED_TMP_TABLES: 0
       SUM_SELECT_FULL_JOIN: 0
 SUM_SELECT_FULL_RANGE_JOIN: 0
           SUM_SELECT_RANGE: 0
     SUM_SELECT_RANGE_CHECK: 0
            SUM_SELECT_SCAN: 6
      SUM_SORT_MERGE_PASSES: 0
             SUM_SORT_RANGE: 0
              SUM_SORT_ROWS: 0
              SUM_SORT_SCAN: 0
          SUM_NO_INDEX_USED: 6
     SUM_NO_GOOD_INDEX_USED: 0
...
</pre><p>
          各ステートメントサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_account_by_event_name</code> には、<code class="literal">EVENT_NAME</code>、<code class="literal">USER</code> および <code class="literal">HOST</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_digest</code> には <code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> カラムがあります。 各行には、スキーマおよびダイジェスト値ごとにイベントが要約されます。 (<code class="literal">DIGEST_TEXT</code> カラムには、対応する正規化されたステートメントダイジェストテキストが含まれますが、グループ化カラムでもサマリーカラムでもありません。 <code class="literal">QUERY_SAMPLE_TEXT</code>、<code class="literal">QUERY_SAMPLE_SEEN</code> および <code class="literal">QUERY_SAMPLE_TIMER_WAIT</code> カラムもグループ化カラムでもサマリーカラムでもありません。これらはステートメントサンプリングをサポートしています。) 
            </p><p>
              テーブルの最大行数は、サーバー起動時に自動サイズ設定されます。 この最大を明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_digests_size</code> システム変数を設定します。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_host_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">HOST</code> カラムがあります。 各行には、特定のホストおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_program</code> には、<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code> カラムがあります。 各行には、特定のストアドプログラム (ストアドプロシージャーまたはストアドファンクション、トリガー、またはイベント) のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のスレッドおよびイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_user_by_event_name</code> には、<code class="literal">EVENT_NAME</code> カラムおよび <code class="literal">USER</code> カラムがあります。 各行には、特定のユーザーおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">prepared_statements_instances</code> には <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。 各行には、指定されたプリペアドステートメントのイベントが要約されます。 
            </p></li></ul></div><p>
          各ステートメント要約テーブルには、集計値を含む次の要約カラムがあります (ただし、次の例外があります):
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムは、ステートメントサマリーテーブルが <code class="literal">events_waits_current</code> ではなく <code class="literal">events_statements_current</code> からイベントを集約する点を除き、待機イベントサマリーテーブル (<a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a> を参照) 内の同じ名前のカラムに似ています。
            </p><p>
              <code class="literal">prepared_statements_instances</code> テーブルには、これらのカラムはありません。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code>
            </p><p>
              <code class="literal">events_statements_current</code> テーブル内の対応する <em class="replaceable"><code>xxx</code></em> カラムの集計。 たとえば、ステートメントサマリーテーブルの <code class="literal">SUM_LOCK_TIME</code> および <code class="literal">SUM_ERRORS</code> カラムは <code class="literal">events_statements_current</code> テーブルの <code class="literal">LOCK_TIME</code> および <code class="literal">ERRORS</code> カラムの集計です。 
            </p></li></ul></div><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルにはこれらの追加のサマリーカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FIRST_SEEN</code>, <code class="literal">LAST_SEEN</code>
            </p><p>
              指定されたダイジェスト値を持つステートメントがいつ最初に見られ、最後に見られたかを示すタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">QUANTILE_95</code>: ステートメントレイテンシの 95 パーセンタイル (ピコ秒)。 このパーセンタイルは、収集されたヒストグラムデータから計算された高い見積りです。 つまり、特定のダイジェストについて、測定されたステートメントの 95% のレイテンシは <code class="literal">QUANTILE_95</code> よりも低くなります。 
            </p><p>
              ヒストグラムデータにアクセスするには、<a class="xref" href="performance-schema.html#performance-schema-statement-histogram-summary-tables" title="27.12.18.4 ステートメントヒストグラム要約テーブル">セクション27.12.18.4「ステートメントヒストグラム要約テーブル」</a> で説明されているテーブルを使用します。
            </p></li><li class="listitem"><p>
              <code class="literal">QUANTILE_99</code>: <code class="literal">QUANTILE_95</code> と似ていますが、99 パーセンタイルです。
            </p></li><li class="listitem"><p>
              <code class="literal">QUANTILE_999</code>: <code class="literal">QUANTILE_95</code> と似ていますが、99.9 の第一パーセンタイル用です。
            </p></li></ul></div><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルには、次のカラムが含まれます。 これらはグループ化カラムでもサマリーカラムでもなく、ステートメントサンプリングをサポートしています: 
        </p><a class="indexterm" name="idm45882607042064"></a><a class="indexterm" name="idm45882607040576"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">QUERY_SAMPLE_TEXT</code>
            </p><p>
              行にダイジェスト値を生成するサンプル SQL ステートメント。 このカラムを使用すると、アプリケーションは、特定のダイジェスト値について、そのダイジェストを生成するサーバーによって実際に表示されるステートメントにアクセスできます。 これを使用するには、頻繁に発生するダイジェストに関連付けられた代表的なステートメントの実行計画を調べるために、ステートメントに対して <code class="literal">EXPLAIN</code> を実行します。 
            </p><p>
              <code class="literal">QUERY_SAMPLE_TEXT</code> カラムに値が割り当てられると、<code class="literal">QUERY_SAMPLE_SEEN</code> および <code class="literal">QUERY_SAMPLE_TIMER_WAIT</code> カラムにも値が割り当てられます。
            </p><p>
              ステートメントの表示に使用できる最大領域は、デフォルトで 1024 バイトです。 この値を変更するには、サーバーの起動時に <code class="literal">performance_schema_max_sql_text_length</code> システム変数を設定します。 (この値を変更すると、他の「パフォーマンススキーマ」テーブルのカラムにも影響します。 <a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。) 
            </p><p>
              ステートメントサンプリングの詳細は、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a> を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">QUERY_SAMPLE_SEEN</code>
            </p><p>
              <code class="literal">QUERY_SAMPLE_TEXT</code> カラムのステートメントがいつ見られたかを示すタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">QUERY_SAMPLE_TIMER_WAIT</code>
            </p><p>
              <code class="literal">QUERY_SAMPLE_TEXT</code> カラムのサンプルステートメントの待機時間。
            </p></li></ul></div><p>
          <code class="literal">events_statements_summary_by_program</code> テーブルには、次の追加のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STATEMENTS</code>, <code class="literal">SUM_STATEMENTS_WAIT</code>, <code class="literal">MIN_STATEMENTS_WAIT</code>, <code class="literal">AVG_STATEMENTS_WAIT</code>, <code class="literal">MAX_STATEMENTS_WAIT</code>
            </p><p>
              ストアドプログラムの実行中に呼び出されたネストされたステートメントに関する統計。
            </p></li></ul></div><p>
          <code class="literal">prepared_statements_instances</code> テーブルには、次の追加のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_EXECUTE</code>, <code class="literal">SUM_TIMER_EXECUTE</code>, <code class="literal">MIN_TIMER_EXECUTE</code>, <code class="literal">AVG_TIMER_EXECUTE</code>, <code class="literal">MAX_TIMER_EXECUTE</code>
            </p><p>
              プリペアドステートメントの実行の集計統計。
            </p></li></ul></div><p>
          ステートメントサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_account_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_digest</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">SCHEMA_NAME</code>、<code class="literal">DIGEST</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_host_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_program</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_thread_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_user_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_global_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はステートメントサマリーテーブルに使用できます。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_digest</code> の場合は、行を削除します。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザーごとに集計されない他のサマリーテーブルの場合、切捨てによって、行が削除されるのではなくサマリーカラムがゼロにリセットされます。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザー別に集計された他のサマリーテーブルの場合、切捨てによって、接続のないアカウント、ホストまたはユーザーの行が削除され、残りの行のサマリーカラムがゼロにリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各ステートメントサマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">events_statements_summary_global_by_event_name</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><p>
          また、<code class="literal">events_statements_summary_by_digest</code> を切り捨てると <code class="literal">events_statements_histogram_by_digest</code> が暗黙的に切り捨てられ、<code class="literal">events_statements_summary_global_by_event_name</code> を切り捨てると <code class="literal">events_statements_histogram_global</code> が暗黙的に切り捨てられます。
        </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="statement-summary-tables-aggregation"></a>ステートメントダイジェストアグリゲーションルール</h5></div></div></div><p>
            <code class="literal">statements_digest</code> コンシューマが有効な場合、<code class="literal">events_statements_summary_by_digest</code> への集計はステートメントの完了時に次のように行われます。 アグリゲーションはステートメントに対して計算された <code class="literal">DIGEST</code> 値に基づきます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                完了したばかりのステートメントのダイジェスト値のある <code class="literal">events_statements_summary_by_digest</code> 行がすでに存在する場合、ステートメントの統計はその行に集計されます。 <code class="literal">LAST_SEEN</code> カラムは現在の時間に更新されます。 
              </p></li><li class="listitem"><p>
                完了したばかりのステートメントのダイジェスト値のある行がなく、テーブルがいっぱいでない場合、そのステートメントに対して新しい行が作成されます。 <code class="literal">FIRST_SEEN</code> および <code class="literal">LAST_SEEN</code> カラムは現在の時間で初期化されます。 
              </p></li><li class="listitem"><p>
                完了したばかりのステートメントのステートメントダイジェスト値のある行がなく、テーブルがいっぱいである場合、完了したばかりのステートメントの統計が、必要に応じて作成される特別な<span class="quote">「<span class="quote">多目的</span>」</span>行に、<code class="literal">DIGEST</code> = <code class="literal">NULL</code> で追加されます。 この行が作成された場合、<code class="literal">FIRST_SEEN</code> および <code class="literal">LAST_SEEN</code> カラムは現在の時間で初期化されます。 そうでない場合、<code class="literal">LAST_SEEN</code> カラムが現在の時間で更新されます。 
              </p></li></ul></div><p>
            パフォーマンススキーマテーブルには、メモリー制約による最大サイズがあるため、<code class="literal">DIGEST</code> = <code class="literal">NULL</code> の行は保守されます。 <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ほかの行に一致しないダイジェストが、サマリーテーブルがいっぱいである場合でも、共通の<span class="quote">「<span class="quote">ほかの</span>」</span>バケットを使用して、カウントされることを許可します。 この行は、ダイジェストサマリーが代表的であるかどうかを推定するのに役立ちます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                すべてのダイジェストのうち 5% を表す <code class="literal">COUNT_STAR</code> 値がある <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ダイジェストサマリーテーブルがきわめて代表的であることを示します。ほかの行が、存在するステートメントの 95% を占めます。
              </p></li><li class="listitem"><p>
                すべてのダイジェストのうち 50% を表す <code class="literal">COUNT_STAR</code> 値がある <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ダイジェストサマリーテーブルがあまり代表的でないことを示します。ほかの行は、存在するステートメントの半分しか占めません。 たいていの場合に DBA は <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行にカウントされる行の多くが、代わりにより具体的な行を使用してカウントされるように、最大テーブルサイズを拡大するべきです。 これを実行するには、サーバーの起動時に、<code class="literal">performance_schema_digests_size</code> システム変数を大きな値に設定します。 デフォルトサイズは 200 です。 
              </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="statement-summary-tables-stored-programs"></a>ストアドプログラムインツルメンテーションの動作</h5></div></div></div><p>
            <code class="literal">setup_objects</code> テーブルでインスツルメンテーションが有効になっているストアドプログラムタイプの場合、<code class="literal">events_statements_summary_by_program</code> は次のようにストアドプログラムの統計を保持します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                行は、サーバーで最初に使用されたときにオブジェクトに追加されます。
              </p></li><li class="listitem"><p>
                オブジェクトの行は、オブジェクトが削除されると削除されます。
              </p></li><li class="listitem"><p>
                統計は、実行時にオブジェクトの行で集計されます。
              </p></li></ul></div><p>
            <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="27.4.3 イベントの事前フィルタリング">セクション27.4.3「イベントの事前フィルタリング」</a>も参照してください。
          </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-statement-histogram-summary-tables"></a>27.12.18.4 ステートメントヒストグラム要約テーブル</h4></div></div></div><a class="indexterm" name="idm45882606921184"></a><a class="indexterm" name="idm45882606918992"></a><a class="indexterm" name="idm45882606916960"></a><a class="indexterm" name="idm45882606914704"></a><p>
          パフォーマンススキーマは、ステートメントの最小待機時間、最大待機時間、および平均待機時間に関する情報を含むステートメントイベントのサマリーテーブルを保守します (<a class="xref" href="performance-schema.html#performance-schema-statement-summary-tables" title="27.12.18.3 ステートメントサマリーテーブル">セクション27.12.18.3「ステートメントサマリーテーブル」</a> を参照)。 これらのテーブルでは、システムパフォーマンスの高度な評価が可能です。 よりきめ細かいレベルでの評価を許可するために、パフォーマンススキーマはステートメントの待機時間のヒストグラムデータも収集します。 これらのヒストグラムを使用すると、待機時間分布をさらに把握できます。 
        </p><p>
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="27.12.6 パフォーマンススキーマステートメントイベントテーブル">セクション27.12.6「パフォーマンススキーマステートメントイベントテーブル」</a> は、ステートメントのサマリーの基になるイベントを記述します。 ステートメントイベントの内容、現在および過去のステートメントイベントテーブル、およびステートメントイベント収集の制御方法 (デフォルトでは部分的に無効になっています) については、その説明を参照してください。 
        </p><p>
          ステートメントヒストグラム情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_statements_histogram_by_digest</code></strong>
       <strong class="userinput"><code>WHERE SCHEMA_NAME = 'mydb' AND DIGEST = 'bb3f69453119b2d7b3ae40673a9d4c7c'</code></strong>
       <strong class="userinput"><code>AND COUNT_BUCKET &gt; 0 ORDER BY BUCKET_NUMBER\G</code></strong>
*************************** 1. row ***************************
           SCHEMA_NAME: mydb
                DIGEST: bb3f69453119b2d7b3ae40673a9d4c7c
         BUCKET_NUMBER: 42
      BUCKET_TIMER_LOW: 66069344
     BUCKET_TIMER_HIGH: 69183097
          COUNT_BUCKET: 1
COUNT_BUCKET_AND_LOWER: 1
       BUCKET_QUANTILE: 0.058824
*************************** 2. row ***************************
           SCHEMA_NAME: mydb
                DIGEST: bb3f69453119b2d7b3ae40673a9d4c7c
         BUCKET_NUMBER: 43
      BUCKET_TIMER_LOW: 69183097
     BUCKET_TIMER_HIGH: 72443596
          COUNT_BUCKET: 1
COUNT_BUCKET_AND_LOWER: 2
       BUCKET_QUANTILE: 0.117647
*************************** 3. row ***************************
           SCHEMA_NAME: mydb
                DIGEST: bb3f69453119b2d7b3ae40673a9d4c7c
         BUCKET_NUMBER: 44
      BUCKET_TIMER_LOW: 72443596
     BUCKET_TIMER_HIGH: 75857757
          COUNT_BUCKET: 2
COUNT_BUCKET_AND_LOWER: 4
       BUCKET_QUANTILE: 0.235294
*************************** 4. row ***************************
           SCHEMA_NAME: mydb
                DIGEST: bb3f69453119b2d7b3ae40673a9d4c7c
         BUCKET_NUMBER: 45
      BUCKET_TIMER_LOW: 75857757
     BUCKET_TIMER_HIGH: 79432823
          COUNT_BUCKET: 6
COUNT_BUCKET_AND_LOWER: 10
       BUCKET_QUANTILE: 0.625000
...
</pre><p>
          たとえば、3 行目の次の値は、23.52 % のクエリーが 75.86 マイクロ秒未満で実行されることを示しています:
        </p><pre class="programlisting">BUCKET_TIMER_HIGH: 75857757
  BUCKET_QUANTILE: 0.235294
</pre><p>
          行 4 の次の値は、62.50 のクエリーの割合が 79.44 マイクロ秒未満で実行されていることを示しています:
        </p><pre class="programlisting">BUCKET_TIMER_HIGH: 79432823
  BUCKET_QUANTILE: 0.625000
</pre><p>
          各ステートメントヒストグラムサマリーテーブルには、テーブルがイベントを集計する方法を示す 1 つ以上のグループ化カラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_histogram_by_digest</code> には、<code class="literal">SCHEMA_NAME</code>、<code class="literal">DIGEST</code> および <code class="literal">BUCKET_NUMBER</code> カラムがあります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> カラムは、<code class="literal">events_statements_summary_by_digest</code> テーブルのステートメントダイジェスト行を識別します。
                </p></li><li class="listitem"><p>
                  <code class="literal">SCHEMA_NAME</code> と <code class="literal">DIGEST</code> の値が同じ <code class="literal">events_statements_histogram_by_digest</code> 行は、そのスキーマとダイジェストの組合せのヒストグラムを構成します。
                </p></li><li class="listitem"><p>
                  特定のヒストグラム内で、<code class="literal">BUCKET_NUMBER</code> カラムはバケット番号を示します。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_histogram_global</code> には <code class="literal">BUCKET_NUMBER</code> カラムがあります。 このテーブルは、単一のヒストグラムを使用して、スキーマ名とダイジェスト値の間でグローバルに待機時間を要約しています。 <code class="literal">BUCKET_NUMBER</code> カラムは、このグローバルヒストグラム内のバケット番号を示します。 
            </p></li></ul></div><p>
          ヒストグラムは <em class="replaceable"><code>N</code></em> バケットで構成され、各行は単一のバケットを表し、バケット番号は <code class="literal">BUCKET_NUMBER</code> カラムで示されます。 バケット番号は 0 で始まります。 
        </p><p>
          各ステートメントヒストグラムサマリーテーブルには、集計値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">BUCKET_TIMER_LOW</code>, <code class="literal">BUCKET_TIMER_HIGH</code>
            </p><p>
              バケットは、<code class="literal">BUCKET_TIMER_LOW</code> と <code class="literal">BUCKET_TIMER_HIGH</code> の間で測定されたレイテンシを持つステートメントをピコ秒単位でカウントします:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  最初のバケット (<code class="literal">BUCKET_NUMBER</code> = 0) の <code class="literal">BUCKET_TIMER_LOW</code> の値は 0 です。
                </p></li><li class="listitem"><p>
                  バケット (<code class="literal">BUCKET_NUMBER</code> = <em class="replaceable"><code>k</code></em>) の <code class="literal">BUCKET_TIMER_LOW</code> の値は、前のバケット (<code class="literal">BUCKET_NUMBER</code> = <em class="replaceable"><code>k</code></em>-1) の <code class="literal">BUCKET_TIMER_HIGH</code> と同じです
                </p></li><li class="listitem"><p>
                  最後のバケットは、ヒストグラム内の前のバケットを超えるレイテンシを持つステートメントのキャッチオールです。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">COUNT_BUCKET</code>
            </p><p>
              <code class="literal">BUCKET_TIMER_LOW</code> から <code class="literal">BUCKET_TIMER_HIGH</code> までの間隔の待機時間で測定されたが、<code class="literal">BUCKET_TIMER_HIGH</code> を含まないステートメントの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_BUCKET_AND_LOWER</code>
            </p><p>
              0 から <code class="literal">BUCKET_TIMER_HIGH</code> を含まないまでの間隔で待機時間で測定されたステートメントの数。
            </p></li><li class="listitem"><p>
              <code class="literal">BUCKET_QUANTILE</code>
            </p><p>
              このバケットまたは下位バケットに該当するステートメントの比率。 この比率は、定義によって <code class="literal">COUNT_BUCKET_AND_LOWER / SUM(COUNT_BUCKET)</code> に対応し、利便性の高いカラムとして表示されます。 
            </p></li></ul></div><p>
          ステートメントヒストグラムサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_histogram_by_digest</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  (<code class="literal">SCHEMA_NAME</code>, <code class="literal">DIGEST</code>, <code class="literal">BUCKET_NUMBER</code>) の一意インデックス
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_statements_histogram_global</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">BUCKET_NUMBER</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、ステートメントヒストグラムサマリーテーブルに使用できます。 切捨てでは、<code class="literal">COUNT_BUCKET</code> および <code class="literal">COUNT_BUCKET_AND_LOWER</code> のカラムが 0 に設定されます。 
        </p><p>
          また、<code class="literal">events_statements_summary_by_digest</code> を切り捨てると <code class="literal">events_statements_histogram_by_digest</code> が暗黙的に切り捨てられ、<code class="literal">events_statements_summary_global_by_event_name</code> を切り捨てると <code class="literal">events_statements_histogram_global</code> が暗黙的に切り捨てられます。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-transaction-summary-tables"></a>27.12.18.5 トランザクション要約テーブル</h4></div></div></div><a class="indexterm" name="idm45882606837040"></a><a class="indexterm" name="idm45882606834736"></a><a class="indexterm" name="idm45882606832656"></a><a class="indexterm" name="idm45882606830352"></a><a class="indexterm" name="idm45882606828272"></a><a class="indexterm" name="idm45882606825968"></a><a class="indexterm" name="idm45882606823888"></a><a class="indexterm" name="idm45882606821584"></a><a class="indexterm" name="idm45882606819504"></a><a class="indexterm" name="idm45882606817200"></a><p>
          パフォーマンススキーマは、現在および最近のトランザクションイベントを収集するためのテーブルを保持し、その情報をサマリーテーブルに集約します。<a class="xref" href="performance-schema.html#performance-schema-transaction-tables" title="27.12.7 パフォーマンススキーマのトランザクションテーブル">セクション27.12.7「パフォーマンススキーマのトランザクションテーブル」</a> では、トランザクションサマリーの基になるイベントが記述されます。 トランザクションイベントの内容、現在および過去のトランザクションイベントテーブル、およびデフォルトで無効になっているトランザクションイベント収集の制御方法の詳細は、その説明を参照してください。 
        </p><p>
          トランザクションイベントのサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_transactions_summary_global_by_event_name</code></strong>
       <strong class="userinput"><code>LIMIT 1\G</code></strong>
*************************** 1. row ***************************
          EVENT_NAME: transaction
          COUNT_STAR: 5
      SUM_TIMER_WAIT: 19550092000
      MIN_TIMER_WAIT: 2954148000
      AVG_TIMER_WAIT: 3910018000
      MAX_TIMER_WAIT: 5486275000
    COUNT_READ_WRITE: 5
SUM_TIMER_READ_WRITE: 19550092000
MIN_TIMER_READ_WRITE: 2954148000
AVG_TIMER_READ_WRITE: 3910018000
MAX_TIMER_READ_WRITE: 5486275000
     COUNT_READ_ONLY: 0
 SUM_TIMER_READ_ONLY: 0
 MIN_TIMER_READ_ONLY: 0
 AVG_TIMER_READ_ONLY: 0
 MAX_TIMER_READ_ONLY: 0
</pre><p>
          各トランザクション要約テーブルには、テーブルでのイベントの集計方法を示す 1 つ以上のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_account_by_event_name</code> には、<code class="literal">USER</code>、<code class="literal">HOST</code> および <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_host_by_event_name</code> には、<code class="literal">HOST</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のホストおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_thread_by_event_name</code> には、<code class="literal">THREAD_ID</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のスレッドおよびイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_user_by_event_name</code> には、<code class="literal">USER</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のユーザーおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li></ul></div><p>
          各トランザクション要約テーブルには、集計値を含む次の要約カラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムは、待機イベントサマリーテーブル (<a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a> を参照) の同じ名前のカラムに似ていますが、トランザクションサマリーテーブルでは、<code class="literal">events_waits_current</code> ではなく <code class="literal">events_transactions_current</code> のイベントが集計される点が異なります。 これらのカラムには、読取り/書込みトランザクションと読取り専用トランザクションがまとめられています。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ_WRITE</code>, <code class="literal">SUM_TIMER_READ_WRITE</code>, <code class="literal">MIN_TIMER_READ_WRITE</code>, <code class="literal">AVG_TIMER_READ_WRITE</code>, <code class="literal">MAX_TIMER_READ_WRITE</code>
            </p><p>
              これらは、<code class="literal">COUNT_STAR</code> カラムおよび <code class="literal"><em class="replaceable"><code>xxx</code></em>_TIMER_WAIT</code> カラムに似ていますが、読取り/書込みトランザクションのみを要約します。 トランザクションアクセスモードでは、トランザクションが読取り/書込みモードと読取り専用モードのどちらで動作するかを指定します。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ_ONLY</code>, <code class="literal">SUM_TIMER_READ_ONLY</code>, <code class="literal">MIN_TIMER_READ_ONLY</code>, <code class="literal">AVG_TIMER_READ_ONLY</code>, <code class="literal">MAX_TIMER_READ_ONLY</code>
            </p><p>
              これらは、<code class="literal">COUNT_STAR</code> カラムおよび <code class="literal"><em class="replaceable"><code>xxx</code></em>_TIMER_WAIT</code> カラムに似ていますが、読取り専用トランザクションのみを要約します。 トランザクションアクセスモードでは、トランザクションが読取り/書込みモードと読取り専用モードのどちらで動作するかを指定します。 
            </p></li></ul></div><p>
          トランザクション要約テーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_account_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_host_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_thread_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_by_user_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_transactions_summary_global_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、トランザクション要約テーブルに対して許可されています。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              アカウント、ホストまたはユーザーごとに集計されないサマリーテーブルの場合、切捨てによって、行が削除されるのではなくサマリーカラムがゼロにリセットされます。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザー別に集計されたサマリーテーブルの場合、切捨てによって、接続のないアカウント、ホストまたはユーザーの行が削除され、残りの行のサマリーカラムがゼロにリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各トランザクションサマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">events_transactions_summary_global_by_event_name</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="transaction-summary-tables-aggregation"></a>トランザクション集計ルール</h5></div></div></div><p>
            トランザクションイベント収集は、分離レベル、アクセスモードまたは自動コミットモードに関係なく行われます。
          </p><p>
            トランザクションイベント収集は、サーバーによって開始された中断されていないすべてのトランザクション (空のトランザクションを含む) に対して発生します。
          </p><p>
            読取り/書込みトランザクションは通常、読取り専用トランザクションよりもリソース集中型であるため、トランザクションサマリーテーブルには、読取り/書込みトランザクションと読取り専用トランザクション用の個別の集計カラムが含まれます。
          </p><p>
            リソース要件は、トランザクション分離レベルによっても異なる場合があります。 ただし、サーバーごとに 1 つの分離レベルのみが使用されることを前提としており、分離レベルによる集計は提供されません。 
          </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-objects-summary-global-by-type-table"></a>27.12.18.6 オブジェクト待機サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882606728896"></a><a class="indexterm" name="idm45882606726656"></a><p>
          パフォーマンススキーマは、オブジェクト待機イベントを集約するための <code class="literal">objects_summary_global_by_type</code> テーブルを保守します。
        </p><p>
          オブジェクト待機イベントサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.objects_summary_global_by_type\G</code></strong>
...
*************************** 3. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: test
   OBJECT_NAME: t
    COUNT_STAR: 3
SUM_TIMER_WAIT: 263126976
MIN_TIMER_WAIT: 1522272
AVG_TIMER_WAIT: 87708678
MAX_TIMER_WAIT: 258428280
...
*************************** 10. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: mysql
   OBJECT_NAME: user
    COUNT_STAR: 14
SUM_TIMER_WAIT: 365567592
MIN_TIMER_WAIT: 1141704
AVG_TIMER_WAIT: 26111769
MAX_TIMER_WAIT: 334783032
...
</pre><p>
          <code class="literal">objects_summary_global_by_type</code> テーブルには、テーブルによるイベントの集計方法を示す次のグループ化カラムがあります: <code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code>。 各行は特定のオブジェクトのイベントを要約します。 
        </p><p>
          <code class="literal">objects_summary_global_by_type</code> には <code class="literal">events_waits_summary_by_<em class="replaceable"><code>xxx</code></em></code> テーブルと同じサマリーカラムがあります。 <a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a>を参照してください。 
        </p><p>
          <code class="literal">objects_summary_global_by_type</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はオブジェクトサマリーテーブルに使用できます。 それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-file-summary-tables"></a>27.12.18.7 ファイル I/O サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882606705392"></a><a class="indexterm" name="idm45882606703216"></a><a class="indexterm" name="idm45882606701216"></a><a class="indexterm" name="idm45882606698992"></a><p>
          パフォーマンススキーマは、I/O 操作に関する情報を集約するファイル I/O サマリーテーブルを保守します。
        </p><p>
          ファイル I/O イベントサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.file_summary_by_event_name\G</code></strong>
...
*************************** 2. row ***************************
               EVENT_NAME: wait/io/file/sql/binlog
               COUNT_STAR: 31
           SUM_TIMER_WAIT: 8243784888
           MIN_TIMER_WAIT: 0
           AVG_TIMER_WAIT: 265928484
           MAX_TIMER_WAIT: 6490658832
...
mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.file_summary_by_instance\G</code></strong>
...
*************************** 2. row ***************************
                FILE_NAME: /var/mysql/share/english/errmsg.sys
               EVENT_NAME: wait/io/file/sql/ERRMSG
               EVENT_NAME: wait/io/file/sql/ERRMSG
    OBJECT_INSTANCE_BEGIN: 4686193384
               COUNT_STAR: 5
           SUM_TIMER_WAIT: 13990154448
           MIN_TIMER_WAIT: 26349624
           AVG_TIMER_WAIT: 2798030607
           MAX_TIMER_WAIT: 8150662536
...
</pre><p>
          各ファイル I/O サマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">file_summary_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">file_summary_by_instance</code> には、<code class="literal">FILE_NAME</code>、<code class="literal">EVENT_NAME</code> および <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。 各行は特定のファイルおよびイベント名のイベントを要約します。 
            </p></li></ul></div><p>
          各ファイル I/O サマリーテーブルには、集約された値を含む次のサマリーカラムがあります。 一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。 このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムはすべての I/O 操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>、<code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              これらのカラムは <code class="literal">FGETS</code>、<code class="literal">FGETC</code>、<code class="literal">FREAD</code>、および <code class="literal">READ</code> を含むすべての読み取り操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>、<code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              これらのカラムは <code class="literal">FPUTS</code>、<code class="literal">FPUTC</code>、<code class="literal">FPRINTF</code>、<code class="literal">VFPRINTF</code>、<code class="literal">FWRITE</code>、および <code class="literal">PWRITE</code> を含むすべての書き込み操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>、<code class="literal">SUM_TIMER_MISC</code>、<code class="literal">MIN_TIMER_MISC</code>、<code class="literal">AVG_TIMER_MISC</code>、<code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              これらのカラムは <code class="literal">CREATE</code>、<code class="literal">DELETE</code>、<code class="literal">OPEN</code>、<code class="literal">CLOSE</code>、<code class="literal">STREAM_OPEN</code>、<code class="literal">STREAM_CLOSE</code>、<code class="literal">SEEK</code>、<code class="literal">TELL</code>、<code class="literal">FLUSH</code>、<code class="literal">STAT</code>、<code class="literal">FSTAT</code>、<code class="literal">CHSIZE</code>、<code class="literal">RENAME</code>、および <code class="literal">SYNC</code> を含むその他のすべての I/O 操作を集計します。 これらの操作のバイトカウントはありません。 
            </p></li></ul></div><p>
          ファイル I/O サマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">file_summary_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">file_summary_by_instance</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
                </p></li><li class="listitem"><p>
                  (<code class="literal">FILE_NAME</code>) のインデックス
                </p></li><li class="listitem"><p>
                  (<code class="literal">EVENT_NAME</code>) のインデックス
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はファイル I/O サマリーテーブルに使用できます。 それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。 
        </p><p>
          MySQL サーバーでは、複数の手法を使用して、ファイルから読み取られた情報をキャッシュすることで I/O 操作を回避するため、I/O イベントが発生すると予想されるステートメントではそうしない可能性があります。 キャッシュをフラッシュするか、サーバーを再起動して、その状態をリセットすることによって、I/O を発生させることができる場合があります。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="table-wait-summary-tables"></a>27.12.18.8 テーブル I/O およびロック待機サマリーテーブル</h4></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-table-io-waits-summary-by-table-table">27.12.18.8.1 table_io_waits_summary_by_table テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-io-waits-summary-by-index-usage-table">27.12.18.8.2 table_io_waits_summary_by_index_usage テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-lock-waits-summary-by-table-table">27.12.18.8.3 table_lock_waits_summary_by_table テーブル</a></span></dt></dl></div><p>
          次のセクションでは、テーブル I/O およびロック待機サマリーテーブルについて説明します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_index_usage</code>: インデックスごとのテーブル I/O 待機
            </p></li><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_table</code>: テーブルごとのテーブル I/O 待機
            </p></li><li class="listitem"><p>
              <code class="literal">table_lock_waits_summary_by_table</code>: テーブルごとのテーブルロック待機
            </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-table-io-waits-summary-by-table-table"></a>27.12.18.8.1 table_io_waits_summary_by_table テーブル</h5></div></div></div><a class="indexterm" name="idm45882606619344"></a><a class="indexterm" name="idm45882606617088"></a><p>
            <code class="literal">table_io_waits_summary_by_table</code> テーブルは、<code class="literal">wait/io/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブル I/O 待機イベントを集計します。 グループ化はテーブル単位です。 
          </p><p>
            <code class="literal">table_io_waits_summary_by_table</code> テーブルには、テーブルのイベントの集計方法を示すこれらのグループ化カラムがあります。<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code>、および <code class="literal">OBJECT_NAME</code>。 これらのカラムは、<code class="literal">events_waits_current</code> テーブル内と同じ意味を持ちます。 それらは、行の適用先のテーブルを識別します。 
          </p><p>
            <code class="literal">table_io_waits_summary_by_table</code> には集計された値を格納する次のサマリーカラムがあります。 カラムの説明に示すように、一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。 たとえば、すべての書き込みを集計するカラムは、挿入、更新、および削除を集計する対応するカラムの合計を保持します。 このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                これらのカラムはすべての I/O 操作を集計します。 それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code> および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code> カラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>
              </p><p>
                これらのカラムはすべての読み取り操作を集計します。 それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_FETCH</code> カラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                これらのカラムはすべての書き込み操作を集計します。 それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_INSERT</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_UPDATE</code>、および <code class="literal"><em class="replaceable"><code>xxx</code></em>_DELETE</code> カラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_FETCH</code>、<code class="literal">SUM_TIMER_FETCH</code>、<code class="literal">MIN_TIMER_FETCH</code>、<code class="literal">AVG_TIMER_FETCH</code>、<code class="literal">MAX_TIMER_FETCH</code>
              </p><p>
                これらのカラムはすべてのフェッチ操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_INSERT</code>、<code class="literal">SUM_TIMER_INSERT</code>、<code class="literal">MIN_TIMER_INSERT</code>、<code class="literal">AVG_TIMER_INSERT</code>、<code class="literal">MAX_TIMER_INSERT</code>
              </p><p>
                これらのカラムはすべての挿入操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_UPDATE</code>、<code class="literal">SUM_TIMER_UPDATE</code>、<code class="literal">MIN_TIMER_UPDATE</code>、<code class="literal">AVG_TIMER_UPDATE</code>、<code class="literal">MAX_TIMER_UPDATE</code>
              </p><p>
                これらのカラムはすべての更新操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_DELETE</code>、<code class="literal">SUM_TIMER_DELETE</code>、<code class="literal">MIN_TIMER_DELETE</code>、<code class="literal">AVG_TIMER_DELETE</code>、<code class="literal">MAX_TIMER_DELETE</code>
              </p><p>
                これらのカラムはすべての削除操作を集計します。
              </p></li></ul></div><p>
            <code class="literal">table_io_waits_summary_by_table</code> テーブルには次のインデックスがあります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>) の一意インデックス
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブル I/O サマリーテーブルに使用できます。 それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。 このテーブルを切り捨てると、<code class="literal">table_io_waits_summary_by_index_usage</code> テーブルも切り捨てられます。 
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-table-io-waits-summary-by-index-usage-table"></a>27.12.18.8.2 table_io_waits_summary_by_index_usage テーブル</h5></div></div></div><a class="indexterm" name="idm45882606555344"></a><a class="indexterm" name="idm45882606553088"></a><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code> テーブルは、<code class="literal">wait/io/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブルインデックス I/O 待機イベントを集計します。 グループ化はテーブルインデックス単位です。 
          </p><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code> のカラムは、<code class="literal">table_io_waits_summary_by_table</code> とほぼ同じです。 唯一の違いは、テーブル I/O 待機イベントが記録されたときに使用されたインデックスの名前に対応する、追加のグループカラム <code class="literal">INDEX_NAME</code> です。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">PRIMARY</code> の値はテーブル I/O でプライマリインデックスが使用されたことを示します。
              </p></li><li class="listitem"><p>
                <code class="literal">NULL</code> の値はテーブル I/O でインデックスが使用されなかったことを示します。
              </p></li><li class="listitem"><p>
                挿入は <code class="literal">INDEX_NAME = NULL</code> に対してカウントされます。
              </p></li></ul></div><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code> テーブルには次のインデックスがあります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>, <code class="literal">INDEX_NAME</code>) の一意インデックス
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブル I/O サマリーテーブルに使用できます。 それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。 このテーブルも、<code class="literal">table_io_waits_summary_by_table</code> テーブルの切り捨てによって切り捨てられます。 テーブルのインデックス構造を変更する DDL 操作により、インデックスごとの統計がリセットされることがあります。 
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-table-lock-waits-summary-by-table-table"></a>27.12.18.8.3 table_lock_waits_summary_by_table テーブル</h5></div></div></div><a class="indexterm" name="idm45882606529408"></a><a class="indexterm" name="idm45882606527152"></a><p>
            <code class="literal">table_lock_waits_summary_by_table</code> テーブルは、<code class="literal">wait/lock/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブルロック待機イベントを集計します。 グループ化はテーブル単位です。 
          </p><p>
            このテーブルには、内部および外部ロックに関する情報が格納されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                内部ロックは、SQL レイヤーのロックに対応します。 これは現在 <code class="literal">thr_lock()</code> への呼び出しによって実装されます。 イベント行では、これらのロックは次のいずれかの値を持つ <code class="literal">OPERATION</code> カラムによって区別されます: 
              </p><pre class="programlisting">read normal
read with shared locks
read high priority
read no insert
write allow write
write concurrent insert
write delayed
write low priority
write normal
</pre></li><li class="listitem"><p>
                外部ロックはストレージエンジンレイヤーのロックに対応します。 これは現在 <code class="literal">handler::external_lock()</code> への呼び出しによって実装されます。 イベント行では、これらのロックは次のいずれかの値を持つ <code class="literal">OPERATION</code> カラムによって区別されます: 
              </p><pre class="programlisting">read external
write external
</pre></li></ul></div><p>
            <code class="literal">table_lock_waits_summary_by_table</code> テーブルには、テーブルのイベントの集計方法を示すこれらのグループ化カラムがあります。<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code>、および <code class="literal">OBJECT_NAME</code>。 これらのカラムは、<code class="literal">events_waits_current</code> テーブル内と同じ意味を持ちます。 それらは、行の適用先のテーブルを識別します。 
          </p><p>
            <code class="literal">table_lock_waits_summary_by_table</code> には集計された値を格納する次のサマリーカラムがあります。 カラムの説明に示すように、一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。 たとえば、すべてのロックを集計するカラムは、読み取りおよび書き込みロックを集計する対応するカラムの合計を保持します。 このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                これらのカラムはすべてのロック操作を集計します。 それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code> および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code> カラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>
              </p><p>
                これらのカラムはすべての読み取りロック操作を集計します。 それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NORMAL</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_WITH_SHARED_LOCKS</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_HIGH_PRIORITY</code>、および <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NO_INSERT</code> カラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                これらのカラムはすべての書き込みロック操作を集計します。 これらは、対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_ALLOW_WRITE</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_CONCURRENT_INSERT</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_LOW_PRIORITY</code> および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_NORMAL</code> のカラムの合計と同じです。 
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NORMAL</code>、<code class="literal">SUM_TIMER_READ_NORMAL</code>、<code class="literal">MIN_TIMER_READ_NORMAL</code>、<code class="literal">AVG_TIMER_READ_NORMAL</code>、<code class="literal">MAX_TIMER_READ_NORMAL</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_WITH_SHARED_LOCKS</code>、<code class="literal">SUM_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">MIN_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">AVG_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">MAX_TIMER_READ_WITH_SHARED_LOCKS</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_HIGH_PRIORITY</code>、<code class="literal">SUM_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">MIN_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">AVG_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">MAX_TIMER_READ_HIGH_PRIORITY</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NO_INSERT</code>、<code class="literal">SUM_TIMER_READ_NO_INSERT</code>、<code class="literal">MIN_TIMER_READ_NO_INSERT</code>、<code class="literal">AVG_TIMER_READ_NO_INSERT</code>、<code class="literal">MAX_TIMER_READ_NO_INSERT</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_EXTERNAL</code>、<code class="literal">SUM_TIMER_READ_EXTERNAL</code>、<code class="literal">MIN_TIMER_READ_EXTERNAL</code>、<code class="literal">AVG_TIMER_READ_EXTERNAL</code>、<code class="literal">MAX_TIMER_READ_EXTERNAL</code>
              </p><p>
                これらのカラムは外部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_ALLOW_WRITE</code>、<code class="literal">SUM_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">MIN_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">AVG_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">MAX_TIMER_WRITE_ALLOW_WRITE</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_CONCURRENT_INSERT</code>、<code class="literal">SUM_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">MIN_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">AVG_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">MAX_TIMER_WRITE_CONCURRENT_INSERT</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_LOW_PRIORITY</code>、<code class="literal">SUM_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">MIN_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">AVG_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">MAX_TIMER_WRITE_LOW_PRIORITY</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_NORMAL</code>、<code class="literal">SUM_TIMER_WRITE_NORMAL</code>、<code class="literal">MIN_TIMER_WRITE_NORMAL</code>、<code class="literal">AVG_TIMER_WRITE_NORMAL</code>、<code class="literal">MAX_TIMER_WRITE_NORMAL</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_EXTERNAL</code>、<code class="literal">SUM_TIMER_WRITE_EXTERNAL</code>、<code class="literal">MIN_TIMER_WRITE_EXTERNAL</code>、<code class="literal">AVG_TIMER_WRITE_EXTERNAL</code>、<code class="literal">MAX_TIMER_WRITE_EXTERNAL</code>
              </p><p>
                これらのカラムは外部書き込みロックを集計します。
              </p></li></ul></div><p>
            <code class="literal">table_lock_waits_summary_by_table</code> テーブルには次のインデックスがあります:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                (<code class="literal">OBJECT_TYPE</code>, <code class="literal">OBJECT_SCHEMA</code>, <code class="literal">OBJECT_NAME</code>) の一意インデックス
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブルロックサマリーテーブルに使用できます。 それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。 
          </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-socket-summary-tables"></a>27.12.18.9 ソケットサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882606423552"></a><a class="indexterm" name="idm45882606421376"></a><a class="indexterm" name="idm45882606419360"></a><a class="indexterm" name="idm45882606417136"></a><p>
          これらのソケットサマリーテーブルは、ソケット操作のタイマーおよびバイトカウント情報を集計します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code>: ソケットインストゥルメントごとに、すべてのソケット I/O 操作の <code class="literal">wait/io/socket/*</code> インストゥルメントによって生成されたタイマーおよびバイトカウント統計を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_instance</code>: ソケットインスタンスごとに、すべてのソケット I/O 操作の <code class="literal">wait/io/socket/*</code> インストゥルメントによって生成されたタイマーおよびバイトカウント統計を集計します。 接続が終了すると、<code class="literal">socket_summary_by_instance</code> 内のそれに対応する行が削除されます。 
            </p></li></ul></div><p>
          ソケットサマリーテーブルは、ソケットがクライアントからの次のリクエストを待っている間に、<code class="literal">idle</code> イベントによって生成される待機は集計しません。 <code class="literal">idle</code> イベントアグリゲーションには、待機イベントサマリーテーブルを使用します。<a class="xref" href="performance-schema.html#performance-schema-wait-summary-tables" title="27.12.18.1 待機イベント要約テーブル">セクション27.12.18.1「待機イベント要約テーブル」</a>を参照してください。 
        </p><p>
          各ソケットサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_instance</code> には <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。 各行は特定のオブジェクトのイベントを要約します。 
            </p></li></ul></div><p>
          各ソケットサマリーテーブルには、集約された値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムはすべての操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>、<code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              これらのカラムはすべての受信操作 (<code class="literal">RECV</code>、<code class="literal">RECVFROM</code>、および <code class="literal">RECVMSG</code>) を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>、<code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              これらのカラムはすべての送信操作 (<code class="literal">SEND</code>、<code class="literal">SENDTO</code>、および <code class="literal">SENDMSG</code>) を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>、<code class="literal">SUM_TIMER_MISC</code>、<code class="literal">MIN_TIMER_MISC</code>、<code class="literal">AVG_TIMER_MISC</code>、<code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              これらのカラムは <code class="literal">CONNECT</code>、<code class="literal">LISTEN</code>、<code class="literal">ACCEPT</code>、<code class="literal">CLOSE</code>、および <code class="literal">SHUTDOWN</code> などのほかのすべてのソケット操作を集計します。 これらの操作のバイトカウントはありません。 
            </p></li></ul></div><p>
          <code class="literal">socket_summary_by_instance</code> テーブルには、ソケットのクラス (<code class="literal">client_connection</code>、<code class="literal">server_tcpip_socket</code>、<code class="literal">server_unix_socket</code>) を示す <code class="literal">EVENT_NAME</code> カラムもあります。 このカラムは、たとえば、クライアントアクティビティーをサーバー待機ソケットのそれから分離するために、グループ化できます。 
        </p><p>
          ソケットサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_instance</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">OBJECT_INSTANCE_BEGIN</code>)
                </p></li><li class="listitem"><p>
                  (<code class="literal">EVENT_NAME</code>) のインデックス
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はソケットサマリーテーブルに使用できます。 <code class="literal">events_statements_summary_by_digest</code> を除き、tt は行を削除するのではなく、サマリーカラムを 0 にリセットします。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-memory-summary-tables"></a>27.12.18.10 メモリーサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm45882606347216"></a><a class="indexterm" name="idm45882606345024"></a><a class="indexterm" name="idm45882606342992"></a><a class="indexterm" name="idm45882606340720"></a><a class="indexterm" name="idm45882606338672"></a><a class="indexterm" name="idm45882606336416"></a><a class="indexterm" name="idm45882606334384"></a><a class="indexterm" name="idm45882606332128"></a><a class="indexterm" name="idm45882606330096"></a><a class="indexterm" name="idm45882606327840"></a><p>
          パフォーマンススキーマは、メモリー使用量を計測し、メモリー使用量の統計を集約します。詳細は、次の要因を参照してください:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              使用されるメモリーのタイプ (様々なキャッシュ、内部バッファなど)
            </p></li><li class="listitem"><p>
              メモリー操作を間接的に実行するスレッド、アカウント、ユーザー、ホスト
            </p></li></ul></div><p>
          パフォーマンススキーマは、メモリー使用の次の側面を計測
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              使用済メモリーサイズ
            </p></li><li class="listitem"><p>
              操作数
            </p></li><li class="listitem"><p>
              最低水位標と最高水位標
            </p></li></ul></div><p>
          メモリーサイズは、サーバーのメモリー消費を理解またはチューニングするのに役立ちます。
        </p><p>
          操作数は、サーバーがメモリーアロケータに与える全体的な圧力を理解またはチューニングするのに役立ちます。これはパフォーマンスに影響します。 シングルバイトを 100 万回割り当てることは、100 万バイトを一度に割り当てることと同じではありません。サイズとカウントの両方を追跡すると、違いが生じる可能性があります。 
        </p><p>
          最低水位標と最高水位標は、ワークロードのスパイク、全体的なワークロードの安定性およびメモリーリークの可能性を検出するために重要です。
        </p><p>
          メモリーサマリーテーブルには、メモリーイベントが時間指定されていないため、タイミング情報は含まれません。
        </p><p>
          メモリー使用量データの収集の詳細は、<a class="xref" href="performance-schema.html#memory-instrumentation-behavior" title="メモリーインストゥルメンテーションの動作">メモリーインストゥルメンテーションの動作</a> を参照してください。
        </p><p>
          メモリーイベントのサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.memory_summary_global_by_event_name</code></strong>
       <strong class="userinput"><code>WHERE EVENT_NAME = 'memory/sql/TABLE'\G</code></strong>
*************************** 1. row ***************************
                  EVENT_NAME: memory/sql/TABLE
                 COUNT_ALLOC: 1381
                  COUNT_FREE: 924
   SUM_NUMBER_OF_BYTES_ALLOC: 2059873
    SUM_NUMBER_OF_BYTES_FREE: 1407432
              LOW_COUNT_USED: 0
          CURRENT_COUNT_USED: 457
             HIGH_COUNT_USED: 461
    LOW_NUMBER_OF_BYTES_USED: 0
CURRENT_NUMBER_OF_BYTES_USED: 652441
   HIGH_NUMBER_OF_BYTES_USED: 669269
</pre><p>
          各メモリーサマリーテーブルには、テーブルがイベントを集約する方法を示す 1 つまたは複数のグループ化カラムがあります。 イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を参照します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">memory_summary_by_account_by_event_name</code> には、<code class="literal">USER</code>、<code class="literal">HOST</code> および <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_host_by_event_name</code> には、<code class="literal">HOST</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のホストおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_thread_by_event_name</code> には、<code class="literal">THREAD_ID</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のスレッドおよびイベント名のイベントを要約します。 
            </p></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_user_by_event_name</code> には、<code class="literal">USER</code> カラムおよび <code class="literal">EVENT_NAME</code> カラムがあります。 各行には、特定のユーザーおよびイベント名のイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">memory_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。 各行は特定のイベント名のイベントを要約します。 
            </p></li></ul></div><p>
          各メモリーサマリーテーブルには、集計値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_ALLOC</code>, <code class="literal">COUNT_FREE</code>
            </p><p>
              メモリー割り当て関数およびメモリー解放関数への呼び出しの総数。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_NUMBER_OF_BYTES_ALLOC</code>, <code class="literal">SUM_NUMBER_OF_BYTES_FREE</code>
            </p><p>
              割り当てられたメモリーブロックおよび解放されたメモリーブロックの集計サイズ。
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_COUNT_USED</code>
            </p><p>
              まだ解放されていない現在割り当てられているブロックの集計数。 これは、<code class="literal">COUNT_ALLOC</code>−<code class="literal">COUNT_FREE</code> と同等の便利なカラムです。 
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code>
            </p><p>
              まだ解放されていない、現在割り当てられているメモリーブロックの集計サイズ。 これは、<code class="literal">SUM_NUMBER_OF_BYTES_ALLOC</code>−<code class="literal">SUM_NUMBER_OF_BYTES_FREE</code> と同等の便利なカラムです。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOW_COUNT_USED</code>, <code class="literal">HIGH_COUNT_USED</code>
            </p><p>
              <code class="literal">CURRENT_COUNT_USED</code> カラムに対応する最低水位標および最高水位標。
            </p></li><li class="listitem"><p>
              <code class="literal">LOW_NUMBER_OF_BYTES_USED</code>, <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code>
            </p><p>
              <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code> カラムに対応する最低水位標および最高水位標。
            </p></li></ul></div><p>
          メモリーサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">memory_summary_by_account_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_host_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_thread_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">memory_summary_by_user_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">memory_summary_global_by_event_name</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">EVENT_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はメモリーサマリーテーブルに対して許可されています。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              通常、切捨てによって統計のベースラインがリセットされますが、サーバーの状態は変更されません。 つまり、メモリーテーブルを切り捨ててもメモリーは解放されません。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ALLOC</code> および <code class="literal">COUNT_FREE</code> は、各カウンタを同じ値だけ減らすことで、新しいベースラインにリセットされます。
            </p></li><li class="listitem"><p>
              同様に、<code class="literal">SUM_NUMBER_OF_BYTES_ALLOC</code> および <code class="literal">SUM_NUMBER_OF_BYTES_FREE</code> は新しいベースラインにリセットされます。
            </p></li><li class="listitem"><p>
              <code class="literal">LOW_COUNT_USED</code> および <code class="literal">HIGH_COUNT_USED</code> は <code class="literal">CURRENT_COUNT_USED</code> にリセットされます。
            </p></li><li class="listitem"><p>
              <code class="literal">LOW_NUMBER_OF_BYTES_USED</code> および <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code> は <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code> にリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各メモリーサマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">memory_summary_global_by_event_name</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="memory-instrumentation-behavior"></a>メモリーインストゥルメンテーションの動作</h5></div></div></div><p>
            メモリーインストゥルメントは <code class="literal">setup_instruments</code> テーブルにリストされ、<code class="literal">memory/<em class="replaceable"><code>code_area</code></em>/<em class="replaceable"><code>instrument_name</code></em></code> という形式の名前を持ちます。 メモリーインストゥルメンテーションはデフォルトで有効になっています。 
          </p><p>
            接頭辞 <code class="literal">memory/performance_schema/</code>が付いたインストゥルメントは、パフォーマンススキーマ自体の内部バッファーに割り当てられているメモリー量を公開します。 <code class="literal">memory/performance_schema/</code>インストゥルメントは組込みであり、常に有効になっており、起動時または実行時に無効にすることはできません。 組込みメモリーインストルメントは、<code class="literal">memory_summary_global_by_event_name</code> テーブルにのみ表示されます。 
          </p><p>
            サーバー起動時のメモリーインストゥルメンテーションの状態を制御するには、<code class="filename">my.cnf</code> ファイルで次のような行を使用します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                有効化:
              </p><pre class="programlisting">[mysqld]
performance-schema-instrument='memory/%=ON'
</pre></li><li class="listitem"><p>
                無効化:
              </p><pre class="programlisting">[mysqld]
performance-schema-instrument='memory/%=OFF'
</pre></li></ul></div><p>
            実行時のメモリーインストゥルメンテーションの状態を制御するには、<code class="literal">setup_instruments</code> テーブルの関連インストゥルメントの <code class="literal">ENABLED</code> カラムを更新します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                有効化:
              </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'YES'
WHERE NAME LIKE 'memory/%';
</pre></li><li class="listitem"><p>
                無効化:
              </p><pre class="programlisting">UPDATE performance_schema.setup_instruments
SET ENABLED = 'NO'
WHERE NAME LIKE 'memory/%';
</pre></li></ul></div><p>
            メモリーインストルメントの場合、メモリー操作は時間外であるため、<code class="literal">setup_instruments</code> の <code class="literal">TIMED</code> カラムは無視されます。
          </p><p>
            サーバー内のスレッドがインストゥルメントされたメモリー割当てを実行する場合、次のルールが適用されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                スレッドがインストゥルメントされていない場合、またはメモリーインストゥルメントが有効になっていない場合、割り当てられたメモリーブロックはインストゥルメントされません。
              </p></li><li class="listitem"><p>
                それ以外の場合 (つまり、スレッドとインストゥルメントの両方が有効になっている場合)、割り当てられたメモリーブロックがインストゥルメントされます。
              </p></li></ul></div><p>
            割当て解除には、次のルールが適用されます:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                メモリー割当て操作がインストゥルメントされた場合、現在のインストゥルメントまたはスレッド有効ステータスに関係なく、対応する空き操作がインストゥルメントされます。
              </p></li><li class="listitem"><p>
                メモリー割当て操作がインストゥルメントされていない場合、現在のインストゥルメントまたはスレッド有効ステータスに関係なく、対応する空き操作はインストゥルメントされません。
              </p></li></ul></div><p>
            スレッドごとの統計には、次のルールが適用されます。
          </p><p>
            計測されたサイズ <em class="replaceable"><code>N</code></em> のメモリーブロックが割り当てられると、パフォーマンススキーマはメモリーサマリーテーブルのカラムを次のように更新します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_ALLOC</code>: 増加 1
              </p></li><li class="listitem"><p>
                <code class="literal">CURRENT_COUNT_USED</code>: 増加 1
              </p></li><li class="listitem"><p>
                <code class="literal">HIGH_COUNT_USED</code>: <code class="literal">CURRENT_COUNT_USED</code> が新しい最大値の場合に増加
              </p></li><li class="listitem"><p>
                <code class="literal">SUM_NUMBER_OF_BYTES_ALLOC</code>: <em class="replaceable"><code>N</code></em> による増加
              </p></li><li class="listitem"><p>
                <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code>: <em class="replaceable"><code>N</code></em> による増加
              </p></li><li class="listitem"><p>
                <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code>: <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code> が新しい最大値の場合に増加
              </p></li></ul></div><p>
            インストゥルメントされたメモリーブロックの割り当てが解除されると、パフォーマンススキーマはメモリーサマリーテーブルのカラムを次のように更新します:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_FREE</code>: 増加 1
              </p></li><li class="listitem"><p>
                <code class="literal">CURRENT_COUNT_USED</code>: 減少 1
              </p></li><li class="listitem"><p>
                <code class="literal">LOW_COUNT_USED</code>: <code class="literal">CURRENT_COUNT_USED</code> が新しい最小値の場合は減少
              </p></li><li class="listitem"><p>
                <code class="literal">SUM_NUMBER_OF_BYTES_FREE</code>: <em class="replaceable"><code>N</code></em> による増加
              </p></li><li class="listitem"><p>
                <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code>: <em class="replaceable"><code>N</code></em> による減少
              </p></li><li class="listitem"><p>
                <code class="literal">LOW_NUMBER_OF_BYTES_USED</code>: <code class="literal">CURRENT_NUMBER_OF_BYTES_USED</code> が新しい最小値の場合は減少
              </p></li></ul></div><p>
            高レベルの集計 (アカウント別、ユーザー別、ホスト別) では、最低水位標と最高水位標に同じルールが適用されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">LOW_COUNT_USED</code> および <code class="literal">LOW_NUMBER_OF_BYTES_USED</code> は、より低い見積りです。 パフォーマンススキーマによって報告される値は、実行時に効率的に使用されるメモリーの最小数または最小サイズ以下であることが保証されます。 
              </p></li><li class="listitem"><p>
                <code class="literal">HIGH_COUNT_USED</code> および <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code> は、より高い見積りです。 パフォーマンススキーマによって報告される値は、実行時に効率的に使用されるメモリーの最大数または最大サイズ以上であることが保証されます。 
              </p></li></ul></div><p>
            <code class="literal">memory_summary_global_by_event_name</code> 以外のサマリーテーブルの見積りが低い場合、スレッド間でメモリー所有権が転送されると、値が負になる可能性があります。
          </p><p>
            見積計算の例を次に示しますが、見積実装は変更される可能性があることに注意してください:
          </p><p>
            スレッド 1 は、<code class="literal">memory_summary_by_thread_by_event_name</code> テーブルの <code class="literal">LOW_NUMBER_OF_BYTES_USED</code> カラムおよび <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code> カラムで報告されているように、実行中に 1MB から 2MB の範囲のメモリーを使用します。
          </p><p>
            スレッド 2 は、同様に、実行中に 10MB から 12MB の範囲のメモリーを使用します。
          </p><p>
            これらの 2 つのスレッドが同じユーザーアカウントに属している場合、アカウントごとのサマリーでは、このアカウントが 11MB から 14MB の範囲でメモリーを使用したと推定されます。 つまり、上位レベルの集計の <code class="literal">LOW_NUMBER_OF_BYTES_USED</code> は、各 <code class="literal">LOW_NUMBER_OF_BYTES_USED</code> の合計です (最悪の場合)。 同様に、上位レベルの集計の <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code> は、各 <code class="literal">HIGH_NUMBER_OF_BYTES_USED</code> の合計です (最悪の場合)。 
          </p><p>
            11MB は、両方のスレッドが同時に低い使用マークに達した場合にのみ発生する可能性のある低い見積りです。
          </p><p>
            14MB は、両方のスレッドが同時に高使用量マークに達した場合にのみ発生する可能性のある高い見積りです。
          </p><p>
            このアカウントの実際のメモリー使用量は、11.5 MB から 13.5 MB の範囲内である可能性があります。
          </p><p>
            キャパシティプランニングでは、セッションが相関していない場合に発生する可能性がある可能性があることが示されているため (通常は、最悪のケースのレポートが望ましい動作です)。
          </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-error-summary-tables"></a>27.12.18.11 エラー要約テーブル</h4></div></div></div><a class="indexterm" name="idm45882606151984"></a><a class="indexterm" name="idm45882606149712"></a><a class="indexterm" name="idm45882606147664"></a><a class="indexterm" name="idm45882606145408"></a><a class="indexterm" name="idm45882606143376"></a><a class="indexterm" name="idm45882606141104"></a><a class="indexterm" name="idm45882606139056"></a><a class="indexterm" name="idm45882606136800"></a><a class="indexterm" name="idm45882606134768"></a><a class="indexterm" name="idm45882606132512"></a><p>
          パフォーマンススキーマは、サーバーエラー (および警告) に関する統計情報を集約するためのサマリーテーブルを保持します。 サーバーエラーのリストは、<a class="ulink" href="https://dev.mysql.com/doc/mysql-errors/8.0/en/server-error-reference.html" target="_top">Server Error Message Reference</a> を参照してください。 
        </p><p>
          エラー情報の収集は、デフォルトで有効になっている <code class="literal">error</code> インストゥルメントによって制御されます。 タイミング情報は収集されません。 
        </p><p>
          各エラーサマリーテーブルには、エラーを識別する 3 つのカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ERROR_NUMBER</code> は数値のエラー値です。 値は一意です。 
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR_NAME</code> は、<code class="literal">ERROR_NUMBER</code> 値に対応するシンボリックエラー名です。 値は一意です。 
            </p></li><li class="listitem"><p>
              <code class="literal">SQLSTATE</code> は、<code class="literal">ERROR_NUMBER</code> 値に対応する SQLSTATE 値です。 値は必ずしも一意ではありません。 
            </p></li></ul></div><p>
          たとえば、<code class="literal">ERROR_NUMBER</code> が 1050 の場合、<code class="literal">ERROR_NAME</code> は <code class="literal">ER_TABLE_EXISTS_ERROR</code> で、<code class="literal">SQLSTATE</code> は <code class="literal">42S01</code> です。
        </p><p>
          エラーイベントのサマリー情報の例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT *</code></strong>
       <strong class="userinput"><code>FROM performance_schema.events_errors_summary_global_by_error</code></strong>
       <strong class="userinput"><code>WHERE SUM_ERROR_RAISED &lt;&gt; 0\G</code></strong>
*************************** 1. row ***************************
     ERROR_NUMBER: 1064
       ERROR_NAME: ER_PARSE_ERROR
        SQL_STATE: 42000
 SUM_ERROR_RAISED: 1
SUM_ERROR_HANDLED: 0
       FIRST_SEEN: 2016-06-28 07:34:02
        LAST_SEEN: 2016-06-28 07:34:02
*************************** 2. row ***************************
     ERROR_NUMBER: 1146
       ERROR_NAME: ER_NO_SUCH_TABLE
        SQL_STATE: 42S02
 SUM_ERROR_RAISED: 2
SUM_ERROR_HANDLED: 0
       FIRST_SEEN: 2016-06-28 07:34:05
        LAST_SEEN: 2016-06-28 07:36:18
*************************** 3. row ***************************
     ERROR_NUMBER: 1317
       ERROR_NAME: ER_QUERY_INTERRUPTED
        SQL_STATE: 70100
 SUM_ERROR_RAISED: 1
SUM_ERROR_HANDLED: 0
       FIRST_SEEN: 2016-06-28 11:01:49
        LAST_SEEN: 2016-06-28 11:01:49
</pre><p>
          各エラーサマリーテーブルには、テーブルでのエラーの集計方法を示す 1 つ以上のグループ化カラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_account_by_error</code> には、<code class="literal">USER</code>、<code class="literal">HOST</code> および <code class="literal">ERROR_NUMBER</code> カラムがあります。 各行には、特定のアカウント (ユーザーとホストの組合せ) およびエラーのイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_host_by_error</code> には、<code class="literal">HOST</code> カラムおよび <code class="literal">ERROR_NUMBER</code> カラムがあります。 各行には、特定のホストおよびエラーのイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_thread_by_error</code> には、<code class="literal">THREAD_ID</code> カラムおよび <code class="literal">ERROR_NUMBER</code> カラムがあります。 各行には、特定のスレッドおよびエラーのイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_user_by_error</code> には、<code class="literal">USER</code> カラムおよび <code class="literal">ERROR_NUMBER</code> カラムがあります。 各行には、特定のユーザーおよびエラーのイベントが要約されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_global_by_error</code> には <code class="literal">ERROR_NUMBER</code> カラムがあります。 各行には、特定のエラーのイベントが要約されます。 
            </p></li></ul></div><p>
          各エラーサマリーテーブルには、集計値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SUM_ERROR_RAISED</code>
            </p><p>
              このカラムには、エラーが発生した回数が集計されます。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_ERROR_HANDLED</code>
            </p><p>
              このカラムは、SQL 例外ハンドラによってエラーが処理された回数を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_SEEN</code>, <code class="literal">LAST_SEEN</code>
            </p><p>
              エラーが最初に表示された時間と最後に表示された時間を示すタイムスタンプ。
            </p></li></ul></div><p>
          各エラーサマリーテーブルの <code class="literal">NULL</code> 行は、インストゥルメントされたエラーの範囲外にあるすべてのエラーの統計を集計するために使用されます。 たとえば、MySQL Server エラーが <em class="replaceable"><code>M</code></em> から <em class="replaceable"><code>N</code></em> の範囲内にあり、その範囲内にない番号 <em class="replaceable"><code>Q</code></em> でエラーが発生した場合、エラーは <code class="literal">NULL</code> 行に集計されます。 <code class="literal">NULL</code> の行は、<code class="literal">ERROR_NUMBER=0</code>、<code class="literal">ERROR_NAME=NULL</code> および <code class="literal">SQLSTATE=NULL</code> を含む行です。 
        </p><p>
          エラーサマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_account_by_error</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">ERROR_NUMBER</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_host_by_error</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">ERROR_NUMBER</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_thread_by_error</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">THREAD_ID</code>、<code class="literal">ERROR_NUMBER</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_by_user_by_error</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">ERROR_NUMBER</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">events_errors_summary_global_by_error</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">ERROR_NUMBER</code>)
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> はエラーサマリーテーブルに対して許可されています。 これには次の効果があります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              アカウント、ホストまたはユーザーごとに集計されないサマリーテーブルの場合、切捨てによって、行が削除されるのではなく、サマリーカラムがゼロまたは <code class="literal">NULL</code> にリセットされます。
            </p></li><li class="listitem"><p>
              アカウント、ホストまたはユーザー別に集計されたサマリーテーブルの場合、切捨てによって、接続のないアカウント、ホストまたはユーザーの行が削除され、残りの行のサマリーカラムがゼロまたは <code class="literal">NULL</code> にリセットされます。
            </p></li></ul></div><p>
          また、アカウント、ホスト、ユーザーまたはスレッド別に集計された各エラーサマリーテーブルは、依存する接続テーブルの切捨てまたは <code class="literal">events_errors_summary_global_by_error</code> の切捨てによって暗黙的に切り捨てられます。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="27.12.8 パフォーマンススキーマ接続テーブル">セクション27.12.8「パフォーマンススキーマ接続テーブル」</a>を参照してください。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-status-variable-summary-tables"></a>27.12.18.12 ステータス変数サマリーテーブル</h4></div></div></div><p>
          パフォーマンススキーマは、<a class="xref" href="performance-schema.html#performance-schema-status-variable-tables" title="27.12.15 パフォーマンススキーマのステータス変数のテーブル">セクション27.12.15「パフォーマンススキーマのステータス変数のテーブル」</a> で説明されているテーブルでステータス変数情報を使用できるようにします。 また、ここで説明するように、集計されたステータス変数情報をサマリーテーブルで使用できるようにします。 各ステータス変数サマリーテーブルには、テーブルでのステータス値の集計方法を示す 1 つ以上のグループ化カラムがあります: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">status_by_account</code> には、アカウント別にステータス変数を要約するための <code class="literal">USER</code>、<code class="literal">HOST</code> および <code class="literal">VARIABLE_NAME</code> のカラムがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">status_by_host</code> には、クライアントの接続元のホスト別にステータス変数を要約するための <code class="literal">HOST</code> および <code class="literal">VARIABLE_NAME</code> のカラムがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">status_by_user</code> には、クライアントユーザー名別にステータス変数を要約するための <code class="literal">USER</code> および <code class="literal">VARIABLE_NAME</code> のカラムがあります。
            </p></li></ul></div><p>
          各ステータス変数サマリーテーブルには、集計値を含む次のサマリーカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">VARIABLE_VALUE</code>
            </p><p>
              アクティブセッションおよび終了したセッションの集計ステータス変数値。
            </p></li></ul></div><p>
          ステータス変数サマリーテーブルには、次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">status_by_account</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>, <code class="literal">HOST</code>, <code class="literal">VARIABLE_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">status_by_host</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">HOST</code>、<code class="literal">VARIABLE_NAME</code>)
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">status_by_user</code>:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  主キー (<code class="literal">USER</code>、<code class="literal">VARIABLE_NAME</code>)
                </p></li></ul></div></li></ul></div><p>
          これらのテーブルの <span class="quote">「<span class="quote">account</span>」</span> の意味は、<code class="literal">mysql</code> システムデータベースの MySQL 付与テーブルでの意味と似ていますが、用語はユーザーとホストの値の組合せを意味します。 権限付与テーブルの場合、アカウントのホスト部分はパターンにできますが、「パフォーマンススキーマ」テーブルの場合、ホスト値は常に特定のパターン以外のホスト名になります。 
        </p><p>
          アカウントステータスは、セッションの終了時に収集されます。 セッションステータスカウンタは、グローバルステータスカウンタおよび対応するアカウントステータスカウンタに追加されます。 アカウント統計が収集されない場合、ホストおよびユーザーのステータスが収集されると、セッションステータスがホストおよびユーザーのステータスに追加されます。 
        </p><p>
          <code class="literal">performance_schema_accounts_size</code>、<code class="literal">performance_schema_hosts_size</code> および <code class="literal">performance_schema_users_size</code> システム変数がそれぞれ 0 に設定されている場合、アカウント、ホストおよびユーザーの統計は収集されません。
        </p><p>
          パフォーマンススキーマは、次のようなステータス変数サマリーテーブルの <code class="literal">TRUNCATE TABLE</code> をサポートしています。すべての場合、アクティブセッションのステータスは影響を受けません:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">status_by_account</code>: 終了したセッションからユーザーおよびホストのステータスにアカウントステータスを集計し、アカウントステータスをリセットします。
            </p></li><li class="listitem"><p>
              <code class="literal">status_by_host</code>: 終了したセッションから集計ホストのステータスをリセットします。
            </p></li><li class="listitem"><p>
              <code class="literal">status_by_user</code>: 終了したセッションから集計済ユーザーステータスをリセットします。
            </p></li></ul></div><p>
          <code class="literal">FLUSH STATUS</code> は、すべてのアクティブセッションのセッションステータスをグローバルステータス変数に追加し、すべてのアクティブセッションのステータスをリセットし、切断されたセッションから集計されたアカウント、ホストおよびユーザーステータス値をリセットします。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-miscellaneous-tables"></a>27.12.19 パフォーマンススキーマのその他のテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-error-log-table">27.12.19.1 error_log テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-firewall-groups-table">27.12.19.2 firewall_groups テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-firewall-group-allowlist-table">27.12.19.3 firewall_group_allowlist テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-firewall-membership-table">27.12.19.4 firewall_membership テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-host-cache-table">27.12.19.5 host_cache テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-keyring-keys-table">27.12.19.6 keyring_keys テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-log-status-table">27.12.19.7 log_status テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-performance-timers-table">27.12.19.8 performance_timers テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-processlist-table">27.12.19.9 processlist テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-threads-table">27.12.19.10 スレッドテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-tls-channel-status-table">27.12.19.11 tls_channel_status テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-user-defined-functions-table">27.12.19.12 user_defined_functions テーブル</a></span></dt></dl></div><p>
        次のセクションでは、先述のセクションで説明したテーブルカテゴリに収まらないテーブルについて説明します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">error_log</code>: エラーログに書き込まれた最新のイベント。
          </p></li><li class="listitem"><p>
            <code class="literal">host_cache</code>: 内部ホストキャッシュからの情報
          </p></li><li class="listitem"><p>
            <code class="literal">keyring_keys</code>: MySQL キーリングのキーのメタデータ。
          </p></li><li class="listitem"><p>
            <code class="literal">log_status</code>: バックアップのためのサーバーログに関する情報。
          </p></li><li class="listitem"><p>
            <code class="literal">performance_timers</code>: 使用可能なイベントタイマー
          </p></li><li class="listitem"><p>
            <code class="literal">threads</code>: サーバースレッドに関する情報
          </p></li><li class="listitem"><p>
            <code class="literal">tls_channel_status</code>: 接続インタフェースの TLS コンテキストプロパティ。
          </p></li><li class="listitem"><p>
            <code class="literal">user_defined_functions</code>: コンポーネント、プラグイン、または <code class="literal">CREATE FUNCTION</code> ステートメントによって登録されたユーザー定義関数。
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-error-log-table"></a>27.12.19.1 error_log テーブル</h4></div></div></div><a class="indexterm" name="idm45882605976912"></a><a class="indexterm" name="idm45882605974736"></a><p>
          MySQL サーバーが保持するログのうち、診断メッセージを書き込むエラーログです (<a class="xref" href="server-administration.html#error-log" title="5.4.2 エラーログ">セクション5.4.2「エラーログ」</a> を参照)。 通常、サーバーはサーバーホスト上のファイルまたはシステムログサービスに診断を書き込みます。 MySQL 8.0.22 の時点では、エラーログの構成に応じて、サーバーは最新のエラーイベントをパフォーマンススキーマの <code class="literal">error_log</code> テーブルに書き込むこともできます。 したがって、<code class="literal">error_log</code> テーブルに対する <code class="literal">SELECT</code> 権限を付与すると、クライアントおよびアプリケーションは SQL クエリーを使用してエラーログの内容にアクセスできるため、DBA はサーバーホストでのファイルシステムへの直接アクセスを許可せずにログにアクセスできます。 
        </p><p>
          <code class="literal">error_log</code> テーブルでは、より構造化されたカラムに基づいてフォーカスされたクエリーがサポートされます。 また、より自由形式の分析をサポートするエラーメッセージの全文も含まれています。 
        </p><p>
          テーブルの実装では、固定サイズのメモリー内リングバッファが使用され、必要に応じて古いイベントが自動的に破棄され、新しいイベント用の領域が確保されます。
        </p><p>
          <code class="literal">error_log</code> コンテンツの例:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.error_log\G</code></strong>
*************************** 1. row ***************************
    LOGGED: 2020-08-06 09:25:00.338624
 THREAD_ID: 0
      PRIO: System
ERROR_CODE: MY-010116
 SUBSYSTEM: Server
      DATA: mysqld (mysqld 8.0.23) starting as process 96344
*************************** 2. row ***************************
    LOGGED: 2020-08-06 09:25:00.363521
 THREAD_ID: 1
      PRIO: System
ERROR_CODE: MY-013576
 SUBSYSTEM: InnoDB
      DATA: InnoDB initialization has started.
...
*************************** 65. row ***************************
    LOGGED: 2020-08-06 09:25:02.936146
 THREAD_ID: 0
      PRIO: Warning
ERROR_CODE: MY-010068
 SUBSYSTEM: Server
      DATA: CA certificate /var/mysql/sslinfo/cacert.pem is self signed.
...
*************************** 89. row ***************************
    LOGGED: 2020-08-06 09:25:03.112801
 THREAD_ID: 0
      PRIO: System
ERROR_CODE: MY-013292
 SUBSYSTEM: Server
      DATA: Admin interface ready for connections, address: '127.0.0.1' port: 33062
</pre><p>
          <code class="literal">error_log</code> テーブルには次のカラムがあります。 説明に示されているように、<code class="literal">DATA</code> カラム以外のすべてのカラムは、<a class="xref" href="server-administration.html#error-log-event-fields" title="5.4.2.3 エラーイベントフィールド">セクション5.4.2.3「エラーイベントフィールド」</a> で説明されている基礎となるエラーイベント構造のフィールドに対応します。 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">LOGGED</code>
            </p><p>
              マイクロ秒精度のイベントタイムスタンプ。 <code class="literal">LOGGED</code> は、エラーイベントの <code class="literal">time</code> フィールドに対応していますが、次のような違いが考えられます: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  エラーログの <code class="literal">time</code> 値は、<code class="literal">log_timestamps</code> システム変数の設定に従って表示されます。<a class="xref" href="server-administration.html#error-log-format-output-format-for-early-logging" title="初期起動時のロギング出力形式">初期起動時のロギング出力形式</a> を参照してください。
                </p></li><li class="listitem"><p>
                  <code class="literal">LOGGED</code> カラムには、<code class="literal">TIMESTAMP</code> データ型を使用して値が格納されます。値は UTC で格納されますが、現在のセッションタイムゾーンで取得されると表示されます。<a class="xref" href="data-types.html#datetime" title="11.2.2 DATE、DATETIME、および TIMESTAMP 型">セクション11.2.2「DATE、DATETIME、および TIMESTAMP 型」</a> を参照してください。
                </p></li></ul></div><p>
              エラーログファイルに表示されているのと同じタイムゾーンで <code class="literal">LOGGED</code> 値を表示するには、最初にセッションタイムゾーンを次のように設定します:
            </p><pre class="programlisting">SET @@session.time_zone = @@global.log_timestamps;
</pre><p>
              <code class="literal">log_timestamps</code> 値が <code class="literal">UTC</code> で、システムに名前付きタイムゾーンサポートがインストールされていない場合 (<a class="xref" href="server-administration.html#time-zone-support" title="5.1.15 MySQL Server でのタイムゾーンのサポート">セクション5.1.15「MySQL Server でのタイムゾーンのサポート」</a> を参照)、タイムゾーンを次のように設定します:
            </p><pre class="programlisting">SET @@session.time_zone = '+00:00';
</pre></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              MySQL スレッド ID。 <code class="literal">THREAD_ID</code> は、エラーイベントの <code class="literal">thread</code> フィールドに対応します。 
            </p><p>
              パフォーマンススキーマ内では、<code class="literal">error_log</code> テーブルの <code class="literal">THREAD_ID</code> カラムは <code class="literal">threads</code> テーブルの <code class="literal">PROCESSLIST_ID</code> カラムにもっとも似ています:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  フォアグラウンドスレッドの場合、<code class="literal">THREAD_ID</code> および <code class="literal">PROCESSLIST_ID</code> は接続識別子を表します。 これは、<code class="literal">INFORMATION_SCHEMA</code> <code class="literal">PROCESSLIST</code> テーブルの <code class="literal">ID</code> カラムに表示される値と同じで、<code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラムに表示され、スレッド内の <code class="literal">CONNECTION_ID()</code> 関数によって返されます。 
                </p></li><li class="listitem"><p>
                  バックグラウンドスレッドの場合、<code class="literal">THREAD_ID</code> は 0、<code class="literal">PROCESSLIST_ID</code> は <code class="literal">NULL</code> です。
                </p></li></ul></div><p>
              <code class="literal">error_log</code> 以外の「多数のパフォーマンススキーマ」テーブルには <code class="literal">THREAD_ID</code> という名前のカラムがありますが、これらのテーブルでは、<code class="literal">THREAD_ID</code> カラムはパフォーマンススキーマによって内部的に割り当てられた値です。
            </p></li><li class="listitem"><p>
              <code class="literal">PRIO</code>
            </p><p>
              イベントの優先度。 許可される値は <code class="literal">System</code>, <code class="literal">Error</code>, <code class="literal">Warning</code>, <code class="literal">Note</code> です。 <code class="literal">PRIO</code> カラムは、エラーイベントの <code class="literal">label</code> フィールドに基づいており、それ自体は基礎となる数値 <code class="literal">prio</code> フィールド値に基づいています。 
            </p></li><li class="listitem"><p>
              <code class="literal">ERROR_CODE</code>
            </p><p>
              数値のイベントエラーコード。 <code class="literal">ERROR_CODE</code> は、エラーイベントの <code class="literal">error_code</code> フィールドに対応します。 
            </p></li><li class="listitem"><p>
              <code class="literal">SUBSYSTEM</code>
            </p><p>
              イベントが発生したサブシステム。 <code class="literal">SUBSYSTEM</code> は、エラーイベントの <code class="literal">subsystem</code> フィールドに対応します。 
            </p></li><li class="listitem"><p>
              <code class="literal">DATA</code>
            </p><p>
              エラーイベントのテキスト表現。 この値の形式は、<code class="literal">error_log</code> 行を生成するログシンクコンポーネントによって生成される形式によって異なります。 たとえば、ログシンクが <code class="literal">log_sink_internal</code> または <code class="literal">log_sink_json</code> の場合、<code class="literal">DATA</code> の値はそれぞれ従来の形式または JSON 形式のエラーイベントを表します。 (<a class="xref" href="server-administration.html#error-log-format" title="5.4.2.9 エラーログ出力形式">セクション5.4.2.9「エラーログ出力形式」</a>を参照してください。) 
            </p><p>
              エラーログを再構成して、<code class="literal">error_log</code> テーブルに行を提供するログシンクコンポーネントを変更できます。また、異なるシンクによって異なる出力形式が生成されるため、異なるタイミングで <code class="literal">error_log</code> テーブルに書き込まれる行に異なる <code class="literal">DATA</code> 形式を設定できます。
            </p></li></ul></div><p>
          <code class="literal">error_log</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">LOGGED</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">PRIO</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">ERROR_CODE</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">SUBSYSTEM</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">error_log</code> テーブルに対して許可されていません。
        </p><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-error-log-table-implementation"></a>error_log テーブルの実装および構成</h5></div></div></div><p>
            パフォーマンススキーマ <code class="literal">error_log</code> テーブルは、エラーログにフォーマットされたエラーイベントを書き込むだけでなく、テーブルに書き込むエラーログシンクコンポーネントによって移入されます。 ログシンクによるパフォーマンススキーマのサポートには、次の 2 つの部分があります: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                ログシンクは、発生時に新しいエラーイベントを <code class="literal">error_log</code> テーブルに書き込むことができます。
              </p></li><li class="listitem"><p>
                ログシンクは、以前に書き込まれたエラーメッセージを抽出するためのパーサーを提供できます。 これにより、サーバーインスタンスは前のインスタンスによってエラーログファイルに書き込まれたメッセージを読み取って、<code class="literal">error_log</code> テーブルに格納できます。 前のインスタンスによって停止中に書き込まれたメッセージは、停止が発生した理由の診断に役立つ場合があります。 
              </p></li></ul></div><p>
            現在、従来の形式の <code class="literal">log_sink_internal</code> および JSON 形式の <code class="literal">log_sink_json</code> シンクは、<code class="literal">error_log</code> テーブルへの新しいイベントの書込みをサポートし、以前に書き込まれたエラーログファイルを読み取るパーサーを提供しています。
          </p><p>
            <code class="literal">log_error_services</code> システム変数は、エラーロギングを有効にするログコンポーネントを制御します。 この値は、エラーイベントが発生したときに左から右の順に実行されるログフィルタおよびログシンクコンポーネントのパイプラインです。 <code class="literal">log_error_services</code> の値は、次のように <code class="literal">error_log</code> テーブルへの移入に関連します: 
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                起動時に、サーバーは <code class="literal">log_error_services</code> 値を調べ、次の条件を満たす左端のログシンクから選択します:
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                    <code class="literal">error_log</code> テーブルをサポートし、パーサーを提供するシンク。
                  </p></li><li class="listitem"><p>
                    存在しない場合、<code class="literal">error_log</code> テーブルをサポートするがパーサーを提供しないシンク。
                  </p></li></ul></div><p>
                これらの条件を満たすログシンクがない場合、<code class="literal">error_log</code> テーブルは空のままです。 それ以外の場合、シンクがパーサーを提供し、以前に書き込まれたエラーログファイルを検出できるようにすると、サーバーはシンクパーサーを使用してファイルの最後の部分を読み取り、そこに含まれる古いイベントをテーブルに書き込みます。 その後、シンクは新しいエラーイベントを発生時にテーブルに書き込みます。 
              </p></li><li class="listitem"><p>
                実行時に、<code class="literal">log_error_services</code> の値が変更されると、サーバーは再度その値を調べ、今度は <code class="literal">error_log</code> テーブルをサポートする左端に有効なログシンクを探して、パーサーを提供するかどうかを確認します。
              </p><p>
                そのようなログシンクが存在しない場合、追加のエラーイベントは <code class="literal">error_log</code> テーブルに書き込まれません。 それ以外の場合、新しく構成されたシンクは、新しいエラーイベントを発生時にテーブルに書き込みます。 
              </p></li></ul></div><p>
            エラーログに書き込まれる出力に影響する構成は、<code class="literal">error_log</code> テーブルの内容に影響します。 これには、冗長性、メッセージ抑制、メッセージフィルタリングなどの設定が含まれます。 また、起動時に以前のログファイルから読み取られた情報にも適用されます。 たとえば、冗長性が低い状態で構成された以前のサーバーインスタンス中に書き込まれなかったメッセージは、冗長性が高い状態で構成された現在のインスタンスによってファイルが読み取られた場合は使用できなくなります。 
          </p><p>
            <code class="literal">error_log</code> テーブルは固定サイズのメモリー内リングバッファのビューで、新しいイベント用の領域を確保するために、必要に応じて古いイベントが自動的に破棄されます。 次のテーブルに示すように、いくつかのステータス変数は、進行中の <code class="literal">error_log</code> 操作に関する情報を提供します。 
          </p><div class="informaltable"><table summary="error_log table status variables."><col width="35%"><col width="35%"><thead><tr>
                <th>ステータス変数</th>
                <th>意味</th>
              </tr></thead><tbody><tr>
                <td><code class="literal">Error_log_buffered_bytes</code></td>
                <td>テーブルで使用されるバイト数</td>
              </tr><tr>
                <td><code class="literal">Error_log_buffered_events</code></td>
                <td>テーブルに存在するイベント</td>
              </tr><tr>
                <td><code class="literal">Error_log_expired_events</code></td>
                <td>テーブルから破棄されたイベント</td>
              </tr><tr>
                <td><code class="literal">Error_log_latest_write</code></td>
                <td>テーブルへの最終書込み時間</td>
              </tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-firewall-groups-table"></a>27.12.19.2 firewall_groups テーブル</h4></div></div></div><a class="indexterm" name="idm45882605827232"></a><a class="indexterm" name="idm45882605825024"></a><p>
          <code class="literal">firewall_groups</code> テーブルは、MySQL Enterprise Firewall のインメモリーデータキャッシュのビューを提供します。 登録されているファイアウォールグループプロファイルの名前と動作モードを一覧表示します。 ファイアウォールデータの永続的な記憶域を提供する <code class="literal">mysql.firewall_groups</code> システムテーブルとともに使用されます。<a class="xref" href="security.html#firewall-tables" title="MySQL Enterprise Firewall テーブル">MySQL Enterprise Firewall テーブル</a> を参照してください。 
        </p><p>
          <code class="literal">firewall_groups</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              グループプロファイル名。
            </p></li><li class="listitem"><p>
              <code class="literal">MODE</code>
            </p><p>
              プロファイルの現在の操作モード。 許可されるモード値は、<code class="literal">OFF</code>, <code class="literal">DETECTING</code>, <code class="literal">PROTECTING</code> および <code class="literal">RECORDING</code> です。 意味の詳細は、<a class="xref" href="security.html#firewall-concepts" title="ファイアウォール操作の概念">ファイアウォール操作の概念</a> を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">USERHOST</code>
            </p><p>
              プロファイルが <code class="literal">RECORDING</code> モードの場合に使用される、グループプロファイルのトレーニングアカウント。 値は、<code class="literal">NULL</code> または <code class="literal"><em class="replaceable"><code>user_name</code></em>@<em class="replaceable"><code>host_name</code></em></code> 形式の <code class="literal">NULL</code> 以外のアカウントです: 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  値が <code class="literal">NULL</code> の場合、ファイアウォールはグループのメンバーであるアカウントから受信したステートメントの許可リストルールを記録します。
                </p></li><li class="listitem"><p>
                  値が <code class="literal">NULL</code> 以外の場合、ファイアウォールは、指定されたアカウント (グループのメンバーである必要があります) から受信したステートメントの許可リストルールのみを記録します。
                </p></li></ul></div></li></ul></div><p>
          <code class="literal">firewall_groups</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">firewall_groups</code> テーブルに対して許可されていません。
        </p><p>
          <code class="literal">firewall_groups</code> テーブルが MySQL 8.0.23 に追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-firewall-group-allowlist-table"></a>27.12.19.3 firewall_group_allowlist テーブル</h4></div></div></div><a class="indexterm" name="idm45882605790624"></a><a class="indexterm" name="idm45882605788400"></a><p>
          <code class="literal">firewall_group_allowlist</code> テーブルは、MySQL Enterprise Firewall のインメモリーデータキャッシュのビューを提供します。 登録されているファイアウォールグループプロファイルの許可リストルールを一覧表示します。 ファイアウォールデータの永続的な記憶域を提供する <code class="literal">mysql.firewall_group_allowlist</code> システムテーブルとともに使用されます。<a class="xref" href="security.html#firewall-tables" title="MySQL Enterprise Firewall テーブル">MySQL Enterprise Firewall テーブル</a> を参照してください。 
        </p><p>
          <code class="literal">firewall_group_allowlist</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              グループプロファイル名。
            </p></li><li class="listitem"><p>
              <code class="literal">RULE</code>
            </p><p>
              プロファイルの許容可能なステートメントパターンを示す正規化されたステートメント。 プロファイル許可リストは、そのルールの和集合です。 
            </p></li></ul></div><p>
          <code class="literal">firewall_group_allowlist</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">firewall_group_allowlist</code> テーブルに対して許可されていません。
        </p><p>
          <code class="literal">firewall_group_allowlist</code> テーブルが MySQL 8.0.23 に追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-firewall-membership-table"></a>27.12.19.4 firewall_membership テーブル</h4></div></div></div><a class="indexterm" name="idm45882605768016"></a><a class="indexterm" name="idm45882605765808"></a><p>
          <code class="literal">firewall_membership</code> テーブルは、MySQL Enterprise Firewall のインメモリーデータキャッシュのビューを提供します。 登録済のファイアウォールグループプロファイルのメンバー (アカウント) がリストされます。 ファイアウォールデータの永続的な記憶域を提供する <code class="literal">mysql.firewall_membership</code> システムテーブルとともに使用されます。<a class="xref" href="security.html#firewall-tables" title="MySQL Enterprise Firewall テーブル">MySQL Enterprise Firewall テーブル</a> を参照してください。 
        </p><p>
          <code class="literal">firewall_membership</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">GROUP_ID</code>
            </p><p>
              グループプロファイル名。
            </p></li><li class="listitem"><p>
              <code class="literal">MEMBER_ID</code>
            </p><p>
              プロファイルのメンバーであるアカウントの名前。
            </p></li></ul></div><p>
          <code class="literal">firewall_membership</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">firewall_membership</code> テーブルに対して許可されていません。
        </p><p>
          <code class="literal">firewall_membership</code> テーブルが MySQL 8.0.23 に追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-host-cache-table"></a>27.12.19.5 host_cache テーブル</h4></div></div></div><a class="indexterm" name="idm45882605746560"></a><a class="indexterm" name="idm45882605744384"></a><p>
          MySQL サーバーは、クライアントホスト名および IP アドレス情報を含むインメモリーホストキャッシュを保持し、ドメインネームシステム (DNS) のルックアップを回避するために使用されます。 <code class="literal">host_cache</code> テーブルには、このキャッシュの内容が公開されます。 <code class="literal">host_cache_size</code> システム変数は、ホストキャッシュのサイズと <code class="literal">host_cache</code> テーブルのサイズを制御します。 ホストキャッシュの操作および構成については、<a class="xref" href="server-administration.html#host-cache" title="5.1.12.3 DNS ルックアップとホストキャッシュ">セクション5.1.12.3「DNS ルックアップとホストキャッシュ」</a> を参照してください。 
        </p><p>
          <code class="literal">host_cache</code> テーブルではホストキャッシュの内容が公開されるため、<code class="literal">SELECT</code> ステートメントを使用して調べることができます。 これは、接続の問題の原因の診断に役立つことがあります。 
        </p><p>
          <code class="literal">host_cache</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              文字列で表された、サーバーに接続しているクライアントの IP アドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              そのクライアント IP の解決済みの DNS ホスト名、または名前が不明な場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">HOST_VALIDATED</code>
            </p><p>
              クライアント IP に対し、IP からホスト名、ホスト名から IP の DNS 解決が正常に実行されたかどうか。 <code class="literal">HOST_VALIDATED</code> が <code class="literal">YES</code> の場合、DNS への追加コールを回避できるように、IP に対応するホスト名として <code class="literal">HOST</code> カラムが使用されます。 <code class="literal">HOST_VALIDATED</code> が <code class="literal">NO</code> である間、DNS 解決は、最終的に有効な結果または永続エラーのいずれかで完了するまで、接続試行ごとに試行されます。 この情報により、サーバーは一時的な DNS 障害中に不正または欠落したホスト名のキャッシュを回避でき、クライアントに永久的な影響を及ぼす可能性があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_CONNECT_ERRORS</code>
            </p><p>
              <span class="quote">「<span class="quote">ブロック</span>」</span>とみなされる接続エラーの数 (<code class="literal">max_connect_errors</code> システム変数に対して評価される)。 プロトコルハンドシェイクエラーのみがカウントされ、検証 (<code class="literal">HOST_VALIDATED = YES</code>) に合格したホストに対してのみカウントされます。 
            </p><p>
              特定のホストの <code class="literal">SUM_CONNECT_ERRORS</code> が <code class="literal">max_connect_errors</code> の値に達すると、そのホストからの新しい接続はブロックされます。 ホストがブロックされていない間にホストからの複数の接続が同時に試行される可能性があるため、<code class="literal">SUM_CONNECT_ERRORS</code> 値は <code class="literal">max_connect_errors</code> 値を超えることがあります。 これらのいずれかまたはすべてに障害が発生し、<code class="literal">SUM_CONNECT_ERRORS</code> が <code class="literal">max_connect_errors</code> の値を超える可能性があります。 
            </p><p>
              <code class="literal">max_connect_errors</code> が 200 で、特定のホストの <code class="literal">SUM_CONNECT_ERRORS</code> が 199 であるとします。 10 クライアントがそのホストから同時に接続しようとした場合、<code class="literal">SUM_CONNECT_ERRORS</code> が 200 に達していないため、これらはブロックされません。 5 つのクライアントでブロッキングエラーが発生した場合、<code class="literal">SUM_CONNECT_ERRORS</code> の値は 204 になり、クライアントごとに増加します。 接続試行が開始されたときの <code class="literal">SUM_CONNECT_ERRORS</code> の値が 200 に達していないため、他の 5 つのクライアントは成功し、ブロックされません。 <code class="literal">SUM_CONNECT_ERRORS</code> が 200 に達した後に開始するホストからの新しい接続はブロックされます。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_BLOCKED_ERRORS</code>
            </p><p>
              <code class="literal">SUM_CONNECT_ERRORS</code> が <code class="literal">max_connect_errors</code> システム変数の値を超えたため、ブロックされた接続の数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_TRANSIENT_ERRORS</code>
            </p><p>
              IP からホスト名への DNS 解決時の一時的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_PERMANENT_ERRORS</code>
            </p><p>
              IP からホスト名への DNS 解決時の永続的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FORMAT_ERRORS</code>
            </p><p>
              ホスト名形式エラーの数。 MySQL では、<code class="literal">1.2.example.com</code> など、名前の最初のコンポーネントが完全に数値であるホスト名に対して、<code class="literal">mysql.user</code> システムテーブルの <code class="literal">Host</code> カラム値の照合は実行されません。 代わりにクライアント IP アドレスが使用されます。 この種類の照合が行われない理由については、<a class="xref" href="security.html#account-names" title="6.2.4 アカウント名の指定">セクション6.2.4「アカウント名の指定」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_TRANSIENT_ERRORS</code>
            </p><p>
              ホスト名から IP への逆引き DNS 解決時の一時的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_PERMANENT_ERRORS</code>
            </p><p>
              ホスト名から IP への逆引き DNS 解決時の永続的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FCRDNS_ERRORS</code>
            </p><p>
              Forward-confirmed reverse DNS エラーの数。 これらのエラーは、IP からホスト名、ホスト名から IP の DNS 解決で、クライアントの発信元の IP アドレスに一致しない IP アドレスが生成された場合に発生します。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_ACL_ERRORS</code>
            </p><p>
              クライアントホストからの接続がユーザーに許可されていないために発生したエラーの数。 そのような場合、サーバーは <code class="literal">ER_HOST_NOT_PRIVILEGED</code> を返し、ユーザー名やパスワードも要求しません。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NO_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              使用できない認証プラグインのリクエストによるエラーの数。 プラグインが使用できない可能性があるのは、たとえば、それがロードされていないか、ロードの試みに失敗した場合です。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              認証プラグインによって報告されるエラーの数。
            </p><p>
              認証プラグインは、障害の原因を示すために、さまざまなエラーコードを報告することがあります。 エラーの種類に応じて、これらのいずれかのカラムが増分されます。<code class="literal">COUNT_AUTHENTICATION_ERRORS</code>、<code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>、<code class="literal">COUNT_HANDSHAKE_ERRORS</code>。 新しいリターンコードは、既存のプラグイン API へのオプションの拡張です。 不明または予期しないプラグインエラーは <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code> カラムにカウントされます。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HANDSHAKE_ERRORS</code>
            </p><p>
              有線プロトコルレベルで検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ERRORS</code>
            </p><p>
              プロキシユーザー A が存在しない別のユーザー B にプロキシ設定されているときに検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ACL_ERRORS</code>
            </p><p>
              プロキシユーザー A が、存在するが A が <code class="literal">PROXY</code> 権限を持たない別のユーザー B にプロキシされたときに検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTHENTICATION_ERRORS</code>
            </p><p>
              失敗した認証によって発生したエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_SSL_ERRORS</code>
            </p><p>
              SSL の問題によるエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_ERRORS</code>
            </p><p>
              ユーザーごとの接続割り当てを超えることによって発生したエラーの数。 <a class="xref" href="security.html#user-resources" title="6.2.20 アカウントリソース制限の設定">セクション6.2.20「アカウントリソース制限の設定」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS</code>
            </p><p>
              時間あたりのユーザーごとの接続割り当てを超えることによって発生したエラーの数。 <a class="xref" href="security.html#user-resources" title="6.2.20 アカウントリソース制限の設定">セクション6.2.20「アカウントリソース制限の設定」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_DEFAULT_DATABASE_ERRORS</code>
            </p><p>
              デフォルトのデータベースに関連するエラーの数。 たとえば、データベースが存在しないか、ユーザーにデータベースへのアクセス権限がありません。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_INIT_CONNECT_ERRORS</code>
            </p><p>
              <code class="literal">init_connect</code> システム変数値内のステートメントの実行の失敗によって発生したエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_LOCAL_ERRORS</code>
            </p><p>
              サーバー実装にローカルで、ネットワーク、認証、または承認に関連しないエラーの数。 たとえば、メモリー不足状況はこのカテゴリに収まります。 
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_UNKNOWN_ERRORS</code>
            </p><p>
              このテーブルのほかのカラムによって報告されない、ほかの不明なエラーの数。 新しいエラー条件を報告する必要があり、<code class="literal">host_cache</code> テーブルの下位互換性および構造を保持する必要がある場合に備えて、このカラムは将来の使用のために予約されています。 
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最初の接続の試みのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラムのクライアントから見た最新の接続試行のタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_ERROR_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最初のエラーのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラムでクライアントから検出された最新のエラーのタイムスタンプ。
            </p></li></ul></div><p>
          <code class="literal">host_cache</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">IP</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">HOST</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は <code class="literal">host_cache</code> テーブルに対して許可されています。 テーブルに対する <code class="literal">DROP</code> 権限が必要です。 テーブルを切り捨てると、ホストキャッシュがフラッシュされます。これは、<a class="xref" href="server-administration.html#host-cache-flushing" title="ホストキャッシュのフラッシュ">ホストキャッシュのフラッシュ</a> で説明されている効果があります。 
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-keyring-keys-table"></a>27.12.19.6 keyring_keys テーブル</h4></div></div></div><a class="indexterm" name="idm45882605622240"></a><a class="indexterm" name="idm45882605620128"></a><p>
          MySQL Server は、内部サーバーコンポーネントおよびプラグインが機密情報を安全に格納して後で取得できるようにするキーリングをサポートしています。 <a class="xref" href="security.html#keyring" title="6.4.4 MySQL キーリング">セクション6.4.4「MySQL キーリング」</a>を参照してください。 
        </p><p>
          MySQL 8.0.16 では、<code class="literal">keyring_keys</code> テーブルはキーリング内のキーのメタデータを公開します。 キーメタデータには、キー ID、キー所有者およびバックエンドキー ID が含まれます。 <code class="literal">keyring_keys</code> テーブルでは、キーの内容などの機密キーリングデータは公開されません。 
        </p><p>
          <code class="literal">keyring_keys</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">KEY_ID</code>
            </p><p>
              キー識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">KEY_OWNER</code>
            </p><p>
              キーの所有者。
            </p></li><li class="listitem"><p>
              <code class="literal">BACKEND_KEY_ID</code>
            </p><p>
              キーリングバックエンドによってキーに使用される ID。
            </p></li></ul></div><p>
          <code class="literal">keyring_keys</code> テーブルにインデックスがありません。
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">keyring_keys</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-log-status-table"></a>27.12.19.7 log_status テーブル</h4></div></div></div><a class="indexterm" name="idm45882605600608"></a><a class="indexterm" name="idm45882605598432"></a><p>
          <code class="literal">log_status</code> テーブルには、オンラインバックアップツールが、コピープロセス中に必要なログファイルをロックせずにコピーできるようにする情報が示されます。
        </p><p>
          <code class="literal">log_status</code> テーブルをクエリーすると、サーバーはロギングおよび関連する管理上の変更を、テーブルに移入するのに十分な時間ブロックしてから、リソースを解放します。 <code class="literal">log_status</code> テーブルは、ソースバイナリログと <code class="literal">gtid_executed</code> レコード内のコピー先のオンラインバックアップ、および各レプリケーションチャネルのリレーログを通知します。 また、個々のストレージエンジンに関連する情報 (最後のログシーケンス番号 (LSN) や、<code class="literal">InnoDB</code> ストレージエンジンで最後に取得されたチェックポイントの LSN など) も提供します。 
        </p><p>
          <code class="literal">log_status</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SERVER_UUID</code>
            </p><p>
              このサーバーインスタンスのサーバー UUID。 これは、読取り専用システム変数 <code class="literal">server_uuid</code> の生成された一意の値です。 
            </p></li><li class="listitem"><p>
              <code class="literal">LOCAL</code>
            </p><p>
              次のキーを持つ単一の JSON オブジェクトとして提供される、ソースからのログ位置状態情報:

              </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <code class="literal">binary_log_file</code> </span></dt><dd><p>
                      現在のバイナリログファイルの名前。
                    </p></dd><dt><span class="term"> <code class="literal">binary_log_position</code> </span></dt><dd><p>
                      <code class="literal">log_status</code> テーブルへのアクセス時の現在のバイナリログの位置。
                    </p></dd><dt><span class="term"> <code class="literal">gtid_executed</code> </span></dt><dd><p>
                      <code class="literal">log_status</code> テーブルへのアクセス時のグローバルサーバー変数 <code class="literal">gtid_executed</code> の現在の値。 この情報は、<code class="literal">binary_log_file</code> および <code class="literal">binary_log_position</code> のキーと一致します。 
                    </p></dd></dl></div><p>
            </p></li><li class="listitem"><p>
              <code class="literal">REPLICATION</code>
            </p><p>
              チャネルの JSON 配列。それぞれに次の情報が含まれます:

              </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <code class="literal">channel_name</code> </span></dt><dd><p>
                      レプリケーションチャネルの名前。 デフォルトのレプリケーションチャネル名は空の文字列 (<span class="quote">「<span class="quote"></span>」</span>) です。 
                    </p></dd><dt><span class="term"> <code class="literal">relay_log_file</code> </span></dt><dd><p>
                      レプリケーションチャネルの現在のリレーログファイルの名前。
                    </p></dd><dt><span class="term"> <code class="literal">relay_log_pos</code> </span></dt><dd><p>
                      <code class="literal">log_status</code> テーブルへのアクセス時の現在のリレーログの位置。
                    </p></dd></dl></div><p>
            </p></li><li class="listitem"><p>
              <code class="literal">STORAGE_ENGINES </code>
            </p><p>
              個々のストレージエンジンからの関連情報。適用可能なストレージエンジンごとに 1 つの鍵を持つ JSON オブジェクトとして提供されます。
            </p></li></ul></div><p>
          <code class="literal">log_status</code> テーブルにインデックスがありません。
        </p><p>
          <code class="literal">log_status</code> テーブルにアクセスするには、<code class="literal">BACKUP_ADMIN</code> 権限および <code class="literal">SELECT</code> 権限が必要です。
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">log_status</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-performance-timers-table"></a>27.12.19.8 performance_timers テーブル</h4></div></div></div><a class="indexterm" name="idm45882605549760"></a><a class="indexterm" name="idm45882605547552"></a><p>
          <code class="literal">performance_timers</code> テーブルは使用可能なイベントタイマーを示します。
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |      1000000000 |                1 |            112 |
| MICROSECOND |         1000000 |                1 |            136 |
| MILLISECOND |            1036 |                1 |            168 |
+-------------+-----------------+------------------+----------------+
</pre><p>
          特定のタイマーに関連付けられた値が <code class="literal">NULL</code> の場合、そのタイマーはプラットフォームでサポートされていません。 イベントタイミングがどのように行われるかの説明については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="27.4.1 パフォーマンススキーマイベントタイミング">セクション27.4.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。 
        </p><p>
          <code class="literal">performance_timers</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code>
            </p><p>
              タイマー名。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_FREQUENCY</code>
            </p><p>
              秒あたりのタイマーユニットの数。 サイクルタイマーの場合、頻度は一般に CPU 速度に関連します。 たとえば、2.4GHz プロセッサを搭載するシステムでは、<code class="literal">CYCLE</code> は 2400000000 に近い可能性があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_RESOLUTION</code>
            </p><p>
              タイマー値が増加するタイマーユニット数を示します。 タイマーの分解能が 10 の場合、その値は毎回 10 ずつ増加します。 
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_OVERHEAD</code>
            </p><p>
              特定のタイマーで 1 つのタイミングを取得するためのオーバーヘッドの最小サイクル数。 パフォーマンススキーマは、初期化時にタイマーを 20 回呼び出し、最小値を選択することによって、この値を決定します。 インストゥルメンテーションは、各イベントの開始と終了でタイマーを呼び出すため、実際の合計のオーバーヘッドはこの量の 2 倍になります。 タイマーコードは、時間付きイベントにのみ呼び出されるため、このオーバーヘッドは時間なしイベントには適用されません。 
            </p></li></ul></div><p>
          <code class="literal">performance_timers</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">performance_timers</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-processlist-table"></a>27.12.19.9 processlist テーブル</h4></div></div></div><a class="indexterm" name="idm45882605520736"></a><a class="indexterm" name="idm45882605518592"></a><a class="indexterm" name="idm45882605516624"></a><p>
          MySQL プロセスリストには、サーバー内で実行されているスレッドのセットによって現在実行されている操作が示されます。 <code class="literal">processlist</code> テーブルは、プロセス情報のソースです。 このテーブルと他のソースの比較は、<a class="xref" href="optimization.html#processlist-sources" title="プロセス情報のソース">プロセス情報のソース</a> を参照してください。 
        </p><p>
          <code class="literal">processlist</code> テーブルは直接クエリーすることができます。 <code class="literal">PROCESS</code> 権限を持っている場合は、他のユーザーに属するスレッドも含めて、すべてのスレッドを表示できます。 それ以外の場合 (<code class="literal">PROCESS</code> 権限なし)、非匿名ユーザーは自分のスレッドに関する情報にはアクセスできますが、他のユーザーのスレッドにはアクセスできず、匿名ユーザーはスレッド情報にアクセスできません。 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">performance_schema_show_processlist</code> システム変数が有効になっている場合、<code class="literal">processlist</code> テーブルは <code class="literal">SHOW PROCESSLIST</code> ステートメントの基礎となる代替実装の基礎としても機能します。 詳細は、このセクションの後半のを参照してください。 
          </p></div><p>
          <code class="literal">processlist</code> テーブルには、各サーバープロセスの行が含まれます:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.processlist\G</code></strong>
*************************** 1. row ***************************
     ID: 5
   USER: event_scheduler
   HOST: localhost
     DB: NULL
COMMAND: Daemon
   TIME: 137
  STATE: Waiting on empty queue
   INFO: NULL
*************************** 2. row ***************************
     ID: 9
   USER: me
   HOST: localhost:58812
     DB: NULL
COMMAND: Sleep
   TIME: 95
  STATE:
   INFO: NULL
*************************** 3. row ***************************
     ID: 10
   USER: me
   HOST: localhost:58834
     DB: test
COMMAND: Query
   TIME: 0
  STATE: executing
   INFO: SELECT * FROM performance_schema.processlist
...
</pre><p>
          <code class="literal">processlist</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">ID</code>
            </p><p>
              接続識別子。 これは、<code class="literal">SHOW PROCESSLIST</code> ステートメントの <code class="literal">Id</code> カラムに表示される値と同じで、パフォーマンススキーマ <code class="literal">threads</code> テーブルの <code class="literal">PROCESSLIST_ID</code> カラムに表示され、スレッド内の <code class="literal">CONNECTION_ID()</code> 関数によって返されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              このステートメントを発行した MySQL ユーザー。 <code class="literal">system user</code> の値は、遅延行ハンドラスレッド、レプリカホストで使用される I/O または SQL スレッドなど、タスクを内部的に処理するためにサーバーによって起動される非クライアントスレッドを指します。 <code class="literal">system user</code> の場合、<code class="literal">Host</code> カラムにホストが指定されていません。<code class="literal">unauthenticated user</code> は、クライアント接続に関連付けられたが、クライアントユーザーの認証がまだ行われていないスレッドを参照します。<code class="literal">event_scheduler</code> は、スケジュールされたイベントをモニターするスレッドを指します (<a class="xref" href="stored-objects.html#event-scheduler" title="25.4 イベントスケジューラの使用">セクション25.4「イベントスケジューラの使用」</a> を参照)。 
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
                <code class="literal">system user</code> の <code class="literal">USER</code> 値は、<code class="literal">SYSTEM_USER</code> 権限とは異なります。 前者は内部スレッドを指定します。 後者は、システムユーザーと通常のユーザーアカウントカテゴリを区別します (<a class="xref" href="security.html#account-categories" title="6.2.11 アカウントカテゴリ">セクション6.2.11「アカウントカテゴリ」</a> を参照)。 
              </p></div></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              ステートメントを発行するクライアントのホスト名 (ホストがない <code class="literal">system user</code> を除く)。 TCP/IP 接続のホスト名は、<code class="literal"><em class="replaceable"><code>host_name</code></em>:<em class="replaceable"><code>client_port</code></em></code> 形式でレポートされるため、どのクライアントが何を実行しているかを簡単に判別できます。 
            </p></li><li class="listitem"><p>
              <code class="literal">DB</code>
            </p><p>
              スレッドのデフォルトデータベース。選択されていない場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">COMMAND</code>
            </p><p>
              スレッドがクライアントのかわりに実行しているコマンドのタイプ。セッションがアイドル状態の場合は <code class="literal">Sleep</code>。 スレッドコマンドの説明については、<a class="xref" href="optimization.html#thread-information" title="8.14 サーバースレッド (プロセス) 情報の確認">セクション8.14「サーバースレッド (プロセス) 情報の確認」</a>を参照してください。 このカラムの値は、クライアント/サーバープロトコルの <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code> コマンドと <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> ステータス変数に対応します。 <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 サーバーステータス変数">セクション5.1.10「サーバーステータス変数」</a>を参照してください 
            </p></li><li class="listitem"><p>
              <code class="literal">TIME</code>
            </p><p>
              スレッドが現在の状態になってからの秒数。 レプリカ SQL スレッドの場合、この値は、最後にレプリケートされたイベントのタイムスタンプとレプリカホストのリアルタイムの間の秒数です。 <a class="xref" href="replication.html#replication-implementation-details" title="17.2.3 レプリケーションスレッド">セクション17.2.3「レプリケーションスレッド」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              スレッドが行なっていることを示すアクション、イベント、または状態。 <code class="literal">STATE</code> の値の詳細は、<a class="xref" href="optimization.html#thread-information" title="8.14 サーバースレッド (プロセス) 情報の確認">セクション8.14「サーバースレッド (プロセス) 情報の確認」</a> を参照してください。 
            </p><p>
              ほとんどの状態がきわめてすばやい操作に対応します。 スレッドの状態が何秒間も特定の状態にとどまっている場合は、調査が必要な問題が発生している可能性があります。 
            </p></li><li class="listitem"><p>
              <code class="literal">INFO</code>
            </p><p>
              スレッドが実行しているステートメント。ステートメントを実行していない場合は <code class="literal">NULL</code>。 このステートメントは、サーバーに送信されるステートメント、またはこのステートメントがほかのステートメントを実行する場合は、もっとも内側のステートメントである可能性があります。 たとえば、<code class="literal">CALL</code> ステートメントが <code class="literal">SELECT</code> ステートメントを実行しているストアドプロシージャを実行する場合、<code class="literal">INFO</code> 値には <code class="literal">SELECT</code> ステートメントが表示されます。 
            </p></li></ul></div><p>
          <code class="literal">processlist</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">ID</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">processlist</code> テーブルに対して許可されていません。
        </p><p>
          前述のように、<code class="literal">performance_schema_show_processlist</code> システム変数が有効になっている場合、<code class="literal">processlist</code> テーブルは他のプロセス情報ソースの代替実装の基礎となります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SHOW PROCESSLIST</code> ステートメント。
            </p></li><li class="listitem"><p>
              <span class="command"><strong>mysqladmin processlist</strong></span> コマンド (<code class="literal">SHOW PROCESSLIST</code> ステートメントを使用)。
            </p></li></ul></div><p>
          デフォルトの <code class="literal">SHOW PROCESSLIST</code> 実装は、グローバル mutex を保持しながら、スレッドマネージャ内からアクティブスレッド間で繰り返されます。 これは、特にビジー状態のシステムではパフォーマンスに悪影響を及ぼします。 代替の <code class="literal">SHOW PROCESSLIST</code> 実装は、パフォーマンススキーマ <code class="literal">processlist</code> テーブルに基づいています。 この実装は、スレッドマネージャーではなくパフォーマンススキーマからアクティブなスレッドデータをクエリーするため、mutex は必要ありません。 
        </p><p>
          MySQL の構成は、次のように <code class="literal">processlist</code> テーブルの内容に影響します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              最小限必要な構成:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  MySQL サーバーは、スレッドインストゥルメンテーションを有効にして構成および構築する必要があります。 これはデフォルトで true で、<code class="option">DISABLE_PSI_THREAD</code> <span class="command"><strong>CMake</strong></span> オプションを使用して制御されます。 
                </p></li><li class="listitem"><p>
                  サーバーの起動時にパフォーマンススキーマを有効にする必要があります。 これはデフォルトで true で、<code class="literal">performance_schema</code> システム変数を使用して制御されます。 
                </p></li></ul></div><p>
              この構成が満たされると、<code class="literal">performance_schema_show_processlist</code> は代替の <code class="literal">SHOW PROCESSLIST</code> 実装を有効または無効にします。 最小構成が満たされていない場合、<code class="literal">processlist</code> テーブル (したがって <code class="literal">SHOW PROCESSLIST</code>) はすべてのデータを返すわけではありません。 
            </p></li><li class="listitem"><p>
              推奨構成:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  一部のスレッドを無視しないようにするには:
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">performance_schema_max_thread_instances</code> システム変数はデフォルトのままにするか、少なくとも <code class="literal">max_connections</code> システム変数と同じ大きさに設定します。
                    </p></li><li class="listitem"><p>
                      <code class="literal">performance_schema_max_thread_classes</code> システム変数はデフォルトのままにします。
                    </p></li></ul></div></li><li class="listitem"><p>
                  一部の <code class="literal">STATE</code> カラムの値が空にならないようにするには、<code class="literal">performance_schema_max_stage_classes</code> システム変数をデフォルトのままにします。
                </p></li></ul></div><p>
              これらの構成パラメータのデフォルトは <code class="literal">-1</code> で、パフォーマンススキーマはサーバーの起動時にそれらのサイズを自動設定します。 パラメータが指定どおりに設定されている場合、<code class="literal">processlist</code> テーブル (および <code class="literal">SHOW PROCESSLIST</code>) は完全なプロセス情報を生成します。 
            </p></li></ul></div><p>
          前述の構成パラメータは、<code class="literal">processlist</code> テーブルの内容に影響します。 ただし、特定の構成では、<code class="literal">processlist</code> の内容は <code class="literal">performance_schema_show_processlist</code> 設定の影響を受けません。 
        </p><p>
          代替プロセスリストの実装は、MySQL クライアント/サーバープロトコルの <code class="literal">INFORMATION_SCHEMA</code> <code class="literal">PROCESSLIST</code> テーブルまたは <code class="literal">COM_PROCESS_INFO</code> コマンドには適用されません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-threads-table"></a>27.12.19.10 スレッドテーブル</h4></div></div></div><a class="indexterm" name="idm45882605398720"></a><a class="indexterm" name="idm45882605396544"></a><a class="indexterm" name="idm45882605394592"></a><p>
          <code class="literal">threads</code> テーブルは各サーバースレッドの行を格納します。 各行にはスレッドに関する情報が含まれ、監視および履歴イベントロギングが有効かどうかが示されます: 
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.threads\G</code></strong>
*************************** 1. row ***************************
          THREAD_ID: 1
               NAME: thread/sql/main
               TYPE: BACKGROUND
     PROCESSLIST_ID: NULL
   PROCESSLIST_USER: NULL
   PROCESSLIST_HOST: NULL
     PROCESSLIST_DB: NULL
PROCESSLIST_COMMAND: NULL
   PROCESSLIST_TIME: 80284
  PROCESSLIST_STATE: NULL
   PROCESSLIST_INFO: NULL
   PARENT_THREAD_ID: NULL
               ROLE: NULL
       INSTRUMENTED: YES
            HISTORY: YES
    CONNECTION_TYPE: NULL
       THREAD_OS_ID: 489803
     RESOURCE_GROUP: SYS_default
...
*************************** 4. row ***************************
          THREAD_ID: 51
               NAME: thread/sql/one_connection
               TYPE: FOREGROUND
     PROCESSLIST_ID: 34
   PROCESSLIST_USER: isabella
   PROCESSLIST_HOST: localhost
     PROCESSLIST_DB: performance_schema
PROCESSLIST_COMMAND: Query
   PROCESSLIST_TIME: 0
  PROCESSLIST_STATE: Sending data
   PROCESSLIST_INFO: SELECT * FROM performance_schema.threads
   PARENT_THREAD_ID: 1
               ROLE: NULL
       INSTRUMENTED: YES
            HISTORY: YES
    CONNECTION_TYPE: SSL/TLS
       THREAD_OS_ID: 755399
     RESOURCE_GROUP: USR_default
...
</pre><p>
          パフォーマンススキーマが初期化されると、存在するスレッドに基づいて <code class="literal">threads</code> テーブルが生成されます。 その後、サーバーがスレッドを作成するたびに新しい行が追加されます。 
        </p><p>
          新しいスレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> カラムの値は、<code class="literal">setup_actors</code> テーブルの内容によって決まります。 <code class="literal">setup_actors</code> テーブルを使用してこれらのカラムを制御する方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-thread-filtering" title="27.4.6 スレッドによる事前フィルタリング">セクション27.4.6「スレッドによる事前フィルタリング」</a> を参照してください。 
        </p><a class="indexterm" name="idm45882605379936"></a><p>
          スレッドの終了時に、<code class="literal">threads</code> テーブルからの行の削除が行われます。 クライアントセッションに関連付けられたスレッドでは、セッションの終了時に削除が行われます。 クライアントで自動再接続が有効になっていて、切断後にセッションが再接続された場合、セッションは異なる <code class="literal">PROCESSLIST_ID</code> 値を持つ <code class="literal">threads</code> テーブルの新しい行に関連付けられます。 新しいスレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の初期値は、元のスレッドの値と異なる場合があります: 一方、<code class="literal">setup_actors</code> テーブルは変更された可能性があり、行の初期化後に元のスレッドの <code class="literal">INSTRUMENTED</code> または <code class="literal">HISTORY</code> の値が変更された場合、変更は新しいスレッドに引き継がれません。 
        </p><p>
          スレッドモニタリング (スレッドによって実行されるイベントがインストゥルメントされているかどうか) および履歴イベントロギングを有効または無効にできます。 新しいフォアグラウンドスレッドの <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> の初期値を制御するには、<code class="literal">setup_actors</code> テーブルを使用します。 既存のスレッドのこれらの側面を制御するには、<code class="literal">threads</code> テーブルの行の <code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> カラムを設定します。 (スレッドモニタリングおよび履歴イベントロギングが発生する条件の詳細は、<code class="literal">INSTRUMENTED</code> および <code class="literal">HISTORY</code> のカラムの説明を参照してください。) 
        </p><p>
          接頭辞が <code class="literal">PROCESSLIST_</code>の名前と他のプロセス情報ソースとの <code class="literal">threads</code> テーブルのカラムの比較は、<a class="xref" href="optimization.html#processlist-sources" title="プロセス情報のソース">プロセス情報のソース</a> を参照してください。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            <code class="literal">threads</code> テーブル以外のスレッド情報ソースの場合、他のユーザーのスレッドに関する情報は、現在のユーザーが <code class="literal">PROCESS</code> 権限を持っている場合にのみ表示されます。 これは <code class="literal">threads</code> テーブルには当てはまりません。テーブルの <code class="literal">SELECT</code> 権限を持つすべてのユーザーに、すべての行が表示されます。 <code class="literal">threads</code> テーブルにアクセスして他のユーザーのスレッドを表示できないようにするユーザーには、そのユーザーに対する <code class="literal">SELECT</code> 権限を付与しないでください。 
          </p></div><p>
          <code class="literal">threads</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              一意のスレッド識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              サーバーのスレッドインストゥルメンテーションコードに関連付けられている名前。 たとえば、<code class="literal">thread/sql/one_connection</code> はユーザー接続の処理を担当するコード内のスレッド関数に対応し、<code class="literal">thread/sql/main</code> はサーバーの <code class="literal">main()</code> 関数を表します。 
            </p></li><li class="listitem"><p>
              <code class="literal">TYPE</code>
            </p><p>
              <code class="literal">FOREGROUND</code> または <code class="literal">BACKGROUND</code> のスレッドの種類。 ユーザー接続スレッドはフォアグラウンドスレッドです。 内部サーバーアクティビティーに関連付けられているスレッドはバックグラウンドスレッドです。 たとえば、内部 <code class="literal">InnoDB</code> スレッド、レプリカに情報を送信する <span class="quote">「<span class="quote">binlog dump</span>」</span> スレッド、レプリケーション I/O スレッドおよび SQL スレッドなどです。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              フォアグラウンドスレッド (ユーザー接続に関連付けられている) の場合、これは接続識別子です。 これは、<code class="literal">INFORMATION_SCHEMA</code> <code class="literal">PROCESSLIST</code> テーブルの <code class="literal">ID</code> カラムに表示される値と同じで、<code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラムに表示され、スレッド内の <code class="literal">CONNECTION_ID()</code> 関数によって返されます。 
            </p><p>
              バックグラウンドスレッド (ユーザー接続に関連付けられていない) の場合、<code class="literal">PROCESSLIST_ID</code> は <code class="literal">NULL</code> であるため、値は一意ではありません。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_USER</code>
            </p><p>
              フォアグラウンドスレッドに関連付けられているユーザー、バックグラウンドスレッドの場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_HOST</code>
            </p><p>
              フォアグラウンドスレッドに関連付けられているクライアントのホスト名、バックグラウンドスレッドの場合は <code class="literal">NULL</code>。
            </p><p>
              <code class="literal">INFORMATION_SCHEMA</code> <code class="literal">PROCESSLIST</code> テーブルの <code class="literal">HOST</code> カラムまたは <code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Host</code> カラムとは異なり、<code class="literal">PROCESSLIST_HOST</code> カラムには TCP/IP 接続のポート番号は含まれません。 パフォーマンススキーマからこの情報を取得するには、ソケットインストゥルメンテーションを有効にし (デフォルトでは有効になっていません)、<code class="literal">socket_instances</code> テーブルを調べます: 
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NAME, ENABLED, TIMED</code></strong>
       <strong class="userinput"><code>FROM performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/socket%';</code></strong>
+----------------------------------------+---------+-------+
| NAME                                   | ENABLED | TIMED |
+----------------------------------------+---------+-------+
| wait/io/socket/sql/server_tcpip_socket | NO      | NO    |
| wait/io/socket/sql/server_unix_socket  | NO      | NO    |
| wait/io/socket/sql/client_connection   | NO      | NO    |
+----------------------------------------+---------+-------+
3 rows in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>SET ENABLED='YES'</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/socket%';</code></strong>
Query OK, 3 rows affected (0.00 sec)
Rows matched: 3  Changed: 3  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.socket_instances\G</code></strong>
*************************** 1. row ***************************
           EVENT_NAME: wait/io/socket/sql/client_connection
OBJECT_INSTANCE_BEGIN: 140612577298432
            THREAD_ID: 31
            SOCKET_ID: 53
                   IP: ::ffff:127.0.0.1
                 PORT: 55642
                STATE: ACTIVE
...
</pre></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_DB</code>
            </p><p>
              スレッドのデフォルトデータベース。選択されていない場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_COMMAND</code>
            </p><p>
              フォアグラウンドスレッドの場合、スレッドがクライアントのかわりに実行しているコマンドのタイプ、またはセッションがアイドル状態の場合は <code class="literal">Sleep</code>。 スレッドコマンドの説明については、<a class="xref" href="optimization.html#thread-information" title="8.14 サーバースレッド (プロセス) 情報の確認">セクション8.14「サーバースレッド (プロセス) 情報の確認」</a>を参照してください。 このカラムの値は、クライアント/サーバープロトコルの <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code> コマンドと <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> ステータス変数に対応します。 <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 サーバーステータス変数">セクション5.1.10「サーバーステータス変数」</a>を参照してください 
            </p><p>
              バックグラウンドスレッドはクライアントのかわりにコマンドを実行しないため、このカラムは <code class="literal">NULL</code> である可能性があります。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_TIME</code>
            </p><p>
              スレッドが現在の状態になってからの秒数。 レプリカ SQL スレッドの場合、この値は、最後にレプリケートされたイベントのタイムスタンプとレプリカホストのリアルタイムの間の秒数です。 <a class="xref" href="replication.html#replication-implementation-details" title="17.2.3 レプリケーションスレッド">セクション17.2.3「レプリケーションスレッド」</a>を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_STATE</code>
            </p><p>
              スレッドが行なっていることを示すアクション、イベント、または状態。 <code class="literal">PROCESSLIST_STATE</code> 値の説明については、<a class="xref" href="optimization.html#thread-information" title="8.14 サーバースレッド (プロセス) 情報の確認">セクション8.14「サーバースレッド (プロセス) 情報の確認」</a>を参照してください。 値が <code class="literal">NULL</code> の場合、スレッドはアイドルクライアントセッションに対応しているか、スレッドが実行している作業がステージでインストゥルメントされていません。 
            </p><p>
              ほとんどの状態がきわめてすばやい操作に対応します。 スレッドが何秒間も特定の状態にとどまっている場合は、問題が発生している可能性があり、調査が必要です。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_INFO</code>
            </p><p>
              スレッドが実行しているステートメント。ステートメントを実行していない場合は <code class="literal">NULL</code>。 このステートメントは、サーバーに送信されるステートメント、またはこのステートメントがほかのステートメントを実行する場合は、もっとも内側のステートメントである可能性があります。 たとえば、<code class="literal">CALL</code> ステートメントが <code class="literal">SELECT</code> ステートメントを実行しているストアドプロシージャーを実行する場合、<code class="literal">PROCESSLIST_INFO</code> 値には <code class="literal">SELECT</code> ステートメントが示されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">PARENT_THREAD_ID</code>
            </p><p>
              このスレッドがサブスレッド (別のスレッドによって生成される) である場合、これは生成されるスレッドの <code class="literal">THREAD_ID</code> 値です。
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              使用されません。
            </p></li><li class="listitem"><p>
              <code class="literal">INSTRUMENTED</code>
            </p><p>
              スレッドによって実行されるイベントがインストゥルメントされるかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  フォアグラウンドスレッドでは、初期 <code class="literal">INSTRUMENTED</code> 値は、スレッドに関連付けられているユーザーアカウントが <code class="literal">setup_actors</code> テーブル内の任意の行に一致するかどうかによって決定されます。 照合は <code class="literal">PROCESSLIST_USER</code> および <code class="literal">PROCESSLIST_HOST</code> カラムの値に基づきます。 
                </p><p>
                  スレッドがサブスレッドを生成すると、そのサブスレッドに対して作成された <code class="literal">threads</code> テーブルの行に対して照合が再度行われます。
                </p></li><li class="listitem"><p>
                  バックグラウンドスレッドの場合、<code class="literal">INSTRUMENTED</code> はデフォルトで <code class="literal">YES</code> です。バックグラウンドスレッドに関連付けられたユーザーはないため、<code class="literal">setup_actors</code> は参照されません。
                </p></li><li class="listitem"><p>
                  どのスレッドでも、スレッドの有効期間の間にその <code class="literal">INSTRUMENTED</code> 値が変更されることがあります。
                </p></li></ul></div><p>
              スレッドによって実行されるイベントのモニタリングが行われる場合、これらのことが当てはまる必要があります。
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">setup_consumers</code> テーブル内の <code class="literal">thread_instrumentation</code> コンシューマは <code class="literal">YES</code> である必要があります。
                </p></li><li class="listitem"><p>
                  <code class="literal">threads.INSTRUMENTED</code> カラムは <code class="literal">YES</code> である必要があります。
                </p></li><li class="listitem"><p>
                  監視は、<code class="literal">setup_instruments</code> テーブルで <code class="literal">ENABLED</code> カラムが <code class="literal">YES</code> に設定されているインストゥルメントから生成されたスレッドイベントに対してのみ行われます。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">HISTORY</code>
            </p><p>
              スレッドの履歴イベントをログに記録するかどうか。 値は <code class="literal">YES</code> または <code class="literal">NO</code> です。 
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  フォアグラウンドスレッドの場合、初期 <code class="literal">HISTORY</code> 値は、スレッドに関連付けられたユーザーアカウントが <code class="literal">setup_actors</code> テーブルのいずれかの行と一致するかどうかによって決まります。 照合は <code class="literal">PROCESSLIST_USER</code> および <code class="literal">PROCESSLIST_HOST</code> カラムの値に基づきます。 
                </p><p>
                  スレッドがサブスレッドを生成すると、そのサブスレッドに対して作成された <code class="literal">threads</code> テーブルの行に対して照合が再度行われます。
                </p></li><li class="listitem"><p>
                  バックグラウンドスレッドの場合、<code class="literal">HISTORY</code> はデフォルトで <code class="literal">YES</code> です。バックグラウンドスレッドに関連付けられたユーザーがないため、<code class="literal">setup_actors</code> は参照されません。
                </p></li><li class="listitem"><p>
                  どのスレッドでも、その <code class="literal">HISTORY</code> 値はスレッドの存続期間中に変更できます。
                </p></li></ul></div><p>
              スレッドの履歴イベントロギングを実行するには、次のことが当てはまる必要があります:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">setup_consumers</code> テーブルの適切な履歴関連コンシューマを有効にする必要があります。 たとえば、<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルの待機イベントロギングでは、対応する <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> コンシューマが <code class="literal">YES</code> である必要があります。 
                </p></li><li class="listitem"><p>
                  <code class="literal">threads.HISTORY</code> カラムは <code class="literal">YES</code> である必要があります。
                </p></li><li class="listitem"><p>
                  ロギングは、<code class="literal">setup_instruments</code> テーブルで <code class="literal">ENABLED</code> カラムが <code class="literal">YES</code> に設定されているインストゥルメントから生成されたスレッドイベントに対してのみ発生します。
                </p></li></ul></div></li><li class="listitem"><p>
              <code class="literal">CONNECTION_TYPE</code>
            </p><p>
              接続の確立に使用されるプロトコル、またはバックグラウンドスレッド用の <code class="literal">NULL</code>。 許可される値は、<code class="literal">TCP/IP</code> (暗号化なしで確立された TCP/IP 接続)、<code class="literal">SSL/TLS</code> (暗号化で確立された TCP/IP 接続)、<code class="literal">Socket</code> (Unix ソケットファイル接続)、<code class="literal">Named Pipe</code> (Windows 名前付きパイプ接続) および <code class="literal">Shared Memory</code> (Windows 共有メモリー接続) です。 
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_OS_ID</code>
            </p><p>
              基礎となるオペレーティングシステムで定義されているスレッドまたはタスク識別子 (存在する場合):
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  MySQL スレッドが存続期間中に同じオペレーティングシステムスレッドに関連付けられている場合、<code class="literal">THREAD_OS_ID</code> にはオペレーティングシステムスレッド ID が含まれます。
                </p></li><li class="listitem"><p>
                  MySQL スレッドが存続期間中に同じオペレーティングシステムスレッドに関連付けられていない場合、<code class="literal">THREAD_OS_ID</code> には <code class="literal">NULL</code> が含まれます。 これは、スレッドプールプラグインが使用されている場合のユーザーセッションに一般的です (<a class="xref" href="server-administration.html#thread-pool" title="5.6.3 MySQL Enterprise Thread Pool">セクション5.6.3「MySQL Enterprise Thread Pool」</a> を参照)。 
                </p></li></ul></div><p>
              Windows の場合、<code class="literal">THREAD_OS_ID</code> はプロセスエクスプローラ (<a class="ulink" href="https://technet.microsoft.com/en-us/sysinternals/bb896653.aspx" target="_top">https://technet.microsoft.com/en-us/sysinternals/bb896653.aspx</a>) に表示されるスレッド ID に対応します。
            </p><p>
              Linux の場合、<code class="literal">THREAD_OS_ID</code> は <code class="literal">gettid()</code> 関数の値に対応します。 この値は、たとえば、<span class="command"><strong>perf</strong></span> または <span class="command"><strong>ps -L</strong></span> コマンドを使用するか、<code class="literal">proc</code> ファイルシステム (<code class="filename">/proc/<em class="replaceable"><code>[pid]</code></em>/task/<em class="replaceable"><code>[tid]</code></em></code>) で公開されます。 詳細は、<code class="literal">perf-stat(1)</code>、<code class="literal">ps(1)</code>、および <code class="literal">proc(5)</code> のマニュアルページを参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">RESOURCE_GROUP</code>
            </p><p>
              リソースグループラベル。 リソースグループが現在のプラットフォームまたはサーバー構成でサポートされていない場合、この値は <code class="literal">NULL</code> です (<a class="xref" href="server-administration.html#resource-group-restrictions" title="リソースグループの制限">リソースグループの制限</a> を参照)。 
            </p></li></ul></div><p>
          <code class="literal">threads</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">THREAD_ID</code>)
            </p></li><li class="listitem"><p>
              (<code class="literal">NAME</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">PROCESSLIST_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">PROCESSLIST_USER</code>、<code class="literal">PROCESSLIST_HOST</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">PROCESSLIST_HOST</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">THREAD_OS_ID</code>) のインデックス
            </p></li><li class="listitem"><p>
              (<code class="literal">RESOURCE_GROUP</code>) のインデックス
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">threads</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-tls-channel-status-table"></a>27.12.19.11 tls_channel_status テーブル</h4></div></div></div><a class="indexterm" name="idm45882605175968"></a><a class="indexterm" name="idm45882605173808"></a><p>
          接続インタフェース TLS プロパティーはサーバーの起動時に設定され、実行時に <code class="literal">ALTER INSTANCE RELOAD TLS</code> ステートメントを使用して更新できます。 <a class="xref" href="security.html#using-encrypted-connections-server-side-runtime-configuration" title="サーバー側のランタイム構成および暗号化された接続の監視">サーバー側のランタイム構成および暗号化された接続の監視</a>を参照してください。 
        </p><p>
          <code class="literal">tls_channel_status</code> テーブル (MySQL 8.0.21 で使用可能) は、接続インタフェース TLS プロパティに関する情報を提供します:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.tls_channel_status\G</code></strong>
*************************** 1. row ***************************
 CHANNEL: mysql_main
PROPERTY: Enabled
   VALUE: Yes
*************************** 2. row ***************************
 CHANNEL: mysql_main
PROPERTY: ssl_accept_renegotiates
   VALUE: 0
*************************** 3. row ***************************
 CHANNEL: mysql_main
PROPERTY: Ssl_accepts
   VALUE: 2
...
*************************** 29. row ***************************
 CHANNEL: mysql_admin
PROPERTY: Enabled
   VALUE: No
*************************** 30. row ***************************
 CHANNEL: mysql_admin
PROPERTY: ssl_accept_renegotiates
   VALUE: 0
*************************** 31. row ***************************
 CHANNEL: mysql_admin
PROPERTY: Ssl_accepts
   VALUE: 0
...
</pre><p>
          <code class="literal">tls_channel_status</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CHANNEL</code>
            </p><p>
              TLS プロパティ行が適用される接続インタフェースの名前。<code class="literal">mysql_main</code> と <code class="literal">mysql_admin</code> は、それぞれメイン接続インタフェースと管理接続インタフェースのチャネル名です。 様々なインタフェースの詳細は、<a class="xref" href="server-administration.html#connection-interfaces" title="5.1.12.1 接続インタフェース">セクション5.1.12.1「接続インタフェース」</a> を参照してください。 
            </p></li><li class="listitem"><p>
              <code class="literal">PROPERTY</code>
            </p><p>
              TLS プロパティー名。 <code class="literal">Enabled</code> プロパティの行は、インタフェース全体のステータスを示し、インタフェースとそのステータスはそれぞれ <code class="literal">CHANNEL</code> カラムと <code class="literal">VALUE</code> カラムで指定されます。 その他のプロパティー名は、特定の TLS プロパティーを示します。 これらは多くの場合、TLS 関連のステータス変数の名前に対応します。 
            </p></li><li class="listitem"><p>
              <code class="literal">VALUE</code>
            </p><p>
              TLS プロパティー値。
            </p></li></ul></div><p>
          このテーブルで公開されるプロパティは固定されず、各チャネルで実装されるインストゥルメンテーションに依存します。
        </p><p>
          チャネルごとに、<code class="literal">PROPERTY</code> 値が <code class="literal">Enabled</code> の行はチャネルが暗号化された接続をサポートしているかどうかを示し、その他のチャネル行は TLS コンテキストプロパティを示します:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql_main</code> の場合、<code class="literal">Enabled</code> プロパティは <code class="literal">yes</code> または <code class="literal">no</code> で、メインインタフェースが暗号化された接続をサポートするかどうかを示します。 その他のチャネル行には、メインインタフェースの TLS コンテキストプロパティが表示されます。 
            </p><p>
              メインインタフェースでは、次のステートメントを使用して同様のステータス情報を取得できます:
            </p><pre class="programlisting">SHOW GLOBAL STATUS LIKE 'current_tls%';
SHOW GLOBAL STATUS LIKE 'ssl%';
</pre></li><li class="listitem"><p>
              <code class="literal">mysql_admin</code> では、管理インタフェースが有効になっていない場合、または有効になっているが暗号化された接続をサポートしていない場合、<code class="literal">Enabled</code> プロパティは <code class="literal">no</code> です。 インタフェースが有効で、暗号化された接続をサポートしている場合、<code class="literal">Enabled</code> は <code class="literal">yes</code> です。 
            </p><p>
              <code class="literal">Enabled</code> が <code class="literal">yes</code> の場合、他の <code class="literal">mysql_admin</code> 行は、そのインタフェースにデフォルト以外の TLS パラメータ値が構成されている場合にのみ、管理インタフェース TLS コンテキストのチャネルプロパティを示します。 (これは、<code class="literal">admin_tls_<em class="replaceable"><code>xxx</code></em></code> または <code class="literal">admin_ssl_<em class="replaceable"><code>xxx</code></em></code> システム変数がデフォルトとは異なる値に設定されている場合です。) それ以外の場合、管理インタフェースはメインインタフェースと同じ TLS コンテキストを使用します。 
            </p></li></ul></div><p>
          <code class="literal">tls_channel_status</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              なし
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">tls_channel_status</code> テーブルに対して許可されていません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-user-defined-functions-table"></a>27.12.19.12 user_defined_functions テーブル</h4></div></div></div><a class="indexterm" name="idm45882605125856"></a><a class="indexterm" name="idm45882605123648"></a><p>
          <code class="literal">user_defined_functions</code> テーブルには、コンポーネントまたはプラグインによって自動的に、または <code class="literal">CREATE FUNCTION</code> ステートメントによって手動で登録された各ユーザー定義関数 (UDF) の行が含まれています。 テーブルの行を追加または削除する操作の詳細は、<a class="xref" href="server-administration.html#function-loading" title="5.7.1 ユーザー定義関数のインストールおよびアンインストール">セクション5.7.1「ユーザー定義関数のインストールおよびアンインストール」</a> を参照してください。 
        </p><p>
          <code class="literal">user_defined_functions</code> テーブルには、次のカラムがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">UDF_NAME</code>
            </p><p>
              SQL ステートメントで参照される UDF 名。 関数が <code class="literal">CREATE FUNCTION</code> ステートメントによって登録され、アンロード処理中の場合、値は <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">UDF_RETURN_TYPE</code>
            </p><p>
              UDF 戻り値のタイプ。 値は、<code class="literal">int</code>, <code class="literal">decimal</code>, <code class="literal">real</code>, <code class="literal">char</code> または <code class="literal">row</code> のいずれかです。 
            </p></li><li class="listitem"><p>
              <code class="literal">UDF_TYPE</code>
            </p><p>
              UDF タイプ。 値は、<code class="literal">function</code> (スカラー) または <code class="literal">aggregate</code> のいずれかです。 
            </p></li><li class="listitem"><p>
              <code class="literal">UDF_LIBRARY</code>
            </p><p>
              実行可能 UDF コードを含むライブラリファイルの名前。 このファイルは、<code class="literal">plugin_dir</code> システム変数で指定されたディレクトリにあります。 UDF が <code class="literal">CREATE FUNCTION</code> ステートメントではなくコンポーネントまたはプラグインによって登録された場合、値は <code class="literal">NULL</code> です。 
            </p></li><li class="listitem"><p>
              <code class="literal">UDF_USAGE_COUNT</code>
            </p><p>
              現在の UDF 使用数。 これは、ステートメントが現在 UDF にアクセスしているかどうかを判断するために使用されます。 
            </p></li></ul></div><p>
          <code class="literal">user_defined_functions</code> テーブルには次のインデックスがあります:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              主キー (<code class="literal">UDF_NAME</code>)
            </p></li></ul></div><p>
          <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">user_defined_functions</code> テーブルに対して許可されていません。
        </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-option-variable-reference"></a>27.13 パフォーマンススキーマオプションおよび変数リファレンス</h2></div></div></div><div class="table"><a name="idm45882605087872"></a><p class="title"><b>表 27.4 「パフォーマンススキーマ変数リファレンス」</b></p><div class="table-contents"><table frame="box" rules="all" summary="「パフォーマンススキーマのコマンド行オプション、システム変数、およびステータス変数のリファレンス。」"><col width="20%"><col width="15%"><col width="15%"><col width="15%"><col width="15%"><col width="15%"><col width="15%"><thead><tr><th scope="col">名前</th>
<th scope="col">コマンド行</th>
<th scope="col">オプションファイル</th>
<th scope="col">システム変数</th>
<th scope="col">ステータス変数</th>
<th scope="col">変数スコープ</th>
<th scope="col">動的</th>
</tr></thead><tbody><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_accounts_lost">Performance_schema_accounts_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_classes_lost">Performance_schema_cond_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_instances_lost">Performance_schema_cond_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-current">performance-schema-consumer-events-stages-current</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history">performance-schema-consumer-events-stages-history</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history-long">performance-schema-consumer-events-stages-history-long</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-current">performance-schema-consumer-events-statements-current</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history">performance-schema-consumer-events-statements-history</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history-long">performance-schema-consumer-events-statements-history-long</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-transactions-current">performance-schema-consumer-events-transactions-current</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-transactions-history">performance-schema-consumer-events-transactions-history</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-transactions-history-long">performance-schema-consumer-events-transactions-history-long</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-current">performance-schema-consumer-events-waits-current</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history">performance-schema-consumer-events-waits-history</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history-long">performance-schema-consumer-events-waits-history-long</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-global-instrumentation">performance-schema-consumer-global-instrumentation</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-statements-digest">performance-schema-consumer-statements-digest</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-thread-instrumentation">performance-schema-consumer-thread-instrumentation</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_digest_lost">Performance_schema_digest_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_transactions_history_long_size">performance_schema_events_transactions_history_long_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_transactions_history_size">performance_schema_events_transactions_history_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_classes_lost">Performance_schema_file_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_handles_lost">Performance_schema_file_handles_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_instances_lost">Performance_schema_file_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_hosts_lost">Performance_schema_hosts_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-instrument">performance-schema-instrument</a></th>
<td>はい</td>
<td>はい</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_locker_lost">Performance_schema_locker_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length">performance_schema_max_digest_length</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_memory_classes">performance_schema_max_memory_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_metadata_locks">performance_schema_max_metadata_locks</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_prepared_statements_instances">performance_schema_max_prepared_statements_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_program_instances">performance_schema_max_program_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_stack">performance_schema_max_statement_stack</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_memory_classes_lost">Performance_schema_memory_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_metadata_lock_lost">Performance_schema_metadata_lock_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost">Performance_schema_mutex_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost">Performance_schema_mutex_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_nested_statement_lost">Performance_schema_nested_statement_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_prepared_statements_lost">Performance_schema_prepared_statements_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_program_lost">Performance_schema_program_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_classes_lost">Performance_schema_rwlock_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_instances_lost">Performance_schema_rwlock_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_session_connect_attrs_lost">Performance_schema_session_connect_attrs_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_classes_lost">Performance_schema_socket_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_instances_lost">Performance_schema_socket_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_stage_classes_lost">Performance_schema_stage_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_statement_classes_lost">Performance_schema_statement_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_handles_lost">Performance_schema_table_handles_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_instances_lost">Performance_schema_table_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_classes_lost">Performance_schema_thread_classes_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_instances_lost">Performance_schema_thread_instances_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_users_lost">Performance_schema_users_lost</a></th>
<td></td>
<td></td>
<td></td>
<td>はい</td>
<td>グローバル</td>
<td>いいえ</td>
</tr><tr><th scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></th>
<td>はい</td>
<td>はい</td>
<td>はい</td>
<td></td>
<td>グローバル</td>
<td>いいえ</td>
</tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-options"></a>27.14 パフォーマンススキーマコマンドオプション</h2></div></div></div><p>
      パフォーマンススキーマパラメータは、サーバー起動時にコマンド行またはオプションファイルに指定して、パフォーマンススキーマのインストゥルメントおよびコンシューマを構成できます。 多くの場合に実行時構成も可能ですが (<a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="27.4 パフォーマンススキーマ実行時構成">セクション27.4「パフォーマンススキーマ実行時構成」</a> を参照)、実行時構成で、起動プロセス中にすでに初期化されているインストゥルメントに影響を与えるには遅すぎる場合は、起動時構成を使用する必要があります。 
    </p><p>
      パフォーマンススキーマのコンシューマおよびインストゥルメントは、次の構文を使用して起動時に構成できます。 追加の詳細については、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a>を参照してください。 
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-xxx"></a>
          <code class="option">--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604481648"></a><a class="indexterm" name="idm45882604479456"></a><p>
          パフォーマンススキーマコンシューマを構成します。 <code class="literal">setup_consumers</code> テーブル内のコンシューマ名は下線が使われますが、起動時に設定されたコンシューマでは、名前の中のダッシュと下線は同等です。 各コンシューマを構成するためのオプションについては、このセクションの後半で詳しく説明します。 
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-instrument"></a>
          <code class="option">--performance-schema-instrument=<em class="replaceable"><code>instrument_name</code></em>=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604472288"></a><a class="indexterm" name="idm45882604470096"></a><p>
          パフォーマンススキーマインストゥルメントを構成します。 名前をパターンとして指定して、パターンに一致するインストゥルメントを構成できます。 
        </p></li></ul></div><p>
      次の項目は各コンシューマを構成します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-current"></a>
          <code class="option">--performance-schema-consumer-events-stages-current=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604463696"></a><a class="indexterm" name="idm45882604461472"></a><p>
          <code class="literal">events-stages-current</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history"></a>
          <code class="option">--performance-schema-consumer-events-stages-history=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604455616"></a><a class="indexterm" name="idm45882604453392"></a><p>
          <code class="literal">events-stages-history</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history-long"></a>
          <code class="option">--performance-schema-consumer-events-stages-history-long=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604447536"></a><a class="indexterm" name="idm45882604445216"></a><p>
          <code class="literal">events-stages-history-long</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-current"></a>
          <code class="option">--performance-schema-consumer-events-statements-current=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604439392"></a><a class="indexterm" name="idm45882604437072"></a><p>
          <code class="literal">events-statements-current</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history"></a>
          <code class="option">--performance-schema-consumer-events-statements-history=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604431248"></a><a class="indexterm" name="idm45882604428928"></a><p>
          <code class="literal">events-statements-history</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history-long"></a>
          <code class="option">--performance-schema-consumer-events-statements-history-long=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604423008"></a><a class="indexterm" name="idm45882604420768"></a><p>
          <code class="literal">events-statements-history-long</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-transactions-current"></a>
          <code class="option">--performance-schema-consumer-events-transactions-current=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604414928"></a><a class="indexterm" name="idm45882604412608"></a><p>
          パフォーマンススキーマ <code class="literal">events-transactions-current</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-transactions-history"></a>
          <code class="option">--performance-schema-consumer-events-transactions-history=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604406672"></a><a class="indexterm" name="idm45882604404352"></a><p>
          パフォーマンススキーマ <code class="literal">events-transactions-history</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-transactions-history-long"></a>
          <code class="option">--performance-schema-consumer-events-transactions-history-long=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604398288"></a><a class="indexterm" name="idm45882604396032"></a><p>
          パフォーマンススキーマ <code class="literal">events-transactions-history-long</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-current"></a>
          <code class="option">--performance-schema-consumer-events-waits-current=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604390000"></a><a class="indexterm" name="idm45882604387776"></a><p>
          <code class="literal">events-waits-current</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history"></a>
          <code class="option">--performance-schema-consumer-events-waits-history=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604381856"></a><a class="indexterm" name="idm45882604379632"></a><p>
          <code class="literal">events-waits-history</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history-long"></a>
          <code class="option">--performance-schema-consumer-events-waits-history-long=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604373840"></a><a class="indexterm" name="idm45882604371520"></a><p>
          <code class="literal">events-waits-history-long</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-global-instrumentation"></a>
          <code class="option">--performance-schema-consumer-global-instrumentation=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604365568"></a><a class="indexterm" name="idm45882604363344"></a><p>
          <code class="literal">global-instrumentation</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-statements-digest"></a>
          <code class="option">--performance-schema-consumer-statements-digest=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604357424"></a><a class="indexterm" name="idm45882604355200"></a><p>
          <code class="literal">statements-digest</code> コンシューマを構成します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-thread-instrumentation"></a>
          <code class="option">--performance-schema-consumer-thread-instrumentation=<code class="literal">value</code></code>
        </p><a class="indexterm" name="idm45882604349344"></a><a class="indexterm" name="idm45882604347120"></a><p>
          <code class="literal">thread-instrumentation</code> コンシューマを構成します。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-system-variables"></a>27.15 パフォーマンススキーマシステム変数</h2></div></div></div><p>
      パフォーマンススキーマは、構成情報を提供するいくつかのシステム変数を実装しています。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+----------------------------------------------------------+-------+
| Variable_name                                            | Value |
+----------------------------------------------------------+-------+
| performance_schema                                       | ON    |
| performance_schema_accounts_size                         | -1    |
| performance_schema_digests_size                          | 10000 |
| performance_schema_events_stages_history_long_size       | 10000 |
| performance_schema_events_stages_history_size            | 10    |
| performance_schema_events_statements_history_long_size   | 10000 |
| performance_schema_events_statements_history_size        | 10    |
| performance_schema_events_transactions_history_long_size | 10000 |
| performance_schema_events_transactions_history_size      | 10    |
| performance_schema_events_waits_history_long_size        | 10000 |
| performance_schema_events_waits_history_size             | 10    |
| performance_schema_hosts_size                            | -1    |
| performance_schema_max_cond_classes                      | 80    |
| performance_schema_max_cond_instances                    | -1    |
| performance_schema_max_digest_length                     | 1024  |
| performance_schema_max_file_classes                      | 50    |
| performance_schema_max_file_handles                      | 32768 |
| performance_schema_max_file_instances                    | -1    |
| performance_schema_max_index_stat                        | -1    |
| performance_schema_max_memory_classes                    | 320   |
| performance_schema_max_metadata_locks                    | -1    |
| performance_schema_max_mutex_classes                     | 220   |
| performance_schema_max_mutex_instances                   | -1    |
| performance_schema_max_prepared_statements_instances     | -1    |
| performance_schema_max_program_instances                 | -1    |
| performance_schema_max_rwlock_classes                    | 40    |
| performance_schema_max_rwlock_instances                  | -1    |
| performance_schema_max_socket_classes                    | 10    |
| performance_schema_max_socket_instances                  | -1    |
| performance_schema_max_sql_text_length                   | 1024  |
| performance_schema_max_stage_classes                     | 150   |
| performance_schema_max_statement_classes                 | 192   |
| performance_schema_max_statement_stack                   | 10    |
| performance_schema_max_table_handles                     | -1    |
| performance_schema_max_table_instances                   | -1    |
| performance_schema_max_table_lock_stat                   | -1    |
| performance_schema_max_thread_classes                    | 50    |
| performance_schema_max_thread_instances                  | -1    |
| performance_schema_session_connect_attrs_size            | 512   |
| performance_schema_setup_actors_size                     | -1    |
| performance_schema_setup_objects_size                    | -1    |
| performance_schema_users_size                            | -1    |
+----------------------------------------------------------+-------+
</pre><p>
      パフォーマンススキーマシステム変数は、コマンド行またはオプションファイルでサーバーの起動時に設定でき、多くは実行時に設定できます。 <a class="xref" href="performance-schema.html#performance-schema-option-variable-reference" title="27.13 パフォーマンススキーマオプションおよび変数リファレンス">セクション27.13「パフォーマンススキーマオプションおよび変数リファレンス」</a>を参照してください。 
    </p><p>
      パフォーマンススキーマは、明示的に設定されていない場合、サーバーの起動時にいくつかのパラメータの値のサイズを自動的に設定します。 詳細については、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="27.3 パフォーマンススキーマ起動構成">セクション27.3「パフォーマンススキーマ起動構成」</a>を参照してください。 
    </p><p>
      パフォーマンススキーマシステム変数には次の意味があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="sysvar_performance_schema"></a>
          <code class="literal">performance_schema</code>
        </p><a class="indexterm" name="idm45882604330640"></a><a class="indexterm" name="idm45882604329088"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema[={OFF|ON}]</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Boolean</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">ON</code></td>
</tr></tbody></table></div><p>
          この変数の値は <code class="literal">ON</code> または <code class="literal">OFF</code> で、パフォーマンススキーマが有効にされているかどうかを示します。 デフォルト値は <code class="literal">ON</code> です。 サーバーの起動時に、この変数を値なし、またはそれを有効にする <code class="literal">ON</code> または 1 の値、またはそれを無効にする <code class="literal">OFF</code> または 0 の値で指定できます。 
        </p><p>
          パフォーマンススキーマが無効になっていても、引き続き <code class="literal">global_variables</code>, <code class="literal">session_variables</code>, <code class="literal">global_status</code> および <code class="literal">session_status</code> テーブルにデータが移入されます。 これは、必要に応じて、<code class="literal">SHOW VARIABLES</code> および <code class="literal">SHOW STATUS</code> ステートメントの結果をこれらのテーブルから取得できるようにするために発生します。 また、パフォーマンススキーマは、一部のレプリケーションテーブルが無効になっている場合はそれらのテーブルにデータを移入します。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_accounts_size"></a>
          <code class="literal">performance_schema_accounts_size</code>
        </p><a class="indexterm" name="idm45882604293488"></a><a class="indexterm" name="idm45882604291904"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_accounts_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-accounts-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最小値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          <code class="literal">accounts</code> テーブルの行数。 この変数が 0 の場合、パフォーマンススキーマは <code class="literal">accounts</code> テーブル内の接続統計情報または <code class="literal">status_by_account</code> テーブル内のステータス変数情報を保持しません。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_digests_size"></a>
          <code class="literal">performance_schema_digests_size</code>
        </p><a class="indexterm" name="idm45882604258544"></a><a class="indexterm" name="idm45882604256960"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_digests_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-digests-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最小値</th>
<td><code class="literal">-1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブル内の最大行数。 この最大を超えたため、ダイジェストをインストゥルメントできない場合、パフォーマンススキーマは <code class="literal">Performance_schema_digest_lost</code> ステータス変数を増分します。 
        </p><p>
          ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a>を参照してください。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_error_size"></a>
          <code class="literal">performance_schema_error_size</code>
        </p><a class="indexterm" name="idm45882604223552"></a><a class="indexterm" name="idm45882604221984"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_error_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-error-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_error_size">performance_schema_error_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">number of server error codes</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          インストゥルメントされたサーバーエラーコードの数。 デフォルト値は、サーバーエラーコードの実際の数です。 値は 0 から最大までの任意の場所に設定できますが、使用目的はデフォルト (すべてのエラーを計測する) または 0 (エラーを計測しない) に設定することです。 
        </p><p>
          エラー情報はサマリーテーブルに集約されます。<a class="xref" href="performance-schema.html#performance-schema-error-summary-tables" title="27.12.18.11 エラー要約テーブル">セクション27.12.18.11「エラー要約テーブル」</a> を参照してください。 インストゥルメントされていないエラーが発生した場合、発生した情報は各サマリーテーブルの <code class="literal">NULL</code> 行、つまり <code class="literal">ERROR_NUMBER=0</code>、<code class="literal">ERROR_NAME=NULL</code> および <code class="literal">SQLSTATE=NULL</code> のある行に集計されます。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_long_size"></a>
          <code class="literal">performance_schema_events_stages_history_long_size</code>
        </p><a class="indexterm" name="idm45882604187168"></a><a class="indexterm" name="idm45882604185520"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_stages_history_long_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-stages-history-long-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_stages_history_long</code> テーブルの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_size"></a>
          <code class="literal">performance_schema_events_stages_history_size</code>
        </p><a class="indexterm" name="idm45882604159504"></a><a class="indexterm" name="idm45882604157968"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_stages_history_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-stages-history-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_stages_history</code> テーブルのスレッドあたりの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_long_size"></a>
          <code class="literal">performance_schema_events_statements_history_long_size</code>
        </p><a class="indexterm" name="idm45882604131856"></a><a class="indexterm" name="idm45882604130208"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_statements_history_long_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-statements-history-long-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_statements_history_long</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_size"></a>
          <code class="literal">performance_schema_events_statements_history_size</code>
        </p><a class="indexterm" name="idm45882604104144"></a><a class="indexterm" name="idm45882604102496"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_statements_history_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-statements-history-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_statements_history</code> テーブル内のスレッドあたりの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_transactions_history_long_size"></a>
          <code class="literal">performance_schema_events_transactions_history_long_size</code>
        </p><a class="indexterm" name="idm45882604076464"></a><a class="indexterm" name="idm45882604074816"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_transactions_history_long_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-transactions-history-long-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_transactions_history_long_size">performance_schema_events_transactions_history_long_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_transactions_history_long</code> テーブルの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_transactions_history_size"></a>
          <code class="literal">performance_schema_events_transactions_history_size</code>
        </p><a class="indexterm" name="idm45882604048576"></a><a class="indexterm" name="idm45882604046928"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_transactions_history_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-transactions-history-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_transactions_history_size">performance_schema_events_transactions_history_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_transactions_history</code> テーブルのスレッド当たりの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_long_size"></a>
          <code class="literal">performance_schema_events_waits_history_long_size</code>
        </p><a class="indexterm" name="idm45882604020784"></a><a class="indexterm" name="idm45882604019136"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_waits_history_long_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-waits-history-long-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_waits_history_long</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_size"></a>
          <code class="literal">performance_schema_events_waits_history_size</code>
        </p><a class="indexterm" name="idm45882603993120"></a><a class="indexterm" name="idm45882603991584"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_events_waits_history_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-events-waits-history-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">events_waits_history</code> テーブル内のスレッドあたりの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_hosts_size"></a>
          <code class="literal">performance_schema_hosts_size</code>
        </p><a class="indexterm" name="idm45882603965552"></a><a class="indexterm" name="idm45882603963984"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_hosts_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-hosts-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最小値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          <code class="literal">hosts</code> テーブル内の行数。 この変数が 0 の場合、パフォーマンススキーマは <code class="literal">hosts</code> テーブル内の接続統計情報または <code class="literal">status_by_host</code> テーブル内のステータス変数情報を保持しません。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_classes"></a>
          <code class="literal">performance_schema_max_cond_classes</code>
        </p><a class="indexterm" name="idm45882603930592"></a><a class="indexterm" name="idm45882603928992"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_cond_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-cond-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値 (≥ 8.0.13)</th>
<td><code class="literal">100</code></td>
</tr><tr><th>デフォルト値 (≤ 8.0.12)</th>
<td><code class="literal">80</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          条件インストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_instances"></a>
          <code class="literal">performance_schema_max_cond_instances</code>
        </p><a class="indexterm" name="idm45882603893600"></a><a class="indexterm" name="idm45882603892000"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_cond_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-cond-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされた条件オブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_digest_length"></a>
          <code class="literal">performance_schema_max_digest_length</code>
        </p><a class="indexterm" name="idm45882603865968"></a><a class="indexterm" name="idm45882603864368"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_digest_length"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-digest-length=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length">performance_schema_max_digest_length</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          パフォーマンススキーマ内の正規化されたステートメントダイジェスト値を計算するためにステートメントごとに予約されるメモリーの最大バイト数。 この変数は <code class="literal">max_digest_length</code> に関連しています。<a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 サーバーシステム変数">セクション5.1.8「サーバーシステム変数」</a> でその変数の説明を参照してください。 
        </p><p>
          メモリー使用に関する考慮事項など、ステートメントダイジェストの詳細は、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a> を参照してください。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_digest_sample_age"></a>
          <code class="literal">performance_schema_max_digest_sample_age</code>
        </p><a class="indexterm" name="idm45882603831168"></a><a class="indexterm" name="idm45882603829568"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_digest_sample_age"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-digest-sample-age=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_sample_age">performance_schema_max_digest_sample_age</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">60</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          この変数は、<code class="literal">events_statements_summary_by_digest</code> テーブルのステートメントサンプリングに影響します。 新しいテーブル行が挿入されると、行ダイジェスト値を生成したステートメントは、ダイジェストに関連付けられた現在のサンプルステートメントとして格納されます。 その後、同じダイジェスト値を持つほかのステートメントがサーバーに表示されるときに、新しいステートメントを使用して現在のサンプルステートメントを置き換えるかどうか (つまり、再サンプリングするかどうか) を決定します。 リサンプリングポリシーは、現在のサンプルステートメントと新しいステートメントの比較待機時間、およびオプションで現在のサンプルステートメントの経過時間に基づきます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              待機時間に基づくリサンプリング: 新しいステートメントの待機時間が現在のサンプルステートメントの待機時間よりも長い場合は、現在のサンプルステートメントになります。
            </p></li><li class="listitem"><p>
              年齢に基づくリサンプリング: <code class="literal">performance_schema_max_digest_sample_age</code> システム変数の値がゼロより大きく、現在のサンプルステートメントが何秒以上経過している場合、現在のステートメントは<span class="quote">「<span class="quote">「古すぎます」</span>」</span>とみなされ、新しいステートメントで置き換えられます。 これは、新しいステートメントの待機時間が現在のサンプルステートメントの待機時間より短い場合でも発生します。 
            </p></li></ul></div><p>
          ステートメントサンプリングの詳細は、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="27.10 パフォーマンススキーマのステートメントダイジェストとサンプリング">セクション27.10「パフォーマンススキーマのステートメントダイジェストとサンプリング」</a> を参照してください。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_classes"></a>
          <code class="literal">performance_schema_max_file_classes</code>
        </p><a class="indexterm" name="idm45882603791408"></a><a class="indexterm" name="idm45882603789808"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_file_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-file-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">80</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          ファイルインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_handles"></a>
          <code class="literal">performance_schema_max_file_handles</code>
        </p><a class="indexterm" name="idm45882603756912"></a><a class="indexterm" name="idm45882603755312"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_file_handles"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-file-handles=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">32768</code></td>
</tr></tbody></table></div><p>
          オープンしているファイルオブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p><p>
          <code class="literal">performance_schema_max_file_handles</code> の値は、<code class="literal">open_files_limit</code> の値より大きくしてください。<code class="literal">open_files_limit</code> は、サーバーがサポート可能なオープンファイルハンドルの最大数に影響し、<code class="literal">performance_schema_max_file_handles</code> はこれらのファイルハンドルのうちインストゥルメント可能な数に影響します。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_instances"></a>
          <code class="literal">performance_schema_max_file_instances</code>
        </p><a class="indexterm" name="idm45882603724752"></a><a class="indexterm" name="idm45882603723152"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_file_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-file-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされるファイルオブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_index_stat"></a>
          <code class="literal">performance_schema_max_index_stat</code>
        </p><a class="indexterm" name="idm45882603697168"></a><a class="indexterm" name="idm45882603695568"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_index_stat"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-index-stat=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_index_stat">performance_schema_max_index_stat</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          パフォーマンススキーマが統計情報を保持するインデックスの最大数。 インデックス統計が失われるようにこの最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_index_stat_lost</code> ステータス変数を増分します。 デフォルト値は、<code class="literal">performance_schema_max_table_instances</code> の値を使用して自動サイズ設定されます。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_memory_classes"></a>
          <code class="literal">performance_schema_max_memory_classes</code>
        </p><a class="indexterm" name="idm45882603667920"></a><a class="indexterm" name="idm45882603666320"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_memory_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-memory-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_memory_classes">performance_schema_max_memory_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">450</code></td>
</tr></tbody></table></div><p>
          メモリーインストゥルメントの最大数 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_metadata_locks"></a>
          <code class="literal">performance_schema_max_metadata_locks</code>
        </p><a class="indexterm" name="idm45882603640752"></a><a class="indexterm" name="idm45882603639152"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_metadata_locks"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-metadata-locks=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_metadata_locks">performance_schema_max_metadata_locks</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          メタデータロックインストゥルメントの最大数。 この値は、<code class="literal">metadata_locks</code> テーブルのサイズを制御します。 メタデータロックを計測できないようにこの最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_metadata_lock_lost</code> ステータス変数を増分します。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_classes"></a>
          <code class="literal">performance_schema_max_mutex_classes</code>
        </p><a class="indexterm" name="idm45882603611616"></a><a class="indexterm" name="idm45882603610016"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_mutex_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-mutex-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値 (≥ 8.0.12)</th>
<td><code class="literal">300</code></td>
</tr><tr><th>デフォルト値 (8.0.11)</th>
<td><code class="literal">250</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          相互排他ロックインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_instances"></a>
          <code class="literal">performance_schema_max_mutex_instances</code>
        </p><a class="indexterm" name="idm45882603574640"></a><a class="indexterm" name="idm45882603573040"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_mutex_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-mutex-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされる相互排他ロックオブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_prepared_statements_instances"></a>
          <code class="literal">performance_schema_max_prepared_statements_instances</code>
        </p><a class="indexterm" name="idm45882603546928"></a><a class="indexterm" name="idm45882603545280"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_prepared_statements_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-prepared-statements-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_prepared_statements_instances">performance_schema_max_prepared_statements_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">prepared_statements_instances</code> テーブルの最大行数。 プリペアドステートメントを計測できないようにこの最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_prepared_statements_lost</code> ステータス変数を増分します。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p><p>
          この変数のデフォルト値は、<code class="literal">max_prepared_stmt_count</code> システム変数の値に基づいて自動サイズ設定されます。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_classes"></a>
          <code class="literal">performance_schema_max_rwlock_classes</code>
        </p><a class="indexterm" name="idm45882603515344"></a><a class="indexterm" name="idm45882603513824"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_rwlock_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-rwlock-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">60</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          rwlock インストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_program_instances"></a>
          <code class="literal">performance_schema_max_program_instances</code>
        </p><a class="indexterm" name="idm45882603480912"></a><a class="indexterm" name="idm45882603479312"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_program_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-program-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_program_instances">performance_schema_max_program_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          パフォーマンススキーマが統計情報を保持するストアドプログラムの最大数。 この最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_program_lost</code> ステータス変数を増分します。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_instances"></a>
          <code class="literal">performance_schema_max_rwlock_instances</code>
        </p><a class="indexterm" name="idm45882603452016"></a><a class="indexterm" name="idm45882603450416"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_rwlock_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-rwlock-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされる rwlock オブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_classes"></a>
          <code class="literal">performance_schema_max_socket_classes</code>
        </p><a class="indexterm" name="idm45882603424448"></a><a class="indexterm" name="idm45882603422848"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_socket_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-socket-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">10</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          ソケットインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_instances"></a>
          <code class="literal">performance_schema_max_socket_instances</code>
        </p><a class="indexterm" name="idm45882603389936"></a><a class="indexterm" name="idm45882603388336"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_socket_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-socket-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされるソケットオブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_sql_text_length"></a>
          <code class="literal">performance_schema_max_sql_text_length</code>
        </p><a class="indexterm" name="idm45882603362352"></a><a class="indexterm" name="idm45882603360752"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_sql_text_length"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-sql-text-length=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_sql_text_length">performance_schema_max_sql_text_length</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          SQL ステートメントの格納に使用される最大バイト数。 この値は、次のカラムに必要な記憶域に適用されます: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code> ステートメントイベントテーブルの <code class="literal">SQL_TEXT</code> カラム。
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルの <code class="literal">QUERY_SAMPLE_TEXT</code> カラム。
            </p></li></ul></div><p>
          <code class="literal">performance_schema_max_sql_text_length</code> を超えるバイトは破棄され、カラムには表示されません。 カラム内の初期バイト数が多くなった後にのみ異なるステートメントは区別できません。 
        </p><p>
          <code class="literal">performance_schema_max_sql_text_length</code> 値を減らすとメモリー使用量は減少しますが、末尾のみが異なる場合は、より多くのステートメントが区別できなくなります。 値を大きくするとメモリー使用量が増加しますが、長いステートメントを区別できます。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_stage_classes"></a>
          <code class="literal">performance_schema_max_stage_classes</code>
        </p><a class="indexterm" name="idm45882603318928"></a><a class="indexterm" name="idm45882603317328"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_stage_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-stage-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値 (≥ 8.0.13)</th>
<td><code class="literal">175</code></td>
</tr><tr><th>デフォルト値 (≤ 8.0.12)</th>
<td><code class="literal">150</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          ステージインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_statement_classes"></a>
          <code class="literal">performance_schema_max_statement_classes</code>
        </p><a class="indexterm" name="idm45882603281936"></a><a class="indexterm" name="idm45882603280336"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_statement_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-statement-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          ステートメントインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p><p>
          デフォルト値は、サーバー構築時に、クライアント/サーバープロトコルのコマンド数とサーバーでサポートされる SQL ステートメントの種類の数に基づいて計算されます。
        </p><p>
          この変数は、それを 0 に設定して、すべてのステートメントインストゥルメンテーションを無効にし、それに関連付けられているすべてのメモリーを節約しないかぎり、変更するべきではありません。 変数をデフォルトでない 0 以外の値に設定してもメリットはありません。特にデフォルトより大きい値は、必要以上のメモリーが割り当てられます。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_statement_stack"></a>
          <code class="literal">performance_schema_max_statement_stack</code>
        </p><a class="indexterm" name="idm45882603252432"></a><a class="indexterm" name="idm45882603250832"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_statement_stack"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-statement-stack=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_stack">performance_schema_max_statement_stack</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">10</code></td>
</tr></tbody></table></div><p>
          パフォーマンススキーマが統計を保持するネストされたストアドプログラムコールの最大深度。 この最大値を超えると、パフォーマンススキーマはストアドプログラムステートメントが実行されるたびに <code class="literal">Performance_schema_nested_statement_lost</code> ステータス変数を増分します。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_handles"></a>
          <code class="literal">performance_schema_max_table_handles</code>
        </p><a class="indexterm" name="idm45882603224592"></a><a class="indexterm" name="idm45882603222992"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_table_handles"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-table-handles=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          オープンしているテーブルオブジェクトの最大数。 この値は、<code class="literal">table_handles</code> テーブルのサイズを制御します。 テーブルハンドルを計測できないようにこの最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_table_handles_lost</code> ステータス変数を増分します。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_instances"></a>
          <code class="literal">performance_schema_max_table_instances</code>
        </p><a class="indexterm" name="idm45882603194656"></a><a class="indexterm" name="idm45882603193056"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_table_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-table-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされるテーブルオブジェクトの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_lock_stat"></a>
          <code class="literal">performance_schema_max_table_lock_stat</code>
        </p><a class="indexterm" name="idm45882603167072"></a><a class="indexterm" name="idm45882603165472"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_table_lock_stat"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-table-lock-stat=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_lock_stat">performance_schema_max_table_lock_stat</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          パフォーマンススキーマがロック統計を保持するテーブルの最大数。 テーブルロック統計が失われるようにこの最大値を超えると、パフォーマンススキーマは <code class="literal">Performance_schema_table_lock_stat_lost</code> ステータス変数を増分します。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_classes"></a>
          <code class="literal">performance_schema_max_thread_classes</code>
        </p><a class="indexterm" name="idm45882603139040"></a><a class="indexterm" name="idm45882603137440"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_thread_classes"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-thread-classes=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">100</code></td>
</tr><tr><th>最小値</th>
<td><code class="literal">0</code></td>
</tr><tr><th>最大値 (≥ 8.0.12)</th>
<td><code class="literal">1024</code></td>
</tr><tr><th>最大値 (8.0.11)</th>
<td><code class="literal">256</code></td>
</tr></tbody></table></div><p>
          スレッドインストゥルメントの最大数。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_instances"></a>
          <code class="literal">performance_schema_max_thread_instances</code>
        </p><a class="indexterm" name="idm45882603104592"></a><a class="indexterm" name="idm45882603102992"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_max_thread_instances"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-max-thread-instances=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          インストゥルメントされるスレッドオブジェクトの最大数。 この値は <code class="literal">threads</code> テーブルのサイズを制御します。 この最大を超えたため、スレッドをインストゥルメントできない場合、パフォーマンススキーマは <code class="literal">Performance_schema_thread_instances_lost</code> ステータス変数を増分します。 この変数の設定方法および使用方法の詳細は、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a> を参照してください。 
        </p><p>
          <code class="literal">max_connections</code> システム変数は、サーバーで実行できるスレッドの数に影響します。<code class="literal">performance_schema_max_thread_instances</code> は、これらの実行中のスレッドのうちインストゥルメントできる数に影響します。
        </p><p>
          <code class="literal">variables_by_thread</code> テーブルおよび <code class="literal">status_by_thread</code> テーブルには、フォアグラウンドスレッドに関するシステム変数およびステータス変数の情報のみが含まれます。 すべてのスレッドがパフォーマンススキーマによって計測されるわけではない場合、このテーブルにはいくつかの行がありません。 この場合、<code class="literal">Performance_schema_thread_instances_lost</code> ステータス変数はゼロより大きくなります。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_session_connect_attrs_size"></a>
          <code class="literal">performance_schema_session_connect_attrs_size</code>
        </p><a class="indexterm" name="idm45882603067776"></a><a class="indexterm" name="idm45882603066160"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_session_connect_attrs_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-session-connect-attrs-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動サイズ設定を示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最小値</th>
<td><code class="literal">-1</code></td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          接続属性のキーと値のペアを保持するために予約されているスレッド当たりの事前割当て済メモリーの量。 クライアントによって送信される接続属性データの集約サイズがこの量より大きい場合、パフォーマンススキーマは属性データを切り捨て、<code class="literal">Performance_schema_session_connect_attrs_lost</code> ステータス変数を増分して、<code class="literal">log_error_verbosity</code> システム変数が 1 より大きい場合に切り捨てが発生したことを示すメッセージをエラーログに書き込みます。 <code class="literal">_truncated</code> 属性は、属性バッファに十分な領域がある場合、失われたバイト数を示す値とともにセッション属性にも追加されます。 これにより、パフォーマンススキーマは接続属性テーブルで接続ごとの切り捨て情報を公開できます。 この情報は、エラーログを確認せずに調べることができます。 
        </p><p>
          <code class="literal">performance_schema_session_connect_attrs_size</code> のデフォルト値は、サーバーの起動時に自動サイズ設定されます。 この値は小さい場合があるため、切捨て (<code class="literal">Performance_schema_session_connect_attrs_lost</code> がゼロ以外になる) が発生した場合は、<code class="literal">performance_schema_session_connect_attrs_size</code> を明示的に大きい値に設定することをお薦めします。 
        </p><p>
          最大許容 <code class="literal">performance_schema_session_connect_attrs_size</code> 値は 1MB ですが、サーバーは受け入れる接続属性データの集計サイズに 64KB の制限を課すため、有効な最大値は 64KB です。 クライアントが 64KB を超える属性データを送信しようとすると、サーバーは接続を拒否します。 詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="27.12.9 パフォーマンススキーマ接続属性テーブル">セクション27.12.9「パフォーマンススキーマ接続属性テーブル」</a>を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_actors_size"></a>
          <code class="literal">performance_schema_setup_actors_size</code>
        </p><a class="indexterm" name="idm45882603025104"></a><a class="indexterm" name="idm45882603023504"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_setup_actors_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-setup-actors-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">setup_actors</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_objects_size"></a>
          <code class="literal">performance_schema_setup_objects_size</code>
        </p><a class="indexterm" name="idm45882602997600"></a><a class="indexterm" name="idm45882602996000"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_setup_objects_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-setup-objects-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr></tbody></table></div><p>
          <code class="literal">setup_objects</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_show_processlist"></a>
          <code class="literal">performance_schema_show_processlist</code>
        </p><a class="indexterm" name="idm45882602970032"></a><a class="indexterm" name="idm45882602968432"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_show_processlist"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-show-processlist[={OFF|ON}]</code></td>
</tr><tr><th>導入</th>
<td>8.0.22</td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_show_processlist">performance_schema_show_processlist</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>はい</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Boolean</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">OFF</code></td>
</tr></tbody></table></div><p>
          <code class="literal">SHOW PROCESSLIST</code> ステートメントは、すべてのアクティブスレッドからスレッドデータを収集することで、プロセス情報を提供します。 <code class="literal">performance_schema_show_processlist</code> 変数は、使用する <code class="literal">SHOW PROCESSLIST</code> 実装を決定します: 
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              デフォルトの実装は、グローバル mutex を保持しながら、スレッドマネージャ内からアクティブスレッド間で繰り返されます。 これは、特にビジー状態のシステムではパフォーマンスに悪影響を及ぼします。 
            </p></li><li class="listitem"><p>
              代替の <code class="literal">SHOW PROCESSLIST</code> 実装は、パフォーマンススキーマ <code class="literal">processlist</code> テーブルに基づいています。 この実装は、スレッドマネージャーではなくパフォーマンススキーマからアクティブなスレッドデータをクエリーするため、mutex は必要ありません。 
            </p></li></ul></div><p>
          代替実装を有効にするには、<code class="literal">performance_schema_show_processlist</code> システム変数を有効にします。 デフォルトおよび代替の実装で同じ情報が得られるようにするには、特定の構成要件を満たす必要があります。<a class="xref" href="performance-schema.html#performance-schema-processlist-table" title="27.12.19.9 processlist テーブル">セクション27.12.19.9「processlist テーブル」</a> を参照してください。 
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_users_size"></a>
          <code class="literal">performance_schema_users_size</code>
        </p><a class="indexterm" name="idm45882602931056"></a><a class="indexterm" name="idm45882602929488"></a><div class="informaltable"><table frame="box" rules="all" summary="Properties for performance_schema_users_size"><col width="30%"><col width="70%"><tbody><tr><th>コマンド行形式</th>
<td><code class="literal">--performance-schema-users-size=#</code></td>
</tr><tr><th>システム変数</th>
<td><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></code></td>
</tr><tr><th>スコープ</th>
<td>グローバル</td>
</tr><tr><th>動的</th>
<td>いいえ</td>
</tr><tr><th><code class="literal">SET_VAR</code> ヒントの適用</th>
<td>いいえ</td>
</tr><tr><th>型</th>
<td>Integer</td>
</tr><tr><th>デフォルト値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最小値</th>
<td><code class="literal">-1</code> (自動スケーリングを示します。このリテラル値を割り当てないでください)</td>
</tr><tr><th>最大値</th>
<td><code class="literal">1048576</code></td>
</tr></tbody></table></div><p>
          <code class="literal">users</code> テーブル内の行数。 この変数が 0 の場合、パフォーマンススキーマは <code class="literal">users</code> テーブル内の接続統計情報または <code class="literal">status_by_user</code> テーブル内のステータス変数情報を保持しません。 
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-status-variables"></a>27.16 パフォーマンススキーマステータス変数</h2></div></div></div><p>
      パフォーマンススキーマは、メモリー制約のためロードまたは作成できなかったインストゥルメンテーションついての情報を提供するいくつかのステータス変数を実装しています。
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-------------------------------------------+-------+
| Variable_name                             | Value |
+-------------------------------------------+-------+
| Performance_schema_accounts_lost          | 0     |
| Performance_schema_cond_classes_lost      | 0     |
| Performance_schema_cond_instances_lost    | 0     |
| Performance_schema_file_classes_lost      | 0     |
| Performance_schema_file_handles_lost      | 0     |
| Performance_schema_file_instances_lost    | 0     |
| Performance_schema_hosts_lost             | 0     |
| Performance_schema_locker_lost            | 0     |
| Performance_schema_mutex_classes_lost     | 0     |
| Performance_schema_mutex_instances_lost   | 0     |
| Performance_schema_rwlock_classes_lost    | 0     |
| Performance_schema_rwlock_instances_lost  | 0     |
| Performance_schema_socket_classes_lost    | 0     |
| Performance_schema_socket_instances_lost  | 0     |
| Performance_schema_stage_classes_lost     | 0     |
| Performance_schema_statement_classes_lost | 0     |
| Performance_schema_table_handles_lost     | 0     |
| Performance_schema_table_instances_lost   | 0     |
| Performance_schema_thread_classes_lost    | 0     |
| Performance_schema_thread_instances_lost  | 0     |
| Performance_schema_users_lost             | 0     |
+-------------------------------------------+-------+
</pre><p>
      これらの変数を使用して、パフォーマンススキーマのステータスをチェックすることについては、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a>を参照してください。
    </p><p>
      パフォーマンススキーマステータス変数には次の意味があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="statvar_Performance_schema_accounts_lost"></a>
          <code class="literal">Performance_schema_accounts_lost</code>
        </p><a class="indexterm" name="idm45882602887152"></a><a class="indexterm" name="idm45882602885552"></a><p>
          <code class="literal">accounts</code> テーブルがいっぱいであったため、行を追加できなかった回数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_classes_lost"></a>
          <code class="literal">Performance_schema_cond_classes_lost</code>
        </p><a class="indexterm" name="idm45882602879888"></a><a class="indexterm" name="idm45882602878288"></a><p>
          ロードできなかった条件インストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_instances_lost"></a>
          <code class="literal">Performance_schema_cond_instances_lost</code>
        </p><a class="indexterm" name="idm45882602873568"></a><a class="indexterm" name="idm45882602871952"></a><p>
          作成できなかった条件インストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_digest_lost"></a>
          <code class="literal">Performance_schema_digest_lost</code>
        </p><a class="indexterm" name="idm45882602867296"></a><a class="indexterm" name="idm45882602865696"></a><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルにインストゥルメントできなかったダイジェストインスタンスの数。 <code class="literal">performance_schema_digests_size</code> の値が小さすぎる場合、これは 0 以外になることがあります。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_classes_lost"></a>
          <code class="literal">Performance_schema_file_classes_lost</code>
        </p><a class="indexterm" name="idm45882602858752"></a><a class="indexterm" name="idm45882602857152"></a><p>
          ロードできなかったファイルインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_handles_lost"></a>
          <code class="literal">Performance_schema_file_handles_lost</code>
        </p><a class="indexterm" name="idm45882602852416"></a><a class="indexterm" name="idm45882602850816"></a><p>
          オープンできなかったファイルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_instances_lost"></a>
          <code class="literal">Performance_schema_file_instances_lost</code>
        </p><a class="indexterm" name="idm45882602845968"></a><a class="indexterm" name="idm45882602844352"></a><p>
          作成できなかったファイルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_hosts_lost"></a>
          <code class="literal">Performance_schema_hosts_lost</code>
        </p><a class="indexterm" name="idm45882602839680"></a><a class="indexterm" name="idm45882602838096"></a><p>
          <code class="literal">hosts</code> テーブルがいっぱいであったため、行を追加できなかった回数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_index_stat_lost"></a>
          <code class="literal">Performance_schema_index_stat_lost</code>
        </p><a class="indexterm" name="idm45882602832304"></a><a class="indexterm" name="idm45882602830704"></a><p>
          統計が失われたインデックスの数。 <code class="literal">performance_schema_max_index_stat</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_locker_lost"></a>
          <code class="literal">Performance_schema_locker_lost</code>
        </p><a class="indexterm" name="idm45882602824944"></a><a class="indexterm" name="idm45882602823344"></a><p>
          次の状況のため、<span class="quote">「<span class="quote">失われる</span>」</span>か記録されないイベント数。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              イベントが再帰的です (たとえば、A を待機することによって B で待機が発生し、それによって C で待機が発生したなど)。
            </p></li><li class="listitem"><p>
              ネストしたイベントスタックの深さが、実装によって課せられる制限より大きいです。
            </p></li></ul></div><p>
          パフォーマンススキーマによって記録されるイベントは再帰的ではないため、この変数は常に 0 であるべきです。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_memory_classes_lost"></a>
          <code class="literal">Performance_schema_memory_classes_lost</code>
        </p><a class="indexterm" name="idm45882602814752"></a><a class="indexterm" name="idm45882602813136"></a><p>
          メモリーインストゥルメントをロードできなかった回数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_metadata_lock_lost"></a>
          <code class="literal">Performance_schema_metadata_lock_lost</code>
        </p><a class="indexterm" name="idm45882602808400"></a><a class="indexterm" name="idm45882602806800"></a><p>
          <code class="literal">metadata_locks</code> テーブルでインストゥルメントできなかったメタデータロックの数。 <code class="literal">performance_schema_max_metadata_locks</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_classes_lost"></a>
          <code class="literal">Performance_schema_mutex_classes_lost</code>
        </p><a class="indexterm" name="idm45882602799952"></a><a class="indexterm" name="idm45882602798352"></a><p>
          ロードできなかった相互排他ロックインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_instances_lost"></a>
          <code class="literal">Performance_schema_mutex_instances_lost</code>
        </p><a class="indexterm" name="idm45882602793536"></a><a class="indexterm" name="idm45882602791920"></a><p>
          作成できなかった相互排他ロックインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_nested_statement_lost"></a>
          <code class="literal">Performance_schema_nested_statement_lost</code>
        </p><a class="indexterm" name="idm45882602787184"></a><a class="indexterm" name="idm45882602785568"></a><p>
          統計が失われたストアドプログラムステートメントの数。 <code class="literal">performance_schema_max_statement_stack</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_prepared_statements_lost"></a>
          <code class="literal">Performance_schema_prepared_statements_lost</code>
        </p><a class="indexterm" name="idm45882602779552"></a><a class="indexterm" name="idm45882602777936"></a><p>
          <code class="literal">prepared_statements_instances</code> テーブルでインストゥルメントできなかったプリペアドステートメントの数。 <code class="literal">performance_schema_max_prepared_statements_instances</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_program_lost"></a>
          <code class="literal">Performance_schema_program_lost</code>
        </p><a class="indexterm" name="idm45882602771040"></a><a class="indexterm" name="idm45882602769440"></a><p>
          統計が失われたストアドプログラムの数。 <code class="literal">performance_schema_max_program_instances</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_classes_lost"></a>
          <code class="literal">Performance_schema_rwlock_classes_lost</code>
        </p><a class="indexterm" name="idm45882602763424"></a><a class="indexterm" name="idm45882602761808"></a><p>
          ロードできなかった rwlock インストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_instances_lost"></a>
          <code class="literal">Performance_schema_rwlock_instances_lost</code>
        </p><a class="indexterm" name="idm45882602757136"></a><a class="indexterm" name="idm45882602755520"></a><p>
          作成できなかった rwlock インストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_session_connect_attrs_longest_seen"></a>
          <code class="literal">Performance_schema_session_connect_attrs_longest_seen</code>
        </p><a class="indexterm" name="idm45882602750608"></a><a class="indexterm" name="idm45882602748960"></a><p>
          <code class="literal">performance_schema_session_connect_attrs_size</code> システム変数の値に対してパフォーマンススキーマによって実行される接続属性 size-limit チェックに加えて、サーバーは事前チェックを実行し、受け入れる接続属性データの集約サイズに 64KB の制限を課します。 クライアントが 64KB を超える属性データを送信しようとすると、サーバーは接続を拒否します。 それ以外の場合、サーバーは属性バッファが有効であるとみなし、<code class="literal">Performance_schema_session_connect_attrs_longest_seen</code> ステータス変数で最も長いバッファのサイズを追跡します。 この値が <code class="literal">performance_schema_session_connect_attrs_size</code> より大きい場合、DBA は後者の値を増やすことも、大量の属性データを送信しているクライアントを調査することもできます。 
        </p><p>
          接続属性の詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="27.12.9 パフォーマンススキーマ接続属性テーブル">セクション27.12.9「パフォーマンススキーマ接続属性テーブル」</a> を参照してください。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_session_connect_attrs_lost"></a>
          <code class="literal">Performance_schema_session_connect_attrs_lost</code>
        </p><a class="indexterm" name="idm45882602738912"></a><a class="indexterm" name="idm45882602737280"></a><p>
          接続属性の切捨てが発生した接続の数。 特定の接続について、クライアントが、集約サイズが <code class="literal">performance_schema_session_connect_attrs_size</code> システム変数の値で許可されている予約済みストレージより大きい接続属性のキーと値のペアを送信した場合、パフォーマンススキーマは属性データを切り捨て、<code class="literal">Performance_schema_session_connect_attrs_lost</code> を増分します。 この値がゼロ以外の場合は、<code class="literal">performance_schema_session_connect_attrs_size</code> を大きい値に設定できます。 
        </p><p>
          接続属性の詳細は、<a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="27.12.9 パフォーマンススキーマ接続属性テーブル">セクション27.12.9「パフォーマンススキーマ接続属性テーブル」</a> を参照してください。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_classes_lost"></a>
          <code class="literal">Performance_schema_socket_classes_lost</code>
        </p><a class="indexterm" name="idm45882602727392"></a><a class="indexterm" name="idm45882602725856"></a><p>
          ロードできなかったソケットインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_instances_lost"></a>
          <code class="literal">Performance_schema_socket_instances_lost</code>
        </p><a class="indexterm" name="idm45882602721104"></a><a class="indexterm" name="idm45882602719488"></a><p>
          作成できなかったソケットインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_stage_classes_lost"></a>
          <code class="literal">Performance_schema_stage_classes_lost</code>
        </p><a class="indexterm" name="idm45882602714560"></a><a class="indexterm" name="idm45882602712960"></a><p>
          ロードできなかったステージインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_statement_classes_lost"></a>
          <code class="literal">Performance_schema_statement_classes_lost</code>
        </p><a class="indexterm" name="idm45882602708208"></a><a class="indexterm" name="idm45882602706592"></a><p>
          ロードできなかったステートメントインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_handles_lost"></a>
          <code class="literal">Performance_schema_table_handles_lost</code>
        </p><a class="indexterm" name="idm45882602701680"></a><a class="indexterm" name="idm45882602700080"></a><p>
          オープンできなかったテーブルインストゥルメントインスタンスの数。 <code class="literal">performance_schema_max_table_handles</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_instances_lost"></a>
          <code class="literal">Performance_schema_table_instances_lost</code>
        </p><a class="indexterm" name="idm45882602694064"></a><a class="indexterm" name="idm45882602692448"></a><p>
          作成できなかったテーブルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_lock_stat_lost"></a>
          <code class="literal">Performance_schema_table_lock_stat_lost</code>
        </p><a class="indexterm" name="idm45882602687680"></a><a class="indexterm" name="idm45882602686064"></a><p>
          ロック統計が失われたテーブルの数。 <code class="literal">performance_schema_max_table_lock_stat</code> の値が小さすぎる場合は、ゼロ以外にすることができます。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_classes_lost"></a>
          <code class="literal">Performance_schema_thread_classes_lost</code>
        </p><a class="indexterm" name="idm45882602680144"></a><a class="indexterm" name="idm45882602678528"></a><p>
          ロードできなかったスレッドインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_instances_lost"></a>
          <code class="literal">Performance_schema_thread_instances_lost</code>
        </p><a class="indexterm" name="idm45882602673840"></a><a class="indexterm" name="idm45882602672224"></a><p>
          <code class="literal">threads</code> テーブルにインストゥルメントできなかったスレッドインスタンスの数。 <code class="literal">performance_schema_max_thread_instances</code> の値が小さすぎる場合、これは 0 以外になることがあります。 
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_users_lost"></a>
          <code class="literal">Performance_schema_users_lost</code>
        </p><a class="indexterm" name="idm45882602665296"></a><a class="indexterm" name="idm45882602663712"></a><p>
          <code class="literal">users</code> テーブルがいっぱいであったため、行を追加できなかった回数。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-memory-model"></a>27.17 パフォーマンススキーマのメモリー割り当てモデル</h2></div></div></div><p>
      パフォーマンススキーマは、次のメモリー割り当てモデルを使用します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          サーバー起動時にメモリーを割り当てることができます
        </p></li><li class="listitem"><p>
          サーバー操作中に追加のメモリーを割り当てることができます
        </p></li><li class="listitem"><p>
          サーバー操作中にメモリーを解放しないでください (ただし、リサイクルされている可能性があります)
        </p></li><li class="listitem"><p>
          シャットダウン時に使用されたすべてのメモリーを解放
        </p></li></ul></div><p>
      その結果、パフォーマンススキーマを少ない構成で使用できるようにメモリー制約が緩和され、サーバー負荷で消費量がスケーリングされるようにメモリーフットプリントが減少します。 使用されるメモリーは、見積もられた負荷や明示的に構成された負荷ではなく、実際に見られる負荷によって異なります。 
    </p><p>
      いくつかのパフォーマンススキーマのサイズ変更パラメータは自動調整されるため、メモリー割り当ての明示的な制限を確立しないかぎり、明示的に構成する必要はありません:
    </p><pre class="programlisting">performance_schema_accounts_size
performance_schema_hosts_size
performance_schema_max_cond_instances
performance_schema_max_file_instances
performance_schema_max_index_stat
performance_schema_max_metadata_locks
performance_schema_max_mutex_instances
performance_schema_max_prepared_statements_instances
performance_schema_max_program_instances
performance_schema_max_rwlock_instances
performance_schema_max_socket_instances
performance_schema_max_table_handles
performance_schema_max_table_instances
performance_schema_max_table_lock_stat
performance_schema_max_thread_instances
performance_schema_users_size
</pre><p>
      自動スケールパラメータの場合、構成は次のように機能します:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          値を -1 (デフォルト) に設定すると、パラメータは自動スケールされます:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              対応する内部バッファは最初は空で、メモリーは割り当てられません。
            </p></li><li class="listitem"><p>
              パフォーマンススキーマがデータを収集すると、対応するバッファーにメモリーが割り当てられます。 バッファサイズは無制限で、負荷に伴って大きくなる可能性があります。 
            </p></li></ul></div></li><li class="listitem"><p>
          値を 0 に設定した場合:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              対応する内部バッファは最初は空で、メモリーは割り当てられません。
            </p></li></ul></div></li><li class="listitem"><p>
          値が <em class="replaceable"><code>N</code></em> &gt; 0 に設定されている場合:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              対応する内部バッファは最初は空で、メモリーは割り当てられません。
            </p></li><li class="listitem"><p>
              パフォーマンススキーマがデータを収集すると、バッファーサイズが <em class="replaceable"><code>N</code></em> に達するまで、対応するバッファーにメモリーが割り当てられます。
            </p></li><li class="listitem"><p>
              バッファサイズが <em class="replaceable"><code>N</code></em> に達すると、メモリーはこれ以上割り当てられません。 このバッファーのパフォーマンススキーマによって収集されたデータは失われ、対応する<span class="quote">「<span class="quote">「失われたインスタンス」</span>」</span>カウンタは増分されます。 
            </p></li></ul></div></li></ul></div><p>
      パフォーマンススキーマが使用しているメモリー量を確認するには、その目的に合わせて設計されたインストゥルメントを確認します。 パフォーマンススキーマはメモリーを内部的に割り当て、各バッファーを専用インストゥルメントに関連付けて、メモリー消費を個々のバッファーにトレースできるようにします。 接頭辞 <code class="literal">memory/performance_schema/</code>で指定されたインストゥルメントは、これらの内部バッファに割り当てられているメモリー量を公開します。 バッファはサーバーに対してグローバルであるため、インストゥルメントは <code class="literal">memory_summary_global_by_event_name</code> テーブルにのみ表示され、他の <code class="literal">memory_summary_by_<em class="replaceable"><code>xxx</code></em>_by_event_name</code> テーブルには表示されません。 
    </p><p>
      このクエリーは、メモリーインストルメントに関連付けられた情報を表示します:
    </p><pre class="programlisting">SELECT * FROM performance_schema.memory_summary_global_by_event_name
WHERE EVENT_NAME LIKE 'memory/performance_schema/%';
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-and-plugins"></a>27.18 パフォーマンススキーマとプラグイン</h2></div></div></div><p>
      <code class="literal">UNINSTALL PLUGIN</code> によってプラグインを削除することは、そのプラグインのコードですでに収集された情報には影響しません。 プラグインのロード中にコードの実行に費やされた時間は、プラグインがあとでアンロードされた場合でも費やされます。 集計情報を含む関連付けられたイベント情報は、<code class="literal">performance_schema</code> データベーステーブルで読み取り可能なままになります。 プラグインのインストールと削除の効果の追加情報については、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="27.7 パフォーマンススキーマステータスモニタリング">セクション27.7「パフォーマンススキーマステータスモニタリング」</a>を参照してください。 
    </p><p>
      プラグインコードをインストゥルメントするプラグイン実装者は、プラグインをロードするユーザーがその要件を把握できるように、インストゥルメンテーションの特性をドキュメント化してください。 たとえば、サードパーティーストレージエンジンでは、そのドキュメントに、エンジンが相互排他ロックおよびその他のインストゥルメントに必要とするメモリーの量を記載してください。 
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-examples"></a>27.19 問題を診断するためのパフォーマンススキーマの使用</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-query-profiling">27.19.1 パフォーマンススキーマを使用したクエリープロファイリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-obtaining-parent-events">27.19.2 親イベント情報の取得</a></span></dt></dl></div><a class="indexterm" name="idm45882602623216"></a><a class="indexterm" name="idm45882602620976"></a><p>
      パフォーマンススキーマは、DBA が<span class="quote">「<span class="quote">大まかな推量</span>」</span>ではなく、実際に測定して、パフォーマンスのチューニングを行うのに役立つツールです。 このセクションでは、この目的でパフォーマンススキーマを使用するいくつかの方法について説明します。 ここでの説明は、<a class="xref" href="performance-schema.html#performance-schema-filtering" title="27.4.2 パフォーマンススキーマイベントフィルタリング">セクション27.4.2「パフォーマンススキーマイベントフィルタリング」</a>で説明しているイベントフィルタリングの使用に依存します。 
    </p><p>
      次の例では、パフォーマンスボトルネックの調査など、反復される問題の分析に使用できる 1 つの方法を示しています。 開始するには、パフォーマンスが<span class="quote">「<span class="quote">遅すぎる</span>」</span>とみなされ、最適化が必要な反復可能なユースケースが必要であり、すべてのインストゥルメンテーションを有効にすべきです (事前フィルタリングなし)。 
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          ユースケースを実行します。
        </p></li><li class="listitem"><p>
          パフォーマンススキーマテーブルを使用して、パフォーマンスの問題の原因を分析します。 この分析は、フィルタリング後に大きく依存します。 
        </p></li><li class="listitem"><p>
          除外する問題領域については、対応するインストゥルメントを無効にします。 たとえば、問題が特定のストレージエンジンのファイル I/O に関連していないことが分析に示されている場合、そのエンジンのファイル I/O インストゥルメントを無効にします。 次に、履歴およびサマリーテーブルを切り捨て、これまでに収集されたイベントを削除します。 
        </p></li><li class="listitem"><p>
          ステップ 1 のプロセスを繰り返します。
        </p><p>
          反復のたびに、パフォーマンススキーマの出力 (特に <code class="literal">events_waits_history_long</code> テーブル) に含まれる<span class="quote">「<span class="quote">「ノイズ」</span>」</span>の数が少なく、重要でないインストゥルメントによって発生する<span class="quote">「<span class="quote">「ノイズ」</span>」</span>が少なくなり、このテーブルのサイズが固定されている場合は、手動での問題の分析に関連するより多くのデータが含まれます。
        </p><p>
          <span class="quote">「<span class="quote">signal/noise</span>」</span> 比率が改善され、分析が容易になるため、反復ごとに調査が問題の根本原因に近づいて近づく必要があります。
        </p></li><li class="listitem"><p>
          パフォーマンスボトルネックの原因を突き止めたら、次のような適切な修正措置をとります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              サーバーパラメータ (キャッシュサイズ、メモリーなど) をチューニングします。
            </p></li><li class="listitem"><p>
              クエリーを違う方法で書いてチューニングします。
            </p></li><li class="listitem"><p>
              データベーススキーマ (テーブル、インデックスなど) をチューニングします。
            </p></li><li class="listitem"><p>
              コードをチューニングします (これはストレージエンジンまたはサーバー開発者のみに適用されます)。
            </p></li></ul></div></li><li class="listitem"><p>
          ステップ 1 から再開して、パフォーマンスへの変更の効果を確認します。
        </p></li></ol></div><p>
      <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> および <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code> カラムは、パフォーマンスボトルネックまたはデッドロックの調査にきわめて重要です。 これは、次のようなパフォーマンススキーマインストゥルメンテーションによって可能になります。 
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          スレッド 1 は相互排他ロックを待機してスタックしているとします。
        </p></li><li class="listitem"><p>
          スレッドが何を待機しているかを特定できます。
        </p><pre class="programlisting">SELECT * FROM performance_schema.events_waits_current
WHERE THREAD_ID = <em class="replaceable"><code>thread_1</code></em>;
</pre><p>
          たとえば、<code class="literal">events_waits_current.OBJECT_INSTANCE_BEGIN</code> にあるように、スレッドが相互排他ロック A を待機していることがクエリー結果に示されます。
        </p></li><li class="listitem"><p>
          相互排他ロック A を保持しているスレッドを特定できます。
        </p><pre class="programlisting">SELECT * FROM performance_schema.mutex_instances
WHERE OBJECT_INSTANCE_BEGIN = <em class="replaceable"><code>mutex_A</code></em>;
</pre><p>
          たとえば、<code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> にあるように、相互排他ロック A を保持しているのがスレッド 2 であることがクエリー結果に示されます。
        </p></li><li class="listitem"><p>
          スレッド 2 が何を実行しているかを確認できます。
        </p><pre class="programlisting">SELECT * FROM performance_schema.events_waits_current
WHERE THREAD_ID = <em class="replaceable"><code>thread_2</code></em>;
</pre></li></ol></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-query-profiling"></a>27.19.1 パフォーマンススキーマを使用したクエリープロファイリング</h3></div></div></div><p>
        次の例は、パフォーマンススキーマのステートメントイベントとステージイベントを使用して、<code class="literal">SHOW PROFILES</code> および <code class="literal">SHOW PROFILE</code> ステートメントによって提供されるプロファイリング情報と同等のデータを取得する方法を示しています。
      </p><p>
        <code class="literal">setup_actors</code> テーブルを使用すると、ホスト、ユーザーまたはアカウントごとに履歴イベントの収集を制限して、実行時のオーバーヘッドおよび履歴テーブルに収集されるデータ量を減らすことができます。 例の最初のステップは、履歴イベントの収集を特定のユーザーに制限する方法を示しています。 
      </p><p>
        パフォーマンススキーマは、タイミングデータを標準単位に正規化するために、イベントタイマー情報をピコ秒 (1 秒に 1 兆) で表示します。 次の例では、<code class="literal">TIMER_WAIT</code> 値を 1000000000000 で除算して、データを秒単位で表示します。 また、値は小数点以下 6 桁に切り捨てられ、<code class="literal">SHOW PROFILES</code> および <code class="literal">SHOW PROFILE</code> ステートメントと同じ形式でデータが表示されます。 
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            履歴イベントの収集を、クエリーを実行するユーザーに制限します。 デフォルトでは、<code class="literal">setup_actors</code> は、すべてのフォアグラウンドスレッドのモニタリングおよび履歴イベント収集を許可するように構成されています: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_actors;</code></strong>
+------+------+------+---------+---------+
| HOST | USER | ROLE | ENABLED | HISTORY |
+------+------+------+---------+---------+
| %    | %    | %    | YES     | YES     |
+------+------+------+---------+---------+
</pre><p>
            <code class="literal">setup_actors</code> テーブルのデフォルト行を更新して、すべてのフォアグラウンドスレッドの履歴イベント収集および監視を無効にし、クエリーを実行するユーザーの監視および履歴イベント収集を有効にする新しい行を挿入します:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_actors</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'NO', HISTORY = 'NO'</code></strong>
       <strong class="userinput"><code>WHERE HOST = '%' AND USER = '%';</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO performance_schema.setup_actors</code></strong>
       <strong class="userinput"><code>(HOST,USER,ROLE,ENABLED,HISTORY)</code></strong>
       <strong class="userinput"><code>VALUES('localhost','test_user','%','YES','YES');</code></strong>
</pre><p>
            これで、<code class="literal">setup_actors</code> テーブルのデータは次のようになります:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_schema.setup_actors;</code></strong>
+-----------+-----------+------+---------+---------+
| HOST      | USER      | ROLE | ENABLED | HISTORY |
+-----------+-----------+------+---------+---------+
| %         | %         | %    | NO      | NO      |
| localhost | test_user | %    | YES     | YES     |
+-----------+-----------+------+---------+---------+
</pre></li><li class="listitem"><p>
            <code class="literal">setup_instruments</code> テーブルを更新して、ステートメントおよびステージインストゥルメンテーションが有効になっていることを確認します。 一部のインストゥルメントは、デフォルトですでに有効になっている場合があります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%statement/%';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_instruments</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%stage/%';</code></strong>
</pre></li><li class="listitem"><p>
            <code class="literal">events_statements_*</code> および <code class="literal">events_stages_*</code> コンシューマが有効になっていることを確認します。 一部のコンシューマは、デフォルトですでに有効になっている場合があります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES'</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%events_statements_%';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE performance_schema.setup_consumers</code></strong>
       <strong class="userinput"><code>SET ENABLED = 'YES'</code></strong>
       <strong class="userinput"><code>WHERE NAME LIKE '%events_stages_%';</code></strong>
</pre></li><li class="listitem"><p>
            監視しているユーザーアカウントで、プロファイリングするステートメントを実行します。 例: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM employees.employees WHERE emp_no = 10001;</code></strong>
+--------+------------+------------+-----------+--------+------------+
| emp_no | birth_date | first_name | last_name | gender | hire_date |
+--------+------------+------------+-----------+--------+------------+
|  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |
+--------+------------+------------+-----------+--------+------------+
</pre></li><li class="listitem"><p>
            <code class="literal">events_statements_history_long</code> テーブルをクエリーして、ステートメントの <code class="literal">EVENT_ID</code> を識別します。 このステップは、<code class="literal">Query_ID</code> を識別するための <code class="literal">SHOW PROFILES</code> の実行に似ています。 次のクエリーでは、<code class="literal">SHOW PROFILES</code> のような出力が生成されます: 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EVENT_ID, TRUNCATE(TIMER_WAIT/1000000000000,6) as Duration, SQL_TEXT
       FROM performance_schema.events_statements_history_long WHERE SQL_TEXT like '%10001%';</code></strong>
+----------+----------+--------------------------------------------------------+
| event_id | duration | sql_text                                               |
+----------+----------+--------------------------------------------------------+
|       31 | 0.028310 | SELECT * FROM employees.employees WHERE emp_no = 10001 |
+----------+----------+--------------------------------------------------------+
</pre></li><li class="listitem"><p>
            <code class="literal">events_stages_history_long</code> テーブルをクエリーして、ステートメントステージイベントを取得します。 ステージは、イベントネストを使用してステートメントにリンクされます。 各ステージイベントレコードには、親ステートメントの <code class="literal">EVENT_ID</code> を含む <code class="literal">NESTING_EVENT_ID</code> カラムがあります。 
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT event_name AS Stage, TRUNCATE(TIMER_WAIT/1000000000000,6) AS Duration
       FROM performance_schema.events_stages_history_long WHERE NESTING_EVENT_ID=31;</code></strong>
+--------------------------------+----------+
| Stage                          | Duration |
+--------------------------------+----------+
| stage/sql/starting             | 0.000080 |
| stage/sql/checking permissions | 0.000005 |
| stage/sql/Opening tables       | 0.027759 |
| stage/sql/init                 | 0.000052 |
| stage/sql/System lock          | 0.000009 |
| stage/sql/optimizing           | 0.000006 |
| stage/sql/statistics           | 0.000082 |
| stage/sql/preparing            | 0.000008 |
| stage/sql/executing            | 0.000000 |
| stage/sql/Sending data         | 0.000017 |
| stage/sql/end                  | 0.000001 |
| stage/sql/query end            | 0.000004 |
| stage/sql/closing tables       | 0.000006 |
| stage/sql/freeing items        | 0.000272 |
| stage/sql/cleaning up          | 0.000001 |
+--------------------------------+----------+
</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-obtaining-parent-events"></a>27.19.2 親イベント情報の取得</h3></div></div></div><a class="indexterm" name="idm45882602527104"></a><a class="indexterm" name="idm45882602524960"></a><a class="indexterm" name="idm45882602523040"></a><a class="indexterm" name="idm45882602520864"></a><p>
        <code class="literal">data_locks</code> テーブルには、保持およびリクエストされたデータロックが表示されます。 このテーブルの行には、ロックを所有するセッションのスレッド ID を示す <code class="literal">THREAD_ID</code> カラムと、ロックの原因となったパフォーマンススキーマイベントを示す <code class="literal">EVENT_ID</code> カラムがあります。 (<code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>) 値のタプルは、他の「パフォーマンススキーマ」テーブルの親イベントを暗黙的に識別します: 
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_<em class="replaceable"><code>xxx</code></em></code> テーブルの親待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_<em class="replaceable"><code>xxx</code></em></code> テーブルの親ステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_<em class="replaceable"><code>xxx</code></em></code> テーブルの親ステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_transactions_current</code> テーブルの親トランザクションイベント
          </p></li></ul></div><p>
        親イベントの詳細を取得するには、<code class="literal">THREAD_ID</code> カラムと <code class="literal">EVENT_ID</code> カラムを適切な親イベントテーブルの同名のカラムと結合します。 リレーションはネストされたセットデータモデルに基づいているため、結合には複数の句があります。 <code class="literal">parent</code> および <code class="literal">child</code> でそれぞれ表される親テーブルと子テーブルの場合、結合は次のようになります: 
      </p><pre class="programlisting">WHERE
  parent.THREAD_ID = child.THREAD_ID        /* 1 */
  AND parent.EVENT_ID &lt; child.EVENT_ID      /* 2 */
  AND (
    child.EVENT_ID &lt;= parent.END_EVENT_ID   /* 3a */
    OR parent.END_EVENT_ID IS NULL          /* 3b */
  )
</pre><p>
        結合の条件は次のとおりです:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            親イベントと子イベントは同じスレッド内にあります。
          </p></li><li class="listitem"><p>
            子イベントは親イベントの後に開始されるため、その <code class="literal">EVENT_ID</code> 値は親の値より大きくなります。
          </p></li><li class="listitem"><p>
            親イベントが完了したか、まだ実行中です。
          </p></li></ol></div><p>
        ロック情報を検索するために、<code class="literal">data_locks</code> は子イベントを含むテーブルです。
      </p><p>
        <code class="literal">data_locks</code> テーブルには既存のロックのみが表示されるため、親イベントを含むテーブルに関して次の考慮事項が適用されます:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            トランザクションの場合、唯一の選択肢は <code class="literal">events_transactions_current</code> です。 トランザクションが完了した場合、そのトランザクションはトランザクション履歴テーブルにある可能性がありますが、ロックはすでに解除されています。 
          </p></li><li class="listitem"><p>
            ステートメントの場合、ロックを取得したステートメントがすでに完了したトランザクション内のステートメントであるか (<code class="literal">events_statements_history</code> を使用)、ステートメントがまだ実行中であるか (<code class="literal">events_statements_current</code> を使用)、によって異なります。
          </p></li><li class="listitem"><p>
            ステージの場合、ロジックはステートメントのロジックと似ています。<code class="literal">events_stages_history</code> または <code class="literal">events_stages_current</code> を使用します。
          </p></li><li class="listitem"><p>
            待機の場合、ロジックはステートメントのロジックと似ています。<code class="literal">events_waits_history</code> または <code class="literal">events_waits_current</code> を使用します。 ただし、多くの待機が記録されるため、ロックの原因となった待機はすでに履歴テーブルからなくなっている可能性があります。 
          </p></li></ul></div><p>
        待機イベント、ステージイベントおよびステートメントイベントは、履歴からすぐに消えます。 長時間前に実行されたステートメントがロックを取得したが、まだオープンしているトランザクションにある場合、ステートメントを見つけることはできない可能性がありますが、トランザクションを見つけることはできます。 
      </p><p>
        このため、ネストされたセットデータモデルは親イベントの検索に適しています。 中間ノードがすでに履歴テーブルから削除されている場合、親/子関係の次のリンク (データロック -&gt;親待機 -&gt;親ステージ -&gt;親トランザクション) は適切に機能しません。 
      </p><p>
        次のシナリオは、ロックが取得されたステートメントの親トランザクションを検索する方法を示しています:
      </p><p>
        セッション A:
      </p><pre class="programlisting">[1] START TRANSACTION;
[2] SELECT * FROM t1 WHERE pk = 1;
[3] SELECT 'Hello, world';
</pre><p>
        セッション B:
      </p><pre class="programlisting">SELECT ...
FROM performance_schema.events_transactions_current AS parent
  INNER JOIN performance_schema.data_locks AS child
WHERE
  parent.THREAD_ID = child.THREAD_ID
  AND parent.EVENT_ID &lt; child.EVENT_ID
  AND (
    child.EVENT_ID &lt;= parent.END_EVENT_ID
    OR parent.END_EVENT_ID IS NULL
  );
</pre><p>
        セッション B のクエリーでは、<code class="literal">pk=1</code> を使用してレコードのデータロックを所有しているステートメント[2]を表示する必要があります。
      </p><p>
        セッション A がさらにステートメントを実行すると、[2]は履歴テーブルからフェードアウトします。
      </p><p>
        クエリーでは、実行されたステートメント、ステージまたは待機の数に関係なく、[1]で開始されたトランザクションが表示されます。
      </p><p>
        サーバーで他のクエリーが実行されないことを前提として (履歴が保持されるように)、<code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code> テーブルを使用してさらにデータを表示することもできます (トランザクションを除く)。
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-restrictions"></a>27.20 パフォーマンススキーマの制約</h2></div></div></div><a class="indexterm" name="idm45882602467584"></a><a class="indexterm" name="idm45882602465408"></a><a class="indexterm" name="idm45882602463296"></a><a class="indexterm" name="idm45882602461296"></a><p>
      パフォーマンススキーマでは、データの収集または生成に相互排他ロックを使用できないので、一貫性は保証されず、適切な結果にならないことがあります。 <code class="literal">performance_schema</code> テーブルのイベント値は、非決定的であり、反復不可です。 
    </p><p>
      イベント情報を別のテーブルに保存する場合は、元のイベントが後で使用可能なままであると想定しないでください。 たとえば、<code class="literal">performance_schema</code> テーブルから一時テーブルにイベントを選択し、あとからそのテーブルと元のテーブルを結合させる場合、一致するものがない可能性があります。 
    </p><p>
      <span class="command"><strong>mysqldump</strong></span> と <code class="literal">BACKUP DATABASE</code> は、<code class="literal">performance_schema</code> データベース内のテーブルを無視します。
    </p><p>
      <code class="literal">performance_schema</code> データベース内のテーブルは、<code class="literal">LOCK TABLES</code> でロックできませんが、<code class="literal">setup_<em class="replaceable"><code>xxx</code></em></code> テーブルは除きます。
    </p><p>
      <code class="literal">performance_schema</code> データベース内のテーブルにインデックスを設定できません。
    </p><p>
      <code class="literal">performance_schema</code> データベース内のテーブルは複製されません。
    </p><p>
      タイマーの種類は、プラットフォームごとに異なります。 <code class="literal">performance_timers</code> テーブルは使用可能なイベントタイマーを示します。 特定のタイマー名に対するこのテーブルでの値が <code class="literal">NULL</code> の場合、そのタイマーはプラットフォームでサポートされていません。 
    </p><p>
      ストレージエンジンに適用されるインストゥルメントは、すべてのストレージエンジンに実装されていないことがあります。 各サードパーティーエンジンのインストゥルメンテーションはエンジン管理者の責任です。 
    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="information-schema.html">前</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="sys-schema.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第 26 章 INFORMATION_SCHEMA テーブル </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第 28 章 MySQL sys スキーマ</td></tr></table></div><div class="copyright-footer"></div></body></html>
